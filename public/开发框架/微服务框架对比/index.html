<!DOCTYPE html>
<html lang="en-us">
  <head><link rel="icon" href="/favicon_main.svg"><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<meta http-equiv="x-ua-compatible" content="ie=edge" /><meta property="og:url"  content="http://localhost:1313/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%AF%94/" />
    <meta property="og:type" content="article" /><meta property="og:title" content="微服务框架对比" /><meta property="og:description" content="微服务框架对比." /><meta property="og:image:width"  content="600" />
        <meta property="og:image:height" content="400" /><meta property="og:image" content="http://localhost:1313/images/default_summary_hu2be732aee21a2469ead3fe1f2df8caca_2088687_600x0_resize_q75_box.jpg" /><title>Promacanthus</title>
    
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Open&#43;Sans" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/css/style.6fd7fa42c7b7fe49cfeceeed650d33cb8d1cdbfe842e514a22e57a6b712729aa.css" integrity="sha256-b9f6Qse3/knP7O7tZQ0zy40c2/6ELlFKIuV6a3EnKao=">
<link rel="stylesheet" type="text/css" href="/css/monokai-sublime.9.15.8.min.91376415864fdd3a92be524052267afece4bdb1bb8c6c754f5e60c5ac28e93be.css" integrity="sha256-kTdkFYZP3TqSvlJAUiZ6/s5L2xu4xsdU9eYMWsKOk74=">
<link rel="stylesheet" type="text/css" href="/css/icons.f72c0103ff9598115ab2a76351494b950570479ce3f1795fec13fc62e4185dcf.css" integrity="sha256-9ywBA/&#43;VmBFasqdjUUlLlQVwR5zj8Xlf7BP8YuQYXc8=">
<link rel="stylesheet" type="text/css" href="/css/refresh.a55f73bd3031566bede1873d229fc74559352e7072fc322debef4b7ea58f58b8.css" integrity="sha256-pV9zvTAxVmvt4Yc9Ip/HRVk1LnBy/DIt6&#43;9LfqWPWLg=">
<link rel="stylesheet" type="text/css" href="/css/devicon.min.149016fbf45c8bc157d6f55ce3ee875feaa3f90446bf7d151fbc16a9f21a8859.css" integrity="sha256-FJAW&#43;/Rci8FX1vVc4&#43;6HX&#43;qj&#43;QRGv30VH7wWqfIaiFk=">
  </head>
  <body>
     

    <div id="preloader">
      <div id="status"></div>
    </div><nav class="navbar is-fresh is-transparent no-shadow" role="navigation" aria-label="main navigation">
  <div class="container">
    <div class="navbar-brand">

      
      
      
      <a class="navbar-item">
        <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
        <div class="navbar-item left-menu-icon-wrapper">
          分类
        </div>
      </a>

      <div class="navbar-item is-expanded"></div>
      <a class="navbar-item is-hidden-desktop">  
        <div data-target="navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
          Menu
        </div>
        <div data-target="navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
          <svg width="1000px" height="1000px">
            <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
            <path class="path2" d="M 300 500 L 700 500"></path>
            <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
          </svg>
          <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
        </div>
      </a>
    </div>

    

    <div id="navbar-menu" class="navbar-menu is-static">
      
      <div class="navbar-end">
        
          <a href="/" class="navbar-item is-secondary">主页</a><a href="/%E5%85%B3%E4%BA%8E/" class="navbar-item is-secondary">关于</a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="navbar-link">微服务</a>
            <div class="navbar-dropdown">
              <a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%9A%E5%8A%A1/" class="navbar-item">微服务业务</a><a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0/" class="navbar-item">微服务平台</a><a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/" class="navbar-item">领域驱动设计</a></div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/" class="navbar-link">填坑记</a>
            <div class="navbar-dropdown">
              <a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/traefik/" class="navbar-item">Traefik</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/mysql/" class="navbar-item">MySQL</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/kubernetes/" class="navbar-item">Kubernetes</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/http/" class="navbar-item">HTTP</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/golang/" class="navbar-item">Golang</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/docker/" class="navbar-item">Docker</a></div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/" class="navbar-link">开发框架</a>
            <div class="navbar-dropdown">
              <a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/webassembly/" class="navbar-item">WebAssembly</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/protocol-buffers/" class="navbar-item">Protocol Buffers</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/grpc/" class="navbar-item">GRPC</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/go-web/" class="navbar-item">Go Web</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/go-kit/" class="navbar-item">Go Kit</a></div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/" class="navbar-link">集成开发环境</a>
            <div class="navbar-dropdown">
              <a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/vscode/" class="navbar-item">VSCode</a><a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/goland/" class="navbar-item">Goland</a></div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" class="navbar-link">常用工具</a>
            <div class="navbar-dropdown">
              <a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/git/" class="navbar-item">Git</a><a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="navbar-item">正则表达式</a></div>
          </div><a href="/%E4%BA%A7%E5%93%81%E6%89%8B%E5%86%8C/" class="navbar-item is-secondary">产品手册</a>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/go%E8%AF%AD%E8%A8%80/" class="navbar-link">Go语言</a>
            <div class="navbar-dropdown">
              <a href="/go%E8%AF%AD%E8%A8%80/%E6%A0%B7%E4%BE%8B%E4%BB%A3%E7%A0%81/" class="navbar-item">样例代码</a><a href="/go%E8%AF%AD%E8%A8%80/%E5%AE%98%E6%96%B9%E6%96%87%E7%AB%A0/" class="navbar-item">官方文章</a><a href="/go%E8%AF%AD%E8%A8%80/%E6%A0%87%E5%87%86%E5%BA%93/" class="navbar-item">标准库</a><a href="/go%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80/" class="navbar-item">基础</a></div>
          </div>
          <div class="navbar-item has-dropdown is-hoverable">
            <a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/" class="navbar-link">云原生</a>
            <div class="navbar-dropdown">
              <a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/etcd/" class="navbar-item">Etcd</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" class="navbar-item">开发环境配置</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/traefik/" class="navbar-item">Traefik</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/service-mesh/" class="navbar-item">Service Mesh</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/ingress/" class="navbar-item">Ingress</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/helm/" class="navbar-item">Helm</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/docker/" class="navbar-item">Docker</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/kubernetes/" class="navbar-item">Kubernetes</a></div>
          </div></div>
    </div>




  </div>
</nav>
<nav id="navbar-clone" class="navbar is-fresh is-transparent" role="navigation" aria-label="main navigation">
  <div class="container">
      <div class="navbar-brand">
  
        
        
        
        <a class="navbar-item">
          <div class="menu-icon-wrapper left-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
          <div class="navbar-item left-menu-icon-wrapper">
            分类
          </div>
        </a>
  
        <div class="navbar-item is-expanded"></div>
        <a class="navbar-item is-hidden-desktop">  
          <div data-target="cloned-navbar-menu" class="navbar-item right-menu-icon-wrapper is-hidden-desktop">
            Menu
          </div>
          <div data-target="cloned-navbar-menu" class="menu-icon-wrapper right-menu-icon-wrapper" style="visibility: visible;">
            <svg width="1000px" height="1000px">
              <path class="path1" d="M 300 400 L 700 400 C 900 400 900 750 600 850 A 400 400 0 0 1 200 200 L 800 800"></path>
              <path class="path2" d="M 300 500 L 700 500"></path>
              <path class="path3" d="M 700 600 L 300 600 C 100 600 100 200 400 150 A 400 380 0 1 1 200 800 L 800 200"></path>
            </svg>
            <button id="menu-icon-trigger" class="menu-icon-trigger"></button>
          </div>
        </a>
      </div>
  
      
  
      <div id="cloned-navbar-menu" class="navbar-menu is-static">
        <div class="navbar-end"><a href="/" class="navbar-item is-secondary">主页</a><a href="/%E5%85%B3%E4%BA%8E/" class="navbar-item is-secondary">关于</a><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/" class="navbar-link">微服务</a>
              <div class="navbar-dropdown">
                <a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%9A%E5%8A%A1/" class="navbar-item">微服务业务</a><a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%B9%B3%E5%8F%B0/" class="navbar-item">微服务平台</a><a href="/%E5%BE%AE%E6%9C%8D%E5%8A%A1/%E9%A2%86%E5%9F%9F%E9%A9%B1%E5%8A%A8%E8%AE%BE%E8%AE%A1/" class="navbar-item">领域驱动设计</a></div>
            </div><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/" class="navbar-link">填坑记</a>
              <div class="navbar-dropdown">
                <a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/traefik/" class="navbar-item">Traefik</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/mysql/" class="navbar-item">MySQL</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/kubernetes/" class="navbar-item">Kubernetes</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/http/" class="navbar-item">HTTP</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/golang/" class="navbar-item">Golang</a><a href="/%E5%A1%AB%E5%9D%91%E8%AE%B0/docker/" class="navbar-item">Docker</a></div>
            </div><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/" class="navbar-link">开发框架</a>
              <div class="navbar-dropdown">
                <a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/webassembly/" class="navbar-item">WebAssembly</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/protocol-buffers/" class="navbar-item">Protocol Buffers</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/grpc/" class="navbar-item">GRPC</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/go-web/" class="navbar-item">Go Web</a><a href="/%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6/go-kit/" class="navbar-item">Go Kit</a></div>
            </div><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/" class="navbar-link">集成开发环境</a>
              <div class="navbar-dropdown">
                <a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/vscode/" class="navbar-item">VSCode</a><a href="/%E9%9B%86%E6%88%90%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83/goland/" class="navbar-item">Goland</a></div>
            </div><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" class="navbar-link">常用工具</a>
              <div class="navbar-dropdown">
                <a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/git/" class="navbar-item">Git</a><a href="/%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="navbar-item">正则表达式</a></div>
            </div><a href="/%E4%BA%A7%E5%93%81%E6%89%8B%E5%86%8C/" class="navbar-item is-secondary">产品手册</a><div class="navbar-item has-dropdown is-hoverable">
              <a href="/go%E8%AF%AD%E8%A8%80/" class="navbar-link">Go语言</a>
              <div class="navbar-dropdown">
                <a href="/go%E8%AF%AD%E8%A8%80/%E6%A0%B7%E4%BE%8B%E4%BB%A3%E7%A0%81/" class="navbar-item">样例代码</a><a href="/go%E8%AF%AD%E8%A8%80/%E5%AE%98%E6%96%B9%E6%96%87%E7%AB%A0/" class="navbar-item">官方文章</a><a href="/go%E8%AF%AD%E8%A8%80/%E6%A0%87%E5%87%86%E5%BA%93/" class="navbar-item">标准库</a><a href="/go%E8%AF%AD%E8%A8%80/%E5%9F%BA%E7%A1%80/" class="navbar-item">基础</a></div>
            </div><div class="navbar-item has-dropdown is-hoverable">
              <a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/" class="navbar-link">云原生</a>
              <div class="navbar-dropdown">
                <a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/etcd/" class="navbar-item">Etcd</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE/" class="navbar-item">开发环境配置</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/traefik/" class="navbar-item">Traefik</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/service-mesh/" class="navbar-item">Service Mesh</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/ingress/" class="navbar-item">Ingress</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/helm/" class="navbar-item">Helm</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/docker/" class="navbar-item">Docker</a><a href="/%E4%BA%91%E5%8E%9F%E7%94%9F/kubernetes/" class="navbar-item">Kubernetes</a></div>
            </div></div>
      </div>
  
  
  
  
    </div>
  </nav>
<section class="section is-medium">
  <div class="container">
    <div class="columns">
      <div class="column is-centered-tablet-portrait">
        <h1 class="title is-2 section-title">微服务框架对比</h1>
        <h5 class="subtitle is-5 is-muted"></h5>
        <div class="divider"></div>
        
        <section class="section content has-text-justified">
          <p><a href="https://medium.com/seek-blog/microservices-in-go-2fc1570f6800#id_token=eyJhbGciOiJSUzI1NiIsImtpZCI6IjhhNjNmZTcxZTUzMDY3NTI0Y2JiYzZhM2E1ODQ2M2IzODY0YzA3ODciLCJ0eXAiOiJKV1QifQ.eyJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20iLCJuYmYiOjE1NzIyMjg1MTUsImF1ZCI6IjIxNjI5NjAzNTgzNC1rMWs2cWUwNjBzMnRwMmEyamFtNGxqZGNtczAwc3R0Zy5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbSIsInN1YiI6IjEwMDcxNzY1ODE2MzQ3MjgyOTc1NiIsImVtYWlsIjoicHJvbWFjYW50aHVzQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJhenAiOiIyMTYyOTYwMzU4MzQtazFrNnFlMDYwczJ0cDJhMmphbTRsamRjbXMwMHN0dGcuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJuYW1lIjoi5pyx5Y2a5paHIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hLS9BQXVFN21EazdrbjJqZ29WcmlFbUU4R1A3ZnJEOHVmaVk0ZlduVWhoc3R5WD1zOTYtYyIsImdpdmVuX25hbWUiOiLljZrmlociLCJmYW1pbHlfbmFtZSI6IuacsSIsImlhdCI6MTU3MjIyODgxNSwiZXhwIjoxNTcyMjMyNDE1LCJqdGkiOiJjMjE2ZGFmYTI0MmVjNGM5MjJmMmNiNDhiZjQzNDgyODllNGM3M2NkIn0.ls7DvPanvP_FMw2tWVbXCb9qixJyt6zYE-cMLphP9qj2dLS7rPXW0P86ZCXy0qXOejOYpnuJGjBhyqHt4xy7oz1l520VoVHZqIuMlVMWXDoQ060RChcwCsGfZG1CJ4o_WdCn5KO9HRHPGtzGqzXo4u8qJHpZ9Lp4pHZwlMhn23sjKxopKRzPdMu5i3eP7jjeurQ8RXUHlCCLy5dG1rz8DL6LzSvf5e4KLAQwRqBuK0d9HrH4V_ho7r-eOmy34AFqjU5UEU4C1GFxgvt_Xu_xCKp0RMPgKYPpK5FX5lr0WruDfyJ4autZjHajoqeuHzrU7OYaW_U3DLDHgbib6FtqYQ">Medium原文</a>点这里。</p>
<p>对以下四个框架进行比较：</p>
<ul>
<li><a href="https://micro.mu/">Go Micro</a></li>
<li><a href="https://gokit.io/">Go Kit</a></li>
<li><a href="https://github.com/NYTimes/gizmo">Gizmo</a></li>
<li><a href="https://github.com/koding/kite">Kite</a></li>
</ul>
<h2 id="框架介绍">框架介绍</h2>
<h3 id="go-micro">Go Micro</h3>
<p>最受欢迎的框架只一，网上有很多的博客、文章，还有很多使用示例。可以在Medium上关注<a href="https://medium.com/microhq">microhq</a>，来获得Go Micro中的最新更新。</p>
<p>Go Micro是使用Go语言编写微服务的可插拔RPC框架，它开箱即用，有如下功能：</p>
<ol>
<li>服务发现：应用程序自动在服务发现系统中注册</li>
<li>负载均衡：客户端侧负载均衡，用于平衡服务实例之间的请求</li>
<li>同步通信：传输层提供请求/响应</li>
<li>异步通信：内置发布订阅功能</li>
<li>消息编码：基于消息的<code>Content-Type</code>标头的编码/解码</li>
<li>RPC客户端和服务端包：利用上述功能并暴露接口以构建微服务</li>
</ol>
<p>Go Micro架构可以描述为如下所示的三层堆栈：</p>
<p><img src="https://github.com/Promacanthus/Golang-Guide/blob/master/static/images/Go-Micro.png" alt="image"></p>
<p>顶层由客户端-服务器模型和服务抽象组成。服务器(Server)是用于编写服务的构建块，客户端(Client)提供了向服务请求的接口。</p>
<p>底层由以下类型的插件组成：</p>
<ul>
<li>代理：为异步发布/订阅通信提供消息代理的接口</li>
<li>编解码器：用于编码/解码消息，支持的格式包括<code>json</code>，<code>bson</code>，<code>protobuf</code>，<code>msgpack</code>等</li>
<li>注册中心：提供服务发现机制（默认为<a href="https://www.consul.io/">Consul</a>）</li>
<li>选择器：建立在注册中心上的负载均衡抽象，允许使用诸如随机，轮循，最少连接等算法来“选择”服务</li>
<li>传输：服务之间同步请求/响应通信的接口</li>
</ul>
<p>Go Micro还提供了Sidecar等功能。这就可以使用以Go以外的语言编写的服务。Sidecar提供服务注册，gRPC编码/解码和HTTP处理程序。它支持多种语言。</p>
<h3 id="go-kit">Go Kit</h3>
<p>Go Kit是用于在Go中构建微服务的编程工具包。与Go Micro不同，它是一个旨在导入二进制软件包的库。Go Kit遵循简单原则，例如：</p>
<ul>
<li>没有全局状态</li>
<li>声明式组成</li>
<li>显式依赖</li>
<li>合约式接口</li>
<li>领域驱动设计</li>
</ul>
<p>在Go Kit中可以找到以下软件包：</p>
<ol>
<li>身份验证：<code>basic</code>和<code>JWT</code></li>
<li>数据传输：HTTP、Nats（开源消息传递系统）、gRPC等</li>
<li>日志记录：通用接口用于结构化服务的日志记录</li>
<li>指标监控：<a href="https://aws.amazon.com/cn/cloudwatch/">CloudWatch</a>，<a href="https://github.com/statsd/statsd">Statsd</a>，<a href="https://github.com/springside/springside4/wiki/Graphite">Graphite</a>等</li>
<li>链路追踪： <a href="https://zipkin.io/">Zipkin</a>和<a href="https://opentracing.io/">Opentracing</a></li>
<li>服务发现：<a href="https://www.consul.io/">Consul</a>、<a href="https://etcd.io/">Etcd</a>、<a href="https://github.com/Netflix/eureka">Eureka</a>等</li>
<li>断路器：使用Go语言实现的<a href="https://github.com/afex/hystrix-go">Hystrix</a></li>
</ol>
<p>Peter Bourgon的文章和演示幻灯片是对Go Kit最好的描述之一：</p>
<ul>
<li><a href="https://peter.bourgon.org/go-kit/">Go kit: Go in the modern enterprise</a></li>
<li><a href="https://github.com/peterbourgon/go-microservices">Go + microservices</a></li>
</ul>
<p>在“ Go + microservices”幻灯片中，可以找到使用Go Kit构建的服务体系结构的示例。为了快速参考，服务架构图如下所示：</p>
<p><img src="https://github.com/Promacanthus/Golang-Guide/blob/master/static/images/Go-Kit.png" alt="image"></p>
<h3 id="gizmo">Gizmo</h3>
<p>Gizmo是《纽约时报》的微服务工具包。它提供了将服务和<code>pubsub</code>守护进程放在一起的软件包。它公开了以下软件包：</p>
<ul>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/server"> server</a>：提供两种服务实现方式：
<ul>
<li>简单服务（基于HTTP）</li>
<li>RPC服务（基于gRPC）</li>
</ul>
</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/server/kit">server/kit</a>：基于Go Kit的实验性软件包</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/config">config</a>：从以下位置获取配置参数的配置函数：
<ul>
<li>JSON文件，</li>
<li>Consul k/v中的JSON blob</li>
<li>环境变量</li>
</ul>
</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub">pubsub</a>：提供用于发布和订阅队列中数据的通用接口</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub/pubsubtest">pubsub/pubsubtest </a>：包含发布者和订阅者接口的测试实现</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/web">web</a>：暴露用于从请求查询和有效负载中解析类型的函数</li>
</ul>
<p><code>Pubsub</code>软件包提供了与以下队列一起使用的接口：</p>
<ul>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub/aws">pubsub/aws</a> ：Amazon SNS/SQS</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub/gcp">pubsub/gcp</a> ：Google Pubsub.</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub/kafka">pubsub/kafka</a> ：Kafka topics</li>
<li><a href="https://godoc.org/github.com/NYTimes/gizmo/pubsub/http">pubsub/http</a> ： publishing via HTTP</li>
</ul>
<p>因此，可以认为Gizmo位于Go Micro和Go Kit之间。它不是像Go Micro这样的完整“黑箱”。同时，它不像Go Kit那样原始。它提供了更高级别的构建组件，例如config和pubsub软件包。</p>
<h3 id="kite">Kite</h3>
<p>Kite是用于在Go中开发微服务的框架。它公开了RPC客户端和服务器程序包。创建的服务会自动在服务发现系统Kontrol中注册。 Kontrol是用Kite编写的，它本身就是Kite服务。这意味着Kite微服务在其自己的环境中运行良好。<strong>如果需要将Kite微服务连接到另一个服务发现系统，则需要自定义</strong>。这是从列表中删除Kite并决定不审查此框架的主要原因。</p>
<h2 id="框架对比">框架对比</h2>
<p>使用四个类别来比较框架：</p>
<ul>
<li>目标比较：基于GitHub统计</li>
<li>文档和示例</li>
<li>用户和社区</li>
<li>代码质量</li>
</ul>
<h3 id="github统计">Github统计</h3>
<p>时间：2019/10/28</p>
<table>
<thead>
<tr>
<th></th>
<th>Go Micro</th>
<th>Go Kit</th>
<th>Gizmo</th>
</tr>
</thead>
<tbody>
<tr>
<td>License</td>
<td>Apache License 2.0</td>
<td>MIT</td>
<td>Apache License 2.0</td>
</tr>
<tr>
<td>Created</td>
<td>Jan 2015</td>
<td>Feb 2015</td>
<td>Dec 2015</td>
</tr>
<tr>
<td>Release</td>
<td>60</td>
<td>9</td>
<td>48</td>
</tr>
<tr>
<td>Author</td>
<td>Asim  Aslam</td>
<td>Peter Bourgon</td>
<td>JP Robinson</td>
</tr>
<tr>
<td>Stars</td>
<td>9484</td>
<td>15190</td>
<td>2937</td>
</tr>
<tr>
<td>Open/Closed Issues</td>
<td>35/400</td>
<td>56/370</td>
<td>12/52</td>
</tr>
<tr>
<td>Last Update</td>
<td>Oct 26, 2019</td>
<td>Oct 18, 2019</td>
<td>Oct 14, 2019</td>
</tr>
</tbody>
</table>
<h3 id="文档和示例">文档和示例</h3>
<p>Go Micro和Go kit 提供了一个主页，其中包含正式的文档和示例。Gizmo框架没有提供可靠的文档，唯一的正式文档是仓库中的README文件。</p>
<p>有关Go Micro的大量信息和公告，请访问<a href="https://micro.mu/">micro.mu</a>，<a href="https://medium.com/microhq">microhq</a>和社交媒体<a href="https://twitter.com/MicroHQ">@MicroHQ</a>。</p>
<p>如果使用Go Kit，最好的文档可在<a href="https://peter.bourgon.org/go-kit/">Peter Bourgon博客</a>中找到。我发现的最好的例子之一是在<a href="http://www.ru-rocker.com/2017/04/17/micro-services-using-go-kit-service-discovery/">ru-rocker博客</a>中。</p>
<p>使用Gizmo，源代码提供了最佳的文档和示例。</p>
<blockquote>
<p>综上所述，如果您来自NodeJS领域，并希望看到类似ExpressJS的教程，您将感到失望。另一方面，这是创建自己的教程的绝佳机会。</p>
</blockquote>
<h3 id="用户和社区">用户和社区</h3>
<p>Go Kit是最流行的微服务框架，基于GitHub统计数据，它已超过1万五千颗星。它有大量的贡献者（161）和超过1600个分叉。最后，Go Kit受<a href="https://www.digitalocean.com/">DigitalOcean</a>支持。</p>
<p>拥有9484颗星，54个贡献者和993个分叉-Go Micro位居第二。 <a href="https://www.sixt.com/">Sixt</a>是Go Micro的最大赞助商之一。</p>
<p>Gizmo第三名。超过2937星，41个贡献者和188个分叉。由《纽约时报》支持和创建。</p>
<h3 id="代码质量">代码质量</h3>
<p>Go Kit在代码质量类别中排名第一。它具有近80％的代码覆盖率，并且具有出色的<a href="https://goreportcard.com/report/github.com/go-kit/kit">Go报告评级</a>。Gizmo也具有出色的<a href="https://goreportcard.com/report/github.com/NYTimes/gizmo">Go报告评级</a>。但是它的代码覆盖率只有46％。Go Micro不提供覆盖范围信息，但确实具有很高的<a href="https://goreportcard.com/report/github.com/micro/go-micro">Go报告评级</a>。</p>
<blockquote>
<p><a href="https://goreportcard.com/">https://goreportcard.com/</a> 代码质量评级网站</p>
</blockquote>
<h2 id="编写微服务">编写微服务</h2>
<p>为了更好地了解框架，创建了三个简单的微服务，如下图所示：</p>
<p><img src="https://github.com/Promacanthus/Golang-Guide/blob/master/static/images/microservice-example.png" alt="image"></p>
<p>这些服务都实现了一个业务逻辑：打招呼（greeting），当用户向服务中输入“名称”参数时，服务会发送问候语作为响应。所有服务都满足以下需求：</p>
<ul>
<li>服务应自行在服务发现系统中注册</li>
<li>服务应具有运行状况检查端点</li>
<li>服务应至少支持HTTP和gRPC传输协议</li>
</ul>
<p>对于喜欢阅读源代码的人，可以在这里访问<a href="https://github.com/antklim/go-microservices">仓库</a>源代码。</p>
<h3 id="gommicro-greeter">GomMicro greeter</h3>
<p>使用Go Micro创建服务所需要做的第一件事是定义protobuf描述。所有这三种服务都使用了相同的protobuf定义。创建了以下服务描述：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-protobuf" data-lang="protobuf">syntax <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;proto3&#34;</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#f92672">package</span> pb;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">service</span> Greeter {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">rpc</span> Greeting(GreetingRequest) <span style="color:#66d9ef">returns</span> (GreetingResponse) {}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">GreetingRequest</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> name <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span><span style="color:#66d9ef">message</span> <span style="color:#a6e22e">GreetingResponse</span> {<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>  <span style="color:#66d9ef">string</span> greeting <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>;<span style="color:#960050;background-color:#1e0010">
</span><span style="color:#960050;background-color:#1e0010"></span>}<span style="color:#960050;background-color:#1e0010">
</span></code></pre></div><p>这个接口包含一个方法Greeting，它有一个请求参数(name)和一个响应参数(greeting)</p>
<p>然后使用修改后的protoc从protobuf中生成服务接口，该<a href="https://github.com/micro/protoc-gen-micro">proto生成器</a>是Go Micro的一个分叉，并经过修改以支持该框架的某些功能。在打招呼服务中将所有这些连接在一起，此时，服务正在启动并在服务发现系统中注册，它仅支持gRPC传输协议。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;log&#34;</span>

    <span style="color:#a6e22e">pb</span> <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-micro-greeter/pb&#34;</span>
    <span style="color:#e6db74">&#34;github.com/micro/go-micro&#34;</span>
    <span style="color:#e6db74">&#34;golang.org/x/net/context&#34;</span>
)

<span style="color:#75715e">// Greeter implements greeter service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Greeter</span> <span style="color:#66d9ef">struct</span>{}

<span style="color:#75715e">// Greeting method implementation.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">g</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Greeter</span>) <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">in</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingRequest</span>, <span style="color:#a6e22e">out</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>) <span style="color:#66d9ef">error</span> {
    <span style="color:#a6e22e">out</span>.<span style="color:#a6e22e">Greeting</span> = <span style="color:#e6db74">&#34;GO-MICRO Hello &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">in</span>.<span style="color:#a6e22e">Name</span>
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">service</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">micro</span>.<span style="color:#a6e22e">NewService</span>(
        <span style="color:#a6e22e">micro</span>.<span style="color:#a6e22e">Name</span>(<span style="color:#e6db74">&#34;go-micro-srv-greeter&#34;</span>),
        <span style="color:#a6e22e">micro</span>.<span style="color:#a6e22e">Version</span>(<span style="color:#e6db74">&#34;latest&#34;</span>),
    )

    <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">Init</span>()

    <span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">RegisterGreeterHandler</span>(<span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">Server</span>(), new(<span style="color:#a6e22e">Greeter</span>))

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">Run</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
    }
}
</code></pre></div><p>为了支持HTTP传输，必须添加其他模块。它将HTTP请求映射到protobuf定义的请求，并调用gRPC服务。然后，它将服务响应映射到HTTP响应，并将其响应返回给用户。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;context&#34;</span>
    <span style="color:#e6db74">&#34;encoding/json&#34;</span>
    <span style="color:#e6db74">&#34;log&#34;</span>
    <span style="color:#e6db74">&#34;net/http&#34;</span>

    <span style="color:#a6e22e">proto</span> <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-micro-greeter/pb&#34;</span>
    <span style="color:#e6db74">&#34;github.com/micro/go-micro/client&#34;</span>
    <span style="color:#a6e22e">web</span> <span style="color:#e6db74">&#34;github.com/micro/go-web&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">service</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">NewService</span>(
        <span style="color:#a6e22e">web</span>.<span style="color:#a6e22e">Name</span>(<span style="color:#e6db74">&#34;go-micro-web-greeter&#34;</span>),
    )

    <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">HandleFunc</span>(<span style="color:#e6db74">&#34;/greeting&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) {
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Method</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;GET&#34;</span> {
            <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>
            <span style="color:#a6e22e">vars</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">Query</span>()
            <span style="color:#a6e22e">names</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vars</span>[<span style="color:#e6db74">&#34;name&#34;</span>]
            <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> <span style="color:#f92672">||</span> len(<span style="color:#a6e22e">names</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
                <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;&#34;</span>
            } <span style="color:#66d9ef">else</span> {
                <span style="color:#a6e22e">name</span> = <span style="color:#a6e22e">names</span>[<span style="color:#ae81ff">0</span>]
            }

            <span style="color:#a6e22e">cl</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">proto</span>.<span style="color:#a6e22e">NewGreeterClient</span>(<span style="color:#e6db74">&#34;go-micro-srv-greeter&#34;</span>, <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">DefaultClient</span>)
            <span style="color:#a6e22e">rsp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">cl</span>.<span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Background</span>(), <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">proto</span>.<span style="color:#a6e22e">GreetingRequest</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">name</span>})
            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
                <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>(), <span style="color:#ae81ff">500</span>)
                <span style="color:#66d9ef">return</span>
            }

            <span style="color:#a6e22e">js</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">rsp</span>)
            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
                <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Error</span>(<span style="color:#a6e22e">w</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>(), <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusInternalServerError</span>)
                <span style="color:#66d9ef">return</span>
            }

            <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>)
            <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">js</span>)
            <span style="color:#66d9ef">return</span>
        }
    })

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">Init</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
    }

    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">service</span>.<span style="color:#a6e22e">Run</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
    }
}
</code></pre></div><p>一方面，Go Micro在后台处理了许多事情，例如在服务发现系统中进行注册。另一方面，很难创建纯HTTP服务。</p>
<h3 id="go-kit-greeter">Go Kit greeter</h3>
<p>在完成Go Micro之后，继续进行Go Kit服务的实现。我花了很多时间阅读Go Kit存储库中提供的代码示例。了解端点的概念花了很多时间。下一个耗时的难题是服务发现注册中心代码。在找到一个很好的<a href="https://www.ru-rocker.com/2017/04/17/micro-services-using-go-kit-service-discovery/">例子</a>之前，我无法实现它。</p>
<p>最后，创建了四个包用于：</p>
<ol>
<li>服务逻辑实现</li>
<li>传输不可知服务端点</li>
<li>传输特定端点（gRPC、HTTP）</li>
<li>服务发现注册中心</li>
</ol>
<p>服务逻辑实现如下所示，代码没有任何依赖关系，它只是实现逻辑。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greeterservice</span>

<span style="color:#75715e">// Service describe greetings service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Service</span> <span style="color:#66d9ef">interface</span> {
    <span style="color:#a6e22e">Health</span>() <span style="color:#66d9ef">bool</span>
    <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span>
}

<span style="color:#75715e">// GreeterService implementation of the Service interface.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">GreeterService</span> <span style="color:#66d9ef">struct</span>{}

<span style="color:#75715e">// Health implementation of the Service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">GreeterService</span>) <span style="color:#a6e22e">Health</span>() <span style="color:#66d9ef">bool</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span>
}

<span style="color:#75715e">// Greeting implementation of the Service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">GreeterService</span>) <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">greeting</span> <span style="color:#66d9ef">string</span>) {
    <span style="color:#a6e22e">greeting</span> = <span style="color:#e6db74">&#34;GO-KIT Hello &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">name</span>
    <span style="color:#66d9ef">return</span>
}
</code></pre></div><p>下一段代码显示了端点定义：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greeterendpoint</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;context&#34;</span>

    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>

    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice&#34;</span>
    <span style="color:#e6db74">&#34;github.com/go-kit/kit/endpoint&#34;</span>
)

<span style="color:#75715e">//  端点集合收集打招呼服务的所有端点，它旨在用作辅助结构将所有端点收集到单个参数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Endpoints</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">HealthEndpoint</span>   <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span> <span style="color:#75715e">// used by Consul for the healthcheck
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">GreetingEndpoint</span> <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span>
}

<span style="color:#75715e">// MakeServerEndpoints返回服务端点，并在所有提供的中间件中进行连线
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeServerEndpoints</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>, <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#a6e22e">Endpoints</span> {
    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">healthEndpoint</span> <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span>
    {
        <span style="color:#a6e22e">healthEndpoint</span> = <span style="color:#a6e22e">MakeHealthEndpoint</span>(<span style="color:#a6e22e">s</span>)
        <span style="color:#a6e22e">healthEndpoint</span> = <span style="color:#a6e22e">LoggingMiddleware</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;method&#34;</span>, <span style="color:#e6db74">&#34;Health&#34;</span>))(<span style="color:#a6e22e">healthEndpoint</span>)
    }

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">greetingEndpoint</span> <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span>
    {
        <span style="color:#a6e22e">greetingEndpoint</span> = <span style="color:#a6e22e">MakeGreetingEndpoint</span>(<span style="color:#a6e22e">s</span>)
        <span style="color:#a6e22e">greetingEndpoint</span> = <span style="color:#a6e22e">LoggingMiddleware</span>(<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;method&#34;</span>, <span style="color:#e6db74">&#34;Greeting&#34;</span>))(<span style="color:#a6e22e">greetingEndpoint</span>)
    }

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Endpoints</span>{
        <span style="color:#a6e22e">HealthEndpoint</span>:   <span style="color:#a6e22e">healthEndpoint</span>,
        <span style="color:#a6e22e">GreetingEndpoint</span>: <span style="color:#a6e22e">greetingEndpoint</span>,
    }
}

<span style="color:#75715e">//  MakeHealthEndpoint构造Health端点来包装服务
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeHealthEndpoint</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">request</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">response</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
        <span style="color:#a6e22e">healthy</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Health</span>()
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">HealthResponse</span>{<span style="color:#a6e22e">Healthy</span>: <span style="color:#a6e22e">healthy</span>}, <span style="color:#66d9ef">nil</span>
    }
}

<span style="color:#75715e">//  MakeHealthEndpoint构造Greeter端点来包装服务
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeGreetingEndpoint</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">request</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">response</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
        <span style="color:#a6e22e">req</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">request</span>.(<span style="color:#a6e22e">GreetingRequest</span>)
        <span style="color:#a6e22e">greeting</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Name</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">GreetingResponse</span>{<span style="color:#a6e22e">Greeting</span>: <span style="color:#a6e22e">greeting</span>}, <span style="color:#66d9ef">nil</span>
    }
}

<span style="color:#75715e">// Failer是应该由响应类型实现的接口
</span><span style="color:#75715e">// 响应编码器可以检查响应是否为Failer，如果是Failer，
</span><span style="color:#75715e">// 判断是否失败，或者是否基于错误使用单独的写入路径对响应进行编码
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Failer</span> <span style="color:#66d9ef">interface</span> {
    <span style="color:#a6e22e">Failed</span>() <span style="color:#66d9ef">error</span>
}

<span style="color:#75715e">// HealthRequest收集Health方法的请求参数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HealthRequest</span> <span style="color:#66d9ef">struct</span>{}

<span style="color:#75715e">// HealthResponse收集Health方法的响应值
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HealthResponse</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Healthy</span> <span style="color:#66d9ef">bool</span>  <span style="color:#e6db74">`json:&#34;healthy,omitempty&#34;`</span>
    <span style="color:#a6e22e">Err</span>     <span style="color:#66d9ef">error</span> <span style="color:#e6db74">`json:&#34;err,omitempty&#34;`</span>
}

<span style="color:#75715e">// Failed实现Failer接口
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">HealthResponse</span>) <span style="color:#a6e22e">Failed</span>() <span style="color:#66d9ef">error</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Err</span> }

<span style="color:#75715e">// GreetingRequest收集Greeting方法的请求参数
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">GreetingRequest</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;name,omitempty&#34;`</span>
}

<span style="color:#75715e">// GreetingResponse收集Greeting方法的响应值
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">GreetingResponse</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Greeting</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;greeting,omitempty&#34;`</span>
    <span style="color:#a6e22e">Err</span>      <span style="color:#66d9ef">error</span>  <span style="color:#e6db74">`json:&#34;err,omitempty&#34;`</span>
}

<span style="color:#75715e">// Failed实现Failer接口
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">GreetingResponse</span>) <span style="color:#a6e22e">Failed</span>() <span style="color:#66d9ef">error</span> { <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Err</span> }
</code></pre></div><p>定义服务和端点后，通过不同的传输协议暴露端点。从HTTP传输开始：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greetertransport</span>

<span style="color:#f92672">import</span> (
<span style="color:#e6db74">&#34;context&#34;</span>
    <span style="color:#e6db74">&#34;encoding/json&#34;</span>
    <span style="color:#e6db74">&#34;errors&#34;</span>
    <span style="color:#e6db74">&#34;net/http&#34;</span>

    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint&#34;</span>
    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
    <span style="color:#a6e22e">httptransport</span> <span style="color:#e6db74">&#34;github.com/go-kit/kit/transport/http&#34;</span>
    <span style="color:#e6db74">&#34;github.com/gorilla/mux&#34;</span>
)

<span style="color:#66d9ef">var</span> (
    <span style="color:#75715e">// 如果缺少预期的路径变量，则返回ErrBadRouting
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ErrBadRouting</span> = <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;inconsistent mapping between route and handler&#34;</span>)
)

<span style="color:#75715e">// NewHTTPHandler返回一个HTTP处理程序，该处理程序使一组端点在预定义路径上可用
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewHTTPHandler</span>(<span style="color:#a6e22e">endpoints</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">Endpoints</span>, <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span> {
    <span style="color:#a6e22e">m</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">mux</span>.<span style="color:#a6e22e">NewRouter</span>()
    <span style="color:#a6e22e">options</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">httptransport</span>.<span style="color:#a6e22e">ServerOption</span>{
        <span style="color:#a6e22e">httptransport</span>.<span style="color:#a6e22e">ServerErrorEncoder</span>(<span style="color:#a6e22e">encodeError</span>),
        <span style="color:#a6e22e">httptransport</span>.<span style="color:#a6e22e">ServerErrorLogger</span>(<span style="color:#a6e22e">logger</span>),
    }

    <span style="color:#75715e">// GET /health                      retrieves service heath information
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// GET /greeting?name        retrieves greeting
</span><span style="color:#75715e"></span>
    <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Methods</span>(<span style="color:#e6db74">&#34;GET&#34;</span>).<span style="color:#a6e22e">Path</span>(<span style="color:#e6db74">&#34;/health&#34;</span>).<span style="color:#a6e22e">Handler</span>(<span style="color:#a6e22e">httptransport</span>.<span style="color:#a6e22e">NewServer</span>(
        <span style="color:#a6e22e">endpoints</span>.<span style="color:#a6e22e">HealthEndpoint</span>,
        <span style="color:#a6e22e">DecodeHTTPHealthRequest</span>,
        <span style="color:#a6e22e">EncodeHTTPGenericResponse</span>,
        <span style="color:#a6e22e">options</span><span style="color:#f92672">...</span>,
    ))
    <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Methods</span>(<span style="color:#e6db74">&#34;GET&#34;</span>).<span style="color:#a6e22e">Path</span>(<span style="color:#e6db74">&#34;/greeting&#34;</span>).<span style="color:#a6e22e">Handler</span>(<span style="color:#a6e22e">httptransport</span>.<span style="color:#a6e22e">NewServer</span>(
        <span style="color:#a6e22e">endpoints</span>.<span style="color:#a6e22e">GreetingEndpoint</span>,
        <span style="color:#a6e22e">DecodeHTTPGreetingRequest</span>,
        <span style="color:#a6e22e">EncodeHTTPGenericResponse</span>,
        <span style="color:#a6e22e">options</span><span style="color:#f92672">...</span>,
    ))
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">m</span>
}

<span style="color:#75715e">// DecodeHTTPHealthRequest method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DecodeHTTPHealthRequest</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">HealthRequest</span>{}, <span style="color:#66d9ef">nil</span>
}

<span style="color:#75715e">// DecodeHTTPGreetingRequest method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">DecodeHTTPGreetingRequest</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
    <span style="color:#a6e22e">vars</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">Query</span>()
    <span style="color:#a6e22e">names</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vars</span>[<span style="color:#e6db74">&#34;name&#34;</span>]
    <span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> <span style="color:#f92672">||</span> len(<span style="color:#a6e22e">names</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">ErrBadRouting</span>
    }
    <span style="color:#a6e22e">req</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">GreetingRequest</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">names</span>[<span style="color:#ae81ff">0</span>]}
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">req</span>, <span style="color:#66d9ef">nil</span>
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">encodeError</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>, <span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>) {
    <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">WriteHeader</span>(<span style="color:#a6e22e">err2code</span>(<span style="color:#a6e22e">err</span>))
    <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewEncoder</span>(<span style="color:#a6e22e">w</span>).<span style="color:#a6e22e">Encode</span>(<span style="color:#a6e22e">errorWrapper</span>{<span style="color:#a6e22e">Error</span>: <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>()})
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">err2code</span>(<span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) <span style="color:#66d9ef">int</span> {
    <span style="color:#66d9ef">switch</span> <span style="color:#a6e22e">err</span> {
    <span style="color:#66d9ef">default</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusInternalServerError</span>
    }
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">errorWrapper</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Error</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;error&#34;`</span>
}

<span style="color:#75715e">// EncodeHTTPGenericResponse是`transport/http.EncodeResponseFunc`，它将响应编码为JSON编码到响应编写器
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">EncodeHTTPGenericResponse</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">w</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ResponseWriter</span>, <span style="color:#a6e22e">response</span> <span style="color:#66d9ef">interface</span>{}) <span style="color:#66d9ef">error</span> {
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">f</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">response</span>.(<span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">Failer</span>); <span style="color:#a6e22e">ok</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Failed</span>() <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#a6e22e">encodeError</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Failed</span>(), <span style="color:#a6e22e">w</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
    }
    <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Header</span>().<span style="color:#a6e22e">Set</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json; charset=utf-8&#34;</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewEncoder</span>(<span style="color:#a6e22e">w</span>).<span style="color:#a6e22e">Encode</span>(<span style="color:#a6e22e">response</span>)
}
</code></pre></div><p>在开始gRPC端点实现之前，不需要protobuf定义。直接复制上面Go Micro服务的protobuf定义。但是对于Go Kit，使用默认的服务生成器来创建服务接口。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">protoc greeter.proto --go_out<span style="color:#f92672">=</span>plugins<span style="color:#f92672">=</span>grpc:.
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greetertransport</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;context&#34;</span>

    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pb&#34;</span>
    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint&#34;</span>
    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
    <span style="color:#a6e22e">grpctransport</span> <span style="color:#e6db74">&#34;github.com/go-kit/kit/transport/grpc&#34;</span>
    <span style="color:#a6e22e">oldcontext</span> <span style="color:#e6db74">&#34;golang.org/x/net/context&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">grpcServer</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">greeter</span> <span style="color:#a6e22e">grpctransport</span>.<span style="color:#a6e22e">Handler</span>
}

<span style="color:#75715e">// NewGRPCServer使一组端点可用作gRPC GreeterServer
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewGRPCServer</span>(<span style="color:#a6e22e">endpoints</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">Endpoints</span>, <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreeterServer</span> {
    <span style="color:#a6e22e">options</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">grpctransport</span>.<span style="color:#a6e22e">ServerOption</span>{
        <span style="color:#a6e22e">grpctransport</span>.<span style="color:#a6e22e">ServerErrorLogger</span>(<span style="color:#a6e22e">logger</span>),
    }

    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">grpcServer</span>{
        <span style="color:#a6e22e">greeter</span>: <span style="color:#a6e22e">grpctransport</span>.<span style="color:#a6e22e">NewServer</span>(
            <span style="color:#a6e22e">endpoints</span>.<span style="color:#a6e22e">GreetingEndpoint</span>,
            <span style="color:#a6e22e">decodeGRPCGreetingRequest</span>,
            <span style="color:#a6e22e">encodeGRPCGreetingResponse</span>,
            <span style="color:#a6e22e">options</span><span style="color:#f92672">...</span>,
        ),
    }
}

<span style="color:#75715e">//  Greeting实现GreeterService接口的方法
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">grpcServer</span>) <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">oldcontext</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">req</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingRequest</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>, <span style="color:#66d9ef">error</span>) {
    <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">greeter</span>.<span style="color:#a6e22e">ServeGRPC</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">req</span>)
    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">err</span>
    }
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">res</span>.(<span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>), <span style="color:#66d9ef">nil</span>
}

<span style="color:#75715e">// encodeGRPCGreetingRequest是一个`transport/grpc.DecodeRequestFunc`，它将gRPC问候请求转换为用户域问候请求
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">decodeGRPCGreetingRequest</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">grpcReq</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
    <span style="color:#a6e22e">req</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">grpcReq</span>.(<span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingRequest</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">GreetingRequest</span>{<span style="color:#a6e22e">Name</span>: <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Name</span>}, <span style="color:#66d9ef">nil</span>
}


<span style="color:#75715e">// encodeGRPCGreetingResponse是`transport/grpc.EncodeResponseFunc`，它将用户域问候响应转换为gRPC问候响应
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">encodeGRPCGreetingResponse</span>(<span style="color:#a6e22e">_</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">response</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
    <span style="color:#a6e22e">res</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">response</span>.(<span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">GreetingResponse</span>)
    <span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>{<span style="color:#a6e22e">Greeting</span>: <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">Greeting</span>}, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>最后，实现服务发现注册器：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greetersd</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;math/rand&#34;</span>
    <span style="color:#e6db74">&#34;os&#34;</span>
    <span style="color:#e6db74">&#34;strconv&#34;</span>
    <span style="color:#e6db74">&#34;time&#34;</span>

    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
    <span style="color:#e6db74">&#34;github.com/go-kit/kit/sd&#34;</span>
    <span style="color:#a6e22e">consulsd</span> <span style="color:#e6db74">&#34;github.com/go-kit/kit/sd/consul&#34;</span>
    <span style="color:#e6db74">&#34;github.com/hashicorp/consul/api&#34;</span>
)

<span style="color:#75715e">// ConsulRegister method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ConsulRegister</span>(<span style="color:#a6e22e">consulAddress</span> <span style="color:#66d9ef">string</span>,
    <span style="color:#a6e22e">consulPort</span> <span style="color:#66d9ef">string</span>,
    <span style="color:#a6e22e">advertiseAddress</span> <span style="color:#66d9ef">string</span>,
    <span style="color:#a6e22e">advertisePort</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">registar</span> <span style="color:#a6e22e">sd</span>.<span style="color:#a6e22e">Registrar</span>) {

    <span style="color:#75715e">// Logging domain.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>
    {
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">NewLogfmtLogger</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>)
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;ts&#34;</span>, <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">DefaultTimestampUTC</span>)
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;caller&#34;</span>, <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">DefaultCaller</span>)
    }

    <span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Seed</span>(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>().<span style="color:#a6e22e">UTC</span>().<span style="color:#a6e22e">UnixNano</span>())

    <span style="color:#75715e">// Service discovery domain. In this example we use Consul.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">client</span> <span style="color:#a6e22e">consulsd</span>.<span style="color:#a6e22e">Client</span>
    {
        <span style="color:#a6e22e">consulConfig</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">api</span>.<span style="color:#a6e22e">DefaultConfig</span>()
        <span style="color:#a6e22e">consulConfig</span>.<span style="color:#a6e22e">Address</span> = <span style="color:#a6e22e">consulAddress</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">consulPort</span>
        <span style="color:#a6e22e">consulClient</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">api</span>.<span style="color:#a6e22e">NewClient</span>(<span style="color:#a6e22e">consulConfig</span>)
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;err&#34;</span>, <span style="color:#a6e22e">err</span>)
            <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
        }
        <span style="color:#a6e22e">client</span> = <span style="color:#a6e22e">consulsd</span>.<span style="color:#a6e22e">NewClient</span>(<span style="color:#a6e22e">consulClient</span>)
    }

    <span style="color:#a6e22e">check</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">api</span>.<span style="color:#a6e22e">AgentServiceCheck</span>{
        <span style="color:#a6e22e">HTTP</span>:     <span style="color:#e6db74">&#34;http://&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">advertiseAddress</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;:&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">advertisePort</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;/health&#34;</span>,
        <span style="color:#a6e22e">Interval</span>: <span style="color:#e6db74">&#34;10s&#34;</span>,
        <span style="color:#a6e22e">Timeout</span>:  <span style="color:#e6db74">&#34;1s&#34;</span>,
        <span style="color:#a6e22e">Notes</span>:    <span style="color:#e6db74">&#34;Basic health checks&#34;</span>,
    }

    <span style="color:#a6e22e">port</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Atoi</span>(<span style="color:#a6e22e">advertisePort</span>)
    <span style="color:#a6e22e">num</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Intn</span>(<span style="color:#ae81ff">100</span>) <span style="color:#75715e">// to make service ID unique
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">asr</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">api</span>.<span style="color:#a6e22e">AgentServiceRegistration</span>{
        <span style="color:#a6e22e">ID</span>:      <span style="color:#e6db74">&#34;go-kit-srv-greeter-&#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">strconv</span>.<span style="color:#a6e22e">Itoa</span>(<span style="color:#a6e22e">num</span>), <span style="color:#75715e">//unique service ID
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">Name</span>:    <span style="color:#e6db74">&#34;go-kit-srv-greeter&#34;</span>,
        <span style="color:#a6e22e">Address</span>: <span style="color:#a6e22e">advertiseAddress</span>,
        <span style="color:#a6e22e">Port</span>:    <span style="color:#a6e22e">port</span>,
        <span style="color:#a6e22e">Tags</span>:    []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;go-kit&#34;</span>, <span style="color:#e6db74">&#34;greeter&#34;</span>},
        <span style="color:#a6e22e">Check</span>:   <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">check</span>,
    }
    <span style="color:#a6e22e">registar</span> = <span style="color:#a6e22e">consulsd</span>.<span style="color:#a6e22e">NewRegistrar</span>(<span style="color:#a6e22e">client</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">asr</span>, <span style="color:#a6e22e">logger</span>)
    <span style="color:#66d9ef">return</span>
}
</code></pre></div><p>准备好所有构建块之后，我将它们连接到服务启动器中：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;flag&#34;</span>
    <span style="color:#e6db74">&#34;fmt&#34;</span>
    <span style="color:#e6db74">&#34;net&#34;</span>
    <span style="color:#e6db74">&#34;net/http&#34;</span>
    <span style="color:#e6db74">&#34;os&#34;</span>
    <span style="color:#e6db74">&#34;os/signal&#34;</span>
    <span style="color:#e6db74">&#34;syscall&#34;</span>
    <span style="color:#e6db74">&#34;text/tabwriter&#34;</span>

    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pb&#34;</span>
    <span style="color:#e6db74">&#34;google.golang.org/grpc&#34;</span>

    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint&#34;</span>
    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greetersd&#34;</span>
    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice&#34;</span>
    <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/go-kit-greeter/pkg/greetertransport&#34;</span>

    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
    <span style="color:#e6db74">&#34;github.com/oklog/oklog/pkg/group&#34;</span>
)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
    <span style="color:#a6e22e">fs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">NewFlagSet</span>(<span style="color:#e6db74">&#34;greetersvc&#34;</span>, <span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">ExitOnError</span>)
    <span style="color:#66d9ef">var</span> (
        <span style="color:#a6e22e">debugAddr</span>  = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;debug.addr&#34;</span>, <span style="color:#e6db74">&#34;:9100&#34;</span>, <span style="color:#e6db74">&#34;Debug and metrics listen address&#34;</span>)
        <span style="color:#a6e22e">consulAddr</span> = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;consul.addr&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;Consul Address&#34;</span>)
        <span style="color:#a6e22e">consulPort</span> = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;consul.port&#34;</span>, <span style="color:#e6db74">&#34;8500&#34;</span>, <span style="color:#e6db74">&#34;Consul Port&#34;</span>)
        <span style="color:#a6e22e">httpAddr</span>   = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;http.addr&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;HTTP Listen Address&#34;</span>)
        <span style="color:#a6e22e">httpPort</span>   = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;http.port&#34;</span>, <span style="color:#e6db74">&#34;9110&#34;</span>, <span style="color:#e6db74">&#34;HTTP Listen Port&#34;</span>)
        <span style="color:#a6e22e">grpcAddr</span>   = <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">String</span>(<span style="color:#e6db74">&#34;grpc-addr&#34;</span>, <span style="color:#e6db74">&#34;:9120&#34;</span>, <span style="color:#e6db74">&#34;gRPC listen address&#34;</span>)
    )
    <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">Usage</span> = <span style="color:#a6e22e">usageFor</span>(<span style="color:#a6e22e">fs</span>, <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">+</span><span style="color:#e6db74">&#34; [flags]&#34;</span>)
    <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">Parse</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Args</span>[<span style="color:#ae81ff">1</span>:])

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>
    {
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">NewLogfmtLogger</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>)
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;ts&#34;</span>, <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">DefaultTimestampUTC</span>)
        <span style="color:#a6e22e">logger</span> = <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">With</span>(<span style="color:#a6e22e">logger</span>, <span style="color:#e6db74">&#34;caller&#34;</span>, <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">DefaultCaller</span>)
    }

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">service</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>
    {
        <span style="color:#a6e22e">service</span> = <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">GreeterService</span>{}
        <span style="color:#a6e22e">service</span> = <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">LoggingMiddleware</span>(<span style="color:#a6e22e">logger</span>)(<span style="color:#a6e22e">service</span>)
    }

    <span style="color:#66d9ef">var</span> (
        <span style="color:#a6e22e">endpoints</span>   = <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">MakeServerEndpoints</span>(<span style="color:#a6e22e">service</span>, <span style="color:#a6e22e">logger</span>)
        <span style="color:#a6e22e">httpHandler</span> = <span style="color:#a6e22e">greetertransport</span>.<span style="color:#a6e22e">NewHTTPHandler</span>(<span style="color:#a6e22e">endpoints</span>, <span style="color:#a6e22e">logger</span>)
        <span style="color:#a6e22e">registar</span>    = <span style="color:#a6e22e">greetersd</span>.<span style="color:#a6e22e">ConsulRegister</span>(<span style="color:#f92672">*</span><span style="color:#a6e22e">consulAddr</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">consulPort</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">httpAddr</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">httpPort</span>)
        <span style="color:#a6e22e">grpcServer</span>  = <span style="color:#a6e22e">greetertransport</span>.<span style="color:#a6e22e">NewGRPCServer</span>(<span style="color:#a6e22e">endpoints</span>, <span style="color:#a6e22e">logger</span>)
    )

    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span> <span style="color:#a6e22e">group</span>.<span style="color:#a6e22e">Group</span>
    {
        <span style="color:#75715e">// The debug listener mounts the http.DefaultServeMux, and serves up
</span><span style="color:#75715e"></span>        <span style="color:#75715e">// stuff like the Go debug and profiling routes, and so on.
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">debugListener</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;tcp&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">debugAddr</span>)
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport&#34;</span>, <span style="color:#e6db74">&#34;debug/HTTP&#34;</span>, <span style="color:#e6db74">&#34;during&#34;</span>, <span style="color:#e6db74">&#34;Listen&#34;</span>, <span style="color:#e6db74">&#34;err&#34;</span>, <span style="color:#a6e22e">err</span>)
            <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
        }
        <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport&#34;</span>, <span style="color:#e6db74">&#34;debug/HTTP&#34;</span>, <span style="color:#e6db74">&#34;addr&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">debugAddr</span>)
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Serve</span>(<span style="color:#a6e22e">debugListener</span>, <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">DefaultServeMux</span>)
        }, <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">error</span>) {
            <span style="color:#a6e22e">debugListener</span>.<span style="color:#a6e22e">Close</span>()
        })
    }

    {
        <span style="color:#75715e">// The service discovery registration.
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport&#34;</span>, <span style="color:#e6db74">&#34;HTTP&#34;</span>, <span style="color:#e6db74">&#34;addr&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">httpAddr</span>, <span style="color:#e6db74">&#34;port&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">httpPort</span>)
            <span style="color:#a6e22e">registar</span>.<span style="color:#a6e22e">Register</span>()
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:&#34;</span><span style="color:#f92672">+*</span><span style="color:#a6e22e">httpPort</span>, <span style="color:#a6e22e">httpHandler</span>)
        }, <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">error</span>) {
            <span style="color:#a6e22e">registar</span>.<span style="color:#a6e22e">Deregister</span>()
        })
    }
    {
        <span style="color:#75715e">// The gRPC listener mounts the Go kit gRPC server we created.
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">grpcListener</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">net</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;tcp&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">grpcAddr</span>)
        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport&#34;</span>, <span style="color:#e6db74">&#34;gRPC&#34;</span>, <span style="color:#e6db74">&#34;during&#34;</span>, <span style="color:#e6db74">&#34;Listen&#34;</span>, <span style="color:#e6db74">&#34;err&#34;</span>, <span style="color:#a6e22e">err</span>)
            <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Exit</span>(<span style="color:#ae81ff">1</span>)
        }
        <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span> {
            <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport&#34;</span>, <span style="color:#e6db74">&#34;gRPC&#34;</span>, <span style="color:#e6db74">&#34;addr&#34;</span>, <span style="color:#f92672">*</span><span style="color:#a6e22e">grpcAddr</span>)
            <span style="color:#a6e22e">baseServer</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">grpc</span>.<span style="color:#a6e22e">NewServer</span>()
            <span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">RegisterGreeterServer</span>(<span style="color:#a6e22e">baseServer</span>, <span style="color:#a6e22e">grpcServer</span>)
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">baseServer</span>.<span style="color:#a6e22e">Serve</span>(<span style="color:#a6e22e">grpcListener</span>)
        }, <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">error</span>) {
            <span style="color:#a6e22e">grpcListener</span>.<span style="color:#a6e22e">Close</span>()
        })
    }

    {
        <span style="color:#75715e">// This function just sits and waits for ctrl-C.
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">cancelInterrupt</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#66d9ef">struct</span>{})
        <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">error</span> {
            <span style="color:#a6e22e">c</span> <span style="color:#f92672">:=</span> make(<span style="color:#66d9ef">chan</span> <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Signal</span>, <span style="color:#ae81ff">1</span>)
            <span style="color:#a6e22e">signal</span>.<span style="color:#a6e22e">Notify</span>(<span style="color:#a6e22e">c</span>, <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGINT</span>, <span style="color:#a6e22e">syscall</span>.<span style="color:#a6e22e">SIGTERM</span>)
            <span style="color:#66d9ef">select</span> {
            <span style="color:#66d9ef">case</span> <span style="color:#a6e22e">sig</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">c</span>:
                <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Errorf</span>(<span style="color:#e6db74">&#34;received signal %s&#34;</span>, <span style="color:#a6e22e">sig</span>)
            <span style="color:#66d9ef">case</span> <span style="color:#f92672">&lt;-</span><span style="color:#a6e22e">cancelInterrupt</span>:
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">nil</span>
            }
        }, <span style="color:#66d9ef">func</span>(<span style="color:#66d9ef">error</span>) {
            close(<span style="color:#a6e22e">cancelInterrupt</span>)
        })
    }
    <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;exit&#34;</span>, <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Run</span>())
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">usageFor</span>(<span style="color:#a6e22e">fs</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">FlagSet</span>, <span style="color:#a6e22e">short</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">func</span>() {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>() {
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;USAGE\n&#34;</span>)
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;  %s\n&#34;</span>, <span style="color:#a6e22e">short</span>)
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;\n&#34;</span>)
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;FLAGS\n&#34;</span>)
        <span style="color:#a6e22e">w</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">tabwriter</span>.<span style="color:#a6e22e">NewWriter</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#39; &#39;</span>, <span style="color:#ae81ff">0</span>)
        <span style="color:#a6e22e">fs</span>.<span style="color:#a6e22e">VisitAll</span>(<span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">f</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">flag</span>.<span style="color:#a6e22e">Flag</span>) {
            <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">w</span>, <span style="color:#e6db74">&#34;\t-%s %s\t%s\n&#34;</span>, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Name</span>, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">DefValue</span>, <span style="color:#a6e22e">f</span>.<span style="color:#a6e22e">Usage</span>)
        })
        <span style="color:#a6e22e">w</span>.<span style="color:#a6e22e">Flush</span>()
        <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Fprintf</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stderr</span>, <span style="color:#e6db74">&#34;\n&#34;</span>)
    }
}
</code></pre></div><p>在几个地方使用了日志记录中间件。它使我们能够将日志记录逻辑与主要服务/端点工作流分离。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greeterservice</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;time&#34;</span>

    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
)

<span style="color:#75715e">// ServiceMiddleware描述了服务中间件
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ServiceMiddleware</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">Service</span>

<span style="color:#75715e">// LoggingMiddleware将记录器作为依赖项，并返回ServiceMiddleware。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoggingMiddleware</span>(<span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#a6e22e">ServiceMiddleware</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">next</span> <span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">Service</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">loggingMiddleware</span>{<span style="color:#a6e22e">next</span>, <span style="color:#a6e22e">logger</span>}
    }
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">loggingMiddleware</span> <span style="color:#66d9ef">struct</span> {
    <span style="color:#a6e22e">Service</span>
    <span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">m</span> <span style="color:#a6e22e">loggingMiddleware</span>) <span style="color:#a6e22e">Health</span>() (<span style="color:#a6e22e">healthy</span> <span style="color:#66d9ef">bool</span>) {
    <span style="color:#66d9ef">defer</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">begin</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>) {
        <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(
            <span style="color:#e6db74">&#34;method&#34;</span>, <span style="color:#e6db74">&#34;Health&#34;</span>,
            <span style="color:#e6db74">&#34;healthy&#34;</span>, <span style="color:#a6e22e">healthy</span>,
            <span style="color:#e6db74">&#34;took&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>),
        )
    }(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>())
    <span style="color:#a6e22e">healthy</span> = <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Service</span>.<span style="color:#a6e22e">Health</span>()
    <span style="color:#66d9ef">return</span>
}

<span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">m</span> <span style="color:#a6e22e">loggingMiddleware</span>) <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">name</span> <span style="color:#66d9ef">string</span>) (<span style="color:#a6e22e">greeting</span> <span style="color:#66d9ef">string</span>) {
    <span style="color:#66d9ef">defer</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">begin</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>) {
        <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(
            <span style="color:#e6db74">&#34;method&#34;</span>, <span style="color:#e6db74">&#34;Greeting&#34;</span>,
            <span style="color:#e6db74">&#34;name&#34;</span>, <span style="color:#a6e22e">name</span>,
            <span style="color:#e6db74">&#34;greeting&#34;</span>, <span style="color:#a6e22e">greeting</span>,
            <span style="color:#e6db74">&#34;took&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>),
        )
    }(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>())
    <span style="color:#a6e22e">greeting</span> = <span style="color:#a6e22e">m</span>.<span style="color:#a6e22e">Service</span>.<span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">name</span>)
    <span style="color:#66d9ef">return</span>
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greeterendpoint</span>

<span style="color:#f92672">import</span> (
    <span style="color:#e6db74">&#34;context&#34;</span>
    <span style="color:#e6db74">&#34;time&#34;</span>

    <span style="color:#e6db74">&#34;github.com/go-kit/kit/endpoint&#34;</span>
    <span style="color:#e6db74">&#34;github.com/go-kit/kit/log&#34;</span>
)

<span style="color:#75715e">// LoggingMiddleware返回一个端点中间件，该中间件记录每次调用的持续时间以及所产生的错误（如果有）
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">LoggingMiddleware</span>(<span style="color:#a6e22e">logger</span> <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Logger</span>) <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Middleware</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">next</span> <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span>) <span style="color:#a6e22e">endpoint</span>.<span style="color:#a6e22e">Endpoint</span> {
        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">request</span> <span style="color:#66d9ef">interface</span>{}) (<span style="color:#a6e22e">response</span> <span style="color:#66d9ef">interface</span>{}, <span style="color:#a6e22e">err</span> <span style="color:#66d9ef">error</span>) {
            <span style="color:#66d9ef">defer</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">begin</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span>) {
                <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">Log</span>(<span style="color:#e6db74">&#34;transport_error&#34;</span>, <span style="color:#a6e22e">err</span>, <span style="color:#e6db74">&#34;took&#34;</span>, <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Since</span>(<span style="color:#a6e22e">begin</span>))
            }(<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>())
            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">next</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">request</span>)
        }
    }
}
</code></pre></div><h3 id="gizmo-greeter">Gizmo greeter</h3>
<p>以与Go Kit类似的方式创建了Gizmo服务。为服务，端点，传输和服务发现注册器定义了四个包。服务实现和服务发现系统注册中心与Go Kit服务共享相同的代码。但是端点定义和传输实现必须根据Gizmo的功能来完成。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greeterendpoint</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;net/http&#34;</span>

	<span style="color:#a6e22e">ocontext</span> <span style="color:#e6db74">&#34;golang.org/x/net/context&#34;</span>

	<span style="color:#e6db74">&#34;github.com/NYTimes/gizmo/server&#34;</span>
	<span style="color:#e6db74">&#34;github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterservice&#34;</span>
)

<span style="color:#75715e">// Endpoints collects all of the endpoints that compose a greeter service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Endpoints</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">HealthEndpoint</span>   <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>
	<span style="color:#a6e22e">GreetingEndpoint</span> <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>
}

<span style="color:#75715e">// MakeServerEndpoints returns service Endoints
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeServerEndpoints</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">Endpoints</span> {
	<span style="color:#a6e22e">healthEndpoint</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MakeHealthEndpoint</span>(<span style="color:#a6e22e">s</span>)
	<span style="color:#a6e22e">greetingEndpoint</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">MakeGreetingEndpoint</span>(<span style="color:#a6e22e">s</span>)

	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Endpoints</span>{
		<span style="color:#a6e22e">HealthEndpoint</span>:   <span style="color:#a6e22e">healthEndpoint</span>,
		<span style="color:#a6e22e">GreetingEndpoint</span>: <span style="color:#a6e22e">greetingEndpoint</span>,
	}
}

<span style="color:#75715e">// MakeHealthEndpoint constructs a Health endpoint.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeHealthEndpoint</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">ocontext</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
		<span style="color:#a6e22e">healthy</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Health</span>()
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">HealthResponse</span>{<span style="color:#a6e22e">Healthy</span>: <span style="color:#a6e22e">healthy</span>}, <span style="color:#66d9ef">nil</span>
	}
}

<span style="color:#75715e">// MakeGreetingEndpoint constructs a Greeting endpoint.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">MakeGreetingEndpoint</span>(<span style="color:#a6e22e">s</span> <span style="color:#a6e22e">greeterservice</span>.<span style="color:#a6e22e">Service</span>) <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">ocontext</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {
		<span style="color:#a6e22e">vars</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">URL</span>.<span style="color:#a6e22e">Query</span>()
		<span style="color:#a6e22e">names</span>, <span style="color:#a6e22e">exists</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">vars</span>[<span style="color:#e6db74">&#34;name&#34;</span>]
		<span style="color:#66d9ef">if</span> !<span style="color:#a6e22e">exists</span> <span style="color:#f92672">||</span> len(<span style="color:#a6e22e">names</span>) <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span> {
			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">errorResponse</span>{<span style="color:#a6e22e">Error</span>: <span style="color:#e6db74">&#34;query parameter &#39;name&#39; required&#34;</span>}, <span style="color:#66d9ef">nil</span>
		}
		<span style="color:#a6e22e">greeting</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">names</span>[<span style="color:#ae81ff">0</span>])
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusOK</span>, <span style="color:#a6e22e">GreetingResponse</span>{<span style="color:#a6e22e">Greeting</span>: <span style="color:#a6e22e">greeting</span>}, <span style="color:#66d9ef">nil</span>
	}
}

<span style="color:#75715e">// HealthRequest collects the request parameters for the Health method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HealthRequest</span> <span style="color:#66d9ef">struct</span>{}

<span style="color:#75715e">// HealthResponse collects the response values for the Health method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">HealthResponse</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Healthy</span> <span style="color:#66d9ef">bool</span> <span style="color:#e6db74">`json:&#34;healthy,omitempty&#34;`</span>
}

<span style="color:#75715e">// GreetingRequest collects the request parameters for the Greeting method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">GreetingRequest</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;name,omitempty&#34;`</span>
}

<span style="color:#75715e">// GreetingResponse collects the response values for the Greeting method.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">GreetingResponse</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Greeting</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;greeting,omitempty&#34;`</span>
}

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">errorResponse</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Error</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;error&#34;`</span>
}
</code></pre></div><p>如上所示，该代码段类似于Go Kit。主要区别在于应返回的接口类型：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greetertransport</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;context&#34;</span>

	<span style="color:#e6db74">&#34;github.com/NYTimes/gizmo/server&#34;</span>
	<span style="color:#e6db74">&#34;google.golang.org/grpc&#34;</span>

	<span style="color:#e6db74">&#34;errors&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>

	<span style="color:#e6db74">&#34;github.com/NYTimes/gziphandler&#34;</span>
	<span style="color:#a6e22e">pb</span> <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/gizmo-greeter/pb&#34;</span>
	<span style="color:#e6db74">&#34;github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterendpoint&#34;</span>
	<span style="color:#e6db74">&#34;github.com/sirupsen/logrus&#34;</span>
)

<span style="color:#66d9ef">type</span> (
	<span style="color:#75715e">// TService will implement server.RPCService and handle all requests to the server.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">TService</span> <span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">Endpoints</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">Endpoints</span>
	}

	<span style="color:#75715e">// Config is a struct to contain all the needed
</span><span style="color:#75715e"></span>	<span style="color:#75715e">// configuration for our JSONService.
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">Config</span> <span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">Server</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">Config</span>
	}
)

<span style="color:#75715e">// NewTService will instantiate a RPCService with the given configuration.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewTService</span>(<span style="color:#a6e22e">cfg</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Config</span>, <span style="color:#a6e22e">endpoints</span> <span style="color:#a6e22e">greeterendpoint</span>.<span style="color:#a6e22e">Endpoints</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">TService</span>{<span style="color:#a6e22e">Endpoints</span>: <span style="color:#a6e22e">endpoints</span>}
}

<span style="color:#75715e">// Prefix returns the string prefix used for all endpoints within this service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">Prefix</span>() <span style="color:#66d9ef">string</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;&#34;</span>
}

<span style="color:#75715e">// Service provides the TService with a description of the service to serve and
</span><span style="color:#75715e">// the implementation.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">Service</span>() (<span style="color:#f92672">*</span><span style="color:#a6e22e">grpc</span>.<span style="color:#a6e22e">ServiceDesc</span>, <span style="color:#66d9ef">interface</span>{}) {
	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">Greeter_serviceDesc</span>, <span style="color:#a6e22e">s</span>
}

<span style="color:#75715e">// Middleware provides an http.Handler hook wrapped around all requests.
</span><span style="color:#75715e">// In this implementation, we&#39;re using a GzipHandler middleware to
</span><span style="color:#75715e">// compress our responses.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">Middleware</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span>) <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handler</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">gziphandler</span>.<span style="color:#a6e22e">GzipHandler</span>(<span style="color:#a6e22e">h</span>)
}

<span style="color:#75715e">// ContextMiddleware provides a server.ContextHAndler hook wrapped around all
</span><span style="color:#75715e">// requests. This could be handy if you need to decorate the request context.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">ContextMiddleware</span>(<span style="color:#a6e22e">h</span> <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ContextHandler</span>) <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ContextHandler</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">h</span>
}

<span style="color:#75715e">// JSONMiddleware provides a JSONEndpoint hook wrapped around all requests.
</span><span style="color:#75715e">// In this implementation, we&#39;re using it to provide application logging and to check errors
</span><span style="color:#75715e">// and provide generic responses.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">JSONMiddleware</span>(<span style="color:#a6e22e">j</span> <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>) <span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span> {
	<span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">context</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Request</span>) (<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">interface</span>{}, <span style="color:#66d9ef">error</span>) {

		<span style="color:#a6e22e">status</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">j</span>(<span style="color:#a6e22e">ctx</span>, <span style="color:#a6e22e">r</span>)
		<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
			<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">LogWithFields</span>(<span style="color:#a6e22e">r</span>).<span style="color:#a6e22e">WithFields</span>(<span style="color:#a6e22e">logrus</span>.<span style="color:#a6e22e">Fields</span>{
				<span style="color:#e6db74">&#34;error&#34;</span>: <span style="color:#a6e22e">err</span>,
			}).<span style="color:#a6e22e">Error</span>(<span style="color:#e6db74">&#34;problems with serving request&#34;</span>)
			<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">StatusServiceUnavailable</span>, <span style="color:#66d9ef">nil</span>, <span style="color:#a6e22e">errors</span>.<span style="color:#a6e22e">New</span>(<span style="color:#e6db74">&#34;sorry, this service is unavailable&#34;</span>)
		}

		<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">LogWithFields</span>(<span style="color:#a6e22e">r</span>).<span style="color:#a6e22e">Info</span>(<span style="color:#e6db74">&#34;success!&#34;</span>)
		<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">status</span>, <span style="color:#a6e22e">res</span>, <span style="color:#66d9ef">nil</span>
	}
}

<span style="color:#75715e">// ContextEndpoints may be needed if your server has any non-RPC-able
</span><span style="color:#75715e">// endpoints. In this case, we have none but still need this method to
</span><span style="color:#75715e">// satisfy the server.RPCService interface.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">ContextEndpoints</span>() <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ContextHandlerFunc</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">ContextHandlerFunc</span>{}
}

<span style="color:#75715e">// JSONEndpoints is a listing of all endpoints available in the TService.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">JSONEndpoints</span>() <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span> {
    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>{
        <span style="color:#e6db74">&#34;/health&#34;</span>: <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>{
            <span style="color:#e6db74">&#34;GET&#34;</span>: <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Endpoints</span>.<span style="color:#a6e22e">HealthEndpoint</span>,
        },
        <span style="color:#e6db74">&#34;/greeting&#34;</span>: <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#a6e22e">server</span>.<span style="color:#a6e22e">JSONContextEndpoint</span>{
            <span style="color:#e6db74">&#34;GET&#34;</span>: <span style="color:#a6e22e">s</span>.<span style="color:#a6e22e">Endpoints</span>.<span style="color:#a6e22e">GreetingEndpoint</span>,
        },
    }
}
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#f92672">package</span> <span style="color:#a6e22e">greetertransport</span>

<span style="color:#f92672">import</span> (
	<span style="color:#a6e22e">pb</span> <span style="color:#e6db74">&#34;github.com/antklim/go-microservices/gizmo-greeter/pb&#34;</span>
	<span style="color:#a6e22e">ocontext</span> <span style="color:#e6db74">&#34;golang.org/x/net/context&#34;</span>
)

<span style="color:#75715e">// Greeting implementation of the gRPC service.
</span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">s</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">TService</span>) <span style="color:#a6e22e">Greeting</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">ocontext</span>.<span style="color:#a6e22e">Context</span>, <span style="color:#a6e22e">r</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingRequest</span>) (<span style="color:#f92672">*</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>, <span style="color:#66d9ef">error</span>) {
	<span style="color:#66d9ef">return</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">pb</span>.<span style="color:#a6e22e">GreetingResponse</span>{<span style="color:#a6e22e">Greeting</span>: <span style="color:#e6db74">&#34;Hola Gizmo RPC &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Name</span>}, <span style="color:#66d9ef">nil</span>
}
</code></pre></div><p>Go Kit和Gizmo之间的明显区别在于传输方式。 Gizmo提供了几种可以利用的服务类型。要做的就是将HTTP路径映射到端点定义。低级HTTP请求/响应处理由Gizmo处理。</p>
<h2 id="总结">总结</h2>
<p>Go Micro是启动微服务系统的最快方法。框架提供了许多功能。因此，无需重新发明轮子。但是，这种舒适性和速度会牺牲灵活性。更改或更新系统部件并不像Go Kit那样容易。并且将gRPC强制为一等的通信类型。</p>
<p>可能需要一些时间来熟悉Go Kit。它需要具备Go语言特性的丰富知识和软件架构方面的经验。另一方面，没有框架限制。所有部件均可独立更改和更新。</p>
<p>Gizmo位于Go Micro和Go Kit之间。它提供了一些更高级别的抽象，例如Service包。但是缺少文档和示例，这意味着不得不通读源代码以了解不同服务类型的工作方式。使用Gizmo比使用Go Kit容易。但是它不像Go Micro那样流畅。</p>

        </section>
      </div>
    </div>
  </div>  
  <div class="container">
    <div class="columns">
      <div class="column has-text-right is-family-monospace is-centered-tablet-portrait">
        上次修改:&nbsp;14 April 2020</div>
    </div>
  </div></section>
<footer class="footer footer-dark">
  <div class="container">
    <div class="columns">
      <div class="column">
        <img src="/footer.svg" alt="">
        
      </div>
      
    <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Website</h3>
          </div>
          <ul class="link-list"><li>
              <a href="/"><span class="icon"><i class="fa fa-home"></i></span> 主页</a>
            </li><li></li>
            <li><a href="/tags/">
                <span class="icon"><i class="fa fa-tag"></i></span> 
                所有类别
              </a></li>
          </ul>
        </div>
      </div>
    
      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Contacts</h3>
          </div>
          <ul class="link-list">
            
            
            <li>
              <a href="https://github.com/Promacanthus" target="_blank">
                <span class="icon"><i class="fa fa-github"></i></span>
                
                  Github
                
              </a>
            </li>
                         
            
            <li>
              <a href="mailto:promacanthus@gmail.com" target="_blank">
                <span class="icon"><i class="fa fa-envelope"></i></span>
                
                  Gmail
                
              </a>
            </li>
            
                   
                   
                   
          </ul>
        </div>
      </div>
      

      
      <div class="column">
        <div class="footer-column">
          <div class="footer-header">
              <h3>Copyright</h3>
          </div>
          <ul class="link-list">
            <li>
              <a>
                <span class="icon"><i class="fa fa-copyright"></i></span>
                promacanthus - 2020
              </a>
            </li>
          </ul>
        </div>
      </div>
      

    </div>
  </div>
</footer>
    <div id="backtotop"><a href="#"></a></div><div class="sidebar">
  <div class="sidebar-header"><img src="/sidebar.svg" alt="">
    
    <a class="sidebar-close" href="javascript:void(0);">
      <i data-feather="x"></i>
    </a>
  </div>
  <div class="inner">
    <ul class="sidebar-menu">
      <li class="no-children"><a href="/tags/"><div class="columns">
              <table width="100%">  
                <tr>
                  <td class="">
                    <span class="icon"><i class="fa fa-cubes"></i></span>
                    所有类别
                  </td>
                  <td class="has-text-right" >
                      
                  </td>
                </tr>
              </table>
            </div>
          </a>
      <li class="no-children">
          <a href="/tags/">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>开发框架</td>
                    <td class="has-text-right" >
                        <div class="tag-number">316</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/go%e8%af%ad%e8%a8%80">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Go语言</td>
                    <td class="has-text-right" >
                        <div class="tag-number">115</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e4%ba%91%e5%8e%9f%e7%94%9f">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>云原生</td>
                    <td class="has-text-right" >
                        <div class="tag-number">114</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e6%a0%b7%e4%be%8b%e4%bb%a3%e7%a0%81">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>样例代码</td>
                    <td class="has-text-right" >
                        <div class="tag-number">73</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/kubernetes">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Kubernetes</td>
                    <td class="has-text-right" >
                        <div class="tag-number">53</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%bc%80%e5%8f%91%e6%a1%86%e6%9e%b6">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>开发框架</td>
                    <td class="has-text-right" >
                        <div class="tag-number">37</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/docker">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Docker</td>
                    <td class="has-text-right" >
                        <div class="tag-number">33</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%9f%ba%e7%a1%80">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>基础</td>
                    <td class="has-text-right" >
                        <div class="tag-number">30</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%a1%ab%e5%9d%91%e8%ae%b0">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>填坑记</td>
                    <td class="has-text-right" >
                        <div class="tag-number">20</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/helm">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Helm</td>
                    <td class="has-text-right" >
                        <div class="tag-number">17</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%be%ae%e6%9c%8d%e5%8a%a1">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>微服务</td>
                    <td class="has-text-right" >
                        <div class="tag-number">15</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e9%9b%86%e6%88%90%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>集成开发环境</td>
                    <td class="has-text-right" >
                        <div class="tag-number">14</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/vscode">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>VSCode</td>
                    <td class="has-text-right" >
                        <div class="tag-number">13</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/03-%e5%ae%b9%e5%99%a8%e7%bc%96%e6%8e%92">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>03-容器编排</td>
                    <td class="has-text-right" >
                        <div class="tag-number">12</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/go-kit">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Go-kit</td>
                    <td class="has-text-right" >
                        <div class="tag-number">12</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e6%a0%87%e5%87%86%e5%ba%93">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>标准库</td>
                    <td class="has-text-right" >
                        <div class="tag-number">11</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/grpc">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>gRPC</td>
                    <td class="has-text-right" >
                        <div class="tag-number">10</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/protocol-buffers">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Protocol-Buffers</td>
                    <td class="has-text-right" >
                        <div class="tag-number">9</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/examples">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Examples</td>
                    <td class="has-text-right" >
                        <div class="tag-number">8</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/05-%e5%ae%b9%e5%99%a8%e7%bd%91%e7%bb%9c">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>05-容器网络</td>
                    <td class="has-text-right" >
                        <div class="tag-number">7</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/09-dashboard">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>09-Dashboard</td>
                    <td class="has-text-right" >
                        <div class="tag-number">7</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/10-%e7%ac%94%e8%ae%b0">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>10-笔记</td>
                    <td class="has-text-right" >
                        <div class="tag-number">7</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%b8%b8%e7%94%a8%e5%b7%a5%e5%85%b7">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>常用工具</td>
                    <td class="has-text-right" >
                        <div class="tag-number">7</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%be%ae%e6%9c%8d%e5%8a%a1%e4%b8%9a%e5%8a%a1">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>微服务业务</td>
                    <td class="has-text-right" >
                        <div class="tag-number">7</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/git">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Git</td>
                    <td class="has-text-right" >
                        <div class="tag-number">6</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/mysql">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>MySQL</td>
                    <td class="has-text-right" >
                        <div class="tag-number">6</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/registry">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Registry</td>
                    <td class="has-text-right" >
                        <div class="tag-number">6</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%bc%80%e5%8f%91%e7%8e%af%e5%a2%83%e9%85%8d%e7%bd%ae">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>开发环境配置</td>
                    <td class="has-text-right" >
                        <div class="tag-number">6</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/01-%e5%ae%b9%e5%99%a8%e6%8a%80%e6%9c%af">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>01-容器技术</td>
                    <td class="has-text-right" >
                        <div class="tag-number">5</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/golang">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Golang</td>
                    <td class="has-text-right" >
                        <div class="tag-number">5</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/traefik">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Traefik</td>
                    <td class="has-text-right" >
                        <div class="tag-number">5</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%8e%9f%e7%90%86">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>原理</td>
                    <td class="has-text-right" >
                        <div class="tag-number">5</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/dockerfile-guide">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Dockerfile-Guide</td>
                    <td class="has-text-right" >
                        <div class="tag-number">4</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%ae%98%e6%96%b9%e5%ba%93">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>官方库</td>
                    <td class="has-text-right" >
                        <div class="tag-number">4</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e9%a2%86%e5%9f%9f%e9%a9%b1%e5%8a%a8%e8%ae%be%e8%ae%a1">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>领域驱动设计</td>
                    <td class="has-text-right" >
                        <div class="tag-number">4</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/06-%e4%bd%9c%e4%b8%9a%e8%b0%83%e5%ba%a6%e4%b8%8e%e8%b5%84%e6%ba%90%e7%ae%a1%e7%90%86">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>06-作业调度与资源管理</td>
                    <td class="has-text-right" >
                        <div class="tag-number">3</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/go-web">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Go-Web</td>
                    <td class="has-text-right" >
                        <div class="tag-number">3</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/http">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>HTTP</td>
                    <td class="has-text-right" >
                        <div class="tag-number">3</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-net">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-net</td>
                    <td class="has-text-right" >
                        <div class="tag-number">3</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%be%ae%e6%9c%8d%e5%8a%a1%e5%b9%b3%e5%8f%b0">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>微服务平台</td>
                    <td class="has-text-right" >
                        <div class="tag-number">3</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/02-%e9%9b%86%e7%be%a4%e6%90%ad%e5%bb%ba">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>02-集群搭建</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/08-%e7%9b%91%e6%8e%a7%e4%b8%8e%e6%97%a5%e5%bf%97">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>08-监控与日志</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/apimachinery">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>apimachinery</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/etcd">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Etcd</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/init-system">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>init-system</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/kit">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>kit</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/pkg">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>pkg</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/service-mesh">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Service-mesh</td>
                    <td class="has-text-right" >
                        <div class="tag-number">2</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/04-%e6%8c%81%e4%b9%85%e5%8c%96%e5%ad%98%e5%82%a8">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>04-持久化存储</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/07-%e5%ae%b9%e5%99%a8%e8%bf%90%e8%a1%8c%e6%97%b6">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>07-容器运行时</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/goland">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Goland</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/ingress">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Ingress</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/nginx-ingress">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>nginx-ingress</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-io">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-io</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-log">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-log</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-os">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-os</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-syscall">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-syscall</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/package-text">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>package-text</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/proxy">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Proxy</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/runtime">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>runtime</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/skopeo">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>Skopeo</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/transport">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>transport</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/webassembly">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>WebAssembly</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e4%ba%a7%e5%93%81%e6%89%8b%e5%86%8c">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>产品手册</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%85%b3%e4%ba%8e">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>关于</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e5%ae%98%e6%96%b9%e6%96%87%e7%ab%a0">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>官方文章</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li>
      <li class="no-children">
          <a href="/tags/%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f">
            <div class="columns">
              
              <table width="100%">  
                  <tr>
                    <td class=""><span class="icon"><i class="fa fa-cube"></i></span>正则表达式</td>
                    <td class="has-text-right" >
                        <div class="tag-number">1</div>
                      
                    </td>
                    
                  </tr>
              </table>
              
            </div>
          </a>
      </li></ul>
  </div>
</div>
<script src="/js/jquery-2.2.4.893e90f6230962e42231635df650f20544ad22affc3ee396df768eaa6bc5a6a2.js" integrity="sha256-iT6Q9iMJYuQiMWNd9lDyBUStIq/8PuOW33aOqmvFpqI="></script>
<script src="/js/feather.4.22.0.1ab07abeb9975f283f6b5f29451981be680fbf77ea778f991d457511d210476a.js" integrity="sha256-GrB6vrmXXyg/a18pRRmBvmgPv3fqd4&#43;ZHUV1EdIQR2o="></script>
<script src="/js/modernizr-3.6.0.e013a1e54e3c19d83537ba42b900d34451e5e4b2e789be27a02ac9b152edb741.js" integrity="sha256-4BOh5U48Gdg1N7pCuQDTRFHl5LLnib4noCrJsVLtt0E="></script>
<script src="/js/refresh.f6a5a7cd6b7a72867ff68f6ab208dd115915f6bd3a2269803d3f1835373ad619.js" integrity="sha256-9qWnzWt6coZ/9o9qsgjdEVkV9r06ImmAPT8YNTc61hk="></script>

<script>
  window.MathJax = {
    loader: {
      load: ['core', 'input/tex-base', 'output/chtml'],  
      source: {
        'core': '\/js\/mathjax\/core.d48fedf25c74c54fa6bf79646de92b02155872bdc4f5f7d0bbfc662523d8b4f5.js',
        'input/tex-base': '\/js\/mathjax\/tex-base.1b68b8741dfc54e8f7222f88bea8ffcfc57ac54b2a2d8f4edf6800aa44d49441.js',
        'output/chtml': '\/js\/mathjax\/chtml.926cd166e0f8c1f8a566a718d60c9c58a2b7142b156d30d5f02cec7c3b0ad60a.js',
        'output/chtml/fonts/tex': '\/js\/mathjax\/tex_out.b8b2bb939c0dae84bf1390bfe6d32af13e83f647cdac01d544d2a7a517477e9d.js'
      },
    },
    chtml: {
      fontURL: '/fonts' 
    },
  };
</script>

<script src="/js/mathjax/startup.234a2513e6bdbc1eee06ca19abceca30fe4034e82afb373c08274c1ba2feb1a6.js" integrity="sha256-I0olE&#43;a9vB7uBsoZq87KMP5ANOgq&#43;zc8CCdMG6L&#43;saY="></script>
<script src="/js/highlight.9.18.1.b1c58829c55afcc1f568022af4b08ed8976da404d2990b7535bd8e19c0e3310c.js" integrity="sha256-scWIKcVa/MH1aAIq9LCO2JdtpATSmQt1Nb2OGcDjMQw="></script>
<script src="/js/highlightjs-line-numbers.2.7.0.min.ddfe282e07b7ec1ed069c23f92c7c8216ddb3f1879c4e962d37fd52adbd15a05.js" integrity="sha256-3f4oLge37B7QacI/ksfIIW3bPxh5xOli03/VKtvRWgU="></script>

<script>
  hljs.initHighlightingOnLoad();
  hljs.initLineNumbersOnLoad();
  document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('.codeinline').forEach((block) => {
      hljs.highlightBlock(block);
    });
  });
</script>

</body>
</html>