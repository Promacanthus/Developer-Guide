# package templage

```go
import "text/template"
```

templage包实现数据驱动的模板以生成文本输出。

要生成HTML输出，请查看`html/template`包，该软件包具有与此软件包相同的接口，但会自动保护HTML输出免受某些攻击。

Templates通过将模板应用于数据结构来运行。 模板中的注释指的是数据结构的元素（通常是结构体的字段或map中的键），以控制执行并派生要显示的值。 模板执行引擎将遍历结构并设置光标（以句点`“.”`表示）到结构中当前位置的值。

模板的输入文本是UTF-8编码的任何格式的文本。 

- 动作：数据评估或控制
- 结构：以`“ {{”`和`“}}”`界定

所有动作之外的文本将原样复制到输出中。 除了`raw string`，动作可能不会跨越换行符，尽管注释可以。

一旦开始解析，可以并行安全地执行模板，如果并行执行共享一个Writer，则输出可以交错。

这是一个简单的示例，输出“ 17 items are made of wool ”。

```go
type Inventory struct {
    Material string
    Count    uint
}

sweaters := Inventory{"wool", 17}
tmpl, err := template.New("test").Parse("{{.Count}} items are made of {{.Material}}")
if err != nil { panic(err) }
err = tmpl.Execute(os.Stdout, sweaters)
if err != nil { panic(err) }
```

下面展示更多复杂的示例。

## 文字和空格

默认情况下，执行模板时，将逐个复制动作之间的所有文本。例如，在上面的示例中，运行程序时，字符串`“ items made of ”`显示在标准输出上。

但是，为帮助格式化模板源代码，如果操作的左定界符（默认为`“{{”`）后紧跟一个减号和ASCII空格字符（`“{{- ”`），则会紧接在前的文本。 同样，如果右定界符（`“}}”`）前面有一个空格和减号（`“ -}}”`），则所有紧随其后的空格都将修剪掉。 在这些修饰标记中，必须存在ASCII空格； `“{{-3}}”`解析为包含数字-3的动作。

例如，执行以下模板：

```go
"{{23 -}} < {{- 45}}"
// 生成的输出
"23<45"
```

对于此修剪操作，空格字符的定义与Go中的相同：空格，水平制表符，回车符和换行符。

## 动作

这是动作列表，“参数”和“管道”是对数据的评估，将在随后的相应部分中详细定义。

```go
{{/* a comment */}}
{{- /* a comment with white space trimmed from preceding and following text */ -}}
一条注释可能包含换行符。注释不嵌套，但是必须像这里一样以界定符开头和结尾。

{{pipeline}}
管道值的默认的文字表示形式（和fmt.Print输出的一样）被复制到输出中。

{{if pipeline}} T1 {{end}}
如果管道的值为空，则不生成任何输出，否则执行T1。
空值是false，0，任何为nil的指针或者接口，任何长度为0的数组、切片、字典或字符串。
点不受影响。

{{if pipeline}} T1 {{else}} T0 {{end}}
如果管道的值为空，则执行T0，否则执行T1。点不受影响。

{{if pipeline}} T1 {{else if pipeline}} T0 {{end}}
为了简化if-else链的外观，上面的例子和下面写的效果是一样的。
        {{if pipeline}} T1 {{else}}{{if pipeline}} T0 {{end}}{{end}}

{{range pipeline}} T1 {{end}}
管道的值必须是数组，切片，字典或通道。 如果管道的值的长度为零，则不输出任何内容。
否则，将点设置为数组，切片或字典的连续元素，然后执行T1。
如果值是字典，并且键是具有定义顺序（“可比较”）的基本类型，则将按排序的键顺序访问元素。

{{range pipeline}} T1 {{else}} T0 {{end}}
管道的值必须是数组，切片，字典或通道。 如果管道的长度为零，则点不受影响并执行T0；
否则，将点设置为数组，切片或字典的连续元素，然后执行T1。

{{template "name"}}
指定名称的模板将使用nil数据执行。

{{template "name" pipeline}}
指定名称的模板通过点设置执行管道的值。

{{block "name" pipeline}} T1 {{end}}
块是定义模板的简写
        {{define "name"}} T1 {{end}}
然后执行它
        {{template "name" pipeline}}
通常的用途是定义一组根模板， 然后通过重新定义其中的块模板进行自定义。

{{with pipeline}} T1 {{end}}
如果管道的值为空，则不生成任何输出。 否则，将点设置为管道的值，并且T1被执行。

{{with pipeline}} T1 {{else}} T0 {{end}}
如果管道的值为空，则点不受影响并且T0 被执行;否则，将点设置为管道的值然后执行T1。
```

## 参数

参数是一个简单值，由以下之一表示。

- Go语法中的布尔值，字符串，字符，整数，浮点数，虚数或复数常量。 它们的行为就像Go的未类型化常量。 请注意，与Go中一样，大整数常量在赋值或传递给函数时是否溢出取决于主机的int是32位还是64位。
- 关键字nil，代表无类型的Go nil。
- 字符`'.'`，结果是点的值。
- 变量名称，它是一个字母数字字符串（可能为空），前面加一个美元符号，例如`$piOver2`或者`$`结果是变量的值。
- 数据字段的名称（必须是结构体），例如：`.Field`，结果是该字段的值，字段的调用可能是链式的：` .Field1.Field2`，还可以对变量进行评估包括链接：`$x.Field1.Field2`