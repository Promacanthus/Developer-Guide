---
title: "预声明函数"
date: 2020-04-29T12:33:24+08:00
draft: true
---

|函数|描述|
|---|---|
|make||
|len||
|cap||
|new|创建变量|
|append||
|copy||
|close||
|delete||
|complex||
|real||
|imag||
|panic||
|recover||

## new

使用内置函数new创建变量。表达式`new(T)`创建一个未命名的`T`类型变量，初始化为`T`类型的零值，并返回其**地址**（地址类型为`*T`）。

```go
p := new(int)   // *int 类型的p，指向未命名的int变量
fmt.Println(*p) // 输出 0
*p = 2          // 把未命名的int设置为2
fmt.Println(*p) // 输出 2
```

使用`new`创建的变量和取其地址的普通局部变量没有什么不同。只是不需要引入和声明一个虚拟的名字，通过`new(T)`直接在表达式中使用。

**`new`只是语法上的便利，不是一个基础概念**。

```go
func newInt() *int {
    return new(int)
}

func newInt() *int {
    var dump int
    return &dump
}

// 这两个函数有相同的行为
```

**每一次调用`new`返回一个具有唯一地址的不同变量**。

```go
p := new(int)
q := new(int)
fmt.Println(p == q) // 输出 false
```

> 上述规则的例外情况：**两个变量的类型不携带任何信息且是零值**，例如`struct{}`或`[0]int`，当前的实现中它们有相同的地址。

因为常见的未命名变量都是结构体类型，所以`new`函数使用的相对较少。

`new`是一个预声明的函数，不是一个关键字，可以被重定义为另外的其他类型。
