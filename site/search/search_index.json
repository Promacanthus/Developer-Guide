{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to Golang-Guide Golang related ecology. Golang basic concepts Golang common tools Golang test tools Golang microservices development framework Remote Procedure Call","title":"Welcome to Golang-Guide"},{"location":"#welcome-to-golang-guide","text":"Golang related ecology. Golang basic concepts Golang common tools Golang test tools Golang microservices development framework Remote Procedure Call","title":"Welcome to Golang-Guide"},{"location":"Frameworks/\u5e38\u7528\u6846\u67b6/","text":"\u6846\u67b6 \u7c7b\u578b \u540d\u79f0 \u94fe\u63a5 Web\u6846\u67b6 gin https://gin-gonic.com/ \u8def\u7531 httprouter https://github.com/julienschmidt/httprouter websocket websocket https://github.com/gorilla/websocket \u5fae\u670d\u52a1 go-kit https://gokit.io/ RPC gRPC-go https://grpc.io/ \u6570\u636e\u5e93 gorm https://gorm.io/ config viper https://github.com/spf13/viper \u547d\u4ee4\u884c cobra https://github.com/spf13/cobra","title":"\u6846\u67b6"},{"location":"Frameworks/\u5e38\u7528\u6846\u67b6/#_1","text":"\u7c7b\u578b \u540d\u79f0 \u94fe\u63a5 Web\u6846\u67b6 gin https://gin-gonic.com/ \u8def\u7531 httprouter https://github.com/julienschmidt/httprouter websocket websocket https://github.com/gorilla/websocket \u5fae\u670d\u52a1 go-kit https://gokit.io/ RPC gRPC-go https://grpc.io/ \u6570\u636e\u5e93 gorm https://gorm.io/ config viper https://github.com/spf13/viper \u547d\u4ee4\u884c cobra https://github.com/spf13/cobra","title":"\u6846\u67b6"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/","text":"Microservices in Go Medium\u539f\u6587 \u70b9\u8fd9\u91cc\u3002 \u5bf9\u4ee5\u4e0b\u56db\u4e2a\u6846\u67b6\u8fdb\u884c\u6bd4\u8f83\uff1a Go Micro Go Kit Gizmo Kite \u6846\u67b6\u4ecb\u7ecd Go Micro \u6700\u53d7\u6b22\u8fce\u7684\u6846\u67b6\u53ea\u4e00\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u7684\u535a\u5ba2\u3001\u6587\u7ae0\uff0c\u8fd8\u6709\u5f88\u591a\u4f7f\u7528\u793a\u4f8b\u3002\u53ef\u4ee5\u5728Medium\u4e0a\u5173\u6ce8 microhq \uff0c\u6765\u83b7\u5f97Go Micro\u4e2d\u7684\u6700\u65b0\u66f4\u65b0\u3002 Go Micro\u662f\u4f7f\u7528Go\u8bed\u8a00\u7f16\u5199\u5fae\u670d\u52a1\u7684\u53ef\u63d2\u62d4RPC\u6846\u67b6\uff0c\u5b83\u5f00\u7bb1\u5373\u7528\uff0c\u6709\u5982\u4e0b\u529f\u80fd\uff1a \u670d\u52a1\u53d1\u73b0\uff1a\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c \u8d1f\u8f7d\u5747\u8861\uff1a\u5ba2\u6237\u7aef\u4fa7\u8d1f\u8f7d\u5747\u8861\uff0c\u7528\u4e8e\u5e73\u8861\u670d\u52a1\u5b9e\u4f8b\u4e4b\u95f4\u7684\u8bf7\u6c42 \u540c\u6b65\u901a\u4fe1\uff1a\u4f20\u8f93\u5c42\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94 \u5f02\u6b65\u901a\u4fe1\uff1a\u5185\u7f6e\u53d1\u5e03\u8ba2\u9605\u529f\u80fd \u6d88\u606f\u7f16\u7801\uff1a\u57fa\u4e8e\u6d88\u606f\u7684 Content-Type \u6807\u5934\u7684\u7f16\u7801/\u89e3\u7801 RPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5305\uff1a\u5229\u7528\u4e0a\u8ff0\u529f\u80fd\u5e76\u66b4\u9732\u63a5\u53e3\u4ee5\u6784\u5efa\u5fae\u670d\u52a1 Go Micro\u67b6\u6784\u53ef\u4ee5\u63cf\u8ff0\u4e3a\u5982\u4e0b\u6240\u793a\u7684\u4e09\u5c42\u5806\u6808\uff1a \u9876\u5c42\u7531\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u6a21\u578b\u548c\u670d\u52a1\u62bd\u8c61\u7ec4\u6210\u3002\u670d\u52a1\u5668(Server)\u662f\u7528\u4e8e\u7f16\u5199\u670d\u52a1\u7684\u6784\u5efa\u5757\uff0c\u5ba2\u6237\u7aef(Client)\u63d0\u4f9b\u4e86\u5411\u670d\u52a1\u8bf7\u6c42\u7684\u63a5\u53e3\u3002 \u5e95\u5c42\u7531\u4ee5\u4e0b\u7c7b\u578b\u7684\u63d2\u4ef6\u7ec4\u6210\uff1a \u4ee3\u7406\uff1a\u4e3a\u5f02\u6b65\u53d1\u5e03/\u8ba2\u9605\u901a\u4fe1\u63d0\u4f9b\u6d88\u606f\u4ee3\u7406\u7684\u63a5\u53e3 \u7f16\u89e3\u7801\u5668\uff1a\u7528\u4e8e\u7f16\u7801/\u89e3\u7801\u6d88\u606f\uff0c\u652f\u6301\u7684\u683c\u5f0f\u5305\u62ec json \uff0c bson \uff0c protobuf \uff0c msgpack \u7b49 \u6ce8\u518c\u4e2d\u5fc3\uff1a\u63d0\u4f9b\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff08\u9ed8\u8ba4\u4e3a Consul \uff09 \u9009\u62e9\u5668\uff1a\u5efa\u7acb\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u7684\u8d1f\u8f7d\u5747\u8861\u62bd\u8c61\uff0c\u5141\u8bb8\u4f7f\u7528\u8bf8\u5982\u968f\u673a\uff0c\u8f6e\u5faa\uff0c\u6700\u5c11\u8fde\u63a5\u7b49\u7b97\u6cd5\u6765\u201c\u9009\u62e9\u201d\u670d\u52a1 \u4f20\u8f93\uff1a\u670d\u52a1\u4e4b\u95f4\u540c\u6b65\u8bf7\u6c42/\u54cd\u5e94\u901a\u4fe1\u7684\u63a5\u53e3 Go Micro\u8fd8\u63d0\u4f9b\u4e86Sidecar\u7b49\u529f\u80fd\u3002\u8fd9\u5c31\u53ef\u4ee5\u4f7f\u7528\u4ee5Go\u4ee5\u5916\u7684\u8bed\u8a00\u7f16\u5199\u7684\u670d\u52a1\u3002Sidecar\u63d0\u4f9b\u670d\u52a1\u6ce8\u518c\uff0cgRPC\u7f16\u7801/\u89e3\u7801\u548cHTTP\u5904\u7406\u7a0b\u5e8f\u3002\u5b83\u652f\u6301\u591a\u79cd\u8bed\u8a00\u3002 Go Kit Go Kit\u662f\u7528\u4e8e\u5728Go\u4e2d\u6784\u5efa\u5fae\u670d\u52a1\u7684\u7f16\u7a0b\u5de5\u5177\u5305\u3002\u4e0eGo Micro\u4e0d\u540c\uff0c\u5b83\u662f\u4e00\u4e2a\u65e8\u5728\u5bfc\u5165\u4e8c\u8fdb\u5236\u8f6f\u4ef6\u5305\u7684\u5e93\u3002Go Kit\u9075\u5faa\u7b80\u5355\u539f\u5219\uff0c\u4f8b\u5982\uff1a \u6ca1\u6709\u5168\u5c40\u72b6\u6001 \u58f0\u660e\u5f0f\u7ec4\u6210 \u663e\u5f0f\u4f9d\u8d56 \u5408\u7ea6\u5f0f\u63a5\u53e3 \u9886\u57df\u9a71\u52a8\u8bbe\u8ba1 \u5728Go Kit\u4e2d\u53ef\u4ee5\u627e\u5230\u4ee5\u4e0b\u8f6f\u4ef6\u5305\uff1a \u8eab\u4efd\u9a8c\u8bc1\uff1a basic \u548c JWT \u6570\u636e\u4f20\u8f93\uff1aHTTP\u3001Nats\uff08\u5f00\u6e90\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff09\u3001gRPC\u7b49 \u65e5\u5fd7\u8bb0\u5f55\uff1a\u901a\u7528\u63a5\u53e3\u7528\u4e8e\u7ed3\u6784\u5316\u670d\u52a1\u7684\u65e5\u5fd7\u8bb0\u5f55 \u6307\u6807\u76d1\u63a7\uff1a CloudWatch \uff0c Statsd \uff0c Graphite \u7b49 \u94fe\u8def\u8ffd\u8e2a\uff1a Zipkin \u548c Opentracing \u670d\u52a1\u53d1\u73b0\uff1a Consul \u3001 Etcd \u3001 Eureka \u7b49 \u65ad\u8def\u5668\uff1a\u4f7f\u7528Go\u8bed\u8a00\u5b9e\u73b0\u7684 Hystrix Peter Bourgon\u7684\u6587\u7ae0\u548c\u6f14\u793a\u5e7b\u706f\u7247\u662f\u5bf9Go Kit\u6700\u597d\u7684\u63cf\u8ff0\u4e4b\u4e00\uff1a Go kit: Go in the modern enterprise Go + microservices \u5728\u201c Go + microservices\u201d\u5e7b\u706f\u7247\u4e2d\uff0c\u53ef\u4ee5\u627e\u5230\u4f7f\u7528Go Kit\u6784\u5efa\u7684\u670d\u52a1\u4f53\u7cfb\u7ed3\u6784\u7684\u793a\u4f8b\u3002\u4e3a\u4e86\u5feb\u901f\u53c2\u8003\uff0c\u670d\u52a1\u67b6\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a Gizmo Gizmo\u662f\u300a\u7ebd\u7ea6\u65f6\u62a5\u300b\u7684\u5fae\u670d\u52a1\u5de5\u5177\u5305\u3002\u5b83\u63d0\u4f9b\u4e86\u5c06\u670d\u52a1\u548c pubsub \u5b88\u62a4\u8fdb\u7a0b\u653e\u5728\u4e00\u8d77\u7684\u8f6f\u4ef6\u5305\u3002\u5b83\u516c\u5f00\u4e86\u4ee5\u4e0b\u8f6f\u4ef6\u5305\uff1a server \uff1a\u63d0\u4f9b\u4e24\u79cd\u670d\u52a1\u5b9e\u73b0\u65b9\u5f0f\uff1a \u7b80\u5355\u670d\u52a1\uff08\u57fa\u4e8eHTTP\uff09 RPC\u670d\u52a1\uff08\u57fa\u4e8egRPC\uff09 server/kit \uff1a\u57fa\u4e8eGo Kit\u7684\u5b9e\u9a8c\u6027\u8f6f\u4ef6\u5305 config \uff1a\u4ece\u4ee5\u4e0b\u4f4d\u7f6e\u83b7\u53d6\u914d\u7f6e\u53c2\u6570\u7684\u914d\u7f6e\u51fd\u6570\uff1a JSON\u6587\u4ef6\uff0c Consul k/v\u4e2d\u7684JSON blob \u73af\u5883\u53d8\u91cf pubsub \uff1a\u63d0\u4f9b\u7528\u4e8e\u53d1\u5e03\u548c\u8ba2\u9605\u961f\u5217\u4e2d\u6570\u636e\u7684\u901a\u7528\u63a5\u53e3 pubsub/pubsubtest \uff1a\u5305\u542b\u53d1\u5e03\u8005\u548c\u8ba2\u9605\u8005\u63a5\u53e3\u7684\u6d4b\u8bd5\u5b9e\u73b0 web \uff1a\u66b4\u9732\u7528\u4e8e\u4ece\u8bf7\u6c42\u67e5\u8be2\u548c\u6709\u6548\u8d1f\u8f7d\u4e2d\u89e3\u6790\u7c7b\u578b\u7684\u51fd\u6570 Pubsub \u8f6f\u4ef6\u5305\u63d0\u4f9b\u4e86\u4e0e\u4ee5\u4e0b\u961f\u5217\u4e00\u8d77\u4f7f\u7528\u7684\u63a5\u53e3\uff1a pubsub/aws \uff1aAmazon SNS/SQS pubsub/gcp \uff1aGoogle Pubsub. pubsub/kafka \uff1aKafka topics pubsub/http \uff1a publishing via HTTP \u56e0\u6b64\uff0c\u53ef\u4ee5\u8ba4\u4e3aGizmo\u4f4d\u4e8eGo Micro\u548cGo Kit\u4e4b\u95f4\u3002\u5b83\u4e0d\u662f\u50cfGo Micro\u8fd9\u6837\u7684\u5b8c\u6574\u201c\u9ed1\u7bb1\u201d\u3002\u540c\u65f6\uff0c\u5b83\u4e0d\u50cfGo Kit\u90a3\u6837\u539f\u59cb\u3002\u5b83\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7ea7\u522b\u7684\u6784\u5efa\u7ec4\u4ef6\uff0c\u4f8b\u5982config\u548cpubsub\u8f6f\u4ef6\u5305\u3002 Kite Kite\u662f\u7528\u4e8e\u5728Go\u4e2d\u5f00\u53d1\u5fae\u670d\u52a1\u7684\u6846\u67b6\u3002\u5b83\u516c\u5f00\u4e86RPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7a0b\u5e8f\u5305\u3002\u521b\u5efa\u7684\u670d\u52a1\u4f1a\u81ea\u52a8\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edfKontrol\u4e2d\u6ce8\u518c\u3002 Kontrol\u662f\u7528Kite\u7f16\u5199\u7684\uff0c\u5b83\u672c\u8eab\u5c31\u662fKite\u670d\u52a1\u3002\u8fd9\u610f\u5473\u7740Kite\u5fae\u670d\u52a1\u5728\u5176\u81ea\u5df1\u7684\u73af\u5883\u4e2d\u8fd0\u884c\u826f\u597d\u3002 \u5982\u679c\u9700\u8981\u5c06Kite\u5fae\u670d\u52a1\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\uff0c\u5219\u9700\u8981\u81ea\u5b9a\u4e49 \u3002\u8fd9\u662f\u4ece\u5217\u8868\u4e2d\u5220\u9664Kite\u5e76\u51b3\u5b9a\u4e0d\u5ba1\u67e5\u6b64\u6846\u67b6\u7684\u4e3b\u8981\u539f\u56e0\u3002 \u6846\u67b6\u5bf9\u6bd4 \u4f7f\u7528\u56db\u4e2a\u7c7b\u522b\u6765\u6bd4\u8f83\u6846\u67b6\uff1a \u76ee\u6807\u6bd4\u8f83\uff1a\u57fa\u4e8eGitHub\u7edf\u8ba1 \u6587\u6863\u548c\u793a\u4f8b \u7528\u6237\u548c\u793e\u533a \u4ee3\u7801\u8d28\u91cf Github\u7edf\u8ba1 \u65f6\u95f4\uff1a2019/10/28 Go Micro Go Kit Gizmo License Apache License 2.0 MIT Apache License 2.0 Created Jan 2015 Feb 2015 Dec 2015 Release 60 9 48 Author Asim Aslam Peter Bourgon JP Robinson Stars 9484 15190 2937 Open/Closed Issues 35/400 56/370 12/52 Last Update Oct 26, 2019 Oct 18, 2019 Oct 14, 2019 \u6587\u6863\u548c\u793a\u4f8b Go Micro\u548cGo kit \u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e3b\u9875\uff0c\u5176\u4e2d\u5305\u542b\u6b63\u5f0f\u7684\u6587\u6863\u548c\u793a\u4f8b\u3002Gizmo\u6846\u67b6\u6ca1\u6709\u63d0\u4f9b\u53ef\u9760\u7684\u6587\u6863\uff0c\u552f\u4e00\u7684\u6b63\u5f0f\u6587\u6863\u662f\u4ed3\u5e93\u4e2d\u7684README\u6587\u4ef6\u3002 \u6709\u5173Go Micro\u7684\u5927\u91cf\u4fe1\u606f\u548c\u516c\u544a\uff0c\u8bf7\u8bbf\u95ee micro.mu \uff0c microhq \u548c\u793e\u4ea4\u5a92\u4f53 @MicroHQ \u3002 \u5982\u679c\u4f7f\u7528Go Kit\uff0c\u6700\u597d\u7684\u6587\u6863\u53ef\u5728 Peter Bourgon\u535a\u5ba2 \u4e2d\u627e\u5230\u3002\u6211\u53d1\u73b0\u7684\u6700\u597d\u7684\u4f8b\u5b50\u4e4b\u4e00\u662f\u5728 ru-rocker\u535a\u5ba2 \u4e2d\u3002 \u4f7f\u7528Gizmo\uff0c\u6e90\u4ee3\u7801\u63d0\u4f9b\u4e86\u6700\u4f73\u7684\u6587\u6863\u548c\u793a\u4f8b\u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u5982\u679c\u60a8\u6765\u81eaNodeJS\u9886\u57df\uff0c\u5e76\u5e0c\u671b\u770b\u5230\u7c7b\u4f3cExpressJS\u7684\u6559\u7a0b\uff0c\u60a8\u5c06\u611f\u5230\u5931\u671b\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8fd9\u662f\u521b\u5efa\u81ea\u5df1\u7684\u6559\u7a0b\u7684\u7edd\u4f73\u673a\u4f1a\u3002 \u7528\u6237\u548c\u793e\u533a Go Kit\u662f\u6700\u6d41\u884c\u7684\u5fae\u670d\u52a1\u6846\u67b6\uff0c\u57fa\u4e8eGitHub\u7edf\u8ba1\u6570\u636e\uff0c\u5b83\u5df2\u8d85\u8fc71\u4e07\u4e94\u5343\u9897\u661f\u3002\u5b83\u6709\u5927\u91cf\u7684\u8d21\u732e\u8005\uff08161\uff09\u548c\u8d85\u8fc71600\u4e2a\u5206\u53c9\u3002\u6700\u540e\uff0cGo Kit\u53d7 DigitalOcean \u652f\u6301\u3002 \u62e5\u67099484\u9897\u661f\uff0c54\u4e2a\u8d21\u732e\u8005\u548c993\u4e2a\u5206\u53c9-Go Micro\u4f4d\u5c45\u7b2c\u4e8c\u3002 Sixt \u662fGo Micro\u7684\u6700\u5927\u8d5e\u52a9\u5546\u4e4b\u4e00\u3002 Gizmo\u7b2c\u4e09\u540d\u3002\u8d85\u8fc72937\u661f\uff0c41\u4e2a\u8d21\u732e\u8005\u548c188\u4e2a\u5206\u53c9\u3002\u7531\u300a\u7ebd\u7ea6\u65f6\u62a5\u300b\u652f\u6301\u548c\u521b\u5efa\u3002 \u4ee3\u7801\u8d28\u91cf Go Kit\u5728\u4ee3\u7801\u8d28\u91cf\u7c7b\u522b\u4e2d\u6392\u540d\u7b2c\u4e00\u3002\u5b83\u5177\u6709\u8fd180\uff05\u7684\u4ee3\u7801\u8986\u76d6\u7387\uff0c\u5e76\u4e14\u5177\u6709\u51fa\u8272\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002Gizmo\u4e5f\u5177\u6709\u51fa\u8272\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002\u4f46\u662f\u5b83\u7684\u4ee3\u7801\u8986\u76d6\u7387\u53ea\u670946\uff05\u3002Go Micro\u4e0d\u63d0\u4f9b\u8986\u76d6\u8303\u56f4\u4fe1\u606f\uff0c\u4f46\u786e\u5b9e\u5177\u6709\u5f88\u9ad8\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002 https://goreportcard.com/ \u4ee3\u7801\u8d28\u91cf\u8bc4\u7ea7\u7f51\u7ad9 \u7f16\u5199\u5fae\u670d\u52a1 \u4e3a\u4e86\u66f4\u597d\u5730\u4e86\u89e3\u6846\u67b6\uff0c\u521b\u5efa\u4e86\u4e09\u4e2a\u7b80\u5355\u7684\u5fae\u670d\u52a1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u8fd9\u4e9b\u670d\u52a1\u90fd\u5b9e\u73b0\u4e86\u4e00\u4e2a\u4e1a\u52a1\u903b\u8f91\uff1a\u6253\u62db\u547c\uff08greeting\uff09\uff0c\u5f53\u7528\u6237\u5411\u670d\u52a1\u4e2d\u8f93\u5165\u201c\u540d\u79f0\u201d\u53c2\u6570\u65f6\uff0c\u670d\u52a1\u4f1a\u53d1\u9001\u95ee\u5019\u8bed\u4f5c\u4e3a\u54cd\u5e94\u3002\u6240\u6709\u670d\u52a1\u90fd\u6ee1\u8db3\u4ee5\u4e0b\u9700\u6c42\uff1a \u670d\u52a1\u5e94\u81ea\u884c\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c \u670d\u52a1\u5e94\u5177\u6709\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7aef\u70b9 \u670d\u52a1\u5e94\u81f3\u5c11\u652f\u6301HTTP\u548cgRPC\u4f20\u8f93\u534f\u8bae \u5bf9\u4e8e\u559c\u6b22\u9605\u8bfb\u6e90\u4ee3\u7801\u7684\u4eba\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u8bbf\u95ee \u4ed3\u5e93 \u6e90\u4ee3\u7801\u3002 GomMicro greeter \u4f7f\u7528Go Micro\u521b\u5efa\u670d\u52a1\u6240\u9700\u8981\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u662f\u5b9a\u4e49protobuf\u63cf\u8ff0\u3002\u6240\u6709\u8fd9\u4e09\u79cd\u670d\u52a1\u90fd\u4f7f\u7528\u4e86\u76f8\u540c\u7684protobuf\u5b9a\u4e49\u3002\u521b\u5efa\u4e86\u4ee5\u4e0b\u670d\u52a1\u63cf\u8ff0\uff1a syntax = proto3 ; package pb; service Greeter { rpc Greeting(GreetingRequest) returns (GreetingResponse) {} } message GreetingRequest { string name = 1; } message GreetingResponse { string greeting = 2; } \u8fd9\u4e2a\u63a5\u53e3\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5Greeting\uff0c\u5b83\u6709\u4e00\u4e2a\u8bf7\u6c42\u53c2\u6570(name)\u548c\u4e00\u4e2a\u54cd\u5e94\u53c2\u6570(greeting) \u7136\u540e\u4f7f\u7528\u4fee\u6539\u540e\u7684protoc\u4eceprotobuf\u4e2d\u751f\u6210\u670d\u52a1\u63a5\u53e3\uff0c\u8be5 proto\u751f\u6210\u5668 \u662fGo Micro\u7684\u4e00\u4e2a\u5206\u53c9\uff0c\u5e76\u7ecf\u8fc7\u4fee\u6539\u4ee5\u652f\u6301\u8be5\u6846\u67b6\u7684\u67d0\u4e9b\u529f\u80fd\u3002\u5728\u6253\u62db\u547c\u670d\u52a1\u4e2d\u5c06\u6240\u6709\u8fd9\u4e9b\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u6b64\u65f6\uff0c\u670d\u52a1\u6b63\u5728\u542f\u52a8\u5e76\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c\uff0c\u5b83\u4ec5\u652f\u6301gRPC\u4f20\u8f93\u534f\u8bae\u3002 package main import ( log pb github.com/antklim/go-microservices/go-micro-greeter/pb github.com/micro/go-micro golang.org/x/net/context ) // Greeter implements greeter service. type Greeter struct{} // Greeting method implementation. func (g *Greeter) Greeting(ctx context.Context, in *pb.GreetingRequest, out *pb.GreetingResponse) error { out.Greeting = GO-MICRO Hello + in.Name return nil } func main() { service := micro.NewService( micro.Name( go-micro-srv-greeter ), micro.Version( latest ), ) service.Init() pb.RegisterGreeterHandler(service.Server(), new(Greeter)) if err := service.Run(); err != nil { log.Fatal(err) } } \u4e3a\u4e86\u652f\u6301HTTP\u4f20\u8f93\uff0c\u5fc5\u987b\u6dfb\u52a0\u5176\u4ed6\u6a21\u5757\u3002\u5b83\u5c06HTTP\u8bf7\u6c42\u6620\u5c04\u5230protobuf\u5b9a\u4e49\u7684\u8bf7\u6c42\uff0c\u5e76\u8c03\u7528gRPC\u670d\u52a1\u3002\u7136\u540e\uff0c\u5b83\u5c06\u670d\u52a1\u54cd\u5e94\u6620\u5c04\u5230HTTP\u54cd\u5e94\uff0c\u5e76\u5c06\u5176\u54cd\u5e94\u8fd4\u56de\u7ed9\u7528\u6237\u3002 package main import ( context encoding/json log net/http proto github.com/antklim/go-microservices/go-micro-greeter/pb github.com/micro/go-micro/client web github.com/micro/go-web ) func main() { service := web.NewService( web.Name( go-micro-web-greeter ), ) service.HandleFunc( /greeting , func(w http.ResponseWriter, r *http.Request) { if r.Method == GET { var name string vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { name = } else { name = names[0] } cl := proto.NewGreeterClient( go-micro-srv-greeter , client.DefaultClient) rsp, err := cl.Greeting(context.Background(), proto.GreetingRequest{Name: name}) if err != nil { http.Error(w, err.Error(), 500) return } js, err := json.Marshal(rsp) if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } w.Header().Set( Content-Type , application/json ) w.Write(js) return } }) if err := service.Init(); err != nil { log.Fatal(err) } if err := service.Run(); err != nil { log.Fatal(err) } } \u4e00\u65b9\u9762\uff0cGo Micro\u5728\u540e\u53f0\u5904\u7406\u4e86\u8bb8\u591a\u4e8b\u60c5\uff0c\u4f8b\u5982\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u8fdb\u884c\u6ce8\u518c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5f88\u96be\u521b\u5efa\u7eafHTTP\u670d\u52a1\u3002 Go Kit greeter \u5728\u5b8c\u6210Go Micro\u4e4b\u540e\uff0c\u7ee7\u7eed\u8fdb\u884cGo Kit\u670d\u52a1\u7684\u5b9e\u73b0\u3002\u6211\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u9605\u8bfbGo Kit\u5b58\u50a8\u5e93\u4e2d\u63d0\u4f9b\u7684\u4ee3\u7801\u793a\u4f8b\u3002\u4e86\u89e3\u7aef\u70b9\u7684\u6982\u5ff5\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u3002\u4e0b\u4e00\u4e2a\u8017\u65f6\u7684\u96be\u9898\u662f\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3\u4ee3\u7801\u3002\u5728\u627e\u5230\u4e00\u4e2a\u5f88\u597d\u7684 \u4f8b\u5b50 \u4e4b\u524d\uff0c\u6211\u65e0\u6cd5\u5b9e\u73b0\u5b83\u3002 \u6700\u540e\uff0c\u521b\u5efa\u4e86\u56db\u4e2a\u5305\u7528\u4e8e\uff1a \u670d\u52a1\u903b\u8f91\u5b9e\u73b0 \u4f20\u8f93\u4e0d\u53ef\u77e5\u670d\u52a1\u7aef\u70b9 \u4f20\u8f93\u7279\u5b9a\u7aef\u70b9\uff08gRPC\u3001HTTP\uff09 \u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3 \u670d\u52a1\u903b\u8f91\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff0c\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u4f9d\u8d56\u5173\u7cfb\uff0c\u5b83\u53ea\u662f\u5b9e\u73b0\u903b\u8f91\u3002 package greeterservice // Service describe greetings service. type Service interface { Health() bool Greeting(name string) string } // GreeterService implementation of the Service interface. type GreeterService struct{} // Health implementation of the Service. func (GreeterService) Health() bool { return true } // Greeting implementation of the Service. func (GreeterService) Greeting(name string) (greeting string) { greeting = GO-KIT Hello + name return } \u4e0b\u4e00\u6bb5\u4ee3\u7801\u663e\u793a\u4e86\u7aef\u70b9\u5b9a\u4e49\uff1a package greeterendpoint import ( context github.com/go-kit/kit/log github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice github.com/go-kit/kit/endpoint ) // \u7aef\u70b9\u96c6\u5408\u6536\u96c6\u6253\u62db\u547c\u670d\u52a1\u7684\u6240\u6709\u7aef\u70b9\uff0c\u5b83\u65e8\u5728\u7528\u4f5c\u8f85\u52a9\u7ed3\u6784\u5c06\u6240\u6709\u7aef\u70b9\u6536\u96c6\u5230\u5355\u4e2a\u53c2\u6570 type Endpoints struct { HealthEndpoint endpoint.Endpoint // used by Consul for the healthcheck GreetingEndpoint endpoint.Endpoint } // MakeServerEndpoints\u8fd4\u56de\u670d\u52a1\u7aef\u70b9\uff0c\u5e76\u5728\u6240\u6709\u63d0\u4f9b\u7684\u4e2d\u95f4\u4ef6\u4e2d\u8fdb\u884c\u8fde\u7ebf func MakeServerEndpoints(s greeterservice.Service, logger log.Logger) Endpoints { var healthEndpoint endpoint.Endpoint { healthEndpoint = MakeHealthEndpoint(s) healthEndpoint = LoggingMiddleware(log.With(logger, method , Health ))(healthEndpoint) } var greetingEndpoint endpoint.Endpoint { greetingEndpoint = MakeGreetingEndpoint(s) greetingEndpoint = LoggingMiddleware(log.With(logger, method , Greeting ))(greetingEndpoint) } return Endpoints{ HealthEndpoint: healthEndpoint, GreetingEndpoint: greetingEndpoint, } } // MakeHealthEndpoint\u6784\u9020Health\u7aef\u70b9\u6765\u5305\u88c5\u670d\u52a1 func MakeHealthEndpoint(s greeterservice.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { healthy := s.Health() return HealthResponse{Healthy: healthy}, nil } } // MakeHealthEndpoint\u6784\u9020Greeter\u7aef\u70b9\u6765\u5305\u88c5\u670d\u52a1 func MakeGreetingEndpoint(s greeterservice.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { req := request.(GreetingRequest) greeting := s.Greeting(req.Name) return GreetingResponse{Greeting: greeting}, nil } } // Failer\u662f\u5e94\u8be5\u7531\u54cd\u5e94\u7c7b\u578b\u5b9e\u73b0\u7684\u63a5\u53e3 // \u54cd\u5e94\u7f16\u7801\u5668\u53ef\u4ee5\u68c0\u67e5\u54cd\u5e94\u662f\u5426\u4e3aFailer\uff0c\u5982\u679c\u662fFailer\uff0c // \u5224\u65ad\u662f\u5426\u5931\u8d25\uff0c\u6216\u8005\u662f\u5426\u57fa\u4e8e\u9519\u8bef\u4f7f\u7528\u5355\u72ec\u7684\u5199\u5165\u8def\u5f84\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801 type Failer interface { Failed() error } // HealthRequest\u6536\u96c6Health\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570 type HealthRequest struct{} // HealthResponse\u6536\u96c6Health\u65b9\u6cd5\u7684\u54cd\u5e94\u503c type HealthResponse struct { Healthy bool `json: healthy,omitempty ` Err error `json: err,omitempty ` } // Failed\u5b9e\u73b0Failer\u63a5\u53e3 func (r HealthResponse) Failed() error { return r.Err } // GreetingRequest\u6536\u96c6Greeting\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570 type GreetingRequest struct { Name string `json: name,omitempty ` } // GreetingResponse\u6536\u96c6Greeting\u65b9\u6cd5\u7684\u54cd\u5e94\u503c type GreetingResponse struct { Greeting string `json: greeting,omitempty ` Err error `json: err,omitempty ` } // Failed\u5b9e\u73b0Failer\u63a5\u53e3 func (r GreetingResponse) Failed() error { return r.Err } \u5b9a\u4e49\u670d\u52a1\u548c\u7aef\u70b9\u540e\uff0c\u901a\u8fc7\u4e0d\u540c\u7684\u4f20\u8f93\u534f\u8bae\u66b4\u9732\u7aef\u70b9\u3002\u4eceHTTP\u4f20\u8f93\u5f00\u59cb\uff1a package greetertransport import ( context encoding/json errors net/http github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/go-kit/kit/log httptransport github.com/go-kit/kit/transport/http github.com/gorilla/mux ) var ( // \u5982\u679c\u7f3a\u5c11\u9884\u671f\u7684\u8def\u5f84\u53d8\u91cf\uff0c\u5219\u8fd4\u56deErrBadRouting ErrBadRouting = errors.New( inconsistent mapping between route and handler ) ) // NewHTTPHandler\u8fd4\u56de\u4e00\u4e2aHTTP\u5904\u7406\u7a0b\u5e8f\uff0c\u8be5\u5904\u7406\u7a0b\u5e8f\u4f7f\u4e00\u7ec4\u7aef\u70b9\u5728\u9884\u5b9a\u4e49\u8def\u5f84\u4e0a\u53ef\u7528 func NewHTTPHandler(endpoints greeterendpoint.Endpoints, logger log.Logger) http.Handler { m := mux.NewRouter() options := []httptransport.ServerOption{ httptransport.ServerErrorEncoder(encodeError), httptransport.ServerErrorLogger(logger), } // GET /health retrieves service heath information // GET /greeting?name retrieves greeting m.Methods( GET ).Path( /health ).Handler(httptransport.NewServer( endpoints.HealthEndpoint, DecodeHTTPHealthRequest, EncodeHTTPGenericResponse, options..., )) m.Methods( GET ).Path( /greeting ).Handler(httptransport.NewServer( endpoints.GreetingEndpoint, DecodeHTTPGreetingRequest, EncodeHTTPGenericResponse, options..., )) return m } // DecodeHTTPHealthRequest method. func DecodeHTTPHealthRequest(_ context.Context, _ *http.Request) (interface{}, error) { return greeterendpoint.HealthRequest{}, nil } // DecodeHTTPGreetingRequest method. func DecodeHTTPGreetingRequest(_ context.Context, r *http.Request) (interface{}, error) { vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { return nil, ErrBadRouting } req := greeterendpoint.GreetingRequest{Name: names[0]} return req, nil } func encodeError(_ context.Context, err error, w http.ResponseWriter) { w.WriteHeader(err2code(err)) json.NewEncoder(w).Encode(errorWrapper{Error: err.Error()}) } func err2code(err error) int { switch err { default: return http.StatusInternalServerError } } type errorWrapper struct { Error string `json: error ` } // EncodeHTTPGenericResponse\u662f`transport/http.EncodeResponseFunc`\uff0c\u5b83\u5c06\u54cd\u5e94\u7f16\u7801\u4e3aJSON\u7f16\u7801\u5230\u54cd\u5e94\u7f16\u5199\u5668 func EncodeHTTPGenericResponse(ctx context.Context, w http.ResponseWriter, response interface{}) error { if f, ok := response.(greeterendpoint.Failer); ok f.Failed() != nil { encodeError(ctx, f.Failed(), w) return nil } w.Header().Set( Content-Type , application/json; charset=utf-8 ) return json.NewEncoder(w).Encode(response) } \u5728\u5f00\u59cbgRPC\u7aef\u70b9\u5b9e\u73b0\u4e4b\u524d\uff0c\u4e0d\u9700\u8981protobuf\u5b9a\u4e49\u3002\u76f4\u63a5\u590d\u5236\u4e0a\u9762Go Micro\u670d\u52a1\u7684protobuf\u5b9a\u4e49\u3002\u4f46\u662f\u5bf9\u4e8eGo Kit\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u670d\u52a1\u751f\u6210\u5668\u6765\u521b\u5efa\u670d\u52a1\u63a5\u53e3\u3002 protoc greeter.proto --go_out=plugins=grpc:. package greetertransport import ( context github.com/antklim/go-microservices/go-kit-greeter/pb github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/go-kit/kit/log grpctransport github.com/go-kit/kit/transport/grpc oldcontext golang.org/x/net/context ) type grpcServer struct { greeter grpctransport.Handler } // NewGRPCServer\u4f7f\u4e00\u7ec4\u7aef\u70b9\u53ef\u7528\u4f5cgRPC GreeterServer func NewGRPCServer(endpoints greeterendpoint.Endpoints, logger log.Logger) pb.GreeterServer { options := []grpctransport.ServerOption{ grpctransport.ServerErrorLogger(logger), } return grpcServer{ greeter: grpctransport.NewServer( endpoints.GreetingEndpoint, decodeGRPCGreetingRequest, encodeGRPCGreetingResponse, options..., ), } } // Greeting\u5b9e\u73b0GreeterService\u63a5\u53e3\u7684\u65b9\u6cd5 func (s *grpcServer) Greeting(ctx oldcontext.Context, req *pb.GreetingRequest) (*pb.GreetingResponse, error) { _, res, err := s.greeter.ServeGRPC(ctx, req) if err != nil { return nil, err } return res.(*pb.GreetingResponse), nil } // encodeGRPCGreetingRequest\u662f\u4e00\u4e2a`transport/grpc.DecodeRequestFunc`\uff0c\u5b83\u5c06gRPC\u95ee\u5019\u8bf7\u6c42\u8f6c\u6362\u4e3a\u7528\u6237\u57df\u95ee\u5019\u8bf7\u6c42 func decodeGRPCGreetingRequest(_ context.Context, grpcReq interface{}) (interface{}, error) { req := grpcReq.(*pb.GreetingRequest) return greeterendpoint.GreetingRequest{Name: req.Name}, nil } // encodeGRPCGreetingResponse\u662f`transport/grpc.EncodeResponseFunc`\uff0c\u5b83\u5c06\u7528\u6237\u57df\u95ee\u5019\u54cd\u5e94\u8f6c\u6362\u4e3agRPC\u95ee\u5019\u54cd\u5e94 func encodeGRPCGreetingResponse(_ context.Context, response interface{}) (interface{}, error) { res := response.(greeterendpoint.GreetingResponse) return pb.GreetingResponse{Greeting: res.Greeting}, nil } \u6700\u540e\uff0c\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u5668\uff1a package greetersd import ( math/rand os strconv time github.com/go-kit/kit/log github.com/go-kit/kit/sd consulsd github.com/go-kit/kit/sd/consul github.com/hashicorp/consul/api ) // ConsulRegister method. func ConsulRegister(consulAddress string, consulPort string, advertiseAddress string, advertisePort string) (registar sd.Registrar) { // Logging domain. var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.With(logger, ts , log.DefaultTimestampUTC) logger = log.With(logger, caller , log.DefaultCaller) } rand.Seed(time.Now().UTC().UnixNano()) // Service discovery domain. In this example we use Consul. var client consulsd.Client { consulConfig := api.DefaultConfig() consulConfig.Address = consulAddress + : + consulPort consulClient, err := api.NewClient(consulConfig) if err != nil { logger.Log( err , err) os.Exit(1) } client = consulsd.NewClient(consulClient) } check := api.AgentServiceCheck{ HTTP: http:// + advertiseAddress + : + advertisePort + /health , Interval: 10s , Timeout: 1s , Notes: Basic health checks , } port, _ := strconv.Atoi(advertisePort) num := rand.Intn(100) // to make service ID unique asr := api.AgentServiceRegistration{ ID: go-kit-srv-greeter- + strconv.Itoa(num), //unique service ID Name: go-kit-srv-greeter , Address: advertiseAddress, Port: port, Tags: []string{ go-kit , greeter }, Check: check, } registar = consulsd.NewRegistrar(client, asr, logger) return } \u51c6\u5907\u597d\u6240\u6709\u6784\u5efa\u5757\u4e4b\u540e\uff0c\u6211\u5c06\u5b83\u4eec\u8fde\u63a5\u5230\u670d\u52a1\u542f\u52a8\u5668\u4e2d\uff1a package main import ( flag fmt net net/http os os/signal syscall text/tabwriter github.com/antklim/go-microservices/go-kit-greeter/pb google.golang.org/grpc github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/antklim/go-microservices/go-kit-greeter/pkg/greetersd github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice github.com/antklim/go-microservices/go-kit-greeter/pkg/greetertransport github.com/go-kit/kit/log github.com/oklog/oklog/pkg/group ) func main() { fs := flag.NewFlagSet( greetersvc , flag.ExitOnError) var ( debugAddr = fs.String( debug.addr , :9100 , Debug and metrics listen address ) consulAddr = fs.String( consul.addr , , Consul Address ) consulPort = fs.String( consul.port , 8500 , Consul Port ) httpAddr = fs.String( http.addr , , HTTP Listen Address ) httpPort = fs.String( http.port , 9110 , HTTP Listen Port ) grpcAddr = fs.String( grpc-addr , :9120 , gRPC listen address ) ) fs.Usage = usageFor(fs, os.Args[0]+ [flags] ) fs.Parse(os.Args[1:]) var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.With(logger, ts , log.DefaultTimestampUTC) logger = log.With(logger, caller , log.DefaultCaller) } var service greeterservice.Service { service = greeterservice.GreeterService{} service = greeterservice.LoggingMiddleware(logger)(service) } var ( endpoints = greeterendpoint.MakeServerEndpoints(service, logger) httpHandler = greetertransport.NewHTTPHandler(endpoints, logger) registar = greetersd.ConsulRegister(*consulAddr, *consulPort, *httpAddr, *httpPort) grpcServer = greetertransport.NewGRPCServer(endpoints, logger) ) var g group.Group { // The debug listener mounts the http.DefaultServeMux, and serves up // stuff like the Go debug and profiling routes, and so on. debugListener, err := net.Listen( tcp , *debugAddr) if err != nil { logger.Log( transport , debug/HTTP , during , Listen , err , err) os.Exit(1) } g.Add(func() error { logger.Log( transport , debug/HTTP , addr , *debugAddr) return http.Serve(debugListener, http.DefaultServeMux) }, func(error) { debugListener.Close() }) } { // The service discovery registration. g.Add(func() error { logger.Log( transport , HTTP , addr , *httpAddr, port , *httpPort) registar.Register() return http.ListenAndServe( : +*httpPort, httpHandler) }, func(error) { registar.Deregister() }) } { // The gRPC listener mounts the Go kit gRPC server we created. grpcListener, err := net.Listen( tcp , *grpcAddr) if err != nil { logger.Log( transport , gRPC , during , Listen , err , err) os.Exit(1) } g.Add(func() error { logger.Log( transport , gRPC , addr , *grpcAddr) baseServer := grpc.NewServer() pb.RegisterGreeterServer(baseServer, grpcServer) return baseServer.Serve(grpcListener) }, func(error) { grpcListener.Close() }) } { // This function just sits and waits for ctrl-C. cancelInterrupt := make(chan struct{}) g.Add(func() error { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) select { case sig := -c: return fmt.Errorf( received signal %s , sig) case -cancelInterrupt: return nil } }, func(error) { close(cancelInterrupt) }) } logger.Log( exit , g.Run()) } func usageFor(fs *flag.FlagSet, short string) func() { return func() { fmt.Fprintf(os.Stderr, USAGE\\n ) fmt.Fprintf(os.Stderr, %s\\n , short) fmt.Fprintf(os.Stderr, \\n ) fmt.Fprintf(os.Stderr, FLAGS\\n ) w := tabwriter.NewWriter(os.Stderr, 0, 2, 2, ' ', 0) fs.VisitAll(func(f *flag.Flag) { fmt.Fprintf(w, \\t-%s %s\\t%s\\n , f.Name, f.DefValue, f.Usage) }) w.Flush() fmt.Fprintf(os.Stderr, \\n ) } } \u5728\u51e0\u4e2a\u5730\u65b9\u4f7f\u7528\u4e86\u65e5\u5fd7\u8bb0\u5f55\u4e2d\u95f4\u4ef6\u3002\u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u5c06\u65e5\u5fd7\u8bb0\u5f55\u903b\u8f91\u4e0e\u4e3b\u8981\u670d\u52a1/\u7aef\u70b9\u5de5\u4f5c\u6d41\u5206\u79bb\u3002 package greeterservice import ( time github.com/go-kit/kit/log ) // ServiceMiddleware\u63cf\u8ff0\u4e86\u670d\u52a1\u4e2d\u95f4\u4ef6 type ServiceMiddleware func(Service) Service // LoggingMiddleware\u5c06\u8bb0\u5f55\u5668\u4f5c\u4e3a\u4f9d\u8d56\u9879\uff0c\u5e76\u8fd4\u56deServiceMiddleware\u3002 func LoggingMiddleware(logger log.Logger) ServiceMiddleware { return func(next Service) Service { return loggingMiddleware{next, logger} } } type loggingMiddleware struct { Service logger log.Logger } func (m loggingMiddleware) Health() (healthy bool) { defer func(begin time.Time) { m.logger.Log( method , Health , healthy , healthy, took , time.Since(begin), ) }(time.Now()) healthy = m.Service.Health() return } func (m loggingMiddleware) Greeting(name string) (greeting string) { defer func(begin time.Time) { m.logger.Log( method , Greeting , name , name, greeting , greeting, took , time.Since(begin), ) }(time.Now()) greeting = m.Service.Greeting(name) return } package greeterendpoint import ( context time github.com/go-kit/kit/endpoint github.com/go-kit/kit/log ) // LoggingMiddleware\u8fd4\u56de\u4e00\u4e2a\u7aef\u70b9\u4e2d\u95f4\u4ef6\uff0c\u8be5\u4e2d\u95f4\u4ef6\u8bb0\u5f55\u6bcf\u6b21\u8c03\u7528\u7684\u6301\u7eed\u65f6\u95f4\u4ee5\u53ca\u6240\u4ea7\u751f\u7684\u9519\u8bef\uff08\u5982\u679c\u6709\uff09 func LoggingMiddleware(logger log.Logger) endpoint.Middleware { return func(next endpoint.Endpoint) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { defer func(begin time.Time) { logger.Log( transport_error , err, took , time.Since(begin)) }(time.Now()) return next(ctx, request) } } } Gizmo greeter \u4ee5\u4e0eGo Kit\u7c7b\u4f3c\u7684\u65b9\u5f0f\u521b\u5efa\u4e86Gizmo\u670d\u52a1\u3002\u4e3a\u670d\u52a1\uff0c\u7aef\u70b9\uff0c\u4f20\u8f93\u548c\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u5668\u5b9a\u4e49\u4e86\u56db\u4e2a\u5305\u3002\u670d\u52a1\u5b9e\u73b0\u548c\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u6ce8\u518c\u4e2d\u5fc3\u4e0eGo Kit\u670d\u52a1\u5171\u4eab\u76f8\u540c\u7684\u4ee3\u7801\u3002\u4f46\u662f\u7aef\u70b9\u5b9a\u4e49\u548c\u4f20\u8f93\u5b9e\u73b0\u5fc5\u987b\u6839\u636eGizmo\u7684\u529f\u80fd\u6765\u5b8c\u6210\u3002 package greeterendpoint import ( net/http ocontext golang.org/x/net/context github.com/NYTimes/gizmo/server github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterservice ) // Endpoints collects all of the endpoints that compose a greeter service. type Endpoints struct { HealthEndpoint server.JSONContextEndpoint GreetingEndpoint server.JSONContextEndpoint } // MakeServerEndpoints returns service Endoints func MakeServerEndpoints(s greeterservice.Service) Endpoints { healthEndpoint := MakeHealthEndpoint(s) greetingEndpoint := MakeGreetingEndpoint(s) return Endpoints{ HealthEndpoint: healthEndpoint, GreetingEndpoint: greetingEndpoint, } } // MakeHealthEndpoint constructs a Health endpoint. func MakeHealthEndpoint(s greeterservice.Service) server.JSONContextEndpoint { return func(ctx ocontext.Context, r *http.Request) (int, interface{}, error) { healthy := s.Health() return http.StatusOK, HealthResponse{Healthy: healthy}, nil } } // MakeGreetingEndpoint constructs a Greeting endpoint. func MakeGreetingEndpoint(s greeterservice.Service) server.JSONContextEndpoint { return func(ctx ocontext.Context, r *http.Request) (int, interface{}, error) { vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { return http.StatusBadRequest, errorResponse{Error: query parameter 'name' required }, nil } greeting := s.Greeting(names[0]) return http.StatusOK, GreetingResponse{Greeting: greeting}, nil } } // HealthRequest collects the request parameters for the Health method. type HealthRequest struct{} // HealthResponse collects the response values for the Health method. type HealthResponse struct { Healthy bool `json: healthy,omitempty ` } // GreetingRequest collects the request parameters for the Greeting method. type GreetingRequest struct { Name string `json: name,omitempty ` } // GreetingResponse collects the response values for the Greeting method. type GreetingResponse struct { Greeting string `json: greeting,omitempty ` } type errorResponse struct { Error string `json: error ` } \u5982\u4e0a\u6240\u793a\uff0c\u8be5\u4ee3\u7801\u6bb5\u7c7b\u4f3c\u4e8eGo Kit\u3002\u4e3b\u8981\u533a\u522b\u5728\u4e8e\u5e94\u8fd4\u56de\u7684\u63a5\u53e3\u7c7b\u578b\uff1a package greetertransport import ( context github.com/NYTimes/gizmo/server google.golang.org/grpc errors net/http github.com/NYTimes/gziphandler pb github.com/antklim/go-microservices/gizmo-greeter/pb github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterendpoint github.com/sirupsen/logrus ) type ( // TService will implement server.RPCService and handle all requests to the server. TService struct { Endpoints greeterendpoint.Endpoints } // Config is a struct to contain all the needed // configuration for our JSONService. Config struct { Server *server.Config } ) // NewTService will instantiate a RPCService with the given configuration. func NewTService(cfg *Config, endpoints greeterendpoint.Endpoints) *TService { return TService{Endpoints: endpoints} } // Prefix returns the string prefix used for all endpoints within this service. func (s *TService) Prefix() string { return } // Service provides the TService with a description of the service to serve and // the implementation. func (s *TService) Service() (*grpc.ServiceDesc, interface{}) { return pb.Greeter_serviceDesc, s } // Middleware provides an http.Handler hook wrapped around all requests. // In this implementation, we're using a GzipHandler middleware to // compress our responses. func (s *TService) Middleware(h http.Handler) http.Handler { return gziphandler.GzipHandler(h) } // ContextMiddleware provides a server.ContextHAndler hook wrapped around all // requests. This could be handy if you need to decorate the request context. func (s *TService) ContextMiddleware(h server.ContextHandler) server.ContextHandler { return h } // JSONMiddleware provides a JSONEndpoint hook wrapped around all requests. // In this implementation, we're using it to provide application logging and to check errors // and provide generic responses. func (s *TService) JSONMiddleware(j server.JSONContextEndpoint) server.JSONContextEndpoint { return func(ctx context.Context, r *http.Request) (int, interface{}, error) { status, res, err := j(ctx, r) if err != nil { server.LogWithFields(r).WithFields(logrus.Fields{ error : err, }).Error( problems with serving request ) return http.StatusServiceUnavailable, nil, errors.New( sorry, this service is unavailable ) } server.LogWithFields(r).Info( success! ) return status, res, nil } } // ContextEndpoints may be needed if your server has any non-RPC-able // endpoints. In this case, we have none but still need this method to // satisfy the server.RPCService interface. func (s *TService) ContextEndpoints() map[string]map[string]server.ContextHandlerFunc { return map[string]map[string]server.ContextHandlerFunc{} } // JSONEndpoints is a listing of all endpoints available in the TService. func (s *TService) JSONEndpoints() map[string]map[string]server.JSONContextEndpoint { return map[string]map[string]server.JSONContextEndpoint{ /health : map[string]server.JSONContextEndpoint{ GET : s.Endpoints.HealthEndpoint, }, /greeting : map[string]server.JSONContextEndpoint{ GET : s.Endpoints.GreetingEndpoint, }, } } package greetertransport import ( pb github.com/antklim/go-microservices/gizmo-greeter/pb ocontext golang.org/x/net/context ) // Greeting implementation of the gRPC service. func (s *TService) Greeting(ctx ocontext.Context, r *pb.GreetingRequest) (*pb.GreetingResponse, error) { return pb.GreetingResponse{Greeting: Hola Gizmo RPC + r.Name}, nil } Go Kit\u548cGizmo\u4e4b\u95f4\u7684\u660e\u663e\u533a\u522b\u5728\u4e8e\u4f20\u8f93\u65b9\u5f0f\u3002 Gizmo\u63d0\u4f9b\u4e86\u51e0\u79cd\u53ef\u4ee5\u5229\u7528\u7684\u670d\u52a1\u7c7b\u578b\u3002\u8981\u505a\u7684\u5c31\u662f\u5c06HTTP\u8def\u5f84\u6620\u5c04\u5230\u7aef\u70b9\u5b9a\u4e49\u3002\u4f4e\u7ea7HTTP\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u7531Gizmo\u5904\u7406\u3002 \u603b\u7ed3 Go Micro\u662f\u542f\u52a8\u5fae\u670d\u52a1\u7cfb\u7edf\u7684\u6700\u5feb\u65b9\u6cd5\u3002\u6846\u67b6\u63d0\u4f9b\u4e86\u8bb8\u591a\u529f\u80fd\u3002\u56e0\u6b64\uff0c\u65e0\u9700\u91cd\u65b0\u53d1\u660e\u8f6e\u5b50\u3002\u4f46\u662f\uff0c\u8fd9\u79cd\u8212\u9002\u6027\u548c\u901f\u5ea6\u4f1a\u727a\u7272\u7075\u6d3b\u6027\u3002\u66f4\u6539\u6216\u66f4\u65b0\u7cfb\u7edf\u90e8\u4ef6\u5e76\u4e0d\u50cfGo Kit\u90a3\u6837\u5bb9\u6613\u3002\u5e76\u4e14\u5c06gRPC\u5f3a\u5236\u4e3a\u4e00\u7b49\u7684\u901a\u4fe1\u7c7b\u578b\u3002 \u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u6765\u719f\u6089Go Kit\u3002\u5b83\u9700\u8981\u5177\u5907Go\u8bed\u8a00\u7279\u6027\u7684\u4e30\u5bcc\u77e5\u8bc6\u548c\u8f6f\u4ef6\u67b6\u6784\u65b9\u9762\u7684\u7ecf\u9a8c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u6ca1\u6709\u6846\u67b6\u9650\u5236\u3002\u6240\u6709\u90e8\u4ef6\u5747\u53ef\u72ec\u7acb\u66f4\u6539\u548c\u66f4\u65b0\u3002 Gizmo\u4f4d\u4e8eGo Micro\u548cGo Kit\u4e4b\u95f4\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u66f4\u9ad8\u7ea7\u522b\u7684\u62bd\u8c61\uff0c\u4f8b\u5982Service\u5305\u3002\u4f46\u662f\u7f3a\u5c11\u6587\u6863\u548c\u793a\u4f8b\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u5f97\u4e0d\u901a\u8bfb\u6e90\u4ee3\u7801\u4ee5\u4e86\u89e3\u4e0d\u540c\u670d\u52a1\u7c7b\u578b\u7684\u5de5\u4f5c\u65b9\u5f0f\u3002\u4f7f\u7528Gizmo\u6bd4\u4f7f\u7528Go Kit\u5bb9\u6613\u3002\u4f46\u662f\u5b83\u4e0d\u50cfGo Micro\u90a3\u6837\u6d41\u7545\u3002","title":"Microservices in Go"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#microservices-in-go","text":"Medium\u539f\u6587 \u70b9\u8fd9\u91cc\u3002 \u5bf9\u4ee5\u4e0b\u56db\u4e2a\u6846\u67b6\u8fdb\u884c\u6bd4\u8f83\uff1a Go Micro Go Kit Gizmo Kite","title":"Microservices in Go"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_1","text":"","title":"\u6846\u67b6\u4ecb\u7ecd"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#go-micro","text":"\u6700\u53d7\u6b22\u8fce\u7684\u6846\u67b6\u53ea\u4e00\uff0c\u7f51\u4e0a\u6709\u5f88\u591a\u7684\u535a\u5ba2\u3001\u6587\u7ae0\uff0c\u8fd8\u6709\u5f88\u591a\u4f7f\u7528\u793a\u4f8b\u3002\u53ef\u4ee5\u5728Medium\u4e0a\u5173\u6ce8 microhq \uff0c\u6765\u83b7\u5f97Go Micro\u4e2d\u7684\u6700\u65b0\u66f4\u65b0\u3002 Go Micro\u662f\u4f7f\u7528Go\u8bed\u8a00\u7f16\u5199\u5fae\u670d\u52a1\u7684\u53ef\u63d2\u62d4RPC\u6846\u67b6\uff0c\u5b83\u5f00\u7bb1\u5373\u7528\uff0c\u6709\u5982\u4e0b\u529f\u80fd\uff1a \u670d\u52a1\u53d1\u73b0\uff1a\u5e94\u7528\u7a0b\u5e8f\u81ea\u52a8\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c \u8d1f\u8f7d\u5747\u8861\uff1a\u5ba2\u6237\u7aef\u4fa7\u8d1f\u8f7d\u5747\u8861\uff0c\u7528\u4e8e\u5e73\u8861\u670d\u52a1\u5b9e\u4f8b\u4e4b\u95f4\u7684\u8bf7\u6c42 \u540c\u6b65\u901a\u4fe1\uff1a\u4f20\u8f93\u5c42\u63d0\u4f9b\u8bf7\u6c42/\u54cd\u5e94 \u5f02\u6b65\u901a\u4fe1\uff1a\u5185\u7f6e\u53d1\u5e03\u8ba2\u9605\u529f\u80fd \u6d88\u606f\u7f16\u7801\uff1a\u57fa\u4e8e\u6d88\u606f\u7684 Content-Type \u6807\u5934\u7684\u7f16\u7801/\u89e3\u7801 RPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5305\uff1a\u5229\u7528\u4e0a\u8ff0\u529f\u80fd\u5e76\u66b4\u9732\u63a5\u53e3\u4ee5\u6784\u5efa\u5fae\u670d\u52a1 Go Micro\u67b6\u6784\u53ef\u4ee5\u63cf\u8ff0\u4e3a\u5982\u4e0b\u6240\u793a\u7684\u4e09\u5c42\u5806\u6808\uff1a \u9876\u5c42\u7531\u5ba2\u6237\u7aef-\u670d\u52a1\u5668\u6a21\u578b\u548c\u670d\u52a1\u62bd\u8c61\u7ec4\u6210\u3002\u670d\u52a1\u5668(Server)\u662f\u7528\u4e8e\u7f16\u5199\u670d\u52a1\u7684\u6784\u5efa\u5757\uff0c\u5ba2\u6237\u7aef(Client)\u63d0\u4f9b\u4e86\u5411\u670d\u52a1\u8bf7\u6c42\u7684\u63a5\u53e3\u3002 \u5e95\u5c42\u7531\u4ee5\u4e0b\u7c7b\u578b\u7684\u63d2\u4ef6\u7ec4\u6210\uff1a \u4ee3\u7406\uff1a\u4e3a\u5f02\u6b65\u53d1\u5e03/\u8ba2\u9605\u901a\u4fe1\u63d0\u4f9b\u6d88\u606f\u4ee3\u7406\u7684\u63a5\u53e3 \u7f16\u89e3\u7801\u5668\uff1a\u7528\u4e8e\u7f16\u7801/\u89e3\u7801\u6d88\u606f\uff0c\u652f\u6301\u7684\u683c\u5f0f\u5305\u62ec json \uff0c bson \uff0c protobuf \uff0c msgpack \u7b49 \u6ce8\u518c\u4e2d\u5fc3\uff1a\u63d0\u4f9b\u670d\u52a1\u53d1\u73b0\u673a\u5236\uff08\u9ed8\u8ba4\u4e3a Consul \uff09 \u9009\u62e9\u5668\uff1a\u5efa\u7acb\u5728\u6ce8\u518c\u4e2d\u5fc3\u4e0a\u7684\u8d1f\u8f7d\u5747\u8861\u62bd\u8c61\uff0c\u5141\u8bb8\u4f7f\u7528\u8bf8\u5982\u968f\u673a\uff0c\u8f6e\u5faa\uff0c\u6700\u5c11\u8fde\u63a5\u7b49\u7b97\u6cd5\u6765\u201c\u9009\u62e9\u201d\u670d\u52a1 \u4f20\u8f93\uff1a\u670d\u52a1\u4e4b\u95f4\u540c\u6b65\u8bf7\u6c42/\u54cd\u5e94\u901a\u4fe1\u7684\u63a5\u53e3 Go Micro\u8fd8\u63d0\u4f9b\u4e86Sidecar\u7b49\u529f\u80fd\u3002\u8fd9\u5c31\u53ef\u4ee5\u4f7f\u7528\u4ee5Go\u4ee5\u5916\u7684\u8bed\u8a00\u7f16\u5199\u7684\u670d\u52a1\u3002Sidecar\u63d0\u4f9b\u670d\u52a1\u6ce8\u518c\uff0cgRPC\u7f16\u7801/\u89e3\u7801\u548cHTTP\u5904\u7406\u7a0b\u5e8f\u3002\u5b83\u652f\u6301\u591a\u79cd\u8bed\u8a00\u3002","title":"Go Micro"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#go-kit","text":"Go Kit\u662f\u7528\u4e8e\u5728Go\u4e2d\u6784\u5efa\u5fae\u670d\u52a1\u7684\u7f16\u7a0b\u5de5\u5177\u5305\u3002\u4e0eGo Micro\u4e0d\u540c\uff0c\u5b83\u662f\u4e00\u4e2a\u65e8\u5728\u5bfc\u5165\u4e8c\u8fdb\u5236\u8f6f\u4ef6\u5305\u7684\u5e93\u3002Go Kit\u9075\u5faa\u7b80\u5355\u539f\u5219\uff0c\u4f8b\u5982\uff1a \u6ca1\u6709\u5168\u5c40\u72b6\u6001 \u58f0\u660e\u5f0f\u7ec4\u6210 \u663e\u5f0f\u4f9d\u8d56 \u5408\u7ea6\u5f0f\u63a5\u53e3 \u9886\u57df\u9a71\u52a8\u8bbe\u8ba1 \u5728Go Kit\u4e2d\u53ef\u4ee5\u627e\u5230\u4ee5\u4e0b\u8f6f\u4ef6\u5305\uff1a \u8eab\u4efd\u9a8c\u8bc1\uff1a basic \u548c JWT \u6570\u636e\u4f20\u8f93\uff1aHTTP\u3001Nats\uff08\u5f00\u6e90\u6d88\u606f\u4f20\u9012\u7cfb\u7edf\uff09\u3001gRPC\u7b49 \u65e5\u5fd7\u8bb0\u5f55\uff1a\u901a\u7528\u63a5\u53e3\u7528\u4e8e\u7ed3\u6784\u5316\u670d\u52a1\u7684\u65e5\u5fd7\u8bb0\u5f55 \u6307\u6807\u76d1\u63a7\uff1a CloudWatch \uff0c Statsd \uff0c Graphite \u7b49 \u94fe\u8def\u8ffd\u8e2a\uff1a Zipkin \u548c Opentracing \u670d\u52a1\u53d1\u73b0\uff1a Consul \u3001 Etcd \u3001 Eureka \u7b49 \u65ad\u8def\u5668\uff1a\u4f7f\u7528Go\u8bed\u8a00\u5b9e\u73b0\u7684 Hystrix Peter Bourgon\u7684\u6587\u7ae0\u548c\u6f14\u793a\u5e7b\u706f\u7247\u662f\u5bf9Go Kit\u6700\u597d\u7684\u63cf\u8ff0\u4e4b\u4e00\uff1a Go kit: Go in the modern enterprise Go + microservices \u5728\u201c Go + microservices\u201d\u5e7b\u706f\u7247\u4e2d\uff0c\u53ef\u4ee5\u627e\u5230\u4f7f\u7528Go Kit\u6784\u5efa\u7684\u670d\u52a1\u4f53\u7cfb\u7ed3\u6784\u7684\u793a\u4f8b\u3002\u4e3a\u4e86\u5feb\u901f\u53c2\u8003\uff0c\u670d\u52a1\u67b6\u6784\u56fe\u5982\u4e0b\u6240\u793a\uff1a","title":"Go Kit"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#gizmo","text":"Gizmo\u662f\u300a\u7ebd\u7ea6\u65f6\u62a5\u300b\u7684\u5fae\u670d\u52a1\u5de5\u5177\u5305\u3002\u5b83\u63d0\u4f9b\u4e86\u5c06\u670d\u52a1\u548c pubsub \u5b88\u62a4\u8fdb\u7a0b\u653e\u5728\u4e00\u8d77\u7684\u8f6f\u4ef6\u5305\u3002\u5b83\u516c\u5f00\u4e86\u4ee5\u4e0b\u8f6f\u4ef6\u5305\uff1a server \uff1a\u63d0\u4f9b\u4e24\u79cd\u670d\u52a1\u5b9e\u73b0\u65b9\u5f0f\uff1a \u7b80\u5355\u670d\u52a1\uff08\u57fa\u4e8eHTTP\uff09 RPC\u670d\u52a1\uff08\u57fa\u4e8egRPC\uff09 server/kit \uff1a\u57fa\u4e8eGo Kit\u7684\u5b9e\u9a8c\u6027\u8f6f\u4ef6\u5305 config \uff1a\u4ece\u4ee5\u4e0b\u4f4d\u7f6e\u83b7\u53d6\u914d\u7f6e\u53c2\u6570\u7684\u914d\u7f6e\u51fd\u6570\uff1a JSON\u6587\u4ef6\uff0c Consul k/v\u4e2d\u7684JSON blob \u73af\u5883\u53d8\u91cf pubsub \uff1a\u63d0\u4f9b\u7528\u4e8e\u53d1\u5e03\u548c\u8ba2\u9605\u961f\u5217\u4e2d\u6570\u636e\u7684\u901a\u7528\u63a5\u53e3 pubsub/pubsubtest \uff1a\u5305\u542b\u53d1\u5e03\u8005\u548c\u8ba2\u9605\u8005\u63a5\u53e3\u7684\u6d4b\u8bd5\u5b9e\u73b0 web \uff1a\u66b4\u9732\u7528\u4e8e\u4ece\u8bf7\u6c42\u67e5\u8be2\u548c\u6709\u6548\u8d1f\u8f7d\u4e2d\u89e3\u6790\u7c7b\u578b\u7684\u51fd\u6570 Pubsub \u8f6f\u4ef6\u5305\u63d0\u4f9b\u4e86\u4e0e\u4ee5\u4e0b\u961f\u5217\u4e00\u8d77\u4f7f\u7528\u7684\u63a5\u53e3\uff1a pubsub/aws \uff1aAmazon SNS/SQS pubsub/gcp \uff1aGoogle Pubsub. pubsub/kafka \uff1aKafka topics pubsub/http \uff1a publishing via HTTP \u56e0\u6b64\uff0c\u53ef\u4ee5\u8ba4\u4e3aGizmo\u4f4d\u4e8eGo Micro\u548cGo Kit\u4e4b\u95f4\u3002\u5b83\u4e0d\u662f\u50cfGo Micro\u8fd9\u6837\u7684\u5b8c\u6574\u201c\u9ed1\u7bb1\u201d\u3002\u540c\u65f6\uff0c\u5b83\u4e0d\u50cfGo Kit\u90a3\u6837\u539f\u59cb\u3002\u5b83\u63d0\u4f9b\u4e86\u66f4\u9ad8\u7ea7\u522b\u7684\u6784\u5efa\u7ec4\u4ef6\uff0c\u4f8b\u5982config\u548cpubsub\u8f6f\u4ef6\u5305\u3002","title":"Gizmo"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#kite","text":"Kite\u662f\u7528\u4e8e\u5728Go\u4e2d\u5f00\u53d1\u5fae\u670d\u52a1\u7684\u6846\u67b6\u3002\u5b83\u516c\u5f00\u4e86RPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7a0b\u5e8f\u5305\u3002\u521b\u5efa\u7684\u670d\u52a1\u4f1a\u81ea\u52a8\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edfKontrol\u4e2d\u6ce8\u518c\u3002 Kontrol\u662f\u7528Kite\u7f16\u5199\u7684\uff0c\u5b83\u672c\u8eab\u5c31\u662fKite\u670d\u52a1\u3002\u8fd9\u610f\u5473\u7740Kite\u5fae\u670d\u52a1\u5728\u5176\u81ea\u5df1\u7684\u73af\u5883\u4e2d\u8fd0\u884c\u826f\u597d\u3002 \u5982\u679c\u9700\u8981\u5c06Kite\u5fae\u670d\u52a1\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\uff0c\u5219\u9700\u8981\u81ea\u5b9a\u4e49 \u3002\u8fd9\u662f\u4ece\u5217\u8868\u4e2d\u5220\u9664Kite\u5e76\u51b3\u5b9a\u4e0d\u5ba1\u67e5\u6b64\u6846\u67b6\u7684\u4e3b\u8981\u539f\u56e0\u3002","title":"Kite"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_2","text":"\u4f7f\u7528\u56db\u4e2a\u7c7b\u522b\u6765\u6bd4\u8f83\u6846\u67b6\uff1a \u76ee\u6807\u6bd4\u8f83\uff1a\u57fa\u4e8eGitHub\u7edf\u8ba1 \u6587\u6863\u548c\u793a\u4f8b \u7528\u6237\u548c\u793e\u533a \u4ee3\u7801\u8d28\u91cf","title":"\u6846\u67b6\u5bf9\u6bd4"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#github","text":"\u65f6\u95f4\uff1a2019/10/28 Go Micro Go Kit Gizmo License Apache License 2.0 MIT Apache License 2.0 Created Jan 2015 Feb 2015 Dec 2015 Release 60 9 48 Author Asim Aslam Peter Bourgon JP Robinson Stars 9484 15190 2937 Open/Closed Issues 35/400 56/370 12/52 Last Update Oct 26, 2019 Oct 18, 2019 Oct 14, 2019","title":"Github\u7edf\u8ba1"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_3","text":"Go Micro\u548cGo kit \u63d0\u4f9b\u4e86\u4e00\u4e2a\u4e3b\u9875\uff0c\u5176\u4e2d\u5305\u542b\u6b63\u5f0f\u7684\u6587\u6863\u548c\u793a\u4f8b\u3002Gizmo\u6846\u67b6\u6ca1\u6709\u63d0\u4f9b\u53ef\u9760\u7684\u6587\u6863\uff0c\u552f\u4e00\u7684\u6b63\u5f0f\u6587\u6863\u662f\u4ed3\u5e93\u4e2d\u7684README\u6587\u4ef6\u3002 \u6709\u5173Go Micro\u7684\u5927\u91cf\u4fe1\u606f\u548c\u516c\u544a\uff0c\u8bf7\u8bbf\u95ee micro.mu \uff0c microhq \u548c\u793e\u4ea4\u5a92\u4f53 @MicroHQ \u3002 \u5982\u679c\u4f7f\u7528Go Kit\uff0c\u6700\u597d\u7684\u6587\u6863\u53ef\u5728 Peter Bourgon\u535a\u5ba2 \u4e2d\u627e\u5230\u3002\u6211\u53d1\u73b0\u7684\u6700\u597d\u7684\u4f8b\u5b50\u4e4b\u4e00\u662f\u5728 ru-rocker\u535a\u5ba2 \u4e2d\u3002 \u4f7f\u7528Gizmo\uff0c\u6e90\u4ee3\u7801\u63d0\u4f9b\u4e86\u6700\u4f73\u7684\u6587\u6863\u548c\u793a\u4f8b\u3002 \u7efc\u4e0a\u6240\u8ff0\uff0c\u5982\u679c\u60a8\u6765\u81eaNodeJS\u9886\u57df\uff0c\u5e76\u5e0c\u671b\u770b\u5230\u7c7b\u4f3cExpressJS\u7684\u6559\u7a0b\uff0c\u60a8\u5c06\u611f\u5230\u5931\u671b\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u8fd9\u662f\u521b\u5efa\u81ea\u5df1\u7684\u6559\u7a0b\u7684\u7edd\u4f73\u673a\u4f1a\u3002","title":"\u6587\u6863\u548c\u793a\u4f8b"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_4","text":"Go Kit\u662f\u6700\u6d41\u884c\u7684\u5fae\u670d\u52a1\u6846\u67b6\uff0c\u57fa\u4e8eGitHub\u7edf\u8ba1\u6570\u636e\uff0c\u5b83\u5df2\u8d85\u8fc71\u4e07\u4e94\u5343\u9897\u661f\u3002\u5b83\u6709\u5927\u91cf\u7684\u8d21\u732e\u8005\uff08161\uff09\u548c\u8d85\u8fc71600\u4e2a\u5206\u53c9\u3002\u6700\u540e\uff0cGo Kit\u53d7 DigitalOcean \u652f\u6301\u3002 \u62e5\u67099484\u9897\u661f\uff0c54\u4e2a\u8d21\u732e\u8005\u548c993\u4e2a\u5206\u53c9-Go Micro\u4f4d\u5c45\u7b2c\u4e8c\u3002 Sixt \u662fGo Micro\u7684\u6700\u5927\u8d5e\u52a9\u5546\u4e4b\u4e00\u3002 Gizmo\u7b2c\u4e09\u540d\u3002\u8d85\u8fc72937\u661f\uff0c41\u4e2a\u8d21\u732e\u8005\u548c188\u4e2a\u5206\u53c9\u3002\u7531\u300a\u7ebd\u7ea6\u65f6\u62a5\u300b\u652f\u6301\u548c\u521b\u5efa\u3002","title":"\u7528\u6237\u548c\u793e\u533a"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_5","text":"Go Kit\u5728\u4ee3\u7801\u8d28\u91cf\u7c7b\u522b\u4e2d\u6392\u540d\u7b2c\u4e00\u3002\u5b83\u5177\u6709\u8fd180\uff05\u7684\u4ee3\u7801\u8986\u76d6\u7387\uff0c\u5e76\u4e14\u5177\u6709\u51fa\u8272\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002Gizmo\u4e5f\u5177\u6709\u51fa\u8272\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002\u4f46\u662f\u5b83\u7684\u4ee3\u7801\u8986\u76d6\u7387\u53ea\u670946\uff05\u3002Go Micro\u4e0d\u63d0\u4f9b\u8986\u76d6\u8303\u56f4\u4fe1\u606f\uff0c\u4f46\u786e\u5b9e\u5177\u6709\u5f88\u9ad8\u7684 Go\u62a5\u544a\u8bc4\u7ea7 \u3002 https://goreportcard.com/ \u4ee3\u7801\u8d28\u91cf\u8bc4\u7ea7\u7f51\u7ad9","title":"\u4ee3\u7801\u8d28\u91cf"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_6","text":"\u4e3a\u4e86\u66f4\u597d\u5730\u4e86\u89e3\u6846\u67b6\uff0c\u521b\u5efa\u4e86\u4e09\u4e2a\u7b80\u5355\u7684\u5fae\u670d\u52a1\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u8fd9\u4e9b\u670d\u52a1\u90fd\u5b9e\u73b0\u4e86\u4e00\u4e2a\u4e1a\u52a1\u903b\u8f91\uff1a\u6253\u62db\u547c\uff08greeting\uff09\uff0c\u5f53\u7528\u6237\u5411\u670d\u52a1\u4e2d\u8f93\u5165\u201c\u540d\u79f0\u201d\u53c2\u6570\u65f6\uff0c\u670d\u52a1\u4f1a\u53d1\u9001\u95ee\u5019\u8bed\u4f5c\u4e3a\u54cd\u5e94\u3002\u6240\u6709\u670d\u52a1\u90fd\u6ee1\u8db3\u4ee5\u4e0b\u9700\u6c42\uff1a \u670d\u52a1\u5e94\u81ea\u884c\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c \u670d\u52a1\u5e94\u5177\u6709\u8fd0\u884c\u72b6\u51b5\u68c0\u67e5\u7aef\u70b9 \u670d\u52a1\u5e94\u81f3\u5c11\u652f\u6301HTTP\u548cgRPC\u4f20\u8f93\u534f\u8bae \u5bf9\u4e8e\u559c\u6b22\u9605\u8bfb\u6e90\u4ee3\u7801\u7684\u4eba\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u8bbf\u95ee \u4ed3\u5e93 \u6e90\u4ee3\u7801\u3002","title":"\u7f16\u5199\u5fae\u670d\u52a1"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#gommicro-greeter","text":"\u4f7f\u7528Go Micro\u521b\u5efa\u670d\u52a1\u6240\u9700\u8981\u505a\u7684\u7b2c\u4e00\u4ef6\u4e8b\u662f\u5b9a\u4e49protobuf\u63cf\u8ff0\u3002\u6240\u6709\u8fd9\u4e09\u79cd\u670d\u52a1\u90fd\u4f7f\u7528\u4e86\u76f8\u540c\u7684protobuf\u5b9a\u4e49\u3002\u521b\u5efa\u4e86\u4ee5\u4e0b\u670d\u52a1\u63cf\u8ff0\uff1a syntax = proto3 ; package pb; service Greeter { rpc Greeting(GreetingRequest) returns (GreetingResponse) {} } message GreetingRequest { string name = 1; } message GreetingResponse { string greeting = 2; } \u8fd9\u4e2a\u63a5\u53e3\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5Greeting\uff0c\u5b83\u6709\u4e00\u4e2a\u8bf7\u6c42\u53c2\u6570(name)\u548c\u4e00\u4e2a\u54cd\u5e94\u53c2\u6570(greeting) \u7136\u540e\u4f7f\u7528\u4fee\u6539\u540e\u7684protoc\u4eceprotobuf\u4e2d\u751f\u6210\u670d\u52a1\u63a5\u53e3\uff0c\u8be5 proto\u751f\u6210\u5668 \u662fGo Micro\u7684\u4e00\u4e2a\u5206\u53c9\uff0c\u5e76\u7ecf\u8fc7\u4fee\u6539\u4ee5\u652f\u6301\u8be5\u6846\u67b6\u7684\u67d0\u4e9b\u529f\u80fd\u3002\u5728\u6253\u62db\u547c\u670d\u52a1\u4e2d\u5c06\u6240\u6709\u8fd9\u4e9b\u8fde\u63a5\u5728\u4e00\u8d77\uff0c\u6b64\u65f6\uff0c\u670d\u52a1\u6b63\u5728\u542f\u52a8\u5e76\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u6ce8\u518c\uff0c\u5b83\u4ec5\u652f\u6301gRPC\u4f20\u8f93\u534f\u8bae\u3002 package main import ( log pb github.com/antklim/go-microservices/go-micro-greeter/pb github.com/micro/go-micro golang.org/x/net/context ) // Greeter implements greeter service. type Greeter struct{} // Greeting method implementation. func (g *Greeter) Greeting(ctx context.Context, in *pb.GreetingRequest, out *pb.GreetingResponse) error { out.Greeting = GO-MICRO Hello + in.Name return nil } func main() { service := micro.NewService( micro.Name( go-micro-srv-greeter ), micro.Version( latest ), ) service.Init() pb.RegisterGreeterHandler(service.Server(), new(Greeter)) if err := service.Run(); err != nil { log.Fatal(err) } } \u4e3a\u4e86\u652f\u6301HTTP\u4f20\u8f93\uff0c\u5fc5\u987b\u6dfb\u52a0\u5176\u4ed6\u6a21\u5757\u3002\u5b83\u5c06HTTP\u8bf7\u6c42\u6620\u5c04\u5230protobuf\u5b9a\u4e49\u7684\u8bf7\u6c42\uff0c\u5e76\u8c03\u7528gRPC\u670d\u52a1\u3002\u7136\u540e\uff0c\u5b83\u5c06\u670d\u52a1\u54cd\u5e94\u6620\u5c04\u5230HTTP\u54cd\u5e94\uff0c\u5e76\u5c06\u5176\u54cd\u5e94\u8fd4\u56de\u7ed9\u7528\u6237\u3002 package main import ( context encoding/json log net/http proto github.com/antklim/go-microservices/go-micro-greeter/pb github.com/micro/go-micro/client web github.com/micro/go-web ) func main() { service := web.NewService( web.Name( go-micro-web-greeter ), ) service.HandleFunc( /greeting , func(w http.ResponseWriter, r *http.Request) { if r.Method == GET { var name string vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { name = } else { name = names[0] } cl := proto.NewGreeterClient( go-micro-srv-greeter , client.DefaultClient) rsp, err := cl.Greeting(context.Background(), proto.GreetingRequest{Name: name}) if err != nil { http.Error(w, err.Error(), 500) return } js, err := json.Marshal(rsp) if err != nil { http.Error(w, err.Error(), http.StatusInternalServerError) return } w.Header().Set( Content-Type , application/json ) w.Write(js) return } }) if err := service.Init(); err != nil { log.Fatal(err) } if err := service.Run(); err != nil { log.Fatal(err) } } \u4e00\u65b9\u9762\uff0cGo Micro\u5728\u540e\u53f0\u5904\u7406\u4e86\u8bb8\u591a\u4e8b\u60c5\uff0c\u4f8b\u5982\u5728\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u4e2d\u8fdb\u884c\u6ce8\u518c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u5f88\u96be\u521b\u5efa\u7eafHTTP\u670d\u52a1\u3002","title":"GomMicro greeter"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#go-kit-greeter","text":"\u5728\u5b8c\u6210Go Micro\u4e4b\u540e\uff0c\u7ee7\u7eed\u8fdb\u884cGo Kit\u670d\u52a1\u7684\u5b9e\u73b0\u3002\u6211\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u9605\u8bfbGo Kit\u5b58\u50a8\u5e93\u4e2d\u63d0\u4f9b\u7684\u4ee3\u7801\u793a\u4f8b\u3002\u4e86\u89e3\u7aef\u70b9\u7684\u6982\u5ff5\u82b1\u4e86\u5f88\u591a\u65f6\u95f4\u3002\u4e0b\u4e00\u4e2a\u8017\u65f6\u7684\u96be\u9898\u662f\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3\u4ee3\u7801\u3002\u5728\u627e\u5230\u4e00\u4e2a\u5f88\u597d\u7684 \u4f8b\u5b50 \u4e4b\u524d\uff0c\u6211\u65e0\u6cd5\u5b9e\u73b0\u5b83\u3002 \u6700\u540e\uff0c\u521b\u5efa\u4e86\u56db\u4e2a\u5305\u7528\u4e8e\uff1a \u670d\u52a1\u903b\u8f91\u5b9e\u73b0 \u4f20\u8f93\u4e0d\u53ef\u77e5\u670d\u52a1\u7aef\u70b9 \u4f20\u8f93\u7279\u5b9a\u7aef\u70b9\uff08gRPC\u3001HTTP\uff09 \u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u4e2d\u5fc3 \u670d\u52a1\u903b\u8f91\u5b9e\u73b0\u5982\u4e0b\u6240\u793a\uff0c\u4ee3\u7801\u6ca1\u6709\u4efb\u4f55\u4f9d\u8d56\u5173\u7cfb\uff0c\u5b83\u53ea\u662f\u5b9e\u73b0\u903b\u8f91\u3002 package greeterservice // Service describe greetings service. type Service interface { Health() bool Greeting(name string) string } // GreeterService implementation of the Service interface. type GreeterService struct{} // Health implementation of the Service. func (GreeterService) Health() bool { return true } // Greeting implementation of the Service. func (GreeterService) Greeting(name string) (greeting string) { greeting = GO-KIT Hello + name return } \u4e0b\u4e00\u6bb5\u4ee3\u7801\u663e\u793a\u4e86\u7aef\u70b9\u5b9a\u4e49\uff1a package greeterendpoint import ( context github.com/go-kit/kit/log github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice github.com/go-kit/kit/endpoint ) // \u7aef\u70b9\u96c6\u5408\u6536\u96c6\u6253\u62db\u547c\u670d\u52a1\u7684\u6240\u6709\u7aef\u70b9\uff0c\u5b83\u65e8\u5728\u7528\u4f5c\u8f85\u52a9\u7ed3\u6784\u5c06\u6240\u6709\u7aef\u70b9\u6536\u96c6\u5230\u5355\u4e2a\u53c2\u6570 type Endpoints struct { HealthEndpoint endpoint.Endpoint // used by Consul for the healthcheck GreetingEndpoint endpoint.Endpoint } // MakeServerEndpoints\u8fd4\u56de\u670d\u52a1\u7aef\u70b9\uff0c\u5e76\u5728\u6240\u6709\u63d0\u4f9b\u7684\u4e2d\u95f4\u4ef6\u4e2d\u8fdb\u884c\u8fde\u7ebf func MakeServerEndpoints(s greeterservice.Service, logger log.Logger) Endpoints { var healthEndpoint endpoint.Endpoint { healthEndpoint = MakeHealthEndpoint(s) healthEndpoint = LoggingMiddleware(log.With(logger, method , Health ))(healthEndpoint) } var greetingEndpoint endpoint.Endpoint { greetingEndpoint = MakeGreetingEndpoint(s) greetingEndpoint = LoggingMiddleware(log.With(logger, method , Greeting ))(greetingEndpoint) } return Endpoints{ HealthEndpoint: healthEndpoint, GreetingEndpoint: greetingEndpoint, } } // MakeHealthEndpoint\u6784\u9020Health\u7aef\u70b9\u6765\u5305\u88c5\u670d\u52a1 func MakeHealthEndpoint(s greeterservice.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { healthy := s.Health() return HealthResponse{Healthy: healthy}, nil } } // MakeHealthEndpoint\u6784\u9020Greeter\u7aef\u70b9\u6765\u5305\u88c5\u670d\u52a1 func MakeGreetingEndpoint(s greeterservice.Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { req := request.(GreetingRequest) greeting := s.Greeting(req.Name) return GreetingResponse{Greeting: greeting}, nil } } // Failer\u662f\u5e94\u8be5\u7531\u54cd\u5e94\u7c7b\u578b\u5b9e\u73b0\u7684\u63a5\u53e3 // \u54cd\u5e94\u7f16\u7801\u5668\u53ef\u4ee5\u68c0\u67e5\u54cd\u5e94\u662f\u5426\u4e3aFailer\uff0c\u5982\u679c\u662fFailer\uff0c // \u5224\u65ad\u662f\u5426\u5931\u8d25\uff0c\u6216\u8005\u662f\u5426\u57fa\u4e8e\u9519\u8bef\u4f7f\u7528\u5355\u72ec\u7684\u5199\u5165\u8def\u5f84\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801 type Failer interface { Failed() error } // HealthRequest\u6536\u96c6Health\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570 type HealthRequest struct{} // HealthResponse\u6536\u96c6Health\u65b9\u6cd5\u7684\u54cd\u5e94\u503c type HealthResponse struct { Healthy bool `json: healthy,omitempty ` Err error `json: err,omitempty ` } // Failed\u5b9e\u73b0Failer\u63a5\u53e3 func (r HealthResponse) Failed() error { return r.Err } // GreetingRequest\u6536\u96c6Greeting\u65b9\u6cd5\u7684\u8bf7\u6c42\u53c2\u6570 type GreetingRequest struct { Name string `json: name,omitempty ` } // GreetingResponse\u6536\u96c6Greeting\u65b9\u6cd5\u7684\u54cd\u5e94\u503c type GreetingResponse struct { Greeting string `json: greeting,omitempty ` Err error `json: err,omitempty ` } // Failed\u5b9e\u73b0Failer\u63a5\u53e3 func (r GreetingResponse) Failed() error { return r.Err } \u5b9a\u4e49\u670d\u52a1\u548c\u7aef\u70b9\u540e\uff0c\u901a\u8fc7\u4e0d\u540c\u7684\u4f20\u8f93\u534f\u8bae\u66b4\u9732\u7aef\u70b9\u3002\u4eceHTTP\u4f20\u8f93\u5f00\u59cb\uff1a package greetertransport import ( context encoding/json errors net/http github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/go-kit/kit/log httptransport github.com/go-kit/kit/transport/http github.com/gorilla/mux ) var ( // \u5982\u679c\u7f3a\u5c11\u9884\u671f\u7684\u8def\u5f84\u53d8\u91cf\uff0c\u5219\u8fd4\u56deErrBadRouting ErrBadRouting = errors.New( inconsistent mapping between route and handler ) ) // NewHTTPHandler\u8fd4\u56de\u4e00\u4e2aHTTP\u5904\u7406\u7a0b\u5e8f\uff0c\u8be5\u5904\u7406\u7a0b\u5e8f\u4f7f\u4e00\u7ec4\u7aef\u70b9\u5728\u9884\u5b9a\u4e49\u8def\u5f84\u4e0a\u53ef\u7528 func NewHTTPHandler(endpoints greeterendpoint.Endpoints, logger log.Logger) http.Handler { m := mux.NewRouter() options := []httptransport.ServerOption{ httptransport.ServerErrorEncoder(encodeError), httptransport.ServerErrorLogger(logger), } // GET /health retrieves service heath information // GET /greeting?name retrieves greeting m.Methods( GET ).Path( /health ).Handler(httptransport.NewServer( endpoints.HealthEndpoint, DecodeHTTPHealthRequest, EncodeHTTPGenericResponse, options..., )) m.Methods( GET ).Path( /greeting ).Handler(httptransport.NewServer( endpoints.GreetingEndpoint, DecodeHTTPGreetingRequest, EncodeHTTPGenericResponse, options..., )) return m } // DecodeHTTPHealthRequest method. func DecodeHTTPHealthRequest(_ context.Context, _ *http.Request) (interface{}, error) { return greeterendpoint.HealthRequest{}, nil } // DecodeHTTPGreetingRequest method. func DecodeHTTPGreetingRequest(_ context.Context, r *http.Request) (interface{}, error) { vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { return nil, ErrBadRouting } req := greeterendpoint.GreetingRequest{Name: names[0]} return req, nil } func encodeError(_ context.Context, err error, w http.ResponseWriter) { w.WriteHeader(err2code(err)) json.NewEncoder(w).Encode(errorWrapper{Error: err.Error()}) } func err2code(err error) int { switch err { default: return http.StatusInternalServerError } } type errorWrapper struct { Error string `json: error ` } // EncodeHTTPGenericResponse\u662f`transport/http.EncodeResponseFunc`\uff0c\u5b83\u5c06\u54cd\u5e94\u7f16\u7801\u4e3aJSON\u7f16\u7801\u5230\u54cd\u5e94\u7f16\u5199\u5668 func EncodeHTTPGenericResponse(ctx context.Context, w http.ResponseWriter, response interface{}) error { if f, ok := response.(greeterendpoint.Failer); ok f.Failed() != nil { encodeError(ctx, f.Failed(), w) return nil } w.Header().Set( Content-Type , application/json; charset=utf-8 ) return json.NewEncoder(w).Encode(response) } \u5728\u5f00\u59cbgRPC\u7aef\u70b9\u5b9e\u73b0\u4e4b\u524d\uff0c\u4e0d\u9700\u8981protobuf\u5b9a\u4e49\u3002\u76f4\u63a5\u590d\u5236\u4e0a\u9762Go Micro\u670d\u52a1\u7684protobuf\u5b9a\u4e49\u3002\u4f46\u662f\u5bf9\u4e8eGo Kit\uff0c\u4f7f\u7528\u9ed8\u8ba4\u7684\u670d\u52a1\u751f\u6210\u5668\u6765\u521b\u5efa\u670d\u52a1\u63a5\u53e3\u3002 protoc greeter.proto --go_out=plugins=grpc:. package greetertransport import ( context github.com/antklim/go-microservices/go-kit-greeter/pb github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/go-kit/kit/log grpctransport github.com/go-kit/kit/transport/grpc oldcontext golang.org/x/net/context ) type grpcServer struct { greeter grpctransport.Handler } // NewGRPCServer\u4f7f\u4e00\u7ec4\u7aef\u70b9\u53ef\u7528\u4f5cgRPC GreeterServer func NewGRPCServer(endpoints greeterendpoint.Endpoints, logger log.Logger) pb.GreeterServer { options := []grpctransport.ServerOption{ grpctransport.ServerErrorLogger(logger), } return grpcServer{ greeter: grpctransport.NewServer( endpoints.GreetingEndpoint, decodeGRPCGreetingRequest, encodeGRPCGreetingResponse, options..., ), } } // Greeting\u5b9e\u73b0GreeterService\u63a5\u53e3\u7684\u65b9\u6cd5 func (s *grpcServer) Greeting(ctx oldcontext.Context, req *pb.GreetingRequest) (*pb.GreetingResponse, error) { _, res, err := s.greeter.ServeGRPC(ctx, req) if err != nil { return nil, err } return res.(*pb.GreetingResponse), nil } // encodeGRPCGreetingRequest\u662f\u4e00\u4e2a`transport/grpc.DecodeRequestFunc`\uff0c\u5b83\u5c06gRPC\u95ee\u5019\u8bf7\u6c42\u8f6c\u6362\u4e3a\u7528\u6237\u57df\u95ee\u5019\u8bf7\u6c42 func decodeGRPCGreetingRequest(_ context.Context, grpcReq interface{}) (interface{}, error) { req := grpcReq.(*pb.GreetingRequest) return greeterendpoint.GreetingRequest{Name: req.Name}, nil } // encodeGRPCGreetingResponse\u662f`transport/grpc.EncodeResponseFunc`\uff0c\u5b83\u5c06\u7528\u6237\u57df\u95ee\u5019\u54cd\u5e94\u8f6c\u6362\u4e3agRPC\u95ee\u5019\u54cd\u5e94 func encodeGRPCGreetingResponse(_ context.Context, response interface{}) (interface{}, error) { res := response.(greeterendpoint.GreetingResponse) return pb.GreetingResponse{Greeting: res.Greeting}, nil } \u6700\u540e\uff0c\u5b9e\u73b0\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u5668\uff1a package greetersd import ( math/rand os strconv time github.com/go-kit/kit/log github.com/go-kit/kit/sd consulsd github.com/go-kit/kit/sd/consul github.com/hashicorp/consul/api ) // ConsulRegister method. func ConsulRegister(consulAddress string, consulPort string, advertiseAddress string, advertisePort string) (registar sd.Registrar) { // Logging domain. var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.With(logger, ts , log.DefaultTimestampUTC) logger = log.With(logger, caller , log.DefaultCaller) } rand.Seed(time.Now().UTC().UnixNano()) // Service discovery domain. In this example we use Consul. var client consulsd.Client { consulConfig := api.DefaultConfig() consulConfig.Address = consulAddress + : + consulPort consulClient, err := api.NewClient(consulConfig) if err != nil { logger.Log( err , err) os.Exit(1) } client = consulsd.NewClient(consulClient) } check := api.AgentServiceCheck{ HTTP: http:// + advertiseAddress + : + advertisePort + /health , Interval: 10s , Timeout: 1s , Notes: Basic health checks , } port, _ := strconv.Atoi(advertisePort) num := rand.Intn(100) // to make service ID unique asr := api.AgentServiceRegistration{ ID: go-kit-srv-greeter- + strconv.Itoa(num), //unique service ID Name: go-kit-srv-greeter , Address: advertiseAddress, Port: port, Tags: []string{ go-kit , greeter }, Check: check, } registar = consulsd.NewRegistrar(client, asr, logger) return } \u51c6\u5907\u597d\u6240\u6709\u6784\u5efa\u5757\u4e4b\u540e\uff0c\u6211\u5c06\u5b83\u4eec\u8fde\u63a5\u5230\u670d\u52a1\u542f\u52a8\u5668\u4e2d\uff1a package main import ( flag fmt net net/http os os/signal syscall text/tabwriter github.com/antklim/go-microservices/go-kit-greeter/pb google.golang.org/grpc github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterendpoint github.com/antklim/go-microservices/go-kit-greeter/pkg/greetersd github.com/antklim/go-microservices/go-kit-greeter/pkg/greeterservice github.com/antklim/go-microservices/go-kit-greeter/pkg/greetertransport github.com/go-kit/kit/log github.com/oklog/oklog/pkg/group ) func main() { fs := flag.NewFlagSet( greetersvc , flag.ExitOnError) var ( debugAddr = fs.String( debug.addr , :9100 , Debug and metrics listen address ) consulAddr = fs.String( consul.addr , , Consul Address ) consulPort = fs.String( consul.port , 8500 , Consul Port ) httpAddr = fs.String( http.addr , , HTTP Listen Address ) httpPort = fs.String( http.port , 9110 , HTTP Listen Port ) grpcAddr = fs.String( grpc-addr , :9120 , gRPC listen address ) ) fs.Usage = usageFor(fs, os.Args[0]+ [flags] ) fs.Parse(os.Args[1:]) var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.With(logger, ts , log.DefaultTimestampUTC) logger = log.With(logger, caller , log.DefaultCaller) } var service greeterservice.Service { service = greeterservice.GreeterService{} service = greeterservice.LoggingMiddleware(logger)(service) } var ( endpoints = greeterendpoint.MakeServerEndpoints(service, logger) httpHandler = greetertransport.NewHTTPHandler(endpoints, logger) registar = greetersd.ConsulRegister(*consulAddr, *consulPort, *httpAddr, *httpPort) grpcServer = greetertransport.NewGRPCServer(endpoints, logger) ) var g group.Group { // The debug listener mounts the http.DefaultServeMux, and serves up // stuff like the Go debug and profiling routes, and so on. debugListener, err := net.Listen( tcp , *debugAddr) if err != nil { logger.Log( transport , debug/HTTP , during , Listen , err , err) os.Exit(1) } g.Add(func() error { logger.Log( transport , debug/HTTP , addr , *debugAddr) return http.Serve(debugListener, http.DefaultServeMux) }, func(error) { debugListener.Close() }) } { // The service discovery registration. g.Add(func() error { logger.Log( transport , HTTP , addr , *httpAddr, port , *httpPort) registar.Register() return http.ListenAndServe( : +*httpPort, httpHandler) }, func(error) { registar.Deregister() }) } { // The gRPC listener mounts the Go kit gRPC server we created. grpcListener, err := net.Listen( tcp , *grpcAddr) if err != nil { logger.Log( transport , gRPC , during , Listen , err , err) os.Exit(1) } g.Add(func() error { logger.Log( transport , gRPC , addr , *grpcAddr) baseServer := grpc.NewServer() pb.RegisterGreeterServer(baseServer, grpcServer) return baseServer.Serve(grpcListener) }, func(error) { grpcListener.Close() }) } { // This function just sits and waits for ctrl-C. cancelInterrupt := make(chan struct{}) g.Add(func() error { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) select { case sig := -c: return fmt.Errorf( received signal %s , sig) case -cancelInterrupt: return nil } }, func(error) { close(cancelInterrupt) }) } logger.Log( exit , g.Run()) } func usageFor(fs *flag.FlagSet, short string) func() { return func() { fmt.Fprintf(os.Stderr, USAGE\\n ) fmt.Fprintf(os.Stderr, %s\\n , short) fmt.Fprintf(os.Stderr, \\n ) fmt.Fprintf(os.Stderr, FLAGS\\n ) w := tabwriter.NewWriter(os.Stderr, 0, 2, 2, ' ', 0) fs.VisitAll(func(f *flag.Flag) { fmt.Fprintf(w, \\t-%s %s\\t%s\\n , f.Name, f.DefValue, f.Usage) }) w.Flush() fmt.Fprintf(os.Stderr, \\n ) } } \u5728\u51e0\u4e2a\u5730\u65b9\u4f7f\u7528\u4e86\u65e5\u5fd7\u8bb0\u5f55\u4e2d\u95f4\u4ef6\u3002\u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u5c06\u65e5\u5fd7\u8bb0\u5f55\u903b\u8f91\u4e0e\u4e3b\u8981\u670d\u52a1/\u7aef\u70b9\u5de5\u4f5c\u6d41\u5206\u79bb\u3002 package greeterservice import ( time github.com/go-kit/kit/log ) // ServiceMiddleware\u63cf\u8ff0\u4e86\u670d\u52a1\u4e2d\u95f4\u4ef6 type ServiceMiddleware func(Service) Service // LoggingMiddleware\u5c06\u8bb0\u5f55\u5668\u4f5c\u4e3a\u4f9d\u8d56\u9879\uff0c\u5e76\u8fd4\u56deServiceMiddleware\u3002 func LoggingMiddleware(logger log.Logger) ServiceMiddleware { return func(next Service) Service { return loggingMiddleware{next, logger} } } type loggingMiddleware struct { Service logger log.Logger } func (m loggingMiddleware) Health() (healthy bool) { defer func(begin time.Time) { m.logger.Log( method , Health , healthy , healthy, took , time.Since(begin), ) }(time.Now()) healthy = m.Service.Health() return } func (m loggingMiddleware) Greeting(name string) (greeting string) { defer func(begin time.Time) { m.logger.Log( method , Greeting , name , name, greeting , greeting, took , time.Since(begin), ) }(time.Now()) greeting = m.Service.Greeting(name) return } package greeterendpoint import ( context time github.com/go-kit/kit/endpoint github.com/go-kit/kit/log ) // LoggingMiddleware\u8fd4\u56de\u4e00\u4e2a\u7aef\u70b9\u4e2d\u95f4\u4ef6\uff0c\u8be5\u4e2d\u95f4\u4ef6\u8bb0\u5f55\u6bcf\u6b21\u8c03\u7528\u7684\u6301\u7eed\u65f6\u95f4\u4ee5\u53ca\u6240\u4ea7\u751f\u7684\u9519\u8bef\uff08\u5982\u679c\u6709\uff09 func LoggingMiddleware(logger log.Logger) endpoint.Middleware { return func(next endpoint.Endpoint) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (response interface{}, err error) { defer func(begin time.Time) { logger.Log( transport_error , err, took , time.Since(begin)) }(time.Now()) return next(ctx, request) } } }","title":"Go Kit greeter"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#gizmo-greeter","text":"\u4ee5\u4e0eGo Kit\u7c7b\u4f3c\u7684\u65b9\u5f0f\u521b\u5efa\u4e86Gizmo\u670d\u52a1\u3002\u4e3a\u670d\u52a1\uff0c\u7aef\u70b9\uff0c\u4f20\u8f93\u548c\u670d\u52a1\u53d1\u73b0\u6ce8\u518c\u5668\u5b9a\u4e49\u4e86\u56db\u4e2a\u5305\u3002\u670d\u52a1\u5b9e\u73b0\u548c\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf\u6ce8\u518c\u4e2d\u5fc3\u4e0eGo Kit\u670d\u52a1\u5171\u4eab\u76f8\u540c\u7684\u4ee3\u7801\u3002\u4f46\u662f\u7aef\u70b9\u5b9a\u4e49\u548c\u4f20\u8f93\u5b9e\u73b0\u5fc5\u987b\u6839\u636eGizmo\u7684\u529f\u80fd\u6765\u5b8c\u6210\u3002 package greeterendpoint import ( net/http ocontext golang.org/x/net/context github.com/NYTimes/gizmo/server github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterservice ) // Endpoints collects all of the endpoints that compose a greeter service. type Endpoints struct { HealthEndpoint server.JSONContextEndpoint GreetingEndpoint server.JSONContextEndpoint } // MakeServerEndpoints returns service Endoints func MakeServerEndpoints(s greeterservice.Service) Endpoints { healthEndpoint := MakeHealthEndpoint(s) greetingEndpoint := MakeGreetingEndpoint(s) return Endpoints{ HealthEndpoint: healthEndpoint, GreetingEndpoint: greetingEndpoint, } } // MakeHealthEndpoint constructs a Health endpoint. func MakeHealthEndpoint(s greeterservice.Service) server.JSONContextEndpoint { return func(ctx ocontext.Context, r *http.Request) (int, interface{}, error) { healthy := s.Health() return http.StatusOK, HealthResponse{Healthy: healthy}, nil } } // MakeGreetingEndpoint constructs a Greeting endpoint. func MakeGreetingEndpoint(s greeterservice.Service) server.JSONContextEndpoint { return func(ctx ocontext.Context, r *http.Request) (int, interface{}, error) { vars := r.URL.Query() names, exists := vars[ name ] if !exists || len(names) != 1 { return http.StatusBadRequest, errorResponse{Error: query parameter 'name' required }, nil } greeting := s.Greeting(names[0]) return http.StatusOK, GreetingResponse{Greeting: greeting}, nil } } // HealthRequest collects the request parameters for the Health method. type HealthRequest struct{} // HealthResponse collects the response values for the Health method. type HealthResponse struct { Healthy bool `json: healthy,omitempty ` } // GreetingRequest collects the request parameters for the Greeting method. type GreetingRequest struct { Name string `json: name,omitempty ` } // GreetingResponse collects the response values for the Greeting method. type GreetingResponse struct { Greeting string `json: greeting,omitempty ` } type errorResponse struct { Error string `json: error ` } \u5982\u4e0a\u6240\u793a\uff0c\u8be5\u4ee3\u7801\u6bb5\u7c7b\u4f3c\u4e8eGo Kit\u3002\u4e3b\u8981\u533a\u522b\u5728\u4e8e\u5e94\u8fd4\u56de\u7684\u63a5\u53e3\u7c7b\u578b\uff1a package greetertransport import ( context github.com/NYTimes/gizmo/server google.golang.org/grpc errors net/http github.com/NYTimes/gziphandler pb github.com/antklim/go-microservices/gizmo-greeter/pb github.com/antklim/go-microservices/gizmo-greeter/pkg/greeterendpoint github.com/sirupsen/logrus ) type ( // TService will implement server.RPCService and handle all requests to the server. TService struct { Endpoints greeterendpoint.Endpoints } // Config is a struct to contain all the needed // configuration for our JSONService. Config struct { Server *server.Config } ) // NewTService will instantiate a RPCService with the given configuration. func NewTService(cfg *Config, endpoints greeterendpoint.Endpoints) *TService { return TService{Endpoints: endpoints} } // Prefix returns the string prefix used for all endpoints within this service. func (s *TService) Prefix() string { return } // Service provides the TService with a description of the service to serve and // the implementation. func (s *TService) Service() (*grpc.ServiceDesc, interface{}) { return pb.Greeter_serviceDesc, s } // Middleware provides an http.Handler hook wrapped around all requests. // In this implementation, we're using a GzipHandler middleware to // compress our responses. func (s *TService) Middleware(h http.Handler) http.Handler { return gziphandler.GzipHandler(h) } // ContextMiddleware provides a server.ContextHAndler hook wrapped around all // requests. This could be handy if you need to decorate the request context. func (s *TService) ContextMiddleware(h server.ContextHandler) server.ContextHandler { return h } // JSONMiddleware provides a JSONEndpoint hook wrapped around all requests. // In this implementation, we're using it to provide application logging and to check errors // and provide generic responses. func (s *TService) JSONMiddleware(j server.JSONContextEndpoint) server.JSONContextEndpoint { return func(ctx context.Context, r *http.Request) (int, interface{}, error) { status, res, err := j(ctx, r) if err != nil { server.LogWithFields(r).WithFields(logrus.Fields{ error : err, }).Error( problems with serving request ) return http.StatusServiceUnavailable, nil, errors.New( sorry, this service is unavailable ) } server.LogWithFields(r).Info( success! ) return status, res, nil } } // ContextEndpoints may be needed if your server has any non-RPC-able // endpoints. In this case, we have none but still need this method to // satisfy the server.RPCService interface. func (s *TService) ContextEndpoints() map[string]map[string]server.ContextHandlerFunc { return map[string]map[string]server.ContextHandlerFunc{} } // JSONEndpoints is a listing of all endpoints available in the TService. func (s *TService) JSONEndpoints() map[string]map[string]server.JSONContextEndpoint { return map[string]map[string]server.JSONContextEndpoint{ /health : map[string]server.JSONContextEndpoint{ GET : s.Endpoints.HealthEndpoint, }, /greeting : map[string]server.JSONContextEndpoint{ GET : s.Endpoints.GreetingEndpoint, }, } } package greetertransport import ( pb github.com/antklim/go-microservices/gizmo-greeter/pb ocontext golang.org/x/net/context ) // Greeting implementation of the gRPC service. func (s *TService) Greeting(ctx ocontext.Context, r *pb.GreetingRequest) (*pb.GreetingResponse, error) { return pb.GreetingResponse{Greeting: Hola Gizmo RPC + r.Name}, nil } Go Kit\u548cGizmo\u4e4b\u95f4\u7684\u660e\u663e\u533a\u522b\u5728\u4e8e\u4f20\u8f93\u65b9\u5f0f\u3002 Gizmo\u63d0\u4f9b\u4e86\u51e0\u79cd\u53ef\u4ee5\u5229\u7528\u7684\u670d\u52a1\u7c7b\u578b\u3002\u8981\u505a\u7684\u5c31\u662f\u5c06HTTP\u8def\u5f84\u6620\u5c04\u5230\u7aef\u70b9\u5b9a\u4e49\u3002\u4f4e\u7ea7HTTP\u8bf7\u6c42/\u54cd\u5e94\u5904\u7406\u7531Gizmo\u5904\u7406\u3002","title":"Gizmo greeter"},{"location":"Frameworks/\u5fae\u670d\u52a1\u6846\u67b6\u5bf9\u6bd4/#_7","text":"Go Micro\u662f\u542f\u52a8\u5fae\u670d\u52a1\u7cfb\u7edf\u7684\u6700\u5feb\u65b9\u6cd5\u3002\u6846\u67b6\u63d0\u4f9b\u4e86\u8bb8\u591a\u529f\u80fd\u3002\u56e0\u6b64\uff0c\u65e0\u9700\u91cd\u65b0\u53d1\u660e\u8f6e\u5b50\u3002\u4f46\u662f\uff0c\u8fd9\u79cd\u8212\u9002\u6027\u548c\u901f\u5ea6\u4f1a\u727a\u7272\u7075\u6d3b\u6027\u3002\u66f4\u6539\u6216\u66f4\u65b0\u7cfb\u7edf\u90e8\u4ef6\u5e76\u4e0d\u50cfGo Kit\u90a3\u6837\u5bb9\u6613\u3002\u5e76\u4e14\u5c06gRPC\u5f3a\u5236\u4e3a\u4e00\u7b49\u7684\u901a\u4fe1\u7c7b\u578b\u3002 \u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u65f6\u95f4\u6765\u719f\u6089Go Kit\u3002\u5b83\u9700\u8981\u5177\u5907Go\u8bed\u8a00\u7279\u6027\u7684\u4e30\u5bcc\u77e5\u8bc6\u548c\u8f6f\u4ef6\u67b6\u6784\u65b9\u9762\u7684\u7ecf\u9a8c\u3002\u53e6\u4e00\u65b9\u9762\uff0c\u6ca1\u6709\u6846\u67b6\u9650\u5236\u3002\u6240\u6709\u90e8\u4ef6\u5747\u53ef\u72ec\u7acb\u66f4\u6539\u548c\u66f4\u65b0\u3002 Gizmo\u4f4d\u4e8eGo Micro\u548cGo Kit\u4e4b\u95f4\u3002\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e9b\u66f4\u9ad8\u7ea7\u522b\u7684\u62bd\u8c61\uff0c\u4f8b\u5982Service\u5305\u3002\u4f46\u662f\u7f3a\u5c11\u6587\u6863\u548c\u793a\u4f8b\uff0c\u8fd9\u610f\u5473\u7740\u4e0d\u5f97\u4e0d\u901a\u8bfb\u6e90\u4ee3\u7801\u4ee5\u4e86\u89e3\u4e0d\u540c\u670d\u52a1\u7c7b\u578b\u7684\u5de5\u4f5c\u65b9\u5f0f\u3002\u4f7f\u7528Gizmo\u6bd4\u4f7f\u7528Go Kit\u5bb9\u6613\u3002\u4f46\u662f\u5b83\u4e0d\u50cfGo Micro\u90a3\u6837\u6d41\u7545\u3002","title":"\u603b\u7ed3"},{"location":"Frameworks/Go-Web/HTTP/HTTP/","text":"HTTP HTTP\u8bf7\u6c42 HTTP\u662f\u4e00\u79cd\u8bf7\u6c42-\u76f8\u5e94\u534f\u8bae\uff0c\u534f\u8bae\u6d89\u53ca\u7684\u6240\u6709\u4e8b\u60c5\u90fd\u662f\u4ee5\u4e00\u4e2a\u8bf7\u6c42\u5f00\u59cb\u3002HTTP\u8bf7\u6c42\u8ddf\u5176\u4ed6\u6240\u6709HTTP\u62a5\u6587\u4e00\u6837\uff0c\u90fd\u662f\u7531\u4e00\u7cfb\u5217\u6587\u672c\u884c\u7ec4\u6210\uff0c\u8fd9\u4e9b\u6587\u672c\u884c\u4f1a\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u8fdb\u884c\u6392\u5217\uff1a \u8bf7\u6c42\u884c\uff08request-line\uff09 \u96f6\u4e2a\u6216\u4efb\u610f\u591a\u4e2a\u8bf7\u6c42\u9996\u90e8\uff08header\uff09 \u4e00\u4e2a\u7a7a\u884c \u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53\uff08body\uff09 \u4e00\u4e2a\u5178\u578b\u7684HTTP\u8bf7\u6c42\uff0c\u5982\u4e0b\u6240\u793a\uff1a GET /Protocols/rfc2616/rfc2616.html HTTP/1.1 // \u8bf7\u6c42\u884c Host: www.w3.org // \u8bf7\u6c42\u9996\u90e8 User-Agent: Mozilla/5.0 // \u8bf7\u6c42\u9996\u90e8 (empty line) // \u7a7a\u884c\uff0c\u5fc5\u987b\u5b58\u5728 // \u53ef\u9009\u62a5\u6587\u4e3b\u4f53\u90e8\u5206\u4e3a\u7a7a \u8bf7\u6c42\u884c\uff1a \u7b2c\u4e00\u4e2a\u5355\u8bcd\u662f\u8bf7\u6c42\u65b9\u6cd5\uff08request method\uff09 \u4e4b\u540e\u662f\u7edf\u4e00\u8d44\u6e90\u6807\u8bc6\u7b26\uff08Uniform Resource Identifier\uff0cURI\uff09 \u4ee5\u53ca\u6240\u4f7f\u7528\u7684HTTP\u7248\u672c \u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53\uff1a\u62a5\u6587\u662f\u5426\u5305\u542b\u4e3b\u4f53\u9700\u8981\u6839\u636e\u8bf7\u6c42\u4f7f\u7528\u7684\u65b9\u6cd5\u800c\u5b9a \u8bf7\u6c42\u65b9\u6cd5 \u8bf7\u6c42\u65b9\u6cd5\u662f\u8bf7\u6c42\u884c\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5355\u8bcd\uff0c\u6307\u660e\u4e86\u5ba2\u6237\u7aef\u60f3\u8981\u5bf9\u8d44\u6e90\u6267\u884c\u7684\u64cd\u4f5c\u3002 HTTP0.9\uff1a\u53ea\u6709GET\u4e00\u4e2a\u65b9\u6cd5 HTTP1.0\uff1a\u6dfb\u52a0\u4e86POST\u548cHEAD\u65b9\u6cd5 HTTP1.1\uff1a\u6dfb\u52a0\u4e86PUT\u3001DELETE\u3001OPTIONS\u3001TRACE\u548cCONNECT\uff0c\u5141\u8bb8\u5f00\u53d1\u7740\u81ea\u884c\u6dfb\u52a0\u66f4\u591a\u65b9\u6cd5 HTTP1.1\u8981\u53bb\u5fc5\u987b\u5b9e\u73b0\u7684\u53ea\u6709GET\u548cHEAD\u65b9\u6cd5\uff0c\u5176\u4ed6\u65b9\u6cd5\u7684\u5b9e\u73b0\u662f\u53ef\u9009\u7684\u3002 \u5404\u4e2aHTTP\u65b9\u6cd5\u7684\u4f5c\u7528\u8bf4\u660e\uff1a \u65b9\u6cd5 \u63cf\u8ff0 \u8bf4\u660e \u662f\u5426\u5b89\u5168 \u662f\u5426\u5e42\u7b49 GET \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u6307\u5b9a\u7684\u8d44\u6e90 \u662f HEAD \u4e0eGET\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5728\u4e8e\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u8981\u6c42\u670d\u52a1\u5668\u8fd4\u56de\u62a5\u6587\u7684\u4e3b\u4f53 \u901a\u5e38\u7528\u4e8e\u5728\u4e0d\u83b7\u53d6\u62a5\u6587\u4e3b\u4f53\u7684\u60c5\u51b5\u4e0b\uff0c\u83b7\u53d6\u76f8\u5e94\u7684\u9996\u90e8 \u662f POST \u547d\u4ee4\u670d\u52a1\u5668\u5c06\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u4f20\u9012\u7ed9URI\u6307\u5b9a\u7684\u8d44\u6e90\uff0c\u81f3\u4e8e\u670d\u52a1\u5668\u5177\u4f53\u4f1a\u5bf9\u8fd9\u4e9b\u6570\u636e\u6267\u884c\u4ec0\u4e48\u52a8\u4f5c\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u672c\u8eab \u4e0d\u662f PUT \u547d\u4ee4\u670d\u52a1\u5668\u5c06\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u8bbe\u7f6e\u4e3aURI\u6307\u5b9a\u7684\u8d44\u6e90 \u5982\u679cURI\u6307\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u5df2\u7ecf\u6709\u6570\u636e\u5b58\u5728\uff0c\u90a3\u4e48\u4f7f\u7528\u62a5\u6587\u4e3b\u4f53\u7684\u6570\u636e\u53bb\u66ff\u4ee3\u5df2\u6709\u7684\u6570\u636e,\u5982\u679c\u8d44\u6e90\u5c1a\u672a\u5b58\u5728\uff0c\u90a3\u4e48\u5728URI\u6307\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u65b0\u521b\u5efa\u4e00\u4e2a\u8d44\u6e90 \u4e0d\u662f \u5e42\u7b49 DELETE \u547d\u4ee4\u670d\u52a1\u5668\u5220\u9664URI\u6307\u5b9a\u7684\u8d44\u6e90 \u4e0d\u662f \u5e42\u7b49 TRACE \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u8bf7\u6c42\u672c\u8eab \u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u77e5\u9053\u4ecb\u4e8e\u5b83\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u5176\u4ed6\u670d\u52a1\u5668\u662f\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u7684 \u662f OPTIONS \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u5b83\u652f\u6301\u7684HTTP\u65b9\u6cd5\u5217\u8868 \u662f CONNECT \u547d\u4ee4\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u5efa\u7acb\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u8bbe\u7f6eSSL\u96a7\u9053\u5df2\u5f00\u542fHTTPS\u529f\u80fd PATCH \u547d\u4ee4\u670d\u52a1\u5668\u4f7f\u7528\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u5bf9URI\u6307\u5b9a\u7684\u8d44\u6e90\u8fdb\u884c\u4fee\u6539 \u5b89\u5168\u7684\u65b9\u6cd5\uff1a\u5982\u679c\u4e00\u4e2aHTTP\u65b9\u6cd5\u53ea\u8981\u6c42\u670d\u52a1\u5668\u63d0\u4f9b\u4fe1\u606f\u800c\u4e0d\u4f1a\u5bf9\u670d\u52a1\u5668\u7684\u72b6\u6001\u505a\u4efb\u4f55\u4fee\u6539\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5b89\u5168\u7684\u3002 \u5e42\u7b49\u7684\u65b9\u6cd5\uff1a\u5982\u679c\u4e00\u4e2aHTTP\u65b9\u6cd5\u5728\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8c03\u7528\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u5bf9\u670d\u52a1\u5668\u7684\u72b6\u6001\u9020\u6210\u4efb\u4f55\u6539\u53d8\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5e42\u7b49\u7684\u3002 \u6d4f\u89c8\u5668\u5bf9\u8bf7\u6c42\u65b9\u6cd5\u7684\u652f\u6301 GET\u65b9\u6cd5\u662f\u6700\u57fa\u672c\u7684HTTP\u65b9\u6cd5\uff0c\u5b83\u8d1f\u8d23\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u5185\u5bb9\uff0c\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u652f\u6301\u8fd9\u4e2a\u65b9\u6cd5\u3002 POST\u65b9\u6cd5\u4eceHTML2.0\u5f00\u59cb\u53ef\u4ee5\u901a\u8fc7HTML\u8868\u5355\u6765\u5b9e\u73b0\uff1aHTML\u7684form\u6807\u7b7e\u6709\u4e00\u4e2a\u540d\u4e3amethod\u7684\u5c5e\u6027\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5c06\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3aget\u6216\u8005post\u6765\u6307\u5b9a\u8981\u4f7f\u7528\u90a3\u79cd\u65b9\u6cd5\u3002 HTML\u4e0d\u652f\u6301\u9664\u4e86GET\u548cPOST\u4e4b\u5916\u7684\u5176\u4ed6HTTP\u65b9\u6cd5\u3002 \u4e3b\u6d41\u7684\u6d4f\u89c8\u5668\u901a\u5e38\u90fd\u4e0d\u4f1a\u53ea\u652f\u6301HTML\u4e00\u79cd\u6570\u636e\u683c\u5f0f\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528XMLHttpREquest\uff08XHR\uff09\u6765\u83b7\u5f97\u5bf9PUT\u65b9\u6cd5\u548cDELETE\u65b9\u6cd5\u7684\u652f\u6301\u3002 XHR\u662f\u4e00\u7cfb\u5217\u6d4f\u89c8\u5668API\uff0c\u8fd9\u4e9bAPI\u540c\u5316\u6210\u90a3\u4e2a\u6709JS\u5305\u88f9\uff08\u5b9e\u9645\u4e0aXHR\u5c31\u662f\u4e00\u4e2a\u540d\u4e3aXML XMLHttpRequest\u7684\u6d4f\u89c8\u5668\u5bf9\u8c61\uff09\uff0cXHR\u5141\u8bb8\u7a0b\u5e8f\u5458\u5411\u670d\u52a1\u5668\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u8fd9\u9879\u6280\u672f\u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8eXML\u683c\u5f0f\uff0c\u5305\u62ecJSON\u4ee5\u53ca\u7eaf\u6587\u672c\u5728\u5185\u7684\u4efb\u4f55\u683c\u5f0f\u7684\u8bf7\u6c42\u548c\u76f8\u5e94\u90fd\u53ef\u4ee5\u901a\u8fc7XHR\u53d1\u9001\u3002 \u8bf7\u6c42\u9996\u90e8 HTTP\u8bf7\u6c42\u65b9\u6cd5\u5b9a\u4e49\u4e86\u53d1\u9001\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u60f3\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff0c\u800cHTTP\u8bf7\u6c42\u7684\u9996\u90e8\u5219\u8bb0\u5f55\u4e86\u4e0e\u8bf7\u6c42\u672c\u8eab\u4ee5\u53ca\u5ba2\u6237\u7aef\u6709\u5173\u7684\u4fe1\u606f\u3002\u8bf7\u6c42\u7684\u9996\u90e8\u7531\u4efb\u610f\u591a\u4e2a\u7528\u5192\u53f7\u5206\u9694\u7684\u7eaf\u6587\u672c\u952e\u503c\u5bf9\u7ec4\u6210\uff0c\u6700\u540e\u4ee5\u56de\u8f66\uff08CR\uff09\u548c\u6362\u884c\uff08LF\uff09\u7ed3\u5c3e\u3002 \u5927\u591a\u6570HTTP\u8bf7\u6c42\u9996\u90e8\u90fd\u662f\u53ef\u9009\u7684\uff0cHost\u9996\u90e8\u5b57\u6bb5\u662fHTTP1.1\u552f\u4e00\u5f3a\u5236\u8981\u6c42\u7684\u9996\u90e8\u3002\u6839\u636e\u8bf7\u6c42\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u62a5\u6587\u4e2d\u5305\u542b\u6709\u53ef\u9009\u7684\u4e3b\u4f53\uff0c\u90a3\u4e48\u8bf7\u6c42\u7684\u9996\u90e8\u8fd8\u9700\u8981\u5e26\u6709\u5185\u5bb9\u957f\u5ea6\uff08Content-Length\uff09\u5b57\u6bb5\u6216\u8005\u4f20\u8f93\u7f16\u7801\uff08Transfer-Encoding\uff09\u5b57\u6bb5\u3002 \u5e38\u89c1\u8bf7\u6c42\u9996\u90e8\u5982\u4e0b\uff1a \u9996\u90e8\u5b57\u6bb5 \u4f5c\u7528\u63cf\u8ff0 \u8bf4\u660e Accept \u5ba2\u6237\u7aef\u5728HTTP\u54cd\u5e94\u4e2d\u80fd\u591f\u63a5\u6536\u7684\u5185\u5bb9\u7c7b\u578b \u6bd4\u5982\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7 Accept:text/html \u8fd9\u4e2a\u9996\u90e8\uff0c\u544a\u77e5\u670d\u52a1\u5668\u81ea\u5df1\u5e0c\u671b\u5728\u76f8\u5e94\u7684\u4e3b\u4f53\u4e2d\u6536\u5230HTML\u7c7b\u578b\u7684\u5185\u5bb9 Accept-Charset \u5ba2\u6237\u7aef\u8981\u6c42\u670d\u52a1\u5668\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u7f16\u7801 \u6bd4\u5982\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7 Accept-Charset:utf-8 \u8fd9\u4e2a\u9996\u90e8\u6765\u544a\u77e5\u670d\u52a1\u5668\u81ea\u5df1\u5e0c\u671b\u54cd\u5e94\u7684\u4e3b\u4f53\u4f7f\u7528UTF-8\u5b57\u7b26\u96c6 Authorization \u8fd9\u4e2a\u9996\u90e8\u7528\u4e8e\u5411\u670d\u52a1\u5668\u53d1\u9001\u57fa\u672c\u7684\u8eab\u4efd\u9a8c\u8bc1\u8bc1\u4e66 Cookie \u5ba2\u6237\u7aef\u5e94\u8be5\u5728\u8fd9\u4e2a\u9996\u90e8\u4e2d\u628a\u670d\u52a1\u5668\u4e4b\u524d\u8bbe\u7f6e\u7684\u6240\u4ee5Cookie\u56de\u4f20\u7ed9\u670d\u52a1\u5668 \u6bd4\u5982\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e4b\u524d\u5728\u6d4f\u89c8\u5668\u4e0a\u8bbe\u7f6e\u4e863\u4e2aCookie\uff0c\u90a3\u4e48Cookie\u9996\u90e8\u5b57\u6bb5\u5c06\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u91cc\u9762\u5305\u542b\u8fd93\u4e2aCookie\uff0c\u5e76\u4f7f\u7528\u5206\u53f7\u5bf9\u8fd9\u4e9bCookie\u8fdb\u884c\u5206\u9694\uff0c\u5982 Cookie:my_first_cookie=hello;my_second_cookie=world Content-Length \u8bf7\u6c42\u4e3b\u4f53\u7684\u5b57\u8282\u957f\u5ea6 Content-Type \u5f53\u8bf7\u6c42\u5305\u542b\u4e3b\u4f53\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u9996\u90e8\u7528\u4e8e\u8bb0\u5f55\u4e3b\u4f53\u5185\u5bb9\u7684\u7c7b\u578b \u5728\u53d1\u9001POST\u6216PUT\u8bf7\u6c42\u65f6\uff0c\u5185\u5bb9\u7684\u7c7b\u578b\u9ed8\u8ba4\u4e3a x-www-form-urlen-coded \uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5185\u5bb9\u7684\u7c7b\u578b\u5e94\u8be5\u8bbe\u7f6e\u4e3a multipart/form-data \uff08\u4e0a\u4f20\u6587\u4ef6\u8fd9\u4e00\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u5c06input\u6807\u7b7e\u7684\u7c7b\u578b\u8bbe\u7f6e\u4e3afile\u6765\u5b9e\u73b0\uff09 Host \u670d\u52a1\u5668\u7684\u540d\u5b57\u4ee5\u53ca\u7aef\u53e3\u53f7 \u5982\u679c\u8fd9\u4e2a\u9996\u90e8\u6ca1\u6709\u8bb0\u5f55\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7\uff0c\u5c31\u8868\u793a\u670d\u52a1\u5668\u4f7f\u7528\u7684\u662f80\u7aef\u53e3 Referrer \u53d1\u8d77\u8bf7\u6c42\u7684\u9875\u9762\u6240\u5728\u5730\u5740 User-Agent \u5bf9\u53d1\u8d77\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u8fdb\u884c\u63cf\u8ff0 HTTP\u54cd\u5e94 HTTP\u54cd\u5e94\u62a5\u6587\u662f\u5bf9HTTP\u8bf7\u6c42\u62a5\u6587\u7684\u56de\u590d\u3002\u8ddfHTTP\u8bf7\u6c42\u4e00\u6837\uff0cHTTP\u76f8\u5e94\u4e5f\u662f\u6709\u4e00\u7cfb\u5217\u6587\u672c\u884c\u7ec4\u6210\u7684\uff0c\u5176\u4e2d\u5305\u62ec\uff1a \u4e00\u4e2a\u72b6\u6001\u884c \u96f6\u4e2a\u6216\u4efb\u610f\u6570\u91cf\u7684\u54cd\u5e94\u9996\u90e8 \u4e00\u4e2a\u7a7a\u884c \u4e00\u4e2a\u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53 HTTP\u54cd\u5e94\uff0c\u5982\u4e0b\uff1a 200 OK // \u72b6\u6001\u884c\uff0c\u5305\u542b\u72b6\u6001\u7801\u548c\u54cd\u5e94\u7684\u539f\u56e0\u77ed\u8bed\uff08\u5bf9\u72b6\u6001\u7801\u8fdb\u884c\u7b80\u5355\u7684\u63cf\u8ff0\uff09 Date: Sat, 22 Nov 2014 12:58:58 GMT Server: Apache/2 \u3000Last-Modified: Thu, 28 Aug 2014 21:01:33 GMT Content-Length: 33115 Content-Type: text/html; charset=iso-8859-1 // HTML\u683c\u5f0f\u7684\u62a5\u6587\u4e3b\u4f53 !DOCTYPE html PUBLIC -//W3C//DTD XHTML 1.0 Strict//EN http://www.w3.org/ \u3000\u3000 TR/xhtml1/DTD/xhtml1-strict.dtd html xmlns='http://www.w3.org/1999/ \u3000\u3000 xhtml' head title Hypertext Transfer Protocol -- HTTP/1.1 /title / \u3000\u3000 head body ... /body /html \u54cd\u5e94\u72b6\u6001\u7801 HTTP\u54cd\u5e94\u4e2d\u7684\u72b6\u6001\u7801\u8868\u660e\u4e86\u54cd\u5e94\u7684\u7c7b\u578b\uff0cHTTP\u54cd\u5e94\u72b6\u6001\u7801\u5171\u67095\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u4ee5\u4e0d\u540c\u7684\u6570\u5b57\u4f5c\u4e3a\u524d\u7f00\u3002 \u72b6\u6001\u7801\u7c7b\u578b \u4f5c\u7528\u63cf\u8ff0 \u8bf4\u660e 1XX \u60c5\u62a5\u72b6\u6001\u7801 \u670d\u52a1\u5668\u901a\u8fc7\u8fd9\u4e9b\u72b6\u6001\u7801\u6765\u544a\u77e5\u5ba2\u6237\u7aef\uff0c\u81ea\u5df1\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u5df2\u7ecf\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4e86\u5904\u7406 2XX \u6210\u529f\u72b6\u6001\u7801 \u8fd9\u4e9b\u72b6\u6001\u7801\u8bf4\u660e\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u6210\u529f\u5730\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4e86\u5904\u7406\uff0c\u8fd9\u7c7b\u72b6\u6001\u7801\u7684\u6807\u51c6\u54cd\u5e94\u4e3a\u201c200 OK\u201d 3XX \u91cd\u5b9a\u5411\u72b6\u6001\u7801 \u8fd9\u4e9b\u72b6\u6001\u7801\u8868\u793a\u670d\u52a1\u5668\u5df2\u7ecf\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u5df2\u7ecf\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u662f\u4e3a\u4e86\u5b8c\u6210\u8bf7\u6c42\u6307\u5b9a\u7684\u52a8\u4f5c\uff0c\u5ba2\u6237\u7aef\u8fd8\u9700\u8981\u518d\u505a\u4e00\u4e9b\u5176\u4ed6\u7684\u5de5\u4f5c\uff0c\u8fd9\u91cc\u72b6\u6001\u7801\u5927\u591a\u7528\u4e8e\u5b9e\u73b0URL\u91cd\u5b9a\u5411\u3002 4XX \u5ba2\u6237\u7aef\u9519\u8bef\u72b6\u6001\u7801 \u8fd9\u7c7b\u72b6\u6001\u7801\u8bf4\u660e\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u51fa\u73b0\u4e86\u67d0\u4e9b\u95ee\u9898\u3002\u5728\u8fd9\u4e00\u7c7b\u578b\u7684\u72b6\u6001\u7801\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u201c404 Not Found\u201d\uff0c\u8fd9\u4e2a\u72b6\u6001\u7801\u8868\u793a\u670d\u52a1\u5668\u65e0\u6cd5\u4ece\u8bf7\u6c42\u6307\u5b9a\u7684URL\u4e2d\u627e\u5230\u5ba2\u6237\u7aef\u60f3\u8981\u7684\u8d44\u6e90 5XX \u670d\u52a1\u5668\u9519\u8bef\u72b6\u6001\u7801 \u5f53\u670d\u52a1\u5668\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u800c\u65e0\u6cd5\u6b63\u786e\u5730\u5904\u7406\u8bf7\u6c42\u65f6\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u4f7f\u7528\u8fd9\u7c7b\u72b6\u6001\u7801\u6765\u901a\u77e5\u5ba2\u6237\u7aef\uff0c\u8fd9\u4e00\u7c7b\u578b\u7684\u72b6\u6001\u7801\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u201c500 Internal Server Error\u201d\u72b6\u6001\u7801\u3002 \u54cd\u5e94\u9996\u90e8 \u54cd\u5e94\u9996\u90e8\u8ddf\u8bf7\u6c42\u9996\u90e8\u4e00\u6837\uff0c\u662f\u7531\u5192\u53f7\u5206\u9694\u7684\u7eaf\u6587\u672c\u952e\u503c\u5bf9\u7ec4\u6210\uff0c\u5e76\u4e14\u540c\u65f6\u4ee5\u56de\u8f66\uff08CR\uff09\u548c\u6362\u884c\uff08LF\uff09\u7ed3\u5c3e\u3002 \u8bf7\u6c42\u9996\u90e8\u80fd\u591f\u544a\u8bc9\u670d\u52a1\u5668\u66f4\u591a\u4e0e\u8bf7\u6c42\u76f8\u5173\u6216\u8005\u4e0e\u5ba2\u6237\u7aef\u8bc9\u6c42\u76f8\u5173\u7684\u4fe1\u606f \u54cd\u5e94\u9996\u90e8\u80fd\u591f\u5411\u5ba2\u6237\u7aef\u4f20\u8fbe\u66f4\u591a\u54cd\u5e94\u76f8\u5173\u6216\u8005\u4e0e\u670d\u52a1\u5668\u8bc9\u6c42\u76f8\u5173\u7684\u4fe1\u606f \u5e38\u89c1\u54cd\u5e94\u9996\u90e8\u5982\u4e0b\uff1a \u9996\u90e8\u5b57\u6bb5 \u4f5c\u7528\u63cf\u8ff0 Allow \u544a\u77e5\u5ba2\u6237\u7aef\uff0c\u670d\u52a1\u5668\u652f\u6301\u90a3\u4e9b\u8bf7\u6c42\u65b9\u6cd5 Content-Length \u54cd\u5e94\u4e3b\u4f53\u7684\u5b57\u8282\u957f\u5ea6 Content-Type \u5982\u679c\u54cd\u5e94\u5305\u542b\u53ef\u9009\u7684\u4e3b\u4f53\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9996\u90e8\u8bb0\u5f55\u7684\u5c31\u662f\u4e3b\u4f53\u7684\u5185\u5bb9\u7684\u7c7b\u578b Date \u4ee5\u683c\u6797\u5c3c\u6cbb\u6807\u51c6\u65f6\u95f4\uff08GMT\uff09\u683c\u5f0f\u8bb0\u5f55\u7684\u5f53\u524d\u65f6\u95f4 Location \u8fd9\u4e2a\u9996\u90e8\u4ec5\u5728\u91cd\u5b9a\u5411\u7684\u65f6\u5019\u4f7f\u7528\uff0c\u5b83\u4f1a\u9ad8\u67f1\u5ba2\u6237\u7aef\u63a5\u4e0b\u6765\u5e94\u8be5\u5411\u54ea\u4e2aURL\u53d1\u9001\u8bf7\u6c42 Server \u54cd\u5e94\u7684\u670d\u52a1\u5668\u7684\u57df\u540d Set-Cookie \u5728\u5ba2\u6237\u7aef\u91cc\u8bbe\u7f6e\u4e00\u4e2aCookie\uff0c\u4e00\u4e2a\u54cd\u5e94\u91cc\u9762\u53ef\u4ee5\u5305\u542b\u591a\u4e2aSet-Cookie\u9996\u90e8 WWW-Authenticate \u670d\u52a1\u5668\u901a\u8fc7\u8fd9\u4e2a\u9996\u90e8\u6765\u544a\u8bc9\u5ba2\u6237\u7aef\uff0c\u5728Authorization\u8bf7\u6c42\u9996\u90e8\u4e2d\u5e94\u8be5\u63d0\u4f9b\u54ea\u79cd\u7c7b\u578b\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u3002\u670d\u52a1\u5668\u5f02\u5e38\u4f1a\u628a\u8fd9\u4e2a\u9996\u90e8\u4e0e\u201c401 Unauthorized\u201d\u72b6\u6001\u884c\u4e00\u540c\u53d1\u9001\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e2a\u9996\u90e8\u8fd8\u4f1a\u5411\u670d\u52a1\u5668\u8bb8\u53ef\u7684\u8ba4\u8bc1\u6388\u6743\u6a21\u5f0f\uff08scheme\uff09\u63d0\u4f9b\u9a8c\u8bc1\u4fe1\u606f\uff08challenge information\uff09 URI \u4e00\u79cd\u4f7f\u7528\u5b57\u7b26\u4e32\u8868\u793a\u8d44\u6e90\u540d\u7684\u65b9\u6cd5\uff1a\u7edf\u4e00\u8d44\u6e90\u540d\u79f0\uff08Uniform Resource Name\uff0cURN\uff09 \u4e00\u79cd\u4f7f\u7528\u5b57\u7b26\u4e32\u8868\u793a\u8d44\u6e90\u6240\u5728\u4e3a\u6b62\u7684\u65b9\u6cd5\uff1a\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26\uff08Uniform Resource Location\uff0cURL\uff09 URI\u662f\u4e00\u4e2a\u6db5\u76d6\u6027\u672f\u8bed\uff0c\u5b83\u5305\u542b\u4e86URN\u548cURL\uff0c\u5e76\u4e14\u8fd9\u4e24\u8005\u4e5f\u62e5\u6709\u76f8\u4f3c\u7684\u8bed\u6cd5\u548c\u683c\u5f0f\u3002 URI\u4e00\u822c\u683c\u5f0f\u4e3a\uff1a \u65b9\u6848\u540d\u79f0 : \u5206\u5c42\u90e8\u5206 [? \u67e5\u8be2\u53c2\u6570 ][# \u7247\u6bb5 ] URI\u7684\u65b9\u6848\u540d\u79f0\uff08scheme name\uff09\u8bb0\u5f55\u4e86URI\u6b63\u5728\u4f7f\u7528\u7684\u65b9\u6848\uff0c\u5b83\u5b9a\u4e49\u4e86URI\u5176\u4f59\u90e8\u5206\u7684\u7ed3\u6784\u3002\u56e0\u4e3aURI\u662f\u4e00\u79cd\u975e\u5e38\u5e38\u7528\u7684\u8d44\u6e90\u6807\u8bc6\u65b9\u5f0f\uff0c\u6240\u4ee5\u5b83\u62e5\u6709\u5927\u91cf\u7684\u65b9\u6848\u53ef\u4f9b\u4f7f\u7528\uff0c\u5927\u90e8\u5206\u65f6\u5019\u4f7f\u7528HTTP\u65b9\u6848\u3002 URI\u7684\u5206\u5c42\u90e8\u5206\uff08hierarchical part\uff09\u5305\u542b\u4e86\u8d44\u6e90\u7684\u8bc6\u522b\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u4ee5\u5206\u5c42\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec4\u7ec7\u3002\u5982\u679c\u5206\u5c42\u90e8\u5206\u4ee5\u53cc\u659c\u6760\uff08//\uff09\u5f00\u5934\uff0c\u90a3\u4e48\u8bf4\u660e\u5b83\u5305\u542b\u4e86\u53ef\u9009\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5c06\u4ee5@\u7b26\u5408\u7ed3\u5c3e\uff0c\u540e\u8ddf\u5206\u5c42\u8def\u5f84\u3002\u4e0d\u5e26\u7528\u6237\u4fe1\u606f\u7684\u5206\u5c42\u90e8\u5206\u5c31\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u8def\u5f84\uff0c\u6bcf\u4e2a\u8def\u5f84\u90fd\u7531\u4e00\u8fde\u4e32\u7684\u5206\u6bb5\uff08segment\uff09\u7ec4\u6210\uff0c\u5404\u4e2a\u5206\u6bb5\u4e4b\u95f4\u4f7f\u7528\u5355\u659c\u7ebf\uff08/\uff09\u5206\u9694\u3002 \u5728URI\u7684\u5404\u4e2a\u90e8\u5206\u5f53\u4e2d\uff0c\u53ea\u6709\u201c\u65b9\u6848\u540d\u79f0\u201d\u548c\u201c\u5206\u5c42\u90e8\u5206\u201d\u662f\u5fc5\u987b\u7684\u3002\u4ee5\u95ee\u53f7\uff08?\uff09\u4e3a\u524d\u7f00\u7684\u67e5\u8be2\u53c2\u6570\uff08query\uff09\u662f\u53ef\u9009\u7684\uff0c\u8fd9\u4e9b\u53c2\u6570\u7528\u4e8e\u5305\u542b\u65e0\u6cd5\u4f7f\u7528\u5206\u5c42\u65b9\u5f0f\u8868\u793a\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u591a\u4e2a\u67e5\u8be2\u53c2\u6570\u4f1a\u88ab\u7ec4\u7ec7\u6210\u4e00\u8fde\u4e32\u7684\u952e\u503c\u5bf9\uff0c\uff0c\u5404\u4e2a\u952e\u503c\u5bf9\u4e4b\u95f4\u4f7f\u7528 \u7b26\u53f7\u5206\u9694\u3002 URI\u7684\u53e6\u4e00\u4e2a\u53ef\u9009\u90e8\u5206\u4e3a\u7247\u6bb5\uff08fragment\uff09,\u7247\u6bb5\u4f7f\u7528\u4e95\u53f7\uff08#\uff09\u4f5c\u4e3a\u524d\u7f00\uff0c\u5b83\u53ef\u4ee5\u5bf9URI\u5b9a\u4e49\u7684\u8d44\u6e90\u4e2d\u7684\u6b21\u7ea7\u8d44\u6e90\u8fdb\u884c\u8868\u793a\uff08secondary resource\uff09\u8fdb\u884c\u6807\u8bc6\u3002\u5f53URI\u5305\u542b\u53c2\u6570\u65f6\uff0cURI\u7684\u7247\u6bb5\u5c06\u88ab\u653e\u5728\u67e5\u8be2\u53c2\u6570\u4e4b\u540e\u3002\u56e0\u4e3aURI\u7684\u7247\u6bb5\u662f\u6709\u5ba2\u6237\u7aef\u8d1f\u8d23\u5904\u7406\u7684\uff0c\u6240\u4ee5Web\u6d4f\u89c8\u5668\u5728\u5c06URI\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u4e4b\u524d\uff0c\u4e00\u822c\u90fd\u4f1a\u5148\u628aURI\u4e2d\u7684\u7247\u6bb5\u79fb\u9664\u3002\uff08\u5982\u679c\u60f3\u8981\u53d6\u5f97URI\u7247\u6bb5\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7JS\u6216\u67d0\u4e2aHTTP\u5ba2\u6237\u7aef\u5e93\uff0c\u5c06URI\u7247\u6bb5\u5305\u542b\u5728\u4e00\u4e2aGET\u8bf7\u6c42\u91cc\u9762\uff09\u3002 \u4f7f\u7528HTTP\u65b9\u6848\u7684URI\u793a\u4f8b\uff1a http://sausheong:password@www.example. com/ docs/file?name=sausheong location=singapore#summary \u8fd9\u4e2aURI\u4f7f\u7528\u7684\u662fHTTP\u65b9\u6848 \u8ddf\u5728\u65b9\u6848\u4e4b\u540e\u7684\u662f\u4e00\u4e2a\u5192\u53f7\uff0c\u4f4d\u4e8e@\u7b26\u53f7\u4e4b\u524d\u7684\u5206\u6bb5 sausheong:password \u8ddf\u5728\u7528\u6237\u4fe1\u606f\u4e4b\u540e\u7684\u662f www.example.com/docs/file \u662f\u5206\u5c42\u90e8\u5206\u7684\u5176\u4f59\u90e8\u5206\uff0c\u4f4d\u4e8e\u5206\u5c42\u90e8\u5206\u6700\u9ad8\u5c42\u7684\u662f\u670d\u52a1\u5668\u7684\u57df\u540d wwwexample.com \uff0c\u4e4b\u540e\u8ddf\u7740\u7684\u4e24\u4e2a\u5c42\u5206\u522b\u4e3adoc\u548cfile\u3002\u6bcf\u4e2a\u5206\u5c42\u7528\u5355\u659c\u6760\u5206\u9694\u3002 \u8ddf\u5728\u5206\u5c42\u90e8\u5206\u4e4b\u540e\u662f\u4ee5\u95ee\u53f7\uff08?\uff09\u4e3a\u524d\u7f00\u7684\u67e5\u8be2\u53c2\u6570\uff0c\u8fd9\u4e2a\u90e8\u5206\u5305\u542b\u4e86 name=sausheong \u548c location=singapore \u8fd9\u4e24\u4e2a\u952e\u503c\u5bf9\uff0c\u952e\u503c\u5bf9\u4e4b\u95f4\u4f7f\u7528 \u7b26\u53f7\u8fde\u63a5 \u6700\u540e\uff0c\u8fd9\u4e2aURI\u7684\u672b\u5c3e\u8fd8\u5e26\u6709\u4e00\u4e2a\u4ee5\u4e95\u53f7\uff08#\uff09\u524d\u7f00\u7684\u7247\u6bb5 \u56e0\u4e3a\u6bcf\u4e2aURI\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5URI\u91cc\u9762\u662f\u4e0d\u80fd\u591f\u5305\u542b\u7a7a\u683c\u7684\uff0c\u6b64\u5916\uff0c\u56e0\u4e3a\u95ee\u53f7\uff08?\uff09\u548c\u4e95\u53f7\uff08#\uff09\u7b49\u7b26\u53f7\u5728URL\u4e2d\u5177\u6709\u7279\u6b8a\u7684\u542b\u4e49\uff0c\u6240\u4ee5\u8fd9\u4e9b\u7b26\u53f7\u662f\u4e0d\u80fd\u591f\u7528\u4e8e\u5176\u4ed6\u7528\u9014\u7684\uff0c\u672a\u6765\u907f\u5f00\u8fd9\u4e9b\u9650\u5236\uff0c\u9700\u8981\u4f7f\u7528URI\u7f16\u7801\uff08\u767e\u5206\u53f7\u7f16\u7801\uff09\u6765\u5bf9\u7279\u6b8a\u7b26\u53f7\u8fdb\u884c\u8f6c\u6362\u3002 \u6240\u6709\u4fdd\u7559\u5b57\u7b26\u9700\u8981\u8fdb\u884c\u767e\u5206\u53f7\u7f16\u7801\uff0c\u628a\u4fdd\u7559\u5b57\u7b26\u8f6c\u6362\u6210\u8be5\u5b57\u7b26\u5728ASCII\u7f16\u7801\u4e2d\u5bf9\u5e94\u7684\u5b57\u8282\u503c\uff08byte value\uff09,\u63a5\u7740\u628a\u8fd9\u4e2a\u5b57\u8282\u503c\u8868\u793a\u4e3a\u4e00\u4e2a\u4e24\u4f4d\u957f\u7684\u5341\u516d\u8fdb\u5236\u6570\u7ec4\uff0c\u6700\u540e\u518d\u5728\u8fd9\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u7684\u524d\u9762\u52a0\u4e0a\u4e00\u4e2a\u767e\u5206\u53f7\uff08%\uff09\u3002 \u4f8b\u5982\uff0c\u7a7a\u683c\u5728ASCII\u7f16\u7801\u4e2d\u7684\u5b57\u8282\u503c\u4e3a32\uff0c\u5373\u5341\u516d\u8fdb\u5236\u4e2d\u768420\u3002\u56e0\u6b64\uff0c\u7ecf\u8fc7\u767e\u5206\u53f7\u7f16\u7801\u5904\u7406\u7684\u7a7a\u683c\u5c31\u6210\u4e86%20\uff0cURI\u4e2d\u6240\u6709\u7a7a\u683c\u90fd\u4f1a\u88ab\u66ff\u6362\u6210\u8fd9\u4e2a\u503c\uff0c\u5982\u4e0b\u6240\u793a\uff1a http://www.example.com/docs/file? name=sau%20sheong location=singapore \u3002","title":"HTTP"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#http","text":"","title":"HTTP"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#http_1","text":"HTTP\u662f\u4e00\u79cd\u8bf7\u6c42-\u76f8\u5e94\u534f\u8bae\uff0c\u534f\u8bae\u6d89\u53ca\u7684\u6240\u6709\u4e8b\u60c5\u90fd\u662f\u4ee5\u4e00\u4e2a\u8bf7\u6c42\u5f00\u59cb\u3002HTTP\u8bf7\u6c42\u8ddf\u5176\u4ed6\u6240\u6709HTTP\u62a5\u6587\u4e00\u6837\uff0c\u90fd\u662f\u7531\u4e00\u7cfb\u5217\u6587\u672c\u884c\u7ec4\u6210\uff0c\u8fd9\u4e9b\u6587\u672c\u884c\u4f1a\u6309\u7167\u4ee5\u4e0b\u987a\u5e8f\u8fdb\u884c\u6392\u5217\uff1a \u8bf7\u6c42\u884c\uff08request-line\uff09 \u96f6\u4e2a\u6216\u4efb\u610f\u591a\u4e2a\u8bf7\u6c42\u9996\u90e8\uff08header\uff09 \u4e00\u4e2a\u7a7a\u884c \u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53\uff08body\uff09 \u4e00\u4e2a\u5178\u578b\u7684HTTP\u8bf7\u6c42\uff0c\u5982\u4e0b\u6240\u793a\uff1a GET /Protocols/rfc2616/rfc2616.html HTTP/1.1 // \u8bf7\u6c42\u884c Host: www.w3.org // \u8bf7\u6c42\u9996\u90e8 User-Agent: Mozilla/5.0 // \u8bf7\u6c42\u9996\u90e8 (empty line) // \u7a7a\u884c\uff0c\u5fc5\u987b\u5b58\u5728 // \u53ef\u9009\u62a5\u6587\u4e3b\u4f53\u90e8\u5206\u4e3a\u7a7a \u8bf7\u6c42\u884c\uff1a \u7b2c\u4e00\u4e2a\u5355\u8bcd\u662f\u8bf7\u6c42\u65b9\u6cd5\uff08request method\uff09 \u4e4b\u540e\u662f\u7edf\u4e00\u8d44\u6e90\u6807\u8bc6\u7b26\uff08Uniform Resource Identifier\uff0cURI\uff09 \u4ee5\u53ca\u6240\u4f7f\u7528\u7684HTTP\u7248\u672c \u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53\uff1a\u62a5\u6587\u662f\u5426\u5305\u542b\u4e3b\u4f53\u9700\u8981\u6839\u636e\u8bf7\u6c42\u4f7f\u7528\u7684\u65b9\u6cd5\u800c\u5b9a","title":"HTTP\u8bf7\u6c42"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#_1","text":"\u8bf7\u6c42\u65b9\u6cd5\u662f\u8bf7\u6c42\u884c\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5355\u8bcd\uff0c\u6307\u660e\u4e86\u5ba2\u6237\u7aef\u60f3\u8981\u5bf9\u8d44\u6e90\u6267\u884c\u7684\u64cd\u4f5c\u3002 HTTP0.9\uff1a\u53ea\u6709GET\u4e00\u4e2a\u65b9\u6cd5 HTTP1.0\uff1a\u6dfb\u52a0\u4e86POST\u548cHEAD\u65b9\u6cd5 HTTP1.1\uff1a\u6dfb\u52a0\u4e86PUT\u3001DELETE\u3001OPTIONS\u3001TRACE\u548cCONNECT\uff0c\u5141\u8bb8\u5f00\u53d1\u7740\u81ea\u884c\u6dfb\u52a0\u66f4\u591a\u65b9\u6cd5 HTTP1.1\u8981\u53bb\u5fc5\u987b\u5b9e\u73b0\u7684\u53ea\u6709GET\u548cHEAD\u65b9\u6cd5\uff0c\u5176\u4ed6\u65b9\u6cd5\u7684\u5b9e\u73b0\u662f\u53ef\u9009\u7684\u3002 \u5404\u4e2aHTTP\u65b9\u6cd5\u7684\u4f5c\u7528\u8bf4\u660e\uff1a \u65b9\u6cd5 \u63cf\u8ff0 \u8bf4\u660e \u662f\u5426\u5b89\u5168 \u662f\u5426\u5e42\u7b49 GET \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u6307\u5b9a\u7684\u8d44\u6e90 \u662f HEAD \u4e0eGET\u65b9\u6cd5\u7c7b\u4f3c\uff0c\u552f\u4e00\u7684\u4e0d\u540c\u5728\u4e8e\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u8981\u6c42\u670d\u52a1\u5668\u8fd4\u56de\u62a5\u6587\u7684\u4e3b\u4f53 \u901a\u5e38\u7528\u4e8e\u5728\u4e0d\u83b7\u53d6\u62a5\u6587\u4e3b\u4f53\u7684\u60c5\u51b5\u4e0b\uff0c\u83b7\u53d6\u76f8\u5e94\u7684\u9996\u90e8 \u662f POST \u547d\u4ee4\u670d\u52a1\u5668\u5c06\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u4f20\u9012\u7ed9URI\u6307\u5b9a\u7684\u8d44\u6e90\uff0c\u81f3\u4e8e\u670d\u52a1\u5668\u5177\u4f53\u4f1a\u5bf9\u8fd9\u4e9b\u6570\u636e\u6267\u884c\u4ec0\u4e48\u52a8\u4f5c\u53d6\u51b3\u4e8e\u670d\u52a1\u5668\u672c\u8eab \u4e0d\u662f PUT \u547d\u4ee4\u670d\u52a1\u5668\u5c06\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u8bbe\u7f6e\u4e3aURI\u6307\u5b9a\u7684\u8d44\u6e90 \u5982\u679cURI\u6307\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u5df2\u7ecf\u6709\u6570\u636e\u5b58\u5728\uff0c\u90a3\u4e48\u4f7f\u7528\u62a5\u6587\u4e3b\u4f53\u7684\u6570\u636e\u53bb\u66ff\u4ee3\u5df2\u6709\u7684\u6570\u636e,\u5982\u679c\u8d44\u6e90\u5c1a\u672a\u5b58\u5728\uff0c\u90a3\u4e48\u5728URI\u6307\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u65b0\u521b\u5efa\u4e00\u4e2a\u8d44\u6e90 \u4e0d\u662f \u5e42\u7b49 DELETE \u547d\u4ee4\u670d\u52a1\u5668\u5220\u9664URI\u6307\u5b9a\u7684\u8d44\u6e90 \u4e0d\u662f \u5e42\u7b49 TRACE \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u8bf7\u6c42\u672c\u8eab \u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u77e5\u9053\u4ecb\u4e8e\u5b83\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u5176\u4ed6\u670d\u52a1\u5668\u662f\u5982\u4f55\u5904\u7406\u8bf7\u6c42\u7684 \u662f OPTIONS \u547d\u4ee4\u670d\u52a1\u5668\u8fd4\u56de\u5b83\u652f\u6301\u7684HTTP\u65b9\u6cd5\u5217\u8868 \u662f CONNECT \u547d\u4ee4\u670d\u52a1\u5668\u4e0e\u5ba2\u6237\u7aef\u5efa\u7acb\u4e00\u4e2a\u7f51\u7edc\u8fde\u63a5\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u901a\u5e38\u7528\u4e8e\u8bbe\u7f6eSSL\u96a7\u9053\u5df2\u5f00\u542fHTTPS\u529f\u80fd PATCH \u547d\u4ee4\u670d\u52a1\u5668\u4f7f\u7528\u62a5\u6587\u4e3b\u4f53\u4e2d\u7684\u6570\u636e\u5bf9URI\u6307\u5b9a\u7684\u8d44\u6e90\u8fdb\u884c\u4fee\u6539 \u5b89\u5168\u7684\u65b9\u6cd5\uff1a\u5982\u679c\u4e00\u4e2aHTTP\u65b9\u6cd5\u53ea\u8981\u6c42\u670d\u52a1\u5668\u63d0\u4f9b\u4fe1\u606f\u800c\u4e0d\u4f1a\u5bf9\u670d\u52a1\u5668\u7684\u72b6\u6001\u505a\u4efb\u4f55\u4fee\u6539\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5b89\u5168\u7684\u3002 \u5e42\u7b49\u7684\u65b9\u6cd5\uff1a\u5982\u679c\u4e00\u4e2aHTTP\u65b9\u6cd5\u5728\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u8fdb\u884c\u7b2c\u4e8c\u6b21\u8c03\u7528\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u5bf9\u670d\u52a1\u5668\u7684\u72b6\u6001\u9020\u6210\u4efb\u4f55\u6539\u53d8\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5e42\u7b49\u7684\u3002","title":"\u8bf7\u6c42\u65b9\u6cd5"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#_2","text":"GET\u65b9\u6cd5\u662f\u6700\u57fa\u672c\u7684HTTP\u65b9\u6cd5\uff0c\u5b83\u8d1f\u8d23\u4ece\u670d\u52a1\u5668\u83b7\u53d6\u5185\u5bb9\uff0c\u6240\u6709\u6d4f\u89c8\u5668\u90fd\u652f\u6301\u8fd9\u4e2a\u65b9\u6cd5\u3002 POST\u65b9\u6cd5\u4eceHTML2.0\u5f00\u59cb\u53ef\u4ee5\u901a\u8fc7HTML\u8868\u5355\u6765\u5b9e\u73b0\uff1aHTML\u7684form\u6807\u7b7e\u6709\u4e00\u4e2a\u540d\u4e3amethod\u7684\u5c5e\u6027\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u5c06\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u8bbe\u7f6e\u4e3aget\u6216\u8005post\u6765\u6307\u5b9a\u8981\u4f7f\u7528\u90a3\u79cd\u65b9\u6cd5\u3002 HTML\u4e0d\u652f\u6301\u9664\u4e86GET\u548cPOST\u4e4b\u5916\u7684\u5176\u4ed6HTTP\u65b9\u6cd5\u3002 \u4e3b\u6d41\u7684\u6d4f\u89c8\u5668\u901a\u5e38\u90fd\u4e0d\u4f1a\u53ea\u652f\u6301HTML\u4e00\u79cd\u6570\u636e\u683c\u5f0f\uff0c\u7528\u6237\u53ef\u4ee5\u4f7f\u7528XMLHttpREquest\uff08XHR\uff09\u6765\u83b7\u5f97\u5bf9PUT\u65b9\u6cd5\u548cDELETE\u65b9\u6cd5\u7684\u652f\u6301\u3002 XHR\u662f\u4e00\u7cfb\u5217\u6d4f\u89c8\u5668API\uff0c\u8fd9\u4e9bAPI\u540c\u5316\u6210\u90a3\u4e2a\u6709JS\u5305\u88f9\uff08\u5b9e\u9645\u4e0aXHR\u5c31\u662f\u4e00\u4e2a\u540d\u4e3aXML XMLHttpRequest\u7684\u6d4f\u89c8\u5668\u5bf9\u8c61\uff09\uff0cXHR\u5141\u8bb8\u7a0b\u5e8f\u5458\u5411\u670d\u52a1\u5668\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u8fd9\u9879\u6280\u672f\u4e0d\u4ec5\u4ec5\u5c40\u9650\u4e8eXML\u683c\u5f0f\uff0c\u5305\u62ecJSON\u4ee5\u53ca\u7eaf\u6587\u672c\u5728\u5185\u7684\u4efb\u4f55\u683c\u5f0f\u7684\u8bf7\u6c42\u548c\u76f8\u5e94\u90fd\u53ef\u4ee5\u901a\u8fc7XHR\u53d1\u9001\u3002","title":"\u6d4f\u89c8\u5668\u5bf9\u8bf7\u6c42\u65b9\u6cd5\u7684\u652f\u6301"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#_3","text":"HTTP\u8bf7\u6c42\u65b9\u6cd5\u5b9a\u4e49\u4e86\u53d1\u9001\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u60f3\u8981\u6267\u884c\u7684\u52a8\u4f5c\uff0c\u800cHTTP\u8bf7\u6c42\u7684\u9996\u90e8\u5219\u8bb0\u5f55\u4e86\u4e0e\u8bf7\u6c42\u672c\u8eab\u4ee5\u53ca\u5ba2\u6237\u7aef\u6709\u5173\u7684\u4fe1\u606f\u3002\u8bf7\u6c42\u7684\u9996\u90e8\u7531\u4efb\u610f\u591a\u4e2a\u7528\u5192\u53f7\u5206\u9694\u7684\u7eaf\u6587\u672c\u952e\u503c\u5bf9\u7ec4\u6210\uff0c\u6700\u540e\u4ee5\u56de\u8f66\uff08CR\uff09\u548c\u6362\u884c\uff08LF\uff09\u7ed3\u5c3e\u3002 \u5927\u591a\u6570HTTP\u8bf7\u6c42\u9996\u90e8\u90fd\u662f\u53ef\u9009\u7684\uff0cHost\u9996\u90e8\u5b57\u6bb5\u662fHTTP1.1\u552f\u4e00\u5f3a\u5236\u8981\u6c42\u7684\u9996\u90e8\u3002\u6839\u636e\u8bf7\u6c42\u4f7f\u7528\u7684\u65b9\u6cd5\u4e0d\u540c\uff0c\u5982\u679c\u8bf7\u6c42\u7684\u62a5\u6587\u4e2d\u5305\u542b\u6709\u53ef\u9009\u7684\u4e3b\u4f53\uff0c\u90a3\u4e48\u8bf7\u6c42\u7684\u9996\u90e8\u8fd8\u9700\u8981\u5e26\u6709\u5185\u5bb9\u957f\u5ea6\uff08Content-Length\uff09\u5b57\u6bb5\u6216\u8005\u4f20\u8f93\u7f16\u7801\uff08Transfer-Encoding\uff09\u5b57\u6bb5\u3002 \u5e38\u89c1\u8bf7\u6c42\u9996\u90e8\u5982\u4e0b\uff1a \u9996\u90e8\u5b57\u6bb5 \u4f5c\u7528\u63cf\u8ff0 \u8bf4\u660e Accept \u5ba2\u6237\u7aef\u5728HTTP\u54cd\u5e94\u4e2d\u80fd\u591f\u63a5\u6536\u7684\u5185\u5bb9\u7c7b\u578b \u6bd4\u5982\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7 Accept:text/html \u8fd9\u4e2a\u9996\u90e8\uff0c\u544a\u77e5\u670d\u52a1\u5668\u81ea\u5df1\u5e0c\u671b\u5728\u76f8\u5e94\u7684\u4e3b\u4f53\u4e2d\u6536\u5230HTML\u7c7b\u578b\u7684\u5185\u5bb9 Accept-Charset \u5ba2\u6237\u7aef\u8981\u6c42\u670d\u52a1\u5668\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u7f16\u7801 \u6bd4\u5982\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u901a\u8fc7 Accept-Charset:utf-8 \u8fd9\u4e2a\u9996\u90e8\u6765\u544a\u77e5\u670d\u52a1\u5668\u81ea\u5df1\u5e0c\u671b\u54cd\u5e94\u7684\u4e3b\u4f53\u4f7f\u7528UTF-8\u5b57\u7b26\u96c6 Authorization \u8fd9\u4e2a\u9996\u90e8\u7528\u4e8e\u5411\u670d\u52a1\u5668\u53d1\u9001\u57fa\u672c\u7684\u8eab\u4efd\u9a8c\u8bc1\u8bc1\u4e66 Cookie \u5ba2\u6237\u7aef\u5e94\u8be5\u5728\u8fd9\u4e2a\u9996\u90e8\u4e2d\u628a\u670d\u52a1\u5668\u4e4b\u524d\u8bbe\u7f6e\u7684\u6240\u4ee5Cookie\u56de\u4f20\u7ed9\u670d\u52a1\u5668 \u6bd4\u5982\uff0c\u5982\u679c\u670d\u52a1\u5668\u4e4b\u524d\u5728\u6d4f\u89c8\u5668\u4e0a\u8bbe\u7f6e\u4e863\u4e2aCookie\uff0c\u90a3\u4e48Cookie\u9996\u90e8\u5b57\u6bb5\u5c06\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u91cc\u9762\u5305\u542b\u8fd93\u4e2aCookie\uff0c\u5e76\u4f7f\u7528\u5206\u53f7\u5bf9\u8fd9\u4e9bCookie\u8fdb\u884c\u5206\u9694\uff0c\u5982 Cookie:my_first_cookie=hello;my_second_cookie=world Content-Length \u8bf7\u6c42\u4e3b\u4f53\u7684\u5b57\u8282\u957f\u5ea6 Content-Type \u5f53\u8bf7\u6c42\u5305\u542b\u4e3b\u4f53\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u9996\u90e8\u7528\u4e8e\u8bb0\u5f55\u4e3b\u4f53\u5185\u5bb9\u7684\u7c7b\u578b \u5728\u53d1\u9001POST\u6216PUT\u8bf7\u6c42\u65f6\uff0c\u5185\u5bb9\u7684\u7c7b\u578b\u9ed8\u8ba4\u4e3a x-www-form-urlen-coded \uff0c\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5185\u5bb9\u7684\u7c7b\u578b\u5e94\u8be5\u8bbe\u7f6e\u4e3a multipart/form-data \uff08\u4e0a\u4f20\u6587\u4ef6\u8fd9\u4e00\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u5c06input\u6807\u7b7e\u7684\u7c7b\u578b\u8bbe\u7f6e\u4e3afile\u6765\u5b9e\u73b0\uff09 Host \u670d\u52a1\u5668\u7684\u540d\u5b57\u4ee5\u53ca\u7aef\u53e3\u53f7 \u5982\u679c\u8fd9\u4e2a\u9996\u90e8\u6ca1\u6709\u8bb0\u5f55\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7\uff0c\u5c31\u8868\u793a\u670d\u52a1\u5668\u4f7f\u7528\u7684\u662f80\u7aef\u53e3 Referrer \u53d1\u8d77\u8bf7\u6c42\u7684\u9875\u9762\u6240\u5728\u5730\u5740 User-Agent \u5bf9\u53d1\u8d77\u8bf7\u6c42\u7684\u5ba2\u6237\u7aef\u8fdb\u884c\u63cf\u8ff0","title":"\u8bf7\u6c42\u9996\u90e8"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#http_2","text":"HTTP\u54cd\u5e94\u62a5\u6587\u662f\u5bf9HTTP\u8bf7\u6c42\u62a5\u6587\u7684\u56de\u590d\u3002\u8ddfHTTP\u8bf7\u6c42\u4e00\u6837\uff0cHTTP\u76f8\u5e94\u4e5f\u662f\u6709\u4e00\u7cfb\u5217\u6587\u672c\u884c\u7ec4\u6210\u7684\uff0c\u5176\u4e2d\u5305\u62ec\uff1a \u4e00\u4e2a\u72b6\u6001\u884c \u96f6\u4e2a\u6216\u4efb\u610f\u6570\u91cf\u7684\u54cd\u5e94\u9996\u90e8 \u4e00\u4e2a\u7a7a\u884c \u4e00\u4e2a\u53ef\u9009\u7684\u62a5\u6587\u4e3b\u4f53 HTTP\u54cd\u5e94\uff0c\u5982\u4e0b\uff1a 200 OK // \u72b6\u6001\u884c\uff0c\u5305\u542b\u72b6\u6001\u7801\u548c\u54cd\u5e94\u7684\u539f\u56e0\u77ed\u8bed\uff08\u5bf9\u72b6\u6001\u7801\u8fdb\u884c\u7b80\u5355\u7684\u63cf\u8ff0\uff09 Date: Sat, 22 Nov 2014 12:58:58 GMT Server: Apache/2 \u3000Last-Modified: Thu, 28 Aug 2014 21:01:33 GMT Content-Length: 33115 Content-Type: text/html; charset=iso-8859-1 // HTML\u683c\u5f0f\u7684\u62a5\u6587\u4e3b\u4f53 !DOCTYPE html PUBLIC -//W3C//DTD XHTML 1.0 Strict//EN http://www.w3.org/ \u3000\u3000 TR/xhtml1/DTD/xhtml1-strict.dtd html xmlns='http://www.w3.org/1999/ \u3000\u3000 xhtml' head title Hypertext Transfer Protocol -- HTTP/1.1 /title / \u3000\u3000 head body ... /body /html","title":"HTTP\u54cd\u5e94"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#_4","text":"HTTP\u54cd\u5e94\u4e2d\u7684\u72b6\u6001\u7801\u8868\u660e\u4e86\u54cd\u5e94\u7684\u7c7b\u578b\uff0cHTTP\u54cd\u5e94\u72b6\u6001\u7801\u5171\u67095\u79cd\u7c7b\u578b\uff0c\u5206\u522b\u4ee5\u4e0d\u540c\u7684\u6570\u5b57\u4f5c\u4e3a\u524d\u7f00\u3002 \u72b6\u6001\u7801\u7c7b\u578b \u4f5c\u7528\u63cf\u8ff0 \u8bf4\u660e 1XX \u60c5\u62a5\u72b6\u6001\u7801 \u670d\u52a1\u5668\u901a\u8fc7\u8fd9\u4e9b\u72b6\u6001\u7801\u6765\u544a\u77e5\u5ba2\u6237\u7aef\uff0c\u81ea\u5df1\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u5df2\u7ecf\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4e86\u5904\u7406 2XX \u6210\u529f\u72b6\u6001\u7801 \u8fd9\u4e9b\u72b6\u6001\u7801\u8bf4\u660e\u670d\u52a1\u5668\u5df2\u7ecf\u63a5\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u6210\u529f\u5730\u5bf9\u8bf7\u6c42\u8fdb\u884c\u4e86\u5904\u7406\uff0c\u8fd9\u7c7b\u72b6\u6001\u7801\u7684\u6807\u51c6\u54cd\u5e94\u4e3a\u201c200 OK\u201d 3XX \u91cd\u5b9a\u5411\u72b6\u6001\u7801 \u8fd9\u4e9b\u72b6\u6001\u7801\u8868\u793a\u670d\u52a1\u5668\u5df2\u7ecf\u6536\u5230\u4e86\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u5e76\u4e14\u5df2\u7ecf\u6210\u529f\u5904\u7406\u4e86\u8bf7\u6c42\uff0c\u4f46\u662f\u4e3a\u4e86\u5b8c\u6210\u8bf7\u6c42\u6307\u5b9a\u7684\u52a8\u4f5c\uff0c\u5ba2\u6237\u7aef\u8fd8\u9700\u8981\u518d\u505a\u4e00\u4e9b\u5176\u4ed6\u7684\u5de5\u4f5c\uff0c\u8fd9\u91cc\u72b6\u6001\u7801\u5927\u591a\u7528\u4e8e\u5b9e\u73b0URL\u91cd\u5b9a\u5411\u3002 4XX \u5ba2\u6237\u7aef\u9519\u8bef\u72b6\u6001\u7801 \u8fd9\u7c7b\u72b6\u6001\u7801\u8bf4\u660e\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u8bf7\u6c42\u51fa\u73b0\u4e86\u67d0\u4e9b\u95ee\u9898\u3002\u5728\u8fd9\u4e00\u7c7b\u578b\u7684\u72b6\u6001\u7801\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u201c404 Not Found\u201d\uff0c\u8fd9\u4e2a\u72b6\u6001\u7801\u8868\u793a\u670d\u52a1\u5668\u65e0\u6cd5\u4ece\u8bf7\u6c42\u6307\u5b9a\u7684URL\u4e2d\u627e\u5230\u5ba2\u6237\u7aef\u60f3\u8981\u7684\u8d44\u6e90 5XX \u670d\u52a1\u5668\u9519\u8bef\u72b6\u6001\u7801 \u5f53\u670d\u52a1\u5668\u56e0\u4e3a\u67d0\u4e9b\u539f\u56e0\u800c\u65e0\u6cd5\u6b63\u786e\u5730\u5904\u7406\u8bf7\u6c42\u65f6\uff0c\u670d\u52a1\u5668\u5c31\u4f1a\u4f7f\u7528\u8fd9\u7c7b\u72b6\u6001\u7801\u6765\u901a\u77e5\u5ba2\u6237\u7aef\uff0c\u8fd9\u4e00\u7c7b\u578b\u7684\u72b6\u6001\u7801\u4e2d\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u201c500 Internal Server Error\u201d\u72b6\u6001\u7801\u3002","title":"\u54cd\u5e94\u72b6\u6001\u7801"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#_5","text":"\u54cd\u5e94\u9996\u90e8\u8ddf\u8bf7\u6c42\u9996\u90e8\u4e00\u6837\uff0c\u662f\u7531\u5192\u53f7\u5206\u9694\u7684\u7eaf\u6587\u672c\u952e\u503c\u5bf9\u7ec4\u6210\uff0c\u5e76\u4e14\u540c\u65f6\u4ee5\u56de\u8f66\uff08CR\uff09\u548c\u6362\u884c\uff08LF\uff09\u7ed3\u5c3e\u3002 \u8bf7\u6c42\u9996\u90e8\u80fd\u591f\u544a\u8bc9\u670d\u52a1\u5668\u66f4\u591a\u4e0e\u8bf7\u6c42\u76f8\u5173\u6216\u8005\u4e0e\u5ba2\u6237\u7aef\u8bc9\u6c42\u76f8\u5173\u7684\u4fe1\u606f \u54cd\u5e94\u9996\u90e8\u80fd\u591f\u5411\u5ba2\u6237\u7aef\u4f20\u8fbe\u66f4\u591a\u54cd\u5e94\u76f8\u5173\u6216\u8005\u4e0e\u670d\u52a1\u5668\u8bc9\u6c42\u76f8\u5173\u7684\u4fe1\u606f \u5e38\u89c1\u54cd\u5e94\u9996\u90e8\u5982\u4e0b\uff1a \u9996\u90e8\u5b57\u6bb5 \u4f5c\u7528\u63cf\u8ff0 Allow \u544a\u77e5\u5ba2\u6237\u7aef\uff0c\u670d\u52a1\u5668\u652f\u6301\u90a3\u4e9b\u8bf7\u6c42\u65b9\u6cd5 Content-Length \u54cd\u5e94\u4e3b\u4f53\u7684\u5b57\u8282\u957f\u5ea6 Content-Type \u5982\u679c\u54cd\u5e94\u5305\u542b\u53ef\u9009\u7684\u4e3b\u4f53\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9996\u90e8\u8bb0\u5f55\u7684\u5c31\u662f\u4e3b\u4f53\u7684\u5185\u5bb9\u7684\u7c7b\u578b Date \u4ee5\u683c\u6797\u5c3c\u6cbb\u6807\u51c6\u65f6\u95f4\uff08GMT\uff09\u683c\u5f0f\u8bb0\u5f55\u7684\u5f53\u524d\u65f6\u95f4 Location \u8fd9\u4e2a\u9996\u90e8\u4ec5\u5728\u91cd\u5b9a\u5411\u7684\u65f6\u5019\u4f7f\u7528\uff0c\u5b83\u4f1a\u9ad8\u67f1\u5ba2\u6237\u7aef\u63a5\u4e0b\u6765\u5e94\u8be5\u5411\u54ea\u4e2aURL\u53d1\u9001\u8bf7\u6c42 Server \u54cd\u5e94\u7684\u670d\u52a1\u5668\u7684\u57df\u540d Set-Cookie \u5728\u5ba2\u6237\u7aef\u91cc\u8bbe\u7f6e\u4e00\u4e2aCookie\uff0c\u4e00\u4e2a\u54cd\u5e94\u91cc\u9762\u53ef\u4ee5\u5305\u542b\u591a\u4e2aSet-Cookie\u9996\u90e8 WWW-Authenticate \u670d\u52a1\u5668\u901a\u8fc7\u8fd9\u4e2a\u9996\u90e8\u6765\u544a\u8bc9\u5ba2\u6237\u7aef\uff0c\u5728Authorization\u8bf7\u6c42\u9996\u90e8\u4e2d\u5e94\u8be5\u63d0\u4f9b\u54ea\u79cd\u7c7b\u578b\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u3002\u670d\u52a1\u5668\u5f02\u5e38\u4f1a\u628a\u8fd9\u4e2a\u9996\u90e8\u4e0e\u201c401 Unauthorized\u201d\u72b6\u6001\u884c\u4e00\u540c\u53d1\u9001\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u8fd9\u4e2a\u9996\u90e8\u8fd8\u4f1a\u5411\u670d\u52a1\u5668\u8bb8\u53ef\u7684\u8ba4\u8bc1\u6388\u6743\u6a21\u5f0f\uff08scheme\uff09\u63d0\u4f9b\u9a8c\u8bc1\u4fe1\u606f\uff08challenge information\uff09","title":"\u54cd\u5e94\u9996\u90e8"},{"location":"Frameworks/Go-Web/HTTP/HTTP/#uri","text":"\u4e00\u79cd\u4f7f\u7528\u5b57\u7b26\u4e32\u8868\u793a\u8d44\u6e90\u540d\u7684\u65b9\u6cd5\uff1a\u7edf\u4e00\u8d44\u6e90\u540d\u79f0\uff08Uniform Resource Name\uff0cURN\uff09 \u4e00\u79cd\u4f7f\u7528\u5b57\u7b26\u4e32\u8868\u793a\u8d44\u6e90\u6240\u5728\u4e3a\u6b62\u7684\u65b9\u6cd5\uff1a\u7edf\u4e00\u8d44\u6e90\u5b9a\u4f4d\u7b26\uff08Uniform Resource Location\uff0cURL\uff09 URI\u662f\u4e00\u4e2a\u6db5\u76d6\u6027\u672f\u8bed\uff0c\u5b83\u5305\u542b\u4e86URN\u548cURL\uff0c\u5e76\u4e14\u8fd9\u4e24\u8005\u4e5f\u62e5\u6709\u76f8\u4f3c\u7684\u8bed\u6cd5\u548c\u683c\u5f0f\u3002 URI\u4e00\u822c\u683c\u5f0f\u4e3a\uff1a \u65b9\u6848\u540d\u79f0 : \u5206\u5c42\u90e8\u5206 [? \u67e5\u8be2\u53c2\u6570 ][# \u7247\u6bb5 ] URI\u7684\u65b9\u6848\u540d\u79f0\uff08scheme name\uff09\u8bb0\u5f55\u4e86URI\u6b63\u5728\u4f7f\u7528\u7684\u65b9\u6848\uff0c\u5b83\u5b9a\u4e49\u4e86URI\u5176\u4f59\u90e8\u5206\u7684\u7ed3\u6784\u3002\u56e0\u4e3aURI\u662f\u4e00\u79cd\u975e\u5e38\u5e38\u7528\u7684\u8d44\u6e90\u6807\u8bc6\u65b9\u5f0f\uff0c\u6240\u4ee5\u5b83\u62e5\u6709\u5927\u91cf\u7684\u65b9\u6848\u53ef\u4f9b\u4f7f\u7528\uff0c\u5927\u90e8\u5206\u65f6\u5019\u4f7f\u7528HTTP\u65b9\u6848\u3002 URI\u7684\u5206\u5c42\u90e8\u5206\uff08hierarchical part\uff09\u5305\u542b\u4e86\u8d44\u6e90\u7684\u8bc6\u522b\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u4ee5\u5206\u5c42\u7684\u65b9\u5f0f\u8fdb\u884c\u7ec4\u7ec7\u3002\u5982\u679c\u5206\u5c42\u90e8\u5206\u4ee5\u53cc\u659c\u6760\uff08//\uff09\u5f00\u5934\uff0c\u90a3\u4e48\u8bf4\u660e\u5b83\u5305\u542b\u4e86\u53ef\u9009\u7684\u7528\u6237\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5c06\u4ee5@\u7b26\u5408\u7ed3\u5c3e\uff0c\u540e\u8ddf\u5206\u5c42\u8def\u5f84\u3002\u4e0d\u5e26\u7528\u6237\u4fe1\u606f\u7684\u5206\u5c42\u90e8\u5206\u5c31\u662f\u4e00\u4e2a\u5355\u7eaf\u7684\u8def\u5f84\uff0c\u6bcf\u4e2a\u8def\u5f84\u90fd\u7531\u4e00\u8fde\u4e32\u7684\u5206\u6bb5\uff08segment\uff09\u7ec4\u6210\uff0c\u5404\u4e2a\u5206\u6bb5\u4e4b\u95f4\u4f7f\u7528\u5355\u659c\u7ebf\uff08/\uff09\u5206\u9694\u3002 \u5728URI\u7684\u5404\u4e2a\u90e8\u5206\u5f53\u4e2d\uff0c\u53ea\u6709\u201c\u65b9\u6848\u540d\u79f0\u201d\u548c\u201c\u5206\u5c42\u90e8\u5206\u201d\u662f\u5fc5\u987b\u7684\u3002\u4ee5\u95ee\u53f7\uff08?\uff09\u4e3a\u524d\u7f00\u7684\u67e5\u8be2\u53c2\u6570\uff08query\uff09\u662f\u53ef\u9009\u7684\uff0c\u8fd9\u4e9b\u53c2\u6570\u7528\u4e8e\u5305\u542b\u65e0\u6cd5\u4f7f\u7528\u5206\u5c42\u65b9\u5f0f\u8868\u793a\u7684\u5176\u4ed6\u4fe1\u606f\u3002\u591a\u4e2a\u67e5\u8be2\u53c2\u6570\u4f1a\u88ab\u7ec4\u7ec7\u6210\u4e00\u8fde\u4e32\u7684\u952e\u503c\u5bf9\uff0c\uff0c\u5404\u4e2a\u952e\u503c\u5bf9\u4e4b\u95f4\u4f7f\u7528 \u7b26\u53f7\u5206\u9694\u3002 URI\u7684\u53e6\u4e00\u4e2a\u53ef\u9009\u90e8\u5206\u4e3a\u7247\u6bb5\uff08fragment\uff09,\u7247\u6bb5\u4f7f\u7528\u4e95\u53f7\uff08#\uff09\u4f5c\u4e3a\u524d\u7f00\uff0c\u5b83\u53ef\u4ee5\u5bf9URI\u5b9a\u4e49\u7684\u8d44\u6e90\u4e2d\u7684\u6b21\u7ea7\u8d44\u6e90\u8fdb\u884c\u8868\u793a\uff08secondary resource\uff09\u8fdb\u884c\u6807\u8bc6\u3002\u5f53URI\u5305\u542b\u53c2\u6570\u65f6\uff0cURI\u7684\u7247\u6bb5\u5c06\u88ab\u653e\u5728\u67e5\u8be2\u53c2\u6570\u4e4b\u540e\u3002\u56e0\u4e3aURI\u7684\u7247\u6bb5\u662f\u6709\u5ba2\u6237\u7aef\u8d1f\u8d23\u5904\u7406\u7684\uff0c\u6240\u4ee5Web\u6d4f\u89c8\u5668\u5728\u5c06URI\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u4e4b\u524d\uff0c\u4e00\u822c\u90fd\u4f1a\u5148\u628aURI\u4e2d\u7684\u7247\u6bb5\u79fb\u9664\u3002\uff08\u5982\u679c\u60f3\u8981\u53d6\u5f97URI\u7247\u6bb5\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7JS\u6216\u67d0\u4e2aHTTP\u5ba2\u6237\u7aef\u5e93\uff0c\u5c06URI\u7247\u6bb5\u5305\u542b\u5728\u4e00\u4e2aGET\u8bf7\u6c42\u91cc\u9762\uff09\u3002 \u4f7f\u7528HTTP\u65b9\u6848\u7684URI\u793a\u4f8b\uff1a http://sausheong:password@www.example. com/ docs/file?name=sausheong location=singapore#summary \u8fd9\u4e2aURI\u4f7f\u7528\u7684\u662fHTTP\u65b9\u6848 \u8ddf\u5728\u65b9\u6848\u4e4b\u540e\u7684\u662f\u4e00\u4e2a\u5192\u53f7\uff0c\u4f4d\u4e8e@\u7b26\u53f7\u4e4b\u524d\u7684\u5206\u6bb5 sausheong:password \u8ddf\u5728\u7528\u6237\u4fe1\u606f\u4e4b\u540e\u7684\u662f www.example.com/docs/file \u662f\u5206\u5c42\u90e8\u5206\u7684\u5176\u4f59\u90e8\u5206\uff0c\u4f4d\u4e8e\u5206\u5c42\u90e8\u5206\u6700\u9ad8\u5c42\u7684\u662f\u670d\u52a1\u5668\u7684\u57df\u540d wwwexample.com \uff0c\u4e4b\u540e\u8ddf\u7740\u7684\u4e24\u4e2a\u5c42\u5206\u522b\u4e3adoc\u548cfile\u3002\u6bcf\u4e2a\u5206\u5c42\u7528\u5355\u659c\u6760\u5206\u9694\u3002 \u8ddf\u5728\u5206\u5c42\u90e8\u5206\u4e4b\u540e\u662f\u4ee5\u95ee\u53f7\uff08?\uff09\u4e3a\u524d\u7f00\u7684\u67e5\u8be2\u53c2\u6570\uff0c\u8fd9\u4e2a\u90e8\u5206\u5305\u542b\u4e86 name=sausheong \u548c location=singapore \u8fd9\u4e24\u4e2a\u952e\u503c\u5bf9\uff0c\u952e\u503c\u5bf9\u4e4b\u95f4\u4f7f\u7528 \u7b26\u53f7\u8fde\u63a5 \u6700\u540e\uff0c\u8fd9\u4e2aURI\u7684\u672b\u5c3e\u8fd8\u5e26\u6709\u4e00\u4e2a\u4ee5\u4e95\u53f7\uff08#\uff09\u524d\u7f00\u7684\u7247\u6bb5 \u56e0\u4e3a\u6bcf\u4e2aURI\u90fd\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5URI\u91cc\u9762\u662f\u4e0d\u80fd\u591f\u5305\u542b\u7a7a\u683c\u7684\uff0c\u6b64\u5916\uff0c\u56e0\u4e3a\u95ee\u53f7\uff08?\uff09\u548c\u4e95\u53f7\uff08#\uff09\u7b49\u7b26\u53f7\u5728URL\u4e2d\u5177\u6709\u7279\u6b8a\u7684\u542b\u4e49\uff0c\u6240\u4ee5\u8fd9\u4e9b\u7b26\u53f7\u662f\u4e0d\u80fd\u591f\u7528\u4e8e\u5176\u4ed6\u7528\u9014\u7684\uff0c\u672a\u6765\u907f\u5f00\u8fd9\u4e9b\u9650\u5236\uff0c\u9700\u8981\u4f7f\u7528URI\u7f16\u7801\uff08\u767e\u5206\u53f7\u7f16\u7801\uff09\u6765\u5bf9\u7279\u6b8a\u7b26\u53f7\u8fdb\u884c\u8f6c\u6362\u3002 \u6240\u6709\u4fdd\u7559\u5b57\u7b26\u9700\u8981\u8fdb\u884c\u767e\u5206\u53f7\u7f16\u7801\uff0c\u628a\u4fdd\u7559\u5b57\u7b26\u8f6c\u6362\u6210\u8be5\u5b57\u7b26\u5728ASCII\u7f16\u7801\u4e2d\u5bf9\u5e94\u7684\u5b57\u8282\u503c\uff08byte value\uff09,\u63a5\u7740\u628a\u8fd9\u4e2a\u5b57\u8282\u503c\u8868\u793a\u4e3a\u4e00\u4e2a\u4e24\u4f4d\u957f\u7684\u5341\u516d\u8fdb\u5236\u6570\u7ec4\uff0c\u6700\u540e\u518d\u5728\u8fd9\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u5b57\u7684\u524d\u9762\u52a0\u4e0a\u4e00\u4e2a\u767e\u5206\u53f7\uff08%\uff09\u3002 \u4f8b\u5982\uff0c\u7a7a\u683c\u5728ASCII\u7f16\u7801\u4e2d\u7684\u5b57\u8282\u503c\u4e3a32\uff0c\u5373\u5341\u516d\u8fdb\u5236\u4e2d\u768420\u3002\u56e0\u6b64\uff0c\u7ecf\u8fc7\u767e\u5206\u53f7\u7f16\u7801\u5904\u7406\u7684\u7a7a\u683c\u5c31\u6210\u4e86%20\uff0cURI\u4e2d\u6240\u6709\u7a7a\u683c\u90fd\u4f1a\u88ab\u66ff\u6362\u6210\u8fd9\u4e2a\u503c\uff0c\u5982\u4e0b\u6240\u793a\uff1a http://www.example.com/docs/file? name=sau%20sheong location=singapore \u3002","title":"URI"},{"location":"Frameworks/Go-kit/FAQ/","text":"Go-kit \u4ec0\u4e48\u662fGo kit Go kit\u662fGo\u8bed\u8a00\u5e93\u7684\u4e00\u4e2a\u96c6\u5408\u5e2e\u52a9\u6784\u5efa\u53ef\u9760\u3001\u5065\u58ee\u3001\u53ef\u7ef4\u62a4\u7684\u5fae\u670d\u52a1\u3002\u5b83\u6700\u521d\u88ab\u8ba4\u4e3a\u662f\u4e00\u79cd\u5de5\u5177\u5305\uff0c\u53ef\u4ee5\u5e2e\u52a9\u5927\u578b\uff08\u6240\u8c13\u7684\u73b0\u4ee3\u4f01\u4e1a\uff09\u7ec4\u7ec7\u91c7\u7528Go\u4f5c\u4e3a\u5f00\u53d1\u8bed\u8a00\uff0c\u540c\u65f6\u4e5f\u4e3a\u8f83\u5c0f\u7684\u521d\u521b\u4f01\u4e1a\u548c\u7ec4\u7ec7\u670d\u52a1\u3002\u6709\u5173Go kit\u8d77\u6e90\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Go kit\uff1a\u73b0\u4ee3\u4f01\u4e1a\u4e2d\u7684Go \u3002 \u4e3a\u4ec0\u4e48\u9700\u8981\u4f7f\u7528Go kit \u5982\u679c\u8981\u5728\u7ec4\u7ec7\u4e2d\u91c7\u7528\u5fae\u670d\u52a1\u6a21\u5f0f\uff0c\u90a3\u4e48\u5e94\u8be5\u4f7f\u7528Go kit\uff0c\u5b83\u5c06\u6709\u52a9\u4e8e\u67b6\u6784\u548c\u521b\u5efa\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u4ee5\u907f\u514d\u5e38\u89c1\u7684\u9677\u9631\uff0c\u4ece\u800c\u7f16\u5199\u4f18\u96c5\u7684\u4ee3\u7801\u3002 Go kit\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u8bc1\u660eGo\u4f5c\u4e3a\u5f00\u53d1\u8bed\u8a00\u7684\u5408\u7406\u6027\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u6210\u719f\u7684\u6a21\u5f0f\u548c\u4e60\u60ef\u7528\u6cd5\uff08\u7531\u5927\u91cf\u7ecf\u9a8c\u4e30\u5bcc\u7684\u5f00\u53d1\u8005\u7f16\u5199\u548c\u7ef4\u62a4\uff0c\u5e76\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8fdb\u884c\u9a8c\u8bc1\u7684\uff09\uff0c\u964d\u4f4e\u4e86Go\u548c\u5fae\u670d\u52a1\u7684\u98ce\u9669\u3002 Go kit\u7684\u7ef4\u62a4\u8005 Go kit\u6700\u521d\u662f\u7531Peter Bourgon\u6784\u601d\u7684\uff0c\u4f46\u662f\u9650\u5236\u7531\u6765\u81ea\u4e0d\u540c\u80cc\u666f\u548c\u7ec4\u7ec7\u7684\u4e00\u5927\u6279\u8d21\u732e\u8005\u6784\u5efa\u548c\u7ef4\u62a4\u3002Go kit\u76ee\u524d\u662f\u7eaf\u81ea\u53d1\u7ef4\u62a4\u7684\uff0c\u6ca1\u6709\u4efb\u4f55\u5546\u4e1a\u652f\u6301\u3002 Go kit\u662f\u5426\u53ef\u7528\u4e8e\u751f\u4ea7\u73af\u5883 \u53ef\u4ee5\uff0c\u76ee\u524dGo kit\u5df2\u7ecf\u5728\u591a\u4e2a\u7ec4\u7ec7\u4e2d\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u3002 Go kit\u4e0eGo Micro\u76f8\u6bd4\u5982\u4f55 \u50cfGo kit\u4e00\u6837\uff0cMicro\u5c06\u81ea\u5df1\u63cf\u8ff0\u4e3a\u5fae\u670d\u52a1\u5de5\u5177\u7bb1\u3002\u4f46\u662f\u4e0eGo\u5de5\u5177\u5305\u4e0d\u540c\uff0cMicro\u8fd8\u5c06\u81ea\u5df1\u63cf\u8ff0\u4e3a\u5fae\u670d\u52a1\u751f\u6001\u7cfb\u7edf\u3002\u5b83\u5177\u6709\u66f4\u5e7f\u9614\u7684\u89c6\u91ce\uff0c\u5bf9\u6709\u5173\u57fa\u7840\u67b6\u6784\u548c\u4f53\u7cfb\u7ed3\u6784\u7684\u671f\u671b\u548c\u610f\u89c1\u8fdb\u884c\u4e86\u5b9a\u4e49\u3002\u7b80\u800c\u8a00\u4e4b\uff0cMicro\u5e0c\u671b\u6210\u4e3a\u4e00\u4e2a\u5e73\u53f0\u3002\u76f8\u53cd\uff0cGo kit\u5e0c\u671b\u96c6\u6210\u5230\u5176\u4ed6\u5e73\u53f0\u4e2d\u3002","title":"Go-kit"},{"location":"Frameworks/Go-kit/FAQ/#go-kit","text":"","title":"Go-kit"},{"location":"Frameworks/Go-kit/FAQ/#go-kit_1","text":"Go kit\u662fGo\u8bed\u8a00\u5e93\u7684\u4e00\u4e2a\u96c6\u5408\u5e2e\u52a9\u6784\u5efa\u53ef\u9760\u3001\u5065\u58ee\u3001\u53ef\u7ef4\u62a4\u7684\u5fae\u670d\u52a1\u3002\u5b83\u6700\u521d\u88ab\u8ba4\u4e3a\u662f\u4e00\u79cd\u5de5\u5177\u5305\uff0c\u53ef\u4ee5\u5e2e\u52a9\u5927\u578b\uff08\u6240\u8c13\u7684\u73b0\u4ee3\u4f01\u4e1a\uff09\u7ec4\u7ec7\u91c7\u7528Go\u4f5c\u4e3a\u5f00\u53d1\u8bed\u8a00\uff0c\u540c\u65f6\u4e5f\u4e3a\u8f83\u5c0f\u7684\u521d\u521b\u4f01\u4e1a\u548c\u7ec4\u7ec7\u670d\u52a1\u3002\u6709\u5173Go kit\u8d77\u6e90\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Go kit\uff1a\u73b0\u4ee3\u4f01\u4e1a\u4e2d\u7684Go \u3002","title":"\u4ec0\u4e48\u662fGo kit"},{"location":"Frameworks/Go-kit/FAQ/#go-kit_2","text":"\u5982\u679c\u8981\u5728\u7ec4\u7ec7\u4e2d\u91c7\u7528\u5fae\u670d\u52a1\u6a21\u5f0f\uff0c\u90a3\u4e48\u5e94\u8be5\u4f7f\u7528Go kit\uff0c\u5b83\u5c06\u6709\u52a9\u4e8e\u67b6\u6784\u548c\u521b\u5efa\u670d\u52a1\uff0c\u5e76\u4e14\u53ef\u4ee5\u907f\u514d\u5e38\u89c1\u7684\u9677\u9631\uff0c\u4ece\u800c\u7f16\u5199\u4f18\u96c5\u7684\u4ee3\u7801\u3002 Go kit\u8fd8\u53ef\u4ee5\u5e2e\u52a9\u8bc1\u660eGo\u4f5c\u4e3a\u5f00\u53d1\u8bed\u8a00\u7684\u5408\u7406\u6027\uff0c\u5b83\u901a\u8fc7\u63d0\u4f9b\u6210\u719f\u7684\u6a21\u5f0f\u548c\u4e60\u60ef\u7528\u6cd5\uff08\u7531\u5927\u91cf\u7ecf\u9a8c\u4e30\u5bcc\u7684\u5f00\u53d1\u8005\u7f16\u5199\u548c\u7ef4\u62a4\uff0c\u5e76\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u8fdb\u884c\u9a8c\u8bc1\u7684\uff09\uff0c\u964d\u4f4e\u4e86Go\u548c\u5fae\u670d\u52a1\u7684\u98ce\u9669\u3002","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u4f7f\u7528Go kit"},{"location":"Frameworks/Go-kit/FAQ/#go-kit_3","text":"Go kit\u6700\u521d\u662f\u7531Peter Bourgon\u6784\u601d\u7684\uff0c\u4f46\u662f\u9650\u5236\u7531\u6765\u81ea\u4e0d\u540c\u80cc\u666f\u548c\u7ec4\u7ec7\u7684\u4e00\u5927\u6279\u8d21\u732e\u8005\u6784\u5efa\u548c\u7ef4\u62a4\u3002Go kit\u76ee\u524d\u662f\u7eaf\u81ea\u53d1\u7ef4\u62a4\u7684\uff0c\u6ca1\u6709\u4efb\u4f55\u5546\u4e1a\u652f\u6301\u3002","title":"Go kit\u7684\u7ef4\u62a4\u8005"},{"location":"Frameworks/Go-kit/FAQ/#go-kit_4","text":"\u53ef\u4ee5\uff0c\u76ee\u524dGo kit\u5df2\u7ecf\u5728\u591a\u4e2a\u7ec4\u7ec7\u4e2d\u7528\u4e8e\u751f\u4ea7\u73af\u5883\u3002","title":"Go kit\u662f\u5426\u53ef\u7528\u4e8e\u751f\u4ea7\u73af\u5883"},{"location":"Frameworks/Go-kit/FAQ/#go-kitgo-micro","text":"\u50cfGo kit\u4e00\u6837\uff0cMicro\u5c06\u81ea\u5df1\u63cf\u8ff0\u4e3a\u5fae\u670d\u52a1\u5de5\u5177\u7bb1\u3002\u4f46\u662f\u4e0eGo\u5de5\u5177\u5305\u4e0d\u540c\uff0cMicro\u8fd8\u5c06\u81ea\u5df1\u63cf\u8ff0\u4e3a\u5fae\u670d\u52a1\u751f\u6001\u7cfb\u7edf\u3002\u5b83\u5177\u6709\u66f4\u5e7f\u9614\u7684\u89c6\u91ce\uff0c\u5bf9\u6709\u5173\u57fa\u7840\u67b6\u6784\u548c\u4f53\u7cfb\u7ed3\u6784\u7684\u671f\u671b\u548c\u610f\u89c1\u8fdb\u884c\u4e86\u5b9a\u4e49\u3002\u7b80\u800c\u8a00\u4e4b\uff0cMicro\u5e0c\u671b\u6210\u4e3a\u4e00\u4e2a\u5e73\u53f0\u3002\u76f8\u53cd\uff0cGo kit\u5e0c\u671b\u96c6\u6210\u5230\u5176\u4ed6\u5e73\u53f0\u4e2d\u3002","title":"Go kit\u4e0eGo Micro\u76f8\u6bd4\u5982\u4f55"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/","text":"\u67b6\u6784\u4e0e\u8bbe\u8ba1 \u7b80\u4ecb--\u4e86\u89e3Go kit\u6838\u5fc3\u6982\u5ff5 \u5982\u679c\u4e4b\u524d\u4f7f\u7528\u7684\u662fMVC\u6837\u5f0f\u6846\u67b6\uff0c\u5982\uff1a Symfony\uff08PHP\uff09 Rails\uff08Ruby\uff09 Django\uff08Python\uff09 \u90a3\u4e48\u9996\u5148\u8981\u77e5\u9053\u7684\u662fGo kit\u4e0d\u662fMVC\u6846\u67b6\u3002\u76f8\u53cd\uff0cGo kit\u670d\u52a1\u5206\u4e3a\u4e09\u5c42\uff1a \u4f20\u8f93\u5c42\uff08Transport\uff09 \u7aef\u70b9\u5c42\uff08Endpoint\uff09 \u670d\u52a1\u5c42\uff08Service\uff09 \u8bf7\u6c42\u5728\u7b2c\u4e00\u5c42\u8fdb\u5165\u670d\u52a1\uff0c\u7136\u540e\u6d41\u5411\u7b2c\u4e09\u5c42\uff0c\u800c\u54cd\u5e94\u5219\u662f\u76f8\u53cd\u7684\u8fc7\u7a0b\u3002 \u8fd9\u53ef\u80fd\u8fd8\u4f1a\u6709\u8c03\u6574\uff0c\u4f46\u662f\u4e00\u65e6\u61c2\u4e86\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4fbf\u4f1a\u53d1\u73b0Go kit\u7684\u8bbe\u8ba1\u975e\u5e38\u9002\u5408\u73b0\u4ee3\u8f6f\u4ef6\u8bbe\u8ba1\uff1a\u5fae\u670d\u52a1\u548c\u6240\u8c13\u7684\u4f18\u96c5\u7684\u5355\u4f53\u67b6\u6784\u3002 \u4f20\u8f93 \u4f20\u8f93\u57df\u7ed1\u5b9a\u5230HTTP\u6216gRPC\u4e4b\u7c7b\u7684\u5177\u4f53\u4f20\u8f93\u65b9\u5f0f\u4e0a\uff0c\u5728\u5fae\u670d\u52a1\u53ef\u80fd\u652f\u6301\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4f20\u8f93\u65b9\u5f0f\u7684\u4e16\u754c\u4e2d\uff0c\u8fd9\u662f\u975e\u5e38\u5f3a\u5927\u7684\u3002\u53ef\u4ee5\u5728\u5355\u4e2a\u5fae\u670d\u52a1\u4e2d\u652f\u6301\u65e7\u7248\u7684HTTP API\u548c\u65b0\u7248\u7684RPC\u670d\u52a1\u3002 \u5728\u5b9e\u73b0Restful HTTP API\u65f6\uff0c\u8def\u7531\u662f\u5728HTTP\u4f20\u8f93\u4e2d\u5b9a\u4e49\u7684\uff0c\u6700\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u5728HTTP\u7684\u8def\u7531\u5668\u4e2d\u5b9a\u4e49\u5177\u4f53\u7684\u8def\u7531\uff0c\u5982\u4e0b\u6240\u793a\uff1a r.Methods( POST ).Path( /profiles/ ).Handler(httptransport.NewServer( e.PostProfileEndpoint, decodePostProfileRequest, encodeResponse, options..., )) \u652f\u6301\u7684\u4f20\u8f93\u534f\u8bae Go kit\u9644\u5e26\u4e86\u5bf9HTTP\uff0c gRPC \uff0c Thrift \u548c net/rpc \u7684\u652f\u6301\u3002\u6dfb\u52a0\u5bf9\u65b0\u4f20\u8f93\u7684\u652f\u6301\u5f88\u7b80\u5355\uff1b\u5982\u679c\u9700\u8981\u7684\u4e1c\u897f\u8fd8\u6ca1\u6709\u63d0\u4f9b\uff0c\u5c31\u63d0\u51fa\u4e00\u4e2a issue \u3002 \u7aef\u70b9 \u7aef\u70b9\u5c31\u50cf\u662f\u63a7\u5236\u5668\u4e0a\u7684\u5904\u7406\u7a0b\u5e8f\uff0c\u5b83\u662f\u5b89\u5168\u4e14\u6297\u903b\u8f91\u8106\u5f31\u6027\u7684\u3002\u5982\u679c\u5b9e\u73b0\u4e86\u4e24\u79cd\u4f20\u8f93\uff08HTTP\u548cgRPC\uff09\uff0c\u90a3\u4e48\u53ef\u80fd\u6709\u4e24\u79cd\u65b9\u6cd5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u7aef\u70b9\u3002 \u670d\u52a1 \u670d\u52a1\u662f\u5b9e\u73b0\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u7684\u5730\u65b9\uff0c\u670d\u52a1\u901a\u5e38\u5c06\u591a\u4e2a\u7aef\u70b9\u7c98\u5408\u5728\u4e00\u8d77\u3002\u5728Go kit\u4e2d\uff0c\u670d\u52a1\u901a\u5e38\u88ab\u5efa\u6a21\u4e3a\u63a5\u53e3\uff08interface\uff09\uff0c\u5e76\u4e14\u8fd9\u4e9b\u63a5\u53e3\u7684\u5b9e\u73b0\u5305\u542b\u4e1a\u52a1\u903b\u8f91\u3002 Go kit\u7684\u670d\u52a1\u5e94\u8be5\u52aa\u529b\u9075\u5b88\u201c \u6e05\u6d01\u67b6\u6784 \u201d\u6216\u8005\u201c \u516d\u89d2\u67b6\u6784 \u201d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e1a\u52a1\u903b\u8f91\u5e94\u8be5\u4e0d\u4e86\u89e3\u7aef\u70b9\u6216\u4f20\u8f93\u57df\u7684\u6982\u5ff5\uff0c\u670d\u52a1\u4e0d\u5e94\u8be5\u77e5\u9053HTTP\u6807\u5934\u6216gRPC\u9519\u8bef\u4ee3\u7801\u3002 \u4e2d\u95f4\u4ef6 Go kit\u8bd5\u56fe\u901a\u8fc7\u4f7f\u7528\u4e2d\u95f4\u4ef6\uff08\u4fee\u9970\u5668\uff09\u6a21\u5f0f\u6765\u4e25\u683c\u5206\u79bb\u5173\u6ce8\u70b9\u3002\u4e2d\u95f4\u4ef6\u53ef\u4ee5\u5305\u88c5\u7aef\u70b9\u6216\u670d\u52a1\u4ee5\u6dfb\u52a0\u529f\u80fd\uff0c\u4f8b\u5982\u65e5\u5fd7\u8bb0\u5f55\u3001\u901f\u7387\u9650\u5236\u3001\u8d1f\u8f7d\u5747\u8861\u6216\u5206\u5e03\u5f0f\u8ffd\u8e2a\u3002\u5728\u7aef\u70b9\u6216\u670d\u52a1\u5468\u56f4\u94fe\u63a5\u591a\u4e2a\u4e2d\u95f4\u4ef6\u662f\u5f88\u5e38\u89c1\u7684\u3002 \u8bbe\u8ba1\uff1aGo kit\u5fae\u670d\u52a1\u5982\u4f55\u5efa\u6a21 \u7efc\u5408\u6240\u6709\u8fd9\u4e9b\u6982\u5ff5\uff0c\u6211\u4eec\u770b\u5230Go kit\u5fae\u670d\u52a1\u7684\u5efa\u6a21\u5c31\u50cf\u6d0b\u8471\u4e00\u6837\uff0c\u6709\u5f88\u591a\u5c42\u3002\u8fd9\u4e9b\u5c42\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u57df\u3002 \u6700\u91cc\u9762\u662f\u670d\u52a1\u57df\uff1a\u4e00\u5207\u90fd\u57fa\u4e8e\u7279\u5b9a\u7684\u670d\u52a1\u5b9a\u4e49\uff0c\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u90fd\u5728\u6b64\u5b9e\u73b0 \u4e2d\u95f4\u662f\u7aef\u70b9\u57df\uff1a\u5c06\u670d\u52a1\u7684\u6bcf\u79cd\u65b9\u6cd5\u62bd\u8c61\u5230\u901a\u7528 \u7aef\u70b9 \uff0c\u5b83\u4e5f\u662f\u5b9e\u73b0\u5b89\u5168\u548c\u9632\u8106\u5f31\u903b\u8f91\u7684\u5730\u65b9 \u6700\u5916\u90e8\u662f\u4f20\u8f93\u57df\uff1a\u7aef\u70b9\u7ed1\u5b9a\u5230\u8bf8\u5982HTTP\u6216gRPC\u4e4b\u7c7b\u7684\u5177\u4f53\u4f20\u8f93\u534f\u8bae\u7684\u5730\u65b9 \u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u670d\u52a1\u7684\u63a5\u53e3\u5e76\u63d0\u4f9b\u5177\u4f53\u7684\u4ee3\u7801\u5b9e\u73b0\u6765\u5b9e\u73b0\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u3002 \u7136\u540e\uff0c\u7f16\u5199\u670d\u52a1\u4e2d\u95f4\u4ef6\u4ee5\u63d0\u4f9b\u5176\u4ed6\u529f\u80fd\uff0c\u4f8b\u5982\u65e5\u5fd7\u8bb0\u5f55\uff0c\u5206\u6790\uff0c\u68c0\u6d4b\uff0c\u8fd9\u4e9b\u90fd\u9700\u8981\u4e1a\u52a1\u9886\u57df\u7684\u77e5\u8bc6\u3002 Go kit\u63d0\u4f9b\u4e86\u7aef\u70b9\u548c\u4f20\u8f93\u57df\u4e2d\u95f4\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u901f\u7387\u9650\u5236\uff0c\u65ad\u8def\u5668\uff0c\u8d1f\u8f7d\u5747\u8861\u548c\u5206\u5e03\u5f0f\u8ddf\u8e2a\u7b49\u529f\u80fd\uff0c\u800c\u6240\u6709\u8fd9\u4e9b\u529f\u80fd\u901a\u5e38\u90fd\u4e0e\u4e1a\u52a1\u9886\u57df\u65e0\u5173\u3002 \u7b80\u800c\u8a00\u4e4b\uff0cGo kit\u8bd5\u56fe\u901a\u8fc7\u7cbe\u5fc3\u4f7f\u7528\u4e2d\u95f4\u4ef6\uff08\u6216\u4fee\u9970\u5668\uff09\u6a21\u5f0f\u6765\u5f3a\u5236\u5c06\u5173\u6ce8\u70b9\u4e25\u683c\u5206\u79bb\u3002 \u4f9d\u8d56\u6ce8\u5165\uff1a\u4e3a\u4ec0\u4e48func main\u603b\u662f\u90a3\u4e48\u5927 Go kit\u9f13\u52b1\u5c06\u670d\u52a1\u8bbe\u8ba1\u4e3a\u591a\u4e2a\u4ea4\u4e92\u7ec4\u4ef6\uff0c\u5305\u62ec\u591a\u4e2a\u5355\u4e00\u7528\u9014\u7684\u4e2d\u95f4\u4ef6\u3002 \u7ecf\u9a8c\u544a\u8bc9\u6211\u4eec\uff0c\u5728\u5fae\u670d\u52a1\u4e2d\u5b9a\u4e49\u5e76\u8fde\u63a5\u7ec4\u4ef6\u6700\u597d\u65b9\u5f0f\u662f\u5728main\u51fd\u6570\u4e3b\u4f53\u4e2d\u663e\u5f0f\u58f0\u660e\u5404\u7ec4\u4ef6\u7684\u4f9d\u8d56\u5173\u7cfb\u3002 \u63a7\u5236\u53cd\u8f6c\u662f\u5176\u4ed6\u6846\u67b6\u7684\u5e38\u89c1\u529f\u80fd\uff0c\u53ef\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u6216\u670d\u52a1\u5b9a\u4f4d\u5668\u6a21\u5f0f\u5b9e\u73b0\u3002 \u4f46\u662f\u5728Go kit\u4e2d\uff0c\u5e94\u8be5\u5728main\u51fd\u6570\u4e2d\u5c06\u6574\u4e2a\u7ec4\u4ef6\u56fe\u8fde\u63a5\u8d77\u6765\u3002 \u8fd9\u79cd\u98ce\u683c\u5f3a\u5316\u4e86\u4e24\u4e2a\u91cd\u8981\u7684\u4f18\u70b9\uff1a \u901a\u8fc7\u4e25\u683c\u4fdd\u6301\u7ec4\u4ef6\u751f\u547d\u5468\u671f\u5904\u4e8emain\u51fd\u6570\u4e2d\uff0c\u53ef\u4ee5\u907f\u514d\u4f9d\u8d56\u5168\u5c40\u72b6\u6001\u4f5c\u4e3a\u6377\u5f84\uff0c\u8fd9\u5bf9\u4e8e\u53ef\u6d4b\u8bd5\u6027\u81f3\u5173\u91cd\u8981\u3002 \u800c\u4e14\u5982\u679c\u7ec4\u4ef6\u7684\u4f5c\u7528\u57df\u662fmain\uff0c\u5219\u5c06\u5b83\u4eec\u4f5c\u4e3a\u5bf9\u5176\u4ed6\u7ec4\u4ef6\u4f9d\u8d56\u7684\u552f\u4e00\u65b9\u6cd5\u662f\uff0c\u4f5c\u4e3a\u53c2\u6570\u663e\u5f0f\u4f20\u9012\u7ed9\u6784\u9020\u51fd\u6570\uff0c\u8fd9\u4f7f\u4f9d\u8d56\u5173\u7cfb\u4fdd\u6301\u660e\u786e\uff0c\u4ece\u800c\u5728\u542f\u52a8\u4e4b\u524d\u6d88\u9664\u4e86\u5f88\u591a\u6280\u672f\u503a\u52a1\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u5177\u6709\u4ee5\u4e0b\u7ec4\u4ef6\uff1a Logger TodoService, \u5b9e\u73b0\u670d\u52a1\u63a5\u53e3 LoggingMiddleware,\u5b9e\u73b0\u670d\u52a1\u63a5\u53e3\uff0c\u4f9d\u8d56Logger\u548c\u5177\u4f53\u7684TodoService Endpoints, \u4f9d\u8d56\u670d\u52a1\u63a5\u53e3 HTTP (transport), \u4f9d\u8d56\u7aef\u70b9 \u90a3\u4e48main\u51fd\u6570\u5e94\u8be5\u4ee5\u4ee5\u4e0b\u65b9\u5f0f\u7f16\u5199\uff1a logger := log.NewLogger(...) var service todo.Service // interface service = todo.NewService() // concrete struct service = todo.NewLoggingMiddleware(logger)(service) endpoints := todo.NewEndpoints(service) transport := todo.NewHTTPTransport(endpoints) \u4ee5\u62e5\u6709\u6f5c\u5728\u7684\u5de8\u5927main\u51fd\u6570\u4e3a\u4ee3\u4ef7\uff0c\u663e\u5f0f\u58f0\u660e\u7ec4\u4ef6\u7684\u8fde\u63a5\u3002\u6709\u5173\u66f4\u901a\u7528\u7684Go\u8bbe\u8ba1\u6280\u5de7\uff0c\u8bf7\u53c2\u9605 \u516d\u5468\u5e74\uff1aGo\u6700\u4f73\u5b9e\u8df5 \u3002 \u90e8\u7f72 \u8fd9\u5b8c\u5168\u53d6\u51b3\u4e8e\u4f60\u3002 \u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u9759\u6001\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5c06\u5176scp\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u4f7f\u7528 runit \u4e4b\u7c7b\u7684\u7ba1\u7406\u7a0b\u5e8f \u53ef\u4ee5\u4f7f\u7528 Packer \u4e4b\u7c7b\u7684\u5de5\u5177\u6765\u521b\u5efaAMI\uff0c\u5e76\u5c06\u5176\u90e8\u7f72\u5230 EC2\u81ea\u52a8\u4f38\u7f29\u7ec4 \u4e2d \u53ef\u4ee5\u5c06\u670d\u52a1\u6253\u5305\u5230\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u5c06\u5176\u8fd0\u9001\u5230\u6ce8\u518c\u8868\uff0c\u7136\u540e\u5c06\u5176\u90e8\u7f72\u5230 Kubernetes \u7b49\u4e91\u539f\u751f\u5e73\u53f0\u4e0a Go kit\u4e3b\u8981\u4e0e\u670d\u52a1\u4e2d\u7684\u826f\u597d\u8f6f\u4ef6\u5de5\u7a0b\u6709\u5173\uff1b \u5b83\u8bd5\u56fe\u4e0e\u4efb\u4f55\u7c7b\u578b\u7684\u5e73\u53f0\u6216\u57fa\u7840\u67b6\u6784\u5f88\u597d\u5730\u96c6\u6210\u3002 \u9519\u8bef\uff1a\u5982\u4f55\u7f16\u7801\u9519\u8bef \u670d\u52a1\u65b9\u6cd5\u53ef\u80fd\u4f1a\u8fd4\u56de\u9519\u8bef\uff0c\u4e24\u4e2a\u9009\u9879\u53ef\u4ee5\u5728\u7aef\u70b9\u4e2d\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\uff1a \u5728\u54cd\u5e94\u7ed3\u6784\u4e2d\u5305\u542b\u9519\u8bef\u5b57\u6bb5\uff0c\u7136\u540e\u5728\u5176\u4e2d\u8fd4\u56de\u4e1a\u52a1\u57df\u9519\u8bef \u5728\u7aef\u70b9\u9519\u8bef\u8fd4\u56de\u503c\u4e2d\u8fd4\u56de\u4e1a\u52a1\u57df\u9519\u8bef \u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u8d77\u4f5c\u7528\u3002 \u4f46\u662f\u7aef\u70b9\u76f4\u63a5\u8fd4\u56de\u7684\u9519\u8bef\u4f1a\u88ab\u68c0\u67e5\u6545\u969c\u7684\u4e2d\u95f4\u4ef6\u8bc6\u522b\uff0c\u4f8b\u5982\u65ad\u8def\u5668\u3002 \u670d\u52a1\u4e2d\u7684\u4e1a\u52a1\u57df\u9519\u8bef\u4e0d\u592a\u53ef\u80fd\u5bfc\u81f4\u65ad\u8def\u5668\u5728\u5ba2\u6237\u7aef\u8df3\u95f8\u3002 \u56e0\u6b64\uff0c\u53ef\u80fd\u5e94\u8be5\u5728\u54cd\u5e94\u7ed3\u6784\u4e2d\u7f16\u7801\u9519\u8bef\u3002 addsvc \u5305\u542b\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u793a\u4f8b\u3002 \u670d\u52a1\u53d1\u73b0 \u652f\u6301\u7684\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf Go kit\u9644\u5e26\u5bf9 Consul \uff0c etcd \uff0c ZooKeeper \u548c DNS SRV \u8bb0\u5f55\u7684\u652f\u6301\u3002 \u662f\u5426\u9700\u8981\u4f7f\u7528sd\u5305 \u8fd9\u53d6\u51b3\u4e8e\u57fa\u7840\u67b6\u6784\u3002 \u67d0\u4e9b\u5e73\u53f0\uff08\u4f8b\u5982Kubernetes\uff09\u81ea\u8eab\u8d1f\u8d23\u6ce8\u518c\u670d\u52a1\u5b9e\u4f8b\uff0c\u5e76\u901a\u8fc7\u5e73\u53f0\u7279\u5b9a\u7684\u6982\u5ff5\uff08 service \uff09\u4f7f\u5b83\u4eec\u81ea\u52a8\u53ef\u53d1\u73b0\u3002\u56e0\u6b64\uff0c \u5982\u679c\u5728Kubernetes\u4e0a\u8fd0\u884c\uff0c\u5219\u53ef\u80fd\u4e0d\u9700\u8981\u4f7f\u7528sd\u8f6f\u4ef6\u5305 \u3002 \u4f46\u662f\uff0c\u5982\u679c\u5c06\u81ea\u5df1\u7684\u57fa\u7840\u67b6\u6784\u6216\u5e73\u53f0\u4e0e\u5f00\u6e90\u7ec4\u4ef6\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5219\u670d\u52a1\u53ef\u80fd\u9700\u8981\u5728\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u8fdb\u884c\u6ce8\u518c\u3002\u6216\u8005\uff0c\u5982\u679c\u5df2\u8fbe\u5230\u5185\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u6210\u4e3a\u74f6\u9888\u7684\u89c4\u6a21\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8ba9\u670d\u52a1\u76f4\u63a5\u8ba2\u9605\u8bb0\u5f55\u7cfb\u7edf\uff0c\u5e76\u7ef4\u62a4\u81ea\u5df1\u7684\u8fde\u63a5\u6c60\uff08\u8fd9\u662f \u5ba2\u6237\u7aef\u670d\u52a1\u53d1\u73b0\u6a21\u5f0f \uff09\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0csd\u5305\u5c06\u5f88\u6709\u7528\u3002 \u53ef\u89c2\u5bdf\u6027\uff1a\u652f\u6301\u54ea\u4e9b\u76d1\u63a7\u7cfb\u7edf Go kit\u9644\u5e26\u4e86\u5bf9\u73b0\u4ee3\u76d1\u63a7\u7cfb\u7edf\uff08\u5982 Prometheus \u548c InfluxDB \uff09\u4ee5\u53ca\u66f4\u4f20\u7edf\u7684\u7cfb\u7edf\uff08\u5982 statsd \uff0c Graphite \u548c expvar \uff09\u4ee5\u53ca\u6258\u7ba1\u7cfb\u7edf\uff08\u5982\u901a\u8fc7 DogStatsD \u548c Circonus \u7684Datadog\uff09\u7684\u652f\u6301\u3002 \u5f3a\u70c8\u63a8\u8350\u4f7f\u7528\uff1aPrometheus \u65e5\u5fd7\u8bb0\u5f55 \u7ecf\u9a8c\u544a\u8bc9\u6211\u4eec\uff0c\u4e00\u4e2a\u597d\u7684\u65e5\u5fd7\u8bb0\u5f55\u7a0b\u5e8f\u5305\u5e94\u57fa\u4e8e\u6700\u5c0f\u7684\u63a5\u53e3\uff0c\u5e76\u5e94\u6267\u884c\u6240\u8c13\u7684\u7ed3\u6784\u5316\u65e5\u5fd7\u8bb0\u5f55\u3002 \u57fa\u4e8e\u8fd9\u4e9b\u4e0d\u53d8\u6027\uff0cGo kit\u7684\u5957\u4ef6\u65e5\u5fd7\u7ecf\u8fc7\u591a\u6b21\u8bbe\u8ba1\u8fed\u4ee3\uff0c\u5e7f\u6cdb\u7684\u57fa\u51c6\u6d4b\u8bd5\u4ee5\u53ca\u5927\u91cf\u5b9e\u9645\u4f7f\u7528\u800c\u6f14\u53d8\u6210\u5f53\u524d\u72b6\u6001\u3002 \u6709\u4e86\u660e\u786e\u5b9a\u4e49\u7684\u6838\u5fc3\u89c4\u7ea6\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u719f\u6089\u7684\u4fee\u9970\u5668\u6a21\u5f0f\u8f7b\u677e\u5730\u89e3\u51b3\u8bf8\u5982\u65e5\u5fd7\u7b49\u7ea7\u3001\u5f69\u8272\u8f93\u51fa\u548c\u540c\u6b65\u4e4b\u7c7b\u7684\u8f85\u52a9\u95ee\u9898\u3002 \u521a\u5f00\u59cb\u65f6\u53ef\u80fd\u4f1a\u611f\u5230\u6709\u4e9b\u964c\u751f\uff0c\u4f46\u662f\u6211\u4eec\u8ba4\u4e3a log \u5305\u5728\u53ef\u7528\u6027\uff0c\u53ef\u7ef4\u62a4\u6027\u548c\u6027\u80fd\u4e4b\u95f4\u53d6\u5f97\u4e86\u7406\u60f3\u7684\u5e73\u8861\u3002 \u6709\u5173 log \u5305\u6f14\u53d8\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u95ee\u9898\u548cPR 63 \u3001 76 \u3001 131 \u3001 157 \u548c 252 \u3002 \u6709\u5173\u65e5\u5fd7\u8bb0\u5f55\u539f\u7406\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 The Hunt for a Logger Interface , Let\u2019s talk about logging \u548c Logging v. instrumentation. \u5982\u4f55\u805a\u5408\u65e5\u5fd7 \u6536\u96c6\uff0c\u8fd0\u8f93\u548c\u805a\u5408\u65e5\u5fd7\u662f\u5e73\u53f0\u7684\u8d23\u4efb\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u670d\u52a1\u7684\u8d23\u4efb\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u786e\u4fdd\u5c06\u65e5\u5fd7\u5199\u5165 stdout/stderr \uff0c\u7136\u540e\u8ba9\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u6765\u5904\u7406\u5176\u4f59\u90e8\u5206\u3002 Panics \u8fd0\u884c\u65f6\u6050\u614c\u8868\u793a\u7a0b\u5e8f\u5458\u7f16\u7801\u9519\u8bef\uff0c\u5e76\u53d1\u51fa\u9519\u8bef\u7684\u7a0b\u5e8f\u72b6\u6001\u4fe1\u53f7\u3002 \u4e0d\u5e94\u5c06\u5b83\u4eec\u89c6\u4e3a\u9519\u8bef\u6216 ersatz \u5f02\u5e38\u3002 \u901a\u5e38\uff0c\u4e0d\u5e94\u660e\u786e\u5730\u4ece\u6050\u614c\u4e2d\u6062\u590d\uff1a\u5e94\u8be5\u5141\u8bb8\u5b83\u4eec\u4f7f\u7a0b\u5e8f\u6216\u5904\u7406\u7a0b\u5e8fgoroutine\u5d29\u6e83\uff0c\u5e76\u5141\u8bb8\u670d\u52a1\u5c06\u4e2d\u65ad\u7684\u54cd\u5e94\u8fd4\u56de\u7ed9\u8c03\u7528\u5ba2\u6237\u7aef\u3002 \u53ef\u89c2\u5bdf\u6027\u5806\u6808\u5e94\u5728\u51fa\u73b0\u8fd9\u4e9b\u95ee\u9898\u65f6\u53d1\u51fa\u63d0\u9192\uff0c\u7136\u540e\u5e94\u5c3d\u5feb\u4fee\u590d\u53bb\u5b83\u4eec\u3002 \u8bdd\u867d\u5982\u6b64\uff0c\u5982\u679c\u9700\u8981\u5904\u7406\u5f02\u5e38\uff0c\u6700\u597d\u7684\u7b56\u7565\u53ef\u80fd\u662f\u4f7f\u7528\u6267\u884c\u6062\u590d\u7684\u4f20\u8f93\u5c42\u7684\u7279\u5b9a\u4e2d\u95f4\u4ef6\u5305\u88c5\u5177\u4f53\u7684\u4f20\u8f93\u534f\u8bae\u3002\u4f8b\u5982\uff0c\u4f7f\u7528HTTP\uff1a var h http.Handler h = httptransport.NewServer(...) h = newRecoveringMiddleware(h, ...) // use h normally \u6301\u4e45\u6027\uff1a\u5982\u4f55\u4f7f\u7528\u6570\u636e\u5e93\u548c\u6570\u636e\u5b58\u50a8 \u8bbf\u95ee\u6570\u636e\u5e93\u901a\u5e38\u662f\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u7684\u4e00\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u5305\u542b\u4e00\u4e2a * sql.DB \u6307\u9488\u5728\u670d\u52a1\u7684\u5177\u4f53\u5b9e\u73b0\u4e2d\u3002 type MyService struct { db *sql.DB value string logger log.Logger } func NewService(db *sql.DB, value string, logger log.Logger) *MyService { return MyService{ db: db, value: value, logger: logger, } } \u66f4\u597d\u7684\u662f\uff1a\u8003\u8651\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\u6765\u5bf9\u6301\u4e45\u6027\u64cd\u4f5c\u8fdb\u884c\u5efa\u6a21\u3002 \u8be5\u63a5\u53e3\u5c06\u5904\u7406\u4e1a\u52a1\u57df\u5bf9\u8c61\uff0c\u5e76\u5177\u6709\u5305\u88c5\u6570\u636e\u5e93\u53e5\u67c4\u7684\u5b9e\u73b0\u3002 \u4f8b\u5982\uff0c\u4e3a\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u8003\u8651\u4e00\u4e2a\u7b80\u5355\u7684\u6301\u4e45\u5c42\u3002 type Store interface { Insert(Profile) error Select(id string) (Profile, error) Delete(id string) error } type databaseStore struct{ db *sql.DB } func (s *databaseStore) Insert(p Profile) error { /* ... */ } func (s *databaseStore) Select(id string) (Profile, error) { /* ... */ } func (s *databaseStore) Delete(id string) error { /* ... */ } \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5728\u5177\u4f53\u7684\u5b9e\u73b0\u4e2d\u5305\u542b\u4e00\u4e2astore\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a * sql.DB \u3002","title":"\u67b6\u6784\u4e0e\u8bbe\u8ba1"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_1","text":"","title":"\u67b6\u6784\u4e0e\u8bbe\u8ba1"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#-go-kit","text":"\u5982\u679c\u4e4b\u524d\u4f7f\u7528\u7684\u662fMVC\u6837\u5f0f\u6846\u67b6\uff0c\u5982\uff1a Symfony\uff08PHP\uff09 Rails\uff08Ruby\uff09 Django\uff08Python\uff09 \u90a3\u4e48\u9996\u5148\u8981\u77e5\u9053\u7684\u662fGo kit\u4e0d\u662fMVC\u6846\u67b6\u3002\u76f8\u53cd\uff0cGo kit\u670d\u52a1\u5206\u4e3a\u4e09\u5c42\uff1a \u4f20\u8f93\u5c42\uff08Transport\uff09 \u7aef\u70b9\u5c42\uff08Endpoint\uff09 \u670d\u52a1\u5c42\uff08Service\uff09 \u8bf7\u6c42\u5728\u7b2c\u4e00\u5c42\u8fdb\u5165\u670d\u52a1\uff0c\u7136\u540e\u6d41\u5411\u7b2c\u4e09\u5c42\uff0c\u800c\u54cd\u5e94\u5219\u662f\u76f8\u53cd\u7684\u8fc7\u7a0b\u3002 \u8fd9\u53ef\u80fd\u8fd8\u4f1a\u6709\u8c03\u6574\uff0c\u4f46\u662f\u4e00\u65e6\u61c2\u4e86\u8fd9\u4e9b\u6982\u5ff5\uff0c\u4fbf\u4f1a\u53d1\u73b0Go kit\u7684\u8bbe\u8ba1\u975e\u5e38\u9002\u5408\u73b0\u4ee3\u8f6f\u4ef6\u8bbe\u8ba1\uff1a\u5fae\u670d\u52a1\u548c\u6240\u8c13\u7684\u4f18\u96c5\u7684\u5355\u4f53\u67b6\u6784\u3002","title":"\u7b80\u4ecb--\u4e86\u89e3Go kit\u6838\u5fc3\u6982\u5ff5"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_2","text":"\u4f20\u8f93\u57df\u7ed1\u5b9a\u5230HTTP\u6216gRPC\u4e4b\u7c7b\u7684\u5177\u4f53\u4f20\u8f93\u65b9\u5f0f\u4e0a\uff0c\u5728\u5fae\u670d\u52a1\u53ef\u80fd\u652f\u6301\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u4f20\u8f93\u65b9\u5f0f\u7684\u4e16\u754c\u4e2d\uff0c\u8fd9\u662f\u975e\u5e38\u5f3a\u5927\u7684\u3002\u53ef\u4ee5\u5728\u5355\u4e2a\u5fae\u670d\u52a1\u4e2d\u652f\u6301\u65e7\u7248\u7684HTTP API\u548c\u65b0\u7248\u7684RPC\u670d\u52a1\u3002 \u5728\u5b9e\u73b0Restful HTTP API\u65f6\uff0c\u8def\u7531\u662f\u5728HTTP\u4f20\u8f93\u4e2d\u5b9a\u4e49\u7684\uff0c\u6700\u5e38\u89c1\u7684\u60c5\u51b5\u662f\u5728HTTP\u7684\u8def\u7531\u5668\u4e2d\u5b9a\u4e49\u5177\u4f53\u7684\u8def\u7531\uff0c\u5982\u4e0b\u6240\u793a\uff1a r.Methods( POST ).Path( /profiles/ ).Handler(httptransport.NewServer( e.PostProfileEndpoint, decodePostProfileRequest, encodeResponse, options..., ))","title":"\u4f20\u8f93"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_3","text":"Go kit\u9644\u5e26\u4e86\u5bf9HTTP\uff0c gRPC \uff0c Thrift \u548c net/rpc \u7684\u652f\u6301\u3002\u6dfb\u52a0\u5bf9\u65b0\u4f20\u8f93\u7684\u652f\u6301\u5f88\u7b80\u5355\uff1b\u5982\u679c\u9700\u8981\u7684\u4e1c\u897f\u8fd8\u6ca1\u6709\u63d0\u4f9b\uff0c\u5c31\u63d0\u51fa\u4e00\u4e2a issue \u3002","title":"\u652f\u6301\u7684\u4f20\u8f93\u534f\u8bae"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_4","text":"\u7aef\u70b9\u5c31\u50cf\u662f\u63a7\u5236\u5668\u4e0a\u7684\u5904\u7406\u7a0b\u5e8f\uff0c\u5b83\u662f\u5b89\u5168\u4e14\u6297\u903b\u8f91\u8106\u5f31\u6027\u7684\u3002\u5982\u679c\u5b9e\u73b0\u4e86\u4e24\u79cd\u4f20\u8f93\uff08HTTP\u548cgRPC\uff09\uff0c\u90a3\u4e48\u53ef\u80fd\u6709\u4e24\u79cd\u65b9\u6cd5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u540c\u4e00\u4e2a\u7aef\u70b9\u3002","title":"\u7aef\u70b9"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_5","text":"\u670d\u52a1\u662f\u5b9e\u73b0\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u7684\u5730\u65b9\uff0c\u670d\u52a1\u901a\u5e38\u5c06\u591a\u4e2a\u7aef\u70b9\u7c98\u5408\u5728\u4e00\u8d77\u3002\u5728Go kit\u4e2d\uff0c\u670d\u52a1\u901a\u5e38\u88ab\u5efa\u6a21\u4e3a\u63a5\u53e3\uff08interface\uff09\uff0c\u5e76\u4e14\u8fd9\u4e9b\u63a5\u53e3\u7684\u5b9e\u73b0\u5305\u542b\u4e1a\u52a1\u903b\u8f91\u3002 Go kit\u7684\u670d\u52a1\u5e94\u8be5\u52aa\u529b\u9075\u5b88\u201c \u6e05\u6d01\u67b6\u6784 \u201d\u6216\u8005\u201c \u516d\u89d2\u67b6\u6784 \u201d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e1a\u52a1\u903b\u8f91\u5e94\u8be5\u4e0d\u4e86\u89e3\u7aef\u70b9\u6216\u4f20\u8f93\u57df\u7684\u6982\u5ff5\uff0c\u670d\u52a1\u4e0d\u5e94\u8be5\u77e5\u9053HTTP\u6807\u5934\u6216gRPC\u9519\u8bef\u4ee3\u7801\u3002","title":"\u670d\u52a1"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_6","text":"Go kit\u8bd5\u56fe\u901a\u8fc7\u4f7f\u7528\u4e2d\u95f4\u4ef6\uff08\u4fee\u9970\u5668\uff09\u6a21\u5f0f\u6765\u4e25\u683c\u5206\u79bb\u5173\u6ce8\u70b9\u3002\u4e2d\u95f4\u4ef6\u53ef\u4ee5\u5305\u88c5\u7aef\u70b9\u6216\u670d\u52a1\u4ee5\u6dfb\u52a0\u529f\u80fd\uff0c\u4f8b\u5982\u65e5\u5fd7\u8bb0\u5f55\u3001\u901f\u7387\u9650\u5236\u3001\u8d1f\u8f7d\u5747\u8861\u6216\u5206\u5e03\u5f0f\u8ffd\u8e2a\u3002\u5728\u7aef\u70b9\u6216\u670d\u52a1\u5468\u56f4\u94fe\u63a5\u591a\u4e2a\u4e2d\u95f4\u4ef6\u662f\u5f88\u5e38\u89c1\u7684\u3002","title":"\u4e2d\u95f4\u4ef6"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#go-kit","text":"\u7efc\u5408\u6240\u6709\u8fd9\u4e9b\u6982\u5ff5\uff0c\u6211\u4eec\u770b\u5230Go kit\u5fae\u670d\u52a1\u7684\u5efa\u6a21\u5c31\u50cf\u6d0b\u8471\u4e00\u6837\uff0c\u6709\u5f88\u591a\u5c42\u3002\u8fd9\u4e9b\u5c42\u53ef\u4ee5\u5206\u4e3a\u4e09\u4e2a\u57df\u3002 \u6700\u91cc\u9762\u662f\u670d\u52a1\u57df\uff1a\u4e00\u5207\u90fd\u57fa\u4e8e\u7279\u5b9a\u7684\u670d\u52a1\u5b9a\u4e49\uff0c\u6240\u6709\u4e1a\u52a1\u903b\u8f91\u90fd\u5728\u6b64\u5b9e\u73b0 \u4e2d\u95f4\u662f\u7aef\u70b9\u57df\uff1a\u5c06\u670d\u52a1\u7684\u6bcf\u79cd\u65b9\u6cd5\u62bd\u8c61\u5230\u901a\u7528 \u7aef\u70b9 \uff0c\u5b83\u4e5f\u662f\u5b9e\u73b0\u5b89\u5168\u548c\u9632\u8106\u5f31\u903b\u8f91\u7684\u5730\u65b9 \u6700\u5916\u90e8\u662f\u4f20\u8f93\u57df\uff1a\u7aef\u70b9\u7ed1\u5b9a\u5230\u8bf8\u5982HTTP\u6216gRPC\u4e4b\u7c7b\u7684\u5177\u4f53\u4f20\u8f93\u534f\u8bae\u7684\u5730\u65b9 \u53ef\u4ee5\u901a\u8fc7\u5b9a\u4e49\u670d\u52a1\u7684\u63a5\u53e3\u5e76\u63d0\u4f9b\u5177\u4f53\u7684\u4ee3\u7801\u5b9e\u73b0\u6765\u5b9e\u73b0\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u3002 \u7136\u540e\uff0c\u7f16\u5199\u670d\u52a1\u4e2d\u95f4\u4ef6\u4ee5\u63d0\u4f9b\u5176\u4ed6\u529f\u80fd\uff0c\u4f8b\u5982\u65e5\u5fd7\u8bb0\u5f55\uff0c\u5206\u6790\uff0c\u68c0\u6d4b\uff0c\u8fd9\u4e9b\u90fd\u9700\u8981\u4e1a\u52a1\u9886\u57df\u7684\u77e5\u8bc6\u3002 Go kit\u63d0\u4f9b\u4e86\u7aef\u70b9\u548c\u4f20\u8f93\u57df\u4e2d\u95f4\u4ef6\uff0c\u4ee5\u5b9e\u73b0\u901f\u7387\u9650\u5236\uff0c\u65ad\u8def\u5668\uff0c\u8d1f\u8f7d\u5747\u8861\u548c\u5206\u5e03\u5f0f\u8ddf\u8e2a\u7b49\u529f\u80fd\uff0c\u800c\u6240\u6709\u8fd9\u4e9b\u529f\u80fd\u901a\u5e38\u90fd\u4e0e\u4e1a\u52a1\u9886\u57df\u65e0\u5173\u3002 \u7b80\u800c\u8a00\u4e4b\uff0cGo kit\u8bd5\u56fe\u901a\u8fc7\u7cbe\u5fc3\u4f7f\u7528\u4e2d\u95f4\u4ef6\uff08\u6216\u4fee\u9970\u5668\uff09\u6a21\u5f0f\u6765\u5f3a\u5236\u5c06\u5173\u6ce8\u70b9\u4e25\u683c\u5206\u79bb\u3002","title":"\u8bbe\u8ba1\uff1aGo kit\u5fae\u670d\u52a1\u5982\u4f55\u5efa\u6a21"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#func-main","text":"Go kit\u9f13\u52b1\u5c06\u670d\u52a1\u8bbe\u8ba1\u4e3a\u591a\u4e2a\u4ea4\u4e92\u7ec4\u4ef6\uff0c\u5305\u62ec\u591a\u4e2a\u5355\u4e00\u7528\u9014\u7684\u4e2d\u95f4\u4ef6\u3002 \u7ecf\u9a8c\u544a\u8bc9\u6211\u4eec\uff0c\u5728\u5fae\u670d\u52a1\u4e2d\u5b9a\u4e49\u5e76\u8fde\u63a5\u7ec4\u4ef6\u6700\u597d\u65b9\u5f0f\u662f\u5728main\u51fd\u6570\u4e3b\u4f53\u4e2d\u663e\u5f0f\u58f0\u660e\u5404\u7ec4\u4ef6\u7684\u4f9d\u8d56\u5173\u7cfb\u3002 \u63a7\u5236\u53cd\u8f6c\u662f\u5176\u4ed6\u6846\u67b6\u7684\u5e38\u89c1\u529f\u80fd\uff0c\u53ef\u901a\u8fc7\u4f9d\u8d56\u6ce8\u5165\u6216\u670d\u52a1\u5b9a\u4f4d\u5668\u6a21\u5f0f\u5b9e\u73b0\u3002 \u4f46\u662f\u5728Go kit\u4e2d\uff0c\u5e94\u8be5\u5728main\u51fd\u6570\u4e2d\u5c06\u6574\u4e2a\u7ec4\u4ef6\u56fe\u8fde\u63a5\u8d77\u6765\u3002 \u8fd9\u79cd\u98ce\u683c\u5f3a\u5316\u4e86\u4e24\u4e2a\u91cd\u8981\u7684\u4f18\u70b9\uff1a \u901a\u8fc7\u4e25\u683c\u4fdd\u6301\u7ec4\u4ef6\u751f\u547d\u5468\u671f\u5904\u4e8emain\u51fd\u6570\u4e2d\uff0c\u53ef\u4ee5\u907f\u514d\u4f9d\u8d56\u5168\u5c40\u72b6\u6001\u4f5c\u4e3a\u6377\u5f84\uff0c\u8fd9\u5bf9\u4e8e\u53ef\u6d4b\u8bd5\u6027\u81f3\u5173\u91cd\u8981\u3002 \u800c\u4e14\u5982\u679c\u7ec4\u4ef6\u7684\u4f5c\u7528\u57df\u662fmain\uff0c\u5219\u5c06\u5b83\u4eec\u4f5c\u4e3a\u5bf9\u5176\u4ed6\u7ec4\u4ef6\u4f9d\u8d56\u7684\u552f\u4e00\u65b9\u6cd5\u662f\uff0c\u4f5c\u4e3a\u53c2\u6570\u663e\u5f0f\u4f20\u9012\u7ed9\u6784\u9020\u51fd\u6570\uff0c\u8fd9\u4f7f\u4f9d\u8d56\u5173\u7cfb\u4fdd\u6301\u660e\u786e\uff0c\u4ece\u800c\u5728\u542f\u52a8\u4e4b\u524d\u6d88\u9664\u4e86\u5f88\u591a\u6280\u672f\u503a\u52a1\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u5177\u6709\u4ee5\u4e0b\u7ec4\u4ef6\uff1a Logger TodoService, \u5b9e\u73b0\u670d\u52a1\u63a5\u53e3 LoggingMiddleware,\u5b9e\u73b0\u670d\u52a1\u63a5\u53e3\uff0c\u4f9d\u8d56Logger\u548c\u5177\u4f53\u7684TodoService Endpoints, \u4f9d\u8d56\u670d\u52a1\u63a5\u53e3 HTTP (transport), \u4f9d\u8d56\u7aef\u70b9 \u90a3\u4e48main\u51fd\u6570\u5e94\u8be5\u4ee5\u4ee5\u4e0b\u65b9\u5f0f\u7f16\u5199\uff1a logger := log.NewLogger(...) var service todo.Service // interface service = todo.NewService() // concrete struct service = todo.NewLoggingMiddleware(logger)(service) endpoints := todo.NewEndpoints(service) transport := todo.NewHTTPTransport(endpoints) \u4ee5\u62e5\u6709\u6f5c\u5728\u7684\u5de8\u5927main\u51fd\u6570\u4e3a\u4ee3\u4ef7\uff0c\u663e\u5f0f\u58f0\u660e\u7ec4\u4ef6\u7684\u8fde\u63a5\u3002\u6709\u5173\u66f4\u901a\u7528\u7684Go\u8bbe\u8ba1\u6280\u5de7\uff0c\u8bf7\u53c2\u9605 \u516d\u5468\u5e74\uff1aGo\u6700\u4f73\u5b9e\u8df5 \u3002","title":"\u4f9d\u8d56\u6ce8\u5165\uff1a\u4e3a\u4ec0\u4e48func main\u603b\u662f\u90a3\u4e48\u5927"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_7","text":"\u8fd9\u5b8c\u5168\u53d6\u51b3\u4e8e\u4f60\u3002 \u53ef\u4ee5\u6784\u5efa\u4e00\u4e2a\u9759\u6001\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5c06\u5176scp\u5230\u670d\u52a1\u5668\uff0c\u7136\u540e\u4f7f\u7528 runit \u4e4b\u7c7b\u7684\u7ba1\u7406\u7a0b\u5e8f \u53ef\u4ee5\u4f7f\u7528 Packer \u4e4b\u7c7b\u7684\u5de5\u5177\u6765\u521b\u5efaAMI\uff0c\u5e76\u5c06\u5176\u90e8\u7f72\u5230 EC2\u81ea\u52a8\u4f38\u7f29\u7ec4 \u4e2d \u53ef\u4ee5\u5c06\u670d\u52a1\u6253\u5305\u5230\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u5c06\u5176\u8fd0\u9001\u5230\u6ce8\u518c\u8868\uff0c\u7136\u540e\u5c06\u5176\u90e8\u7f72\u5230 Kubernetes \u7b49\u4e91\u539f\u751f\u5e73\u53f0\u4e0a Go kit\u4e3b\u8981\u4e0e\u670d\u52a1\u4e2d\u7684\u826f\u597d\u8f6f\u4ef6\u5de5\u7a0b\u6709\u5173\uff1b \u5b83\u8bd5\u56fe\u4e0e\u4efb\u4f55\u7c7b\u578b\u7684\u5e73\u53f0\u6216\u57fa\u7840\u67b6\u6784\u5f88\u597d\u5730\u96c6\u6210\u3002","title":"\u90e8\u7f72"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_8","text":"\u670d\u52a1\u65b9\u6cd5\u53ef\u80fd\u4f1a\u8fd4\u56de\u9519\u8bef\uff0c\u4e24\u4e2a\u9009\u9879\u53ef\u4ee5\u5728\u7aef\u70b9\u4e2d\u5bf9\u5176\u8fdb\u884c\u7f16\u7801\uff1a \u5728\u54cd\u5e94\u7ed3\u6784\u4e2d\u5305\u542b\u9519\u8bef\u5b57\u6bb5\uff0c\u7136\u540e\u5728\u5176\u4e2d\u8fd4\u56de\u4e1a\u52a1\u57df\u9519\u8bef \u5728\u7aef\u70b9\u9519\u8bef\u8fd4\u56de\u503c\u4e2d\u8fd4\u56de\u4e1a\u52a1\u57df\u9519\u8bef \u4e24\u79cd\u65b9\u6cd5\u90fd\u53ef\u4ee5\u8d77\u4f5c\u7528\u3002 \u4f46\u662f\u7aef\u70b9\u76f4\u63a5\u8fd4\u56de\u7684\u9519\u8bef\u4f1a\u88ab\u68c0\u67e5\u6545\u969c\u7684\u4e2d\u95f4\u4ef6\u8bc6\u522b\uff0c\u4f8b\u5982\u65ad\u8def\u5668\u3002 \u670d\u52a1\u4e2d\u7684\u4e1a\u52a1\u57df\u9519\u8bef\u4e0d\u592a\u53ef\u80fd\u5bfc\u81f4\u65ad\u8def\u5668\u5728\u5ba2\u6237\u7aef\u8df3\u95f8\u3002 \u56e0\u6b64\uff0c\u53ef\u80fd\u5e94\u8be5\u5728\u54cd\u5e94\u7ed3\u6784\u4e2d\u7f16\u7801\u9519\u8bef\u3002 addsvc \u5305\u542b\u8fd9\u4e24\u79cd\u65b9\u6cd5\u7684\u793a\u4f8b\u3002","title":"\u9519\u8bef\uff1a\u5982\u4f55\u7f16\u7801\u9519\u8bef"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_9","text":"","title":"\u670d\u52a1\u53d1\u73b0"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_10","text":"Go kit\u9644\u5e26\u5bf9 Consul \uff0c etcd \uff0c ZooKeeper \u548c DNS SRV \u8bb0\u5f55\u7684\u652f\u6301\u3002","title":"\u652f\u6301\u7684\u670d\u52a1\u53d1\u73b0\u7cfb\u7edf"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#sd","text":"\u8fd9\u53d6\u51b3\u4e8e\u57fa\u7840\u67b6\u6784\u3002 \u67d0\u4e9b\u5e73\u53f0\uff08\u4f8b\u5982Kubernetes\uff09\u81ea\u8eab\u8d1f\u8d23\u6ce8\u518c\u670d\u52a1\u5b9e\u4f8b\uff0c\u5e76\u901a\u8fc7\u5e73\u53f0\u7279\u5b9a\u7684\u6982\u5ff5\uff08 service \uff09\u4f7f\u5b83\u4eec\u81ea\u52a8\u53ef\u53d1\u73b0\u3002\u56e0\u6b64\uff0c \u5982\u679c\u5728Kubernetes\u4e0a\u8fd0\u884c\uff0c\u5219\u53ef\u80fd\u4e0d\u9700\u8981\u4f7f\u7528sd\u8f6f\u4ef6\u5305 \u3002 \u4f46\u662f\uff0c\u5982\u679c\u5c06\u81ea\u5df1\u7684\u57fa\u7840\u67b6\u6784\u6216\u5e73\u53f0\u4e0e\u5f00\u6e90\u7ec4\u4ef6\u7ec4\u5408\u5728\u4e00\u8d77\uff0c\u5219\u670d\u52a1\u53ef\u80fd\u9700\u8981\u5728\u670d\u52a1\u6ce8\u518c\u8868\u4e2d\u8fdb\u884c\u6ce8\u518c\u3002\u6216\u8005\uff0c\u5982\u679c\u5df2\u8fbe\u5230\u5185\u90e8\u8d1f\u8f7d\u5747\u8861\u5668\u6210\u4e3a\u74f6\u9888\u7684\u89c4\u6a21\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8ba9\u670d\u52a1\u76f4\u63a5\u8ba2\u9605\u8bb0\u5f55\u7cfb\u7edf\uff0c\u5e76\u7ef4\u62a4\u81ea\u5df1\u7684\u8fde\u63a5\u6c60\uff08\u8fd9\u662f \u5ba2\u6237\u7aef\u670d\u52a1\u53d1\u73b0\u6a21\u5f0f \uff09\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0csd\u5305\u5c06\u5f88\u6709\u7528\u3002","title":"\u662f\u5426\u9700\u8981\u4f7f\u7528sd\u5305"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_11","text":"Go kit\u9644\u5e26\u4e86\u5bf9\u73b0\u4ee3\u76d1\u63a7\u7cfb\u7edf\uff08\u5982 Prometheus \u548c InfluxDB \uff09\u4ee5\u53ca\u66f4\u4f20\u7edf\u7684\u7cfb\u7edf\uff08\u5982 statsd \uff0c Graphite \u548c expvar \uff09\u4ee5\u53ca\u6258\u7ba1\u7cfb\u7edf\uff08\u5982\u901a\u8fc7 DogStatsD \u548c Circonus \u7684Datadog\uff09\u7684\u652f\u6301\u3002 \u5f3a\u70c8\u63a8\u8350\u4f7f\u7528\uff1aPrometheus","title":"\u53ef\u89c2\u5bdf\u6027\uff1a\u652f\u6301\u54ea\u4e9b\u76d1\u63a7\u7cfb\u7edf"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_12","text":"\u7ecf\u9a8c\u544a\u8bc9\u6211\u4eec\uff0c\u4e00\u4e2a\u597d\u7684\u65e5\u5fd7\u8bb0\u5f55\u7a0b\u5e8f\u5305\u5e94\u57fa\u4e8e\u6700\u5c0f\u7684\u63a5\u53e3\uff0c\u5e76\u5e94\u6267\u884c\u6240\u8c13\u7684\u7ed3\u6784\u5316\u65e5\u5fd7\u8bb0\u5f55\u3002 \u57fa\u4e8e\u8fd9\u4e9b\u4e0d\u53d8\u6027\uff0cGo kit\u7684\u5957\u4ef6\u65e5\u5fd7\u7ecf\u8fc7\u591a\u6b21\u8bbe\u8ba1\u8fed\u4ee3\uff0c\u5e7f\u6cdb\u7684\u57fa\u51c6\u6d4b\u8bd5\u4ee5\u53ca\u5927\u91cf\u5b9e\u9645\u4f7f\u7528\u800c\u6f14\u53d8\u6210\u5f53\u524d\u72b6\u6001\u3002 \u6709\u4e86\u660e\u786e\u5b9a\u4e49\u7684\u6838\u5fc3\u89c4\u7ea6\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u719f\u6089\u7684\u4fee\u9970\u5668\u6a21\u5f0f\u8f7b\u677e\u5730\u89e3\u51b3\u8bf8\u5982\u65e5\u5fd7\u7b49\u7ea7\u3001\u5f69\u8272\u8f93\u51fa\u548c\u540c\u6b65\u4e4b\u7c7b\u7684\u8f85\u52a9\u95ee\u9898\u3002 \u521a\u5f00\u59cb\u65f6\u53ef\u80fd\u4f1a\u611f\u5230\u6709\u4e9b\u964c\u751f\uff0c\u4f46\u662f\u6211\u4eec\u8ba4\u4e3a log \u5305\u5728\u53ef\u7528\u6027\uff0c\u53ef\u7ef4\u62a4\u6027\u548c\u6027\u80fd\u4e4b\u95f4\u53d6\u5f97\u4e86\u7406\u60f3\u7684\u5e73\u8861\u3002 \u6709\u5173 log \u5305\u6f14\u53d8\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u95ee\u9898\u548cPR 63 \u3001 76 \u3001 131 \u3001 157 \u548c 252 \u3002 \u6709\u5173\u65e5\u5fd7\u8bb0\u5f55\u539f\u7406\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 The Hunt for a Logger Interface , Let\u2019s talk about logging \u548c Logging v. instrumentation.","title":"\u65e5\u5fd7\u8bb0\u5f55"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_13","text":"\u6536\u96c6\uff0c\u8fd0\u8f93\u548c\u805a\u5408\u65e5\u5fd7\u662f\u5e73\u53f0\u7684\u8d23\u4efb\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u670d\u52a1\u7684\u8d23\u4efb\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u786e\u4fdd\u5c06\u65e5\u5fd7\u5199\u5165 stdout/stderr \uff0c\u7136\u540e\u8ba9\u53e6\u4e00\u4e2a\u7ec4\u4ef6\u6765\u5904\u7406\u5176\u4f59\u90e8\u5206\u3002","title":"\u5982\u4f55\u805a\u5408\u65e5\u5fd7"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#panics","text":"\u8fd0\u884c\u65f6\u6050\u614c\u8868\u793a\u7a0b\u5e8f\u5458\u7f16\u7801\u9519\u8bef\uff0c\u5e76\u53d1\u51fa\u9519\u8bef\u7684\u7a0b\u5e8f\u72b6\u6001\u4fe1\u53f7\u3002 \u4e0d\u5e94\u5c06\u5b83\u4eec\u89c6\u4e3a\u9519\u8bef\u6216 ersatz \u5f02\u5e38\u3002 \u901a\u5e38\uff0c\u4e0d\u5e94\u660e\u786e\u5730\u4ece\u6050\u614c\u4e2d\u6062\u590d\uff1a\u5e94\u8be5\u5141\u8bb8\u5b83\u4eec\u4f7f\u7a0b\u5e8f\u6216\u5904\u7406\u7a0b\u5e8fgoroutine\u5d29\u6e83\uff0c\u5e76\u5141\u8bb8\u670d\u52a1\u5c06\u4e2d\u65ad\u7684\u54cd\u5e94\u8fd4\u56de\u7ed9\u8c03\u7528\u5ba2\u6237\u7aef\u3002 \u53ef\u89c2\u5bdf\u6027\u5806\u6808\u5e94\u5728\u51fa\u73b0\u8fd9\u4e9b\u95ee\u9898\u65f6\u53d1\u51fa\u63d0\u9192\uff0c\u7136\u540e\u5e94\u5c3d\u5feb\u4fee\u590d\u53bb\u5b83\u4eec\u3002 \u8bdd\u867d\u5982\u6b64\uff0c\u5982\u679c\u9700\u8981\u5904\u7406\u5f02\u5e38\uff0c\u6700\u597d\u7684\u7b56\u7565\u53ef\u80fd\u662f\u4f7f\u7528\u6267\u884c\u6062\u590d\u7684\u4f20\u8f93\u5c42\u7684\u7279\u5b9a\u4e2d\u95f4\u4ef6\u5305\u88c5\u5177\u4f53\u7684\u4f20\u8f93\u534f\u8bae\u3002\u4f8b\u5982\uff0c\u4f7f\u7528HTTP\uff1a var h http.Handler h = httptransport.NewServer(...) h = newRecoveringMiddleware(h, ...) // use h normally","title":"Panics"},{"location":"Frameworks/Go-kit/\u67b6\u6784\u4e0e\u8bbe\u8ba1/#_14","text":"\u8bbf\u95ee\u6570\u636e\u5e93\u901a\u5e38\u662f\u6838\u5fc3\u4e1a\u52a1\u903b\u8f91\u7684\u4e00\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u5305\u542b\u4e00\u4e2a * sql.DB \u6307\u9488\u5728\u670d\u52a1\u7684\u5177\u4f53\u5b9e\u73b0\u4e2d\u3002 type MyService struct { db *sql.DB value string logger log.Logger } func NewService(db *sql.DB, value string, logger log.Logger) *MyService { return MyService{ db: db, value: value, logger: logger, } } \u66f4\u597d\u7684\u662f\uff1a\u8003\u8651\u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\u6765\u5bf9\u6301\u4e45\u6027\u64cd\u4f5c\u8fdb\u884c\u5efa\u6a21\u3002 \u8be5\u63a5\u53e3\u5c06\u5904\u7406\u4e1a\u52a1\u57df\u5bf9\u8c61\uff0c\u5e76\u5177\u6709\u5305\u88c5\u6570\u636e\u5e93\u53e5\u67c4\u7684\u5b9e\u73b0\u3002 \u4f8b\u5982\uff0c\u4e3a\u7528\u6237\u914d\u7f6e\u6587\u4ef6\u8003\u8651\u4e00\u4e2a\u7b80\u5355\u7684\u6301\u4e45\u5c42\u3002 type Store interface { Insert(Profile) error Select(id string) (Profile, error) Delete(id string) error } type databaseStore struct{ db *sql.DB } func (s *databaseStore) Insert(p Profile) error { /* ... */ } func (s *databaseStore) Select(id string) (Profile, error) { /* ... */ } func (s *databaseStore) Delete(id string) error { /* ... */ } \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5728\u5177\u4f53\u7684\u5b9e\u73b0\u4e2d\u5305\u542b\u4e00\u4e2astore\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a * sql.DB \u3002","title":"\u6301\u4e45\u6027\uff1a\u5982\u4f55\u4f7f\u7528\u6570\u636e\u5e93\u548c\u6570\u636e\u5b58\u50a8"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/","text":"REST Endpoints \u539f\u6587\u94fe\u63a5\uff1ahttps://www.ru-rocker.com/2017/02/17/micro-services-using-go-kit-http-endpoint/ \u5728\u672c\u6587\u4e2d\uff0c\u5c06\u4f7f\u7528Go\u7f16\u7a0b\u8bed\u8a00\u548cgo-kit\u4f5c\u4e3a\u6807\u51c6\u5fae\u670d\u52a1\u5e93\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u5fae\u670d\u52a1\u3002\u8be5\u670d\u52a1\u5c06\u901a\u8fc7REST\u7aef\u70b9\u516c\u5f00\u3002 \u5fae\u670d\u52a1 \u5728\u5f53\u4eca\u4e16\u754c\uff0c\u5fae\u670d\u52a1\u4f53\u7cfb\u7ed3\u6784\u5df2\u5f97\u5230\u666e\u53ca\u3002 \u6211\u4e0d\u4f1a\u7279\u522b\u89e3\u91ca\u4ec0\u4e48\u662f\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u56e0\u4e3a\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u8ba8\u8bba\u4e86\u5f88\u591a\u3002 \u4f46\u662f\uff0c\u6211\u5c06\u63d0\u4f9b\u4e24\u4e2a\u6709\u5173\u5fae\u670d\u52a1\u7684\u826f\u597d\u7f51\u7ad9\u3002 \u9996\u5148\u662f\u6211\u6700\u559c\u6b22\u7684martinfowler.com\uff0c\u53ef\u4ee5\u5728 \u8fd9\u91cc \u770b\u5230\u4ed6\u7684\u60ca\u4eba\u89e3\u91ca\u3002 \u53e6\u4e00\u4e2a\u6765\u81eamicroservices.io\uff0c\u91cc\u9762\u6709\u5f88\u591a\u5173\u4e8e\u6a21\u5f0f\u548c\u793a\u4f8b\u7684\u597d\u6587\u7ae0\u3002 Go-lang Go\u662f\u4e00\u79cd\u5f00\u653e\u6e90\u4ee3\u7801\u7f16\u7a0b\u8bed\u8a00\uff0c\u53ef\u8f7b\u677e\u6784\u5efa\u7b80\u5355\uff0c\u53ef\u9760\u548c\u9ad8\u6548\u7684\u8f6f\u4ef6\u3002\u8be5\u8bed\u8a00\u7531Google\u8bbe\u8ba1\uff0c\u65e8\u5728\u89e3\u51b3Google\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u4eba\u4eec\u53ef\u4ee5\u5e0c\u671b\u8fd9\u79cd\u8bed\u8a00\u80fd\u591f\u5927\u89c4\u6a21\u8fd0\u884c\uff0c\u9002\u7528\u4e8e\u5927\u578b\u7a0b\u5e8f\u548c\u4f9d\u8d56\u9879\u3002 Go-kit Go-kit\u786e\u5b9e\u6709\u52a9\u4e8e\u7b80\u5316\u6784\u5efa\u5fae\u670d\u52a1\u67b6\u6784\u7684\u8fc7\u7a0b\u3002 \u8fd9\u662f\u56e0\u4e3a\u5b83\u5177\u6709\u8bb8\u591a\u529f\u80fd\uff0c\u4f8b\u5982\u670d\u52a1\u8fde\u63a5\u6027\uff0c\u6307\u6807\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002 \u56e0\u6b64\uff0c\u6211\u8981\u7279\u522b\u611f\u8c22Peter Bourgon\uff08@peterbourgon\uff09\u548c\u6240\u6709\u63d0\u4f9b\u6b64\u51fa\u8272\u5e93\u7684\u8d21\u732e\u8005\u3002 \u7528\u4f8b \u6211\u5728\u672c\u6587\u4e2d\u7684\u91cd\u70b9\u662f\u5c06REST\u7aef\u70b9\u516c\u5f00\u4e3a\u670d\u52a1\u3002\u670d\u52a1\u672c\u8eab\u5c06\u4f7f\u7528HTTP POST\u65b9\u6cd5\u516c\u5f00\u7aef\u70b9\u3002\u7136\u540e\u5b83\u5c06\u4ee5JSON\u683c\u5f0f\u8fd4\u56delorem ipsum\u6d88\u606f\u3002 \u7aef\u70b9URL\u683c\u5f0f\u4e3a /lorem/{type}/{min}/{max} \uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u8bf4\u660e\uff1a type\u5c06\u662florem\u7c7b\u578b\uff0c\u5373word\uff08\u5355\u8bcd\uff09\uff0csentence\uff08\u53e5\u5b50\uff09\u548cparagraph\uff08\u6bb5\u843d\uff09 min\u548cmax\u8868\u793a\u751f\u6210\u5668\u751f\u6210\u7684\u6700\u5c11\u548c\u6700\u591a\u5b57\u6bcd\u6570 \u4e00\u6b65\u6b65\u64cd\u4f5c \u5728\u9010\u6b65\u5f00\u59cb\u4e4b\u524d\uff0c\u6b64\u793a\u4f8b\u9700\u8981\u51e0\u4e2a\u5e93\u3002\u90a3\u4e9b\u662f\uff1a go-kit libraries golorem libraries:\u7528\u4e8e\u751f\u6210lorem ipsum\u6587\u672c gorilla mux libraries: \u7528\u4e8ehttp\u5904\u7406\u7a0b\u5e8f \u7b2c\u4e00\u6b65\uff1a\u521b\u5efaService go get github.com/go-kit/kit go get github.com/drhodes/golorem go get github.com/gorilla/mux \u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u6700\u9177\u7684\u5de5\u5177\uff0c\u90fd\u9700\u8981\u5728\u7b2c\u4e00\u65f6\u95f4\u521b\u5efa\u4e1a\u52a1\u903b\u8f91\u3002\u5982\u7528\u4f8b\u6240\u8ff0\uff0c\u6211\u4eec\u7684\u4e1a\u52a1\u903b\u8f91\u662f\u6839\u636e\u5355\u8bcd\uff0c\u53e5\u5b50\u6216\u6bb5\u843d\u521b\u5efalorem ipsum\u6587\u672c\u3002\u56e0\u6b64\uff0c\u8ba9\u6211\u4eec\u5728\u5de5\u4f5c\u533a\u4e0b\u521b\u5efalorem\u6587\u4ef6\u5939\u3002\u5c31\u6211\u800c\u8a00\uff0c\u6211\u7684\u6587\u4ef6\u5939\u662f $GOPATH/github.com/ru-rocker/gokit-playground/lorem \u3002\u7136\u540e\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u521b\u5efa\u6587\u4ef6 service.go \u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a // Define service interface type Service interface { Word(min, max int) string // generate a word with at least min letters and at most max letters. Sentence(min, max int) string // generate a sentence with at least min words and at most max words. Paragraph(min, max int) string // generate a paragraph with at least min sentences and at most max sentences. } // Implement service with empty struct type LoremService struct {} \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u63a5\u53e3\uff0c\u4f46\u662f\uff0c\u6ca1\u6709\u65b9\u6cd5\u5b9e\u73b0\u7684\u63a5\u53e3\u5c06\u6beb\u65e0\u610f\u4e49\u3002\u4e3aservice.go\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u5b9e\u73b0\uff1a // Implement service functions func (LoremService) Word(min, max int) string { return golorem.Word(min, max) } func (LoremService) Sentence(min, max int) string { return golorem.Sentence(min, max) } func (LoremService) Paragraph(min, max int) string { return golorem.Paragraph(min, max) } \u6ce8\u610f\uff0c\u5bf9\u6bcf\u4e2a\u65b9\u6cd5\u5b9e\u73b0\u90fd\u4f7f\u7528\u4e86golorem\u51fd\u6570\u3002 \u7b2c2\u6b65\uff1a\u5efa\u6a21Request\u548cResponse \u7531\u4e8e\u6b64\u670d\u52a1\u662fHTTP\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u4e0b\u4e00\u6b65\u662f\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u8fdb\u884c\u5efa\u6a21\u3002\u5982\u679c\u56de\u5934\u770b\u4e00\u4e0b\u7528\u4f8b\uff0c\u5c06\u53d1\u73b0\u5b9e\u73b0\u9700\u8981\u4e09\u4e2a\u5c5e\u6027\uff0c\u5206\u522b\u662f\uff1atype\u3001min\u3001max\u3002 \u5bf9\u4e8e\u54cd\u5e94\u672c\u8eab\uff0c\u53ea\u9700\u8981\u4e24\u4e2a\u5b57\u6bb5\u3002 \u8fd9\u4e9b\u5b57\u6bb5\u662f\u5305\u542blorem ipsum\u6587\u672c\u7684\u6d88\u606f \u53e6\u4e00\u4e2a\u662f\u9519\u8bef\u5b57\u6bb5\uff0c\u5f53\u51fa\u73b0\u9519\u8bef\u65f6\uff0c\u5b83\u5c06\u7ed9\u51fa\u9519\u8bef\u63cf\u8ff0 \u56e0\u6b64\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u4e3a\u5176\u547d\u540d\u4e3a endpoints.go \uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a //request type LoremRequest struct { RequestType string Min int Max int } //response type LoremResponse struct { Message string `json: message ` Err error `json: err,omitempty ` //omitempty \u8868\u793a\uff0c\u5982\u679c\u503c\u4e3anil\uff0c\u5219\u4e0d\u4f1a\u663e\u793a\u6b64\u5b57\u6bb5 } \u7b2c3\u6b65\uff1a\u521b\u5efa\u7aef\u70b9 \u7aef\u70b9\u662fgo-kit\u4e2d\u7684\u7279\u6b8a\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06\u5b83\u5305\u88c5\u5230 http.Handler \u4e2d\u3002\u4e3a\u4e86\u4f7f\u6211\u4eec\u7684service\u53d8\u6210 endpoint.Endpoint \u51fd\u6570\uff0c\u6211\u4eec\u5c06\u8981\u5236\u4f5c\u4e00\u4e2a\u51fd\u6570\u6765\u5904\u7406LoremRequest\uff0c\u5728\u51fd\u6570\u5185\u90e8\u505a\u4e00\u4e9b\u903b\u8f91\uff0c\u7136\u540e\u8fd4\u56deLoremResponse\u3002\u5bf9\u4e8eendpoints.go\uff0c\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a var ( ErrRequestTypeNotFound = errors.New( Request type only valid for word, sentence and paragraph ) ) // endpoints wrapper type Endpoints struct { LoremEndpoint endpoint.Endpoint } // creating Lorem Ipsum Endpoint func MakeLoremEndpoint(svc Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (interface{}, error) { req := request.(LoremRequest) var ( txt string min, max int ) min = req.Min max = req.Max if strings.EqualFold(req.RequestType, Word ) { txt = svc.Word(min, max) } else if strings.EqualFold(req.RequestType, Sentence ){ txt = svc.Sentence(min, max) } else if strings.EqualFold(req.RequestType, Paragraph ) { txt = svc.Paragraph(min, max) } else { return nil, ErrRequestTypeNotFound } return LoremResponse{Message: txt}, nil } } \u7b2c4\u6b65\uff1a\u4f20\u8f93 \u5728\u5904\u7406 http \u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u524d\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u4ece struct \u5230 json \u6216\u76f8\u53cd\u7684\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u3002\u4e3a\u6b64\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u547d\u540d\u4e3a transport.go \u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a // decode url path variables into request func decodeLoremRequest(_ context.Context, r *http.Request) (interface{}, error) { vars := mux.Vars(r) requestType, ok := vars[ type ] if !ok { return nil, ErrBadRouting } vmin, ok := vars[ min ] if !ok { return nil, ErrBadRouting } vmax, ok := vars[ max ] if !ok { return nil, ErrBadRouting } min, _ := strconv.Atoi(vmin) max, _ := strconv.Atoi(vmax) return LoremRequest{ RequestType: requestType, Min: min, Max: max, }, nil } // errorer\u7531\u53ef\u80fd\u5305\u542b\u9519\u8bef\u7684\u6240\u6709\u5177\u4f53\u54cd\u5e94\u7c7b\u578b\u5b9e\u73b0 // \u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u66f4\u6539HTTP\u54cd\u5e94\u4ee3\u7801\uff0c\u800c\u65e0\u9700\u89e6\u53d1\u7aef\u70b9\uff08\u4f20\u8f93\u7ea7\uff09\u9519\u8bef type errorer interface { error() error } // encodeResponse\u662f\u5bf9\u5ba2\u6237\u7aef\u7684\u6240\u6709\u54cd\u5e94\u7c7b\u578b\u8fdb\u884c\u7f16\u7801\u7684\u5e38\u7528\u65b9\u6cd5 func encodeResponse(ctx context.Context, w http.ResponseWriter, response interface{}) error { if e, ok := response.(errorer); ok e.error() != nil { // \u4e0d\u662fGo kit\u4f20\u8f93\u9519\u8bef\uff0c\u800c\u662f\u4e1a\u52a1\u903b\u8f91\u9519\u8bef // \u63d0\u4f9b\u8fd9\u4e9b\u4f5c\u4e3aHTTP\u9519\u8bef encodeError(ctx, e.error(), w) return nil } w.Header().Set( Content-Type , application/json; charset=utf-8 ) return json.NewEncoder(w).Encode(response) } // encode error func encodeError(_ context.Context, err error, w http.ResponseWriter) { if err == nil { panic( encodeError with nil error ) } w.Header().Set( Content-Type , application/json; charset=utf-8 ) w.WriteHeader(http.StatusInternalServerError) json.NewEncoder(w).Encode(map[string]interface{}{ error : err.Error(), }) } \u4e00\u65e6\u58f0\u660e\u4e86\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u521b\u5efa http \u5904\u7406\u7a0b\u5e8f\u4e86\u3002\u5728 transport.go \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a var ( // \u5982\u679c\u7f3a\u5c11\u9884\u671f\u7684\u8def\u5f84\u53d8\u91cf\uff0c\u5219\u8fd4\u56deErrBadRouting ErrBadRouting = errors.New( inconsistent mapping between route and handler (programmer error) ) ) // Make Http Handler func MakeHttpHandler(ctx context.Context, endpoint Endpoints, logger log.Logger) http.Handler { r := mux.NewRouter() options := []httptransport.ServerOption{ httptransport.ServerErrorLogger(logger), httptransport.ServerErrorEncoder(encodeError), } //POST /lorem/{type}/{min}/{max} // \u6ce8\u610f\uff1a\u8bf7\u770b\u8fd9\u884c\u3002\u8fd9\u662f\u63cf\u8ff0URL\u8def\u5f84\u548cHTTP\u8bf7\u6c42\u65b9\u6cd5\u7684\u65b9\u6cd5 r.Methods( POST ).Path( /lorem/{type}/{min}/{max} ).Handler(httptransport.NewServer( ctx, endpoint.LoremEndpoint, decodeLoremRequest, encodeResponse, options..., )) return r } \u7b2c5\u6b65\uff1amain \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5df2\u7ecf\u4e3a\u670d\u52a1\u63d0\u4f9b\u4e86\u670d\u52a1/\u4e1a\u52a1\u5c42\uff0c\u7aef\u70b9\u548c\u4f20\u8f93\u3002\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u5c31\u8be5\u521b\u5efamain\u51fd\u6570\u4e86\u3002main\u51fd\u6570\u57fa\u672c\u4e0a\u662f\u6784\u9020\u7aef\u70b9\u5e76\u4f7f\u5176\u53ef\u7528\u4e8eHTTP\u4f20\u8f93\u3002 \u56e0\u6b64\uff0c\u5728lorem\u6587\u4ef6\u5939\u4e0b\uff0c\u521b\u5efa\u53e6\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u540d\u4e3a lorem.d \uff08\u70b9d\u8868\u793a\u5b88\u62a4\u7a0b\u5e8f\uff09\u3002\u53ef\u4ee5\u968f\u610f\u547d\u540d\uff0c\u7136\u540e\u521b\u5efa\u6587\u4ef6 main.go \uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a func main() { ctx := context.Background() errChan := make(chan error) var svc lorem.Service svc = lorem.LoremService{} endpoint := lorem.Endpoints{ LoremEndpoint: lorem.MakeLoremEndpoint(svc), } // Logging domain. var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.NewContext(logger).With( ts , log.DefaultTimestampUTC) logger = log.NewContext(logger).With( caller , log.DefaultCaller) } r := lorem.MakeHttpHandler(ctx, endpoint, logger) // HTTP transport go func() { fmt.Println( Starting server at port 8080 ) handler := r errChan - http.ListenAndServe( :8080 , handler) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() fmt.Println( - errChan) } \u7b2c6\u6b65\uff1a\u8fd0\u884c\u6837\u4f8b \u73b0\u5728\u8be5\u8fd0\u884c\u793a\u4f8b\u4e86\u3002\u6253\u5f00shell\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a cd $GOPATH go run src/github.com/ru-rocker/gokit-playground/lorem/lorem.d/main.go \u4f7f\u7528curl\u6216postman\u6d4b\u8bd5\u7aef\u70b9\u3002 \u6837\u4f8b\u4ee3\u7801 \u6bcf\u5f53\u60a8\u5bf9\u672c\u6587\u611f\u5174\u8da3\u5e76\u613f\u610f\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u65f6\uff0c\u90fd\u53ef\u4ee5\u5728\u6211\u7684 github \u4e0a\u8fdb\u884c\u68c0\u67e5\u3002","title":"REST Endpoints"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#rest-endpoints","text":"\u539f\u6587\u94fe\u63a5\uff1ahttps://www.ru-rocker.com/2017/02/17/micro-services-using-go-kit-http-endpoint/ \u5728\u672c\u6587\u4e2d\uff0c\u5c06\u4f7f\u7528Go\u7f16\u7a0b\u8bed\u8a00\u548cgo-kit\u4f5c\u4e3a\u6807\u51c6\u5fae\u670d\u52a1\u5e93\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u5fae\u670d\u52a1\u3002\u8be5\u670d\u52a1\u5c06\u901a\u8fc7REST\u7aef\u70b9\u516c\u5f00\u3002","title":"REST Endpoints"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#_1","text":"\u5728\u5f53\u4eca\u4e16\u754c\uff0c\u5fae\u670d\u52a1\u4f53\u7cfb\u7ed3\u6784\u5df2\u5f97\u5230\u666e\u53ca\u3002 \u6211\u4e0d\u4f1a\u7279\u522b\u89e3\u91ca\u4ec0\u4e48\u662f\u5fae\u670d\u52a1\u67b6\u6784\uff0c\u56e0\u4e3a\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u8ba8\u8bba\u4e86\u5f88\u591a\u3002 \u4f46\u662f\uff0c\u6211\u5c06\u63d0\u4f9b\u4e24\u4e2a\u6709\u5173\u5fae\u670d\u52a1\u7684\u826f\u597d\u7f51\u7ad9\u3002 \u9996\u5148\u662f\u6211\u6700\u559c\u6b22\u7684martinfowler.com\uff0c\u53ef\u4ee5\u5728 \u8fd9\u91cc \u770b\u5230\u4ed6\u7684\u60ca\u4eba\u89e3\u91ca\u3002 \u53e6\u4e00\u4e2a\u6765\u81eamicroservices.io\uff0c\u91cc\u9762\u6709\u5f88\u591a\u5173\u4e8e\u6a21\u5f0f\u548c\u793a\u4f8b\u7684\u597d\u6587\u7ae0\u3002","title":"\u5fae\u670d\u52a1"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#go-lang","text":"Go\u662f\u4e00\u79cd\u5f00\u653e\u6e90\u4ee3\u7801\u7f16\u7a0b\u8bed\u8a00\uff0c\u53ef\u8f7b\u677e\u6784\u5efa\u7b80\u5355\uff0c\u53ef\u9760\u548c\u9ad8\u6548\u7684\u8f6f\u4ef6\u3002\u8be5\u8bed\u8a00\u7531Google\u8bbe\u8ba1\uff0c\u65e8\u5728\u89e3\u51b3Google\u7684\u95ee\u9898\u3002\u56e0\u6b64\uff0c\u4eba\u4eec\u53ef\u4ee5\u5e0c\u671b\u8fd9\u79cd\u8bed\u8a00\u80fd\u591f\u5927\u89c4\u6a21\u8fd0\u884c\uff0c\u9002\u7528\u4e8e\u5927\u578b\u7a0b\u5e8f\u548c\u4f9d\u8d56\u9879\u3002","title":"Go-lang"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#go-kit","text":"Go-kit\u786e\u5b9e\u6709\u52a9\u4e8e\u7b80\u5316\u6784\u5efa\u5fae\u670d\u52a1\u67b6\u6784\u7684\u8fc7\u7a0b\u3002 \u8fd9\u662f\u56e0\u4e3a\u5b83\u5177\u6709\u8bb8\u591a\u529f\u80fd\uff0c\u4f8b\u5982\u670d\u52a1\u8fde\u63a5\u6027\uff0c\u6307\u6807\u548c\u65e5\u5fd7\u8bb0\u5f55\u3002 \u56e0\u6b64\uff0c\u6211\u8981\u7279\u522b\u611f\u8c22Peter Bourgon\uff08@peterbourgon\uff09\u548c\u6240\u6709\u63d0\u4f9b\u6b64\u51fa\u8272\u5e93\u7684\u8d21\u732e\u8005\u3002","title":"Go-kit"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#_2","text":"\u6211\u5728\u672c\u6587\u4e2d\u7684\u91cd\u70b9\u662f\u5c06REST\u7aef\u70b9\u516c\u5f00\u4e3a\u670d\u52a1\u3002\u670d\u52a1\u672c\u8eab\u5c06\u4f7f\u7528HTTP POST\u65b9\u6cd5\u516c\u5f00\u7aef\u70b9\u3002\u7136\u540e\u5b83\u5c06\u4ee5JSON\u683c\u5f0f\u8fd4\u56delorem ipsum\u6d88\u606f\u3002 \u7aef\u70b9URL\u683c\u5f0f\u4e3a /lorem/{type}/{min}/{max} \uff0c\u5176\u4e2d\u5305\u542b\u4ee5\u4e0b\u8bf4\u660e\uff1a type\u5c06\u662florem\u7c7b\u578b\uff0c\u5373word\uff08\u5355\u8bcd\uff09\uff0csentence\uff08\u53e5\u5b50\uff09\u548cparagraph\uff08\u6bb5\u843d\uff09 min\u548cmax\u8868\u793a\u751f\u6210\u5668\u751f\u6210\u7684\u6700\u5c11\u548c\u6700\u591a\u5b57\u6bcd\u6570","title":"\u7528\u4f8b"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#_3","text":"\u5728\u9010\u6b65\u5f00\u59cb\u4e4b\u524d\uff0c\u6b64\u793a\u4f8b\u9700\u8981\u51e0\u4e2a\u5e93\u3002\u90a3\u4e9b\u662f\uff1a go-kit libraries golorem libraries:\u7528\u4e8e\u751f\u6210lorem ipsum\u6587\u672c gorilla mux libraries: \u7528\u4e8ehttp\u5904\u7406\u7a0b\u5e8f","title":"\u4e00\u6b65\u6b65\u64cd\u4f5c"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#service","text":"go get github.com/go-kit/kit go get github.com/drhodes/golorem go get github.com/gorilla/mux \u65e0\u8bba\u4f7f\u7528\u54ea\u79cd\u6700\u9177\u7684\u5de5\u5177\uff0c\u90fd\u9700\u8981\u5728\u7b2c\u4e00\u65f6\u95f4\u521b\u5efa\u4e1a\u52a1\u903b\u8f91\u3002\u5982\u7528\u4f8b\u6240\u8ff0\uff0c\u6211\u4eec\u7684\u4e1a\u52a1\u903b\u8f91\u662f\u6839\u636e\u5355\u8bcd\uff0c\u53e5\u5b50\u6216\u6bb5\u843d\u521b\u5efalorem ipsum\u6587\u672c\u3002\u56e0\u6b64\uff0c\u8ba9\u6211\u4eec\u5728\u5de5\u4f5c\u533a\u4e0b\u521b\u5efalorem\u6587\u4ef6\u5939\u3002\u5c31\u6211\u800c\u8a00\uff0c\u6211\u7684\u6587\u4ef6\u5939\u662f $GOPATH/github.com/ru-rocker/gokit-playground/lorem \u3002\u7136\u540e\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u521b\u5efa\u6587\u4ef6 service.go \u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a // Define service interface type Service interface { Word(min, max int) string // generate a word with at least min letters and at most max letters. Sentence(min, max int) string // generate a sentence with at least min words and at most max words. Paragraph(min, max int) string // generate a paragraph with at least min sentences and at most max sentences. } // Implement service with empty struct type LoremService struct {} \u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u63a5\u53e3\uff0c\u4f46\u662f\uff0c\u6ca1\u6709\u65b9\u6cd5\u5b9e\u73b0\u7684\u63a5\u53e3\u5c06\u6beb\u65e0\u610f\u4e49\u3002\u4e3aservice.go\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u5b9e\u73b0\uff1a // Implement service functions func (LoremService) Word(min, max int) string { return golorem.Word(min, max) } func (LoremService) Sentence(min, max int) string { return golorem.Sentence(min, max) } func (LoremService) Paragraph(min, max int) string { return golorem.Paragraph(min, max) } \u6ce8\u610f\uff0c\u5bf9\u6bcf\u4e2a\u65b9\u6cd5\u5b9e\u73b0\u90fd\u4f7f\u7528\u4e86golorem\u51fd\u6570\u3002","title":"\u7b2c\u4e00\u6b65\uff1a\u521b\u5efaService"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#2requestresponse","text":"\u7531\u4e8e\u6b64\u670d\u52a1\u662fHTTP\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u4e0b\u4e00\u6b65\u662f\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u8fdb\u884c\u5efa\u6a21\u3002\u5982\u679c\u56de\u5934\u770b\u4e00\u4e0b\u7528\u4f8b\uff0c\u5c06\u53d1\u73b0\u5b9e\u73b0\u9700\u8981\u4e09\u4e2a\u5c5e\u6027\uff0c\u5206\u522b\u662f\uff1atype\u3001min\u3001max\u3002 \u5bf9\u4e8e\u54cd\u5e94\u672c\u8eab\uff0c\u53ea\u9700\u8981\u4e24\u4e2a\u5b57\u6bb5\u3002 \u8fd9\u4e9b\u5b57\u6bb5\u662f\u5305\u542blorem ipsum\u6587\u672c\u7684\u6d88\u606f \u53e6\u4e00\u4e2a\u662f\u9519\u8bef\u5b57\u6bb5\uff0c\u5f53\u51fa\u73b0\u9519\u8bef\u65f6\uff0c\u5b83\u5c06\u7ed9\u51fa\u9519\u8bef\u63cf\u8ff0 \u56e0\u6b64\uff0c\u8ba9\u6211\u4eec\u521b\u5efa\u53e6\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u4e3a\u5176\u547d\u540d\u4e3a endpoints.go \uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a //request type LoremRequest struct { RequestType string Min int Max int } //response type LoremResponse struct { Message string `json: message ` Err error `json: err,omitempty ` //omitempty \u8868\u793a\uff0c\u5982\u679c\u503c\u4e3anil\uff0c\u5219\u4e0d\u4f1a\u663e\u793a\u6b64\u5b57\u6bb5 }","title":"\u7b2c2\u6b65\uff1a\u5efa\u6a21Request\u548cResponse"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#3","text":"\u7aef\u70b9\u662fgo-kit\u4e2d\u7684\u7279\u6b8a\u529f\u80fd\uff0c\u53ef\u4ee5\u5c06\u5b83\u5305\u88c5\u5230 http.Handler \u4e2d\u3002\u4e3a\u4e86\u4f7f\u6211\u4eec\u7684service\u53d8\u6210 endpoint.Endpoint \u51fd\u6570\uff0c\u6211\u4eec\u5c06\u8981\u5236\u4f5c\u4e00\u4e2a\u51fd\u6570\u6765\u5904\u7406LoremRequest\uff0c\u5728\u51fd\u6570\u5185\u90e8\u505a\u4e00\u4e9b\u903b\u8f91\uff0c\u7136\u540e\u8fd4\u56deLoremResponse\u3002\u5bf9\u4e8eendpoints.go\uff0c\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a var ( ErrRequestTypeNotFound = errors.New( Request type only valid for word, sentence and paragraph ) ) // endpoints wrapper type Endpoints struct { LoremEndpoint endpoint.Endpoint } // creating Lorem Ipsum Endpoint func MakeLoremEndpoint(svc Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (interface{}, error) { req := request.(LoremRequest) var ( txt string min, max int ) min = req.Min max = req.Max if strings.EqualFold(req.RequestType, Word ) { txt = svc.Word(min, max) } else if strings.EqualFold(req.RequestType, Sentence ){ txt = svc.Sentence(min, max) } else if strings.EqualFold(req.RequestType, Paragraph ) { txt = svc.Paragraph(min, max) } else { return nil, ErrRequestTypeNotFound } return LoremResponse{Message: txt}, nil } }","title":"\u7b2c3\u6b65\uff1a\u521b\u5efa\u7aef\u70b9"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#4","text":"\u5728\u5904\u7406 http \u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u524d\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u4ece struct \u5230 json \u6216\u76f8\u53cd\u7684\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u3002\u4e3a\u6b64\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u6587\u4ef6\uff0c\u547d\u540d\u4e3a transport.go \u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a // decode url path variables into request func decodeLoremRequest(_ context.Context, r *http.Request) (interface{}, error) { vars := mux.Vars(r) requestType, ok := vars[ type ] if !ok { return nil, ErrBadRouting } vmin, ok := vars[ min ] if !ok { return nil, ErrBadRouting } vmax, ok := vars[ max ] if !ok { return nil, ErrBadRouting } min, _ := strconv.Atoi(vmin) max, _ := strconv.Atoi(vmax) return LoremRequest{ RequestType: requestType, Min: min, Max: max, }, nil } // errorer\u7531\u53ef\u80fd\u5305\u542b\u9519\u8bef\u7684\u6240\u6709\u5177\u4f53\u54cd\u5e94\u7c7b\u578b\u5b9e\u73b0 // \u5b83\u4f7f\u6211\u4eec\u80fd\u591f\u66f4\u6539HTTP\u54cd\u5e94\u4ee3\u7801\uff0c\u800c\u65e0\u9700\u89e6\u53d1\u7aef\u70b9\uff08\u4f20\u8f93\u7ea7\uff09\u9519\u8bef type errorer interface { error() error } // encodeResponse\u662f\u5bf9\u5ba2\u6237\u7aef\u7684\u6240\u6709\u54cd\u5e94\u7c7b\u578b\u8fdb\u884c\u7f16\u7801\u7684\u5e38\u7528\u65b9\u6cd5 func encodeResponse(ctx context.Context, w http.ResponseWriter, response interface{}) error { if e, ok := response.(errorer); ok e.error() != nil { // \u4e0d\u662fGo kit\u4f20\u8f93\u9519\u8bef\uff0c\u800c\u662f\u4e1a\u52a1\u903b\u8f91\u9519\u8bef // \u63d0\u4f9b\u8fd9\u4e9b\u4f5c\u4e3aHTTP\u9519\u8bef encodeError(ctx, e.error(), w) return nil } w.Header().Set( Content-Type , application/json; charset=utf-8 ) return json.NewEncoder(w).Encode(response) } // encode error func encodeError(_ context.Context, err error, w http.ResponseWriter) { if err == nil { panic( encodeError with nil error ) } w.Header().Set( Content-Type , application/json; charset=utf-8 ) w.WriteHeader(http.StatusInternalServerError) json.NewEncoder(w).Encode(map[string]interface{}{ error : err.Error(), }) } \u4e00\u65e6\u58f0\u660e\u4e86\u7f16\u7801\u5668\u548c\u89e3\u7801\u5668\u529f\u80fd\uff0c\u5c31\u53ef\u4ee5\u521b\u5efa http \u5904\u7406\u7a0b\u5e8f\u4e86\u3002\u5728 transport.go \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a var ( // \u5982\u679c\u7f3a\u5c11\u9884\u671f\u7684\u8def\u5f84\u53d8\u91cf\uff0c\u5219\u8fd4\u56deErrBadRouting ErrBadRouting = errors.New( inconsistent mapping between route and handler (programmer error) ) ) // Make Http Handler func MakeHttpHandler(ctx context.Context, endpoint Endpoints, logger log.Logger) http.Handler { r := mux.NewRouter() options := []httptransport.ServerOption{ httptransport.ServerErrorLogger(logger), httptransport.ServerErrorEncoder(encodeError), } //POST /lorem/{type}/{min}/{max} // \u6ce8\u610f\uff1a\u8bf7\u770b\u8fd9\u884c\u3002\u8fd9\u662f\u63cf\u8ff0URL\u8def\u5f84\u548cHTTP\u8bf7\u6c42\u65b9\u6cd5\u7684\u65b9\u6cd5 r.Methods( POST ).Path( /lorem/{type}/{min}/{max} ).Handler(httptransport.NewServer( ctx, endpoint.LoremEndpoint, decodeLoremRequest, encodeResponse, options..., )) return r }","title":"\u7b2c4\u6b65\uff1a\u4f20\u8f93"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#5main","text":"\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5df2\u7ecf\u4e3a\u670d\u52a1\u63d0\u4f9b\u4e86\u670d\u52a1/\u4e1a\u52a1\u5c42\uff0c\u7aef\u70b9\u548c\u4f20\u8f93\u3002\u8bbe\u7f6e\u5b8c\u6210\u540e\uff0c\u5c31\u8be5\u521b\u5efamain\u51fd\u6570\u4e86\u3002main\u51fd\u6570\u57fa\u672c\u4e0a\u662f\u6784\u9020\u7aef\u70b9\u5e76\u4f7f\u5176\u53ef\u7528\u4e8eHTTP\u4f20\u8f93\u3002 \u56e0\u6b64\uff0c\u5728lorem\u6587\u4ef6\u5939\u4e0b\uff0c\u521b\u5efa\u53e6\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u540d\u4e3a lorem.d \uff08\u70b9d\u8868\u793a\u5b88\u62a4\u7a0b\u5e8f\uff09\u3002\u53ef\u4ee5\u968f\u610f\u547d\u540d\uff0c\u7136\u540e\u521b\u5efa\u6587\u4ef6 main.go \uff0c\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u4ee3\u7801\uff1a func main() { ctx := context.Background() errChan := make(chan error) var svc lorem.Service svc = lorem.LoremService{} endpoint := lorem.Endpoints{ LoremEndpoint: lorem.MakeLoremEndpoint(svc), } // Logging domain. var logger log.Logger { logger = log.NewLogfmtLogger(os.Stderr) logger = log.NewContext(logger).With( ts , log.DefaultTimestampUTC) logger = log.NewContext(logger).With( caller , log.DefaultCaller) } r := lorem.MakeHttpHandler(ctx, endpoint, logger) // HTTP transport go func() { fmt.Println( Starting server at port 8080 ) handler := r errChan - http.ListenAndServe( :8080 , handler) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() fmt.Println( - errChan) }","title":"\u7b2c5\u6b65\uff1amain"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#6","text":"\u73b0\u5728\u8be5\u8fd0\u884c\u793a\u4f8b\u4e86\u3002\u6253\u5f00shell\u8f93\u5165\u5982\u4e0b\u547d\u4ee4\uff1a cd $GOPATH go run src/github.com/ru-rocker/gokit-playground/lorem/lorem.d/main.go \u4f7f\u7528curl\u6216postman\u6d4b\u8bd5\u7aef\u70b9\u3002","title":"\u7b2c6\u6b65\uff1a\u8fd0\u884c\u6837\u4f8b"},{"location":"Frameworks/Go-kit/Examples/00-Endpoints(REST)/#_4","text":"\u6bcf\u5f53\u60a8\u5bf9\u672c\u6587\u611f\u5174\u8da3\u5e76\u613f\u610f\u4e86\u89e3\u66f4\u591a\u4fe1\u606f\u65f6\uff0c\u90fd\u53ef\u4ee5\u5728\u6211\u7684 github \u4e0a\u8fdb\u884c\u68c0\u67e5\u3002","title":"\u6837\u4f8b\u4ee3\u7801"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/","text":"gRPC Endpoint \u539f\u6587\u94fe\u63a5\uff1ahttps://www.ru-rocker.com/2017/02/24/micro-services-using-go-kit-grpc-endpoint/ \u672c\u6587\u5c06\u5c55\u793a\u5982\u4f55\u4f7f\u7528Golang\u7f16\u7a0b\u8bed\u8a00\u548cGo-kit\u4f5c\u4e3a\u5176\u6846\u67b6\u6765\u521b\u5efa\u5fae\u670d\u52a1\u3002\u8be5\u670d\u52a1\u5c06\u901a\u8fc7gRPC\u534f\u8bae\u516c\u5f00\u3002 \u6982\u89c8 \u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u8c08\u5230\u4e86\u4f7f\u7528go\u7f16\u7a0b\u8bed\u8a00\u521b\u5efa\u5fae\u670d\u52a1\u3002\u53e6\u5916\uff0c\u6211\u4ecb\u7ecd\u4e86go-kit\u4f5c\u4e3a\u5fae\u670d\u52a1\u6846\u67b6\u3002\u5982\u60a8\u6240\u89c1\uff0c\u4e24\u8005\u5728\u6784\u5efa\u670d\u52a1\u65b9\u9762\u90fd\u975e\u5e38\u51fa\u8272\u3002\u5c31\u50cf\u4ee5\u524d\u4e00\u6837\uff0c\u5728\u672c\u6587\u4e2d\uff0c\u5c06\u521b\u5efa\u53e6\u4e00\u4e2a\u7aef\u70b9\u4f5c\u4e3a\u670d\u52a1\uff0c\u4f46\u662f\uff0c\u5c06\u4f7f\u7528gRPC\u534f\u8bae\u4f5c\u4e3a\u901a\u4fe1\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u901a\u8fc7REST\u66b4\u9732\u670d\u52a1\u3002 gRPC \u6211\u5c06\u7b80\u8981\u4ecb\u7ecdgRPC\uff0c\u56e0\u4e3a grpc.io \u5df2\u7ecf\u5bf9\u6b64\u8fdb\u884c\u4e86\u5f88\u597d\u7684\u89e3\u91ca\u3002gRPC\u662fGoogle\u63d0\u4f9b\u7684\u6846\u67b6\uff0c\u7528\u4e8e\u652f\u6301\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u3002\u901a\u8fc7\u4f7f\u7528gRPC\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u8fd0\u884c\u5728\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0a\u7684\u670d\u52a1\u7684\u65b9\u6cd5\u3002\u6b64\u5916\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u5e8f\u5217\u5316\u7ed3\u6784\u6570\u636e\u7684\u673a\u5236\u3002\u4e0eXML\u6216JSON\u76f8\u6bd4\uff0c\u6b64\u5e8f\u5217\u5316\u66f4\u5c0f\u4e14\u7f16\u7801\u548c\u89e3\u7801\u66f4\u5feb\u3002 \u5982\u679c\u60f3\u8981\u4e86\u89e3 protocol buffers \u6027\u80fd\u4e0eJSON\u76f8\u6bd4\u6709\u591a\u51fa\u8272\uff0c\u53ef\u4ee5\u8bbf\u95ee\u6b64 \u94fe\u63a5 \u3002 \u7528\u4f8b \u7528\u4f8b\u4ecd\u7136\u4e0e\u4e0a\u4e00\u7bc7\u6587\u7ae0\u76f8\u540c\u3002\u5c06\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u6765\u751f\u6210\u201c lorem ipsum\u201d\u6587\u672c\u3002\u4f46\u662f\u8fd9\u6b21\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4e0d\u4f1a\u5728\u4e00\u9879\u670d\u52a1\u4e2d\u521b\u5efa\u4e09\u4e2a\u529f\u80fd\uff08\u5355\u8bcd\uff0c\u53e5\u5b50\u548c\u6bb5\u843d\uff09\uff0c\u800c\u662f\u521b\u5efa\u4e00\u4e2a\u79f0\u4e3aLorem\u7684\u529f\u80fd\u3002\u7136\u540e\u4ece\u8be5\u51fd\u6570\u4e2d\uff0c\u65e0\u8bba\u662f\u751f\u6210\u5355\u8bcd\uff0c\u53e5\u5b50\u8fd8\u662f\u6bb5\u843d\uff0c\u90fd\u5c06\u5206\u6d3e\u8bf7\u6c42\u7c7b\u578b\u3002 \u4e00\u6b65\u6b65\u64cd\u4f5c \u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u4ece \u4e0a\u4e00\u7bc7\u6587\u7ae0 \u4e2d\u83b7\u5f97\u4e86\u6240\u9700\u7684\u5e93\u3002\u4f46\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5176\u4ed6\u5e93\u548c protocol buffers \u3002 \u4ece \u8fd9\u91cc \u4e0b\u8f7d protocol buffers \u7684\u7f16\u8bd1\u5668\uff0c\u63d0\u53d6bin\u6587\u4ef6\u5939\u5e76\u5c06\u5176\u5bfc\u51fa\u5230 $PATH \u4e2d\u3002 ```bash PROTOC export PROTOC_HOME=~/opt/protoc-3.2.0-osx-x86_64 export PATH=${PATH}:$PROTOC_HOME/bin/ ``` \u5728\u547d\u4ee4\u884c\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a bash go get -u github.com/golang/protobuf/{proto,protoc-gen-go} \u5c06GOBIN\u4e5f\u8981\u6dfb\u52a0\u5230PATH\u4e2d\uff1a ```bash GOPATH export GOPATH=~/workspace-golang/ export GOBIN=$GOPATH/bin/ export PATH=${PATH}:$GOBIN ``` \u7136\u540e\u521b\u5efa\u65b0\u6587\u4ef6\u5939\uff0c\u4e3a\u5176\u547d\u540d\uff1a lorem-grpc \u3002\u5c31\u6211\u800c\u8a00\uff0c\u6211\u662f\u5728 $GOPATH/github.com/ru-rocker/gokit-playground/lorem-grpc \u4e0b\u5b8c\u6210\u7684\u3002\u6211\u5c06\u5176\u79f0\u4e3aWORKDIR\u3002 \u7b2c1\u6b65\uff1aProto \u4f7f\u7528 protocol buffers \u7b2c\u4e09\u7248\u7684\u8bed\u8a00\uff08\u5373 proto3 \uff09\u6765\u5b9a\u4e49\u6570\u636e\u7ed3\u6784\uff0c\u9996\u5148\u5728WORKDIR\u4e2d\u521b\u5efa\u540d\u53ebpb\u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e\u5728\u5176\u4e2d\u521b\u5efa\u4e00\u4e2aproto\u6587\u4ef6\u3002\u5728\u8fd9\u4e2aproto\u6587\u4ef6\u4e2d\u6307\u5b9a\u9700\u8981\u4f7f\u7528\u7684\u8bed\u6cd5\u662f proto3 \uff0c\u6b64\u5916\uff0c\u8fd8\u5c06\u5b9a\u4e49\u670d\u52a1\u548c\u8bf7\u6c42\u54cd\u5e94\u5bf9\u3002 \u5728\u672c\u6587\u4e2d\uff0c\u670d\u52a1\u540d\u79f0\u662fLorem\uff0c\u4ee5LoremRequest\u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\uff0c\u5e76\u8fd4\u56deLoremResponse\u3002 syntax = proto3 ; package pb; service Lorem { rpc Lorem(LoremRequest) returns (LoremResponse) {} } message LoremRequest { string requestType = 1; int32 min = 2; int32 max = 3; } message LoremResponse { string message = 1; string err = 2; } \u6d88\u606f\u5185\u7684\u5b57\u6bb5\u5177\u6709\u4ee5\u4e0b\u683c\u5f0f\uff1a type name = index type\uff1a\u63cf\u8ff0\u6570\u636e\u7c7b\u578b\u5c5e\u6027\uff0c\u5b83\u53ef\u4ee5\u662fstring\uff0cbool\uff0cdouble\uff0cfloat\uff0cint32\uff0cint64\u7b49\u3002 index\uff1a\u662f\u6570\u636e\u6d41\u7684\u6574\u6570\u503c\uff0c\u7528\u4e8e\u6307\u793a\u5b57\u6bb5\u4f4d\u7f6e \u57fa\u4e8eproto\u6587\u4ef6\u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668\u548c\u7528\u4e8e protobuf \u7684Go\u63d2\u4ef6\u751f\u6210Go\u6587\u4ef6\u3002\u5728pb\u6587\u4ef6\u5939\u4e0b\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a protoc lorem.proto --go_out=plugins=grpc:. \u8fd9\u5c06\u4f1a\u521b\u5efa\u540d\u4e3a lorem.pb.go \u7684\u6587\u4ef6\u3002 \u7b2c2\u6b65\uff1a\u5b9a\u4e49\u670d\u52a1 \u5728WORKDIR\u4e0b\u521b\u5efa\u6587\u4ef6service.go\uff0c\u7136\u540e\u5728\u5176\u4e2d\u521b\u5efaLorem\u51fd\u6570\u3002 package lorem_grpc import ( gl github.com/drhodes/golorem strings errors context ) var ( ErrRequestTypeNotFound = errors.New( Request type only valid for word, sentence and paragraph ) ) // Define service interface type Service interface { // generate a word with at least min letters and at most max letters. Lorem(ctx context.Context, requestType string, min, max int) (string, error) } // Implement service with empty struct type LoremService struct {} // Implement service functions func (LoremService) Lorem(_ context.Context, requestType string, min, max int) (string, error) { var result string var err error if strings.EqualFold(requestType, Word ) { result = gl.Word(min, max) } else if strings.EqualFold(requestType, Sentence ) { result = gl.Sentence(min, max) } else if strings.EqualFold(requestType, Paragraph ) { result = gl.Paragraph(min, max) } else { err = ErrRequestTypeNotFound } return result, err } \u7b2c3\u6b65\uff1a\u521b\u5efa\u7aef\u70b9 \u9700\u8981\u6ce8\u610f\u7684\u4e00\u4ef6\u4e8b\u662f\uff0c\u4f7f\u7528Endpoints\u7ed3\u6784\u5b9e\u73b0Service\u63a5\u53e3\uff0c\u56e0\u4e3a\uff0c\u521b\u5efagRPC\u5ba2\u6237\u7aef\u8fde\u63a5\u65f6\u9700\u8981\u6b64\u673a\u5236\u3002 package lorem_grpc import ( github.com/go-kit/kit/endpoint context errors ) //request type LoremRequest struct { RequestType string Min int32 Max int32 } //response type LoremResponse struct { Message string `json: message ` Err string `json: err,omitempty ` } // endpoints wrapper type Endpoints struct { LoremEndpoint endpoint.Endpoint } // creating Lorem Ipsum Endpoint func MakeLoremEndpoint(svc Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (interface{}, error) { req := request.(LoremRequest) var ( min, max int ) min = int(req.Min) max = int(req.Max) txt, err := svc.Lorem(ctx, req.RequestType, min, max) if err != nil { return nil, err } return LoremResponse{Message: txt}, nil } } // Wrapping Endpoints as a Service implementation. // Will be used in gRPC client func (e Endpoints) Lorem(ctx context.Context, requestType string, min, max int) (string, error) { req := LoremRequest{ RequestType: requestType, Min: int32(min), Max: int32(max), } resp, err := e.LoremEndpoint(ctx, req) if err != nil { return , err } loremResp := resp.(LoremResponse) if loremResp.Err != { return , errors.New(loremResp.Err) } return loremResp.Message, nil } \u7b2c4\u6b65\uff1a\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u5efa\u6a21 \u9700\u8981\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u8fdb\u884c\u7f16\u7801/\u89e3\u7801\uff0c\u4e3a\u6b64\uff0c\u521b\u5efamodel.go\u5e76\u5b9a\u4e49\u7f16\u7801/\u89e3\u7801\u529f\u80fd\u3002 package lorem_grpc import ( context github.com/ru-rocker/gokit-playground/lorem-grpc/pb ) //Encode and Decode Lorem Request func EncodeGRPCLoremRequest(_ context.Context, r interface{}) (interface{}, error) { req := r.(LoremRequest) return pb.LoremRequest{ RequestType: req.RequestType, Max: req.Max, Min: req.Min, } , nil } func DecodeGRPCLoremRequest(ctx context.Context, r interface{}) (interface{}, error) { req := r.(*pb.LoremRequest) return LoremRequest{ RequestType: req.RequestType, Max: req.Max, Min: req.Min, }, nil } // Encode and Decode Lorem Response func EncodeGRPCLoremResponse(_ context.Context, r interface{}) (interface{}, error) { resp := r.(LoremResponse) return pb.LoremResponse{ Message: resp.Message, Err: resp.Err, }, nil } func DecodeGRPCLoremResponse(_ context.Context, r interface{}) (interface{}, error) { resp := r.(*pb.LoremResponse) return LoremResponse{ Message: resp.Message, Err: resp.Err, }, nil } \u7b2c5\u6b65\uff1a\u4f20\u8f93 \u5728\u6b64\u6b65\u9aa4\u4e2d\uff0c\u9700\u8981\u4e3agrpcServer\u7c7b\u578b\u5b9e\u73b0LoremServer\u63a5\u53e3\u3002\u7136\u540e\u521b\u5efa\u51fd\u6570\u4ee5\u8fd4\u56degrpcServer\u3002 package lorem_grpc import ( golang.org/x/net/context grpctransport github.com/go-kit/kit/transport/grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb ) type grpcServer struct { lorem grpctransport.Handler } // implement LoremServer Interface in lorem.pb.go func (s *grpcServer) Lorem(ctx context.Context, r *pb.LoremRequest) (*pb.LoremResponse, error) { _, resp, err := s.lorem.ServeGRPC(ctx, r) if err != nil { return nil, err } return resp.(*pb.LoremResponse), nil } // create new grpc server func NewGRPCServer(ctx context.Context, endpoint Endpoints) pb.LoremServer { return grpcServer{ lorem: grpctransport.NewServer( ctx, endpoint.LoremEndpoint, DecodeGRPCLoremRequest, EncodeGRPCLoremResponse, ), } } \u7b2c6\u6b65\uff1aServer \u5728Go lang\u4e2d\u521b\u5efagRPC\u670d\u52a1\u5668\u51e0\u4e4e\u4e0e\u521b\u5efaHTTP\u670d\u52a1\u5668\u4e00\u6837\u5bb9\u6613\u3002\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662ftcp\u534f\u8bae\u800c\u4e0d\u662fhttp\u3002\u5728WORKDIR\u4e0b\uff0c\u521b\u5efa\u6587\u4ef6\u5939server\u5e76\u521b\u5efa\u6587\u4ef6server_grpc_main.go\u3002 package main import ( net flag github.com/ru-rocker/gokit-playground/lorem-grpc context golang.org/x/net/context google.golang.org/grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb os os/signal syscall fmt ) func main() { var gRPCAddr = flag.String( grpc , :8081 , gRPC listen address ) flag.Parse() ctx := context.Background() // init lorem service var svc lorem_grpc.Service svc = lorem_grpc.LoremService{} errChan := make(chan error) // creating Endpoints struct endpoints := lorem_grpc.Endpoints{ LoremEndpoint: lorem_grpc.MakeLoremEndpoint(svc), } //execute grpc server go func() { listener, err := net.Listen( tcp , *gRPCAddr) if err != nil { errChan - err return } handler := lorem_grpc.NewGRPCServer(ctx, endpoints) gRPCServer := grpc.NewServer() pb.RegisterLoremServer(gRPCServer, handler) errChan - gRPCServer.Serve(listener) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() fmt.Println( - errChan) } \u7b2c7\u6b65\uff1aClient \u73b0\u5728\u8be5\u5230\u5ba2\u6237\u7aef\u4e86\uff0c\u9700\u8981\u521b\u5efa\u8fd4\u56deService\u7684NewClient\u51fd\u6570\uff0c\u56e0\u4e3aNewClient\u51fd\u6570\u5c06\u8f6c\u6362\u4e3aEndpoint\u3002 package client import ( github.com/ru-rocker/gokit-playground/lorem-grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb grpctransport github.com/go-kit/kit/transport/grpc google.golang.org/grpc ) // Return new lorem_grpc service func New(conn *grpc.ClientConn) lorem_grpc.Service { var loremEndpoint = grpctransport.NewClient( conn, Lorem , Lorem , lorem_grpc.EncodeGRPCLoremRequest, lorem_grpc.DecodeGRPCLoremResponse, pb.LoremResponse{}, ).Endpoint() return lorem_grpc.Endpoints{ LoremEndpoint: loremEndpoint, } } \u8bf7\u6ce8\u610f\uff0c\u6211\u4e3a\u6b64\u529f\u80fd\u8fd4\u56de\u4e86Endpoint\uff08\u8bf7\u53c2\u9605\u6709\u5173\u5b9e\u73b0Service\u63a5\u53e3\u7684\u6b65\u9aa43\uff09\u3002\u7136\u540e\u5728cmd\u76ee\u5f55\u4e0b\u521b\u5efa\u53ef\u6267\u884c\u5ba2\u6237\u7aef\u3002 package main import ( flag time log grpcClient github.com/ru-rocker/gokit-playground/lorem-grpc/client google.golang.org/grpc golang.org/x/net/context github.com/ru-rocker/gokit-playground/lorem-grpc fmt strconv ) func main() { var ( grpcAddr = flag.String( addr , :8081 , gRPC address ) ) flag.Parse() ctx := context.Background() conn, err := grpc.Dial(*grpcAddr, grpc.WithInsecure(), grpc.WithTimeout(1*time.Second)) if err != nil { log.Fatalln( gRPC dial: , err) } defer conn.Close() loremService := grpcClient.New(conn) args := flag.Args() var cmd string cmd, args = pop(args) switch cmd { case lorem : var requestType, minStr, maxStr string requestType, args = pop(args) minStr, args = pop(args) maxStr, args = pop(args) min, _ := strconv.Atoi(minStr) max, _ := strconv.Atoi(maxStr) lorem(ctx, loremService, requestType, min, max) default: log.Fatalln( unknown command , cmd) } } // parse command line argument one by one func pop(s []string) (string, []string) { if len(s) == 0 { return , s } return s[0], s[1:] } // call lorem service func lorem(ctx context.Context, service lorem_grpc.Service, requestType string, min int, max int) { mesg, err := service.Lorem(ctx, requestType, min, max) if err != nil { log.Fatalln(err.Error()) } fmt.Println(mesg) } \u8fd0\u884c \u4e3a\u4e86\u6d4b\u8bd5\u5b83\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u8fd0\u884cgRPC\u670d\u52a1\u5668\u3002 cd $GOPATH #Running grpc server go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/server/src/github.com/ru-rocker/gokit-playground/lorem-grpc/server/server_grpc_main.go \u63a5\u4e0b\u6765\uff0c\u6267\u884c\u5ba2\u6237\u7aef\uff1a cd $GOPATH #Running client go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/main.go lorem sentence 10 20 \u8f93\u5165\u5982\u4e0b\uff1a # sentence go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem sentence 10 20 Concurrunt nota re dicam fias, sim aut pecco, die appetitum. # word go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem word 10 20 difficultates # paragraph go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem paragraph 10 20 En igitur aequo tibi ita recedimus an aut eum tenacius quae mortalitatis eram aut rapit montium inaequaliter dulcedo aditum. Rerum tempus mala anima volebant dura quae o modis, fama vanescit fit. Nuntii comprehendet ponamus redducet cura sero prout, nonne respondi ipsa angelos comes, da ea saepe didici. Crebro te via hos adsit. Psalmi agam me mea pro da. Audi pati sim da ita praeire nescio faciant. Deserens da contexo e suaveolentiam qualibus subtrahatur excogitanda pusillus grex, e o recorder cor re libidine. Ore siderum ago mei, cura hi deo. Dicens ore curiosarum, filiorum eruuntur munerum displicens ita me repente formaeque agam nosti. Deo fama propterea ab persentiscere nam acceptam sed e a corruptione. Rogo ea nascendo qui, fuit ceterarumque. Drachmam ore operatores exemplo vivunt. Recolo hi fac cor secreta fama, domi, rogo somnis. Sapores fidei maneas saepe corporis re oris quantulum doleam te potu ita lux da facie aut. Benedicendo e tertium nosse agam ne amo, mole invenio dicturus me cognoscere ita aer se memor consulerem ab te rei. Miles ita amaritudo rogo hi flendae quietem invoco quae odor desuper tu. Temptatione dicturus ita mediator ita mundum lux partes miseros percepta seu dicant avaritiam nares contra deseri securus. Ea sobrios tale, rogo sanctis. Ita ne manu uspiam hierusalem, transeam dicite subduntur responsa cor socialiter fit deseri album praeditum. \u603b\u7ed3 \u521b\u5efagRPC\u7aef\u70b9\u975e\u5e38\u7b80\u5355\uff0c\u4e0eREST\u7aef\u70b9\u53ea\u6709\u4e00\u70b9\u70b9\u4e0d\u540c\u3002\u4f46\u662f\uff0cgRPC\u6bd4REST\u8fd0\u884c\u5f97\u66f4\u5feb\u3002\u6211\u7684\u611f\u89c9\u662f\u5c06\u6765gRPC\u5c06\u53d6\u4ee3JSON\u3002 \u540c\u65f6\uff0c\u5982\u679c\u60a8\u5bf9\u6b64\u793a\u4f8b\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u5728\u6211\u7684 github \u4e0a\u68c0\u67e5\u6e90\u4ee3\u7801\u3002","title":"gRPC Endpoint"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#grpc-endpoint","text":"\u539f\u6587\u94fe\u63a5\uff1ahttps://www.ru-rocker.com/2017/02/24/micro-services-using-go-kit-grpc-endpoint/ \u672c\u6587\u5c06\u5c55\u793a\u5982\u4f55\u4f7f\u7528Golang\u7f16\u7a0b\u8bed\u8a00\u548cGo-kit\u4f5c\u4e3a\u5176\u6846\u67b6\u6765\u521b\u5efa\u5fae\u670d\u52a1\u3002\u8be5\u670d\u52a1\u5c06\u901a\u8fc7gRPC\u534f\u8bae\u516c\u5f00\u3002","title":"gRPC Endpoint"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#_1","text":"\u5728\u4e0a\u4e00\u7bc7\u6587\u7ae0\u4e2d\uff0c\u6211\u8c08\u5230\u4e86\u4f7f\u7528go\u7f16\u7a0b\u8bed\u8a00\u521b\u5efa\u5fae\u670d\u52a1\u3002\u53e6\u5916\uff0c\u6211\u4ecb\u7ecd\u4e86go-kit\u4f5c\u4e3a\u5fae\u670d\u52a1\u6846\u67b6\u3002\u5982\u60a8\u6240\u89c1\uff0c\u4e24\u8005\u5728\u6784\u5efa\u670d\u52a1\u65b9\u9762\u90fd\u975e\u5e38\u51fa\u8272\u3002\u5c31\u50cf\u4ee5\u524d\u4e00\u6837\uff0c\u5728\u672c\u6587\u4e2d\uff0c\u5c06\u521b\u5efa\u53e6\u4e00\u4e2a\u7aef\u70b9\u4f5c\u4e3a\u670d\u52a1\uff0c\u4f46\u662f\uff0c\u5c06\u4f7f\u7528gRPC\u534f\u8bae\u4f5c\u4e3a\u901a\u4fe1\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u901a\u8fc7REST\u66b4\u9732\u670d\u52a1\u3002","title":"\u6982\u89c8"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#grpc","text":"\u6211\u5c06\u7b80\u8981\u4ecb\u7ecdgRPC\uff0c\u56e0\u4e3a grpc.io \u5df2\u7ecf\u5bf9\u6b64\u8fdb\u884c\u4e86\u5f88\u597d\u7684\u89e3\u91ca\u3002gRPC\u662fGoogle\u63d0\u4f9b\u7684\u6846\u67b6\uff0c\u7528\u4e8e\u652f\u6301\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u3002\u901a\u8fc7\u4f7f\u7528gRPC\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u8fd0\u884c\u5728\u5176\u4ed6\u8ba1\u7b97\u673a\u4e0a\u7684\u670d\u52a1\u7684\u65b9\u6cd5\u3002\u6b64\u5916\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u5e8f\u5217\u5316\u7ed3\u6784\u6570\u636e\u7684\u673a\u5236\u3002\u4e0eXML\u6216JSON\u76f8\u6bd4\uff0c\u6b64\u5e8f\u5217\u5316\u66f4\u5c0f\u4e14\u7f16\u7801\u548c\u89e3\u7801\u66f4\u5feb\u3002 \u5982\u679c\u60f3\u8981\u4e86\u89e3 protocol buffers \u6027\u80fd\u4e0eJSON\u76f8\u6bd4\u6709\u591a\u51fa\u8272\uff0c\u53ef\u4ee5\u8bbf\u95ee\u6b64 \u94fe\u63a5 \u3002","title":"gRPC"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#_2","text":"\u7528\u4f8b\u4ecd\u7136\u4e0e\u4e0a\u4e00\u7bc7\u6587\u7ae0\u76f8\u540c\u3002\u5c06\u521b\u5efa\u4e00\u4e2a\u670d\u52a1\u6765\u751f\u6210\u201c lorem ipsum\u201d\u6587\u672c\u3002\u4f46\u662f\u8fd9\u6b21\u4f1a\u6709\u6240\u4e0d\u540c\uff0c\u4e0d\u4f1a\u5728\u4e00\u9879\u670d\u52a1\u4e2d\u521b\u5efa\u4e09\u4e2a\u529f\u80fd\uff08\u5355\u8bcd\uff0c\u53e5\u5b50\u548c\u6bb5\u843d\uff09\uff0c\u800c\u662f\u521b\u5efa\u4e00\u4e2a\u79f0\u4e3aLorem\u7684\u529f\u80fd\u3002\u7136\u540e\u4ece\u8be5\u51fd\u6570\u4e2d\uff0c\u65e0\u8bba\u662f\u751f\u6210\u5355\u8bcd\uff0c\u53e5\u5b50\u8fd8\u662f\u6bb5\u843d\uff0c\u90fd\u5c06\u5206\u6d3e\u8bf7\u6c42\u7c7b\u578b\u3002","title":"\u7528\u4f8b"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#_3","text":"\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u4ece \u4e0a\u4e00\u7bc7\u6587\u7ae0 \u4e2d\u83b7\u5f97\u4e86\u6240\u9700\u7684\u5e93\u3002\u4f46\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u9700\u8981\u5b89\u88c5\u5176\u4ed6\u5e93\u548c protocol buffers \u3002 \u4ece \u8fd9\u91cc \u4e0b\u8f7d protocol buffers \u7684\u7f16\u8bd1\u5668\uff0c\u63d0\u53d6bin\u6587\u4ef6\u5939\u5e76\u5c06\u5176\u5bfc\u51fa\u5230 $PATH \u4e2d\u3002 ```bash","title":"\u4e00\u6b65\u6b65\u64cd\u4f5c"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#protoc","text":"export PROTOC_HOME=~/opt/protoc-3.2.0-osx-x86_64 export PATH=${PATH}:$PROTOC_HOME/bin/ ``` \u5728\u547d\u4ee4\u884c\u6267\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a bash go get -u github.com/golang/protobuf/{proto,protoc-gen-go} \u5c06GOBIN\u4e5f\u8981\u6dfb\u52a0\u5230PATH\u4e2d\uff1a ```bash","title":"PROTOC"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#gopath","text":"export GOPATH=~/workspace-golang/ export GOBIN=$GOPATH/bin/ export PATH=${PATH}:$GOBIN ``` \u7136\u540e\u521b\u5efa\u65b0\u6587\u4ef6\u5939\uff0c\u4e3a\u5176\u547d\u540d\uff1a lorem-grpc \u3002\u5c31\u6211\u800c\u8a00\uff0c\u6211\u662f\u5728 $GOPATH/github.com/ru-rocker/gokit-playground/lorem-grpc \u4e0b\u5b8c\u6210\u7684\u3002\u6211\u5c06\u5176\u79f0\u4e3aWORKDIR\u3002","title":"GOPATH"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#1proto","text":"\u4f7f\u7528 protocol buffers \u7b2c\u4e09\u7248\u7684\u8bed\u8a00\uff08\u5373 proto3 \uff09\u6765\u5b9a\u4e49\u6570\u636e\u7ed3\u6784\uff0c\u9996\u5148\u5728WORKDIR\u4e2d\u521b\u5efa\u540d\u53ebpb\u7684\u6587\u4ef6\u5939\uff0c\u7136\u540e\u5728\u5176\u4e2d\u521b\u5efa\u4e00\u4e2aproto\u6587\u4ef6\u3002\u5728\u8fd9\u4e2aproto\u6587\u4ef6\u4e2d\u6307\u5b9a\u9700\u8981\u4f7f\u7528\u7684\u8bed\u6cd5\u662f proto3 \uff0c\u6b64\u5916\uff0c\u8fd8\u5c06\u5b9a\u4e49\u670d\u52a1\u548c\u8bf7\u6c42\u54cd\u5e94\u5bf9\u3002 \u5728\u672c\u6587\u4e2d\uff0c\u670d\u52a1\u540d\u79f0\u662fLorem\uff0c\u4ee5LoremRequest\u4f5c\u4e3a\u8f93\u5165\u53c2\u6570\uff0c\u5e76\u8fd4\u56deLoremResponse\u3002 syntax = proto3 ; package pb; service Lorem { rpc Lorem(LoremRequest) returns (LoremResponse) {} } message LoremRequest { string requestType = 1; int32 min = 2; int32 max = 3; } message LoremResponse { string message = 1; string err = 2; } \u6d88\u606f\u5185\u7684\u5b57\u6bb5\u5177\u6709\u4ee5\u4e0b\u683c\u5f0f\uff1a type name = index type\uff1a\u63cf\u8ff0\u6570\u636e\u7c7b\u578b\u5c5e\u6027\uff0c\u5b83\u53ef\u4ee5\u662fstring\uff0cbool\uff0cdouble\uff0cfloat\uff0cint32\uff0cint64\u7b49\u3002 index\uff1a\u662f\u6570\u636e\u6d41\u7684\u6574\u6570\u503c\uff0c\u7528\u4e8e\u6307\u793a\u5b57\u6bb5\u4f4d\u7f6e \u57fa\u4e8eproto\u6587\u4ef6\u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668\u548c\u7528\u4e8e protobuf \u7684Go\u63d2\u4ef6\u751f\u6210Go\u6587\u4ef6\u3002\u5728pb\u6587\u4ef6\u5939\u4e0b\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a protoc lorem.proto --go_out=plugins=grpc:. \u8fd9\u5c06\u4f1a\u521b\u5efa\u540d\u4e3a lorem.pb.go \u7684\u6587\u4ef6\u3002","title":"\u7b2c1\u6b65\uff1aProto"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#2","text":"\u5728WORKDIR\u4e0b\u521b\u5efa\u6587\u4ef6service.go\uff0c\u7136\u540e\u5728\u5176\u4e2d\u521b\u5efaLorem\u51fd\u6570\u3002 package lorem_grpc import ( gl github.com/drhodes/golorem strings errors context ) var ( ErrRequestTypeNotFound = errors.New( Request type only valid for word, sentence and paragraph ) ) // Define service interface type Service interface { // generate a word with at least min letters and at most max letters. Lorem(ctx context.Context, requestType string, min, max int) (string, error) } // Implement service with empty struct type LoremService struct {} // Implement service functions func (LoremService) Lorem(_ context.Context, requestType string, min, max int) (string, error) { var result string var err error if strings.EqualFold(requestType, Word ) { result = gl.Word(min, max) } else if strings.EqualFold(requestType, Sentence ) { result = gl.Sentence(min, max) } else if strings.EqualFold(requestType, Paragraph ) { result = gl.Paragraph(min, max) } else { err = ErrRequestTypeNotFound } return result, err }","title":"\u7b2c2\u6b65\uff1a\u5b9a\u4e49\u670d\u52a1"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#3","text":"\u9700\u8981\u6ce8\u610f\u7684\u4e00\u4ef6\u4e8b\u662f\uff0c\u4f7f\u7528Endpoints\u7ed3\u6784\u5b9e\u73b0Service\u63a5\u53e3\uff0c\u56e0\u4e3a\uff0c\u521b\u5efagRPC\u5ba2\u6237\u7aef\u8fde\u63a5\u65f6\u9700\u8981\u6b64\u673a\u5236\u3002 package lorem_grpc import ( github.com/go-kit/kit/endpoint context errors ) //request type LoremRequest struct { RequestType string Min int32 Max int32 } //response type LoremResponse struct { Message string `json: message ` Err string `json: err,omitempty ` } // endpoints wrapper type Endpoints struct { LoremEndpoint endpoint.Endpoint } // creating Lorem Ipsum Endpoint func MakeLoremEndpoint(svc Service) endpoint.Endpoint { return func(ctx context.Context, request interface{}) (interface{}, error) { req := request.(LoremRequest) var ( min, max int ) min = int(req.Min) max = int(req.Max) txt, err := svc.Lorem(ctx, req.RequestType, min, max) if err != nil { return nil, err } return LoremResponse{Message: txt}, nil } } // Wrapping Endpoints as a Service implementation. // Will be used in gRPC client func (e Endpoints) Lorem(ctx context.Context, requestType string, min, max int) (string, error) { req := LoremRequest{ RequestType: requestType, Min: int32(min), Max: int32(max), } resp, err := e.LoremEndpoint(ctx, req) if err != nil { return , err } loremResp := resp.(LoremResponse) if loremResp.Err != { return , errors.New(loremResp.Err) } return loremResp.Message, nil }","title":"\u7b2c3\u6b65\uff1a\u521b\u5efa\u7aef\u70b9"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#4","text":"\u9700\u8981\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u8fdb\u884c\u7f16\u7801/\u89e3\u7801\uff0c\u4e3a\u6b64\uff0c\u521b\u5efamodel.go\u5e76\u5b9a\u4e49\u7f16\u7801/\u89e3\u7801\u529f\u80fd\u3002 package lorem_grpc import ( context github.com/ru-rocker/gokit-playground/lorem-grpc/pb ) //Encode and Decode Lorem Request func EncodeGRPCLoremRequest(_ context.Context, r interface{}) (interface{}, error) { req := r.(LoremRequest) return pb.LoremRequest{ RequestType: req.RequestType, Max: req.Max, Min: req.Min, } , nil } func DecodeGRPCLoremRequest(ctx context.Context, r interface{}) (interface{}, error) { req := r.(*pb.LoremRequest) return LoremRequest{ RequestType: req.RequestType, Max: req.Max, Min: req.Min, }, nil } // Encode and Decode Lorem Response func EncodeGRPCLoremResponse(_ context.Context, r interface{}) (interface{}, error) { resp := r.(LoremResponse) return pb.LoremResponse{ Message: resp.Message, Err: resp.Err, }, nil } func DecodeGRPCLoremResponse(_ context.Context, r interface{}) (interface{}, error) { resp := r.(*pb.LoremResponse) return LoremResponse{ Message: resp.Message, Err: resp.Err, }, nil }","title":"\u7b2c4\u6b65\uff1a\u5bf9\u8bf7\u6c42\u548c\u54cd\u5e94\u5efa\u6a21"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#5","text":"\u5728\u6b64\u6b65\u9aa4\u4e2d\uff0c\u9700\u8981\u4e3agrpcServer\u7c7b\u578b\u5b9e\u73b0LoremServer\u63a5\u53e3\u3002\u7136\u540e\u521b\u5efa\u51fd\u6570\u4ee5\u8fd4\u56degrpcServer\u3002 package lorem_grpc import ( golang.org/x/net/context grpctransport github.com/go-kit/kit/transport/grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb ) type grpcServer struct { lorem grpctransport.Handler } // implement LoremServer Interface in lorem.pb.go func (s *grpcServer) Lorem(ctx context.Context, r *pb.LoremRequest) (*pb.LoremResponse, error) { _, resp, err := s.lorem.ServeGRPC(ctx, r) if err != nil { return nil, err } return resp.(*pb.LoremResponse), nil } // create new grpc server func NewGRPCServer(ctx context.Context, endpoint Endpoints) pb.LoremServer { return grpcServer{ lorem: grpctransport.NewServer( ctx, endpoint.LoremEndpoint, DecodeGRPCLoremRequest, EncodeGRPCLoremResponse, ), } }","title":"\u7b2c5\u6b65\uff1a\u4f20\u8f93"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#6server","text":"\u5728Go lang\u4e2d\u521b\u5efagRPC\u670d\u52a1\u5668\u51e0\u4e4e\u4e0e\u521b\u5efaHTTP\u670d\u52a1\u5668\u4e00\u6837\u5bb9\u6613\u3002\u4e0d\u540c\u7684\u662f\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u662ftcp\u534f\u8bae\u800c\u4e0d\u662fhttp\u3002\u5728WORKDIR\u4e0b\uff0c\u521b\u5efa\u6587\u4ef6\u5939server\u5e76\u521b\u5efa\u6587\u4ef6server_grpc_main.go\u3002 package main import ( net flag github.com/ru-rocker/gokit-playground/lorem-grpc context golang.org/x/net/context google.golang.org/grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb os os/signal syscall fmt ) func main() { var gRPCAddr = flag.String( grpc , :8081 , gRPC listen address ) flag.Parse() ctx := context.Background() // init lorem service var svc lorem_grpc.Service svc = lorem_grpc.LoremService{} errChan := make(chan error) // creating Endpoints struct endpoints := lorem_grpc.Endpoints{ LoremEndpoint: lorem_grpc.MakeLoremEndpoint(svc), } //execute grpc server go func() { listener, err := net.Listen( tcp , *gRPCAddr) if err != nil { errChan - err return } handler := lorem_grpc.NewGRPCServer(ctx, endpoints) gRPCServer := grpc.NewServer() pb.RegisterLoremServer(gRPCServer, handler) errChan - gRPCServer.Serve(listener) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() go func() { c := make(chan os.Signal, 1) signal.Notify(c, syscall.SIGINT, syscall.SIGTERM) errChan - fmt.Errorf( %s , -c) }() fmt.Println( - errChan) }","title":"\u7b2c6\u6b65\uff1aServer"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#7client","text":"\u73b0\u5728\u8be5\u5230\u5ba2\u6237\u7aef\u4e86\uff0c\u9700\u8981\u521b\u5efa\u8fd4\u56deService\u7684NewClient\u51fd\u6570\uff0c\u56e0\u4e3aNewClient\u51fd\u6570\u5c06\u8f6c\u6362\u4e3aEndpoint\u3002 package client import ( github.com/ru-rocker/gokit-playground/lorem-grpc github.com/ru-rocker/gokit-playground/lorem-grpc/pb grpctransport github.com/go-kit/kit/transport/grpc google.golang.org/grpc ) // Return new lorem_grpc service func New(conn *grpc.ClientConn) lorem_grpc.Service { var loremEndpoint = grpctransport.NewClient( conn, Lorem , Lorem , lorem_grpc.EncodeGRPCLoremRequest, lorem_grpc.DecodeGRPCLoremResponse, pb.LoremResponse{}, ).Endpoint() return lorem_grpc.Endpoints{ LoremEndpoint: loremEndpoint, } } \u8bf7\u6ce8\u610f\uff0c\u6211\u4e3a\u6b64\u529f\u80fd\u8fd4\u56de\u4e86Endpoint\uff08\u8bf7\u53c2\u9605\u6709\u5173\u5b9e\u73b0Service\u63a5\u53e3\u7684\u6b65\u9aa43\uff09\u3002\u7136\u540e\u5728cmd\u76ee\u5f55\u4e0b\u521b\u5efa\u53ef\u6267\u884c\u5ba2\u6237\u7aef\u3002 package main import ( flag time log grpcClient github.com/ru-rocker/gokit-playground/lorem-grpc/client google.golang.org/grpc golang.org/x/net/context github.com/ru-rocker/gokit-playground/lorem-grpc fmt strconv ) func main() { var ( grpcAddr = flag.String( addr , :8081 , gRPC address ) ) flag.Parse() ctx := context.Background() conn, err := grpc.Dial(*grpcAddr, grpc.WithInsecure(), grpc.WithTimeout(1*time.Second)) if err != nil { log.Fatalln( gRPC dial: , err) } defer conn.Close() loremService := grpcClient.New(conn) args := flag.Args() var cmd string cmd, args = pop(args) switch cmd { case lorem : var requestType, minStr, maxStr string requestType, args = pop(args) minStr, args = pop(args) maxStr, args = pop(args) min, _ := strconv.Atoi(minStr) max, _ := strconv.Atoi(maxStr) lorem(ctx, loremService, requestType, min, max) default: log.Fatalln( unknown command , cmd) } } // parse command line argument one by one func pop(s []string) (string, []string) { if len(s) == 0 { return , s } return s[0], s[1:] } // call lorem service func lorem(ctx context.Context, service lorem_grpc.Service, requestType string, min int, max int) { mesg, err := service.Lorem(ctx, requestType, min, max) if err != nil { log.Fatalln(err.Error()) } fmt.Println(mesg) }","title":"\u7b2c7\u6b65\uff1aClient"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#_4","text":"\u4e3a\u4e86\u6d4b\u8bd5\u5b83\u7684\u5de5\u4f5c\u65b9\u5f0f\uff0c\u9996\u5148\u6211\u4eec\u9700\u8981\u8fd0\u884cgRPC\u670d\u52a1\u5668\u3002 cd $GOPATH #Running grpc server go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/server/src/github.com/ru-rocker/gokit-playground/lorem-grpc/server/server_grpc_main.go \u63a5\u4e0b\u6765\uff0c\u6267\u884c\u5ba2\u6237\u7aef\uff1a cd $GOPATH #Running client go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/main.go lorem sentence 10 20 \u8f93\u5165\u5982\u4e0b\uff1a # sentence go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem sentence 10 20 Concurrunt nota re dicam fias, sim aut pecco, die appetitum. # word go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem word 10 20 difficultates # paragraph go run src/github.com/ru-rocker/gokit-playground/lorem-grpc/client/cmd/client_grpc_main.go lorem paragraph 10 20 En igitur aequo tibi ita recedimus an aut eum tenacius quae mortalitatis eram aut rapit montium inaequaliter dulcedo aditum. Rerum tempus mala anima volebant dura quae o modis, fama vanescit fit. Nuntii comprehendet ponamus redducet cura sero prout, nonne respondi ipsa angelos comes, da ea saepe didici. Crebro te via hos adsit. Psalmi agam me mea pro da. Audi pati sim da ita praeire nescio faciant. Deserens da contexo e suaveolentiam qualibus subtrahatur excogitanda pusillus grex, e o recorder cor re libidine. Ore siderum ago mei, cura hi deo. Dicens ore curiosarum, filiorum eruuntur munerum displicens ita me repente formaeque agam nosti. Deo fama propterea ab persentiscere nam acceptam sed e a corruptione. Rogo ea nascendo qui, fuit ceterarumque. Drachmam ore operatores exemplo vivunt. Recolo hi fac cor secreta fama, domi, rogo somnis. Sapores fidei maneas saepe corporis re oris quantulum doleam te potu ita lux da facie aut. Benedicendo e tertium nosse agam ne amo, mole invenio dicturus me cognoscere ita aer se memor consulerem ab te rei. Miles ita amaritudo rogo hi flendae quietem invoco quae odor desuper tu. Temptatione dicturus ita mediator ita mundum lux partes miseros percepta seu dicant avaritiam nares contra deseri securus. Ea sobrios tale, rogo sanctis. Ita ne manu uspiam hierusalem, transeam dicite subduntur responsa cor socialiter fit deseri album praeditum.","title":"\u8fd0\u884c"},{"location":"Frameworks/Go-kit/Examples/01-Endpoints(gRPC)/#_5","text":"\u521b\u5efagRPC\u7aef\u70b9\u975e\u5e38\u7b80\u5355\uff0c\u4e0eREST\u7aef\u70b9\u53ea\u6709\u4e00\u70b9\u70b9\u4e0d\u540c\u3002\u4f46\u662f\uff0cgRPC\u6bd4REST\u8fd0\u884c\u5f97\u66f4\u5feb\u3002\u6211\u7684\u611f\u89c9\u662f\u5c06\u6765gRPC\u5c06\u53d6\u4ee3JSON\u3002 \u540c\u65f6\uff0c\u5982\u679c\u60a8\u5bf9\u6b64\u793a\u4f8b\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u5728\u6211\u7684 github \u4e0a\u68c0\u67e5\u6e90\u4ee3\u7801\u3002","title":"\u603b\u7ed3"},{"location":"Frameworks/Go-kit/Examples/API-Monitoring/","text":"","title":"API Monitoring"},{"location":"Frameworks/Go-kit/Examples/Hystrix-Circuit-Breaker/","text":"","title":"Hystrix Circuit Breaker"},{"location":"Frameworks/Go-kit/Examples/Logging(ELK)/","text":"","title":"Logging(ELK)"},{"location":"Frameworks/Go-kit/Examples/Logging/","text":"","title":"Logging"},{"location":"Frameworks/Go-kit/Examples/Rate-Limiting/","text":"","title":"Rate Limiting"},{"location":"Frameworks/Go-kit/Examples/Service-Discovery/","text":"","title":"Service Discovery"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/","text":"\u4ec0\u4e48\u662fProtocol Buffers Protocol buffers \u662f\u4e00\u79cd\u7075\u6d3b\uff0c\u9ad8\u6548\uff0c\u81ea\u52a8\u5316\u7684\u673a\u5236\uff0c\u7528\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u7684\u6570\u636e\uff08\u5982 XML \uff09\uff0c\u4f46\u662f\u5b83\u66f4\u5c0f\uff0c\u66f4\u5feb\uff0c\u66f4\u7b80\u5355\u3002\u53ef\u4ee5\u5b9a\u4e49\u6570\u636e\u5982\u4f55\u88ab\u7ed3\u6784\u5316\uff0c\u7136\u540e\u4f7f\u7528\u7279\u5b9a\u7684\u751f\u6210\u7684\u6e90\u4ee3\u7801\u8f7b\u677e\u5730\u5c06\u7ed3\u6784\u5316\u6570\u636e\u5728\u5404\u79cd\u6570\u636e\u6d41\u4e2d\u5199\u5165\u548c\u8bfb\u53d6\uff0c\u8fd9\u652f\u6301\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00\u3002\u751a\u81f3\u53ef\u4ee5\u66f4\u65b0\u6570\u636e\u7ed3\u6784\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u6839\u636e\u201c\u65e7\u201d\u683c\u5f0f\u7f16\u8bd1\u7684\u5df2\u90e8\u7f72\u7a0b\u5e8f\u3002 Protocol buffers\u5982\u4f55\u5de5\u4f5c \u901a\u8fc7\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49 protocol buffers \u6d88\u606f\u7c7b\u578b\u6765\u6307\u5b9a\u5e0c\u671b\u5982\u4f55\u6784\u5efa\u5e8f\u5217\u5316\u4fe1\u606f\u3002\u6bcf\u4e2a protocol buffers \u6d88\u606f\u90fd\u662f\u4e00\u4e2a\u5c0f\u7684\u903b\u8f91\u4fe1\u606f\u8bb0\u5f55\uff0c\u5305\u542b\u4e00\u7cfb\u5217 \u540d\u79f0-\u503c \u5bf9\u3002\u4ee5\u4e0b\u662f .proto \u6587\u4ef6\u7684\u4e00\u4e2a\u975e\u5e38\u57fa\u672c\u7684\u793a\u4f8b\uff0c\u8be5\u6587\u4ef6\u5b9a\u4e49\u4e86\u5305\u542b\u6709\u5173\u4eba\u5458\u4fe1\u606f\u7684\u6d88\u606f\uff1a message Person { required string name = 1; required int32 id = 2; optional string email = 3; enum PhoneType { MOBILE = 0; HOME = 1; WORK = 2; } message PhoneNumber { required string number = 1; optional PhoneType type = 2 [default = HOME]; } repeated PhoneNumber phone = 4; } \u5982\u4e0a\u6240\u793a\uff0c\u6d88\u606f\u683c\u5f0f\u5f88\u7b80\u5355\uff1a \u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u90fd\u6709\u4e00\u4e2a\u6216\u591a\u4e2a \u552f\u4e00\u7f16\u53f7 \u7684\u5b57\u6bb5\uff0c \u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u4e00\u4e2a \u540d\u79f0 \u548c\u4e00\u4e2a \u503c\u7c7b\u578b \uff0c \u5176\u4e2d\u503c\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a \u6570\u5b57\uff08\u6574\u6570\u6216\u6d6e\u70b9\u6570\uff09 \u5e03\u5c14\u503c \u5b57\u7b26\u4e32 \u539f\u59cb\u5b57\u8282 \u751a\u81f3\uff08\u5982\u4e0a\u4f8b\u6240\u793a\uff09\u5176\u4ed6 protocol buffers \u6d88\u606f\u7c7b\u578b\uff0c\u5141\u8bb8\u5206\u5c42\u6b21\u5730\u6784\u5efa\u6570\u636e \u53ef\u4ee5\u6307\u5b9a: \u53ef\u9009\u5b57\u6bb5\uff08optional\uff09 \u5fc5\u586b\u5b57\u6bb5\uff08required\uff09 \u91cd\u590d\u5b57\u6bb5\uff08repeated\uff09 \u53ef\u4ee5\u5728 Protocol Buffer Language Guide \u4e2d\u627e\u5230\u6709\u5173\u7f16\u5199 .proto \u6587\u4ef6\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u4e00\u65e6\u5b9a\u4e49\u4e86\u6d88\u606f\uff0c\u5c31\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c\u76f8\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684 protocol buffers \u7f16\u8bd1\u5668\u6765\u751f\u6210\u6570\u636e\u8bbf\u95ee\u7c7b\uff0c\u4ed6\u4eec\u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u8bbf\u95ee\u5668\uff0c\u5982 name() \u548c set_name() \uff0c\u4ee5\u53ca\u5c06\u6574\u4e2a\u7ed3\u6784\u5e8f\u5217\u5316\u6216\u89e3\u6790\u4e3a\u539f\u59cb\u5b57\u8282\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u9009\u62e9\u7684\u8bed\u8a00\u662fC++\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e0a\u8fd0\u884c\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Person \u7684\u7c7b\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6b64\u7c7b\u6765\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22 Person \u7684 protocol buffers \u6d88\u606f\u3002\u5982\u4e0b\u6240\u793a\u7684\u4ee3\u7801\u3002 Person person; person.set_name( John Doe ); person.set_id(1234); person.set_email( jdoe@example.com ); fstream output( myfile , ios::out | ios::binary); person.SerializeToOstream( output); \u53ef\u4ee5\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u9605\u8bfb\u6d88\u606f\uff1a fstream input( myfile , ios::in | ios::binary); Person person; person.ParseFromIstream( input); cout Name: person.name() endl; cout E-mail: person.email() endl; \u53ef\u4ee5\u5728\u4e0d\u7834\u574f\u5411\u540e\u517c\u5bb9\u6027\u7684\u60c5\u51b5\u4e0b\u4e3a\u90ae\u4ef6\u683c\u5f0f\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c \u65e7\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u89e3\u6790\u65f6\u53ea\u662f\u5ffd\u7565\u65b0\u5b57\u6bb5 \u3002\u56e0\u6b64\uff0c\u5982\u679c\u901a\u4fe1\u534f\u8bae\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u6570\u636e\u683c\u5f0f\uff0c\u5219\u53ef\u4ee5\u6269\u5c55\u534f\u8bae\uff0c\u800c\u65e0\u9700\u62c5\u5fc3\u7834\u574f\u73b0\u6709\u4ee3\u7801\u3002 \u5c06\u5728 API\u53c2\u8003 \u90e8\u5206\u627e\u5230\u6709\u5173\u4f7f\u7528\u751f\u6210\u7684 protocol buffers \u4ee3\u7801\u7684\u5b8c\u6574\u53c2\u8003\uff0c\u5728 protocol buffers \u7f16\u7801 \u4e2d\u627e\u5230\u6709\u5173 protocol buffers \u6d88\u606f\u5982\u4f55\u7f16\u7801\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u7528XML \u5bf9\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u6570\u636e\uff0c protocol buffers \u6bd4 XML \u5177\u6709\u8bb8\u591a\u4f18\u70b9\uff1a \u66f4\u7b80\u5355 \u7f29\u5c0f3~10\u500d \u5feb20~100\u500d \u66f4\u5c11\u6b67\u4e49 \u751f\u6210\u66f4\u6613\u4e8e\u7f16\u7a0b\u7684\u6570\u636e\u8bbf\u95ee\u7c7b\u578b \u4f8b\u5982\uff0c\u5047\u8bbe\u8981\u4e3a\u5177\u6709 name \u548c email \u7684 Person \u5efa\u6a21\u3002\u5728XML\u4e2d\uff0c\u9700\u8981\uff1a person name John Doe /name email jdoe@example.com /email /person \u800c\u76f8\u5e94\u7684 protocol buffers \u6d88\u606f\uff08 protocol buffers \u6587\u672c\u683c\u5f0f\uff09\u662f\uff1a # Textual representation of a protocol buffer. # This is *not* the binary format used on the wire. person { name: John Doe email: jdoe@example.com } \u5f53\u6b64\u6d88\u606f\u88ab\u7f16\u7801\u4e3a protocol buffers \u4e8c\u8fdb\u5236\u683c\u5f0f\uff08\u4e0a\u9762\u7684\u6587\u672c\u683c\u5f0f\u53ea\u662f\u65b9\u4fbf\u4eba\u7c7b\u53ef\u8bfb\u7684\u8868\u793a\u5f62\u5f0f\uff0c\u7528\u4e8e\u8c03\u8bd5\u548c\u7f16\u8f91\uff09\u65f6\uff0c\u5b83\u53ef\u80fd\u662f28\u5b57\u8282\u957f\u5e76\u4e14\u9700\u8981\u5927\u7ea6100-200\u7eb3\u79d2\u6765\u89e3\u6790\u3002\u5982\u679c\u5220\u9664\u7a7a\u683c\uff0c XML \u7248\u672c\u81f3\u5c11\u4e3a69\u4e2a\u5b57\u8282\uff0c\u5e76\u4e14\u9700\u8981\u5927\u7ea65,000-10,000\u7eb3\u79d2\u624d\u80fd\u89e3\u6790\u3002 \u6b64\u5916\uff0c\u64cd\u4f5c protocol buffers \u8981\u5bb9\u6613\u5f97\u591a\uff1a cout Name: person.name() endl; cout E-mail: person.email() endl; \u800c\u4f7f\u7528 XML \uff0c\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a cout Name: person.getElementsByTagName( name )- item(0)- innerText() endl; cout E-mail: person.getElementsByTagName( email )- item(0)- innerText() endl; \u4f46\u662f\uff0c protocol buffers \u5e76\u4e0d\u603b\u662f\u6bd4 XML \u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4f8b\u5982: protocol buffers \u4e0d\u662f\u4f7f\u7528\u6807\u8bb0\u5bf9\u57fa\u4e8e\u6587\u672c\u7684\u6587\u6863\uff08\u4f8b\u5982 HTML \uff09\u5efa\u6a21\u7684\u597d\u65b9\u6cd5\uff0c \u56e0\u4e3a\u65e0\u6cd5\u8f7b\u677e\u5730\u5c06\u7ed3\u6784\u4e0e\u6587\u672c\u4ea4\u9519 \u3002 XML \u662f\u4eba\u7c7b\u53ef\u8bfb\u548c\u53ef\u7f16\u8f91\u7684; protocol buffers \u5728\u5b83\u539f\u751f\u7684\u683c\u5f0f\u4e2d\u4e0d\u662f\u4eba\u7c7b\u53ef\u8bfb\u548c\u53ef\u7f16\u8f91\u7684\u3002 XML \u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u4e5f\u662f\u81ea\u6211\u63cf\u8ff0\u7684\u3002\u53ea\u6709\u62e5\u6709\u6d88\u606f\u5b9a\u4e49\uff08\u5982 .proto\u6587\u4ef6 \uff09\u65f6\uff0c protocol buffers \u624d\u6709\u610f\u4e49\u3002 \u5982\u4f55\u5f00\u59cb\u4f7f\u7528 \u4e0b\u8f7d\u8fd9\u4e2a\u5305 \uff0c\u5b83\u5305\u542b Java \uff0c Python \u548c C++ \u7248\u672c\u7684 protocol buffers \u7f16\u8bd1\u5668\u7684\u5b8c\u6574\u6e90\u4ee3\u7801\uff0c\u4ee5\u53ca I/O \u548c\u6d4b\u8bd5\u6240\u9700\u7684\u7c7b\u3002\u8981\u6784\u5efa\u548c\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 \u5b8c\u6210\u6240\u6709\u8bbe\u7f6e\u540e\uff0c\u8bf7\u5c1d\u8bd5\u6309\u7167\u6240\u9009\u8bed\u8a00\u7684 \u6559\u7a0b \u8fdb\u884c\u64cd\u4f5c,\u8fd9\u5c06\u6307\u5bfc\u4f60\u521b\u5efa\u4e00\u4e2a\u4f7f\u7528 protocol buffers \u7684\u7b80\u5355\u5e94\u7528\u7a0b\u5e8f\u3002 proto3 \u7b80\u4ecb \u6700\u65b0\u7684\u7248\u672c3 \u53d1\u5e03 \u4e86\u4e00\u4e2a\u65b0\u7684\u8bed\u8a00\u7248\u672c\uff1a Protocol Buffers\u8bed\u8a00\u7248\u672c3 \uff08\u7b80\u79f0 proto3 \uff09\uff0c\u4ee5\u53ca\u73b0\u6709\u8bed\u8a00\u7248\u672c\uff08\u7b80\u79f0 proto2 \uff09\u4e2d\u7684\u4e00\u4e9b\u65b0\u529f\u80fd\u3002 Proto3 \u7b80\u5316\u4e86 protocol buffers \u8bed\u8a00\uff0c\u65e2\u6613\u4e8e\u4f7f\u7528\uff0c\u53c8\u53ef\u4ee5\u5728\u66f4\u5e7f\u6cdb\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\uff1a\u5f53\u524d\u7684\u7248\u672c\u5141\u8bb8\u4f7f\u7528 Java \uff0c C++ \uff0c Python \uff0c Java Lite \uff0c Ruby \uff0c JavaScript \uff0c Objective \u548c C\uff03 \u6765\u751f\u6210 protocol buffers \u4ee3\u7801\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u4f7f\u7528\u6700\u65b0\u7684 Go protoc \u63d2\u4ef6\u4e3aGo\u751f\u6210 proto3 \u4ee3\u7801\uff0c\u8be5\u63d2\u4ef6\u53ef\u4ece golang/protobuf Github\u5b58\u50a8\u5e93\u83b7\u5f97\u3002\u66f4\u591a\u7684\u8bed\u8a00\u6b63\u5728\u7b79\u5907\u4e2d\u3002 \u8bf7\u6ce8\u610f\uff0c\u4e24\u79cd\u8bed\u8a00\u7248\u672c\u7684API\u4e0d\u5b8c\u5168\u517c\u5bb9\u3002\u4e3a\u907f\u514d\u7ed9\u73b0\u6709\u7528\u6237\u5e26\u6765\u4e0d\u4fbf\uff0c\u5c06\u7ee7\u7eed\u5728\u65b0 protocol buffers \u7248\u672c\u4e2d\u652f\u6301\u4ee5\u524d\u7684\u8bed\u8a00\u7248\u672c\u3002 \u53ef\u4ee5\u5728 \u53d1\u884c\u8bf4\u660e \u4e2d\u770b\u5230\u4e0e\u5f53\u524d\u9ed8\u8ba4\u7248\u672c\u7684\u4e3b\u8981\u5dee\u5f02\uff0c\u5e76\u4e86\u89e3 Proto3 \u8bed\u8a00\u6307\u5357\u4e2d\u7684 proto3 \u8bed\u6cd5\u3002proto3\u7684\u5b8c\u6574\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff01 \uff08\u5982\u679c\u540d\u79f0 proto2 \u548c proto3 \u770b\u8d77\u6765\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\uff0c\u90a3\u662f\u56e0\u4e3a\u6700\u521d\u5f00\u6e90 protocol buffers \u65f6\uff0c\u5b83\u5b9e\u9645\u4e0a\u662fGoogle\u7684\u7b2c\u4e8c\u7248\u8bed\u8a00\uff0c\u4e5f\u79f0\u4e3a proto2 \u3002\u8fd9\u4e5f\u5f00\u6e90\u7248\u672c\u53f7\u4ecev2\u5f00\u59cb\u7684\u539f\u56e0\u3002 \u4e00\u70b9\u5c0f\u5386\u53f2 protocol buffers \u6700\u521d\u662f\u5728Google\u5f00\u53d1\u7684\uff0c\u7528\u4e8e\u5904\u7406\u7d22\u5f15\u670d\u52a1\u5668\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\u3002\u5728 protocol buffers \u4e4b\u524d\uff0c\u6709\u4e00\u79cd\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u683c\u5f0f\uff0c\u5b83\u4f7f\u7528\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u624b\u52a8\u7f16\u7ec4/\u89e3\u7ec4\uff0c\u5e76\u652f\u6301\u8bb8\u591a\u7248\u672c\u7684\u534f\u8bae\u3002 \u8fd9\u5bfc\u81f4\u4e00\u4e9b\u975e\u5e38\u4e11\u964b\u7684\u4ee3\u7801\uff0c\u5982\uff1a if (version == 3) { ... } else if (version 4) { if (version == 5) { ... } ... } \u660e\u786e\u683c\u5f0f\u5316\u7684\u534f\u8bae\u4e5f\u4f7f\u65b0\u534f\u8bae\u7248\u672c\u7684\u63a8\u51fa\u53d8\u5f97\u590d\u6742\uff0c\u56e0\u4e3a\u5f00\u53d1\u4eba\u5458\u5fc5\u987b\u786e\u4fdd\u8bf7\u6c42\u7684\u53d1\u8d77\u8005\u548c\u5904\u7406\u8bf7\u6c42\u7684\u5b9e\u9645\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u670d\u52a1\u5668\u90fd\u80fd\u7406\u89e3\u65b0\u534f\u8bae\uff0c\u7136\u540e\u624d\u80fd\u5207\u6362\u4ee5\u5f00\u59cb\u4f7f\u7528\u65b0\u534f\u8bae\u3002 protocol buffers \u5f00\u53d1\u7528\u4e8e\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1a \u53ef\u4ee5\u8f7b\u677e\u5f15\u5165\u65b0\u5b57\u6bb5\uff0c\u800c\u4e2d\u95f4\u670d\u52a1\u5668\u4e0d\u9700\u8981\u68c0\u67e5\u6570\u636e\u5c31\u53ef\u4ee5\u7b80\u5355\u5730\u89e3\u6790\u5b83\u5e76\u4f20\u9012\u6570\u636e\u800c\u65e0\u9700\u4e86\u89e3\u6240\u6709\u5b57\u6bb5\u3002 \u683c\u5f0f\u66f4\u5177\u81ea\u6211\u63cf\u8ff0\u6027\uff0c\u53ef\u4ee5\u7528\u5404\u79cd\u8bed\u8a00\uff08C++\uff0cJava\u7b49\uff09\u5904\u7406\u3002 \u4f46\u662f\uff0c\u7528\u6237\u4ecd\u7136\u9700\u8981\u81ea\u5df1\u624b\u5199\u89e3\u6790\u4ee3\u7801\u3002 \u968f\u7740\u7cfb\u7edf\u7684\u53d1\u5c55\uff0c\u5b83\u83b7\u5f97\u4e86\u8bb8\u591a\u5176\u4ed6\u529f\u80fd\u548c\u7528\u9014\uff1a \u81ea\u52a8\u751f\u6210\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4ee3\u7801\u907f\u514d\u4e86\u624b\u52a8\u89e3\u6790\u7684\u9700\u8981\u3002 \u9664\u4e86\u7528\u4e8e\u77ed\u751f\u547d\u5468\u671f\u7684RPC\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff09\u8bf7\u6c42\u4e4b\u5916\uff0c\u5927\u5bb6\u5df2\u7ecf\u5f00\u59cb\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u4e00\u79cd\u65b9\u4fbf\u7684\u81ea\u63cf\u8ff0\u683c\u5f0f\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u6570\u636e\uff08\u4f8b\u5982\uff0c\u5728 Bigtable \u4e2d\uff09\u3002 \u9996\u5148\u670d\u52a1\u7684RPC\u63a5\u53e3\u88ab\u58f0\u660e\u4e3a protocol \u6587\u4ef6\u7684\u4e00\u90e8\u5206\uff0c\u7136\u540e\u4f7f\u7528 protocol \u7f16\u8bd1\u5668\u751f\u6210 stub \u7c7b\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u670d\u52a1\u63a5\u53e3\u7684\u5b9e\u9645\u5b9e\u73b0\u6765\u8986\u76d6\u8fd9\u4e9b stub \u7c7b\u3002 \u73b0\u5728 protocol buffers \u662fGoogle\u7684\u6570\u636e\u901a\u7528\u8bed\u8a00\uff0c\u5728\u64b0\u5199\u672c\u6587\u65f6\uff0cGoogle\u4ee3\u7801\u6811\u4e2d\u5b9a\u4e49\u4e86306,747\u79cd\u4e0d\u540c\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u8de8348,952\u4e2a .proto \u6587\u4ef6\u3002\u5b83\u4eec\u65e2\u53ef\u7528\u4e8eRPC\u7cfb\u7edf\uff0c\u4e5f\u53ef\u7528\u4e8e\u5404\u79cd\u5b58\u50a8\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u6301\u4e45\u5b58\u50a8\u3002","title":"\u4ec0\u4e48\u662fProtocol Buffers"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#protocol-buffers","text":"Protocol buffers \u662f\u4e00\u79cd\u7075\u6d3b\uff0c\u9ad8\u6548\uff0c\u81ea\u52a8\u5316\u7684\u673a\u5236\uff0c\u7528\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u7684\u6570\u636e\uff08\u5982 XML \uff09\uff0c\u4f46\u662f\u5b83\u66f4\u5c0f\uff0c\u66f4\u5feb\uff0c\u66f4\u7b80\u5355\u3002\u53ef\u4ee5\u5b9a\u4e49\u6570\u636e\u5982\u4f55\u88ab\u7ed3\u6784\u5316\uff0c\u7136\u540e\u4f7f\u7528\u7279\u5b9a\u7684\u751f\u6210\u7684\u6e90\u4ee3\u7801\u8f7b\u677e\u5730\u5c06\u7ed3\u6784\u5316\u6570\u636e\u5728\u5404\u79cd\u6570\u636e\u6d41\u4e2d\u5199\u5165\u548c\u8bfb\u53d6\uff0c\u8fd9\u652f\u6301\u5404\u79cd\u7f16\u7a0b\u8bed\u8a00\u3002\u751a\u81f3\u53ef\u4ee5\u66f4\u65b0\u6570\u636e\u7ed3\u6784\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u6839\u636e\u201c\u65e7\u201d\u683c\u5f0f\u7f16\u8bd1\u7684\u5df2\u90e8\u7f72\u7a0b\u5e8f\u3002","title":"\u4ec0\u4e48\u662fProtocol Buffers"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#protocol-buffers_1","text":"\u901a\u8fc7\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49 protocol buffers \u6d88\u606f\u7c7b\u578b\u6765\u6307\u5b9a\u5e0c\u671b\u5982\u4f55\u6784\u5efa\u5e8f\u5217\u5316\u4fe1\u606f\u3002\u6bcf\u4e2a protocol buffers \u6d88\u606f\u90fd\u662f\u4e00\u4e2a\u5c0f\u7684\u903b\u8f91\u4fe1\u606f\u8bb0\u5f55\uff0c\u5305\u542b\u4e00\u7cfb\u5217 \u540d\u79f0-\u503c \u5bf9\u3002\u4ee5\u4e0b\u662f .proto \u6587\u4ef6\u7684\u4e00\u4e2a\u975e\u5e38\u57fa\u672c\u7684\u793a\u4f8b\uff0c\u8be5\u6587\u4ef6\u5b9a\u4e49\u4e86\u5305\u542b\u6709\u5173\u4eba\u5458\u4fe1\u606f\u7684\u6d88\u606f\uff1a message Person { required string name = 1; required int32 id = 2; optional string email = 3; enum PhoneType { MOBILE = 0; HOME = 1; WORK = 2; } message PhoneNumber { required string number = 1; optional PhoneType type = 2 [default = HOME]; } repeated PhoneNumber phone = 4; } \u5982\u4e0a\u6240\u793a\uff0c\u6d88\u606f\u683c\u5f0f\u5f88\u7b80\u5355\uff1a \u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u90fd\u6709\u4e00\u4e2a\u6216\u591a\u4e2a \u552f\u4e00\u7f16\u53f7 \u7684\u5b57\u6bb5\uff0c \u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u4e00\u4e2a \u540d\u79f0 \u548c\u4e00\u4e2a \u503c\u7c7b\u578b \uff0c \u5176\u4e2d\u503c\u7c7b\u578b\u53ef\u4ee5\u662f\uff1a \u6570\u5b57\uff08\u6574\u6570\u6216\u6d6e\u70b9\u6570\uff09 \u5e03\u5c14\u503c \u5b57\u7b26\u4e32 \u539f\u59cb\u5b57\u8282 \u751a\u81f3\uff08\u5982\u4e0a\u4f8b\u6240\u793a\uff09\u5176\u4ed6 protocol buffers \u6d88\u606f\u7c7b\u578b\uff0c\u5141\u8bb8\u5206\u5c42\u6b21\u5730\u6784\u5efa\u6570\u636e \u53ef\u4ee5\u6307\u5b9a: \u53ef\u9009\u5b57\u6bb5\uff08optional\uff09 \u5fc5\u586b\u5b57\u6bb5\uff08required\uff09 \u91cd\u590d\u5b57\u6bb5\uff08repeated\uff09 \u53ef\u4ee5\u5728 Protocol Buffer Language Guide \u4e2d\u627e\u5230\u6709\u5173\u7f16\u5199 .proto \u6587\u4ef6\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u4e00\u65e6\u5b9a\u4e49\u4e86\u6d88\u606f\uff0c\u5c31\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c\u76f8\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684 protocol buffers \u7f16\u8bd1\u5668\u6765\u751f\u6210\u6570\u636e\u8bbf\u95ee\u7c7b\uff0c\u4ed6\u4eec\u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u8bbf\u95ee\u5668\uff0c\u5982 name() \u548c set_name() \uff0c\u4ee5\u53ca\u5c06\u6574\u4e2a\u7ed3\u6784\u5e8f\u5217\u5316\u6216\u89e3\u6790\u4e3a\u539f\u59cb\u5b57\u8282\u7684\u65b9\u6cd5\u3002 \u4f8b\u5982\uff0c\u5982\u679c\u9009\u62e9\u7684\u8bed\u8a00\u662fC++\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e0a\u8fd0\u884c\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Person \u7684\u7c7b\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6b64\u7c7b\u6765\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22 Person \u7684 protocol buffers \u6d88\u606f\u3002\u5982\u4e0b\u6240\u793a\u7684\u4ee3\u7801\u3002 Person person; person.set_name( John Doe ); person.set_id(1234); person.set_email( jdoe@example.com ); fstream output( myfile , ios::out | ios::binary); person.SerializeToOstream( output); \u53ef\u4ee5\u5728\u4ee5\u4e0b\u4f4d\u7f6e\u9605\u8bfb\u6d88\u606f\uff1a fstream input( myfile , ios::in | ios::binary); Person person; person.ParseFromIstream( input); cout Name: person.name() endl; cout E-mail: person.email() endl; \u53ef\u4ee5\u5728\u4e0d\u7834\u574f\u5411\u540e\u517c\u5bb9\u6027\u7684\u60c5\u51b5\u4e0b\u4e3a\u90ae\u4ef6\u683c\u5f0f\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c \u65e7\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u89e3\u6790\u65f6\u53ea\u662f\u5ffd\u7565\u65b0\u5b57\u6bb5 \u3002\u56e0\u6b64\uff0c\u5982\u679c\u901a\u4fe1\u534f\u8bae\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u6570\u636e\u683c\u5f0f\uff0c\u5219\u53ef\u4ee5\u6269\u5c55\u534f\u8bae\uff0c\u800c\u65e0\u9700\u62c5\u5fc3\u7834\u574f\u73b0\u6709\u4ee3\u7801\u3002 \u5c06\u5728 API\u53c2\u8003 \u90e8\u5206\u627e\u5230\u6709\u5173\u4f7f\u7528\u751f\u6210\u7684 protocol buffers \u4ee3\u7801\u7684\u5b8c\u6574\u53c2\u8003\uff0c\u5728 protocol buffers \u7f16\u7801 \u4e2d\u627e\u5230\u6709\u5173 protocol buffers \u6d88\u606f\u5982\u4f55\u7f16\u7801\u7684\u66f4\u591a\u4fe1\u606f\u3002","title":"Protocol buffers\u5982\u4f55\u5de5\u4f5c"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#xml","text":"\u5bf9\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u6570\u636e\uff0c protocol buffers \u6bd4 XML \u5177\u6709\u8bb8\u591a\u4f18\u70b9\uff1a \u66f4\u7b80\u5355 \u7f29\u5c0f3~10\u500d \u5feb20~100\u500d \u66f4\u5c11\u6b67\u4e49 \u751f\u6210\u66f4\u6613\u4e8e\u7f16\u7a0b\u7684\u6570\u636e\u8bbf\u95ee\u7c7b\u578b \u4f8b\u5982\uff0c\u5047\u8bbe\u8981\u4e3a\u5177\u6709 name \u548c email \u7684 Person \u5efa\u6a21\u3002\u5728XML\u4e2d\uff0c\u9700\u8981\uff1a person name John Doe /name email jdoe@example.com /email /person \u800c\u76f8\u5e94\u7684 protocol buffers \u6d88\u606f\uff08 protocol buffers \u6587\u672c\u683c\u5f0f\uff09\u662f\uff1a # Textual representation of a protocol buffer. # This is *not* the binary format used on the wire. person { name: John Doe email: jdoe@example.com } \u5f53\u6b64\u6d88\u606f\u88ab\u7f16\u7801\u4e3a protocol buffers \u4e8c\u8fdb\u5236\u683c\u5f0f\uff08\u4e0a\u9762\u7684\u6587\u672c\u683c\u5f0f\u53ea\u662f\u65b9\u4fbf\u4eba\u7c7b\u53ef\u8bfb\u7684\u8868\u793a\u5f62\u5f0f\uff0c\u7528\u4e8e\u8c03\u8bd5\u548c\u7f16\u8f91\uff09\u65f6\uff0c\u5b83\u53ef\u80fd\u662f28\u5b57\u8282\u957f\u5e76\u4e14\u9700\u8981\u5927\u7ea6100-200\u7eb3\u79d2\u6765\u89e3\u6790\u3002\u5982\u679c\u5220\u9664\u7a7a\u683c\uff0c XML \u7248\u672c\u81f3\u5c11\u4e3a69\u4e2a\u5b57\u8282\uff0c\u5e76\u4e14\u9700\u8981\u5927\u7ea65,000-10,000\u7eb3\u79d2\u624d\u80fd\u89e3\u6790\u3002 \u6b64\u5916\uff0c\u64cd\u4f5c protocol buffers \u8981\u5bb9\u6613\u5f97\u591a\uff1a cout Name: person.name() endl; cout E-mail: person.email() endl; \u800c\u4f7f\u7528 XML \uff0c\u5fc5\u987b\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a cout Name: person.getElementsByTagName( name )- item(0)- innerText() endl; cout E-mail: person.getElementsByTagName( email )- item(0)- innerText() endl; \u4f46\u662f\uff0c protocol buffers \u5e76\u4e0d\u603b\u662f\u6bd4 XML \u66f4\u597d\u7684\u89e3\u51b3\u65b9\u6848\u3002\u4f8b\u5982: protocol buffers \u4e0d\u662f\u4f7f\u7528\u6807\u8bb0\u5bf9\u57fa\u4e8e\u6587\u672c\u7684\u6587\u6863\uff08\u4f8b\u5982 HTML \uff09\u5efa\u6a21\u7684\u597d\u65b9\u6cd5\uff0c \u56e0\u4e3a\u65e0\u6cd5\u8f7b\u677e\u5730\u5c06\u7ed3\u6784\u4e0e\u6587\u672c\u4ea4\u9519 \u3002 XML \u662f\u4eba\u7c7b\u53ef\u8bfb\u548c\u53ef\u7f16\u8f91\u7684; protocol buffers \u5728\u5b83\u539f\u751f\u7684\u683c\u5f0f\u4e2d\u4e0d\u662f\u4eba\u7c7b\u53ef\u8bfb\u548c\u53ef\u7f16\u8f91\u7684\u3002 XML \u5728\u67d0\u79cd\u7a0b\u5ea6\u4e0a\u4e5f\u662f\u81ea\u6211\u63cf\u8ff0\u7684\u3002\u53ea\u6709\u62e5\u6709\u6d88\u606f\u5b9a\u4e49\uff08\u5982 .proto\u6587\u4ef6 \uff09\u65f6\uff0c protocol buffers \u624d\u6709\u610f\u4e49\u3002","title":"\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u7528XML"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#_1","text":"\u4e0b\u8f7d\u8fd9\u4e2a\u5305 \uff0c\u5b83\u5305\u542b Java \uff0c Python \u548c C++ \u7248\u672c\u7684 protocol buffers \u7f16\u8bd1\u5668\u7684\u5b8c\u6574\u6e90\u4ee3\u7801\uff0c\u4ee5\u53ca I/O \u548c\u6d4b\u8bd5\u6240\u9700\u7684\u7c7b\u3002\u8981\u6784\u5efa\u548c\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 \u5b8c\u6210\u6240\u6709\u8bbe\u7f6e\u540e\uff0c\u8bf7\u5c1d\u8bd5\u6309\u7167\u6240\u9009\u8bed\u8a00\u7684 \u6559\u7a0b \u8fdb\u884c\u64cd\u4f5c,\u8fd9\u5c06\u6307\u5bfc\u4f60\u521b\u5efa\u4e00\u4e2a\u4f7f\u7528 protocol buffers \u7684\u7b80\u5355\u5e94\u7528\u7a0b\u5e8f\u3002","title":"\u5982\u4f55\u5f00\u59cb\u4f7f\u7528"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#proto3","text":"\u6700\u65b0\u7684\u7248\u672c3 \u53d1\u5e03 \u4e86\u4e00\u4e2a\u65b0\u7684\u8bed\u8a00\u7248\u672c\uff1a Protocol Buffers\u8bed\u8a00\u7248\u672c3 \uff08\u7b80\u79f0 proto3 \uff09\uff0c\u4ee5\u53ca\u73b0\u6709\u8bed\u8a00\u7248\u672c\uff08\u7b80\u79f0 proto2 \uff09\u4e2d\u7684\u4e00\u4e9b\u65b0\u529f\u80fd\u3002 Proto3 \u7b80\u5316\u4e86 protocol buffers \u8bed\u8a00\uff0c\u65e2\u6613\u4e8e\u4f7f\u7528\uff0c\u53c8\u53ef\u4ee5\u5728\u66f4\u5e7f\u6cdb\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\uff1a\u5f53\u524d\u7684\u7248\u672c\u5141\u8bb8\u4f7f\u7528 Java \uff0c C++ \uff0c Python \uff0c Java Lite \uff0c Ruby \uff0c JavaScript \uff0c Objective \u548c C\uff03 \u6765\u751f\u6210 protocol buffers \u4ee3\u7801\u3002\u6b64\u5916\uff0c\u53ef\u4ee5\u4f7f\u7528\u6700\u65b0\u7684 Go protoc \u63d2\u4ef6\u4e3aGo\u751f\u6210 proto3 \u4ee3\u7801\uff0c\u8be5\u63d2\u4ef6\u53ef\u4ece golang/protobuf Github\u5b58\u50a8\u5e93\u83b7\u5f97\u3002\u66f4\u591a\u7684\u8bed\u8a00\u6b63\u5728\u7b79\u5907\u4e2d\u3002 \u8bf7\u6ce8\u610f\uff0c\u4e24\u79cd\u8bed\u8a00\u7248\u672c\u7684API\u4e0d\u5b8c\u5168\u517c\u5bb9\u3002\u4e3a\u907f\u514d\u7ed9\u73b0\u6709\u7528\u6237\u5e26\u6765\u4e0d\u4fbf\uff0c\u5c06\u7ee7\u7eed\u5728\u65b0 protocol buffers \u7248\u672c\u4e2d\u652f\u6301\u4ee5\u524d\u7684\u8bed\u8a00\u7248\u672c\u3002 \u53ef\u4ee5\u5728 \u53d1\u884c\u8bf4\u660e \u4e2d\u770b\u5230\u4e0e\u5f53\u524d\u9ed8\u8ba4\u7248\u672c\u7684\u4e3b\u8981\u5dee\u5f02\uff0c\u5e76\u4e86\u89e3 Proto3 \u8bed\u8a00\u6307\u5357\u4e2d\u7684 proto3 \u8bed\u6cd5\u3002proto3\u7684\u5b8c\u6574\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff01 \uff08\u5982\u679c\u540d\u79f0 proto2 \u548c proto3 \u770b\u8d77\u6765\u6709\u70b9\u4ee4\u4eba\u56f0\u60d1\uff0c\u90a3\u662f\u56e0\u4e3a\u6700\u521d\u5f00\u6e90 protocol buffers \u65f6\uff0c\u5b83\u5b9e\u9645\u4e0a\u662fGoogle\u7684\u7b2c\u4e8c\u7248\u8bed\u8a00\uff0c\u4e5f\u79f0\u4e3a proto2 \u3002\u8fd9\u4e5f\u5f00\u6e90\u7248\u672c\u53f7\u4ecev2\u5f00\u59cb\u7684\u539f\u56e0\u3002","title":"proto3\u7b80\u4ecb"},{"location":"Frameworks/Protocol-Buffers/01-\u7b80\u4ecb/#_2","text":"protocol buffers \u6700\u521d\u662f\u5728Google\u5f00\u53d1\u7684\uff0c\u7528\u4e8e\u5904\u7406\u7d22\u5f15\u670d\u52a1\u5668\u8bf7\u6c42/\u54cd\u5e94\u534f\u8bae\u3002\u5728 protocol buffers \u4e4b\u524d\uff0c\u6709\u4e00\u79cd\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u683c\u5f0f\uff0c\u5b83\u4f7f\u7528\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u624b\u52a8\u7f16\u7ec4/\u89e3\u7ec4\uff0c\u5e76\u652f\u6301\u8bb8\u591a\u7248\u672c\u7684\u534f\u8bae\u3002 \u8fd9\u5bfc\u81f4\u4e00\u4e9b\u975e\u5e38\u4e11\u964b\u7684\u4ee3\u7801\uff0c\u5982\uff1a if (version == 3) { ... } else if (version 4) { if (version == 5) { ... } ... } \u660e\u786e\u683c\u5f0f\u5316\u7684\u534f\u8bae\u4e5f\u4f7f\u65b0\u534f\u8bae\u7248\u672c\u7684\u63a8\u51fa\u53d8\u5f97\u590d\u6742\uff0c\u56e0\u4e3a\u5f00\u53d1\u4eba\u5458\u5fc5\u987b\u786e\u4fdd\u8bf7\u6c42\u7684\u53d1\u8d77\u8005\u548c\u5904\u7406\u8bf7\u6c42\u7684\u5b9e\u9645\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u6240\u6709\u670d\u52a1\u5668\u90fd\u80fd\u7406\u89e3\u65b0\u534f\u8bae\uff0c\u7136\u540e\u624d\u80fd\u5207\u6362\u4ee5\u5f00\u59cb\u4f7f\u7528\u65b0\u534f\u8bae\u3002 protocol buffers \u5f00\u53d1\u7528\u4e8e\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\uff1a \u53ef\u4ee5\u8f7b\u677e\u5f15\u5165\u65b0\u5b57\u6bb5\uff0c\u800c\u4e2d\u95f4\u670d\u52a1\u5668\u4e0d\u9700\u8981\u68c0\u67e5\u6570\u636e\u5c31\u53ef\u4ee5\u7b80\u5355\u5730\u89e3\u6790\u5b83\u5e76\u4f20\u9012\u6570\u636e\u800c\u65e0\u9700\u4e86\u89e3\u6240\u6709\u5b57\u6bb5\u3002 \u683c\u5f0f\u66f4\u5177\u81ea\u6211\u63cf\u8ff0\u6027\uff0c\u53ef\u4ee5\u7528\u5404\u79cd\u8bed\u8a00\uff08C++\uff0cJava\u7b49\uff09\u5904\u7406\u3002 \u4f46\u662f\uff0c\u7528\u6237\u4ecd\u7136\u9700\u8981\u81ea\u5df1\u624b\u5199\u89e3\u6790\u4ee3\u7801\u3002 \u968f\u7740\u7cfb\u7edf\u7684\u53d1\u5c55\uff0c\u5b83\u83b7\u5f97\u4e86\u8bb8\u591a\u5176\u4ed6\u529f\u80fd\u548c\u7528\u9014\uff1a \u81ea\u52a8\u751f\u6210\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u4ee3\u7801\u907f\u514d\u4e86\u624b\u52a8\u89e3\u6790\u7684\u9700\u8981\u3002 \u9664\u4e86\u7528\u4e8e\u77ed\u751f\u547d\u5468\u671f\u7684RPC\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff09\u8bf7\u6c42\u4e4b\u5916\uff0c\u5927\u5bb6\u5df2\u7ecf\u5f00\u59cb\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u4e00\u79cd\u65b9\u4fbf\u7684\u81ea\u63cf\u8ff0\u683c\u5f0f\u7528\u4e8e\u6301\u4e45\u5b58\u50a8\u6570\u636e\uff08\u4f8b\u5982\uff0c\u5728 Bigtable \u4e2d\uff09\u3002 \u9996\u5148\u670d\u52a1\u7684RPC\u63a5\u53e3\u88ab\u58f0\u660e\u4e3a protocol \u6587\u4ef6\u7684\u4e00\u90e8\u5206\uff0c\u7136\u540e\u4f7f\u7528 protocol \u7f16\u8bd1\u5668\u751f\u6210 stub \u7c7b\uff0c\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u670d\u52a1\u63a5\u53e3\u7684\u5b9e\u9645\u5b9e\u73b0\u6765\u8986\u76d6\u8fd9\u4e9b stub \u7c7b\u3002 \u73b0\u5728 protocol buffers \u662fGoogle\u7684\u6570\u636e\u901a\u7528\u8bed\u8a00\uff0c\u5728\u64b0\u5199\u672c\u6587\u65f6\uff0cGoogle\u4ee3\u7801\u6811\u4e2d\u5b9a\u4e49\u4e86306,747\u79cd\u4e0d\u540c\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u8de8348,952\u4e2a .proto \u6587\u4ef6\u3002\u5b83\u4eec\u65e2\u53ef\u7528\u4e8eRPC\u7cfb\u7edf\uff0c\u4e5f\u53ef\u7528\u4e8e\u5404\u79cd\u5b58\u50a8\u7cfb\u7edf\u4e2d\u7684\u6570\u636e\u6301\u4e45\u5b58\u50a8\u3002","title":"\u4e00\u70b9\u5c0f\u5386\u53f2"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/","text":"proto3 \u6307\u5357 \u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 protocol buffers \u8bed\u8a00\u6784\u5efa protocol buffers \u6570\u636e\uff0c\u5305\u62ec\uff1a .proto \u6587\u4ef6\u8bed\u6cd5 \u5982\u4f55\u4ece .proto \u6587\u4ef6\u751f\u6210\u6570\u636e\u8bbf\u95ee\u7c7b \u5b83\u6db5\u76d6\u4e86 protocol buffers \u8bed\u8a00\u7684 proto3 \u7248\u672c\uff1a\u6709\u5173\u8f83\u65e9\u7684 proto2 \u8bed\u6cd5\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Proto2 \u8bed\u8a00\u6307\u5357 \u3002 \u8fd9\u662f\u4e00\u4e2a\u53c2\u8003\u6307\u5357\uff0c\u5bf9\u4e8e\u4f7f\u7528\u672c\u6587\u6863\u4e2d\u63cf\u8ff0\u7684\u8bb8\u591a\u529f\u80fd\u7684\u5206\u6b65\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u6559\u7a0b \uff08\u76ee\u524d\u4ec5\u9650 proto 2;\u66f4\u591a proto3 \u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002 \u5b9a\u4e49\u6d88\u606f\u7c7b\u578b \u9996\u5148\u770b\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4f8b\u5b50\u3002\u5047\u8bbe\u8981\u5b9a\u4e49\u641c\u7d22\u8bf7\u6c42\u6d88\u606f\u683c\u5f0f\uff0c\u5176\u4e2d\u6bcf\u4e2a\u641c\u7d22\u8bf7\u6c42\u90fd\u6709\uff1a \u4e00\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u67e5\u8be2 \u6240\u67e5\u8be2\u7684\u7279\u5b9a\u9875\u7801 \u6bcf\u9875\u8fd4\u56de\u7684\u7ed3\u679c\u6570 \u8fd9\u662f\u7528\u4e8e\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u7684 .proto \u6587\u4ef6\u3002 syntax = proto3 ; // \u6307\u5b9a\u6b63\u5728\u4f7f\u7528proto3\u8bed\u6cd5\uff0c\u9ed8\u8ba4\u8ba4\u4e3a\u4f7f\u7528proto2\uff0c\u5fc5\u987b\u662f\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u6ce8\u91ca\u884c message SearchRequest { // \u6d88\u606f\u683c\u5f0f\u4ee5\u540d\u79f0-\u503c\u5bf9\u7684\u5f62\u5f0f\u6307\u5b9a\u4e09\u4e2a\u5b57\u6bb5 string query = 1; // \u6bcf\u4e2a\u5b57\u6bb5\u6709\u4e00\u4e2a\u540d\u79f0\u548c\u7c7b\u578b int32 page_number = 2; int32 result_per_page = 3; } \u6307\u5b9a\u5b57\u6bb5\u7c7b\u578b \u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u7684\u5b57\u6bb5\u90fd\u662f \u6807\u91cf\u7c7b\u578b \uff1a\u4e24\u4e2a\u6574\u578b\u4e00\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u3002\u540c\u65f6\u4e5f\u53ef\u4ee5\u7ed9\u5b57\u6bb5\u6307\u5b9a\u7ec4\u5408\u7c7b\u578b\uff08\u5305\u62ec \u679a\u4e3e \u6216\u5176\u4ed6\u7c7b\u578b\uff09\u3002 \u5206\u914d\u5b57\u6bb5\u7f16\u53f7 \u5982\u4e0a\u6240\u793a\uff0c\u6d88\u606f\u5b9a\u4e49\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u5b9a\u4e49\u4e00\u4e2a \u552f\u4e00\u7684\u7f16\u53f7 \u3002\u8fd9\u4e9b\u5b57\u6bb5\u7684\u7f16\u53f7\u7528\u4e8e\u5728\u6d88\u606f\u7684 \u4e8c\u8fdb\u5236\u683c\u5f0f \u4e2d\u6807\u8bc6\u5b57\u6bb5\uff0c\u4e00\u65e6\u6d88\u606f\u7c7b\u578b\u88ab\u4f7f\u7528\u5c31\u4e0d\u80fd\u518d\u66f4\u6539\u3002\u8bf7\u6ce8\u610f\uff1a 1\u523015 \u8303\u56f4\u5185\u7684\u5b57\u6bb5\u7f16\u53f7\u9700\u8981\u4e00\u4e2a\u5b57\u8282\u8fdb\u884c\u7f16\u7801\uff0c\u5305\u62ec\u5b57\u6bb5\u7684\u7f16\u53f7\u548c\u5b57\u6bb5\u7684\u7c7b\u578b\uff08\u53ef\u4ee5\u5728 protocol buffers \u7f16\u7801 \u4e2d\u627e\u5230\u66f4\u591a\u76f8\u5173\u4fe1\u606f\uff09 16\u52302047 \u8303\u56f4\u5185\u7684\u5b57\u6bb5\u7f16\u53f7\u5360\u7528\u4e24\u4e2a\u5b57\u8282\u3002 \u56e0\u6b64\uff0c\u5e94\u8be5\u4e3a\u975e\u5e38\u9891\u7e41\u51fa\u73b0\u7684\u6d88\u606f\u5143\u7d20\u4fdd\u7559\u6570\u5b571\u523015\uff0c\u8bf7\u8bb0\u4f4f\u4e3a\u5c06\u6765\u53ef\u80fd\u6dfb\u52a0\u7684\u9891\u7e41\u51fa\u73b0\u7684\u5143\u7d20\u7559\u51fa\u4e00\u4e9b\u7a7a\u95f4 \u53ef\u4ee5\u6307\u5b9a\u7684\u6700\u5c0f\u5b57\u6bb5\u6570\u4e3a1\uff0c\u6700\u5927\u5b57\u6bb5\u6570\u4e3a536,870,911\uff082\u768429\u6b21\u65b9-1\uff09\u3002 \u4e0d\u80fd\u4f7f\u7528\u6570\u5b5719000\u523019999\uff08 FieldDescriptor::kFirstReservedNumber \u5230 FieldDescriptor::kLastReservedNumber \uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u4e3a protocol buffers \u5b9e\u73b0\u800c\u4fdd\u7559\u7684\u3002 \u5982\u679c\u5728 .proto \u4e2d\u4f7f\u7528\u8fd9\u4e9b\u4fdd\u7559\u6570\u5b57\u4e4b\u4e00\uff0c protocol buffers \u7f16\u8bd1\u5668\u4f1a\u53d1\u51fa\u8b66\u544a\u3002\u540c\u6837\uff0c\u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u4ee5\u524d \u4fdd\u7559 \u7684\u5b57\u6bb5\u7f16\u53f7\u3002 \u81ea\u5b9a\u5b57\u6bb5\u89c4\u5219 \u6d88\u606f\u7684\u5b57\u6bb5\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e4b\u4e00\uff1a \u5355\u6570\uff1a\u683c\u5f0f\u826f\u597d\u7684\u6d88\u606f\u53ef\u4ee5\u5305\u542b\u96f6\u4e2a\u6216\u4e00\u4e2a\uff08\u4f46\u4e0d\u8d85\u8fc7\u4e00\u4e2a\uff09\u8fd9\u6837\u7684\u5b57\u6bb5\u3002\u8fd9\u662f proto3 \u8bed\u6cd5\u7684\u9ed8\u8ba4\u5b57\u6bb5\u89c4\u5219\u3002 \u91cd\u590d\uff1a\u8be5\u5b57\u6bb5\u53ef\u4ee5\u5728\u683c\u5f0f\u826f\u597d\u7684\u6d88\u606f\u4e2d\u91cd\u590d\u4efb\u610f\u6b21\u6570\uff08\u5305\u62ec\u96f6\uff09\u3002\u5c06\u4fdd\u7559\u91cd\u590d\u503c\u7684\u987a\u5e8f\u3002 \u5728 proto3 \u4e2d\uff0c\u6807\u91cf\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\u9ed8\u8ba4\u4f7f\u7528 \u538b\u7f29 \u7f16\u7801\u3002 \u5728 Protocol Buffer Encoding \u4e2d\u627e\u5230\u6709\u5173\u538b\u7f29\u7f16\u7801\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u6dfb\u52a0\u66f4\u591a\u6d88\u606f\u7c7b\u578b \u53ef\u4ee5\u5728\u5355\u4e2a .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u591a\u79cd\u6d88\u606f\u7c7b\u578b\u3002\u5982\u679c\u8981\u5b9a\u4e49\u591a\u4e2a\u76f8\u5173\u6d88\u606f\uff0c\u8fd9\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u5b9a\u4e49\u4e0e SearchResponse \u6d88\u606f\u7c7b\u578b\u5bf9\u5e94\u7684\u56de\u590d\u6d88\u606f\u683c\u5f0f\uff0c\u5219\u53ef\u4ee5\u5c06\u5176\u6dfb\u52a0\u5230\u76f8\u540c\u7684 .proto \uff1a message SearchRequest { string query = 1; int32 page_number = 2; int32 result_per_page = 3; } message SearchResponse { ... } \u6dfb\u52a0\u6ce8\u91ca \u8981\u4e3a .proto \u6587\u4ef6\u6dfb\u52a0\u6ce8\u91ca\uff0c\u8bf7\u4f7f\u7528 C/C++ \u6837\u5f0f // \u548c /* ... */ \u8bed\u6cd5\u3002 /* SearchRequest \u4ee3\u8868\u4e00\u4e2a\u67e5\u8be2\u8bf7\u6c42, * \u5e26\u6709\u5206\u9875\u9009\u9879\u4ee5\u6307\u793a\u8981\u5305\u542b\u5728\u54cd\u5e94\u4e2d\u7684\u7ed3\u679c\u3002*/ message SearchRequest { string query = 1; int32 page_number = 2; // \u6211\u4eec\u9700\u8981\u7684\u9875\u7801 int32 result_per_page = 3; // \u6bcf\u9875\u8fd4\u56de\u7684\u7ed3\u679c\u6570 } \u4fdd\u7559\u5b57\u6bb5 \u5982\u679c\u901a\u8fc7\u5b8c\u5168\u5220\u9664\u5b57\u6bb5\u6216\u5c06\u5176\u6ce8\u91ca\u6765 \u66f4\u65b0 \u6d88\u606f\u7c7b\u578b\uff0c\u672a\u6765\u7684\u7528\u6237\u53ef\u4ee5\u5728\u5bf9\u7c7b\u578b\u8fdb\u884c\u66f4\u65b0\u65f6\u518d\u6b21\u4f7f\u7528\u8be5\u5b57\u6bb5\u7f16\u53f7\u3002\u5982\u679c\u4ee5\u540e\u52a0\u8f7d\u76f8\u540c .proto \u6587\u4ef6\u7684\u65e7\u7248\u672c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u95ee\u9898\uff0c\u5305\u62ec\u6570\u636e\u635f\u574f\uff0c\u9690\u79c1\u9519\u8bef\u7b49\u3002\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd\u65b9\u6cd5\u662f \u6307\u5b9a\u5df2\u5220\u9664\u5b57\u6bb5\u6216\u5b57\u6bb5\u7684\u7f16\u53f7\u4e3a\u4fdd\u7559\u7684 \uff08\u5e76\u4e14/\u6216\u547d\u540d\u53ef\u80fd\u5bfc\u81f4JSON\u5e8f\u5217\u5316\u95ee\u9898\uff09\u3002\u5982\u679c\u5c06\u6765\u7684\u4efb\u4f55\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e9b\u5b57\u6bb5\u6807\u8bc6\u7b26\uff0c protocol buffers \u7f16\u8bd1\u5668\u5c06\u4f1a\u53d1\u51fa\u8b66\u544a\u3002 message Foo { reserved 2, 15, 9 to 11; reserved foo , bar ; } \u8bf7\u6ce8\u610f\uff0c\u4e0d\u80fd\u5728\u540c\u4e00\u4fdd\u7559\u8bed\u53e5\u4e2d\u6df7\u5408\u5b57\u6bb5\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002 .proto \u6587\u4ef6\u5c06\u751f\u6210\u4ec0\u4e48 \u5728 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 \u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u6839\u636e\u6587\u4ef6\u4e2d\u7684\u63cf\u8ff0\u751f\u6210\u6240\u9009\u8bed\u8a00\u7684\u4ee3\u7801\uff0c\u8fd9\u4e9b\u4ee3\u7801\u662f\u9700\u8981\u4f7f\u7528\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u5305\u62ec\uff1a\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c\uff0c\u5c06\u6d88\u606f\u5e8f\u5217\u5316\u4e3a\u8f93\u51fa\u6d41\uff0c\u5e76\u4ece\u8f93\u5165\u6d41\u4e2d\u89e3\u6790\u6d88\u606f\u3002 \u5bf9\u4e8e C++ \uff0c\u7f16\u8bd1\u5668\u4f1a\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a .h \u548c .cc \u6587\u4ef6\uff0c\u5e76\u4e3a\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u63d0\u4f9b\u4e00\u4e2a\u7c7b\u3002 \u5bf9\u4e8e Java \uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a .java \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\uff0c\u4ee5\u53ca\u7528\u4e8e\u521b\u5efa\u6d88\u606f\u7c7b\u5b9e\u4f8b\u7684\u7279\u6b8a Builder \u7c7b\u3002 Python \u6709\u70b9\u4e0d\u540c\uff1a Python \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u6a21\u5757\uff0c\u5176\u4e2d\u5305\u542b .proto \u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u9759\u6001\u63cf\u8ff0\u7b26\uff0c\u7136\u540e\u4e0e\u5143\u7c7b\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u5fc5\u8981\u7684 Python \u6570\u636e\u8bbf\u95ee\u7c7b\u3002 \u5bf9\u4e8e Go \uff0c\u7f16\u8bd1\u5668\u4f1a\u751f\u6210\u4e00\u4e2a .pb.go \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u578b\u3002 \u5bf9\u4e8e Ruby \uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u5305\u542b\u6d88\u606f\u7c7b\u578b\u7684 Ruby \u6a21\u5757\u7684 .rb \u6587\u4ef6\u3002 \u5bf9\u4e8e Objective-C \uff0c\u7f16\u8bd1\u5668\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a pbobjc.h \u548c pbobjc.m \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u5bf9\u4e8e C\uff03 \uff0c\u7f16\u8bd1\u5668\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a .cs \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u5bf9\u4e8e Dart \uff0c\u7f16\u8bd1\u5668\u4f1a\u751f\u6210\u4e00\u4e2a .pb.dart \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u53ef\u4ee5\u6309\u7167\u6240\u9009\u8bed\u8a00\u7684\u6559\u7a0b\uff08\u5373\u5c06\u63a8\u51fa\u7684proto3\u7248\u672c\uff09\u4e86\u89e3\u6709\u5173\u4e3a\u6bcf\u79cd\u8bed\u8a00\u4f7f\u7528API\u200b\u200b\u7684\u66f4\u591a\u4fe1\u606f\u3002\u6709\u5173\u66f4\u591aAPI\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u76f8\u5173 API\u53c2\u8003 \uff08proto3\u7248\u672c\u5373\u5c06\u63a8\u51fa\uff09\u3002 \u6807\u91cf\u503c\u7c7b\u578b \u6807\u91cf\u6d88\u606f\u5b57\u6bb5\u53ef\u4ee5\u5177\u6709\u4ee5\u4e0b\u7c7b\u578b\u4e4b\u4e00\uff1a\u8be5\u8868\u663e\u793a .proto \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7c7b\u578b\uff0c\u4ee5\u53ca\u81ea\u52a8\u751f\u6210\u7684\u7c7b\u4e2d\u7684\u76f8\u5e94\u7c7b\u578b\uff1a .proto \u7c7b\u578b \u6ce8\u91ca Go\u7c7b\u578b double float64 float float32 int32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u7f16\u7801\u8d1f\u6570\u7684\u6548\u7387\u4f4e\uff08\u5982\u679c\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u6539\u7528sint32\uff09 int32 int64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u7f16\u7801\u8d1f\u6570\u7684\u6548\u7387\u4f4e\uff08\u5982\u679c\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u6539\u7528sint64\uff09 int64 uint32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801 uint32 uint64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801 uint64 sint32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u6709\u7b26\u53f7int\u503c\uff08\u8fd9\u6bd4\u5e38\u89c4int32\u66f4\u6709\u6548\u5730\u7f16\u7801\u8d1f\u6570\uff09 int32 sint64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u6709\u7b26\u53f7int\u503c\uff08\u8fd9\u6bd4\u5e38\u89c4int64\u66f4\u6709\u6548\u5730\u7f16\u7801\u8d1f\u6570\uff09 int64 fixed32 \u603b\u662f\u56db\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u503c\u5927\u4e8e2\u768428\u6b21\u65b9\u5219\u6bd4uint32\u66f4\u6709\u6548 uint32 fixed64 \u603b\u662f\u516b\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u503c\u5927\u4e8e2\u768456\u6b21\u65b9\u5219\u6bd4uint32\u66f4\u6709\u6548 uint64 sfixed32 \u603b\u662f\u56db\u4e2a\u5b57\u8282 int32 sfixed64 \u603b\u662f\u516b\u4e2a\u5b57\u8282 int64 bool bool string \u5b57\u7b26\u4e32\u5fc5\u987b\u59cb\u7ec8\u5305\u542bUTF-8\u7f16\u7801\u62167\u4f4dASCII\u6587\u672c\uff0c\u4e14\u4e0d\u80fd\u8d85\u8fc72\u768432\u6b21\u65b9 string bytes \u53ef\u4ee5\u5305\u542b\u4e0d\u8d85\u8fc72\u768432\u6b21\u65b9\u7684\u4efb\u610f\u5b57\u8282\u5e8f\u5217 []bytes \u5728 protocol buffers \u7f16\u7801 \u4e2d\u53ef\u4ee5\u627e\u5230\u66f4\u591a\u5173\u4e8e\u5728\u5e8f\u5217\u5316\u6d88\u606f\u65f6\u8fd9\u4e9b\u7c7b\u578b\u662f\u5982\u4f55\u88ab\u7f16\u7801\u7684\u4fe1\u606f\u3002 \u9ed8\u8ba4\u503c \u5728\u89e3\u6790\u6d88\u606f\u65f6\uff0c\u5982\u679c\u7f16\u7801\u6d88\u606f\u4e0d\u5305\u542b\u67d0\u4e2a\u7279\u5b9a\u7684\u5355\u6570\u5143\u7d20\uff0c\u5219\u89e3\u6790\u5bf9\u8c61\u4e2d\u76f8\u5e94\u7684\u5b57\u6bb5\u5c06\u88ab\u8bbe\u7f6e\u4e3a\u8be5\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\u8fd9\u4e9b\u9ed8\u8ba4\u503c\u6839\u636e\u7c7b\u578b\u800c\u4e0d\u540c\uff1a \u5bf9\u4e8e\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 \u5bf9\u4e8e\u5b57\u8282\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u8282\u3002 \u5bf9\u4e8e\u5e03\u5c14\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002 \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a\u96f6\u3002 \u5bf9\u4e8e \u679a\u4e3e \uff0c\u9ed8\u8ba4\u503c\u662f \u7b2c\u4e00\u4e2a\u5b9a\u4e49\u7684\u679a\u4e3e\u503c \uff0c\u8be5\u503c\u5fc5\u987b\u4e3a0\u3002 \u5bf9\u4e8e\u6d88\u606f\u5b57\u6bb5\uff0c\u672a\u8bbe\u7f6e\u8be5\u5b57\u6bb5\u3002\u5b83\u7684\u786e\u5207\u503c\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002 \u91cd\u590d\uff08repeated\uff09\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3a\u7a7a\uff08\u901a\u5e38\u662f\u76f8\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684\u7a7a\u5217\u8868\uff09\u3002 \u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e \u6807\u91cf\u6d88\u606f\u5b57\u6bb5 \uff0c\u4e00\u65e6\u89e3\u6790\u4e86\u6d88\u606f\uff0c\u5c31\u65e0\u6cd5\u786e\u5b9a\u5b57\u6bb5\u662f\u5426\u663e\u5f0f\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\uff08\u4f8b\u5982\uff0c\u5e03\u5c14\u503c\u662f\u5426\u8bbe\u7f6e\u4e3a false \uff09\u6216\u6839\u672c\u6ca1\u6709\u8bbe\u7f6e\u503c\uff0c\u56e0\u6b64\uff0c\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u65f6\u8981\u6ce8\u610f\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e0d\u5e0c\u671b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u53d1\u751f\u8fd9\u79cd\u884c\u4e3a\uff0c\u90a3\u4e48\u5f53\u8bbe\u7f6e\u4e3a false \u65f6\uff0c\u6ca1\u6709\u4e00\u4e2a\u5e03\u5c14\u503c\u53ef\u4ee5\u6253\u5f00\u67d0\u4e9b\u884c\u4e3a\u3002\u53e6\u5916\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u6807\u91cf\u6d88\u606f\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u5176\u9ed8\u8ba4\u503c\uff0c\u5219\u8be5\u503c\u4e0d\u4f1a\u5728\u4f20\u8f93\u65f6\u5e8f\u5217\u5316\u3002 \u6709\u5173\u9ed8\u8ba4\u503c\u5982\u4f55\u5728\u751f\u6210\u7684\u4ee3\u7801\u4e2d\u5de5\u4f5c\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002 \u679a\u4e3e \u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u65f6\uff0c\u53ef\u80fd\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u53ea\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u503c\u5217\u8868\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u8981\u4e3a\u6bcf\u4e2a SearchRequest \u6dfb\u52a0\u8bed\u6599\u5e93\uff08 corups \uff09\u5b57\u6bb5\uff0c\u5176\u4e2d\u8bed\u6599\u5e93\u53ef\u4ee5\u662f UNIVERSAL \uff0c WEB \uff0c IMAGES \uff0c LOCAL \uff0c NEWS \uff0c PRODUCTS \u6216 VIDEO \u3002\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u5730\u901a\u8fc7\u5411\u6d88\u606f\u5b9a\u4e49\u6dfb\u52a0\u679a\u4e3e\uff08 enum \uff09\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u53ef\u80fd\u7684\u503c\u6dfb\u52a0\u5e38\u91cf\u3002 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a\u540d\u4e3a Corpus \u7684\u679a\u4e3e\uff0c\u5176\u4e2d\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684\u503c\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7c7b\u578b\u4e3aCorpus\u7684\u5b57\u6bb5\uff1a message SearchRequest { string query = 1; int32 page_number = 2; int32 result_per_page = 3; enum Corpus { UNIVERSAL = 0; WEB = 1; IMAGES = 2; LOCAL = 3; NEWS = 4; PRODUCTS = 5; VIDEO = 6; } Corpus corpus = 4; } \u5982\u4e0a\u6240\u793a\uff0c Corpus \u679a\u4e3e\u7684\u7b2c\u4e00\u4e2a\u5e38\u91cf\u6620\u5c04\u4e3a\u96f6\uff1a\u6bcf\u4e2a\u679a\u4e3e\u5b9a\u4e49 \u5fc5\u987b \u5305\u542b\u4e00\u4e2a\u6620\u5c04\u5230\u96f6\u7684\u5e38\u91cf\u4f5c\u4e3a\u5176\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u662f\u56e0\u4e3a\uff1a \u5fc5\u987b\u6709\u4e00\u4e2a\u96f6\u503c\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u4f7f\u75280\u4f5c\u4e3a\u6570\u5b57 \u9ed8\u8ba4\u503c \u3002 \u96f6\u503c\u5fc5\u987b\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u4ee5\u4fbf\u4e0e proto2 \u8bed\u4e49\u517c\u5bb9\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u679a\u4e3e\u503c\u59cb\u7ec8\u662f\u9ed8\u8ba4\u503c\u3002 \u53ef\u4ee5\u901a\u8fc7\u4e3a\u4e0d\u540c\u7684\u679a\u4e3e\u5e38\u91cf\u6307\u5b9a\u76f8\u540c\u7684\u503c\u6765\u5b9a\u4e49\u522b\u540d\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u5c06 allow_alias \u9009\u9879\u8bbe\u7f6e\u4e3a true \uff0c\u5426\u5219 proto \u7f16\u8bd1\u5668\u5c06\u5728\u627e\u5230\u522b\u540d\u65f6\u751f\u6210\u9519\u8bef\u6d88\u606f\u3002 enum EnumAllowingAlias { option allow_alias = true; // \u5f00\u542f\u914d\u7f6e UNKNOWN = 0; STARTED = 1; RUNNING = 1; } enum EnumNotAllowingAlias { UNKNOWN = 0; STARTED = 1; // RUNNING = 1; // \u53d6\u6d88\u6ce8\u91ca\u6b64\u884c\u5c06\u5bfc\u81f4Google\u5185\u90e8\u7684\u7f16\u8bd1\u9519\u8bef\u548c\u5916\u90e8\u7684\u8b66\u544a\u6d88\u606f\u3002 } \u679a\u4e3e\u5e38\u91cf\u5fc5\u987b\u572832\u4f4d\u6574\u6570\u8303\u56f4\u5185\u3002\u7531\u4e8e\u679a\u4e3e\u503c\u5728\u4f20\u8f93\u65f6\u4f7f\u7528 varint \u7f16\u7801 \uff0c\u56e0\u6b64\uff0c\u8d1f\u503c\u6548\u7387\u4f4e\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002\u53ef\u4ee5\u5728\u6d88\u606f\u5b9a\u4e49\u4e2d\u5b9a\u4e49\u679a\u4e3e\uff0c\u5982\u4e0a\u4f8b\u6240\u793a\uff0c\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u5b9a\u4e49\u679a\u4e3e\uff0c\u8fd9\u4e9b\u679a\u4e3e\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u7684\u4efb\u4f55\u6d88\u606f\u5b9a\u4e49\u4e2d\u91cd\u7528\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5 MessageType.EnumType \u5c06\u4e00\u4e2a\u6d88\u606f\u4e2d\u58f0\u660e\u7684\u679a\u4e3e\u7c7b\u578b\u7528\u4f5c\u4e0d\u540c\u6d88\u606f\u4e2d\u5b57\u6bb5\u7684\u7c7b\u578b\u3002 \u5728\u4f7f\u7528\u679a\u4e3e\u7684 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668\u65f6\uff0c\u751f\u6210\u7684\u4ee3\u7801\u5c06\u5177\u6709\u76f8\u5e94\u7684 Java \u6216 C++ \u679a\u4e3e\u7c7b\u578b\uff0c\u5728Python\u4e2d\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684 EnumDescriptor \u7c7b\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u751f\u6210\u7c7b\u4e2d\u521b\u5efa\u4e00\u7ec4\u5e26\u6709\u6574\u6570\u503c\u7684\u7b26\u53f7\u5e38\u91cf\u3002 \u5728\u53cd\u5e8f\u5217\u5316\u671f\u95f4\uff0c\u65e0\u6cd5\u8bc6\u522b\u7684\u679a\u4e3e\u503c\u5c06\u4fdd\u7559\u5728\u6d88\u606f\u4e2d\uff0c\u5982\u4f55\u8868\u793a\u8fd9\u79cd\u503c\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u7f16\u7a0b\u8bed\u8a00\u3002 \u5728\u652f\u6301\u5177\u6709\u8d85\u51fa\u6307\u5b9a\u7b26\u53f7\u8303\u56f4\u7684\u503c\u7684\u5f00\u653e\u679a\u4e3e\u7c7b\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff08\u4f8b\u5982 C++ \u548c Go \uff09\uff0c\u672a\u77e5\u7684\u679a\u4e3e\u503c\u4ec5\u4f5c\u4e3a\u5176\u57fa\u7840\u6574\u6570\u8868\u793a\u5b58\u50a8\u3002 \u5728\u652f\u6301\u5c01\u95ed\u679a\u4e3e\u7c7b\u578b\uff08\u5982 Java \uff09\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u679a\u4e3e\u4e2d\u7684\u5927\u5c0f\u5199\u7528\u4e8e\u8868\u793a\u65e0\u6cd5\u8bc6\u522b\u7684\u503c\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u7279\u6b8a\u8bbf\u95ee\u5668\u8bbf\u95ee\u57fa\u7840\u6574\u6570\u3002 \u5728\u4efb\u4f55\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6d88\u606f\u88ab\u5e8f\u5217\u5316\u4e86\uff0c\u90a3\u4e48\u65e0\u6cd5\u8bc6\u522b\u7684\u503c\u4ecd\u7136\u4f1a\u548c\u6d88\u606f\u4e00\u8d77\u88ab\u5e8f\u5217\u5316\u3002 \u6709\u5173\u5982\u4f55\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6d88\u606f\u679a\u4e3e\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002 \u4fdd\u7559\u503c \u5982\u679c\u901a\u8fc7\u5b8c\u5168\u5220\u9664\u679a\u4e3e\u6761\u76ee\u6216\u5c06\u5176\u6ce8\u91ca\u6389\u6765 \u66f4\u65b0 \u679a\u4e3e\u7c7b\u578b\uff0c\u90a3\u4e48\u672a\u6765\u7684\u7528\u6237\u53ef\u4ee5\u5728\u5bf9\u7c7b\u578b\u8fdb\u884c\u66f4\u65b0\u65f6\u91cd\u7528\u8be5\u6570\u503c\u3002\u5982\u679c\u540e\u9762\u53c8\u52a0\u8f7d\u76f8\u540c .proto \u6587\u4ef6\u7684\u65e7\u7248\u672c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u95ee\u9898\uff08\u5305\u62ec\u6570\u636e\u635f\u574f\uff0c\u9690\u79c1\u9519\u8bef\u7b49\uff09\u3002\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u8bbe\u7f6e\u5df2\u5220\u9664\u6761\u76ee\u7684\u6570\u503c\uff08\u548c / \u6216\u540d\u79f0\uff0c\u4e5f\u53ef\u80fd\u5bfc\u81f4JSON\u5e8f\u5217\u5316\u95ee\u9898\uff09\uff09\u4e3a reserved \u3002\u5982\u679c\u5c06\u6765\u7684\u4efb\u4f55\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bc6\u7b26\uff0c protocol buffers \u7f16\u8bd1\u5668\u5c06\u4f1a\u53d1\u51fa\u8b66\u544a\u3002\u53ef\u4ee5\u4f7f\u7528 max \u5173\u952e\u5b57\u6307\u5b9a\u4fdd\u7559\uff08 reserved \uff09\u7684\u6570\u503c\u8303\u56f4\u8fbe\u5230\u6700\u5927\u53ef\u80fd\u503c\u3002 enum Foo { reserved 2, 15, 9 to 11, 40 to max; reserved FOO , BAR ; } \u8bf7\u6ce8\u610f\uff0c\u4e0d\u80fd\u5728\u540c\u4e00\u4fdd\u7559\uff08 reserved \uff09\u8bed\u53e5\u4e2d\u6df7\u5408\u5b57\u6bb5\u540d\u79f0\u548c\u6570\u503c\u3002 \u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b \u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u5728\u6bcf\u4e2a SearchResponse \u6d88\u606f\u4e2d\u5305\u542b Result \u6d88\u606f\uff0c\u4e3a\u6b64\uff0c\u53ef\u4ee5\u5728\u540c\u4e00 .proto \u4e2d\u5b9a\u4e49 Result \u6d88\u606f\u7c7b\u578b\uff0c\u7136\u540e\u5728 SearchResponse \u4e2d\u6307\u5b9a Result \u7c7b\u578b\u7684\u5b57\u6bb5\uff1a message SearchResponse { repeated Result results = 1; } message Result { string url = 1; string title = 2; repeated string snippets = 3; } \u5bfc\u5165\u5b9a\u4e49 \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c Result \u6d88\u606f\u7c7b\u578b\u5728\u4e0e SearchResponse \u76f8\u540c\u7684\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u5982\u679c\u8981\u7528\u4f5c\u5b57\u6bb5\u7c7b\u578b\u7684\u6d88\u606f\u7c7b\u578b\u5728\u53e6\u4e00\u4e2a .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bfc\u5165\u6765\u4f7f\u7528\u5176\u4ed6 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002 \u8981\u5bfc\u5165\u53e6\u4e00\u4e2a .proto \u7684\u5b9a\u4e49\uff0c\u8bf7\u5728\u6587\u4ef6\u9876\u90e8\u6dfb\u52a0\u4e00\u4e2a import \u8bed\u53e5\uff1a import myproject/other_protos.proto ; \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u4f7f\u7528\u76f4\u63a5\u5bfc\u5165\u7684 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002\u4f46\u662f\uff0c\u6709\u65f6\u53ef\u80fd\u9700\u8981\u5c06 .proto \u6587\u4ef6\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002\u90a3\u4e48\uff0c\u53ef\u4ee5\u5728\u65e7\u4f4d\u7f6e\u653e\u7f6e\u4e00\u4e2a\u865a\u62df .proto \u6587\u4ef6\uff0c\u4ee5\u4f7f\u7528 import public \u5c06\u6240\u6709\u5bfc\u5165\u8f6c\u53d1\u5230\u65b0\u4f4d\u7f6e\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u79fb\u52a8 .proto \u6587\u4ef6\u5e76\u5728\u4e00\u6b21\u66f4\u6539\u4e2d\u66f4\u65b0\u6240\u6709\u5bfc\u5165\u5b83\u7684\u6587\u4ef6\u3002 import public \u7684\u4f9d\u8d56\u53ef\u4ee5\u88ab\u4efb\u4f55\u5305\u542b import public \u8bed\u53e5\u7684 proto \u6587\u4ef6\u4f20\u9012\u3002 \u4f8b\u5982\uff1a // new.proto // \u6240\u6709\u5b9a\u4e49\u90fd\u79fb\u52a8\u5230\u4e86\u8fd9\u91cc\u3002 // old.proto // \u8fd9\u662fproto\u6587\u4ef6\uff0c\u6240\u6709\u7684clients\u90fd\u5bfc\u5165\u4e86\u5b83\u3002 import public new.proto ; import other.proto ; // client.proto import old.proto ; // \u4f7f\u7528old.proto\u548cnew.proto\u4e2d\u7684\u5b9a\u4e49\uff0c\u4f46\u4e0d\u4f7f\u7528other.proto proto \u7f16\u8bd1\u5668\u4f7f\u7528 -I/--proto_path \u6807\u5fd7\u5728\u7f16\u8bd1\u5668\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u7684\u4e00\u7ec4\u76ee\u5f55\u4e2d\u641c\u7d22\u5bfc\u5165\u7684\u6587\u4ef6\u3002\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6807\u5fd7\uff0c\u5b83\u5c06\u67e5\u627e\u8c03\u7528\u7f16\u8bd1\u5668\u7684\u76ee\u5f55\u3002\u901a\u5e38\uff0c\u5e94\u5c06 --proto_path \u6807\u5fd7\u8bbe\u7f6e\u4e3a\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0c\u5e76\u5bf9\u6240\u6709\u5bfc\u5165\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002 \u4f7f\u7528 proto2 \u6d88\u606f\u7c7b\u578b \u53ef\u4ee5\u5bfc\u5165 proto2 \u6d88\u606f\u7c7b\u578b\u5e76\u5728 proto3 \u6d88\u606f\u4e2d\u4f7f\u7528\u5b83\u4eec\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u4f46\u662f\uff0c proto2 \u679a\u4e3e\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e proto3 \u8bed\u6cd5\uff08\u5982\u679c\u5df2\u5bfc\u5165\u7684 proto2 \u6d88\u606f\u4f7f\u7528\u5b83\u4eec\u5c31\u6ca1\u5173\u7cfb\uff09\u3002 \u5d4c\u5957\u7c7b\u578b \u53ef\u4ee5\u5728\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4e2d\u5b9a\u4e49\u548c\u4f7f\u7528\u6d88\u606f\u7c7b\u578b\uff0c\u5982\u4e0b\u4f8b\u6240\u793a\uff1a\u6b64\u5904 Result \u6d88\u606f\u5728 SearchResponse \u6d88\u606f\u4e2d\u5b9a\u4e49\uff1a message SearchResponse { message Result { string url = 1; string title = 2; repeated string snippets = 3; } repeated Result results = 1; } \u5982\u679c\u8981\u5728\u5176\u7236\u6d88\u606f\u7c7b\u578b\u4e4b\u5916\u91cd\u7528\u6b64\u6d88\u606f\u7c7b\u578b\uff0c\u8bf7\u5c06\u5176\u79f0\u4e3a Parent.Type \uff1a message SomeOtherMessage { SearchResponse.Result result = 1; } \u53ef\u4ee5\u6839\u636e\u9700\u8981\u6df1\u5165\u5d4c\u5957\u6d88\u606f\uff1a message Outer { // Level 0 message MiddleAA { // Level 1 message Inner { // Level 2 int64 ival = 1; bool booly = 2; } } message MiddleBB { // Level 1 message Inner { // Level 2 int32 ival = 1; bool booly = 2; } } } \u66f4\u65b0\u6d88\u606f\u7c7b\u578b \u5982\u679c\u73b0\u6709\u7684\u6d88\u606f\u7c7b\u578b\u4e0d\u518d\u6ee1\u8db3\u9700\u6c42\uff0c\u4f8b\u5982\uff0c\u5e0c\u671b\u6d88\u606f\u683c\u5f0f\u5177\u6709\u989d\u5916\u7684\u5b57\u6bb5\uff0c\u4f46\u4ecd\u7136\u5e0c\u671b\u4f7f\u7528\u65e7\u683c\u5f0f\u521b\u5efa\u7684\u4ee3\u7801\u3002 \u5728\u4e0d\u7834\u574f\u4efb\u4f55\u73b0\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u66f4\u65b0\u6d88\u606f\u7c7b\u578b\u975e\u5e38\u7b80\u5355 \u3002\u8bf7\u8bb0\u4f4f\u4ee5\u4e0b\u89c4\u5219\uff1a \u8bf7\u52ff\u66f4\u6539\u4efb\u4f55\u73b0\u6709\u5b57\u6bb5\u7684\u5b57\u6bb5\u7f16\u53f7\u3002 \u5982\u679c\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u5219\u4f7f\u7528\u201c\u65e7\u201d\u6d88\u606f\u683c\u5f0f\u5e8f\u5217\u5316\u7684\u4efb\u4f55\u6d88\u606f\u4ecd\u53ef\u7531\u65b0\u751f\u6210\u7684\u4ee3\u7801\u8fdb\u884c\u89e3\u6790\u3002\u5e94\u8be5\u8bb0\u4f4f\u8fd9\u4e9b\u5143\u7d20\u7684 \u9ed8\u8ba4\u503c \uff0c\u4ee5\u4fbf\u65b0\u4ee3\u7801\u53ef\u4ee5\u6b63\u786e\u5730\u4e0e\u65e7\u4ee3\u7801\u751f\u6210\u7684\u6d88\u606f\u8fdb\u884c\u4ea4\u4e92\u3002\u540c\u6837\u7684\u65b0\u4ee3\u7801\u521b\u5efa\u7684\u6d88\u606f\u53ef\u4ee5\u7531\u65e7\u4ee3\u7801\u89e3\u6790\uff0c\u65e7\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u89e3\u6790\u65f6\u53ea\u662f\u5ffd\u7565\u65b0\u5b57\u6bb5\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c \u672a\u77e5\u5b57\u6bb5 \u201d\u90e8\u5206\u3002 \u5728\u66f4\u65b0\u7684\u6d88\u606f\u7c7b\u578b\u4e2d\u4e0d\u518d\u4f7f\u7528\u7684\u5b57\u6bb5\u7f16\u53f7\u5c31\u53ef\u4ee5\u5220\u9664\u3002 \u6709\u65f6\u60f3\u8981\u91cd\u547d\u540d\u8be5\u5b57\u6bb5\uff0c\u53ef\u80fd\u6dfb\u52a0\u524d\u7f00\u201c OBSOLETE_ \u201d\uff0c\u6216\u8005\u5c06\u5b57\u6bb5\u7f16\u53f7\u8bbe\u7f6e\u4e3a \u4fdd\u7559 \uff08 reserved \uff09\uff0c\u4ee5\u4fbf .proto \u7684\u672a\u6765\u7528\u6237\u4e0d\u4f1a\u610f\u5916\u5730\u91cd\u590d\u4f7f\u7528\u8be5\u7f16\u53f7\u3002 int32 \uff0c uint32 \uff0c int64 \uff0c uint64 \u548c bool \u90fd\u662f\u517c\u5bb9\u7684\uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u5c06\u5b57\u6bb5\u4ece\u8fd9\u4e9b\u7c7b\u578b\u4e4b\u4e00\u66f4\u6539\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u5411\u524d\u6216\u5411\u540e\u517c\u5bb9\u6027\u3002\u5982\u679c\u5728\u4f20\u8f93\u4e2d\u89e3\u6790\u51fa\u4e00\u4e2a\u4e0d\u9002\u5408\u76f8\u5e94\u7c7b\u578b\u7684\u6570\u5b57\uff0c\u5c06\u83b7\u5f97\u4e0e\u5728 C++ \u4e2d\u5c06\u8be5\u6570\u5b57\u8f6c\u6362\u4e3a\u8be5\u7c7b\u578b\u76f8\u540c\u7684\u6548\u679c\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5c0664\u4f4d\u6570\u5b57\u4f5c\u4e3aint32\u8bfb\u53d6\uff0c\u5b83\u5c06\u88ab\u622a\u65ad\u4e3a32\u4f4d\uff09\u3002 sint32 \u548c sint64 \u5f7c\u6b64\u517c\u5bb9\uff0c\u4f46\u4e0e\u5176\u4ed6\u6574\u6570\u7c7b\u578b\u4e0d\u517c\u5bb9\u3002 \u53ea\u8981 byte \u662f\u6709\u6548\u7684 UTF-8 \uff0c string \u548c byte \u662f\u517c\u5bb9\u7684\u3002 \u5982\u679c byte \u5305\u542b\u6d88\u606f\u7684\u7f16\u7801\u7248\u672c\uff0c\u5219\u5d4c\u5165\u6d88\u606f\u4e0e byte \u517c\u5bb9\u3002 fixed32 \u4e0e sfixed32 \u517c\u5bb9\uff0c fixed64 \u4e0e sfixed64 \u517c\u5bb9\u3002 enum \u5728\u4f20\u8f93\u683c\u5f0f\u4e2d\u4e0e int32 \uff0c uint32 \uff0c int64 \u548c uint64 \u517c\u5bb9\uff08\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u503c\u4e0d\u5408\u9002\uff0c\u5c06\u622a\u65ad\u503c\uff09\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u6d88\u606f\u65f6\uff0c\u5ba2\u6237\u7aef\u4ee3\u7801\u53ef\u80fd\u4f1a\u4ee5\u4e0d\u540c\u65b9\u5f0f\u5bf9\u5f85\u5b83\u4eec\uff1a\u4f8b\u5982\uff0c\u65e0\u6cd5\u8bc6\u522b\u7684 proto3 \u679a\u4e3e\u7c7b\u578b\u5c06\u4fdd\u7559\u5728\u6d88\u606f\u4e2d\uff0c\u4f46\u5728\u53cd\u5e8f\u5217\u5316\u6d88\u606f\u65f6\u5982\u4f55\u8868\u793a\u5b83\u662f\u4f9d\u8d56\u4e8e\u7f16\u7a0b\u8bed\u8a00\u7684\u3002 Int \u5b57\u6bb5\u603b\u662f\u4fdd\u7559\u5b83\u4eec\u7684\u503c\u3002 \u5c06\u5355\u4e2a\u503c\u66f4\u6539\u4e3a\u65b0 oneof \u7684\u6210\u5458\u662f\u5b89\u5168\u4e14\u4e8c\u8fdb\u5236\u517c\u5bb9\u7684\u3002\u5982\u679c\u786e\u4fdd\u6ca1\u6709\u4ee3\u7801\u4e00\u6b21\u8bbe\u7f6e\u591a\u4e2a\u5b57\u6bb5\uff0c\u90a3\u4e48\u5c06\u591a\u4e2a\u5b57\u6bb5\u79fb\u52a8\u5230\u65b0\u7684 oneof \u53ef\u80fd\u662f\u5b89\u5168\u7684\u3002\u5c06\u4efb\u4f55\u5b57\u6bb5\u79fb\u52a8\u5230\u67d0\u4e2a\u73b0\u6709\u7684 oneof \u4e2d\u90fd\u662f\u4e0d\u5b89\u5168\u7684\u3002 \u672a\u77e5\u5b57\u6bb5 \u672a\u77e5\u5b57\u6bb5\u662f\u683c\u5f0f\u826f\u597d\u7684 protocol buffers \u5e8f\u5217\u5316\u6570\u636e\uff0c\u5b83\u8868\u793a\u89e3\u6790\u5668\u65e0\u6cd5\u8bc6\u522b\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u5f53\u65e7\u4e8c\u8fdb\u5236\u6587\u4ef6\u89e3\u6790\u5177\u6709\u65b0\u5b57\u6bb5\u7684\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u53d1\u9001\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e9b\u65b0\u5b57\u6bb5\u5c06\u6210\u4e3a\u65e7\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u672a\u77e5\u5b57\u6bb5\u3002 \u6700\u521d\uff0c proto3 \u6d88\u606f\u5728\u89e3\u6790\u671f\u95f4\u603b\u662f\u4e22\u5f03\u672a\u77e5\u5b57\u6bb5\uff0c\u4f46\u57283.5\u7248\u672c\u4e2d\uff0c\u91cd\u65b0\u5f15\u5165\u4e86\u672a\u77e5\u5b57\u6bb5\u7684\u4fdd\u5b58\u4ee5\u5339\u914d proto2 \u884c\u4e3a\u3002\u5728\u7248\u672c3.5\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u672a\u77e5\u5b57\u6bb5\u5728\u89e3\u6790\u671f\u95f4\u4fdd\u7559\u5e76\u5305\u542b\u5728\u5e8f\u5217\u5316\u8f93\u51fa\u4e2d\u3002 Any Any \u6d88\u606f\u7c7b\u578b\u5141\u8bb8\u5c06\u6d88\u606f\u7528\u4f5c\u5d4c\u5165\u7c7b\u578b\uff0c\u800c\u65e0\u9700\u4f7f\u7528\u8fd9\u4e9b\u6d88\u606f\u7684 .proto \u5b9a\u4e49\u3002 Any \u5305\u542b\u4efb\u610f\u5e8f\u5217\u5316\u6d88\u606f\uff08\u5982 byte \uff09\uff0c\u5e76\u5e26\u6709\u4e00\u4e2a URL \u4f5c\u4e3a\u8be5\u6d88\u606f\u7c7b\u578b\u7684\u5168\u5c40\u552f\u4e00\u6807\u8bc6\u7b26\u7528\u4e8e\u8868\u793a\u548c\u89e3\u6790\u5b83\u3002\u8981\u4f7f\u7528 Any \u7c7b\u578b\uff0c\u9700\u8981 \u5bfc\u5165 google/protobuf/any.proto \u3002 import google/protobuf/any.proto ; message ErrorStatus { string message = 1; repeated google.protobuf.Any details = 2; } type.googleapis.com/packagename.messagename \u662f\u7ed9\u5b9a\u6d88\u606f\u7c7b\u578b\u7684\u9ed8\u8ba4\u7c7b\u578b URL \u3002 \u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\u5c06\u652f\u6301\u8fd0\u884c\u65f6\u5e93\u6765\u5e2e\u52a9\u7a0b\u5e8f\u4ee5\u7c7b\u578b\u5b89\u5168\u7684\u65b9\u5f0f\u6253\u5305\u548c\u89e3\u538b\u7f29 Any \u503c\u3002\u4f8b\u5982\uff0c\u5728 Java \u4e2d\uff0c Any \u7c7b\u578b\u5c06\u5177\u6709\u7279\u6b8a\u7684 pack() \u548c unpack() \u8bbf\u95ee\u5668\uff0c\u800c\u5728 C++ \u4e2d\u5219\u6709 PackFrom() \u548c UnpackTo () \u65b9\u6cd5\uff1a // \u5728Any\u4e2d\u5b58\u50a8\u4efb\u610f\u6d88\u606f\u7c7b\u578b\u3002 NetworkErrorDetails details = ...; ErrorStatus status; status.add_details()- PackFrom(details); // \u4eceAny\u8bfb\u53d6\u4efb\u610f\u6d88\u606f\u3002 ErrorStatus status = ...; for (const Any detail : status.details()) { if (detail.Is NetworkErrorDetails ()) { NetworkErrorDetails network_error; detail.UnpackTo( network_error); ... processing network_error ... } } \u76ee\u524d\uff0c\u6b63\u5728\u5f00\u53d1\u7528\u4e8e\u5904\u7406 Any \u7c7b\u578b\u7684\u8fd0\u884c\u65f6\u5e93\u3002 \u5982\u679c\u5df2\u719f\u6089 proto2 \u8bed\u6cd5 \uff0c\u5219 Any \u7c7b\u578b\u5c06\u66ff\u6362 \u6269\u5c55 \u3002 Oneof \u5982\u679c\u6709\u4e00\u4e2a\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u7684\u6d88\u606f\uff0c\u5e76\u4e14\u6700\u591a\u53ea\u80fd\u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 oneof \u6765\u5f3a\u5236\u6267\u884c\u6b64\u64cd\u4f5c\u540c\u65f6\u8fd8\u80fd\u8282\u7701\u5185\u5b58\u3002 oneof \u5b57\u6bb5\u4e0e\u6b63\u5e38\u7684\u5b57\u6bb5\u4e00\u6837\uff0c\u53ea\u662f\u5728\u540c\u4e00\u4e2a oneof \u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u5171\u4eab\u5185\u5b58\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u5b57\u6bb5\u3002\u8bbe\u7f6e oneof \u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u6210\u5458\u65f6\u90fd\u4f1a\u81ea\u52a8\u6e05\u9664\u6240\u6709\u5176\u4ed6\u6210\u5458\u3002\u53ef\u4ee5\u4f7f\u7528 case() \u6216 WhichOneof() \u65b9\u6cd5\u68c0\u67e5 oneof \u4e2d\u7684\u54ea\u4e2a\u503c\uff08\u5982\u679c\u6709\uff09\u88ab\u8bbe\u7f6e\u4e86\uff0c\u5177\u4f53\u4f7f\u7528\u54ea\u4e2a\u53d6\u51b3\u4e8e\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\u3002 \u4f7f\u7528 Oneof \u8981\u5728 .proto \u4e2d\u5b9a\u4e49 oneof \uff0c\u8bf7\u4f7f\u7528 oneof \u5173\u952e\u5b57\uff0c\u5e76\u5728\u540e\u9762\u8ddf\u7740 oneof \u540d\u79f0\uff0c\u5728\u672c\u4f8b\u4e2d\u4e3a test_oneof \uff1a message SampleMessage { oneof test_oneof { string name = 4; SubMessage sub_message = 9; } } \u7136\u540e\uff0c\u5c06 oneof \u5b57\u6bb5\u6dfb\u52a0\u5230 oneof \u5b9a\u4e49\u4e2d\u3002\u53ef\u4ee5\u6dfb\u52a0\u4efb\u4f55\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u4f46\u4e0d\u80fd\u4f7f\u7528 repeated \u5b57\u6bb5\u3002 \u5728\u751f\u6210\u7684\u4ee3\u7801\u4e2d\uff0c oneof \u5b57\u6bb5\u4e0e\u5e38\u89c4\u5b57\u6bb5\u5177\u6709\u76f8\u540c\u7684 getter \u548c setter \u3002\u8fd8\u53ef\u4ee5\u83b7\u5f97\u4e00\u79cd\u7279\u6b8a\u65b9\u6cd5\u6765\u68c0\u67e5 oneof \u4e2d\u8bbe\u7f6e\u4e86\u54ea\u4e2a\u503c\uff08\u5982\u679c\u6709\uff09\u3002\u53ef\u4ee5\u5728\u76f8\u5173 API\u53c2\u8003 \u4e2d\u627e\u5230\u6709\u5173\u6240\u9009\u8bed\u8a00\u7684 oneof API \u7684\u66f4\u591a\u4fe1\u606f\u3002 Oneof \u7684\u529f\u80fd \u8bbe\u7f6e oneof \u5b57\u6bb5\u5c06\u81ea\u52a8\u6e05\u9664 oneof \u7684\u6240\u6709\u5176\u4ed6\u6210\u5458\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8bbe\u7f6e\u591a\u4e2a\u5b57\u6bb5\uff0c\u5219\u53ea\u6709\u8bbe\u7f6e\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\u4ecd\u7136\u5177\u6709\u503c\u3002 c++ SampleMessage message; message.set_name(\"name\"); CHECK(message.has_name()); message.mutable_sub_message(); // Will clear name field. CHECK(!message.has_name()); \u5982\u679c\u89e3\u6790\u5668\u5728\u4f20\u8f93\u4e2d\u9047\u5230\u540c\u4e00\u4e2a oneof \u7684\u591a\u4e2a\u6210\u5458\uff0c\u5219\u5728\u89e3\u6790\u7684\u6d88\u606f\u4e2d\u4ec5\u4f7f\u7528\u770b\u5230\u7684\u6700\u540e\u4e00\u4e2a\u6210\u5458\u3002 oneof \u4e0d\u80fd\u662f repeated \u3002 \u5982\u679c\u5c06 oneof \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\uff08\u4f8b\u5982\u5c06 int32 oneof \u5b57\u6bb5\u8bbe\u7f6e\u4e3a0\uff09\uff0c\u90a3\u4e48\u8be5 oneof \u5b57\u6bb5\u7684 \u201ccase\u201d \u5c06\u4f1a\u88ab\u8bbe\u7f6e\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5b57\u6bb5\u7684\u503c\u5c06\u5728\u4f20\u8f93\u65f6\u5e8f\u5217\u5316\u3002 \u5982\u679c\u4f7f\u7528\u7684\u662f C++ \uff0c\u8bf7\u786e\u4fdd\u4ee3\u7801\u4e0d\u4f1a\u5bfc\u81f4\u5185\u5b58\u5d29\u6e83\u3002\u4ee5\u4e0b\u793a\u4f8b\u4ee3\u7801\u5c06\u5d29\u6e83\uff0c\u56e0\u4e3a\u901a\u8fc7\u8c03\u7528 set_name() \u65b9\u6cd5\u5220\u9664\u4e86 sub_message \u3002 c++ SampleMessage message; SubMessage* sub_message = message.mutable_sub_message(); message.set_name(\"name\"); // Will delete sub_message sub_message- set_... // Crashes here \u540c\u6837\u5728 C++ \u4e2d\uff0c\u5982\u679c Swap() \u4e24\u6761 oneof \u7684\u6d88\u606f\uff0c\u5219\u6bcf\u6761\u6d88\u606f\u90fd\u5c06\u4ee5\u53e6\u4e00\u6761\u6d88\u606f\u7684 \u201ccase\u201d \u4f5c\u4e3a\u7ed3\u675f\uff1a\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c msg1 \u5c06\u4f1a\u6709 sub_message \u540c\u65f6 msg2 \u5c06\u4f1a\u6709 name \u3002 c++ SampleMessage msg1; msg1.set_name(\"name\"); SampleMessage msg2; msg2.mutable_sub_message(); msg1.swap( msg2); CHECK(msg1.has_sub_message()); CHECK(msg2.has_name()); \u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898 \u6dfb\u52a0\u6216\u5220\u9664 oneof \u5b57\u6bb5\u65f6\u8981\u5c0f\u5fc3\u3002\u5982\u679c\u5728\u68c0\u67e5 oneof \u7684\u503c\u8fd4\u56de None/NOT_SET \uff0c\u8fd9\u53ef\u80fd\u610f\u5473\u7740 oneof \u5c1a\u672a\u8bbe\u7f6e\u6216\u5df2\u8bbe\u7f6e\u4e3a oneof \u7684\u53e6\u4e00\u4e2a\u4e0d\u540c\u7248\u672c\u3002\u6ca1\u6709\u529e\u6cd5\u533a\u5206\uff0c\u56e0\u4e3a\u6ca1\u6709\u529e\u6cd5\u77e5\u9053\u4f20\u8f93\u4e2d\u7684\u672a\u77e5\u5b57\u6bb5\u662f\u5426\u662f oneof \u7684\u6210\u5458\u3002 \u6807\u7b7e\u91cd\u7528\u95ee\u9898 \u5c06\u5b57\u6bb5\u79fb\u5165\u6216\u79fb\u51fa oneof \uff1a\u5728\u5e8f\u5217\u5316\u6216\u89e3\u6790\u6d88\u606f\u540e\uff0c\u53ef\u80fd\u4f1a\u4e22\u5931\u4e00\u4e9b\u4fe1\u606f\uff08\u67d0\u4e9b\u5b57\u6bb5\u5c06\u88ab\u6e05\u9664\uff09\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u5c06\u5355\u4e2a\u5b57\u6bb5\u79fb\u52a8\u5230\u65b0\u7684 oneof \u5b57\u6bb5\u4e2d\uff0c\u5e76\u4e14\u5982\u679c\u5df2\u77e5\u53ea\u6709\u4e00\u4e2a\u5b57\u6bb5\u88ab\u8bbe\u7f6e\uff0c\u5219\u53ef\u4ee5\u79fb\u52a8\u591a\u4e2a\u5b57\u6bb5\u3002 \u5220\u9664 oneof \u5b57\u6bb5\u5e76\u5c06\u5176\u6dfb\u52a0\u56de \uff1a\u5728\u5e8f\u5217\u5316\u6216\u89e3\u6790\u6d88\u606f\u540e\uff0c\u8fd9\u53ef\u80fd\u4f1a\u6e05\u9664\u5f53\u524d\u8bbe\u7f6e\u7684 oneof \u5b57\u6bb5\u3002 \u62c6\u5206\u6216\u5408\u5e76 oneof \uff1a\u8fd9\u4e0e\u79fb\u52a8\u5e38\u89c4\u5b57\u6bb5\u6709\u7c7b\u4f3c\u7684\u95ee\u9898\u3002 Maps \u5982\u679c\u8981\u5728\u6570\u636e\u5b9a\u4e49\u4e2d\u521b\u5efa\u5173\u8054\u6620\u5c04\uff0c protocol buffers \u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u4fbf\u7684\u5feb\u6377\u65b9\u5f0f\u8bed\u6cd5\uff1a map key_type, value_type map_field = N; \u5176\u4e2d key_type \u53ef\u4ee5\u662f\u4efb\u4f55 \u6574\u6570 \u6216 \u5b57\u7b26\u4e32 \u7c7b\u578b\uff08\u9664\u4e86\u6d6e\u70b9\u7c7b\u578b\u548c\u5b57\u8282\u4e4b\u5916\u7684\u4efb\u4f55 \u6807\u91cf \u7c7b\u578b\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u679a\u4e3e\u4e0d\u662f\u6709\u6548\u7684 key_type \u3002 value_type \u53ef\u4ee5\u662f map \u4e4b\u5916\u7684\u4efb\u4f55\u7c7b\u578b\u3002 \u5982\u679c\u8981\u521b\u5efa\u4e00\u4e2a map \uff0c\u5176\u4e2d\u6bcf\u4e2a Project \u6d88\u606f\u4e0e\u5b57\u7b26\u4e32\u952e\u76f8\u5173\u8054\uff0c\u5219\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u5b9a\u4e49\u5b83\uff1a map string, Project projects = 3; map \u7684\u5b57\u6bb5\u4e0d\u80fd\u662f repeated \u3002 \u4f20\u8f93\u683c\u5f0f\u7684\u987a\u5e8f\u548c map \u503c\u7684\u8fed\u4ee3\u987a\u5e8f\u662f\u672a\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u4e0d\u80fd\u4f9d\u8d56 map \u4e2d\u7684\u9879\u76ee\u6309\u7279\u5b9a\u987a\u5e8f\u6392\u5e8f\u3002 \u4ece .proto \u6587\u4ef6\u4e2d\u751f\u6210\u6587\u672c\u683c\u5f0f\u65f6\uff0c map \u6309\u952e\u6392\u5e8f\uff0c\u6570\u5b57\u952e\u6309\u6570\u5b57\u6392\u5e8f\u3002 \u5728\u4f20\u8f93\u6216\u5408\u5e76\u65f6\u8fdb\u884c\u89e3\u6790\uff0c\u5982\u679c\u6709\u91cd\u590d\u7684 map \u952e\uff0c\u90a3\u4e48\u5c31\u4f7f\u7528\u6700\u540e\u7684\u90a3\u4e2a\u952e\u3002\u4ece\u6587\u672c\u683c\u5f0f\u89e3\u6790 map \u65f6\uff0c\u5982\u679c\u5b58\u5728\u91cd\u590d\u952e\uff0c\u5219\u89e3\u6790\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 \u5982\u679c\u7ed9 map \u63d0\u4f9b\u4e86\u952e\u5374\u6ca1\u6709\u63d0\u4f9b\u503c\uff0c\u90a3\u4e48\u5b57\u6bb5\u5e8f\u5217\u5316\u7684\u5177\u4f53\u884c\u4e3a\u5c31\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u5728 c++ , Java \uff0c Python \u4e2d\u4f7f\u7528\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u8fdb\u884c\u5e8f\u5217\u5316\uff0c\u5728\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u6ca1\u6709\u503c\u88ab\u5e8f\u5217\u5316\u3002 \u76ee\u524d\uff0c\u6240\u6709 proto3 \u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u90fd\u80fd\u751f\u6210 map API\uff0c\u66f4\u591a\u5173\u4e8e\u6240\u9009\u8bed\u8a00\u7684 map API\u7684\u53c2\u8003\u67e5\u770b API\u53c2\u8003\u6587\u6863 \u3002 \u5411\u540e\u517c\u5bb9\u6027 \u5728\u4f20\u8f93\u65f6\uff0c map \u7684\u8bed\u6cd5\u7b49\u6548\u4e8e\u4e0b\u9762\u7684\u793a\u4f8b\uff0c\u56e0\u6b64\u4e0d\u652f\u6301 map \u7684 protocol buffers \u5b9e\u73b0\u4ecd\u7136\u53ef\u4ee5\u5904\u7406\u4f20\u8f93\u7684\u6570\u636e\uff1a message MapFieldEntry { key_type key = 1; value_type value = 2; } repeated MapFieldEntry map_field = N; \u652f\u6301 map \u7684\u4efb\u4f55 protocol buffers \u5b9e\u73b0\u90fd\u5fc5\u987b\u751f\u6210\u548c\u63a5\u53d7\u4e0a\u8ff0\u5b9a\u4e49\u6240\u8868\u793a\u7684\u53ef\u63a5\u53d7\u7684\u6570\u636e\u3002 Packages \u53ef\u4ee5\u5c06\u53ef\u9009\u7684 package \u8bf4\u660e\u7b26\u6dfb\u52a0\u5230 .proto \u6587\u4ef6\uff0c\u4ee5\u9632\u6b62 protocol buffers \u6d88\u606f\u7c7b\u578b\u4e4b\u95f4\u7684\u540d\u79f0\u51b2\u7a81\u3002 package foo.bar; message Open { ... } \u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u7684\u5b57\u6bb5\u65f6\u4f7f\u7528 package \u8bf4\u660e\u7b26\uff1a message Foo { ... foo.bar.Open open = 1; ... } package \u8bf4\u660e\u7b26\u5f71\u54cd\u751f\u6210\u4ee3\u7801\u7684\u65b9\u5f0f\u53d6\u51b3\u4e8e\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\uff1a \u5728 C++ \u4e2d\uff0c\u751f\u6210\u7684\u7c7b\u5305\u542b\u5728 C++ \u547d\u540d\u7a7a\u95f4\u4e2d\u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u547d\u540d\u7a7a\u95f4 foo::bar \u4e2d\u3002 \u5728 Java \u4e2d\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 java_package \uff0c\u5426\u5219\u8be5\u5305\u5c06\u7528\u4f5c Java \u5305\u3002 \u5728 Python \u4e2d\uff0c\u5c06\u5ffd\u7565 package \u6307\u4ee4\uff0c\u56e0\u4e3a Python \u6a21\u5757\u662f\u6839\u636e\u5b83\u4eec\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e\u8fdb\u884c\u7ec4\u7ec7\u7684\u3002 \u5728 Go \u4e2d\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 go_package \uff0c\u5426\u5219\u8be5\u5305\u5c06\u7528\u4f5c Go \u5305\u540d\u79f0\u3002 \u5728 Ruby \u4e2d\uff0c\u751f\u6210\u7684\u7c7b\u5305\u542b\u5728\u5d4c\u5957\u7684 Ruby \u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u8f6c\u6362\u4e3a\u6240\u9700\u7684 Ruby \u5927\u5199\u5f62\u5f0f\uff08\u9996\u5b57\u6bcd\u5927\u5199;\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u5b57\u6bcd\uff0c\u5219 PB_ \u524d\u7f6e\uff09\u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u540d\u79f0\u7a7a\u95f4 Foo::Bar \u4e2d\u3002 \u5728 C\uff03 \u4e2d\uff0c\u8f6c\u6362\u4e3a PascalCase \u540e\uff0c\u5305\u5c06\u7528\u4f5c\u547d\u540d\u7a7a\u95f4\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 csharp_namespace \u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u540d\u79f0\u7a7a\u95f4 Foo.Bar \u4e2d\u3002 \u5305\u548c\u540d\u79f0\u89e3\u6790 protocol buffers \u8bed\u8a00\u4e2d\u7684\u7c7b\u578b\u540d\u79f0\u89e3\u6790\u4e0e C++ \u7c7b\u4f3c\uff1a\u9996\u5148\u641c\u7d22\u6700\u91cc\u9762\u7684\u8303\u56f4\uff0c\u7136\u540e\u641c\u7d22\u4e0b\u4e00\u4e2a\u8303\u56f4\uff0c\u4f9d\u6b64\u7c7b\u63a8\uff0c\u6bcf\u4e2a\u5305\u88ab\u8ba4\u4e3a\u662f\u5176\u7236\u5305\u7684\u201c\u5185\u90e8\u201d\u3002\u4e00\u4e2a '.' \uff08\u4f8b\u5982 .foo.bar.Baz \uff09\u610f\u5473\u7740\u4ece\u6700\u5916\u5c42\u7684\u8303\u56f4\u5f00\u59cb\u3002 protocol buffers \u7f16\u8bd1\u5668\u901a\u8fc7\u89e3\u6790\u5bfc\u5165\u7684 .proto \u6587\u4ef6\u6765\u89e3\u6790\u6240\u6709\u7c7b\u578b\u540d\u79f0\u3002\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u4ee3\u7801\u751f\u6210\u5668\u90fd\u77e5\u9053\u5982\u4f55\u5f15\u7528\u8be5\u8bed\u8a00\u4e2d\u7684\u6bcf\u79cd\u7c7b\u578b\uff0c\u5373\u4f7f\u5b83\u5177\u6709\u4e0d\u540c\u7684\u8303\u56f4\u89c4\u5219\u3002 \u5b9a\u4e49\u670d\u52a1 \u5982\u679c\u8981\u5728RPC\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff09\u7cfb\u7edf\u4e2d\u4f7f\u7528\u81ea\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\uff0c\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49RPC\u670d\u52a1\u63a5\u53e3 protocol buffers \u7f16\u8bd1\u5668\u5c06\u4ee5\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\u751f\u6210\u670d\u52a1\u63a5\u53e3\u4ee3\u7801\u548c stub \u3002 \u4f8b\u5982\uff0c\u8981\u5b9a\u4e49\u4e00\u4e2aRPC\u670d\u52a1\uff0c\u8be5\u670d\u52a1\u83b7\u53d6 SearchRequest \u8bf7\u6c42\u5e76\u8fd4\u56de SearchResponse \u54cd\u5e94\u6d88\u606f\uff0c\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u5b83\uff0c\u5982\u4e0b\u6240\u793a\uff1a service SearchService { rpc Search (SearchRequest) returns (SearchResponse); } \u4e0e protocol buffers \u4e00\u8d77\u4f7f\u7528\u7684\u6700\u7b80\u5355\u7684RPC\u7cfb\u7edf\u662f gRPC \uff1a\u4e00\u79cd\u7531Google\u5f00\u53d1\u7684\u8bed\u8a00\u5e73\u53f0\u4e2d\u7acb\u7684\u5f00\u6e90RPC\u7cfb\u7edf\u3002gRPC\u7279\u522b\u9002\u7528\u4e8e protocol buffers \uff0c\u5e76\u5141\u8bb8\u4f7f\u7528\u7279\u5b9a\u7684 protocol buffers \u7f16\u8bd1\u5668\u63d2\u4ef6\u76f4\u63a5\u4ece .proto \u6587\u4ef6\u751f\u6210\u76f8\u5173\u7684RPC\u4ee3\u7801\u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528gRPC\uff0c\u4e5f\u53ef\u4ee5\u5c06 protocol buffers \u4e0e\u81ea\u5b9a\u4e49\u7684RPC\u5b9e\u73b0\u4e00\u8d77\u4f7f\u7528\u3002\u53ef\u4ee5\u5728 Proto2 \u8bed\u8a00\u6307\u5357 \u4e2d\u627e\u5230\u66f4\u591a\u76f8\u5173\u4fe1\u606f\u3002 \u8fd8\u6709\u4e00\u4e9b\u6b63\u5728\u8fdb\u884c\u7684\u7b2c\u4e09\u65b9\u9879\u76ee\u4e3a Protocol Buffers \u5f00\u53d1RPC\u5b9e\u73b0\u3002\u6709\u5173\u6211\u4eec\u4e86\u89e3\u7684\u9879\u76ee\u7684\u94fe\u63a5\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c\u4e09\u65b9\u52a0\u8f7d\u9879wiki\u9875\u9762 \u3002 JSON\u6620\u5c04 Proto3 \u652f\u6301 JSON \u4e2d\u7684\u89c4\u8303\u7f16\u7801\uff0c\u4f7f\u5f97\u5728\u7cfb\u7edf\u4e4b\u95f4\u5171\u4eab\u6570\u636e\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002\u5728\u4e0b\u8868\u4e2d\u9010\u4e2a\u7c7b\u578b\u5730\u63cf\u8ff0\u7f16\u7801\u3002 \u5982\u679c JSON \u7f16\u7801\u6570\u636e\u4e2d\u7f3a\u5c11\u67d0\u4e2a\u503c\uff0c\u6216\u8005\u5176\u503c\u4e3a null \uff0c\u5219\u5728\u89e3\u6790\u4e3a protocol buffers \u65f6\uff0c\u5b83\u5c06\u88ab\u89e3\u91ca\u4e3a\u76f8\u5e94\u7684 \u9ed8\u8ba4\u503c \u3002\u5982\u679c\u67d0\u4e2a\u5b57\u6bb5\u5728 protocol buffers \u4e2d\u5177\u6709\u9ed8\u8ba4\u503c\uff0c\u5219\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u5728 JSON \u7f16\u7801\u7684\u6570\u636e\u4e2d\u7701\u7565\u8be5\u5b57\u6bb5\u4ee5\u8282\u7701\u7a7a\u95f4\u3002\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\u662f\u63d0\u4f9b\u53ef\u9009\u9009\u9879\u5728 JSON \u7f16\u7801\u7684\u8f93\u51fa\u4e2d\u8f93\u51fa\u5b57\u6bb5\u548c\u5b83\u7684\u9ed8\u8ba4\u503c\u3002 proto3 JSON JSON example Notes message object {\"fooBar\": v, \"g\": null, \u2026} \u751f\u6210JSON\u5bf9\u8c61\u3002 message \u5b57\u6bb5\u540d\u79f0\u6620\u5c04\u5230\u5c0f\u9a7c\u5cf0\u547d\u540d\u5e76\u6210\u4e3aJSON\u5bf9\u8c61\u7684 key \u3002\u5982\u679c\u6307\u5b9a\u4e86 json_name \u5b57\u6bb5\u8fd9\u4e2a\u9009\u9879\uff0c\u5219\u5c06\u6307\u5b9a\u7684\u503c\u4f5c\u4e3a key \u3002\u89e3\u6790\u5668\u63a5\u53d7\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0\uff08\u6216 json_name \u9009\u9879\u6307\u5b9a\u7684\u540d\u79f0\uff09\u548c\u539f\u59cb\u7684 proto \u5b57\u6bb5\u540d\u79f0\u3002 null \u662f\u6240\u6709\u5b57\u6bb5\u7c7b\u578b\u90fd\u53ef\u63a5\u53d7\u7684\u503c\uff0c\u5e76\u88ab\u89c6\u4e3a\u76f8\u5e94\u5b57\u6bb5\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u3002 enum string \"FOO_BAR\" \u4f7f\u7528 proto \u4e2d\u6307\u5b9a\u7684\u679a\u4e3e\u503c\u7684\u540d\u79f0\u3002\u89e3\u6790\u5668\u63a5\u53d7\u679a\u4e3e\u540d\u79f0\u548c\u6574\u6570\u503c\u3002 map object {\"k\": v, \u2026} \u6240\u6709\u952e\u90fd\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002 repeated V array [v, \u2026] null \u88ab\u63a5\u53d7\u4e3a\u7a7a\u7684 list[] \u3002 bool true, false true, false string string \"Hello World!\" bytes base64 string \"YWJjMTIzIT8kKiYoKSctPUB+\" JSON\u503c\u5c06\u662f\u4f7f\u7528\u5e26\u586b\u5145\u7684\u6807\u51c6base64\u7f16\u7801\u65b9\u5f0f\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u6570\u636e\u3002\u5e26\u6709/\u4e0d\u5e26\u586b\u5145\u7684\u6807\u51c6\u6216URL\u5b89\u5168\u7684base64\u7f16\u7801\u65b9\u5f0f\u4e5f\u662f\u53ef\u63a5\u53d7\u7684\u3002 int32, fixed32, uint32 number 1, -10, 0 \u5341\u8fdb\u5236\u6570\u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\u3002 int64, fixed64, uint64 string \"1\", \"-10\" \u5341\u8fdb\u5236\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\u3002 float, double number 1.1, -10.0, 0, \"NaN\", \"Infinity\" \u4e00\u4e2a\u6216\u591a\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32 \u201cNaN\u201d \uff0c \u201cInfinity\u201d \u548c \u201c-Infinity\u201d \u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\uff0c\u6307\u6570\u8868\u793a\u6cd5\u4e5f\u88ab\u63a5\u53d7\u3002 Any object {\"@type\": \"url\", \"f\": v, \u2026 } \u5982\u679c Any \u5305\u542b\u5177\u6709\u7279\u6b8aJSON\u6620\u5c04\u7684\u503c\uff0c\u5219\u5b83\u5c06\u6309\u5982\u4e0b\u65b9\u5f0f\u8f6c\u6362\uff1a {\u201c@ type\u201d\uff1axxx\uff0c\u201cvalue\u201d\uff1ayyy} \u3002 \u5426\u5219\uff0c\u8be5\u503c\u5c06\u8f6c\u6362\u4e3aJSON\u5bf9\u8c61\uff0c\u5e76\u5c06\u63d2\u5165 \u201c@type\u201d \u5b57\u6bb5\u4ee5\u6307\u793a\u5b9e\u9645\u6570\u636e\u7c7b\u578b\u3002 Timestamp string \"1972-01-01T10:00:20.021Z\" \u4f7f\u7528 RFC 3339 \uff0c\u5176\u4e2d\u751f\u6210\u7684\u8f93\u51fa\u5c06\u59cb\u7ec8\u88ab Z-\u6807\u51c6\u5316 \u5e76\u4f7f\u75280,3,6\u62169\u4e2a\u5c0f\u6570\u4f4d\u3002\u4e5f\u63a5\u53d7\u201cZ\u201d\u4ee5\u5916\u7684\u504f\u79fb\u3002 Duration string \"1.000340012s\", \"1s\" \u751f\u6210\u7684\u8f93\u51fa\u59cb\u7ec8\u5305\u542b0,3,6\u62169\u4e2a\u5c0f\u6570\u4f4d\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6240\u9700\u7684\u7cbe\u5ea6\uff0c\u540e\u8ddf\u540e\u7f00 \u201cs\u201d \u3002\u63a5\u53d7\u4efb\u4f55\u5c0f\u6570\u4f4d\uff08\u4e5f\u53ef\u4ee5\u6ca1\u6709\u5c0f\u6570\u4f4d\uff09\uff0c\u53ea\u8981\u5b83\u4eec\u7b26\u5408\u7eb3\u79d2\u7cbe\u5ea6\u5e76\u4e14\u9700\u8981\u540e\u7f00 \u201cs\u201d \u3002 Struct object { \u2026 } \u4efb\u610fJSON\u5bf9\u8c61\uff0c\u67e5\u770b struct.proto \u6587\u4ef6 Wrapper types various types 2, \"2\", \"foo\", true, \"true\", null, 0, \u2026 Wrappers \u5728JSON\u4e2d\u4f7f\u7528\u4e0e\u5305\u88c5\u57fa\u5143\u7c7b\u578b\u76f8\u540c\u7684\u8868\u793a\u5f62\u5f0f\uff0c\u9664\u4e86\u5728\u6570\u636e\u8f6c\u6362\u548c\u4f20\u8f93\u671f\u95f4\u5141\u8bb8\u548c\u4fdd\u7559 null \u3002 FieldMask string \"f.fooBar,h\" \u67e5\u770b field_mask.proto \u6587\u4ef6 ListValue array [foo, bar, \u2026] Value value \u4efb\u610fJSON\u503c NullValue null JSON\u4e2d\u7684 null Empty object {} \u7a7a\u7684JSON\u5bf9\u8c61 JSON\u9009\u9879 proto3 JSON \u5b9e\u73b0\u53ef\u4ee5\u63d0\u4f9b\u4ee5\u4e0b\u53ef\u7528\u9009\u9879\uff1a \u8f93\u51fa\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c \uff1a\u5728 proto3 JSON \u7684\u8f93\u51fa\u4e2d\u9ed8\u8ba4\u7701\u7565\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\u6709\u4e00\u4e2a\u9009\u9879\u53ef\u4ee5\u63d0\u4f9b\u8986\u76d6\u6b64\u884c\u4e3a\u5e76\u8f93\u51fa\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u5ffd\u7565\u672a\u77e5\u5b57\u6bb5 \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c proto3 JSON \u89e3\u6790\u5668\u4f1a\u62d2\u7edd\u672a\u77e5\u5b57\u6bb5\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u9009\u9879\u6765\u5ffd\u7565\u89e3\u6790\u672a\u77e5\u5b57\u6bb5\u3002 \u4f7f\u7528 proto \u5b57\u6bb5\u540d\u79f0\u800c\u4e0d\u662f\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0 \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c proto3 JSON \u4f1a\u5c06\u5b57\u6bb5\u540d\u79f0\u8f6c\u6362\u4e3a\u5c0f\u9a7c\u5cf0\u547d\u540d\u5e76\u5c06\u5176\u7528\u4f5cJSON\u7684\u540d\u79f0\u3002\u6709\u4e00\u4e2a\u9009\u9879\u53ef\u4ee5\u63d0\u4f9b\u4f7f\u7528 proto \u5b57\u6bb5\u540d\u79f0\u4f5c\u4e3aJSON\u7684\u540d\u79f0\u3002 proto3 JSON \u89e3\u6790\u5668\u9700\u8981\u63a5\u53d7\u8f6c\u6362\u540e\u7684\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0\u548c proto \u5b57\u6bb5\u540d\u79f0\u3002 \u5c06\u679a\u4e3e\u503c\u4f5c\u4e3a\u6574\u6570\u800c\u4e0d\u662f\u5b57\u7b26\u4e32\u8f93\u51fa \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728JSON\u8f93\u51fa\u4e2d\u4f7f\u7528\u679a\u4e3e\u503c\u7684\u540d\u79f0\u3002\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u9009\u9879\u4ee5\u4f7f\u7528\u679a\u4e3e\u503c\u7684\u6570\u503c\u3002 \u53ef\u7528\u9009\u9879 .proto \u6587\u4ef6\u4e2d\u7684\u5404\u4e2a\u58f0\u660e\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u9009\u9879\u8fdb\u884c\u6ce8\u91ca\u3002\u9009\u9879\u4e0d\u4f1a\u66f4\u6539\u58f0\u660e\u7684\u6574\u4f53\u542b\u4e49\uff0c\u4f46\u53ef\u80fd\u4f1a\u5f71\u54cd\u8be5\u58f0\u660e\u5728\u7279\u5b9a\u4e0a\u4e0b\u6587\u4e2d\u88ab\u5904\u7406\u7684\u65b9\u5f0f\u3002\u53ef\u7528\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\u5728 google/protobuf/descriptor.proto \u4e2d\u5b9a\u4e49\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u6587\u4ef6\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5728\u9876\u7ea7\u8303\u56f4\u5185\u7f16\u5199\uff0c\u800c\u4e0d\u662f\u5728\u4efb\u4f55 message \u3001 enum \u6216 service \u7684\u5b9a\u4e49\u4e2d\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u6d88\u606f\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5199\u5728 message \u5b9a\u4e49\u4e2d\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u5b57\u6bb5\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5199\u5728\u5b57\u6bb5\u5b9a\u4e49\u4e2d\u3002 \u53ef\u7528\u9009\u9879\u4e5f\u53ef\u4ee5\u5199\u5728\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u503c\uff0c\u670d\u52a1\u7c7b\u578b\u548c\u670d\u52a1\u65b9\u6cd5\u4e0a\uff0c\u4f46\u662f\uff0c\u76ee\u524d\u6ca1\u6709\u4efb\u4f55\u652f\u6301\u8fd9\u4e9b\u7684\u53ef\u7528\u9009\u9879\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e9b\u6700\u5e38\u7528\u7684\u9009\u9879\uff1a java_package \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u7528\u4e8e\u751f\u6210\u7684Java\u7c7b\u7684\u5305\u3002\u5982\u679c .proto \u6587\u4ef6\u4e2d\u6ca1\u6709\u7ed9\u51fa\u663e\u5f0f\u7684 java_package \u9009\u9879\uff0c\u90a3\u4e48\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u4f7f\u7528 proto \u5305\uff08. proto \u6587\u4ef6\u4e2d\u7684 \u201cpackage\u201d \u5173\u952e\u5b57\u6307\u5b9a\u7684\u5305\uff09\u3002\u4f46\u662f\uff0c proto \u5305\u901a\u5e38\u4e0d\u80fd\u751f\u6210\u597d\u7684 Java \u5305\uff0c\u56e0\u4e3a proto \u5305\u4e0d\u4f1a\u4ee5\u53cd\u5411\u57df\u540d\u5f00\u5934\u3002\u5982\u679c\u4e0d\u751f\u6210Java\u4ee3\u7801\uff0c\u5219\u6b64\u9009\u9879\u65e0\u6548\u3002 protobuf option java_package = \"com.example.foo\"; java_multiple_files \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u751f\u6210\u5728\u5305\u7ea7\u522b\u4e2d\u5b9a\u4e49\u7684\u9876\u7ea7 message \u3001 enum \u548c service \uff0c\u800c\u4e0d\u662f\u5728 .proto \u6587\u4ef6\u4e4b\u540e\u547d\u540d\u7684\u5916\u90e8\u7c7b\u4e2d\u3002 protobuf option java_multiple_files = true; java_outer_classname \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u751f\u6210\u6700\u5916\u5c42\u7684Java\u7c7b\u7684\u7c7b\u540d\uff08\u4ee5\u53ca\u6587\u4ef6\u540d\uff09\u3002\u5982\u679c .proto \u6587\u4ef6\u4e2d\u6ca1\u6709\u6307\u5b9a\u663e\u5f0f\u7684 java_outer_classname \uff0c\u5219\u901a\u8fc7\u5c06 .proto \u6587\u4ef6\u540d\u8f6c\u6362\u4e3a\u9a7c\u5cf0\u547d\u540d\u6765\u6784\u9020\u7c7b\u540d\uff08\u56e0\u6b64 foo_bar.proto \u53d8\u4e3a FooBar.java \uff09\u3002\u5982\u679c\u4e0d\u751f\u6210Java\u4ee3\u7801\uff0c\u5219\u6b64\u9009\u9879\u65e0\u6548\u3002 protobuf option java_outer_classname = \"Ponycopter\"; optimize_for\uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u53ef\u4ee5\u8bbe\u7f6e\u4e3a SPEED \uff0c CODE_SIZE \u6216 LITE_RUNTIME \u3002\u8fd9\u4f1a\u5f71\u54cd C++ \u548c Java \u4ee3\u7801\u751f\u6210\u5668\uff08\u53ef\u80fd\u8fd8\u6709\u7b2c\u4e09\u65b9\u751f\u6210\u5668\uff09\uff0c\u4ee5\u4e0b\u5217\u65b9\u5f0f\uff1a protobuf option optimize_for = CODE_SIZE; SPEED \uff08default\uff09\uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u7528\u4e8e\u5bf9\u6d88\u606f\u7c7b\u578b\u8fdb\u884c\u5e8f\u5217\u5316\u3001\u89e3\u6790\u548c\u6267\u884c\u5176\u4ed6\u5e38\u89c1\u64cd\u4f5c\u7684\u4ee3\u7801\u3002\u6b64\u4ee3\u7801\u7ecf\u8fc7\u9ad8\u5ea6\u4f18\u5316\u3002 CODE_SIZE \uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u6700\u5c0f\u7684\u7c7b\uff0c\u5e76\u4f9d\u8d56\u4e8e\u57fa\u4e8e\u53cd\u5c04\u7684\u5171\u4eab\u4ee3\u7801\u6765\u5b9e\u73b0\u5e8f\u5217\u5316\u3001\u89e3\u6790\u548c\u5404\u79cd\u5176\u4ed6\u64cd\u4f5c\u3002\u56e0\u6b64\u751f\u6210\u7684\u4ee3\u7801\u5c06\u6bd4\u4f7f\u7528 SPEED \u5c0f\u5f97\u591a\uff0c\u4f46\u64cd\u4f5c\u4f1a\u66f4\u6162\u3002\u751f\u6210\u7684\u7c7b\u4ecd\u5c06\u5b9e\u73b0\u4e0e SPEED \u6a21\u5f0f\u5b8c\u5168\u76f8\u540c\u7684\u516c\u5171API\u3002\u6b64\u6a21\u5f0f\u5728\u5305\u542b\u5927\u91cf .proto \u6587\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6700\u6709\u7528\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u6240\u6709\u8fd9\u4e9b\u6587\u4ef6\u90fd\u975e\u5e38\u5feb\u901f\u3002 LITE_RUNTIME \uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4ec5\u4f9d\u8d56\u4e8e \u201clite\u201d \u7684\u8fd0\u884c\u65f6\u5e93\u7684\u7c7b\uff08\u5373\u4f9d\u8d56\u4e8e libprotobuf-lite \u800c\u4e0d\u662f libprotobuf \uff09\u3002 lite \u8fd0\u884c\u65f6\u5e93\u6bd4\u5b8c\u6574\u5e93\u5c0f\u5f97\u591a\uff08\u5927\u7ea6\u5c0f\u4e00\u4e2a\u6570\u91cf\u7ea7\uff09\uff0c\u5176\u4e2d\u7701\u7565\u4e86\u63cf\u8ff0\u7b26\u548c\u53cd\u5c04\u7b49\u529f\u80fd\u3002\u8fd9\u5bf9\u4e8e\u5728\u79fb\u52a8\u7535\u8bdd\u7b49\u53d7\u9650\u5e73\u53f0\u4e0a\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u5c24\u5176\u6709\u7528\u3002\u7f16\u8bd1\u5668\u4ecd\u5c06\u751f\u6210\u6240\u6709\u65b9\u6cd5\u7684\u5feb\u901f\u5b9e\u73b0\uff0c\u5c31\u50cf\u5728 SPEED \u6a21\u5f0f\u4e0b\u90a3\u6837\u3002\u751f\u6210\u7684\u7c7b\u5c06\u4ec5\u5b9e\u73b0\u6bcf\u79cd\u8bed\u8a00\u7684 MessageLite \u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u4ec5\u63d0\u4f9b\u5b8c\u6574 Message \u63a5\u53e3\u7684\u65b9\u6cd5\u7684\u5b50\u96c6\u3002 ` cc_enable_arenas \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u4e3a C++ \u751f\u6210\u7684\u4ee3\u7801\u542f\u7528 \u7ade\u6280\u573a\u5206\u914d \u3002 objc_class_prefix \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u8bbe\u7f6e Objective-C \u7c7b\u524d\u7f00\uff0c\u8be5\u524d\u7f00\u7531\u6b64 .proto \u6587\u4ef6\u63d0\u4f9b\u7ed9\u6240\u6709 Objective-C \u751f\u6210\u7684\u7c7b\u548c\u679a\u4e3e\uff0c\u6ca1\u6709\u9ed8\u8ba4\u503c\u3002\u5e94\u8be5\u4f7f\u7528 Apple\u5efa\u8bae \u76843-5\u4e2a\u5927\u5199\u5b57\u7b26\u4e4b\u95f4\u7684\u524d\u7f00\u3002\u8bf7\u6ce8\u610f\uff0cApple\u4fdd\u7559\u6240\u67092\u4e2a\u5b57\u6bcd\u7684\u524d\u7f00\u3002 deprecated \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u5982\u679c\u8bbe\u7f6e\u4e3a true \uff0c\u5219\u8868\u793a\u8be5\u5b57\u6bb5\u5df2\u5f03\u7528\uff0c\u65b0\u4ee3\u7801\u4e0d\u5e94\u4f7f\u7528\u8be5\u5b57\u6bb5\u3002\u5728\u5927\u591a\u6570\u8bed\u8a00\u4e2d\uff0c\u8fd9\u6ca1\u6709\u5b9e\u9645\u6548\u679c\u3002\u5728 Java \u4e2d\uff0c\u8fd9\u5c06\u6210\u4e3a @Deprecated \u6ce8\u91ca\u3002\u5c06\u6765\uff0c\u5176\u4ed6\u7279\u5b9a\u8bed\u8a00\u7684\u4ee3\u7801\u751f\u6210\u5668\u53ef\u80fd\u4f1a\u5728\u5b57\u6bb5\u7684\u8bbf\u95ee\u5668\u4e0a\u751f\u6210\u5f03\u7528\u6ce8\u91ca\uff0c\u8fd9\u5c06\u5bfc\u81f4\u5728\u7f16\u8bd1\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5b57\u6bb5\u7684\u4ee3\u7801\u65f6\u53d1\u51fa\u8b66\u544a\u3002\u5982\u679c\u4efb\u4f55\u4eba\u90fd\u6ca1\u6709\u4f7f\u7528\u8be5\u5b57\u6bb5\uff0c\u5e76\u4e14\u60f3\u8981\u963b\u6b62\u65b0\u7528\u6237\u4f7f\u7528\u8be5\u5b57\u6bb5\uff0c\u8bf7\u8003\u8651\u4f7f\u7528 \u4fdd\u7559\u8bed\u53e5 \u66ff\u6362\u5b57\u6bb5\u58f0\u660e\u3002 protobuf int32 old_field = 6 [deprecated=true]; \u81ea\u5b9a\u4e49\u9009\u9879 Protocol Buffers \u8fd8\u5141\u8bb8\u5b9a\u4e49\u548c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u3002\u8fd9\u662f\u5927\u591a\u6570\u4eba\u4e0d\u9700\u8981\u7684 \u9ad8\u7ea7\u529f\u80fd \u3002\u5982\u679c\u786e\u5b9e\u8ba4\u4e3a\u9700\u8981\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\uff0c\u8bf7\u53c2\u9605 proto2 \u8bed\u8a00\u6307\u5357 \u4ee5\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\u3002\u8bf7\u6ce8\u610f\uff0c\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u4f7f\u7528\u7684 \u6269\u5c55 \u4ec5\u5141\u8bb8\u7528\u4e8e proto3 \u4e2d\u7684\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u3002 \u751f\u6210\u81ea\u5b9a\u4e49\u7684\u7c7b \u9700\u8981\u4f7f .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u6d88\u606f\u7c7b\u578b\u6765\u751f\u6210 Java \uff0c Python \uff0c C++ \uff0c Go \uff0c Ruby \uff0c Objective-C \u6216 C\uff03 \u4ee3\u7801\uff0c\u8fd9\u9700\u8981\u5728 .proto \u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 protoc \u3002\u5982\u679c\u5c1a\u672a\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7\u4e0b\u8f7d\u8be5\u8f6f\u4ef6\u5305\u5e76\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002\u5bf9\u4e8e Go \uff0c\u8fd8\u9700\u8981\u4e3a\u7f16\u8bd1\u5668\u5b89\u88c5\u4e00\u4e2a\u7279\u6b8a\u7684\u4ee3\u7801\u751f\u6210\u5668\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5728 GitHub \u4e0a\u7684 golang/protobuf \u5b58\u50a8\u5e93\u4e2d\u627e\u5230\u8fd9\u4e2a\u63d2\u4ef6\u548c\u5b89\u88c5\u8bf4\u660e\u3002 \u534f\u8bae\u7f16\u8bd1\u5668\u7684\u8c03\u7528\u5982\u4e0b\uff1a protoc --proto_path=IMPORT_PATH \\ --cpp_out=DST_DIR \\ --java_out=DST_DIR \\ --python_out=DST_DIR \\ --go_out=DST_DIR \\ --ruby_out=DST_DIR \\ --objc_out=DST_DIR \\ --csharp_out=DST_DIR \\ path/to/file.proto IMPORT_PATH \u6307\u5b9a\u89e3\u6790\u5bfc\u5165\u6307\u4ee4\u65f6\u67e5\u627e .proto \u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u5982\u679c\u7701\u7565\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u6b21\u4f20\u9012 --proto_path \u9009\u9879\u6765\u6307\u5b9a\u591a\u4e2a\u5bfc\u5165\u76ee\u5f55,\u5c06\u6309\u987a\u5e8f\u641c\u7d22\u3002 -I=IMPORT_PATH \u53ef\u4ee5\u7528\u4f5c --proto_path \u7684\u7f29\u5199\u5f62\u5f0f\u3002 \u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa\u6307\u4ee4\uff1a --cpp_out \u5728 DST_DIR \u4e2d\u751f\u6210 C++ \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 C++ \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --java_out \u5728 DST_DIR \u4e2d\u751f\u6210 Java \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Java \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --python_out \u5728 DST_DIR \u4e2d\u751f\u6210 Python \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Python \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --go_out \u5728 DST_DIR \u4e2d\u751f\u6210 Go \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Go \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --ruby_out \u5728 DST_DIR \u4e2d\u751f\u6210 Ruby \u4ee3\u7801\u3002 Ruby \u751f\u6210\u7684\u4ee3\u7801\u53c2\u8003\u5373\u5c06\u63a8\u51fa\uff01 --objc_out \u5728 DST_DIR \u4e2d\u751f\u6210 Objective-C \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Objective-C \u751f\u6210\u7684\u4ee3\u7801\u53c2\u8003 \u3002 --csharp_out \u5728 DST_DIR \u4e2d\u751f\u6210 C\uff03 \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 C\uff03 \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --php_out \u5728 DST_DIR \u4e2d\u751f\u6210 PHP \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 PHP \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 \u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5982\u679c DST_DIR \u4ee5 .zip \u6216. jar \u7ed3\u5c3e\uff0c\u7f16\u8bd1\u5668\u4f1a\u5c06\u8f93\u51fa\u5199\u5165\u5177\u6709\u7ed9\u5b9a\u540d\u79f0\u7684\u5355\u4e2a ZIP \u683c\u5f0f\u5b58\u6863\u6587\u4ef6\u3002 .jar \u8f93\u51fa\u8fd8\u5c06\u6839\u636e Java JAR \u89c4\u8303\u7684\u8981\u6c42\u63d0\u4f9b\u6e05\u5355\u6587\u4ef6\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u8f93\u51fa\u5b58\u6863\u5df2\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u8986\u76d6; \u7f16\u8bd1\u5668\u4e0d\u591f\u667a\u80fd\uff0c\u65e0\u6cd5\u5c06\u6587\u4ef6\u6dfb\u52a0\u5230\u73b0\u6709\u5b58\u6863\u4e2d\u3002 \u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u6216\u591a\u4e2a .proto \u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\u3002\u53ef\u4ee5\u4e00\u6b21\u6307\u5b9a\u591a\u4e2a .proto \u6587\u4ef6\u3002\u867d\u7136\u6587\u4ef6\u662f\u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u547d\u540d\u7684\uff0c\u4f46\u6bcf\u4e2a\u6587\u4ef6\u5fc5\u987b\u9a7b\u7559\u5728\u5176\u4e2d\u4e00\u4e2a IMPORT_PATH \u4e2d\uff0c\u4ee5\u4fbf\u7f16\u8bd1\u5668\u53ef\u4ee5\u786e\u5b9a\u5176\u89c4\u8303\u540d\u79f0\u3002","title":"`proto3`\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#proto3","text":"\u672c\u6307\u5357\u4ecb\u7ecd\u5982\u4f55\u4f7f\u7528 protocol buffers \u8bed\u8a00\u6784\u5efa protocol buffers \u6570\u636e\uff0c\u5305\u62ec\uff1a .proto \u6587\u4ef6\u8bed\u6cd5 \u5982\u4f55\u4ece .proto \u6587\u4ef6\u751f\u6210\u6570\u636e\u8bbf\u95ee\u7c7b \u5b83\u6db5\u76d6\u4e86 protocol buffers \u8bed\u8a00\u7684 proto3 \u7248\u672c\uff1a\u6709\u5173\u8f83\u65e9\u7684 proto2 \u8bed\u6cd5\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Proto2 \u8bed\u8a00\u6307\u5357 \u3002 \u8fd9\u662f\u4e00\u4e2a\u53c2\u8003\u6307\u5357\uff0c\u5bf9\u4e8e\u4f7f\u7528\u672c\u6587\u6863\u4e2d\u63cf\u8ff0\u7684\u8bb8\u591a\u529f\u80fd\u7684\u5206\u6b65\u793a\u4f8b\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u6559\u7a0b \uff08\u76ee\u524d\u4ec5\u9650 proto 2;\u66f4\u591a proto3 \u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002","title":"proto3\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_1","text":"\u9996\u5148\u770b\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u4f8b\u5b50\u3002\u5047\u8bbe\u8981\u5b9a\u4e49\u641c\u7d22\u8bf7\u6c42\u6d88\u606f\u683c\u5f0f\uff0c\u5176\u4e2d\u6bcf\u4e2a\u641c\u7d22\u8bf7\u6c42\u90fd\u6709\uff1a \u4e00\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u67e5\u8be2 \u6240\u67e5\u8be2\u7684\u7279\u5b9a\u9875\u7801 \u6bcf\u9875\u8fd4\u56de\u7684\u7ed3\u679c\u6570 \u8fd9\u662f\u7528\u4e8e\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u7684 .proto \u6587\u4ef6\u3002 syntax = proto3 ; // \u6307\u5b9a\u6b63\u5728\u4f7f\u7528proto3\u8bed\u6cd5\uff0c\u9ed8\u8ba4\u8ba4\u4e3a\u4f7f\u7528proto2\uff0c\u5fc5\u987b\u662f\u6587\u4ef6\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u6ce8\u91ca\u884c message SearchRequest { // \u6d88\u606f\u683c\u5f0f\u4ee5\u540d\u79f0-\u503c\u5bf9\u7684\u5f62\u5f0f\u6307\u5b9a\u4e09\u4e2a\u5b57\u6bb5 string query = 1; // \u6bcf\u4e2a\u5b57\u6bb5\u6709\u4e00\u4e2a\u540d\u79f0\u548c\u7c7b\u578b int32 page_number = 2; int32 result_per_page = 3; }","title":"\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_2","text":"\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6240\u6709\u7684\u5b57\u6bb5\u90fd\u662f \u6807\u91cf\u7c7b\u578b \uff1a\u4e24\u4e2a\u6574\u578b\u4e00\u4e2a\u5b57\u7b26\u4e32\u7c7b\u578b\u3002\u540c\u65f6\u4e5f\u53ef\u4ee5\u7ed9\u5b57\u6bb5\u6307\u5b9a\u7ec4\u5408\u7c7b\u578b\uff08\u5305\u62ec \u679a\u4e3e \u6216\u5176\u4ed6\u7c7b\u578b\uff09\u3002","title":"\u6307\u5b9a\u5b57\u6bb5\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_3","text":"\u5982\u4e0a\u6240\u793a\uff0c\u6d88\u606f\u5b9a\u4e49\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u5b9a\u4e49\u4e00\u4e2a \u552f\u4e00\u7684\u7f16\u53f7 \u3002\u8fd9\u4e9b\u5b57\u6bb5\u7684\u7f16\u53f7\u7528\u4e8e\u5728\u6d88\u606f\u7684 \u4e8c\u8fdb\u5236\u683c\u5f0f \u4e2d\u6807\u8bc6\u5b57\u6bb5\uff0c\u4e00\u65e6\u6d88\u606f\u7c7b\u578b\u88ab\u4f7f\u7528\u5c31\u4e0d\u80fd\u518d\u66f4\u6539\u3002\u8bf7\u6ce8\u610f\uff1a 1\u523015 \u8303\u56f4\u5185\u7684\u5b57\u6bb5\u7f16\u53f7\u9700\u8981\u4e00\u4e2a\u5b57\u8282\u8fdb\u884c\u7f16\u7801\uff0c\u5305\u62ec\u5b57\u6bb5\u7684\u7f16\u53f7\u548c\u5b57\u6bb5\u7684\u7c7b\u578b\uff08\u53ef\u4ee5\u5728 protocol buffers \u7f16\u7801 \u4e2d\u627e\u5230\u66f4\u591a\u76f8\u5173\u4fe1\u606f\uff09 16\u52302047 \u8303\u56f4\u5185\u7684\u5b57\u6bb5\u7f16\u53f7\u5360\u7528\u4e24\u4e2a\u5b57\u8282\u3002 \u56e0\u6b64\uff0c\u5e94\u8be5\u4e3a\u975e\u5e38\u9891\u7e41\u51fa\u73b0\u7684\u6d88\u606f\u5143\u7d20\u4fdd\u7559\u6570\u5b571\u523015\uff0c\u8bf7\u8bb0\u4f4f\u4e3a\u5c06\u6765\u53ef\u80fd\u6dfb\u52a0\u7684\u9891\u7e41\u51fa\u73b0\u7684\u5143\u7d20\u7559\u51fa\u4e00\u4e9b\u7a7a\u95f4 \u53ef\u4ee5\u6307\u5b9a\u7684\u6700\u5c0f\u5b57\u6bb5\u6570\u4e3a1\uff0c\u6700\u5927\u5b57\u6bb5\u6570\u4e3a536,870,911\uff082\u768429\u6b21\u65b9-1\uff09\u3002 \u4e0d\u80fd\u4f7f\u7528\u6570\u5b5719000\u523019999\uff08 FieldDescriptor::kFirstReservedNumber \u5230 FieldDescriptor::kLastReservedNumber \uff09\uff0c\u56e0\u4e3a\u5b83\u4eec\u662f\u4e3a protocol buffers \u5b9e\u73b0\u800c\u4fdd\u7559\u7684\u3002 \u5982\u679c\u5728 .proto \u4e2d\u4f7f\u7528\u8fd9\u4e9b\u4fdd\u7559\u6570\u5b57\u4e4b\u4e00\uff0c protocol buffers \u7f16\u8bd1\u5668\u4f1a\u53d1\u51fa\u8b66\u544a\u3002\u540c\u6837\uff0c\u4e0d\u80fd\u4f7f\u7528\u4efb\u4f55\u4ee5\u524d \u4fdd\u7559 \u7684\u5b57\u6bb5\u7f16\u53f7\u3002","title":"\u5206\u914d\u5b57\u6bb5\u7f16\u53f7"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_4","text":"\u6d88\u606f\u7684\u5b57\u6bb5\u53ef\u4ee5\u662f\u4ee5\u4e0b\u4e4b\u4e00\uff1a \u5355\u6570\uff1a\u683c\u5f0f\u826f\u597d\u7684\u6d88\u606f\u53ef\u4ee5\u5305\u542b\u96f6\u4e2a\u6216\u4e00\u4e2a\uff08\u4f46\u4e0d\u8d85\u8fc7\u4e00\u4e2a\uff09\u8fd9\u6837\u7684\u5b57\u6bb5\u3002\u8fd9\u662f proto3 \u8bed\u6cd5\u7684\u9ed8\u8ba4\u5b57\u6bb5\u89c4\u5219\u3002 \u91cd\u590d\uff1a\u8be5\u5b57\u6bb5\u53ef\u4ee5\u5728\u683c\u5f0f\u826f\u597d\u7684\u6d88\u606f\u4e2d\u91cd\u590d\u4efb\u610f\u6b21\u6570\uff08\u5305\u62ec\u96f6\uff09\u3002\u5c06\u4fdd\u7559\u91cd\u590d\u503c\u7684\u987a\u5e8f\u3002 \u5728 proto3 \u4e2d\uff0c\u6807\u91cf\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\u9ed8\u8ba4\u4f7f\u7528 \u538b\u7f29 \u7f16\u7801\u3002 \u5728 Protocol Buffer Encoding \u4e2d\u627e\u5230\u6709\u5173\u538b\u7f29\u7f16\u7801\u7684\u66f4\u591a\u4fe1\u606f\u3002","title":"\u81ea\u5b9a\u5b57\u6bb5\u89c4\u5219"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_5","text":"\u53ef\u4ee5\u5728\u5355\u4e2a .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u591a\u79cd\u6d88\u606f\u7c7b\u578b\u3002\u5982\u679c\u8981\u5b9a\u4e49\u591a\u4e2a\u76f8\u5173\u6d88\u606f\uff0c\u8fd9\u975e\u5e38\u6709\u7528\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8981\u5b9a\u4e49\u4e0e SearchResponse \u6d88\u606f\u7c7b\u578b\u5bf9\u5e94\u7684\u56de\u590d\u6d88\u606f\u683c\u5f0f\uff0c\u5219\u53ef\u4ee5\u5c06\u5176\u6dfb\u52a0\u5230\u76f8\u540c\u7684 .proto \uff1a message SearchRequest { string query = 1; int32 page_number = 2; int32 result_per_page = 3; } message SearchResponse { ... }","title":"\u6dfb\u52a0\u66f4\u591a\u6d88\u606f\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_6","text":"\u8981\u4e3a .proto \u6587\u4ef6\u6dfb\u52a0\u6ce8\u91ca\uff0c\u8bf7\u4f7f\u7528 C/C++ \u6837\u5f0f // \u548c /* ... */ \u8bed\u6cd5\u3002 /* SearchRequest \u4ee3\u8868\u4e00\u4e2a\u67e5\u8be2\u8bf7\u6c42, * \u5e26\u6709\u5206\u9875\u9009\u9879\u4ee5\u6307\u793a\u8981\u5305\u542b\u5728\u54cd\u5e94\u4e2d\u7684\u7ed3\u679c\u3002*/ message SearchRequest { string query = 1; int32 page_number = 2; // \u6211\u4eec\u9700\u8981\u7684\u9875\u7801 int32 result_per_page = 3; // \u6bcf\u9875\u8fd4\u56de\u7684\u7ed3\u679c\u6570 }","title":"\u6dfb\u52a0\u6ce8\u91ca"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_7","text":"\u5982\u679c\u901a\u8fc7\u5b8c\u5168\u5220\u9664\u5b57\u6bb5\u6216\u5c06\u5176\u6ce8\u91ca\u6765 \u66f4\u65b0 \u6d88\u606f\u7c7b\u578b\uff0c\u672a\u6765\u7684\u7528\u6237\u53ef\u4ee5\u5728\u5bf9\u7c7b\u578b\u8fdb\u884c\u66f4\u65b0\u65f6\u518d\u6b21\u4f7f\u7528\u8be5\u5b57\u6bb5\u7f16\u53f7\u3002\u5982\u679c\u4ee5\u540e\u52a0\u8f7d\u76f8\u540c .proto \u6587\u4ef6\u7684\u65e7\u7248\u672c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u95ee\u9898\uff0c\u5305\u62ec\u6570\u636e\u635f\u574f\uff0c\u9690\u79c1\u9519\u8bef\u7b49\u3002\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd\u65b9\u6cd5\u662f \u6307\u5b9a\u5df2\u5220\u9664\u5b57\u6bb5\u6216\u5b57\u6bb5\u7684\u7f16\u53f7\u4e3a\u4fdd\u7559\u7684 \uff08\u5e76\u4e14/\u6216\u547d\u540d\u53ef\u80fd\u5bfc\u81f4JSON\u5e8f\u5217\u5316\u95ee\u9898\uff09\u3002\u5982\u679c\u5c06\u6765\u7684\u4efb\u4f55\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e9b\u5b57\u6bb5\u6807\u8bc6\u7b26\uff0c protocol buffers \u7f16\u8bd1\u5668\u5c06\u4f1a\u53d1\u51fa\u8b66\u544a\u3002 message Foo { reserved 2, 15, 9 to 11; reserved foo , bar ; } \u8bf7\u6ce8\u610f\uff0c\u4e0d\u80fd\u5728\u540c\u4e00\u4fdd\u7559\u8bed\u53e5\u4e2d\u6df7\u5408\u5b57\u6bb5\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002","title":"\u4fdd\u7559\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#proto","text":"\u5728 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 \u65f6\uff0c\u7f16\u8bd1\u5668\u4f1a\u6839\u636e\u6587\u4ef6\u4e2d\u7684\u63cf\u8ff0\u751f\u6210\u6240\u9009\u8bed\u8a00\u7684\u4ee3\u7801\uff0c\u8fd9\u4e9b\u4ee3\u7801\u662f\u9700\u8981\u4f7f\u7528\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u5305\u62ec\uff1a\u83b7\u53d6\u548c\u8bbe\u7f6e\u5b57\u6bb5\u503c\uff0c\u5c06\u6d88\u606f\u5e8f\u5217\u5316\u4e3a\u8f93\u51fa\u6d41\uff0c\u5e76\u4ece\u8f93\u5165\u6d41\u4e2d\u89e3\u6790\u6d88\u606f\u3002 \u5bf9\u4e8e C++ \uff0c\u7f16\u8bd1\u5668\u4f1a\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a .h \u548c .cc \u6587\u4ef6\uff0c\u5e76\u4e3a\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u63d0\u4f9b\u4e00\u4e2a\u7c7b\u3002 \u5bf9\u4e8e Java \uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a .java \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\uff0c\u4ee5\u53ca\u7528\u4e8e\u521b\u5efa\u6d88\u606f\u7c7b\u5b9e\u4f8b\u7684\u7279\u6b8a Builder \u7c7b\u3002 Python \u6709\u70b9\u4e0d\u540c\uff1a Python \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u6a21\u5757\uff0c\u5176\u4e2d\u5305\u542b .proto \u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u9759\u6001\u63cf\u8ff0\u7b26\uff0c\u7136\u540e\u4e0e\u5143\u7c7b\u4e00\u8d77\u4f7f\u7528\uff0c\u4ee5\u5728\u8fd0\u884c\u65f6\u521b\u5efa\u5fc5\u8981\u7684 Python \u6570\u636e\u8bbf\u95ee\u7c7b\u3002 \u5bf9\u4e8e Go \uff0c\u7f16\u8bd1\u5668\u4f1a\u751f\u6210\u4e00\u4e2a .pb.go \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u578b\u3002 \u5bf9\u4e8e Ruby \uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u5305\u542b\u6d88\u606f\u7c7b\u578b\u7684 Ruby \u6a21\u5757\u7684 .rb \u6587\u4ef6\u3002 \u5bf9\u4e8e Objective-C \uff0c\u7f16\u8bd1\u5668\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a pbobjc.h \u548c pbobjc.m \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u5bf9\u4e8e C\uff03 \uff0c\u7f16\u8bd1\u5668\u4ece\u6bcf\u4e2a .proto \u751f\u6210\u4e00\u4e2a .cs \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u63cf\u8ff0\u7684\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u5bf9\u4e8e Dart \uff0c\u7f16\u8bd1\u5668\u4f1a\u751f\u6210\u4e00\u4e2a .pb.dart \u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u4e2d\u6bcf\u79cd\u6d88\u606f\u7c7b\u578b\u7684\u7c7b\u3002 \u53ef\u4ee5\u6309\u7167\u6240\u9009\u8bed\u8a00\u7684\u6559\u7a0b\uff08\u5373\u5c06\u63a8\u51fa\u7684proto3\u7248\u672c\uff09\u4e86\u89e3\u6709\u5173\u4e3a\u6bcf\u79cd\u8bed\u8a00\u4f7f\u7528API\u200b\u200b\u7684\u66f4\u591a\u4fe1\u606f\u3002\u6709\u5173\u66f4\u591aAPI\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u76f8\u5173 API\u53c2\u8003 \uff08proto3\u7248\u672c\u5373\u5c06\u63a8\u51fa\uff09\u3002","title":".proto\u6587\u4ef6\u5c06\u751f\u6210\u4ec0\u4e48"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_8","text":"\u6807\u91cf\u6d88\u606f\u5b57\u6bb5\u53ef\u4ee5\u5177\u6709\u4ee5\u4e0b\u7c7b\u578b\u4e4b\u4e00\uff1a\u8be5\u8868\u663e\u793a .proto \u6587\u4ef6\u4e2d\u6307\u5b9a\u7684\u7c7b\u578b\uff0c\u4ee5\u53ca\u81ea\u52a8\u751f\u6210\u7684\u7c7b\u4e2d\u7684\u76f8\u5e94\u7c7b\u578b\uff1a .proto \u7c7b\u578b \u6ce8\u91ca Go\u7c7b\u578b double float64 float float32 int32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u7f16\u7801\u8d1f\u6570\u7684\u6548\u7387\u4f4e\uff08\u5982\u679c\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u6539\u7528sint32\uff09 int32 int64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u7f16\u7801\u8d1f\u6570\u7684\u6548\u7387\u4f4e\uff08\u5982\u679c\u5b57\u6bb5\u53ef\u80fd\u6709\u8d1f\u503c\uff0c\u6539\u7528sint64\uff09 int64 uint32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801 uint32 uint64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801 uint64 sint32 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u6709\u7b26\u53f7int\u503c\uff08\u8fd9\u6bd4\u5e38\u89c4int32\u66f4\u6709\u6548\u5730\u7f16\u7801\u8d1f\u6570\uff09 int32 sint64 \u4f7f\u7528\u53ef\u53d8\u957f\u5ea6\u7f16\u7801\uff0c\u6709\u7b26\u53f7int\u503c\uff08\u8fd9\u6bd4\u5e38\u89c4int64\u66f4\u6709\u6548\u5730\u7f16\u7801\u8d1f\u6570\uff09 int64 fixed32 \u603b\u662f\u56db\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u503c\u5927\u4e8e2\u768428\u6b21\u65b9\u5219\u6bd4uint32\u66f4\u6709\u6548 uint32 fixed64 \u603b\u662f\u516b\u4e2a\u5b57\u8282\uff0c\u5982\u679c\u503c\u5927\u4e8e2\u768456\u6b21\u65b9\u5219\u6bd4uint32\u66f4\u6709\u6548 uint64 sfixed32 \u603b\u662f\u56db\u4e2a\u5b57\u8282 int32 sfixed64 \u603b\u662f\u516b\u4e2a\u5b57\u8282 int64 bool bool string \u5b57\u7b26\u4e32\u5fc5\u987b\u59cb\u7ec8\u5305\u542bUTF-8\u7f16\u7801\u62167\u4f4dASCII\u6587\u672c\uff0c\u4e14\u4e0d\u80fd\u8d85\u8fc72\u768432\u6b21\u65b9 string bytes \u53ef\u4ee5\u5305\u542b\u4e0d\u8d85\u8fc72\u768432\u6b21\u65b9\u7684\u4efb\u610f\u5b57\u8282\u5e8f\u5217 []bytes \u5728 protocol buffers \u7f16\u7801 \u4e2d\u53ef\u4ee5\u627e\u5230\u66f4\u591a\u5173\u4e8e\u5728\u5e8f\u5217\u5316\u6d88\u606f\u65f6\u8fd9\u4e9b\u7c7b\u578b\u662f\u5982\u4f55\u88ab\u7f16\u7801\u7684\u4fe1\u606f\u3002","title":"\u6807\u91cf\u503c\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_9","text":"\u5728\u89e3\u6790\u6d88\u606f\u65f6\uff0c\u5982\u679c\u7f16\u7801\u6d88\u606f\u4e0d\u5305\u542b\u67d0\u4e2a\u7279\u5b9a\u7684\u5355\u6570\u5143\u7d20\uff0c\u5219\u89e3\u6790\u5bf9\u8c61\u4e2d\u76f8\u5e94\u7684\u5b57\u6bb5\u5c06\u88ab\u8bbe\u7f6e\u4e3a\u8be5\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\u8fd9\u4e9b\u9ed8\u8ba4\u503c\u6839\u636e\u7c7b\u578b\u800c\u4e0d\u540c\uff1a \u5bf9\u4e8e\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 \u5bf9\u4e8e\u5b57\u8282\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u8282\u3002 \u5bf9\u4e8e\u5e03\u5c14\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3afalse\u3002 \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a\u96f6\u3002 \u5bf9\u4e8e \u679a\u4e3e \uff0c\u9ed8\u8ba4\u503c\u662f \u7b2c\u4e00\u4e2a\u5b9a\u4e49\u7684\u679a\u4e3e\u503c \uff0c\u8be5\u503c\u5fc5\u987b\u4e3a0\u3002 \u5bf9\u4e8e\u6d88\u606f\u5b57\u6bb5\uff0c\u672a\u8bbe\u7f6e\u8be5\u5b57\u6bb5\u3002\u5b83\u7684\u786e\u5207\u503c\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002 \u91cd\u590d\uff08repeated\uff09\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u4e3a\u7a7a\uff08\u901a\u5e38\u662f\u76f8\u5e94\u7f16\u7a0b\u8bed\u8a00\u7684\u7a7a\u5217\u8868\uff09\u3002 \u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e \u6807\u91cf\u6d88\u606f\u5b57\u6bb5 \uff0c\u4e00\u65e6\u89e3\u6790\u4e86\u6d88\u606f\uff0c\u5c31\u65e0\u6cd5\u786e\u5b9a\u5b57\u6bb5\u662f\u5426\u663e\u5f0f\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\uff08\u4f8b\u5982\uff0c\u5e03\u5c14\u503c\u662f\u5426\u8bbe\u7f6e\u4e3a false \uff09\u6216\u6839\u672c\u6ca1\u6709\u8bbe\u7f6e\u503c\uff0c\u56e0\u6b64\uff0c\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u65f6\u8981\u6ce8\u610f\u3002\u4f8b\u5982\uff0c\u5982\u679c\u4e0d\u5e0c\u671b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u53d1\u751f\u8fd9\u79cd\u884c\u4e3a\uff0c\u90a3\u4e48\u5f53\u8bbe\u7f6e\u4e3a false \u65f6\uff0c\u6ca1\u6709\u4e00\u4e2a\u5e03\u5c14\u503c\u53ef\u4ee5\u6253\u5f00\u67d0\u4e9b\u884c\u4e3a\u3002\u53e6\u5916\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u6807\u91cf\u6d88\u606f\u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u5176\u9ed8\u8ba4\u503c\uff0c\u5219\u8be5\u503c\u4e0d\u4f1a\u5728\u4f20\u8f93\u65f6\u5e8f\u5217\u5316\u3002 \u6709\u5173\u9ed8\u8ba4\u503c\u5982\u4f55\u5728\u751f\u6210\u7684\u4ee3\u7801\u4e2d\u5de5\u4f5c\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002","title":"\u9ed8\u8ba4\u503c"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_10","text":"\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u65f6\uff0c\u53ef\u80fd\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u53ea\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u503c\u5217\u8868\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u8981\u4e3a\u6bcf\u4e2a SearchRequest \u6dfb\u52a0\u8bed\u6599\u5e93\uff08 corups \uff09\u5b57\u6bb5\uff0c\u5176\u4e2d\u8bed\u6599\u5e93\u53ef\u4ee5\u662f UNIVERSAL \uff0c WEB \uff0c IMAGES \uff0c LOCAL \uff0c NEWS \uff0c PRODUCTS \u6216 VIDEO \u3002\u53ef\u4ee5\u975e\u5e38\u7b80\u5355\u5730\u901a\u8fc7\u5411\u6d88\u606f\u5b9a\u4e49\u6dfb\u52a0\u679a\u4e3e\uff08 enum \uff09\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u53ef\u80fd\u7684\u503c\u6dfb\u52a0\u5e38\u91cf\u3002 \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6dfb\u52a0\u4e86\u4e00\u4e2a\u540d\u4e3a Corpus \u7684\u679a\u4e3e\uff0c\u5176\u4e2d\u5305\u542b\u6240\u6709\u53ef\u80fd\u7684\u503c\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7c7b\u578b\u4e3aCorpus\u7684\u5b57\u6bb5\uff1a message SearchRequest { string query = 1; int32 page_number = 2; int32 result_per_page = 3; enum Corpus { UNIVERSAL = 0; WEB = 1; IMAGES = 2; LOCAL = 3; NEWS = 4; PRODUCTS = 5; VIDEO = 6; } Corpus corpus = 4; } \u5982\u4e0a\u6240\u793a\uff0c Corpus \u679a\u4e3e\u7684\u7b2c\u4e00\u4e2a\u5e38\u91cf\u6620\u5c04\u4e3a\u96f6\uff1a\u6bcf\u4e2a\u679a\u4e3e\u5b9a\u4e49 \u5fc5\u987b \u5305\u542b\u4e00\u4e2a\u6620\u5c04\u5230\u96f6\u7684\u5e38\u91cf\u4f5c\u4e3a\u5176\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\u8fd9\u662f\u56e0\u4e3a\uff1a \u5fc5\u987b\u6709\u4e00\u4e2a\u96f6\u503c\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u4f7f\u75280\u4f5c\u4e3a\u6570\u5b57 \u9ed8\u8ba4\u503c \u3002 \u96f6\u503c\u5fc5\u987b\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0c\u4ee5\u4fbf\u4e0e proto2 \u8bed\u4e49\u517c\u5bb9\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u679a\u4e3e\u503c\u59cb\u7ec8\u662f\u9ed8\u8ba4\u503c\u3002 \u53ef\u4ee5\u901a\u8fc7\u4e3a\u4e0d\u540c\u7684\u679a\u4e3e\u5e38\u91cf\u6307\u5b9a\u76f8\u540c\u7684\u503c\u6765\u5b9a\u4e49\u522b\u540d\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u5c06 allow_alias \u9009\u9879\u8bbe\u7f6e\u4e3a true \uff0c\u5426\u5219 proto \u7f16\u8bd1\u5668\u5c06\u5728\u627e\u5230\u522b\u540d\u65f6\u751f\u6210\u9519\u8bef\u6d88\u606f\u3002 enum EnumAllowingAlias { option allow_alias = true; // \u5f00\u542f\u914d\u7f6e UNKNOWN = 0; STARTED = 1; RUNNING = 1; } enum EnumNotAllowingAlias { UNKNOWN = 0; STARTED = 1; // RUNNING = 1; // \u53d6\u6d88\u6ce8\u91ca\u6b64\u884c\u5c06\u5bfc\u81f4Google\u5185\u90e8\u7684\u7f16\u8bd1\u9519\u8bef\u548c\u5916\u90e8\u7684\u8b66\u544a\u6d88\u606f\u3002 } \u679a\u4e3e\u5e38\u91cf\u5fc5\u987b\u572832\u4f4d\u6574\u6570\u8303\u56f4\u5185\u3002\u7531\u4e8e\u679a\u4e3e\u503c\u5728\u4f20\u8f93\u65f6\u4f7f\u7528 varint \u7f16\u7801 \uff0c\u56e0\u6b64\uff0c\u8d1f\u503c\u6548\u7387\u4f4e\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002\u53ef\u4ee5\u5728\u6d88\u606f\u5b9a\u4e49\u4e2d\u5b9a\u4e49\u679a\u4e3e\uff0c\u5982\u4e0a\u4f8b\u6240\u793a\uff0c\u4e5f\u53ef\u4ee5\u5728\u5916\u90e8\u5b9a\u4e49\u679a\u4e3e\uff0c\u8fd9\u4e9b\u679a\u4e3e\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u7684\u4efb\u4f55\u6d88\u606f\u5b9a\u4e49\u4e2d\u91cd\u7528\u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u8bed\u6cd5 MessageType.EnumType \u5c06\u4e00\u4e2a\u6d88\u606f\u4e2d\u58f0\u660e\u7684\u679a\u4e3e\u7c7b\u578b\u7528\u4f5c\u4e0d\u540c\u6d88\u606f\u4e2d\u5b57\u6bb5\u7684\u7c7b\u578b\u3002 \u5728\u4f7f\u7528\u679a\u4e3e\u7684 .proto \u6587\u4ef6\u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668\u65f6\uff0c\u751f\u6210\u7684\u4ee3\u7801\u5c06\u5177\u6709\u76f8\u5e94\u7684 Java \u6216 C++ \u679a\u4e3e\u7c7b\u578b\uff0c\u5728Python\u4e2d\u4f7f\u7528\u4e00\u4e2a\u7279\u6b8a\u7684 EnumDescriptor \u7c7b\uff0c\u7528\u4e8e\u5728\u8fd0\u884c\u65f6\u751f\u6210\u7c7b\u4e2d\u521b\u5efa\u4e00\u7ec4\u5e26\u6709\u6574\u6570\u503c\u7684\u7b26\u53f7\u5e38\u91cf\u3002 \u5728\u53cd\u5e8f\u5217\u5316\u671f\u95f4\uff0c\u65e0\u6cd5\u8bc6\u522b\u7684\u679a\u4e3e\u503c\u5c06\u4fdd\u7559\u5728\u6d88\u606f\u4e2d\uff0c\u5982\u4f55\u8868\u793a\u8fd9\u79cd\u503c\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u7f16\u7a0b\u8bed\u8a00\u3002 \u5728\u652f\u6301\u5177\u6709\u8d85\u51fa\u6307\u5b9a\u7b26\u53f7\u8303\u56f4\u7684\u503c\u7684\u5f00\u653e\u679a\u4e3e\u7c7b\u578b\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff08\u4f8b\u5982 C++ \u548c Go \uff09\uff0c\u672a\u77e5\u7684\u679a\u4e3e\u503c\u4ec5\u4f5c\u4e3a\u5176\u57fa\u7840\u6574\u6570\u8868\u793a\u5b58\u50a8\u3002 \u5728\u652f\u6301\u5c01\u95ed\u679a\u4e3e\u7c7b\u578b\uff08\u5982 Java \uff09\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u679a\u4e3e\u4e2d\u7684\u5927\u5c0f\u5199\u7528\u4e8e\u8868\u793a\u65e0\u6cd5\u8bc6\u522b\u7684\u503c\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u7279\u6b8a\u8bbf\u95ee\u5668\u8bbf\u95ee\u57fa\u7840\u6574\u6570\u3002 \u5728\u4efb\u4f55\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u6d88\u606f\u88ab\u5e8f\u5217\u5316\u4e86\uff0c\u90a3\u4e48\u65e0\u6cd5\u8bc6\u522b\u7684\u503c\u4ecd\u7136\u4f1a\u548c\u6d88\u606f\u4e00\u8d77\u88ab\u5e8f\u5217\u5316\u3002 \u6709\u5173\u5982\u4f55\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6d88\u606f\u679a\u4e3e\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684 \u751f\u6210\u4ee3\u7801\u6307\u5357 \u3002","title":"\u679a\u4e3e"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_11","text":"\u5982\u679c\u901a\u8fc7\u5b8c\u5168\u5220\u9664\u679a\u4e3e\u6761\u76ee\u6216\u5c06\u5176\u6ce8\u91ca\u6389\u6765 \u66f4\u65b0 \u679a\u4e3e\u7c7b\u578b\uff0c\u90a3\u4e48\u672a\u6765\u7684\u7528\u6237\u53ef\u4ee5\u5728\u5bf9\u7c7b\u578b\u8fdb\u884c\u66f4\u65b0\u65f6\u91cd\u7528\u8be5\u6570\u503c\u3002\u5982\u679c\u540e\u9762\u53c8\u52a0\u8f7d\u76f8\u540c .proto \u6587\u4ef6\u7684\u65e7\u7248\u672c\uff0c\u8fd9\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e25\u91cd\u95ee\u9898\uff08\u5305\u62ec\u6570\u636e\u635f\u574f\uff0c\u9690\u79c1\u9519\u8bef\u7b49\uff09\u3002\u786e\u4fdd\u4e0d\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u7684\u4e00\u79cd\u65b9\u6cd5\u662f\u8bbe\u7f6e\u5df2\u5220\u9664\u6761\u76ee\u7684\u6570\u503c\uff08\u548c / \u6216\u540d\u79f0\uff0c\u4e5f\u53ef\u80fd\u5bfc\u81f4JSON\u5e8f\u5217\u5316\u95ee\u9898\uff09\uff09\u4e3a reserved \u3002\u5982\u679c\u5c06\u6765\u7684\u4efb\u4f55\u7528\u6237\u5c1d\u8bd5\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bc6\u7b26\uff0c protocol buffers \u7f16\u8bd1\u5668\u5c06\u4f1a\u53d1\u51fa\u8b66\u544a\u3002\u53ef\u4ee5\u4f7f\u7528 max \u5173\u952e\u5b57\u6307\u5b9a\u4fdd\u7559\uff08 reserved \uff09\u7684\u6570\u503c\u8303\u56f4\u8fbe\u5230\u6700\u5927\u53ef\u80fd\u503c\u3002 enum Foo { reserved 2, 15, 9 to 11, 40 to max; reserved FOO , BAR ; } \u8bf7\u6ce8\u610f\uff0c\u4e0d\u80fd\u5728\u540c\u4e00\u4fdd\u7559\uff08 reserved \uff09\u8bed\u53e5\u4e2d\u6df7\u5408\u5b57\u6bb5\u540d\u79f0\u548c\u6570\u503c\u3002","title":"\u4fdd\u7559\u503c"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_12","text":"\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u5728\u6bcf\u4e2a SearchResponse \u6d88\u606f\u4e2d\u5305\u542b Result \u6d88\u606f\uff0c\u4e3a\u6b64\uff0c\u53ef\u4ee5\u5728\u540c\u4e00 .proto \u4e2d\u5b9a\u4e49 Result \u6d88\u606f\u7c7b\u578b\uff0c\u7136\u540e\u5728 SearchResponse \u4e2d\u6307\u5b9a Result \u7c7b\u578b\u7684\u5b57\u6bb5\uff1a message SearchResponse { repeated Result results = 1; } message Result { string url = 1; string title = 2; repeated string snippets = 3; }","title":"\u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_13","text":"\u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c Result \u6d88\u606f\u7c7b\u578b\u5728\u4e0e SearchResponse \u76f8\u540c\u7684\u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u5982\u679c\u8981\u7528\u4f5c\u5b57\u6bb5\u7c7b\u578b\u7684\u6d88\u606f\u7c7b\u578b\u5728\u53e6\u4e00\u4e2a .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u53ef\u4ee5\u901a\u8fc7\u5bfc\u5165\u6765\u4f7f\u7528\u5176\u4ed6 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002 \u8981\u5bfc\u5165\u53e6\u4e00\u4e2a .proto \u7684\u5b9a\u4e49\uff0c\u8bf7\u5728\u6587\u4ef6\u9876\u90e8\u6dfb\u52a0\u4e00\u4e2a import \u8bed\u53e5\uff1a import myproject/other_protos.proto ; \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u4f7f\u7528\u76f4\u63a5\u5bfc\u5165\u7684 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u3002\u4f46\u662f\uff0c\u6709\u65f6\u53ef\u80fd\u9700\u8981\u5c06 .proto \u6587\u4ef6\u79fb\u52a8\u5230\u65b0\u4f4d\u7f6e\u3002\u90a3\u4e48\uff0c\u53ef\u4ee5\u5728\u65e7\u4f4d\u7f6e\u653e\u7f6e\u4e00\u4e2a\u865a\u62df .proto \u6587\u4ef6\uff0c\u4ee5\u4f7f\u7528 import public \u5c06\u6240\u6709\u5bfc\u5165\u8f6c\u53d1\u5230\u65b0\u4f4d\u7f6e\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u79fb\u52a8 .proto \u6587\u4ef6\u5e76\u5728\u4e00\u6b21\u66f4\u6539\u4e2d\u66f4\u65b0\u6240\u6709\u5bfc\u5165\u5b83\u7684\u6587\u4ef6\u3002 import public \u7684\u4f9d\u8d56\u53ef\u4ee5\u88ab\u4efb\u4f55\u5305\u542b import public \u8bed\u53e5\u7684 proto \u6587\u4ef6\u4f20\u9012\u3002 \u4f8b\u5982\uff1a // new.proto // \u6240\u6709\u5b9a\u4e49\u90fd\u79fb\u52a8\u5230\u4e86\u8fd9\u91cc\u3002 // old.proto // \u8fd9\u662fproto\u6587\u4ef6\uff0c\u6240\u6709\u7684clients\u90fd\u5bfc\u5165\u4e86\u5b83\u3002 import public new.proto ; import other.proto ; // client.proto import old.proto ; // \u4f7f\u7528old.proto\u548cnew.proto\u4e2d\u7684\u5b9a\u4e49\uff0c\u4f46\u4e0d\u4f7f\u7528other.proto proto \u7f16\u8bd1\u5668\u4f7f\u7528 -I/--proto_path \u6807\u5fd7\u5728\u7f16\u8bd1\u5668\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u7684\u4e00\u7ec4\u76ee\u5f55\u4e2d\u641c\u7d22\u5bfc\u5165\u7684\u6587\u4ef6\u3002\u5982\u679c\u6ca1\u6709\u7ed9\u51fa\u6807\u5fd7\uff0c\u5b83\u5c06\u67e5\u627e\u8c03\u7528\u7f16\u8bd1\u5668\u7684\u76ee\u5f55\u3002\u901a\u5e38\uff0c\u5e94\u5c06 --proto_path \u6807\u5fd7\u8bbe\u7f6e\u4e3a\u9879\u76ee\u7684\u6839\u76ee\u5f55\uff0c\u5e76\u5bf9\u6240\u6709\u5bfc\u5165\u4f7f\u7528\u5b8c\u5168\u9650\u5b9a\u540d\u79f0\u3002","title":"\u5bfc\u5165\u5b9a\u4e49"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#proto2","text":"\u53ef\u4ee5\u5bfc\u5165 proto2 \u6d88\u606f\u7c7b\u578b\u5e76\u5728 proto3 \u6d88\u606f\u4e2d\u4f7f\u7528\u5b83\u4eec\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u4f46\u662f\uff0c proto2 \u679a\u4e3e\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8e proto3 \u8bed\u6cd5\uff08\u5982\u679c\u5df2\u5bfc\u5165\u7684 proto2 \u6d88\u606f\u4f7f\u7528\u5b83\u4eec\u5c31\u6ca1\u5173\u7cfb\uff09\u3002","title":"\u4f7f\u7528proto2\u6d88\u606f\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_14","text":"\u53ef\u4ee5\u5728\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4e2d\u5b9a\u4e49\u548c\u4f7f\u7528\u6d88\u606f\u7c7b\u578b\uff0c\u5982\u4e0b\u4f8b\u6240\u793a\uff1a\u6b64\u5904 Result \u6d88\u606f\u5728 SearchResponse \u6d88\u606f\u4e2d\u5b9a\u4e49\uff1a message SearchResponse { message Result { string url = 1; string title = 2; repeated string snippets = 3; } repeated Result results = 1; } \u5982\u679c\u8981\u5728\u5176\u7236\u6d88\u606f\u7c7b\u578b\u4e4b\u5916\u91cd\u7528\u6b64\u6d88\u606f\u7c7b\u578b\uff0c\u8bf7\u5c06\u5176\u79f0\u4e3a Parent.Type \uff1a message SomeOtherMessage { SearchResponse.Result result = 1; } \u53ef\u4ee5\u6839\u636e\u9700\u8981\u6df1\u5165\u5d4c\u5957\u6d88\u606f\uff1a message Outer { // Level 0 message MiddleAA { // Level 1 message Inner { // Level 2 int64 ival = 1; bool booly = 2; } } message MiddleBB { // Level 1 message Inner { // Level 2 int32 ival = 1; bool booly = 2; } } }","title":"\u5d4c\u5957\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_15","text":"\u5982\u679c\u73b0\u6709\u7684\u6d88\u606f\u7c7b\u578b\u4e0d\u518d\u6ee1\u8db3\u9700\u6c42\uff0c\u4f8b\u5982\uff0c\u5e0c\u671b\u6d88\u606f\u683c\u5f0f\u5177\u6709\u989d\u5916\u7684\u5b57\u6bb5\uff0c\u4f46\u4ecd\u7136\u5e0c\u671b\u4f7f\u7528\u65e7\u683c\u5f0f\u521b\u5efa\u7684\u4ee3\u7801\u3002 \u5728\u4e0d\u7834\u574f\u4efb\u4f55\u73b0\u6709\u4ee3\u7801\u7684\u60c5\u51b5\u4e0b\u66f4\u65b0\u6d88\u606f\u7c7b\u578b\u975e\u5e38\u7b80\u5355 \u3002\u8bf7\u8bb0\u4f4f\u4ee5\u4e0b\u89c4\u5219\uff1a \u8bf7\u52ff\u66f4\u6539\u4efb\u4f55\u73b0\u6709\u5b57\u6bb5\u7684\u5b57\u6bb5\u7f16\u53f7\u3002 \u5982\u679c\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u5219\u4f7f\u7528\u201c\u65e7\u201d\u6d88\u606f\u683c\u5f0f\u5e8f\u5217\u5316\u7684\u4efb\u4f55\u6d88\u606f\u4ecd\u53ef\u7531\u65b0\u751f\u6210\u7684\u4ee3\u7801\u8fdb\u884c\u89e3\u6790\u3002\u5e94\u8be5\u8bb0\u4f4f\u8fd9\u4e9b\u5143\u7d20\u7684 \u9ed8\u8ba4\u503c \uff0c\u4ee5\u4fbf\u65b0\u4ee3\u7801\u53ef\u4ee5\u6b63\u786e\u5730\u4e0e\u65e7\u4ee3\u7801\u751f\u6210\u7684\u6d88\u606f\u8fdb\u884c\u4ea4\u4e92\u3002\u540c\u6837\u7684\u65b0\u4ee3\u7801\u521b\u5efa\u7684\u6d88\u606f\u53ef\u4ee5\u7531\u65e7\u4ee3\u7801\u89e3\u6790\uff0c\u65e7\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u5728\u89e3\u6790\u65f6\u53ea\u662f\u5ffd\u7565\u65b0\u5b57\u6bb5\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c \u672a\u77e5\u5b57\u6bb5 \u201d\u90e8\u5206\u3002 \u5728\u66f4\u65b0\u7684\u6d88\u606f\u7c7b\u578b\u4e2d\u4e0d\u518d\u4f7f\u7528\u7684\u5b57\u6bb5\u7f16\u53f7\u5c31\u53ef\u4ee5\u5220\u9664\u3002 \u6709\u65f6\u60f3\u8981\u91cd\u547d\u540d\u8be5\u5b57\u6bb5\uff0c\u53ef\u80fd\u6dfb\u52a0\u524d\u7f00\u201c OBSOLETE_ \u201d\uff0c\u6216\u8005\u5c06\u5b57\u6bb5\u7f16\u53f7\u8bbe\u7f6e\u4e3a \u4fdd\u7559 \uff08 reserved \uff09\uff0c\u4ee5\u4fbf .proto \u7684\u672a\u6765\u7528\u6237\u4e0d\u4f1a\u610f\u5916\u5730\u91cd\u590d\u4f7f\u7528\u8be5\u7f16\u53f7\u3002 int32 \uff0c uint32 \uff0c int64 \uff0c uint64 \u548c bool \u90fd\u662f\u517c\u5bb9\u7684\uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u5c06\u5b57\u6bb5\u4ece\u8fd9\u4e9b\u7c7b\u578b\u4e4b\u4e00\u66f4\u6539\u4e3a\u53e6\u4e00\u79cd\u7c7b\u578b\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u5411\u524d\u6216\u5411\u540e\u517c\u5bb9\u6027\u3002\u5982\u679c\u5728\u4f20\u8f93\u4e2d\u89e3\u6790\u51fa\u4e00\u4e2a\u4e0d\u9002\u5408\u76f8\u5e94\u7c7b\u578b\u7684\u6570\u5b57\uff0c\u5c06\u83b7\u5f97\u4e0e\u5728 C++ \u4e2d\u5c06\u8be5\u6570\u5b57\u8f6c\u6362\u4e3a\u8be5\u7c7b\u578b\u76f8\u540c\u7684\u6548\u679c\uff08\u4f8b\u5982\uff0c\u5982\u679c\u5c0664\u4f4d\u6570\u5b57\u4f5c\u4e3aint32\u8bfb\u53d6\uff0c\u5b83\u5c06\u88ab\u622a\u65ad\u4e3a32\u4f4d\uff09\u3002 sint32 \u548c sint64 \u5f7c\u6b64\u517c\u5bb9\uff0c\u4f46\u4e0e\u5176\u4ed6\u6574\u6570\u7c7b\u578b\u4e0d\u517c\u5bb9\u3002 \u53ea\u8981 byte \u662f\u6709\u6548\u7684 UTF-8 \uff0c string \u548c byte \u662f\u517c\u5bb9\u7684\u3002 \u5982\u679c byte \u5305\u542b\u6d88\u606f\u7684\u7f16\u7801\u7248\u672c\uff0c\u5219\u5d4c\u5165\u6d88\u606f\u4e0e byte \u517c\u5bb9\u3002 fixed32 \u4e0e sfixed32 \u517c\u5bb9\uff0c fixed64 \u4e0e sfixed64 \u517c\u5bb9\u3002 enum \u5728\u4f20\u8f93\u683c\u5f0f\u4e2d\u4e0e int32 \uff0c uint32 \uff0c int64 \u548c uint64 \u517c\u5bb9\uff08\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u503c\u4e0d\u5408\u9002\uff0c\u5c06\u622a\u65ad\u503c\uff09\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u6d88\u606f\u65f6\uff0c\u5ba2\u6237\u7aef\u4ee3\u7801\u53ef\u80fd\u4f1a\u4ee5\u4e0d\u540c\u65b9\u5f0f\u5bf9\u5f85\u5b83\u4eec\uff1a\u4f8b\u5982\uff0c\u65e0\u6cd5\u8bc6\u522b\u7684 proto3 \u679a\u4e3e\u7c7b\u578b\u5c06\u4fdd\u7559\u5728\u6d88\u606f\u4e2d\uff0c\u4f46\u5728\u53cd\u5e8f\u5217\u5316\u6d88\u606f\u65f6\u5982\u4f55\u8868\u793a\u5b83\u662f\u4f9d\u8d56\u4e8e\u7f16\u7a0b\u8bed\u8a00\u7684\u3002 Int \u5b57\u6bb5\u603b\u662f\u4fdd\u7559\u5b83\u4eec\u7684\u503c\u3002 \u5c06\u5355\u4e2a\u503c\u66f4\u6539\u4e3a\u65b0 oneof \u7684\u6210\u5458\u662f\u5b89\u5168\u4e14\u4e8c\u8fdb\u5236\u517c\u5bb9\u7684\u3002\u5982\u679c\u786e\u4fdd\u6ca1\u6709\u4ee3\u7801\u4e00\u6b21\u8bbe\u7f6e\u591a\u4e2a\u5b57\u6bb5\uff0c\u90a3\u4e48\u5c06\u591a\u4e2a\u5b57\u6bb5\u79fb\u52a8\u5230\u65b0\u7684 oneof \u53ef\u80fd\u662f\u5b89\u5168\u7684\u3002\u5c06\u4efb\u4f55\u5b57\u6bb5\u79fb\u52a8\u5230\u67d0\u4e2a\u73b0\u6709\u7684 oneof \u4e2d\u90fd\u662f\u4e0d\u5b89\u5168\u7684\u3002","title":"\u66f4\u65b0\u6d88\u606f\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_16","text":"\u672a\u77e5\u5b57\u6bb5\u662f\u683c\u5f0f\u826f\u597d\u7684 protocol buffers \u5e8f\u5217\u5316\u6570\u636e\uff0c\u5b83\u8868\u793a\u89e3\u6790\u5668\u65e0\u6cd5\u8bc6\u522b\u7684\u5b57\u6bb5\u3002\u4f8b\u5982\uff0c\u5f53\u65e7\u4e8c\u8fdb\u5236\u6587\u4ef6\u89e3\u6790\u5177\u6709\u65b0\u5b57\u6bb5\u7684\u65b0\u4e8c\u8fdb\u5236\u6587\u4ef6\u53d1\u9001\u7684\u6570\u636e\u65f6\uff0c\u8fd9\u4e9b\u65b0\u5b57\u6bb5\u5c06\u6210\u4e3a\u65e7\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u672a\u77e5\u5b57\u6bb5\u3002 \u6700\u521d\uff0c proto3 \u6d88\u606f\u5728\u89e3\u6790\u671f\u95f4\u603b\u662f\u4e22\u5f03\u672a\u77e5\u5b57\u6bb5\uff0c\u4f46\u57283.5\u7248\u672c\u4e2d\uff0c\u91cd\u65b0\u5f15\u5165\u4e86\u672a\u77e5\u5b57\u6bb5\u7684\u4fdd\u5b58\u4ee5\u5339\u914d proto2 \u884c\u4e3a\u3002\u5728\u7248\u672c3.5\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u672a\u77e5\u5b57\u6bb5\u5728\u89e3\u6790\u671f\u95f4\u4fdd\u7559\u5e76\u5305\u542b\u5728\u5e8f\u5217\u5316\u8f93\u51fa\u4e2d\u3002","title":"\u672a\u77e5\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#any","text":"Any \u6d88\u606f\u7c7b\u578b\u5141\u8bb8\u5c06\u6d88\u606f\u7528\u4f5c\u5d4c\u5165\u7c7b\u578b\uff0c\u800c\u65e0\u9700\u4f7f\u7528\u8fd9\u4e9b\u6d88\u606f\u7684 .proto \u5b9a\u4e49\u3002 Any \u5305\u542b\u4efb\u610f\u5e8f\u5217\u5316\u6d88\u606f\uff08\u5982 byte \uff09\uff0c\u5e76\u5e26\u6709\u4e00\u4e2a URL \u4f5c\u4e3a\u8be5\u6d88\u606f\u7c7b\u578b\u7684\u5168\u5c40\u552f\u4e00\u6807\u8bc6\u7b26\u7528\u4e8e\u8868\u793a\u548c\u89e3\u6790\u5b83\u3002\u8981\u4f7f\u7528 Any \u7c7b\u578b\uff0c\u9700\u8981 \u5bfc\u5165 google/protobuf/any.proto \u3002 import google/protobuf/any.proto ; message ErrorStatus { string message = 1; repeated google.protobuf.Any details = 2; } type.googleapis.com/packagename.messagename \u662f\u7ed9\u5b9a\u6d88\u606f\u7c7b\u578b\u7684\u9ed8\u8ba4\u7c7b\u578b URL \u3002 \u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\u5c06\u652f\u6301\u8fd0\u884c\u65f6\u5e93\u6765\u5e2e\u52a9\u7a0b\u5e8f\u4ee5\u7c7b\u578b\u5b89\u5168\u7684\u65b9\u5f0f\u6253\u5305\u548c\u89e3\u538b\u7f29 Any \u503c\u3002\u4f8b\u5982\uff0c\u5728 Java \u4e2d\uff0c Any \u7c7b\u578b\u5c06\u5177\u6709\u7279\u6b8a\u7684 pack() \u548c unpack() \u8bbf\u95ee\u5668\uff0c\u800c\u5728 C++ \u4e2d\u5219\u6709 PackFrom() \u548c UnpackTo () \u65b9\u6cd5\uff1a // \u5728Any\u4e2d\u5b58\u50a8\u4efb\u610f\u6d88\u606f\u7c7b\u578b\u3002 NetworkErrorDetails details = ...; ErrorStatus status; status.add_details()- PackFrom(details); // \u4eceAny\u8bfb\u53d6\u4efb\u610f\u6d88\u606f\u3002 ErrorStatus status = ...; for (const Any detail : status.details()) { if (detail.Is NetworkErrorDetails ()) { NetworkErrorDetails network_error; detail.UnpackTo( network_error); ... processing network_error ... } } \u76ee\u524d\uff0c\u6b63\u5728\u5f00\u53d1\u7528\u4e8e\u5904\u7406 Any \u7c7b\u578b\u7684\u8fd0\u884c\u65f6\u5e93\u3002 \u5982\u679c\u5df2\u719f\u6089 proto2 \u8bed\u6cd5 \uff0c\u5219 Any \u7c7b\u578b\u5c06\u66ff\u6362 \u6269\u5c55 \u3002","title":"Any"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#oneof","text":"\u5982\u679c\u6709\u4e00\u4e2a\u5305\u542b\u8bb8\u591a\u5b57\u6bb5\u7684\u6d88\u606f\uff0c\u5e76\u4e14\u6700\u591a\u53ea\u80fd\u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528 oneof \u6765\u5f3a\u5236\u6267\u884c\u6b64\u64cd\u4f5c\u540c\u65f6\u8fd8\u80fd\u8282\u7701\u5185\u5b58\u3002 oneof \u5b57\u6bb5\u4e0e\u6b63\u5e38\u7684\u5b57\u6bb5\u4e00\u6837\uff0c\u53ea\u662f\u5728\u540c\u4e00\u4e2a oneof \u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u5171\u4eab\u5185\u5b58\uff0c\u5e76\u4e14\u6700\u591a\u53ef\u4ee5\u540c\u65f6\u8bbe\u7f6e\u4e00\u4e2a\u5b57\u6bb5\u3002\u8bbe\u7f6e oneof \u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u6210\u5458\u65f6\u90fd\u4f1a\u81ea\u52a8\u6e05\u9664\u6240\u6709\u5176\u4ed6\u6210\u5458\u3002\u53ef\u4ee5\u4f7f\u7528 case() \u6216 WhichOneof() \u65b9\u6cd5\u68c0\u67e5 oneof \u4e2d\u7684\u54ea\u4e2a\u503c\uff08\u5982\u679c\u6709\uff09\u88ab\u8bbe\u7f6e\u4e86\uff0c\u5177\u4f53\u4f7f\u7528\u54ea\u4e2a\u53d6\u51b3\u4e8e\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\u3002","title":"Oneof"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#oneof_1","text":"\u8981\u5728 .proto \u4e2d\u5b9a\u4e49 oneof \uff0c\u8bf7\u4f7f\u7528 oneof \u5173\u952e\u5b57\uff0c\u5e76\u5728\u540e\u9762\u8ddf\u7740 oneof \u540d\u79f0\uff0c\u5728\u672c\u4f8b\u4e2d\u4e3a test_oneof \uff1a message SampleMessage { oneof test_oneof { string name = 4; SubMessage sub_message = 9; } } \u7136\u540e\uff0c\u5c06 oneof \u5b57\u6bb5\u6dfb\u52a0\u5230 oneof \u5b9a\u4e49\u4e2d\u3002\u53ef\u4ee5\u6dfb\u52a0\u4efb\u4f55\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u4f46\u4e0d\u80fd\u4f7f\u7528 repeated \u5b57\u6bb5\u3002 \u5728\u751f\u6210\u7684\u4ee3\u7801\u4e2d\uff0c oneof \u5b57\u6bb5\u4e0e\u5e38\u89c4\u5b57\u6bb5\u5177\u6709\u76f8\u540c\u7684 getter \u548c setter \u3002\u8fd8\u53ef\u4ee5\u83b7\u5f97\u4e00\u79cd\u7279\u6b8a\u65b9\u6cd5\u6765\u68c0\u67e5 oneof \u4e2d\u8bbe\u7f6e\u4e86\u54ea\u4e2a\u503c\uff08\u5982\u679c\u6709\uff09\u3002\u53ef\u4ee5\u5728\u76f8\u5173 API\u53c2\u8003 \u4e2d\u627e\u5230\u6709\u5173\u6240\u9009\u8bed\u8a00\u7684 oneof API \u7684\u66f4\u591a\u4fe1\u606f\u3002","title":"\u4f7f\u7528Oneof"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#oneof_2","text":"\u8bbe\u7f6e oneof \u5b57\u6bb5\u5c06\u81ea\u52a8\u6e05\u9664 oneof \u7684\u6240\u6709\u5176\u4ed6\u6210\u5458\u3002\u56e0\u6b64\uff0c\u5982\u679c\u8bbe\u7f6e\u591a\u4e2a\u5b57\u6bb5\uff0c\u5219\u53ea\u6709\u8bbe\u7f6e\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u6bb5\u4ecd\u7136\u5177\u6709\u503c\u3002 c++ SampleMessage message; message.set_name(\"name\"); CHECK(message.has_name()); message.mutable_sub_message(); // Will clear name field. CHECK(!message.has_name()); \u5982\u679c\u89e3\u6790\u5668\u5728\u4f20\u8f93\u4e2d\u9047\u5230\u540c\u4e00\u4e2a oneof \u7684\u591a\u4e2a\u6210\u5458\uff0c\u5219\u5728\u89e3\u6790\u7684\u6d88\u606f\u4e2d\u4ec5\u4f7f\u7528\u770b\u5230\u7684\u6700\u540e\u4e00\u4e2a\u6210\u5458\u3002 oneof \u4e0d\u80fd\u662f repeated \u3002 \u5982\u679c\u5c06 oneof \u5b57\u6bb5\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\uff08\u4f8b\u5982\u5c06 int32 oneof \u5b57\u6bb5\u8bbe\u7f6e\u4e3a0\uff09\uff0c\u90a3\u4e48\u8be5 oneof \u5b57\u6bb5\u7684 \u201ccase\u201d \u5c06\u4f1a\u88ab\u8bbe\u7f6e\uff0c\u5e76\u4e14\u8fd9\u4e9b\u5b57\u6bb5\u7684\u503c\u5c06\u5728\u4f20\u8f93\u65f6\u5e8f\u5217\u5316\u3002 \u5982\u679c\u4f7f\u7528\u7684\u662f C++ \uff0c\u8bf7\u786e\u4fdd\u4ee3\u7801\u4e0d\u4f1a\u5bfc\u81f4\u5185\u5b58\u5d29\u6e83\u3002\u4ee5\u4e0b\u793a\u4f8b\u4ee3\u7801\u5c06\u5d29\u6e83\uff0c\u56e0\u4e3a\u901a\u8fc7\u8c03\u7528 set_name() \u65b9\u6cd5\u5220\u9664\u4e86 sub_message \u3002 c++ SampleMessage message; SubMessage* sub_message = message.mutable_sub_message(); message.set_name(\"name\"); // Will delete sub_message sub_message- set_... // Crashes here \u540c\u6837\u5728 C++ \u4e2d\uff0c\u5982\u679c Swap() \u4e24\u6761 oneof \u7684\u6d88\u606f\uff0c\u5219\u6bcf\u6761\u6d88\u606f\u90fd\u5c06\u4ee5\u53e6\u4e00\u6761\u6d88\u606f\u7684 \u201ccase\u201d \u4f5c\u4e3a\u7ed3\u675f\uff1a\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c msg1 \u5c06\u4f1a\u6709 sub_message \u540c\u65f6 msg2 \u5c06\u4f1a\u6709 name \u3002 c++ SampleMessage msg1; msg1.set_name(\"name\"); SampleMessage msg2; msg2.mutable_sub_message(); msg1.swap( msg2); CHECK(msg1.has_sub_message()); CHECK(msg2.has_name());","title":"Oneof\u7684\u529f\u80fd"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_17","text":"\u6dfb\u52a0\u6216\u5220\u9664 oneof \u5b57\u6bb5\u65f6\u8981\u5c0f\u5fc3\u3002\u5982\u679c\u5728\u68c0\u67e5 oneof \u7684\u503c\u8fd4\u56de None/NOT_SET \uff0c\u8fd9\u53ef\u80fd\u610f\u5473\u7740 oneof \u5c1a\u672a\u8bbe\u7f6e\u6216\u5df2\u8bbe\u7f6e\u4e3a oneof \u7684\u53e6\u4e00\u4e2a\u4e0d\u540c\u7248\u672c\u3002\u6ca1\u6709\u529e\u6cd5\u533a\u5206\uff0c\u56e0\u4e3a\u6ca1\u6709\u529e\u6cd5\u77e5\u9053\u4f20\u8f93\u4e2d\u7684\u672a\u77e5\u5b57\u6bb5\u662f\u5426\u662f oneof \u7684\u6210\u5458\u3002","title":"\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_18","text":"\u5c06\u5b57\u6bb5\u79fb\u5165\u6216\u79fb\u51fa oneof \uff1a\u5728\u5e8f\u5217\u5316\u6216\u89e3\u6790\u6d88\u606f\u540e\uff0c\u53ef\u80fd\u4f1a\u4e22\u5931\u4e00\u4e9b\u4fe1\u606f\uff08\u67d0\u4e9b\u5b57\u6bb5\u5c06\u88ab\u6e05\u9664\uff09\u3002\u4f46\u662f\uff0c\u53ef\u4ee5\u5b89\u5168\u5730\u5c06\u5355\u4e2a\u5b57\u6bb5\u79fb\u52a8\u5230\u65b0\u7684 oneof \u5b57\u6bb5\u4e2d\uff0c\u5e76\u4e14\u5982\u679c\u5df2\u77e5\u53ea\u6709\u4e00\u4e2a\u5b57\u6bb5\u88ab\u8bbe\u7f6e\uff0c\u5219\u53ef\u4ee5\u79fb\u52a8\u591a\u4e2a\u5b57\u6bb5\u3002 \u5220\u9664 oneof \u5b57\u6bb5\u5e76\u5c06\u5176\u6dfb\u52a0\u56de \uff1a\u5728\u5e8f\u5217\u5316\u6216\u89e3\u6790\u6d88\u606f\u540e\uff0c\u8fd9\u53ef\u80fd\u4f1a\u6e05\u9664\u5f53\u524d\u8bbe\u7f6e\u7684 oneof \u5b57\u6bb5\u3002 \u62c6\u5206\u6216\u5408\u5e76 oneof \uff1a\u8fd9\u4e0e\u79fb\u52a8\u5e38\u89c4\u5b57\u6bb5\u6709\u7c7b\u4f3c\u7684\u95ee\u9898\u3002","title":"\u6807\u7b7e\u91cd\u7528\u95ee\u9898"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#maps","text":"\u5982\u679c\u8981\u5728\u6570\u636e\u5b9a\u4e49\u4e2d\u521b\u5efa\u5173\u8054\u6620\u5c04\uff0c protocol buffers \u63d0\u4f9b\u4e86\u4e00\u79cd\u65b9\u4fbf\u7684\u5feb\u6377\u65b9\u5f0f\u8bed\u6cd5\uff1a map key_type, value_type map_field = N; \u5176\u4e2d key_type \u53ef\u4ee5\u662f\u4efb\u4f55 \u6574\u6570 \u6216 \u5b57\u7b26\u4e32 \u7c7b\u578b\uff08\u9664\u4e86\u6d6e\u70b9\u7c7b\u578b\u548c\u5b57\u8282\u4e4b\u5916\u7684\u4efb\u4f55 \u6807\u91cf \u7c7b\u578b\uff09\u3002\u8bf7\u6ce8\u610f\uff0c\u679a\u4e3e\u4e0d\u662f\u6709\u6548\u7684 key_type \u3002 value_type \u53ef\u4ee5\u662f map \u4e4b\u5916\u7684\u4efb\u4f55\u7c7b\u578b\u3002 \u5982\u679c\u8981\u521b\u5efa\u4e00\u4e2a map \uff0c\u5176\u4e2d\u6bcf\u4e2a Project \u6d88\u606f\u4e0e\u5b57\u7b26\u4e32\u952e\u76f8\u5173\u8054\uff0c\u5219\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u5b9a\u4e49\u5b83\uff1a map string, Project projects = 3; map \u7684\u5b57\u6bb5\u4e0d\u80fd\u662f repeated \u3002 \u4f20\u8f93\u683c\u5f0f\u7684\u987a\u5e8f\u548c map \u503c\u7684\u8fed\u4ee3\u987a\u5e8f\u662f\u672a\u5b9a\u4e49\u7684\uff0c\u56e0\u6b64\u4e0d\u80fd\u4f9d\u8d56 map \u4e2d\u7684\u9879\u76ee\u6309\u7279\u5b9a\u987a\u5e8f\u6392\u5e8f\u3002 \u4ece .proto \u6587\u4ef6\u4e2d\u751f\u6210\u6587\u672c\u683c\u5f0f\u65f6\uff0c map \u6309\u952e\u6392\u5e8f\uff0c\u6570\u5b57\u952e\u6309\u6570\u5b57\u6392\u5e8f\u3002 \u5728\u4f20\u8f93\u6216\u5408\u5e76\u65f6\u8fdb\u884c\u89e3\u6790\uff0c\u5982\u679c\u6709\u91cd\u590d\u7684 map \u952e\uff0c\u90a3\u4e48\u5c31\u4f7f\u7528\u6700\u540e\u7684\u90a3\u4e2a\u952e\u3002\u4ece\u6587\u672c\u683c\u5f0f\u89e3\u6790 map \u65f6\uff0c\u5982\u679c\u5b58\u5728\u91cd\u590d\u952e\uff0c\u5219\u89e3\u6790\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 \u5982\u679c\u7ed9 map \u63d0\u4f9b\u4e86\u952e\u5374\u6ca1\u6709\u63d0\u4f9b\u503c\uff0c\u90a3\u4e48\u5b57\u6bb5\u5e8f\u5217\u5316\u7684\u5177\u4f53\u884c\u4e3a\u5c31\u53d6\u51b3\u4e8e\u5177\u4f53\u7684\u7f16\u7a0b\u8bed\u8a00\u3002\u5728 c++ , Java \uff0c Python \u4e2d\u4f7f\u7528\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u8fdb\u884c\u5e8f\u5217\u5316\uff0c\u5728\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u4e2d\uff0c\u6ca1\u6709\u503c\u88ab\u5e8f\u5217\u5316\u3002 \u76ee\u524d\uff0c\u6240\u6709 proto3 \u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u90fd\u80fd\u751f\u6210 map API\uff0c\u66f4\u591a\u5173\u4e8e\u6240\u9009\u8bed\u8a00\u7684 map API\u7684\u53c2\u8003\u67e5\u770b API\u53c2\u8003\u6587\u6863 \u3002","title":"Maps"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_19","text":"\u5728\u4f20\u8f93\u65f6\uff0c map \u7684\u8bed\u6cd5\u7b49\u6548\u4e8e\u4e0b\u9762\u7684\u793a\u4f8b\uff0c\u56e0\u6b64\u4e0d\u652f\u6301 map \u7684 protocol buffers \u5b9e\u73b0\u4ecd\u7136\u53ef\u4ee5\u5904\u7406\u4f20\u8f93\u7684\u6570\u636e\uff1a message MapFieldEntry { key_type key = 1; value_type value = 2; } repeated MapFieldEntry map_field = N; \u652f\u6301 map \u7684\u4efb\u4f55 protocol buffers \u5b9e\u73b0\u90fd\u5fc5\u987b\u751f\u6210\u548c\u63a5\u53d7\u4e0a\u8ff0\u5b9a\u4e49\u6240\u8868\u793a\u7684\u53ef\u63a5\u53d7\u7684\u6570\u636e\u3002","title":"\u5411\u540e\u517c\u5bb9\u6027"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#packages","text":"\u53ef\u4ee5\u5c06\u53ef\u9009\u7684 package \u8bf4\u660e\u7b26\u6dfb\u52a0\u5230 .proto \u6587\u4ef6\uff0c\u4ee5\u9632\u6b62 protocol buffers \u6d88\u606f\u7c7b\u578b\u4e4b\u95f4\u7684\u540d\u79f0\u51b2\u7a81\u3002 package foo.bar; message Open { ... } \u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\u7684\u5b57\u6bb5\u65f6\u4f7f\u7528 package \u8bf4\u660e\u7b26\uff1a message Foo { ... foo.bar.Open open = 1; ... } package \u8bf4\u660e\u7b26\u5f71\u54cd\u751f\u6210\u4ee3\u7801\u7684\u65b9\u5f0f\u53d6\u51b3\u4e8e\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\uff1a \u5728 C++ \u4e2d\uff0c\u751f\u6210\u7684\u7c7b\u5305\u542b\u5728 C++ \u547d\u540d\u7a7a\u95f4\u4e2d\u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u547d\u540d\u7a7a\u95f4 foo::bar \u4e2d\u3002 \u5728 Java \u4e2d\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 java_package \uff0c\u5426\u5219\u8be5\u5305\u5c06\u7528\u4f5c Java \u5305\u3002 \u5728 Python \u4e2d\uff0c\u5c06\u5ffd\u7565 package \u6307\u4ee4\uff0c\u56e0\u4e3a Python \u6a21\u5757\u662f\u6839\u636e\u5b83\u4eec\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u4f4d\u7f6e\u8fdb\u884c\u7ec4\u7ec7\u7684\u3002 \u5728 Go \u4e2d\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 go_package \uff0c\u5426\u5219\u8be5\u5305\u5c06\u7528\u4f5c Go \u5305\u540d\u79f0\u3002 \u5728 Ruby \u4e2d\uff0c\u751f\u6210\u7684\u7c7b\u5305\u542b\u5728\u5d4c\u5957\u7684 Ruby \u547d\u540d\u7a7a\u95f4\u4e2d\uff0c\u8f6c\u6362\u4e3a\u6240\u9700\u7684 Ruby \u5927\u5199\u5f62\u5f0f\uff08\u9996\u5b57\u6bcd\u5927\u5199;\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u5b57\u6bcd\uff0c\u5219 PB_ \u524d\u7f6e\uff09\u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u540d\u79f0\u7a7a\u95f4 Foo::Bar \u4e2d\u3002 \u5728 C\uff03 \u4e2d\uff0c\u8f6c\u6362\u4e3a PascalCase \u540e\uff0c\u5305\u5c06\u7528\u4f5c\u547d\u540d\u7a7a\u95f4\uff0c\u9664\u975e\u5728 .proto \u6587\u4ef6\u4e2d\u660e\u786e\u63d0\u4f9b\u9009\u9879 csharp_namespace \u3002\u4f8b\u5982\uff0c Open \u5c06\u4f4d\u4e8e\u540d\u79f0\u7a7a\u95f4 Foo.Bar \u4e2d\u3002","title":"Packages"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_20","text":"protocol buffers \u8bed\u8a00\u4e2d\u7684\u7c7b\u578b\u540d\u79f0\u89e3\u6790\u4e0e C++ \u7c7b\u4f3c\uff1a\u9996\u5148\u641c\u7d22\u6700\u91cc\u9762\u7684\u8303\u56f4\uff0c\u7136\u540e\u641c\u7d22\u4e0b\u4e00\u4e2a\u8303\u56f4\uff0c\u4f9d\u6b64\u7c7b\u63a8\uff0c\u6bcf\u4e2a\u5305\u88ab\u8ba4\u4e3a\u662f\u5176\u7236\u5305\u7684\u201c\u5185\u90e8\u201d\u3002\u4e00\u4e2a '.' \uff08\u4f8b\u5982 .foo.bar.Baz \uff09\u610f\u5473\u7740\u4ece\u6700\u5916\u5c42\u7684\u8303\u56f4\u5f00\u59cb\u3002 protocol buffers \u7f16\u8bd1\u5668\u901a\u8fc7\u89e3\u6790\u5bfc\u5165\u7684 .proto \u6587\u4ef6\u6765\u89e3\u6790\u6240\u6709\u7c7b\u578b\u540d\u79f0\u3002\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u4ee3\u7801\u751f\u6210\u5668\u90fd\u77e5\u9053\u5982\u4f55\u5f15\u7528\u8be5\u8bed\u8a00\u4e2d\u7684\u6bcf\u79cd\u7c7b\u578b\uff0c\u5373\u4f7f\u5b83\u5177\u6709\u4e0d\u540c\u7684\u8303\u56f4\u89c4\u5219\u3002","title":"\u5305\u548c\u540d\u79f0\u89e3\u6790"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_21","text":"\u5982\u679c\u8981\u5728RPC\uff08\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\uff09\u7cfb\u7edf\u4e2d\u4f7f\u7528\u81ea\u5b9a\u4e49\u6d88\u606f\u7c7b\u578b\uff0c\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49RPC\u670d\u52a1\u63a5\u53e3 protocol buffers \u7f16\u8bd1\u5668\u5c06\u4ee5\u9009\u62e9\u7684\u7f16\u7a0b\u8bed\u8a00\u751f\u6210\u670d\u52a1\u63a5\u53e3\u4ee3\u7801\u548c stub \u3002 \u4f8b\u5982\uff0c\u8981\u5b9a\u4e49\u4e00\u4e2aRPC\u670d\u52a1\uff0c\u8be5\u670d\u52a1\u83b7\u53d6 SearchRequest \u8bf7\u6c42\u5e76\u8fd4\u56de SearchResponse \u54cd\u5e94\u6d88\u606f\uff0c\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u5b83\uff0c\u5982\u4e0b\u6240\u793a\uff1a service SearchService { rpc Search (SearchRequest) returns (SearchResponse); } \u4e0e protocol buffers \u4e00\u8d77\u4f7f\u7528\u7684\u6700\u7b80\u5355\u7684RPC\u7cfb\u7edf\u662f gRPC \uff1a\u4e00\u79cd\u7531Google\u5f00\u53d1\u7684\u8bed\u8a00\u5e73\u53f0\u4e2d\u7acb\u7684\u5f00\u6e90RPC\u7cfb\u7edf\u3002gRPC\u7279\u522b\u9002\u7528\u4e8e protocol buffers \uff0c\u5e76\u5141\u8bb8\u4f7f\u7528\u7279\u5b9a\u7684 protocol buffers \u7f16\u8bd1\u5668\u63d2\u4ef6\u76f4\u63a5\u4ece .proto \u6587\u4ef6\u751f\u6210\u76f8\u5173\u7684RPC\u4ee3\u7801\u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528gRPC\uff0c\u4e5f\u53ef\u4ee5\u5c06 protocol buffers \u4e0e\u81ea\u5b9a\u4e49\u7684RPC\u5b9e\u73b0\u4e00\u8d77\u4f7f\u7528\u3002\u53ef\u4ee5\u5728 Proto2 \u8bed\u8a00\u6307\u5357 \u4e2d\u627e\u5230\u66f4\u591a\u76f8\u5173\u4fe1\u606f\u3002 \u8fd8\u6709\u4e00\u4e9b\u6b63\u5728\u8fdb\u884c\u7684\u7b2c\u4e09\u65b9\u9879\u76ee\u4e3a Protocol Buffers \u5f00\u53d1RPC\u5b9e\u73b0\u3002\u6709\u5173\u6211\u4eec\u4e86\u89e3\u7684\u9879\u76ee\u7684\u94fe\u63a5\u5217\u8868\uff0c\u8bf7\u53c2\u9605 \u7b2c\u4e09\u65b9\u52a0\u8f7d\u9879wiki\u9875\u9762 \u3002","title":"\u5b9a\u4e49\u670d\u52a1"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#json","text":"Proto3 \u652f\u6301 JSON \u4e2d\u7684\u89c4\u8303\u7f16\u7801\uff0c\u4f7f\u5f97\u5728\u7cfb\u7edf\u4e4b\u95f4\u5171\u4eab\u6570\u636e\u53d8\u5f97\u66f4\u52a0\u5bb9\u6613\u3002\u5728\u4e0b\u8868\u4e2d\u9010\u4e2a\u7c7b\u578b\u5730\u63cf\u8ff0\u7f16\u7801\u3002 \u5982\u679c JSON \u7f16\u7801\u6570\u636e\u4e2d\u7f3a\u5c11\u67d0\u4e2a\u503c\uff0c\u6216\u8005\u5176\u503c\u4e3a null \uff0c\u5219\u5728\u89e3\u6790\u4e3a protocol buffers \u65f6\uff0c\u5b83\u5c06\u88ab\u89e3\u91ca\u4e3a\u76f8\u5e94\u7684 \u9ed8\u8ba4\u503c \u3002\u5982\u679c\u67d0\u4e2a\u5b57\u6bb5\u5728 protocol buffers \u4e2d\u5177\u6709\u9ed8\u8ba4\u503c\uff0c\u5219\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u5728 JSON \u7f16\u7801\u7684\u6570\u636e\u4e2d\u7701\u7565\u8be5\u5b57\u6bb5\u4ee5\u8282\u7701\u7a7a\u95f4\u3002\u4e00\u79cd\u5b9e\u73b0\u65b9\u5f0f\u662f\u63d0\u4f9b\u53ef\u9009\u9009\u9879\u5728 JSON \u7f16\u7801\u7684\u8f93\u51fa\u4e2d\u8f93\u51fa\u5b57\u6bb5\u548c\u5b83\u7684\u9ed8\u8ba4\u503c\u3002 proto3 JSON JSON example Notes message object {\"fooBar\": v, \"g\": null, \u2026} \u751f\u6210JSON\u5bf9\u8c61\u3002 message \u5b57\u6bb5\u540d\u79f0\u6620\u5c04\u5230\u5c0f\u9a7c\u5cf0\u547d\u540d\u5e76\u6210\u4e3aJSON\u5bf9\u8c61\u7684 key \u3002\u5982\u679c\u6307\u5b9a\u4e86 json_name \u5b57\u6bb5\u8fd9\u4e2a\u9009\u9879\uff0c\u5219\u5c06\u6307\u5b9a\u7684\u503c\u4f5c\u4e3a key \u3002\u89e3\u6790\u5668\u63a5\u53d7\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0\uff08\u6216 json_name \u9009\u9879\u6307\u5b9a\u7684\u540d\u79f0\uff09\u548c\u539f\u59cb\u7684 proto \u5b57\u6bb5\u540d\u79f0\u3002 null \u662f\u6240\u6709\u5b57\u6bb5\u7c7b\u578b\u90fd\u53ef\u63a5\u53d7\u7684\u503c\uff0c\u5e76\u88ab\u89c6\u4e3a\u76f8\u5e94\u5b57\u6bb5\u7c7b\u578b\u7684\u9ed8\u8ba4\u503c\u3002 enum string \"FOO_BAR\" \u4f7f\u7528 proto \u4e2d\u6307\u5b9a\u7684\u679a\u4e3e\u503c\u7684\u540d\u79f0\u3002\u89e3\u6790\u5668\u63a5\u53d7\u679a\u4e3e\u540d\u79f0\u548c\u6574\u6570\u503c\u3002 map object {\"k\": v, \u2026} \u6240\u6709\u952e\u90fd\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u3002 repeated V array [v, \u2026] null \u88ab\u63a5\u53d7\u4e3a\u7a7a\u7684 list[] \u3002 bool true, false true, false string string \"Hello World!\" bytes base64 string \"YWJjMTIzIT8kKiYoKSctPUB+\" JSON\u503c\u5c06\u662f\u4f7f\u7528\u5e26\u586b\u5145\u7684\u6807\u51c6base64\u7f16\u7801\u65b9\u5f0f\u7f16\u7801\u7684\u5b57\u7b26\u4e32\u6570\u636e\u3002\u5e26\u6709/\u4e0d\u5e26\u586b\u5145\u7684\u6807\u51c6\u6216URL\u5b89\u5168\u7684base64\u7f16\u7801\u65b9\u5f0f\u4e5f\u662f\u53ef\u63a5\u53d7\u7684\u3002 int32, fixed32, uint32 number 1, -10, 0 \u5341\u8fdb\u5236\u6570\u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\u3002 int64, fixed64, uint64 string \"1\", \"-10\" \u5341\u8fdb\u5236\u5b57\u7b26\u4e32\u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\u3002 float, double number 1.1, -10.0, 0, \"NaN\", \"Infinity\" \u4e00\u4e2a\u6216\u591a\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32 \u201cNaN\u201d \uff0c \u201cInfinity\u201d \u548c \u201c-Infinity\u201d \u5f62\u5f0f\u7684JSON\u503c\uff0c\u63a5\u53d7\u6570\u5b57\u6216\u5b57\u7b26\u4e32\uff0c\u6307\u6570\u8868\u793a\u6cd5\u4e5f\u88ab\u63a5\u53d7\u3002 Any object {\"@type\": \"url\", \"f\": v, \u2026 } \u5982\u679c Any \u5305\u542b\u5177\u6709\u7279\u6b8aJSON\u6620\u5c04\u7684\u503c\uff0c\u5219\u5b83\u5c06\u6309\u5982\u4e0b\u65b9\u5f0f\u8f6c\u6362\uff1a {\u201c@ type\u201d\uff1axxx\uff0c\u201cvalue\u201d\uff1ayyy} \u3002 \u5426\u5219\uff0c\u8be5\u503c\u5c06\u8f6c\u6362\u4e3aJSON\u5bf9\u8c61\uff0c\u5e76\u5c06\u63d2\u5165 \u201c@type\u201d \u5b57\u6bb5\u4ee5\u6307\u793a\u5b9e\u9645\u6570\u636e\u7c7b\u578b\u3002 Timestamp string \"1972-01-01T10:00:20.021Z\" \u4f7f\u7528 RFC 3339 \uff0c\u5176\u4e2d\u751f\u6210\u7684\u8f93\u51fa\u5c06\u59cb\u7ec8\u88ab Z-\u6807\u51c6\u5316 \u5e76\u4f7f\u75280,3,6\u62169\u4e2a\u5c0f\u6570\u4f4d\u3002\u4e5f\u63a5\u53d7\u201cZ\u201d\u4ee5\u5916\u7684\u504f\u79fb\u3002 Duration string \"1.000340012s\", \"1s\" \u751f\u6210\u7684\u8f93\u51fa\u59cb\u7ec8\u5305\u542b0,3,6\u62169\u4e2a\u5c0f\u6570\u4f4d\uff0c\u5177\u4f53\u53d6\u51b3\u4e8e\u6240\u9700\u7684\u7cbe\u5ea6\uff0c\u540e\u8ddf\u540e\u7f00 \u201cs\u201d \u3002\u63a5\u53d7\u4efb\u4f55\u5c0f\u6570\u4f4d\uff08\u4e5f\u53ef\u4ee5\u6ca1\u6709\u5c0f\u6570\u4f4d\uff09\uff0c\u53ea\u8981\u5b83\u4eec\u7b26\u5408\u7eb3\u79d2\u7cbe\u5ea6\u5e76\u4e14\u9700\u8981\u540e\u7f00 \u201cs\u201d \u3002 Struct object { \u2026 } \u4efb\u610fJSON\u5bf9\u8c61\uff0c\u67e5\u770b struct.proto \u6587\u4ef6 Wrapper types various types 2, \"2\", \"foo\", true, \"true\", null, 0, \u2026 Wrappers \u5728JSON\u4e2d\u4f7f\u7528\u4e0e\u5305\u88c5\u57fa\u5143\u7c7b\u578b\u76f8\u540c\u7684\u8868\u793a\u5f62\u5f0f\uff0c\u9664\u4e86\u5728\u6570\u636e\u8f6c\u6362\u548c\u4f20\u8f93\u671f\u95f4\u5141\u8bb8\u548c\u4fdd\u7559 null \u3002 FieldMask string \"f.fooBar,h\" \u67e5\u770b field_mask.proto \u6587\u4ef6 ListValue array [foo, bar, \u2026] Value value \u4efb\u610fJSON\u503c NullValue null JSON\u4e2d\u7684 null Empty object {} \u7a7a\u7684JSON\u5bf9\u8c61","title":"JSON\u6620\u5c04"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#json_1","text":"proto3 JSON \u5b9e\u73b0\u53ef\u4ee5\u63d0\u4f9b\u4ee5\u4e0b\u53ef\u7528\u9009\u9879\uff1a \u8f93\u51fa\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c \uff1a\u5728 proto3 JSON \u7684\u8f93\u51fa\u4e2d\u9ed8\u8ba4\u7701\u7565\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002\u6709\u4e00\u4e2a\u9009\u9879\u53ef\u4ee5\u63d0\u4f9b\u8986\u76d6\u6b64\u884c\u4e3a\u5e76\u8f93\u51fa\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u5ffd\u7565\u672a\u77e5\u5b57\u6bb5 \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c proto3 JSON \u89e3\u6790\u5668\u4f1a\u62d2\u7edd\u672a\u77e5\u5b57\u6bb5\uff0c\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u9009\u9879\u6765\u5ffd\u7565\u89e3\u6790\u672a\u77e5\u5b57\u6bb5\u3002 \u4f7f\u7528 proto \u5b57\u6bb5\u540d\u79f0\u800c\u4e0d\u662f\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0 \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c proto3 JSON \u4f1a\u5c06\u5b57\u6bb5\u540d\u79f0\u8f6c\u6362\u4e3a\u5c0f\u9a7c\u5cf0\u547d\u540d\u5e76\u5c06\u5176\u7528\u4f5cJSON\u7684\u540d\u79f0\u3002\u6709\u4e00\u4e2a\u9009\u9879\u53ef\u4ee5\u63d0\u4f9b\u4f7f\u7528 proto \u5b57\u6bb5\u540d\u79f0\u4f5c\u4e3aJSON\u7684\u540d\u79f0\u3002 proto3 JSON \u89e3\u6790\u5668\u9700\u8981\u63a5\u53d7\u8f6c\u6362\u540e\u7684\u5c0f\u9a7c\u5cf0\u547d\u540d\u7684\u540d\u79f0\u548c proto \u5b57\u6bb5\u540d\u79f0\u3002 \u5c06\u679a\u4e3e\u503c\u4f5c\u4e3a\u6574\u6570\u800c\u4e0d\u662f\u5b57\u7b26\u4e32\u8f93\u51fa \uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728JSON\u8f93\u51fa\u4e2d\u4f7f\u7528\u679a\u4e3e\u503c\u7684\u540d\u79f0\u3002\u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u9009\u9879\u4ee5\u4f7f\u7528\u679a\u4e3e\u503c\u7684\u6570\u503c\u3002","title":"JSON\u9009\u9879"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_22","text":".proto \u6587\u4ef6\u4e2d\u7684\u5404\u4e2a\u58f0\u660e\u53ef\u4ee5\u4f7f\u7528\u8bb8\u591a\u9009\u9879\u8fdb\u884c\u6ce8\u91ca\u3002\u9009\u9879\u4e0d\u4f1a\u66f4\u6539\u58f0\u660e\u7684\u6574\u4f53\u542b\u4e49\uff0c\u4f46\u53ef\u80fd\u4f1a\u5f71\u54cd\u8be5\u58f0\u660e\u5728\u7279\u5b9a\u4e0a\u4e0b\u6587\u4e2d\u88ab\u5904\u7406\u7684\u65b9\u5f0f\u3002\u53ef\u7528\u9009\u9879\u7684\u5b8c\u6574\u5217\u8868\u5728 google/protobuf/descriptor.proto \u4e2d\u5b9a\u4e49\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u6587\u4ef6\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5728\u9876\u7ea7\u8303\u56f4\u5185\u7f16\u5199\uff0c\u800c\u4e0d\u662f\u5728\u4efb\u4f55 message \u3001 enum \u6216 service \u7684\u5b9a\u4e49\u4e2d\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u6d88\u606f\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5199\u5728 message \u5b9a\u4e49\u4e2d\u3002 \u4e00\u4e9b\u9009\u9879\u662f \u5b57\u6bb5\u7ea7\u9009\u9879 \uff0c\u8fd9\u610f\u5473\u7740\u5b83\u4eec\u5e94\u8be5\u5199\u5728\u5b57\u6bb5\u5b9a\u4e49\u4e2d\u3002 \u53ef\u7528\u9009\u9879\u4e5f\u53ef\u4ee5\u5199\u5728\u679a\u4e3e\u7c7b\u578b\uff0c\u679a\u4e3e\u503c\uff0c\u670d\u52a1\u7c7b\u578b\u548c\u670d\u52a1\u65b9\u6cd5\u4e0a\uff0c\u4f46\u662f\uff0c\u76ee\u524d\u6ca1\u6709\u4efb\u4f55\u652f\u6301\u8fd9\u4e9b\u7684\u53ef\u7528\u9009\u9879\u3002 \u4ee5\u4e0b\u662f\u4e00\u4e9b\u6700\u5e38\u7528\u7684\u9009\u9879\uff1a java_package \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u7528\u4e8e\u751f\u6210\u7684Java\u7c7b\u7684\u5305\u3002\u5982\u679c .proto \u6587\u4ef6\u4e2d\u6ca1\u6709\u7ed9\u51fa\u663e\u5f0f\u7684 java_package \u9009\u9879\uff0c\u90a3\u4e48\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5c06\u4f7f\u7528 proto \u5305\uff08. proto \u6587\u4ef6\u4e2d\u7684 \u201cpackage\u201d \u5173\u952e\u5b57\u6307\u5b9a\u7684\u5305\uff09\u3002\u4f46\u662f\uff0c proto \u5305\u901a\u5e38\u4e0d\u80fd\u751f\u6210\u597d\u7684 Java \u5305\uff0c\u56e0\u4e3a proto \u5305\u4e0d\u4f1a\u4ee5\u53cd\u5411\u57df\u540d\u5f00\u5934\u3002\u5982\u679c\u4e0d\u751f\u6210Java\u4ee3\u7801\uff0c\u5219\u6b64\u9009\u9879\u65e0\u6548\u3002 protobuf option java_package = \"com.example.foo\"; java_multiple_files \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u751f\u6210\u5728\u5305\u7ea7\u522b\u4e2d\u5b9a\u4e49\u7684\u9876\u7ea7 message \u3001 enum \u548c service \uff0c\u800c\u4e0d\u662f\u5728 .proto \u6587\u4ef6\u4e4b\u540e\u547d\u540d\u7684\u5916\u90e8\u7c7b\u4e2d\u3002 protobuf option java_multiple_files = true; java_outer_classname \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u751f\u6210\u6700\u5916\u5c42\u7684Java\u7c7b\u7684\u7c7b\u540d\uff08\u4ee5\u53ca\u6587\u4ef6\u540d\uff09\u3002\u5982\u679c .proto \u6587\u4ef6\u4e2d\u6ca1\u6709\u6307\u5b9a\u663e\u5f0f\u7684 java_outer_classname \uff0c\u5219\u901a\u8fc7\u5c06 .proto \u6587\u4ef6\u540d\u8f6c\u6362\u4e3a\u9a7c\u5cf0\u547d\u540d\u6765\u6784\u9020\u7c7b\u540d\uff08\u56e0\u6b64 foo_bar.proto \u53d8\u4e3a FooBar.java \uff09\u3002\u5982\u679c\u4e0d\u751f\u6210Java\u4ee3\u7801\uff0c\u5219\u6b64\u9009\u9879\u65e0\u6548\u3002 protobuf option java_outer_classname = \"Ponycopter\"; optimize_for\uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u53ef\u4ee5\u8bbe\u7f6e\u4e3a SPEED \uff0c CODE_SIZE \u6216 LITE_RUNTIME \u3002\u8fd9\u4f1a\u5f71\u54cd C++ \u548c Java \u4ee3\u7801\u751f\u6210\u5668\uff08\u53ef\u80fd\u8fd8\u6709\u7b2c\u4e09\u65b9\u751f\u6210\u5668\uff09\uff0c\u4ee5\u4e0b\u5217\u65b9\u5f0f\uff1a protobuf option optimize_for = CODE_SIZE; SPEED \uff08default\uff09\uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u7528\u4e8e\u5bf9\u6d88\u606f\u7c7b\u578b\u8fdb\u884c\u5e8f\u5217\u5316\u3001\u89e3\u6790\u548c\u6267\u884c\u5176\u4ed6\u5e38\u89c1\u64cd\u4f5c\u7684\u4ee3\u7801\u3002\u6b64\u4ee3\u7801\u7ecf\u8fc7\u9ad8\u5ea6\u4f18\u5316\u3002 CODE_SIZE \uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u6700\u5c0f\u7684\u7c7b\uff0c\u5e76\u4f9d\u8d56\u4e8e\u57fa\u4e8e\u53cd\u5c04\u7684\u5171\u4eab\u4ee3\u7801\u6765\u5b9e\u73b0\u5e8f\u5217\u5316\u3001\u89e3\u6790\u548c\u5404\u79cd\u5176\u4ed6\u64cd\u4f5c\u3002\u56e0\u6b64\u751f\u6210\u7684\u4ee3\u7801\u5c06\u6bd4\u4f7f\u7528 SPEED \u5c0f\u5f97\u591a\uff0c\u4f46\u64cd\u4f5c\u4f1a\u66f4\u6162\u3002\u751f\u6210\u7684\u7c7b\u4ecd\u5c06\u5b9e\u73b0\u4e0e SPEED \u6a21\u5f0f\u5b8c\u5168\u76f8\u540c\u7684\u516c\u5171API\u3002\u6b64\u6a21\u5f0f\u5728\u5305\u542b\u5927\u91cf .proto \u6587\u4ef6\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6700\u6709\u7528\uff0c\u5e76\u4e14\u4e0d\u9700\u8981\u6240\u6709\u8fd9\u4e9b\u6587\u4ef6\u90fd\u975e\u5e38\u5feb\u901f\u3002 LITE_RUNTIME \uff1a protocol buffers \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4ec5\u4f9d\u8d56\u4e8e \u201clite\u201d \u7684\u8fd0\u884c\u65f6\u5e93\u7684\u7c7b\uff08\u5373\u4f9d\u8d56\u4e8e libprotobuf-lite \u800c\u4e0d\u662f libprotobuf \uff09\u3002 lite \u8fd0\u884c\u65f6\u5e93\u6bd4\u5b8c\u6574\u5e93\u5c0f\u5f97\u591a\uff08\u5927\u7ea6\u5c0f\u4e00\u4e2a\u6570\u91cf\u7ea7\uff09\uff0c\u5176\u4e2d\u7701\u7565\u4e86\u63cf\u8ff0\u7b26\u548c\u53cd\u5c04\u7b49\u529f\u80fd\u3002\u8fd9\u5bf9\u4e8e\u5728\u79fb\u52a8\u7535\u8bdd\u7b49\u53d7\u9650\u5e73\u53f0\u4e0a\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u5c24\u5176\u6709\u7528\u3002\u7f16\u8bd1\u5668\u4ecd\u5c06\u751f\u6210\u6240\u6709\u65b9\u6cd5\u7684\u5feb\u901f\u5b9e\u73b0\uff0c\u5c31\u50cf\u5728 SPEED \u6a21\u5f0f\u4e0b\u90a3\u6837\u3002\u751f\u6210\u7684\u7c7b\u5c06\u4ec5\u5b9e\u73b0\u6bcf\u79cd\u8bed\u8a00\u7684 MessageLite \u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u4ec5\u63d0\u4f9b\u5b8c\u6574 Message \u63a5\u53e3\u7684\u65b9\u6cd5\u7684\u5b50\u96c6\u3002 ` cc_enable_arenas \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u4e3a C++ \u751f\u6210\u7684\u4ee3\u7801\u542f\u7528 \u7ade\u6280\u573a\u5206\u914d \u3002 objc_class_prefix \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u8bbe\u7f6e Objective-C \u7c7b\u524d\u7f00\uff0c\u8be5\u524d\u7f00\u7531\u6b64 .proto \u6587\u4ef6\u63d0\u4f9b\u7ed9\u6240\u6709 Objective-C \u751f\u6210\u7684\u7c7b\u548c\u679a\u4e3e\uff0c\u6ca1\u6709\u9ed8\u8ba4\u503c\u3002\u5e94\u8be5\u4f7f\u7528 Apple\u5efa\u8bae \u76843-5\u4e2a\u5927\u5199\u5b57\u7b26\u4e4b\u95f4\u7684\u524d\u7f00\u3002\u8bf7\u6ce8\u610f\uff0cApple\u4fdd\u7559\u6240\u67092\u4e2a\u5b57\u6bcd\u7684\u524d\u7f00\u3002 deprecated \uff08\u6587\u4ef6\u7ea7\u9009\u9879\uff09\uff1a\u5982\u679c\u8bbe\u7f6e\u4e3a true \uff0c\u5219\u8868\u793a\u8be5\u5b57\u6bb5\u5df2\u5f03\u7528\uff0c\u65b0\u4ee3\u7801\u4e0d\u5e94\u4f7f\u7528\u8be5\u5b57\u6bb5\u3002\u5728\u5927\u591a\u6570\u8bed\u8a00\u4e2d\uff0c\u8fd9\u6ca1\u6709\u5b9e\u9645\u6548\u679c\u3002\u5728 Java \u4e2d\uff0c\u8fd9\u5c06\u6210\u4e3a @Deprecated \u6ce8\u91ca\u3002\u5c06\u6765\uff0c\u5176\u4ed6\u7279\u5b9a\u8bed\u8a00\u7684\u4ee3\u7801\u751f\u6210\u5668\u53ef\u80fd\u4f1a\u5728\u5b57\u6bb5\u7684\u8bbf\u95ee\u5668\u4e0a\u751f\u6210\u5f03\u7528\u6ce8\u91ca\uff0c\u8fd9\u5c06\u5bfc\u81f4\u5728\u7f16\u8bd1\u5c1d\u8bd5\u4f7f\u7528\u8be5\u5b57\u6bb5\u7684\u4ee3\u7801\u65f6\u53d1\u51fa\u8b66\u544a\u3002\u5982\u679c\u4efb\u4f55\u4eba\u90fd\u6ca1\u6709\u4f7f\u7528\u8be5\u5b57\u6bb5\uff0c\u5e76\u4e14\u60f3\u8981\u963b\u6b62\u65b0\u7528\u6237\u4f7f\u7528\u8be5\u5b57\u6bb5\uff0c\u8bf7\u8003\u8651\u4f7f\u7528 \u4fdd\u7559\u8bed\u53e5 \u66ff\u6362\u5b57\u6bb5\u58f0\u660e\u3002 protobuf int32 old_field = 6 [deprecated=true];","title":"\u53ef\u7528\u9009\u9879"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_23","text":"Protocol Buffers \u8fd8\u5141\u8bb8\u5b9a\u4e49\u548c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u3002\u8fd9\u662f\u5927\u591a\u6570\u4eba\u4e0d\u9700\u8981\u7684 \u9ad8\u7ea7\u529f\u80fd \u3002\u5982\u679c\u786e\u5b9e\u8ba4\u4e3a\u9700\u8981\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\uff0c\u8bf7\u53c2\u9605 proto2 \u8bed\u8a00\u6307\u5357 \u4ee5\u83b7\u53d6\u8be6\u7ec6\u4fe1\u606f\u3002\u8bf7\u6ce8\u610f\uff0c\u521b\u5efa\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u4f7f\u7528\u7684 \u6269\u5c55 \u4ec5\u5141\u8bb8\u7528\u4e8e proto3 \u4e2d\u7684\u81ea\u5b9a\u4e49\u7684\u9009\u9879\u3002","title":"\u81ea\u5b9a\u4e49\u9009\u9879"},{"location":"Frameworks/Protocol-Buffers/02-proto3\u6307\u5357/#_24","text":"\u9700\u8981\u4f7f .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u6d88\u606f\u7c7b\u578b\u6765\u751f\u6210 Java \uff0c Python \uff0c C++ \uff0c Go \uff0c Ruby \uff0c Objective-C \u6216 C\uff03 \u4ee3\u7801\uff0c\u8fd9\u9700\u8981\u5728 .proto \u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 protoc \u3002\u5982\u679c\u5c1a\u672a\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7\u4e0b\u8f7d\u8be5\u8f6f\u4ef6\u5305\u5e76\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002\u5bf9\u4e8e Go \uff0c\u8fd8\u9700\u8981\u4e3a\u7f16\u8bd1\u5668\u5b89\u88c5\u4e00\u4e2a\u7279\u6b8a\u7684\u4ee3\u7801\u751f\u6210\u5668\u63d2\u4ef6\uff0c\u53ef\u4ee5\u5728 GitHub \u4e0a\u7684 golang/protobuf \u5b58\u50a8\u5e93\u4e2d\u627e\u5230\u8fd9\u4e2a\u63d2\u4ef6\u548c\u5b89\u88c5\u8bf4\u660e\u3002 \u534f\u8bae\u7f16\u8bd1\u5668\u7684\u8c03\u7528\u5982\u4e0b\uff1a protoc --proto_path=IMPORT_PATH \\ --cpp_out=DST_DIR \\ --java_out=DST_DIR \\ --python_out=DST_DIR \\ --go_out=DST_DIR \\ --ruby_out=DST_DIR \\ --objc_out=DST_DIR \\ --csharp_out=DST_DIR \\ path/to/file.proto IMPORT_PATH \u6307\u5b9a\u89e3\u6790\u5bfc\u5165\u6307\u4ee4\u65f6\u67e5\u627e .proto \u6587\u4ef6\u7684\u76ee\u5f55\uff0c\u5982\u679c\u7701\u7565\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\u3002\u53ef\u4ee5\u901a\u8fc7\u591a\u6b21\u4f20\u9012 --proto_path \u9009\u9879\u6765\u6307\u5b9a\u591a\u4e2a\u5bfc\u5165\u76ee\u5f55,\u5c06\u6309\u987a\u5e8f\u641c\u7d22\u3002 -I=IMPORT_PATH \u53ef\u4ee5\u7528\u4f5c --proto_path \u7684\u7f29\u5199\u5f62\u5f0f\u3002 \u53ef\u4ee5\u63d0\u4f9b\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa\u6307\u4ee4\uff1a --cpp_out \u5728 DST_DIR \u4e2d\u751f\u6210 C++ \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 C++ \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --java_out \u5728 DST_DIR \u4e2d\u751f\u6210 Java \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Java \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --python_out \u5728 DST_DIR \u4e2d\u751f\u6210 Python \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Python \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --go_out \u5728 DST_DIR \u4e2d\u751f\u6210 Go \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Go \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --ruby_out \u5728 DST_DIR \u4e2d\u751f\u6210 Ruby \u4ee3\u7801\u3002 Ruby \u751f\u6210\u7684\u4ee3\u7801\u53c2\u8003\u5373\u5c06\u63a8\u51fa\uff01 --objc_out \u5728 DST_DIR \u4e2d\u751f\u6210 Objective-C \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Objective-C \u751f\u6210\u7684\u4ee3\u7801\u53c2\u8003 \u3002 --csharp_out \u5728 DST_DIR \u4e2d\u751f\u6210 C\uff03 \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 C\uff03 \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 --php_out \u5728 DST_DIR \u4e2d\u751f\u6210 PHP \u4ee3\u7801\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 PHP \u751f\u6210\u4ee3\u7801\u53c2\u8003 \u3002 \u4e3a\u65b9\u4fbf\u8d77\u89c1\uff0c\u5982\u679c DST_DIR \u4ee5 .zip \u6216. jar \u7ed3\u5c3e\uff0c\u7f16\u8bd1\u5668\u4f1a\u5c06\u8f93\u51fa\u5199\u5165\u5177\u6709\u7ed9\u5b9a\u540d\u79f0\u7684\u5355\u4e2a ZIP \u683c\u5f0f\u5b58\u6863\u6587\u4ef6\u3002 .jar \u8f93\u51fa\u8fd8\u5c06\u6839\u636e Java JAR \u89c4\u8303\u7684\u8981\u6c42\u63d0\u4f9b\u6e05\u5355\u6587\u4ef6\u3002\u8bf7\u6ce8\u610f\uff0c\u5982\u679c\u8f93\u51fa\u5b58\u6863\u5df2\u5b58\u5728\uff0c\u5219\u4f1a\u88ab\u8986\u76d6; \u7f16\u8bd1\u5668\u4e0d\u591f\u667a\u80fd\uff0c\u65e0\u6cd5\u5c06\u6587\u4ef6\u6dfb\u52a0\u5230\u73b0\u6709\u5b58\u6863\u4e2d\u3002 \u5fc5\u987b\u63d0\u4f9b\u4e00\u4e2a\u6216\u591a\u4e2a .proto \u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\u3002\u53ef\u4ee5\u4e00\u6b21\u6307\u5b9a\u591a\u4e2a .proto \u6587\u4ef6\u3002\u867d\u7136\u6587\u4ef6\u662f\u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u547d\u540d\u7684\uff0c\u4f46\u6bcf\u4e2a\u6587\u4ef6\u5fc5\u987b\u9a7b\u7559\u5728\u5176\u4e2d\u4e00\u4e2a IMPORT_PATH \u4e2d\uff0c\u4ee5\u4fbf\u7f16\u8bd1\u5668\u53ef\u4ee5\u786e\u5b9a\u5176\u89c4\u8303\u540d\u79f0\u3002","title":"\u751f\u6210\u81ea\u5b9a\u4e49\u7684\u7c7b"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/","text":"\u6837\u5f0f\u6307\u5357 \u672c\u6587\u6863\u63d0\u4f9b .proto \u6587\u4ef6\u7684\u6837\u5f0f\u6307\u5357\u3002\u901a\u8fc7\u9075\u5faa\u8fd9\u4e9b\u7ea6\u5b9a\uff0c\u5c06\u4f7f protocol buffers \u6d88\u606f\u5b9a\u4e49\u53ca\u5176\u76f8\u5e94\u7684\u7c7b\u4fdd\u6301\u4e00\u81f4\u4e14\u6613\u4e8e\u9605\u8bfb\u3002 \u8bf7\u6ce8\u610f\uff0c protocol buffers \u6837\u5f0f\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u53d1\u5c55\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u770b\u5230\u4ee5\u4e0d\u540c\u7ea6\u5b9a\u6216\u6837\u5f0f\u7f16\u5199\u7684 .proto \u6587\u4ef6\u3002\u4fee\u6539\u8fd9\u4e9b\u6587\u4ef6\u65f6\u8bf7\u5c0a\u91cd\u73b0\u6709\u6837\u5f0f\uff0c\u4e00\u81f4\u6027\u662f\u5173\u952e\u3002\u4f46\u662f\uff0c\u5728\u521b\u5efa\u65b0\u7684 .proto \u6587\u4ef6\u65f6\uff0c\u6700\u597d\u91c7\u7528\u5f53\u524d\u6700\u4f73\u6837\u5f0f\u3002 \u6807\u51c6\u6587\u4ef6\u683c\u5f0f \u4fdd\u6301\u884c\u957f\u5ea6\u4e3a80\u4e2a\u5b57\u7b26\u3002 \u4f7f\u75282\u4e2a\u7a7a\u683c\u7684\u7f29\u8fdb\u3002 \u6587\u4ef6\u7ed3\u6784 \u6587\u4ef6\u5e94\u547d\u540d\u4e3a lower_snake_case.proto (\u5c0f\u86c7\u5f0f) \u6587\u4ef6\u6216\u53d8\u91cf\u547d\u4ee4\u65b9\u5f0f\uff1a \u5927\u9a7c\u5cf0\u5f0f\uff1a CamelCase \u5c0f\u9a7c\u5cf0\u5f0f\uff1a camelCase \u5927\u86c7\u5f0f\uff1a GET_USER_NAME \u5c0f\u86c7\u5f0f\uff1a get_user_name \u70e4\u8089\u4e32\u5f0f\uff1a get-user-name \u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u6392\u5e8f\u6240\u6709\u6587\u4ef6\uff1a \u8bb8\u53ef\u8bc1\u6807\u9898\uff08\u5982\u679c\u9002\u7528\uff09 \u6587\u4ef6\u6982\u8ff0 \u53e5\u6cd5\uff08syntax\uff09 \u5305\uff08package\uff09 \u5bfc\u5165\uff08\u5206\u7c7b\uff0cimport\uff09 \u6587\u4ef6\u9009\u9879 \u5176\u4ed6 \u5305 \u5305\u540d\u79f0\u5e94\u4e3a \u5c0f\u5199 \uff0c\u5e76\u4e14\u5e94\u4e0e\u76ee\u5f55\u5c42\u6b21\u7ed3\u6784\u76f8\u5bf9\u5e94\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6587\u4ef6\u5728 my/package/ \u4e2d\uff0c\u90a3\u4e48\u5305\u540d\u5e94\u8be5\u662f my.package \u3002 \u6d88\u606f\u548c\u5b57\u6bb5\u540d\u79f0 \u5c06 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\u7528\u4e8e\u6d88\u606f\u540d\u79f0\u3002\u4f8b\u5982\uff0c SongServerRequest \u3002 \u5c06 underscore_separated_names \u7528\u4e8e\u5b57\u6bb5\u540d\u79f0\uff08\u5305\u62ec oneof \u5b57\u6bb5\u548c\u6269\u5c55\u540d\u79f0\uff09\u3002\u4f8b\u5982\uff0c song_name \u3002 message SongServerRequest { required string song_name = 1; } \u5bf9\u5b57\u6bb5\u540d\u79f0\u4f7f\u7528\u6b64\u547d\u540d\u7ea6\u5b9a\u53ef\u63d0\u4f9b\u4ee5\u4e0b\u8bbf\u95ee\u5668\uff1a C++: const string song_name() { ... } void set_song_name(const string x) { ... } Java: public String getSongName() { ... } public Builder setSongName(String v) { ... } \u5982\u679c\u5b57\u6bb5\u540d\u79f0\u5305\u542b\u6570\u5b57\uff0c\u5219\u8be5\u6570\u5b57\u5e94\u663e\u793a\u5728\u5b57\u6bcd\u540e\u9762\u800c\u4e0d\u662f\u4e0b\u5212\u7ebf\u4e4b\u540e\u3002\u4f8b\u5982\uff0c\u4f7f\u7528 song_name1 \u800c\u4e0d\u662f song_name_1 \u3002 Repeated \u5b57\u6bb5 \u5bf9 repeated \u5b57\u6bb5\u4f7f\u7528\u590d\u6570\u540d\u79f0\u3002 repeated string keys = 1; ... repeated MyMessage accounts = 17; \u679a\u4e3e \u5bf9\u4e8e\u679a\u4e3e\u7c7b\u578b\u540d\u79f0\u4f7f\u7528 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\uff0c\u5bf9\u503c\u540d\u79f0\u4f7f\u7528 CAPITALS_WITH_UNDERSCORES \uff08\u5927\u86c7\u5f0f\uff09\uff1a enum Foo { FOO_UNSPECIFIED = 0; FOO_FIRST_VALUE = 1; FOO_SECOND_VALUE = 2; } \u6bcf\u4e2a\u679a\u4e3e\u503c\u5e94\u4ee5 \u5206\u53f7\u7ed3\u675f \uff0c\u800c\u4e0d\u662f\u9017\u53f7\u3002\u66f4\u559c\u6b22\u4e3a\u679a\u4e3e\u503c\u6dfb\u52a0\u524d\u7f00\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u5305\u56f4\u5728\u5c01\u95ed\u6d88\u606f\u4e2d\u3002\u96f6\u503c\u679a\u4e3e\u5e94\u5177\u6709\u540e\u7f00 UNSPECIFIED (\u7f3a\u7701)\u3002 Servies\uff08\u670d\u52a1\uff09 \u5982\u679c .proto \u5b9a\u4e49\u4e86RPC\u670d\u52a1\uff0c\u5219\u5e94\u8be5\u5bf9\u670d\u52a1\u540d\u79f0\u548c\u4efb\u4f55RPC\u65b9\u6cd5\u540d\u79f0\u4f7f\u7528 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\uff1a service FooService { rpc GetSomething(FooRequest) returns (FooResponse); } \u8981\u907f\u514d\u7684\u4e8b\u60c5 Required\u5b57\u6bb5\uff08\u4ec5\u9002\u7528\u4e8eproto2\uff09 Groups\uff08\u4ec5\u9002\u7528\u4e8eproto2\uff09","title":"\u6837\u5f0f\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_1","text":"\u672c\u6587\u6863\u63d0\u4f9b .proto \u6587\u4ef6\u7684\u6837\u5f0f\u6307\u5357\u3002\u901a\u8fc7\u9075\u5faa\u8fd9\u4e9b\u7ea6\u5b9a\uff0c\u5c06\u4f7f protocol buffers \u6d88\u606f\u5b9a\u4e49\u53ca\u5176\u76f8\u5e94\u7684\u7c7b\u4fdd\u6301\u4e00\u81f4\u4e14\u6613\u4e8e\u9605\u8bfb\u3002 \u8bf7\u6ce8\u610f\uff0c protocol buffers \u6837\u5f0f\u968f\u7740\u65f6\u95f4\u7684\u63a8\u79fb\u800c\u53d1\u5c55\uff0c\u56e0\u6b64\u53ef\u80fd\u4f1a\u770b\u5230\u4ee5\u4e0d\u540c\u7ea6\u5b9a\u6216\u6837\u5f0f\u7f16\u5199\u7684 .proto \u6587\u4ef6\u3002\u4fee\u6539\u8fd9\u4e9b\u6587\u4ef6\u65f6\u8bf7\u5c0a\u91cd\u73b0\u6709\u6837\u5f0f\uff0c\u4e00\u81f4\u6027\u662f\u5173\u952e\u3002\u4f46\u662f\uff0c\u5728\u521b\u5efa\u65b0\u7684 .proto \u6587\u4ef6\u65f6\uff0c\u6700\u597d\u91c7\u7528\u5f53\u524d\u6700\u4f73\u6837\u5f0f\u3002","title":"\u6837\u5f0f\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_2","text":"\u4fdd\u6301\u884c\u957f\u5ea6\u4e3a80\u4e2a\u5b57\u7b26\u3002 \u4f7f\u75282\u4e2a\u7a7a\u683c\u7684\u7f29\u8fdb\u3002","title":"\u6807\u51c6\u6587\u4ef6\u683c\u5f0f"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_3","text":"\u6587\u4ef6\u5e94\u547d\u540d\u4e3a lower_snake_case.proto (\u5c0f\u86c7\u5f0f) \u6587\u4ef6\u6216\u53d8\u91cf\u547d\u4ee4\u65b9\u5f0f\uff1a \u5927\u9a7c\u5cf0\u5f0f\uff1a CamelCase \u5c0f\u9a7c\u5cf0\u5f0f\uff1a camelCase \u5927\u86c7\u5f0f\uff1a GET_USER_NAME \u5c0f\u86c7\u5f0f\uff1a get_user_name \u70e4\u8089\u4e32\u5f0f\uff1a get-user-name \u6309\u7167\u4ee5\u4e0b\u65b9\u5f0f\u6392\u5e8f\u6240\u6709\u6587\u4ef6\uff1a \u8bb8\u53ef\u8bc1\u6807\u9898\uff08\u5982\u679c\u9002\u7528\uff09 \u6587\u4ef6\u6982\u8ff0 \u53e5\u6cd5\uff08syntax\uff09 \u5305\uff08package\uff09 \u5bfc\u5165\uff08\u5206\u7c7b\uff0cimport\uff09 \u6587\u4ef6\u9009\u9879 \u5176\u4ed6","title":"\u6587\u4ef6\u7ed3\u6784"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_4","text":"\u5305\u540d\u79f0\u5e94\u4e3a \u5c0f\u5199 \uff0c\u5e76\u4e14\u5e94\u4e0e\u76ee\u5f55\u5c42\u6b21\u7ed3\u6784\u76f8\u5bf9\u5e94\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6587\u4ef6\u5728 my/package/ \u4e2d\uff0c\u90a3\u4e48\u5305\u540d\u5e94\u8be5\u662f my.package \u3002","title":"\u5305"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_5","text":"\u5c06 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\u7528\u4e8e\u6d88\u606f\u540d\u79f0\u3002\u4f8b\u5982\uff0c SongServerRequest \u3002 \u5c06 underscore_separated_names \u7528\u4e8e\u5b57\u6bb5\u540d\u79f0\uff08\u5305\u62ec oneof \u5b57\u6bb5\u548c\u6269\u5c55\u540d\u79f0\uff09\u3002\u4f8b\u5982\uff0c song_name \u3002 message SongServerRequest { required string song_name = 1; } \u5bf9\u5b57\u6bb5\u540d\u79f0\u4f7f\u7528\u6b64\u547d\u540d\u7ea6\u5b9a\u53ef\u63d0\u4f9b\u4ee5\u4e0b\u8bbf\u95ee\u5668\uff1a C++: const string song_name() { ... } void set_song_name(const string x) { ... } Java: public String getSongName() { ... } public Builder setSongName(String v) { ... } \u5982\u679c\u5b57\u6bb5\u540d\u79f0\u5305\u542b\u6570\u5b57\uff0c\u5219\u8be5\u6570\u5b57\u5e94\u663e\u793a\u5728\u5b57\u6bcd\u540e\u9762\u800c\u4e0d\u662f\u4e0b\u5212\u7ebf\u4e4b\u540e\u3002\u4f8b\u5982\uff0c\u4f7f\u7528 song_name1 \u800c\u4e0d\u662f song_name_1 \u3002","title":"\u6d88\u606f\u548c\u5b57\u6bb5\u540d\u79f0"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#repeated","text":"\u5bf9 repeated \u5b57\u6bb5\u4f7f\u7528\u590d\u6570\u540d\u79f0\u3002 repeated string keys = 1; ... repeated MyMessage accounts = 17;","title":"Repeated \u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_6","text":"\u5bf9\u4e8e\u679a\u4e3e\u7c7b\u578b\u540d\u79f0\u4f7f\u7528 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\uff0c\u5bf9\u503c\u540d\u79f0\u4f7f\u7528 CAPITALS_WITH_UNDERSCORES \uff08\u5927\u86c7\u5f0f\uff09\uff1a enum Foo { FOO_UNSPECIFIED = 0; FOO_FIRST_VALUE = 1; FOO_SECOND_VALUE = 2; } \u6bcf\u4e2a\u679a\u4e3e\u503c\u5e94\u4ee5 \u5206\u53f7\u7ed3\u675f \uff0c\u800c\u4e0d\u662f\u9017\u53f7\u3002\u66f4\u559c\u6b22\u4e3a\u679a\u4e3e\u503c\u6dfb\u52a0\u524d\u7f00\uff0c\u800c\u4e0d\u662f\u5c06\u5176\u5305\u56f4\u5728\u5c01\u95ed\u6d88\u606f\u4e2d\u3002\u96f6\u503c\u679a\u4e3e\u5e94\u5177\u6709\u540e\u7f00 UNSPECIFIED (\u7f3a\u7701)\u3002","title":"\u679a\u4e3e"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#servies","text":"\u5982\u679c .proto \u5b9a\u4e49\u4e86RPC\u670d\u52a1\uff0c\u5219\u5e94\u8be5\u5bf9\u670d\u52a1\u540d\u79f0\u548c\u4efb\u4f55RPC\u65b9\u6cd5\u540d\u79f0\u4f7f\u7528 CamelCase \uff08\u5e26\u6709\u521d\u59cb\u5927\u5199\uff09\uff1a service FooService { rpc GetSomething(FooRequest) returns (FooResponse); }","title":"Servies\uff08\u670d\u52a1\uff09"},{"location":"Frameworks/Protocol-Buffers/03-\u6837\u5f0f\u6307\u5357/#_7","text":"Required\u5b57\u6bb5\uff08\u4ec5\u9002\u7528\u4e8eproto2\uff09 Groups\uff08\u4ec5\u9002\u7528\u4e8eproto2\uff09","title":"\u8981\u907f\u514d\u7684\u4e8b\u60c5"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/","text":"\u7f16\u7801 \u4e00\u4e2a\u7b80\u5355\u7684\u6d88\u606f \u672c\u6587\u6863\u63cf\u8ff0\u4e86 protocol buffers \u6d88\u606f\u7684\u4e8c\u8fdb\u5236\u4f20\u8f93\u683c\u5f0f\u3002\u4e0d\u9700\u8981\u4e86\u89e3\u8fd9\u4e00\u70b9\u5c31\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528 protocol buffers \uff0c\u4f46\u4e86\u89e3\u4e0d\u540c\u7684 protocol buffers \u683c\u5f0f\u5982\u4f55\u5f71\u54cd\u7f16\u7801\u6d88\u606f\u7684\u5927\u5c0f\u662f\u975e\u5e38\u6709\u7528\u3002 \u5047\u8bbe\u6709\u4ee5\u4e0b\u975e\u5e38\u7b80\u5355\u7684\u6d88\u606f\u5b9a\u4e49\uff1a message Test1 { optional int32 a = 1; } \u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a Test1 \u6d88\u606f\u5e76\u5c06 a \u8bbe\u7f6e\u4e3a150\uff0c\u7136\u540e\u5c06\u6d88\u606f\u5e8f\u5217\u5316\u4e3a\u8f93\u51fa\u6d41\u3002\u5982\u679c\u80fd\u591f\u68c0\u67e5\u7f16\u7801\u7684\u6d88\u606f\uff0c\u4f1a\u770b\u5230\u4e09\u4e2a\u5b57\u8282\uff1a 08 96 01 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u4e48\u5c0f\u7684\u6570\u5b57\uff0c\u5b83\u662f\u4ec0\u4e48\u610f\u601d\uff1f\u7ee7\u7eed\u9605\u8bfb...... Base 128 Varint \u8981\u4e86\u89e3\u7b80\u5355\u7684 protocol buffers \u7f16\u7801\uff0c\u9996\u5148\u9700\u8981\u4e86\u89e3 varints ,\u5b83\u662f\u4e00\u79cd\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u8282\u5e8f\u5217\u5316\u6574\u6570\u7684\u65b9\u6cd5\u3002 \u8f83\u5c0f\u7684\u6570\u5b57\u5360\u7528\u8f83\u5c11\u7684\u5b57\u8282\u6570 \u3002 varint \u4e2d\u7684\u6bcf\u4e2a\u5b57\u8282\uff08\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u9664\u5916\uff09\u90fd\u8bbe\u7f6e\u4e86\u6700\u9ad8\u6709\u6548\u4f4d\uff08msb\uff0cmost significant bit\uff09\uff1a\u8fd9\u8868\u793a\u8fd8\u6709\u5f88\u591a\u5b57\u8282\u3002\u6bcf\u4e2a\u5b57\u8282\u7684\u4f4e7\u4f4d\u7528\u4e8e\u5b58\u50a87\u4f4d\u7ec4\u4e2d\u7684\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff0c \u6700\u4f4e\u6709\u6548\u7ec4\u4f18\u5148 \u3002 \u56e0\u6b64\uff0c\u5982\u4e0b\u6240\u793a\uff1a 0000 0001 // \u8fd9\u91cc\u662f\u6570\u5b571\uff0c\u5b83\u662f\u5355\u4e2a\u5b57\u8282\uff0c\u56e0\u6b64`msb`\u672a\u8bbe\u7f6e 1010 1100 0000 0010 // \u8fd9\u662f300\uff0c\u6709\u70b9\u590d\u6742\uff1a \u600e\u4e48\u77e5\u9053\u8fd9\u662f300\uff1f\u9996\u5148\u4ece\u6bcf\u4e2a\u5b57\u8282\u4e2d\u5220\u9664 msb \uff0c\u56e0\u4e3a\u8fd9\u53ea\u662f\u544a\u8bc9\u6211\u4eec\u662f\u5426\u5df2\u5230\u8fbe\u6570\u5b57\u7684\u672b\u5c3e\uff08\u5982\u6240\u89c1\uff0c\u5b83\u5728\u7b2c\u4e00\u4e2a\u5b57\u8282\u4e2d\u8bbe\u7f6e\uff0c\u56e0\u4e3a varint \u4e2d\u6709\u591a\u4e2a\u5b57\u8282\uff09 \uff1a 1010 1100 0000 0010 \u2192 010 1100 000 0010 \u53ef\u4ee5\u53cd\u8f6c\u8fd9\u4e24\u7ec47\u4f4d\uff0c\u56e0\u4e3a varints \u4f1a\u5c06\u5177\u6709\u6700\u4f4e\u6709\u6548\u7ec4\u7684\u6570\u5b57\u5b58\u50a8\u8d77\u6765\u3002\u7136\u540e\u8fde\u63a5\u5b83\u4eec\u4ee5\u83b7\u5f97\u6700\u7ec8\u7684\u503c\uff1a 000 0010 010 1100 \u2192 000 0010 ++ 010 1100 \u2192 100101100 \u2192 256 + 32 + 8 + 4 = 300 \u6d88\u606f\u7ed3\u6784 protocol buffers \u6d88\u606f\u662f\u4e00\u7cfb\u5217\u952e\u503c\u5bf9\u3002\u6d88\u606f\u7684\u4e8c\u8fdb\u5236\u7248\u672c\u53ea\u4f7f\u7528\u5b57\u6bb5\u7684\u6570\u5b57\u7f16\u53f7\u4f5c\u4e3a\u952e\u503c\u3002\u6bcf\u4e2a\u5b57\u6bb5\u7684\u540d\u79f0\u548c\u58f0\u660e\u7684\u7c7b\u578b\u53ea\u80fd\u901a\u8fc7\u5f15\u7528\u6d88\u606f\u7c7b\u578b\u7684\u5b9a\u4e49\uff08\u5373 .proto \u6587\u4ef6\uff09\u5728\u89e3\u7801\u7aef\u786e\u5b9a\u3002 \u5bf9\u6d88\u606f\u8fdb\u884c\u7f16\u7801\u65f6\uff0c\u952e\u548c\u503c\u5c06\u8fde\u63a5\u6210\u5b57\u8282\u6d41\u3002\u5728\u89e3\u7801\u6d88\u606f\u65f6\uff0c\u89e3\u6790\u5668\u9700\u8981\u80fd\u591f\u8df3\u8fc7\u5b83\u65e0\u6cd5\u8bc6\u522b\u7684\u5b57\u6bb5\u3002\u8fd9\u6837\uff0c\u53ef\u4ee5\u5c06\u65b0\u5b57\u6bb5\u6dfb\u52a0\u5230\u6d88\u606f\u4e2d\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u4e0d\u4e86\u89e3\u5b83\u4eec\u7684\u65e7\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u5728\u4f20\u8f93\u683c\u5f0f\u6d88\u606f\u4e2d\u6bcf\u5bf9\u7684\u201c\u952e\u201d\u5b9e\u9645\u4e0a\u662f\u4e24\u4e2a\u503c\uff1a \u6765\u81ea .proto \u6587\u4ef6\u7684\u5b57\u6bb5\u7f16\u53f7 \u63d0\u4f9b\u8db3\u591f\u4fe1\u606f\u4ee5\u67e5\u627e\u4ee5\u4e0b\u503c\u7684\u957f\u5ea6\u7684\u4f20\u8f93\u7c7b\u578b \u5728\u5927\u591a\u6570\u8bed\u8a00\u5b9e\u73b0\u4e2d\uff0c\u8be5\u952e\u79f0\u4e3a\u6807\u8bb0\u3002 \u53ef\u7528\u7684\u4f20\u8f93\u7c7b\u578b\u5982\u4e0b\uff1a Type Meaning Used For 0 Varint int32, int64, uint32, uint64, sint32, sint64, bool, enum 1 64-bit fixed64, sfixed64, double 2 Length-delimited string, bytes, embedded messages, packed repeated fields 3 Start group groups (deprecated) 4 End group groups (deprecated) 5 32-bit fixed32, sfixed32, float \u6d41\u5f0f\u6d88\u606f\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u5e26\u6709\u503c \uff08field_number 3\uff09| wire_type \u7684 varint \u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6570\u5b57\u7684\u6700\u540e\u4e09\u4f4d\u5b58\u50a8\u4f20\u8f93\u7c7b\u578b\u3002 \u73b0\u5728\u8ba9\u518d\u770b\u4e00\u4e0b\u4e0a\u9762\u7684\u4f8b\u5b50\u3002\u73b0\u5728\u77e5\u9053\u6d41\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57\u603b\u662f\u4e00\u4e2a varint \u952e\uff0c\u8fd9\u91cc\u662f08\uff0c\u6216\u8005\uff08\u5220\u9664msb\uff09\uff1a 000 1000 \u53d6\u6700\u540e\u4e09\u4f4d\u5f97\u5230\u4f20\u8f93\u7c7b\u578b\uff080\uff09\uff0c\u7136\u540e\u53f3\u79fb\u4e09\u6b21\u5f97\u5230\u5b57\u6bb5\u7f16\u53f7\uff081\uff09\u3002\u6240\u4ee5\u73b0\u5728\u77e5\u9053\u5b57\u6bb5\u7f16\u53f7\u662f1\uff0c\u4ee5\u53ca\u4e0b\u4e00\u4e2a\u503c\u662f varint \u3002\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u7684 varint-decoding \u77e5\u8bc6\uff0c\u53ef\u4ee5\u770b\u5230\u63a5\u4e0b\u6765\u7684\u4e24\u4e2a\u5b57\u8282\u5b58\u50a8\u503c150\u3002 96 01 = 1001 0110 0000 0001 \u2192 000 0001 ++ 001 0110 (drop the msb and reverse the groups of 7 bits) \u2192 10010110 \u2192 128 + 16 + 4 + 2 = 150 \u66f4\u591a\u503c\u7c7b\u578b \u6709\u7b26\u53f7\u6574\u6570 \u6b63\u5982\u5728\u4e0a\u4e00\u8282\u4e2d\u770b\u5230\u7684\uff0c\u4e0e\u4f20\u8f93\u7c7b\u578b0\u5173\u8054\u7684\u6240\u6709 protocol buffers \u7c7b\u578b\u90fd\u88ab\u7f16\u7801\u4e3a varints \u3002\u4f46\u662f\uff0c\u5728\u7f16\u7801\u8d1f\u6570\u65f6\uff0c signed int \u7c7b\u578b\uff08 sint32 \u548c sint64 \uff09\u4e0e \u201cstandard\u201dint \u7c7b\u578b\uff08 int32 \u548c int64 \uff09\u4e4b\u95f4\u5b58\u5728\u91cd\u8981\u5dee\u5f02\u3002\u5982\u679c\u4f7f\u7528 int32 \u6216 int64 \u4f5c\u4e3a\u8d1f\u6570\u7684\u7c7b\u578b\uff0c\u5219\u751f\u6210\u7684 varint \u603b\u662f\u5341\u4e2a\u5b57\u8282\u957f\uff0c\u5b9e\u9645\u4e0a\uff0c\u5b83\u88ab\u89c6\u4e3a\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u65e0\u7b26\u53f7\u6574\u6570\u3002\u5982\u679c\u4f7f\u7528\u5176\u4e2d\u4e00\u79cd\u6709\u7b26\u53f7\u7c7b\u578b\uff0c\u5219\u751f\u6210\u7684 varint \u4f7f\u7528 ZigZag \u7f16\u7801\uff0c\u8fd9\u6837\u6548\u7387\u66f4\u9ad8\u3002 ZigZag \u7f16\u7801\u5c06\u6709\u7b26\u53f7\u6574\u6570\u6620\u5c04\u5230\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u56e0\u6b64\u5177\u6709\u8f83\u5c0f\u7edd\u5bf9\u503c\uff08\u4f8b\u5982\uff0c-1\uff09\u7684\u6570\u5b57\u4e5f\u5177\u6709\u8f83\u5c0f\u7684 varint \u7f16\u7801\u503c\u3002\u5b83\u901a\u8fc7\u6b63\u8d1f\u6574\u6570\u6765\u56de \u201czig-zags\u201d \u7684\u65b9\u5f0f\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u56e0\u6b64-1\u88ab\u7f16\u7801\u4e3a1,1\u88ab\u7f16\u7801\u4e3a2\uff0c-2\u88ab\u7f16\u7801\u4e3a3\uff0c\u4f9d\u6b64\u7c7b\u63a8\uff0c\u53ef\u4ee5\u5728\u4e0b\u8868\u4e2d\u770b\u5230\uff1a Signed Original Encoded As 0 0 -1 1 1 2 -2 3 2147483647 4294967294 -2147483648 4294967295 \u6362\u53e5\u8bdd\u8bf4\uff0c\u6bcf\u4e2a\u503c n \u88ab\u7f16\u7801\uff1a (n 1) ^ (n 31) \u6210\u4e3a sint32 s\uff0c\u6216\u8005\uff1a (n 1) ^ (n 63) \u6210\u4e3a64\u4e3a\u7684\u7248\u672c\u3002 \u6ce8\u610f\uff0c\u7b2c\u4e8c\u4e2a\u79fb\u4f4d \uff08n 31\uff09 \u90e8\u5206\u662f\u7b97\u672f\u79fb\u4f4d\u3002\u56e0\u6b64\uff0c\u79fb\u4f4d\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u5168\u4e3a\u96f6\u7684\u6570\u5b57\uff08\u5982\u679c n \u4e3a\u6b63\uff09\u6216\u5168\u90e8\u4e3a\u4e00\u4f4d\uff08\u5982\u679c n \u4e3a\u8d1f\uff09\u3002 \u975e varint \u6570\u5b57 \u975e varint \u6570\u5b57\u7c7b\u578b\u5f88\u7b80\u5355\uff1a double \u548c fixed64 \u6709\u4f20\u8f93\u7c7b\u578b1\uff0c\u5b83\u544a\u8bc9\u89e3\u6790\u5668\u671f\u671b\u4e00\u4e2a\u56fa\u5b9a\u768464\u4f4d\u6570\u636e\u5757; \u7c7b\u4f3c\u5730\uff0c float \u548c fixed32 \u5177\u6709\u4f20\u8f93\u7c7b\u578b5\uff0c\u8fd9\u544a\u8bc9\u5b83\u671f\u671b32\u4f4d\u3002\u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u503c\u90fd\u4ee5 little-endian \u5b57\u8282\u987a\u5e8f\u5b58\u50a8\u3002 Strings \u4f20\u8f93\u7c7b\u578b\u4e3a2\uff08\u957f\u5ea6\u5206\u9694\uff09\u8868\u793a\u8be5\u503c\u662f varint \u7f16\u7801\u957f\u5ea6\uff0c\u540e\u8ddf\u6307\u5b9a\u7684\u6570\u636e\u5b57\u8282\u6570\u3002 message Test2 { optional string b = 2; } \u5c06 b \u7684\u503c\u8bbe\u7f6e\u4e3a \u201ctesting\u201d \u53ef\u4ee5\u5f97\u5230\uff1a 12 07 74 65 73 74 69 6e 67 \u7b2c\u4e09\u4e2a\u5f00\u59cb\u7684\u5b57\u8282\u662f \u201ctesting\u201d \u7684UTF8\u7f16\u7801\u3002\u8fd9\u91cc\u7684\u5173\u952e\u662f 0x12 \u2192\u5b57\u6bb5\u7f16\u53f7=2\uff0c\u7c7b\u578b=2.\u503c\u4e2d\u7684\u957f varint \u662f7\uff0c\u5b83\u540e\u9762\u7684\u4e03\u4e2a\u5b57\u8282\u662f\u6240\u9700\u8981\u7684\u5b57\u7b26\u4e32\u3002 \u5d4c\u5165\u5f0f\u6d88\u606f \u8fd9\u662f\u4e00\u4e2a\u6d88\u606f\u5b9a\u4e49\uff0c\u5e26\u6709\u793a\u4f8b\u7c7b\u578b Test1 \u7684\u5d4c\u5165\u6d88\u606f\uff1a message Test3 { optional Test1 c = 3; } \u8fd9\u662f\u7f16\u7801\u7248\u672c\uff0c\u518d\u6b21\u5c06 Test1 \u7684 a \u5b57\u6bb5\u8bbe\u7f6e\u4e3a150\uff1a 1a 03 08 96 01 \u5982\u4e0a\u6240\u793a\uff0c\u6700\u540e\u4e09\u4e2a\u5b57\u8282\u4e0e\u7b2c\u4e00\u4e2a\u793a\u4f8b\uff08 08 96 01 \uff09\u5b8c\u5168\u76f8\u540c\uff0c\u5e76\u4e14\u5b83\u4eec\u524d\u9762\u662f\u6570\u5b573\uff0c\u5d4c\u5165\u5f0f\u6d88\u606f\u7684\u5904\u7406\u65b9\u5f0f\u4e0e\u5b57\u7b26\u4e32\u5b8c\u5168\u76f8\u540c\uff08\u4f20\u8f93\u7c7b\u578b= 2\uff09 \u3002 \u53ef\u9009\u548c\u91cd\u590d\u5143\u7d20 \u5982\u679c proto2 \u6d88\u606f\u5b9a\u4e49\u5177\u6709 repeated \u5143\u7d20\uff08\u6ca1\u6709[ packed = true ]\u9009\u9879\uff09\uff0c\u5219\u7f16\u7801\u6d88\u606f\u5177\u6709\u96f6\u4e2a\u6216\u591a\u4e2a\u5177\u6709\u76f8\u540c\u5b57\u6bb5\u7f16\u53f7\u7684\u952e\u503c\u5bf9\u3002\u8fd9\u4e9b\u91cd\u590d\u503c\u4e0d\u5fc5\u8fde\u7eed\u51fa\u73b0; \u5b83\u4eec\u53ef\u80fd\u4e0e\u5176\u4ed6\u5b57\u6bb5\u4ea4\u9519\u3002\u89e3\u6790\u65f6\u4fdd\u7559\u5143\u7d20\u76f8\u5bf9\u4e8e\u5f7c\u6b64\u7684\u987a\u5e8f\uff0c\u5c3d\u7ba1\u4e22\u5931\u4e86\u5173\u4e8e\u5176\u4ed6\u5b57\u6bb5\u7684\u987a\u5e8f\u3002 \u5728 proto3 \u4e2d\uff0c repeated \u5b57\u6bb5\u4f7f\u7528 \u538b\u7f29\u7f16\u7801 \uff0c\u53ef\u4ee5\u5728\u4e0b\u9762\u9605\u8bfb\u3002 \u5bf9\u4e8e proto3 \u4e2d\u7684\u4efb\u4f55\u975e repeated \u5b57\u6bb5\u6216 proto2 \u4e2d\u7684 optional \u5b57\u6bb5\uff0c\u7f16\u7801\u6d88\u606f\u53ef\u80fd\u5177\u6709\u6216\u4e0d\u5177\u6709\u8be5\u5b57\u6bb5\u7f16\u53f7\u7684\u952e\u503c\u5bf9\u3002 \u901a\u5e38\uff0c\u7f16\u7801\u6d88\u606f\u6c38\u8fdc\u4e0d\u4f1a\u6709\u591a\u4e2a\u975e repeated \u5b57\u6bb5\u7684\u5b9e\u4f8b\u3002\u4f46\u662f\uff0c\u89e3\u6790\u5668\u5e94\u8be5\u5904\u7406\u8fd9\u4e9b\u60c5\u51b5\u3002 \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\u548c\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u591a\u6b21\u51fa\u73b0\u76f8\u540c\u7684\u5b57\u6bb5\uff0c\u5219\u89e3\u6790\u5668\u63a5\u53d7\u5b83\u770b\u5230\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002 \u5bf9\u4e8e\u5d4c\u5165\u5f0f\u6d88\u606f\u5b57\u6bb5\uff0c\u89e3\u6790\u5668\u5408\u5e76\u540c\u4e00\u5b57\u6bb5\u7684\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5c31\u50cf\u4f7f\u7528 Message::MergeFrom \u65b9\u6cd5\u4e00\u6837\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u540e\u4e00\u4e2a\u5b9e\u4f8b\u4e2d\u7684\u6240\u6709\u5355\u4e2a\u6807\u91cf\u5b57\u6bb5\u90fd\u66ff\u6362\u524d\u8005\uff0c\u5355\u4e2a\u5d4c\u5165\u6d88\u606f\u88ab\u5408\u5e76\uff0c\u5e76\u4e14\u8fde\u63a5\u91cd\u590d\u5b57\u6bb5\u3002\u8fd9\u4e9b\u89c4\u5219\u7684\u4f5c\u7528\u662f\u89e3\u6790\u4e24\u4e2a\u8fde\u63a5\u7684\u7f16\u7801\u6d88\u606f\u4ea7\u751f\u7684\u7ed3\u679c\u4e0e\u5206\u522b\u89e3\u6790\u4e24\u4e2a\u6d88\u606f\u540e\u5e76\u5408\u89e3\u6790\u7ed3\u679c\u6240\u5f97\u5230\u7684\u7ed3\u679c\u5b8c\u5168\u76f8\u540c\u3002\u5c31\u662f\u8fd9\u6837\uff1a MyMessage message; message.ParseFromString(str1 + str2); \u76f8\u5f53\u4e8e\uff1a MyMessage message, message2; message.ParseFromString(str1); message2.ParseFromString(str2); message.MergeFrom(message2); \u6b64\u5c5e\u6027\u5076\u5c14\u4f1a\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u5408\u5e76\u4e24\u6761\u6d88\u606f\uff0c\u5373\u4f7f\u4e0d\u77e5\u9053\u5b83\u4eec\u7684\u7c7b\u578b\u3002 \u538b\u7f29\u91cd\u590d\u5b57\u6bb5 \u7248\u672c 2.1.0 \u5f15\u5165\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\uff0c\u5728 proto2 \u4e2d\u58f0\u660e\u4e3a\u91cd\u590d\u5b57\u6bb5\uff0c\u4f46\u5177\u6709\u7279\u6b8a\u7684[ packed = true ]\u9009\u9879\u3002\u5728 proto3 \u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u538b\u7f29\u6807\u91cf\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\u3002\u8fd9\u4e9b\u529f\u80fd\u7c7b\u4f3c\u4e8e\u91cd\u590d\u7684\u5b57\u6bb5\uff0c\u4f46\u7f16\u7801\u65b9\u5f0f\u4e0d\u540c\u3002\u5305\u542b\u96f6\u5143\u7d20\u7684\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\u4e0d\u4f1a\u51fa\u73b0\u5728\u7f16\u7801\u6d88\u606f\u4e2d\u3002\u5426\u5219\uff0c\u8be5\u5b57\u6bb5\u7684\u6240\u6709\u5143\u7d20\u90fd\u88ab\u538b\u7f29\u5230\u4e00\u4e2a\u952e\u503c\u5bf9\u4e2d\uff0c\u5176\u4e2d\u4f20\u8f93\u7c7b\u578b\u4e3a2\uff08\u957f\u5ea6\u5206\u9694\uff09\u3002\u6bcf\u4e2a\u5143\u7d20\u7684\u7f16\u7801\u65b9\u5f0f\u4e0e\u6b63\u5e38\u60c5\u51b5\u76f8\u540c\uff0c\u53ea\u662f\u524d\u9762\u6ca1\u6709\u952e\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6709\u5982\u4e0b\u6d88\u606f\u7c7b\u578b\uff1a message Test4 { repeated int32 d = 4 [packed=true]; } \u73b0\u5728\u5047\u8bbe\u6784\u9020\u4e00\u4e2a Test4 \uff0c\u4e3a\u91cd\u590d\u5b57\u6bb5 d \u63d0\u4f9b\u503c3,270\u548c86942\u3002\u7136\u540e\uff0c\u7f16\u7801\u7684\u5f62\u5f0f\u5c06\u662f\uff1a 22 // key (\u5b57\u6bb5\u7f16\u53f74, \u4f20\u8f93\u7c7b\u578b2) 06 // payload size (6 bytes) 03 // first element (varint 3) 8E 02 // second element (varint 270) 9E A7 05 // third element (varint 86942) \u53ea\u6709\u539f\u59cb\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\uff08\u4f7f\u7528 varint \u3001 32 \u4f4d\u6216 64 \u4f4d\u4f20\u8f93\u7c7b\u578b\u7684\u7c7b\u578b\uff09\u624d\u80fd\u58f0\u660e\u4e3a \u201cpacked\u201d \u3002 \u8bf7\u6ce8\u610f\uff0c\u867d\u7136\u901a\u5e38\u6ca1\u6709\u7406\u7531\u4e3a\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\u7f16\u7801\u591a\u4e2a\u952e\u503c\u5bf9\uff0c\u4f46\u7f16\u7801\u5668\u5fc5\u987b\u51c6\u5907\u597d\u63a5\u53d7\u591a\u4e2a\u952e\u503c\u5bf9\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u8be5\u8fde\u63a5\u6709\u6548\u8d1f\u8f7d(payloads)\u3002\u6bcf\u4e2a\u952e\u503c\u5bf9\u5fc5\u987b\u5305\u542b\u5927\u91cf\u5143\u7d20\u3002 protocol buffers \u89e3\u6790\u5668\u5fc5\u987b\u80fd\u591f\u89e3\u6790\u538b\u7f29\u7684\u91cd\u590d\u5b57\u6bb5\uff0c\u5c31\u597d\u50cf\u5b83\u4eec\u6ca1\u6709\u538b\u7f29\u4e00\u6837\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u8fd9\u5141\u8bb8\u4ee5\u5411\u524d\u548c\u540e\u5411\u517c\u5bb9\u7684\u65b9\u5f0f\u5c06[ packed = true ]\u6dfb\u52a0\u5230\u73b0\u6709\u5b57\u6bb5\u3002 \u5b57\u6bb5\u987a\u5e8f \u5b57\u6bb5\u7f16\u53f7\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u4ee5\u4efb\u4f55\u987a\u5e8f\u4f7f\u7528\u3002\u9009\u62e9\u7684\u987a\u5e8f\u5bf9\u6d88\u606f\u7684\u5e8f\u5217\u5316\u65b9\u5f0f\u6ca1\u6709\u5f71\u54cd\u3002 \u5f53\u5e8f\u5217\u5316\u6d88\u606f\u65f6\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u5176\u5df2\u77e5\u6216 \u672a\u77e5\u5b57\u6bb5 \u7684\u5199\u5165\u987a\u5e8f\u3002\u5e8f\u5217\u5316\u987a\u5e8f\u662f\u4e00\u4e2a\u5b9e\u73b0\u7ec6\u8282\uff0c\u4efb\u4f55\u7279\u5b9a\u5b9e\u73b0\u7684\u7ec6\u8282\u53ef\u80fd\u5728\u5c06\u6765\u53d1\u751f\u53d8\u5316\u3002\u56e0\u6b64\uff0c protocol buffers \u89e3\u6790\u5668\u5fc5\u987b\u80fd\u591f\u4ee5\u4efb\u4f55\u987a\u5e8f\u89e3\u6790\u5b57\u6bb5\u3002 \u542f\u793a \u4e0d\u8981\u5047\u8bbe\u5e8f\u5217\u5316\u6d88\u606f\u7684\u5b57\u8282\u8f93\u51fa\u662f\u7a33\u5b9a\u7684\u3002\u5bf9\u4e8e\u5177\u6709\u8868\u793a\u5176\u4ed6\u5e8f\u5217\u5316 protocol buffers \u6d88\u606f\u7684\u4f20\u9012\u5b57\u8282\u5b57\u6bb5\u7684\u6d88\u606f\u5c24\u5176\u5982\u6b64\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u540c\u4e00 protocol buffers \u6d88\u606f\u5b9e\u4f8b\u4e0a\u91cd\u590d\u8c03\u7528\u5e8f\u5217\u5316\u65b9\u6cd5\u53ef\u80fd\u4e0d\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u5b57\u8282\u8f93\u51fa;\u5373\u9ed8\u8ba4\u5e8f\u5217\u5316\u4e0d\u662f\u786e\u5b9a\u6027\u7684\u3002 \u786e\u5b9a\u6027\u5e8f\u5217\u5316\u4ec5\u4fdd\u8bc1\u7279\u5b9a\u5bf9\u4e8e\u7279\u5b9a\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f93\u51fa\u76f8\u540c\u7684\u5b57\u8282\u3002\u5b57\u8282\u8f93\u51fa\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7248\u672c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u53d1\u751f\u53d8\u5316\u3002 \u5bf9\u4e8e protocol buffers \u6d88\u606f\u5b9e\u4f8b foo \uff0c\u4ee5\u4e0b\u68c0\u67e5\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 foo.SerializeAsString() == foo.SerializeAsString() Hash(foo.SerializeAsString()) == Hash(foo.SerializeAsString()) CRC(foo.SerializeAsString()) == CRC(foo.SerializeAsString()) FingerPrint(foo.SerializeAsString()) == FingerPrint(foo.SerializeAsString()) \u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\u573a\u666f\uff0c\u5176\u4e2d\u903b\u8f91\u4e0a\u7b49\u6548\u7684 protocol buffers \u6d88\u606f foo \u548c bar \u53ef\u4ee5\u5e8f\u5217\u5316\u4e3a\u4e0d\u540c\u7684\u5b57\u8282\u8f93\u51fa\u3002 bar \u7531\u65e7\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u5c06\u67d0\u4e9b\u5b57\u6bb5\u89c6\u4e3a\u672a\u77e5\u3002 bar \u7531\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u8be5\u670d\u52a1\u5668\u4ee5\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\uff0c\u5e76\u6309\u4e0d\u540c\u987a\u5e8f\u5e8f\u5217\u5316\u5b57\u6bb5\u3002 bar \u6709\u4e00\u4e2a\u4ee5\u975e\u786e\u5b9a\u6027\u65b9\u5f0f\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\u3002 bar \u6709\u4e00\u4e2a\u5b57\u6bb5\uff0c\u7528\u4e8e\u5b58\u50a8 protocol buffers \u6d88\u606f\u7684\u5e8f\u5217\u5316\u5b57\u8282\u8f93\u51fa\uff0c\u8be5\u6d88\u606f\u4ee5\u4e0d\u540c\u65b9\u5f0f\u5e8f\u5217\u5316\u3002 bar \u7531\u65b0\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u8be5\u670d\u52a1\u5668\u7531\u4e8e\u5b9e\u73b0\u66f4\u6539\u56e0\u6b64\u4ee5\u4e0d\u540c\u987a\u5e8f\u5e8f\u5217\u5316\u5b57\u6bb5\u3002 foo \u548c bar \u90fd\u662f\u5355\u4e2a\u6d88\u606f\u7684\u4e32\u8054\uff0c\u4f46\u987a\u5e8f\u4e0d\u540c\u3002","title":"\u7f16\u7801"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_1","text":"","title":"\u7f16\u7801"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_2","text":"\u672c\u6587\u6863\u63cf\u8ff0\u4e86 protocol buffers \u6d88\u606f\u7684\u4e8c\u8fdb\u5236\u4f20\u8f93\u683c\u5f0f\u3002\u4e0d\u9700\u8981\u4e86\u89e3\u8fd9\u4e00\u70b9\u5c31\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528 protocol buffers \uff0c\u4f46\u4e86\u89e3\u4e0d\u540c\u7684 protocol buffers \u683c\u5f0f\u5982\u4f55\u5f71\u54cd\u7f16\u7801\u6d88\u606f\u7684\u5927\u5c0f\u662f\u975e\u5e38\u6709\u7528\u3002 \u5047\u8bbe\u6709\u4ee5\u4e0b\u975e\u5e38\u7b80\u5355\u7684\u6d88\u606f\u5b9a\u4e49\uff1a message Test1 { optional int32 a = 1; } \u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\uff0c\u521b\u5efa\u4e00\u4e2a Test1 \u6d88\u606f\u5e76\u5c06 a \u8bbe\u7f6e\u4e3a150\uff0c\u7136\u540e\u5c06\u6d88\u606f\u5e8f\u5217\u5316\u4e3a\u8f93\u51fa\u6d41\u3002\u5982\u679c\u80fd\u591f\u68c0\u67e5\u7f16\u7801\u7684\u6d88\u606f\uff0c\u4f1a\u770b\u5230\u4e09\u4e2a\u5b57\u8282\uff1a 08 96 01 \u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u4e48\u5c0f\u7684\u6570\u5b57\uff0c\u5b83\u662f\u4ec0\u4e48\u610f\u601d\uff1f\u7ee7\u7eed\u9605\u8bfb......","title":"\u4e00\u4e2a\u7b80\u5355\u7684\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#base-128-varint","text":"\u8981\u4e86\u89e3\u7b80\u5355\u7684 protocol buffers \u7f16\u7801\uff0c\u9996\u5148\u9700\u8981\u4e86\u89e3 varints ,\u5b83\u662f\u4e00\u79cd\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u8282\u5e8f\u5217\u5316\u6574\u6570\u7684\u65b9\u6cd5\u3002 \u8f83\u5c0f\u7684\u6570\u5b57\u5360\u7528\u8f83\u5c11\u7684\u5b57\u8282\u6570 \u3002 varint \u4e2d\u7684\u6bcf\u4e2a\u5b57\u8282\uff08\u6700\u540e\u4e00\u4e2a\u5b57\u8282\u9664\u5916\uff09\u90fd\u8bbe\u7f6e\u4e86\u6700\u9ad8\u6709\u6548\u4f4d\uff08msb\uff0cmost significant bit\uff09\uff1a\u8fd9\u8868\u793a\u8fd8\u6709\u5f88\u591a\u5b57\u8282\u3002\u6bcf\u4e2a\u5b57\u8282\u7684\u4f4e7\u4f4d\u7528\u4e8e\u5b58\u50a87\u4f4d\u7ec4\u4e2d\u7684\u4e8c\u8fdb\u5236\u8865\u7801\u8868\u793a\uff0c \u6700\u4f4e\u6709\u6548\u7ec4\u4f18\u5148 \u3002 \u56e0\u6b64\uff0c\u5982\u4e0b\u6240\u793a\uff1a 0000 0001 // \u8fd9\u91cc\u662f\u6570\u5b571\uff0c\u5b83\u662f\u5355\u4e2a\u5b57\u8282\uff0c\u56e0\u6b64`msb`\u672a\u8bbe\u7f6e 1010 1100 0000 0010 // \u8fd9\u662f300\uff0c\u6709\u70b9\u590d\u6742\uff1a \u600e\u4e48\u77e5\u9053\u8fd9\u662f300\uff1f\u9996\u5148\u4ece\u6bcf\u4e2a\u5b57\u8282\u4e2d\u5220\u9664 msb \uff0c\u56e0\u4e3a\u8fd9\u53ea\u662f\u544a\u8bc9\u6211\u4eec\u662f\u5426\u5df2\u5230\u8fbe\u6570\u5b57\u7684\u672b\u5c3e\uff08\u5982\u6240\u89c1\uff0c\u5b83\u5728\u7b2c\u4e00\u4e2a\u5b57\u8282\u4e2d\u8bbe\u7f6e\uff0c\u56e0\u4e3a varint \u4e2d\u6709\u591a\u4e2a\u5b57\u8282\uff09 \uff1a 1010 1100 0000 0010 \u2192 010 1100 000 0010 \u53ef\u4ee5\u53cd\u8f6c\u8fd9\u4e24\u7ec47\u4f4d\uff0c\u56e0\u4e3a varints \u4f1a\u5c06\u5177\u6709\u6700\u4f4e\u6709\u6548\u7ec4\u7684\u6570\u5b57\u5b58\u50a8\u8d77\u6765\u3002\u7136\u540e\u8fde\u63a5\u5b83\u4eec\u4ee5\u83b7\u5f97\u6700\u7ec8\u7684\u503c\uff1a 000 0010 010 1100 \u2192 000 0010 ++ 010 1100 \u2192 100101100 \u2192 256 + 32 + 8 + 4 = 300","title":"Base 128 Varint"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_3","text":"protocol buffers \u6d88\u606f\u662f\u4e00\u7cfb\u5217\u952e\u503c\u5bf9\u3002\u6d88\u606f\u7684\u4e8c\u8fdb\u5236\u7248\u672c\u53ea\u4f7f\u7528\u5b57\u6bb5\u7684\u6570\u5b57\u7f16\u53f7\u4f5c\u4e3a\u952e\u503c\u3002\u6bcf\u4e2a\u5b57\u6bb5\u7684\u540d\u79f0\u548c\u58f0\u660e\u7684\u7c7b\u578b\u53ea\u80fd\u901a\u8fc7\u5f15\u7528\u6d88\u606f\u7c7b\u578b\u7684\u5b9a\u4e49\uff08\u5373 .proto \u6587\u4ef6\uff09\u5728\u89e3\u7801\u7aef\u786e\u5b9a\u3002 \u5bf9\u6d88\u606f\u8fdb\u884c\u7f16\u7801\u65f6\uff0c\u952e\u548c\u503c\u5c06\u8fde\u63a5\u6210\u5b57\u8282\u6d41\u3002\u5728\u89e3\u7801\u6d88\u606f\u65f6\uff0c\u89e3\u6790\u5668\u9700\u8981\u80fd\u591f\u8df3\u8fc7\u5b83\u65e0\u6cd5\u8bc6\u522b\u7684\u5b57\u6bb5\u3002\u8fd9\u6837\uff0c\u53ef\u4ee5\u5c06\u65b0\u5b57\u6bb5\u6dfb\u52a0\u5230\u6d88\u606f\u4e2d\uff0c\u800c\u4e0d\u4f1a\u7834\u574f\u4e0d\u4e86\u89e3\u5b83\u4eec\u7684\u65e7\u7a0b\u5e8f\u3002\u56e0\u6b64\uff0c\u5728\u4f20\u8f93\u683c\u5f0f\u6d88\u606f\u4e2d\u6bcf\u5bf9\u7684\u201c\u952e\u201d\u5b9e\u9645\u4e0a\u662f\u4e24\u4e2a\u503c\uff1a \u6765\u81ea .proto \u6587\u4ef6\u7684\u5b57\u6bb5\u7f16\u53f7 \u63d0\u4f9b\u8db3\u591f\u4fe1\u606f\u4ee5\u67e5\u627e\u4ee5\u4e0b\u503c\u7684\u957f\u5ea6\u7684\u4f20\u8f93\u7c7b\u578b \u5728\u5927\u591a\u6570\u8bed\u8a00\u5b9e\u73b0\u4e2d\uff0c\u8be5\u952e\u79f0\u4e3a\u6807\u8bb0\u3002 \u53ef\u7528\u7684\u4f20\u8f93\u7c7b\u578b\u5982\u4e0b\uff1a Type Meaning Used For 0 Varint int32, int64, uint32, uint64, sint32, sint64, bool, enum 1 64-bit fixed64, sfixed64, double 2 Length-delimited string, bytes, embedded messages, packed repeated fields 3 Start group groups (deprecated) 4 End group groups (deprecated) 5 32-bit fixed32, sfixed32, float \u6d41\u5f0f\u6d88\u606f\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u5e26\u6709\u503c \uff08field_number 3\uff09| wire_type \u7684 varint \u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6570\u5b57\u7684\u6700\u540e\u4e09\u4f4d\u5b58\u50a8\u4f20\u8f93\u7c7b\u578b\u3002 \u73b0\u5728\u8ba9\u518d\u770b\u4e00\u4e0b\u4e0a\u9762\u7684\u4f8b\u5b50\u3002\u73b0\u5728\u77e5\u9053\u6d41\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6570\u5b57\u603b\u662f\u4e00\u4e2a varint \u952e\uff0c\u8fd9\u91cc\u662f08\uff0c\u6216\u8005\uff08\u5220\u9664msb\uff09\uff1a 000 1000 \u53d6\u6700\u540e\u4e09\u4f4d\u5f97\u5230\u4f20\u8f93\u7c7b\u578b\uff080\uff09\uff0c\u7136\u540e\u53f3\u79fb\u4e09\u6b21\u5f97\u5230\u5b57\u6bb5\u7f16\u53f7\uff081\uff09\u3002\u6240\u4ee5\u73b0\u5728\u77e5\u9053\u5b57\u6bb5\u7f16\u53f7\u662f1\uff0c\u4ee5\u53ca\u4e0b\u4e00\u4e2a\u503c\u662f varint \u3002\u4f7f\u7528\u4e0a\u4e00\u8282\u4e2d\u7684 varint-decoding \u77e5\u8bc6\uff0c\u53ef\u4ee5\u770b\u5230\u63a5\u4e0b\u6765\u7684\u4e24\u4e2a\u5b57\u8282\u5b58\u50a8\u503c150\u3002 96 01 = 1001 0110 0000 0001 \u2192 000 0001 ++ 001 0110 (drop the msb and reverse the groups of 7 bits) \u2192 10010110 \u2192 128 + 16 + 4 + 2 = 150","title":"\u6d88\u606f\u7ed3\u6784"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_4","text":"","title":"\u66f4\u591a\u503c\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_5","text":"\u6b63\u5982\u5728\u4e0a\u4e00\u8282\u4e2d\u770b\u5230\u7684\uff0c\u4e0e\u4f20\u8f93\u7c7b\u578b0\u5173\u8054\u7684\u6240\u6709 protocol buffers \u7c7b\u578b\u90fd\u88ab\u7f16\u7801\u4e3a varints \u3002\u4f46\u662f\uff0c\u5728\u7f16\u7801\u8d1f\u6570\u65f6\uff0c signed int \u7c7b\u578b\uff08 sint32 \u548c sint64 \uff09\u4e0e \u201cstandard\u201dint \u7c7b\u578b\uff08 int32 \u548c int64 \uff09\u4e4b\u95f4\u5b58\u5728\u91cd\u8981\u5dee\u5f02\u3002\u5982\u679c\u4f7f\u7528 int32 \u6216 int64 \u4f5c\u4e3a\u8d1f\u6570\u7684\u7c7b\u578b\uff0c\u5219\u751f\u6210\u7684 varint \u603b\u662f\u5341\u4e2a\u5b57\u8282\u957f\uff0c\u5b9e\u9645\u4e0a\uff0c\u5b83\u88ab\u89c6\u4e3a\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u65e0\u7b26\u53f7\u6574\u6570\u3002\u5982\u679c\u4f7f\u7528\u5176\u4e2d\u4e00\u79cd\u6709\u7b26\u53f7\u7c7b\u578b\uff0c\u5219\u751f\u6210\u7684 varint \u4f7f\u7528 ZigZag \u7f16\u7801\uff0c\u8fd9\u6837\u6548\u7387\u66f4\u9ad8\u3002 ZigZag \u7f16\u7801\u5c06\u6709\u7b26\u53f7\u6574\u6570\u6620\u5c04\u5230\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u56e0\u6b64\u5177\u6709\u8f83\u5c0f\u7edd\u5bf9\u503c\uff08\u4f8b\u5982\uff0c-1\uff09\u7684\u6570\u5b57\u4e5f\u5177\u6709\u8f83\u5c0f\u7684 varint \u7f16\u7801\u503c\u3002\u5b83\u901a\u8fc7\u6b63\u8d1f\u6574\u6570\u6765\u56de \u201czig-zags\u201d \u7684\u65b9\u5f0f\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u56e0\u6b64-1\u88ab\u7f16\u7801\u4e3a1,1\u88ab\u7f16\u7801\u4e3a2\uff0c-2\u88ab\u7f16\u7801\u4e3a3\uff0c\u4f9d\u6b64\u7c7b\u63a8\uff0c\u53ef\u4ee5\u5728\u4e0b\u8868\u4e2d\u770b\u5230\uff1a Signed Original Encoded As 0 0 -1 1 1 2 -2 3 2147483647 4294967294 -2147483648 4294967295 \u6362\u53e5\u8bdd\u8bf4\uff0c\u6bcf\u4e2a\u503c n \u88ab\u7f16\u7801\uff1a (n 1) ^ (n 31) \u6210\u4e3a sint32 s\uff0c\u6216\u8005\uff1a (n 1) ^ (n 63) \u6210\u4e3a64\u4e3a\u7684\u7248\u672c\u3002 \u6ce8\u610f\uff0c\u7b2c\u4e8c\u4e2a\u79fb\u4f4d \uff08n 31\uff09 \u90e8\u5206\u662f\u7b97\u672f\u79fb\u4f4d\u3002\u56e0\u6b64\uff0c\u79fb\u4f4d\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u5168\u4e3a\u96f6\u7684\u6570\u5b57\uff08\u5982\u679c n \u4e3a\u6b63\uff09\u6216\u5168\u90e8\u4e3a\u4e00\u4f4d\uff08\u5982\u679c n \u4e3a\u8d1f\uff09\u3002","title":"\u6709\u7b26\u53f7\u6574\u6570"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#varint","text":"\u975e varint \u6570\u5b57\u7c7b\u578b\u5f88\u7b80\u5355\uff1a double \u548c fixed64 \u6709\u4f20\u8f93\u7c7b\u578b1\uff0c\u5b83\u544a\u8bc9\u89e3\u6790\u5668\u671f\u671b\u4e00\u4e2a\u56fa\u5b9a\u768464\u4f4d\u6570\u636e\u5757; \u7c7b\u4f3c\u5730\uff0c float \u548c fixed32 \u5177\u6709\u4f20\u8f93\u7c7b\u578b5\uff0c\u8fd9\u544a\u8bc9\u5b83\u671f\u671b32\u4f4d\u3002\u5728\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e0b\uff0c\u503c\u90fd\u4ee5 little-endian \u5b57\u8282\u987a\u5e8f\u5b58\u50a8\u3002","title":"\u975evarint\u6570\u5b57"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#strings","text":"\u4f20\u8f93\u7c7b\u578b\u4e3a2\uff08\u957f\u5ea6\u5206\u9694\uff09\u8868\u793a\u8be5\u503c\u662f varint \u7f16\u7801\u957f\u5ea6\uff0c\u540e\u8ddf\u6307\u5b9a\u7684\u6570\u636e\u5b57\u8282\u6570\u3002 message Test2 { optional string b = 2; } \u5c06 b \u7684\u503c\u8bbe\u7f6e\u4e3a \u201ctesting\u201d \u53ef\u4ee5\u5f97\u5230\uff1a 12 07 74 65 73 74 69 6e 67 \u7b2c\u4e09\u4e2a\u5f00\u59cb\u7684\u5b57\u8282\u662f \u201ctesting\u201d \u7684UTF8\u7f16\u7801\u3002\u8fd9\u91cc\u7684\u5173\u952e\u662f 0x12 \u2192\u5b57\u6bb5\u7f16\u53f7=2\uff0c\u7c7b\u578b=2.\u503c\u4e2d\u7684\u957f varint \u662f7\uff0c\u5b83\u540e\u9762\u7684\u4e03\u4e2a\u5b57\u8282\u662f\u6240\u9700\u8981\u7684\u5b57\u7b26\u4e32\u3002","title":"Strings"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_6","text":"\u8fd9\u662f\u4e00\u4e2a\u6d88\u606f\u5b9a\u4e49\uff0c\u5e26\u6709\u793a\u4f8b\u7c7b\u578b Test1 \u7684\u5d4c\u5165\u6d88\u606f\uff1a message Test3 { optional Test1 c = 3; } \u8fd9\u662f\u7f16\u7801\u7248\u672c\uff0c\u518d\u6b21\u5c06 Test1 \u7684 a \u5b57\u6bb5\u8bbe\u7f6e\u4e3a150\uff1a 1a 03 08 96 01 \u5982\u4e0a\u6240\u793a\uff0c\u6700\u540e\u4e09\u4e2a\u5b57\u8282\u4e0e\u7b2c\u4e00\u4e2a\u793a\u4f8b\uff08 08 96 01 \uff09\u5b8c\u5168\u76f8\u540c\uff0c\u5e76\u4e14\u5b83\u4eec\u524d\u9762\u662f\u6570\u5b573\uff0c\u5d4c\u5165\u5f0f\u6d88\u606f\u7684\u5904\u7406\u65b9\u5f0f\u4e0e\u5b57\u7b26\u4e32\u5b8c\u5168\u76f8\u540c\uff08\u4f20\u8f93\u7c7b\u578b= 2\uff09 \u3002","title":"\u5d4c\u5165\u5f0f\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_7","text":"\u5982\u679c proto2 \u6d88\u606f\u5b9a\u4e49\u5177\u6709 repeated \u5143\u7d20\uff08\u6ca1\u6709[ packed = true ]\u9009\u9879\uff09\uff0c\u5219\u7f16\u7801\u6d88\u606f\u5177\u6709\u96f6\u4e2a\u6216\u591a\u4e2a\u5177\u6709\u76f8\u540c\u5b57\u6bb5\u7f16\u53f7\u7684\u952e\u503c\u5bf9\u3002\u8fd9\u4e9b\u91cd\u590d\u503c\u4e0d\u5fc5\u8fde\u7eed\u51fa\u73b0; \u5b83\u4eec\u53ef\u80fd\u4e0e\u5176\u4ed6\u5b57\u6bb5\u4ea4\u9519\u3002\u89e3\u6790\u65f6\u4fdd\u7559\u5143\u7d20\u76f8\u5bf9\u4e8e\u5f7c\u6b64\u7684\u987a\u5e8f\uff0c\u5c3d\u7ba1\u4e22\u5931\u4e86\u5173\u4e8e\u5176\u4ed6\u5b57\u6bb5\u7684\u987a\u5e8f\u3002 \u5728 proto3 \u4e2d\uff0c repeated \u5b57\u6bb5\u4f7f\u7528 \u538b\u7f29\u7f16\u7801 \uff0c\u53ef\u4ee5\u5728\u4e0b\u9762\u9605\u8bfb\u3002 \u5bf9\u4e8e proto3 \u4e2d\u7684\u4efb\u4f55\u975e repeated \u5b57\u6bb5\u6216 proto2 \u4e2d\u7684 optional \u5b57\u6bb5\uff0c\u7f16\u7801\u6d88\u606f\u53ef\u80fd\u5177\u6709\u6216\u4e0d\u5177\u6709\u8be5\u5b57\u6bb5\u7f16\u53f7\u7684\u952e\u503c\u5bf9\u3002 \u901a\u5e38\uff0c\u7f16\u7801\u6d88\u606f\u6c38\u8fdc\u4e0d\u4f1a\u6709\u591a\u4e2a\u975e repeated \u5b57\u6bb5\u7684\u5b9e\u4f8b\u3002\u4f46\u662f\uff0c\u89e3\u6790\u5668\u5e94\u8be5\u5904\u7406\u8fd9\u4e9b\u60c5\u51b5\u3002 \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\u548c\u5b57\u7b26\u4e32\uff0c\u5982\u679c\u591a\u6b21\u51fa\u73b0\u76f8\u540c\u7684\u5b57\u6bb5\uff0c\u5219\u89e3\u6790\u5668\u63a5\u53d7\u5b83\u770b\u5230\u7684\u6700\u540e\u4e00\u4e2a\u503c\u3002 \u5bf9\u4e8e\u5d4c\u5165\u5f0f\u6d88\u606f\u5b57\u6bb5\uff0c\u89e3\u6790\u5668\u5408\u5e76\u540c\u4e00\u5b57\u6bb5\u7684\u591a\u4e2a\u5b9e\u4f8b\uff0c\u5c31\u50cf\u4f7f\u7528 Message::MergeFrom \u65b9\u6cd5\u4e00\u6837\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u540e\u4e00\u4e2a\u5b9e\u4f8b\u4e2d\u7684\u6240\u6709\u5355\u4e2a\u6807\u91cf\u5b57\u6bb5\u90fd\u66ff\u6362\u524d\u8005\uff0c\u5355\u4e2a\u5d4c\u5165\u6d88\u606f\u88ab\u5408\u5e76\uff0c\u5e76\u4e14\u8fde\u63a5\u91cd\u590d\u5b57\u6bb5\u3002\u8fd9\u4e9b\u89c4\u5219\u7684\u4f5c\u7528\u662f\u89e3\u6790\u4e24\u4e2a\u8fde\u63a5\u7684\u7f16\u7801\u6d88\u606f\u4ea7\u751f\u7684\u7ed3\u679c\u4e0e\u5206\u522b\u89e3\u6790\u4e24\u4e2a\u6d88\u606f\u540e\u5e76\u5408\u89e3\u6790\u7ed3\u679c\u6240\u5f97\u5230\u7684\u7ed3\u679c\u5b8c\u5168\u76f8\u540c\u3002\u5c31\u662f\u8fd9\u6837\uff1a MyMessage message; message.ParseFromString(str1 + str2); \u76f8\u5f53\u4e8e\uff1a MyMessage message, message2; message.ParseFromString(str1); message2.ParseFromString(str2); message.MergeFrom(message2); \u6b64\u5c5e\u6027\u5076\u5c14\u4f1a\u6709\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u5408\u5e76\u4e24\u6761\u6d88\u606f\uff0c\u5373\u4f7f\u4e0d\u77e5\u9053\u5b83\u4eec\u7684\u7c7b\u578b\u3002","title":"\u53ef\u9009\u548c\u91cd\u590d\u5143\u7d20"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_8","text":"\u7248\u672c 2.1.0 \u5f15\u5165\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\uff0c\u5728 proto2 \u4e2d\u58f0\u660e\u4e3a\u91cd\u590d\u5b57\u6bb5\uff0c\u4f46\u5177\u6709\u7279\u6b8a\u7684[ packed = true ]\u9009\u9879\u3002\u5728 proto3 \u4e2d\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u538b\u7f29\u6807\u91cf\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\u3002\u8fd9\u4e9b\u529f\u80fd\u7c7b\u4f3c\u4e8e\u91cd\u590d\u7684\u5b57\u6bb5\uff0c\u4f46\u7f16\u7801\u65b9\u5f0f\u4e0d\u540c\u3002\u5305\u542b\u96f6\u5143\u7d20\u7684\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\u4e0d\u4f1a\u51fa\u73b0\u5728\u7f16\u7801\u6d88\u606f\u4e2d\u3002\u5426\u5219\uff0c\u8be5\u5b57\u6bb5\u7684\u6240\u6709\u5143\u7d20\u90fd\u88ab\u538b\u7f29\u5230\u4e00\u4e2a\u952e\u503c\u5bf9\u4e2d\uff0c\u5176\u4e2d\u4f20\u8f93\u7c7b\u578b\u4e3a2\uff08\u957f\u5ea6\u5206\u9694\uff09\u3002\u6bcf\u4e2a\u5143\u7d20\u7684\u7f16\u7801\u65b9\u5f0f\u4e0e\u6b63\u5e38\u60c5\u51b5\u76f8\u540c\uff0c\u53ea\u662f\u524d\u9762\u6ca1\u6709\u952e\u3002 \u4f8b\u5982\uff0c\u5047\u8bbe\u6709\u5982\u4e0b\u6d88\u606f\u7c7b\u578b\uff1a message Test4 { repeated int32 d = 4 [packed=true]; } \u73b0\u5728\u5047\u8bbe\u6784\u9020\u4e00\u4e2a Test4 \uff0c\u4e3a\u91cd\u590d\u5b57\u6bb5 d \u63d0\u4f9b\u503c3,270\u548c86942\u3002\u7136\u540e\uff0c\u7f16\u7801\u7684\u5f62\u5f0f\u5c06\u662f\uff1a 22 // key (\u5b57\u6bb5\u7f16\u53f74, \u4f20\u8f93\u7c7b\u578b2) 06 // payload size (6 bytes) 03 // first element (varint 3) 8E 02 // second element (varint 270) 9E A7 05 // third element (varint 86942) \u53ea\u6709\u539f\u59cb\u6570\u5b57\u7c7b\u578b\u7684\u91cd\u590d\u5b57\u6bb5\uff08\u4f7f\u7528 varint \u3001 32 \u4f4d\u6216 64 \u4f4d\u4f20\u8f93\u7c7b\u578b\u7684\u7c7b\u578b\uff09\u624d\u80fd\u58f0\u660e\u4e3a \u201cpacked\u201d \u3002 \u8bf7\u6ce8\u610f\uff0c\u867d\u7136\u901a\u5e38\u6ca1\u6709\u7406\u7531\u4e3a\u538b\u7f29\u91cd\u590d\u5b57\u6bb5\u7f16\u7801\u591a\u4e2a\u952e\u503c\u5bf9\uff0c\u4f46\u7f16\u7801\u5668\u5fc5\u987b\u51c6\u5907\u597d\u63a5\u53d7\u591a\u4e2a\u952e\u503c\u5bf9\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5e94\u8be5\u8fde\u63a5\u6709\u6548\u8d1f\u8f7d(payloads)\u3002\u6bcf\u4e2a\u952e\u503c\u5bf9\u5fc5\u987b\u5305\u542b\u5927\u91cf\u5143\u7d20\u3002 protocol buffers \u89e3\u6790\u5668\u5fc5\u987b\u80fd\u591f\u89e3\u6790\u538b\u7f29\u7684\u91cd\u590d\u5b57\u6bb5\uff0c\u5c31\u597d\u50cf\u5b83\u4eec\u6ca1\u6709\u538b\u7f29\u4e00\u6837\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u8fd9\u5141\u8bb8\u4ee5\u5411\u524d\u548c\u540e\u5411\u517c\u5bb9\u7684\u65b9\u5f0f\u5c06[ packed = true ]\u6dfb\u52a0\u5230\u73b0\u6709\u5b57\u6bb5\u3002","title":"\u538b\u7f29\u91cd\u590d\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_9","text":"\u5b57\u6bb5\u7f16\u53f7\u53ef\u4ee5\u5728 .proto \u6587\u4ef6\u4e2d\u4ee5\u4efb\u4f55\u987a\u5e8f\u4f7f\u7528\u3002\u9009\u62e9\u7684\u987a\u5e8f\u5bf9\u6d88\u606f\u7684\u5e8f\u5217\u5316\u65b9\u5f0f\u6ca1\u6709\u5f71\u54cd\u3002 \u5f53\u5e8f\u5217\u5316\u6d88\u606f\u65f6\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u5176\u5df2\u77e5\u6216 \u672a\u77e5\u5b57\u6bb5 \u7684\u5199\u5165\u987a\u5e8f\u3002\u5e8f\u5217\u5316\u987a\u5e8f\u662f\u4e00\u4e2a\u5b9e\u73b0\u7ec6\u8282\uff0c\u4efb\u4f55\u7279\u5b9a\u5b9e\u73b0\u7684\u7ec6\u8282\u53ef\u80fd\u5728\u5c06\u6765\u53d1\u751f\u53d8\u5316\u3002\u56e0\u6b64\uff0c protocol buffers \u89e3\u6790\u5668\u5fc5\u987b\u80fd\u591f\u4ee5\u4efb\u4f55\u987a\u5e8f\u89e3\u6790\u5b57\u6bb5\u3002","title":"\u5b57\u6bb5\u987a\u5e8f"},{"location":"Frameworks/Protocol-Buffers/04-\u7f16\u7801/#_10","text":"\u4e0d\u8981\u5047\u8bbe\u5e8f\u5217\u5316\u6d88\u606f\u7684\u5b57\u8282\u8f93\u51fa\u662f\u7a33\u5b9a\u7684\u3002\u5bf9\u4e8e\u5177\u6709\u8868\u793a\u5176\u4ed6\u5e8f\u5217\u5316 protocol buffers \u6d88\u606f\u7684\u4f20\u9012\u5b57\u8282\u5b57\u6bb5\u7684\u6d88\u606f\u5c24\u5176\u5982\u6b64\u3002 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5728\u540c\u4e00 protocol buffers \u6d88\u606f\u5b9e\u4f8b\u4e0a\u91cd\u590d\u8c03\u7528\u5e8f\u5217\u5316\u65b9\u6cd5\u53ef\u80fd\u4e0d\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u5b57\u8282\u8f93\u51fa;\u5373\u9ed8\u8ba4\u5e8f\u5217\u5316\u4e0d\u662f\u786e\u5b9a\u6027\u7684\u3002 \u786e\u5b9a\u6027\u5e8f\u5217\u5316\u4ec5\u4fdd\u8bc1\u7279\u5b9a\u5bf9\u4e8e\u7279\u5b9a\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u8f93\u51fa\u76f8\u540c\u7684\u5b57\u8282\u3002\u5b57\u8282\u8f93\u51fa\u53ef\u80fd\u4f1a\u5728\u4e0d\u540c\u7248\u672c\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4e2d\u53d1\u751f\u53d8\u5316\u3002 \u5bf9\u4e8e protocol buffers \u6d88\u606f\u5b9e\u4f8b foo \uff0c\u4ee5\u4e0b\u68c0\u67e5\u53ef\u80fd\u4f1a\u5931\u8d25\u3002 foo.SerializeAsString() == foo.SerializeAsString() Hash(foo.SerializeAsString()) == Hash(foo.SerializeAsString()) CRC(foo.SerializeAsString()) == CRC(foo.SerializeAsString()) FingerPrint(foo.SerializeAsString()) == FingerPrint(foo.SerializeAsString()) \u4ee5\u4e0b\u662f\u4e00\u4e9b\u793a\u4f8b\u573a\u666f\uff0c\u5176\u4e2d\u903b\u8f91\u4e0a\u7b49\u6548\u7684 protocol buffers \u6d88\u606f foo \u548c bar \u53ef\u4ee5\u5e8f\u5217\u5316\u4e3a\u4e0d\u540c\u7684\u5b57\u8282\u8f93\u51fa\u3002 bar \u7531\u65e7\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u5c06\u67d0\u4e9b\u5b57\u6bb5\u89c6\u4e3a\u672a\u77e5\u3002 bar \u7531\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u8be5\u670d\u52a1\u5668\u4ee5\u4e0d\u540c\u7684\u7f16\u7a0b\u8bed\u8a00\u5b9e\u73b0\uff0c\u5e76\u6309\u4e0d\u540c\u987a\u5e8f\u5e8f\u5217\u5316\u5b57\u6bb5\u3002 bar \u6709\u4e00\u4e2a\u4ee5\u975e\u786e\u5b9a\u6027\u65b9\u5f0f\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\u3002 bar \u6709\u4e00\u4e2a\u5b57\u6bb5\uff0c\u7528\u4e8e\u5b58\u50a8 protocol buffers \u6d88\u606f\u7684\u5e8f\u5217\u5316\u5b57\u8282\u8f93\u51fa\uff0c\u8be5\u6d88\u606f\u4ee5\u4e0d\u540c\u65b9\u5f0f\u5e8f\u5217\u5316\u3002 bar \u7531\u65b0\u670d\u52a1\u5668\u5e8f\u5217\u5316\uff0c\u8be5\u670d\u52a1\u5668\u7531\u4e8e\u5b9e\u73b0\u66f4\u6539\u56e0\u6b64\u4ee5\u4e0d\u540c\u987a\u5e8f\u5e8f\u5217\u5316\u5b57\u6bb5\u3002 foo \u548c bar \u90fd\u662f\u5355\u4e2a\u6d88\u606f\u7684\u4e32\u8054\uff0c\u4f46\u987a\u5e8f\u4e0d\u540c\u3002","title":"\u542f\u793a"},{"location":"Frameworks/Protocol-Buffers/05-\u6280\u672f/","text":"\u6280\u672f \u672c\u9875\u63cf\u8ff0\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5904\u7406 protocol buffers \u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002\u8fd8\u53ef\u4ee5\u5c06\u8bbe\u8ba1\u548c\u4f7f\u7528\u95ee\u9898\u53d1\u9001\u5230 protocol buffers \u8ba8\u8bba\u7ec4 \u3002 \u6d41\u5f0f\u4f20\u8f93\u591a\u6761\u6d88\u606f \u5982\u679c\u8981\u5c06\u591a\u6761\u6d88\u606f\u5199\u5165\u5355\u4e2a\u6587\u4ef6\u6216\u6d41\uff0c\u5219\u9700\u8981\u8ddf\u8e2a\u4e00\u6761\u6d88\u606f\u7684\u7ed3\u675f\u4f4d\u7f6e\u548c\u4e0b\u4e00\u6761\u6d88\u606f\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002 protocol buffers \u4f20\u8f93\u683c\u5f0f\u4e0d\u662f\u81ea\u5b9a\u754c\u9650\u7684\uff0c\u56e0\u6b64 protocol buffers \u89e3\u6790\u5668\u65e0\u6cd5\u786e\u5b9a\u6d88\u606f\u81ea\u8eab\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002 \u89e3\u51b3\u6b64\u95ee\u9898\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\uff1a\u5728\u5199\u5165\u6d88\u606f\u4e4b\u524d\u5199\u5165\u6bcf\u6761\u6d88\u606f\u7684\u5927\u5c0f\u3002\u5f53\u91cd\u65b0\u8bfb\u53d6\u6d88\u606f\u65f6\uff0c\u8bfb\u53d6\u5927\u5c0f\uff0c\u7136\u540e\u5c06\u5b57\u8282\u8bfb\u5165\u5355\u72ec\u7684\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4ece\u8be5\u7f13\u51b2\u533a\u89e3\u6790\u3002 \u5982\u679c\u60f3\u907f\u514d\u5c06\u5b57\u8282\u590d\u5236\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u7f13\u51b2\u533a\uff0c\u8bf7\u67e5\u770b CodedInputStream \u7c7b\uff08\u5728 C++ \u548c Java \u4e2d\uff09\uff0c\u8be5\u7c7b\u53ef\u4ee5\u5c06\u8bfb\u53d6\u9650\u5236\u4e3a\u4e00\u5b9a\u7684\u5b57\u8282\u6570\u3002 \u5927\u6570\u636e\u96c6 protocol buffers \u4e0d\u662f\u4e3a\u5904\u7406\u5927\u578b\u6d88\u606f\u800c\u8bbe\u8ba1\u7684\u3002\u4f5c\u4e3a\u4e00\u822c\u7ecf\u9a8c\u6cd5\u5219\uff0c\u5982\u679c\u6b63\u5728\u5904\u7406\u5927\u4e8e \u6bcf\u5146\u5b57\u8282 \u7684\u6d88\u606f\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8003\u8651\u66ff\u4ee3\u7b56\u7565\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c protocol buffers \u975e\u5e38\u9002\u5408\u5904\u7406\u5927\u578b\u6570\u636e\u96c6\u4e2d\u7684\u5355\u4e2a\u6d88\u606f\u3002\u901a\u5e38\uff0c\u5927\u578b\u6570\u636e\u96c6\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e9b\u5c0f\u90e8\u5206\u7684\u96c6\u5408\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5c0f\u90e8\u5206\u53ef\u80fd\u662f\u7ed3\u6784\u5316\u7684\u6570\u636e\u3002\u5c3d\u7ba1 protocol buffers \u65e0\u6cd5\u540c\u65f6\u5904\u7406\u6574\u4e2a\u96c6\u5408\uff0c\u4f46\u4f7f\u7528 protocol buffers \u5bf9\u6bcf\u4e2a\u90e8\u5206\u8fdb\u884c\u7f16\u7801\u53ef\u4ee5\u6781\u5927\u5730\u7b80\u5316\u95ee\u9898\uff1a\u73b0\u5728\u53ea\u9700\u8981\u5904\u7406\u4e00\u7ec4\u5b57\u8282\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u800c\u4e0d\u662f\u4e00\u6574\u4e2a\u7ed3\u6784\u3002 protocol buffers \u4e0d\u5305\u62ec\u5bf9\u5927\u578b\u6570\u636e\u96c6\u7684\u4efb\u4f55\u5185\u7f6e\u652f\u6301\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u60c5\u51b5\u9700\u8981\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6848\u3002\u6709\u65f6\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8bb0\u5f55\u5217\u8868\uff0c\u800c\u6709\u65f6\u53ef\u80fd\u60f3\u8981\u66f4\u50cf\u6570\u636e\u5e93\u7684\u4e1c\u897f\u3002\u6bcf\u4e2a\u89e3\u51b3\u65b9\u6848\u90fd\u5e94\u8be5\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u5e93\u5f00\u53d1\uff0c\u4ee5\u4fbf\u53ea\u6709\u9700\u8981\u5b83\u7684\u4eba\u624d\u9700\u8981\u652f\u4ed8\u6210\u672c\u3002 \u81ea\u63cf\u8ff0\u6d88\u606f protocol buffers \u4e0d\u5305\u542b\u5176\u81ea\u8eab\u7c7b\u578b\u7684\u63cf\u8ff0\u3002\u56e0\u6b64\uff0c\u53ea\u7ed9\u51fa\u6ca1\u6709\u5b9a\u4e49\u5176\u7c7b\u578b\u7684\u539f\u59cb\u6d88\u606f\u800c\u6ca1\u6709\u76f8\u5e94\u7684\u5b9a\u4e49\u5b83\u7c7b\u578b\u7684 .proto \u6587\u4ef6\uff0c\u5f88\u96be\u63d0\u53d6\u4efb\u4f55\u6709\u7528\u7684\u6570\u636e\u3002 \u4f46\u662f\uff0c\u8bf7\u6ce8\u610f .proto \u6587\u4ef6\u7684\u5185\u5bb9\u672c\u8eab\u53ef\u4ee5\u4f7f\u7528 protocol buffers \u8868\u793a\u3002\u6e90\u4ee3\u7801\u5305\u4e2d\u7684\u6587\u4ef6 src/google/protobuf/descriptor.proto \u5b9a\u4e49\u4e86\u6240\u6d89\u53ca\u7684\u6d88\u606f\u7c7b\u578b\u3002 protoc \u53ef\u4ee5\u4f7f\u7528 --descriptor_set_out \u9009\u9879\u8f93\u51fa FileDescriptorSet \uff08\u8868\u793a\u4e00\u7ec4 .proto \u6587\u4ef6\uff09\u3002\u6709\u4e86\u8fd9\u4e2a\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u81ea\u63cf\u8ff0\u534f\u8bae\u6d88\u606f\uff0c\u5982\u4e0b\u6240\u793a\uff1a syntax = proto3 ; import google/protobuf/any.proto ; import google/protobuf/descriptor.proto ; message SelfDescribingMessage { // Set of FileDescriptorProtos which describe the type and its dependencies. google.protobuf.FileDescriptorSet descriptor_set = 1; // The message and its type, encoded as an Any message. google.protobuf.Any message = 2; } \u901a\u8fc7\u4f7f\u7528 DynamicMessage \uff08\u53ef\u5728 C++ \u548c Java \u4e2d\u4f7f\u7528\uff09\u8fd9\u6837\u7684\u7c7b\uff0c\u53ef\u4ee5\u7f16\u5199\u53ef\u4ee5\u64cd\u4f5c SelfDescribingMessages \u7684\u5de5\u5177\u3002 \u603b\u800c\u8a00\u4e4b\uff0c\u8fd9\u4e2a\u529f\u80fd\u672a\u5305\u542b\u5728 protocol buffers \u5e93\u4e2d\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u4ece\u672a\u5728Google\u5185\u90e8\u4f7f\u7528\u5b83\u3002 \u6b64\u6280\u672f\u9700\u8981\u4f7f\u7528\u63cf\u8ff0\u7b26\u652f\u6301\u52a8\u6001\u6d88\u606f\u3002\u5728\u4f7f\u7528\u81ea\u63cf\u8ff0\u6d88\u606f\u4e4b\u524d\uff0c\u8bf7\u68c0\u67e5\u5e73\u53f0\u662f\u5426\u652f\u6301\u6b64\u529f\u80fd\u3002","title":"\u6280\u672f"},{"location":"Frameworks/Protocol-Buffers/05-\u6280\u672f/#_1","text":"\u672c\u9875\u63cf\u8ff0\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5904\u7406 protocol buffers \u7684\u8bbe\u8ba1\u6a21\u5f0f\u3002\u8fd8\u53ef\u4ee5\u5c06\u8bbe\u8ba1\u548c\u4f7f\u7528\u95ee\u9898\u53d1\u9001\u5230 protocol buffers \u8ba8\u8bba\u7ec4 \u3002","title":"\u6280\u672f"},{"location":"Frameworks/Protocol-Buffers/05-\u6280\u672f/#_2","text":"\u5982\u679c\u8981\u5c06\u591a\u6761\u6d88\u606f\u5199\u5165\u5355\u4e2a\u6587\u4ef6\u6216\u6d41\uff0c\u5219\u9700\u8981\u8ddf\u8e2a\u4e00\u6761\u6d88\u606f\u7684\u7ed3\u675f\u4f4d\u7f6e\u548c\u4e0b\u4e00\u6761\u6d88\u606f\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002 protocol buffers \u4f20\u8f93\u683c\u5f0f\u4e0d\u662f\u81ea\u5b9a\u754c\u9650\u7684\uff0c\u56e0\u6b64 protocol buffers \u89e3\u6790\u5668\u65e0\u6cd5\u786e\u5b9a\u6d88\u606f\u81ea\u8eab\u7684\u7ed3\u675f\u4f4d\u7f6e\u3002 \u89e3\u51b3\u6b64\u95ee\u9898\u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\uff1a\u5728\u5199\u5165\u6d88\u606f\u4e4b\u524d\u5199\u5165\u6bcf\u6761\u6d88\u606f\u7684\u5927\u5c0f\u3002\u5f53\u91cd\u65b0\u8bfb\u53d6\u6d88\u606f\u65f6\uff0c\u8bfb\u53d6\u5927\u5c0f\uff0c\u7136\u540e\u5c06\u5b57\u8282\u8bfb\u5165\u5355\u72ec\u7684\u7f13\u51b2\u533a\uff0c\u7136\u540e\u4ece\u8be5\u7f13\u51b2\u533a\u89e3\u6790\u3002 \u5982\u679c\u60f3\u907f\u514d\u5c06\u5b57\u8282\u590d\u5236\u5230\u4e00\u4e2a\u5355\u72ec\u7684\u7f13\u51b2\u533a\uff0c\u8bf7\u67e5\u770b CodedInputStream \u7c7b\uff08\u5728 C++ \u548c Java \u4e2d\uff09\uff0c\u8be5\u7c7b\u53ef\u4ee5\u5c06\u8bfb\u53d6\u9650\u5236\u4e3a\u4e00\u5b9a\u7684\u5b57\u8282\u6570\u3002","title":"\u6d41\u5f0f\u4f20\u8f93\u591a\u6761\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/05-\u6280\u672f/#_3","text":"protocol buffers \u4e0d\u662f\u4e3a\u5904\u7406\u5927\u578b\u6d88\u606f\u800c\u8bbe\u8ba1\u7684\u3002\u4f5c\u4e3a\u4e00\u822c\u7ecf\u9a8c\u6cd5\u5219\uff0c\u5982\u679c\u6b63\u5728\u5904\u7406\u5927\u4e8e \u6bcf\u5146\u5b57\u8282 \u7684\u6d88\u606f\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8003\u8651\u66ff\u4ee3\u7b56\u7565\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c protocol buffers \u975e\u5e38\u9002\u5408\u5904\u7406\u5927\u578b\u6570\u636e\u96c6\u4e2d\u7684\u5355\u4e2a\u6d88\u606f\u3002\u901a\u5e38\uff0c\u5927\u578b\u6570\u636e\u96c6\u5b9e\u9645\u4e0a\u53ea\u662f\u4e00\u4e9b\u5c0f\u90e8\u5206\u7684\u96c6\u5408\uff0c\u5176\u4e2d\u6bcf\u4e2a\u5c0f\u90e8\u5206\u53ef\u80fd\u662f\u7ed3\u6784\u5316\u7684\u6570\u636e\u3002\u5c3d\u7ba1 protocol buffers \u65e0\u6cd5\u540c\u65f6\u5904\u7406\u6574\u4e2a\u96c6\u5408\uff0c\u4f46\u4f7f\u7528 protocol buffers \u5bf9\u6bcf\u4e2a\u90e8\u5206\u8fdb\u884c\u7f16\u7801\u53ef\u4ee5\u6781\u5927\u5730\u7b80\u5316\u95ee\u9898\uff1a\u73b0\u5728\u53ea\u9700\u8981\u5904\u7406\u4e00\u7ec4\u5b57\u8282\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u800c\u4e0d\u662f\u4e00\u6574\u4e2a\u7ed3\u6784\u3002 protocol buffers \u4e0d\u5305\u62ec\u5bf9\u5927\u578b\u6570\u636e\u96c6\u7684\u4efb\u4f55\u5185\u7f6e\u652f\u6301\uff0c\u56e0\u4e3a\u4e0d\u540c\u7684\u60c5\u51b5\u9700\u8981\u4e0d\u540c\u7684\u89e3\u51b3\u65b9\u6848\u3002\u6709\u65f6\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8bb0\u5f55\u5217\u8868\uff0c\u800c\u6709\u65f6\u53ef\u80fd\u60f3\u8981\u66f4\u50cf\u6570\u636e\u5e93\u7684\u4e1c\u897f\u3002\u6bcf\u4e2a\u89e3\u51b3\u65b9\u6848\u90fd\u5e94\u8be5\u4f5c\u4e3a\u4e00\u4e2a\u5355\u72ec\u7684\u5e93\u5f00\u53d1\uff0c\u4ee5\u4fbf\u53ea\u6709\u9700\u8981\u5b83\u7684\u4eba\u624d\u9700\u8981\u652f\u4ed8\u6210\u672c\u3002","title":"\u5927\u6570\u636e\u96c6"},{"location":"Frameworks/Protocol-Buffers/05-\u6280\u672f/#_4","text":"protocol buffers \u4e0d\u5305\u542b\u5176\u81ea\u8eab\u7c7b\u578b\u7684\u63cf\u8ff0\u3002\u56e0\u6b64\uff0c\u53ea\u7ed9\u51fa\u6ca1\u6709\u5b9a\u4e49\u5176\u7c7b\u578b\u7684\u539f\u59cb\u6d88\u606f\u800c\u6ca1\u6709\u76f8\u5e94\u7684\u5b9a\u4e49\u5b83\u7c7b\u578b\u7684 .proto \u6587\u4ef6\uff0c\u5f88\u96be\u63d0\u53d6\u4efb\u4f55\u6709\u7528\u7684\u6570\u636e\u3002 \u4f46\u662f\uff0c\u8bf7\u6ce8\u610f .proto \u6587\u4ef6\u7684\u5185\u5bb9\u672c\u8eab\u53ef\u4ee5\u4f7f\u7528 protocol buffers \u8868\u793a\u3002\u6e90\u4ee3\u7801\u5305\u4e2d\u7684\u6587\u4ef6 src/google/protobuf/descriptor.proto \u5b9a\u4e49\u4e86\u6240\u6d89\u53ca\u7684\u6d88\u606f\u7c7b\u578b\u3002 protoc \u53ef\u4ee5\u4f7f\u7528 --descriptor_set_out \u9009\u9879\u8f93\u51fa FileDescriptorSet \uff08\u8868\u793a\u4e00\u7ec4 .proto \u6587\u4ef6\uff09\u3002\u6709\u4e86\u8fd9\u4e2a\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u81ea\u63cf\u8ff0\u534f\u8bae\u6d88\u606f\uff0c\u5982\u4e0b\u6240\u793a\uff1a syntax = proto3 ; import google/protobuf/any.proto ; import google/protobuf/descriptor.proto ; message SelfDescribingMessage { // Set of FileDescriptorProtos which describe the type and its dependencies. google.protobuf.FileDescriptorSet descriptor_set = 1; // The message and its type, encoded as an Any message. google.protobuf.Any message = 2; } \u901a\u8fc7\u4f7f\u7528 DynamicMessage \uff08\u53ef\u5728 C++ \u548c Java \u4e2d\u4f7f\u7528\uff09\u8fd9\u6837\u7684\u7c7b\uff0c\u53ef\u4ee5\u7f16\u5199\u53ef\u4ee5\u64cd\u4f5c SelfDescribingMessages \u7684\u5de5\u5177\u3002 \u603b\u800c\u8a00\u4e4b\uff0c\u8fd9\u4e2a\u529f\u80fd\u672a\u5305\u542b\u5728 protocol buffers \u5e93\u4e2d\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u4ece\u672a\u5728Google\u5185\u90e8\u4f7f\u7528\u5b83\u3002 \u6b64\u6280\u672f\u9700\u8981\u4f7f\u7528\u63cf\u8ff0\u7b26\u652f\u6301\u52a8\u6001\u6d88\u606f\u3002\u5728\u4f7f\u7528\u81ea\u63cf\u8ff0\u6d88\u606f\u4e4b\u524d\uff0c\u8bf7\u68c0\u67e5\u5e73\u53f0\u662f\u5426\u652f\u6301\u6b64\u529f\u80fd\u3002","title":"\u81ea\u63cf\u8ff0\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/06-\u7b2c\u4e09\u65b9\u63d2\u4ef6/","text":"\u7b2c\u4e09\u65b9\u63d2\u4ef6 \u8bb8\u591a\u5f00\u6e90\u9879\u76ee\u90fd\u8bd5\u56fe\u5728 Protocol Buffers \u4e4b\u4e0a\u6dfb\u52a0\u6709\u7528\u7684\u529f\u80fd\u3002 \u6709\u5173\u7684\u9879\u76ee\u7684\u94fe\u63a5\u5217\u8868\uff0c\u67e5\u770b \u8fd9\u91cc \u3002","title":"\u7b2c\u4e09\u65b9\u63d2\u4ef6"},{"location":"Frameworks/Protocol-Buffers/06-\u7b2c\u4e09\u65b9\u63d2\u4ef6/#_1","text":"\u8bb8\u591a\u5f00\u6e90\u9879\u76ee\u90fd\u8bd5\u56fe\u5728 Protocol Buffers \u4e4b\u4e0a\u6dfb\u52a0\u6709\u7528\u7684\u529f\u80fd\u3002 \u6709\u5173\u7684\u9879\u76ee\u7684\u94fe\u63a5\u5217\u8868\uff0c\u67e5\u770b \u8fd9\u91cc \u3002","title":"\u7b2c\u4e09\u65b9\u63d2\u4ef6"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/","text":"Protocol Buffers \uff1aGo\u8bed\u8a00\u6307\u5357 \u672c\u6559\u7a0b\u4f7f\u7528 proto3 \u7248\u672c\u7684 protocol buffers \u8bed\u8a00\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u672c\u7684Go\u7a0b\u5e8f\u5458\u4f7f\u7528 protocol buffers \u7684\u4ecb\u7ecd\u3002\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\uff0c\u5c55\u793a\u5982\u4f55\uff1a \u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u6d88\u606f\u683c\u5f0f \u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668 \u4f7f\u7528 Go protocol buffers API\u6765\u7f16\u5199\u548c\u8bfb\u53d6\u6d88\u606f \u8fd9\u4e0d\u662f\u5728Go\u4e2d\u4f7f\u7528 protocol buffers \u7684\u7efc\u5408\u6307\u5357\u3002\u6709\u5173\u66f4\u8be6\u7ec6\u7684\u53c2\u8003\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c protocol buffers \u8bed\u8a00\u6307\u5357 \u201d\uff0c\u201c Go API\u53c2\u8003 \u201d\uff0c\u201c \u751f\u6210\u4ee3\u7801\u6307\u5357 \u201d\u548c\u201c \u7f16\u7801\u53c2\u8003 \u201d\u3002 \u4e3a\u4f55\u4f7f\u7528 Protocol Buffers \u5c06\u8981\u4f7f\u7528\u7684\u793a\u4f8b\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u201c\u5730\u5740\u7c3f\u201d\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5728\u6587\u4ef6\u4e2d\u8bfb\u53d6\u548c\u5199\u5165\u4eba\u5458\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u5730\u5740\u7c3f\u4e2d\u7684\u6bcf\u4e2a\u4eba\u90fd\u6709 \u59d3\u540d \uff0c ID \uff0c \u7535\u5b50\u90ae\u4ef6\u5730\u5740 \u548c \u8054\u7cfb\u7535\u8bdd\u53f7\u7801 \u3002 \u5982\u4f55\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u8fd9\u6837\u7684\u7ed3\u6784\u5316\u6570\u636e \uff1f\u6709\u51e0\u79cd\u65b9\u6cd5\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a \u4f7f\u7528 gobs \u5e8f\u5217\u5316Go\u6570\u636e\u7ed3\u6784\u3002\u8fd9\u662fGo\u7279\u5b9a\u73af\u5883\u4e2d\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u5982\u679c\u9700\u8981\u4e0e\u4e3a\u5176\u4ed6\u5e73\u53f0\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u5171\u4eab\u6570\u636e\uff0c\u5b83\u5c06\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002 \u53ef\u4ee5\u53d1\u660e\u4e00\u79cd\u7279\u6b8a\u7684\u65b9\u6cd5\u5c06\u6570\u636e\u9879\u7f16\u7801\u4e3a\u5355\u4e2a\u5b57\u7b26\u4e32,\u4f8b\u5982\u5c064\u4e2a\u6574\u6570\u7f16\u7801\u4e3a \u201c12:3:-23:67\u201d \u3002\u8fd9\u662f\u4e00\u79cd\u7b80\u5355\u800c\u7075\u6d3b\u7684\u65b9\u6cd5\uff0c\u867d\u7136\u5b83\u786e\u5b9e\u9700\u8981\u7f16\u5199\u4e00\u6b21\u6027\u7f16\u7801\u548c\u89e3\u6790\u4ee3\u7801\uff0c\u5e76\u4e14\u89e3\u6790\u4f1a\u4ea7\u751f\u8f83\u5c0f\u7684\u8fd0\u884c\u65f6\u6210\u672c\u3002\u8fd9\u6700\u9002\u5408\u7f16\u7801\u975e\u5e38\u7b80\u5355\u7684\u6570\u636e\u3002 \u5c06\u6570\u636e\u5e8f\u5217\u5316\u4e3a XML \u3002\u8fd9\u79cd\u65b9\u6cd5\u975e\u5e38\u6709\u5438\u5f15\u529b\uff0c\u56e0\u4e3a XML \u662f\u4eba\u7c7b\u53ef\u8bfb\u7684\uff0c\u5e76\u4e14\u5bf9\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u90fd\u6709\u7ed1\u5b9a\u5e93\u3002\u5982\u679c\u60f3\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f/\u9879\u76ee\u5171\u4eab\u6570\u636e\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\u7136\u800c\uff0c XML \u662f\u7a7a\u95f4\u5bc6\u96c6\u578b\uff0c\u5e76\u4e14\u7f16\u7801/\u89e3\u7801\u5b83\u4f1a\u5bf9\u5e94\u7528\u7a0b\u5e8f\u9020\u6210\u5de8\u5927\u7684\u6027\u80fd\u635f\u5931\u3002\u6b64\u5916\uff0c\u904d\u5386\u4e00\u9897 XML \u7684 DOM \u6811\u6bd4\u50cf\u901a\u5e38\u90a3\u6837\u5728\u7c7b\u4e2d\u904d\u5386\u7b80\u5355\u5b57\u6bb5\u8981\u590d\u6742\u5f97\u591a\u3002 protocol buffers \u662f\u7075\u6d3b\uff0c\u9ad8\u6548\uff0c\u81ea\u52a8\u5316\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u4f7f\u7528 protocol buffers \u7f16\u5199\u8981\u5b58\u50a8\u7684\u6570\u636e\u7ed3\u6784\u7684 .proto \u63cf\u8ff0\u6587\u4ef6\u3002\u7136\u540e protocol buffers \u7f16\u8bd1\u5668\u521b\u5efa\u4e00\u4e2a\u7c7b\uff0c\u8be5\u7c7b\u4f7f\u7528\u6709\u6548\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b9e\u73b0 protocol buffers \u6570\u636e\u7684\u81ea\u52a8\u7f16\u7801\u548c\u89e3\u6790\u3002\u751f\u6210\u7684\u7c7b\u4e3a\u6784\u6210 protocol buffers \u7684\u5b57\u6bb5\u63d0\u4f9b getter \u548c setter \uff0c\u5e76\u751f\u6210\u4e00\u4e2a protocol buffers \uff0c\u5e76\u5c06 protocol buffers \u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u8bfb\u53d6\u548c\u5199\u5165\u8be6\u7ec6\u4fe1\u606f\u3002\u91cd\u8981\u7684\u662f\uff0c protocol buffers \u683c\u5f0f\u652f\u6301\u6269\u5c55\u683c\u5f0f\uff0c\u4f7f\u5f97\u4ee3\u7801\u4ecd\u7136\u53ef\u4ee5\u8bfb\u53d6\u7528\u65e7\u683c\u5f0f\u7f16\u7801\u7684\u6570\u636e\u3002 \u5728\u54ea\u91cc\u67e5\u770b\u6837\u4f8b\u4ee3\u7801 \u6211\u4eec\u7684\u793a\u4f8b\u662f\u4e00\u7ec4\u7528\u4e8e\u7ba1\u7406\u5730\u5740\u7c3f\u6570\u636e\u6587\u4ef6\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f7f\u7528 protocol buffers \u8fdb\u884c\u7f16\u7801\u3002\u547d\u4ee4add_person_go\u5411\u6570\u636e\u6587\u4ef6\u6dfb\u52a0\u65b0\u6761\u76ee\u3002\u547d\u4ee4list_people_go\u89e3\u6790\u6570\u636e\u6587\u4ef6\u5e76\u5c06\u6570\u636e\u6253\u5370\u5230\u63a7\u5236\u53f0\u3002 \u53ef\u4ee5\u5728GitHub\u5b58\u50a8\u5e93\u7684 examples \u76ee\u5f55\u4e2d\u627e\u5230\u5b8c\u6574\u7684\u793a\u4f8b\u3002 \u81ea\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f \u8981\u521b\u5efa\u5730\u5740\u7c3f\u5e94\u7528\u7a0b\u5e8f\uff0c\u9700\u8981\u4ece .proto \u6587\u4ef6\u5f00\u59cb\u3002 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u5f88\u7b80\u5355\uff1a\u4e3a\u8981\u5e8f\u5217\u5316\u7684\u6bcf\u4e2a\u6570\u636e\u7ed3\u6784\u6dfb\u52a0\u6d88\u606f\uff0c\u7136\u540e\u4e3a\u6d88\u606f\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u6307\u5b9a\u540d\u79f0\u548c\u7c7b\u578b\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u5b9a\u4e49\u6d88\u606f\u7684 .proto \u6587\u4ef6\u662f addressbook.proto \u3002 .proto \u6587\u4ef6\u4ee5\u5305\u58f0\u660e\u5f00\u5934\uff0c\u8fd9\u6709\u52a9\u4e8e\u9632\u6b62\u4e0d\u540c\u9879\u76ee\u4e4b\u95f4\u7684\u547d\u540d\u51b2\u7a81\u3002 syntax = proto3 ; package tutorial; import google/protobuf/timestamp.proto ; \u5728Go\u4e2d\uff0c\u5305\u540d\u79f0\u7528\u4f5cGo\u5305\uff0c\u9664\u975e\u6307\u5b9a\u4e86 go_package \u3002\u5373\u4f7f\u786e\u5b9e\u63d0\u4f9b\u4e86 go_package \uff0c\u4ecd\u7136\u5e94\u8be5\u5b9a\u4e49\u4e00\u4e2a\u666e\u901a\u7684\u5305\uff0c\u4ee5\u907f\u514d\u5728 Protocol Buffers \u540d\u79f0\u7a7a\u95f4\u548c\u975eGo\u8bed\u8a00\u4e2d\u53d1\u751f\u540d\u79f0\u51b2\u7a81\u3002 \u63a5\u4e0b\u6765\u662f\u6d88\u606f\u5b9a\u4e49\u3002\u6d88\u606f\u53ea\u662f\u5305\u542b\u4e00\u7ec4\u7c7b\u578b\u5b57\u6bb5\u7684\u805a\u5408\u3002\u8bb8\u591a\u6807\u51c6\u7684\u7b80\u5355\u6570\u636e\u7c7b\u578b\u90fd\u53ef\u7528\u4f5c\u5b57\u6bb5\u7c7b\u578b\uff0c\u5305\u62ec bool \uff0c int32 \uff0c float \uff0c double \u548c string \u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\uff0c\u4e3a\u6d88\u606f\u6dfb\u52a0\u66f4\u591a\u7ed3\u6784\u3002 message Person { string name = 1; int32 id = 2; // Unique ID number for this person. string email = 3; enum PhoneType { MOBILE = 0; HOME = 1; WORK = 2; } message PhoneNumber { string number = 1; PhoneType type = 2; } repeated PhoneNumber phones = 4; google.protobuf.Timestamp last_updated = 5; } // Our address book file is just one of these. message AddressBook { repeated Person people = 1; } \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c Person \u6d88\u606f\u5305\u542b PhoneNumber \u6d88\u606f\uff0c\u800c AddressBook \u6d88\u606f\u5305\u542b Person \u6d88\u606f\u3002 \u751a\u81f3\u53ef\u4ee5\u5b9a\u4e49\u5d4c\u5957\u5728\u5176\u4ed6\u6d88\u606f\u4e2d\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u5982\u4e0a\u6240\u793a\uff0c PhoneNumber \u7c7b\u578b\u5728 Person \u4e2d\u5b9a\u4e49\u3002 \u5982\u679c\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u5177\u6709\u9884\u5b9a\u4e49\u7684\u503c\u5217\u8868\u4e4b\u4e00\uff0c\u8fd8\u53ef\u4ee5\u5b9a\u4e49\u679a\u4e3e\u7c7b\u578b\uff0c\u6b64\u5904\u8981\u6307\u5b9a\u7535\u8bdd\u53f7\u7801\u53ef\u4ee5\u662f MOBILE \uff0c HOME \u6216 WORK \u4e4b\u4e00\u3002 \u6bcf\u4e2a\u5143\u7d20\u4e0a\u7684 \u201c=1\u201d \uff0c \u201c=2\u201d \u6807\u8bc6\u8be5\u5b57\u6bb5\u5728\u4e8c\u8fdb\u5236\u7f16\u7801\u4e2d\u4f7f\u7528\u7684\u552f\u4e00\u201c\u6807\u8bb0\u201d\u3002\u6807\u7b7e\u53f7 1-15 \u76f8\u5bf9\u4e8e\u66f4\u5927\u6570\u5b57\u7684\u6807\u7b7e\u53f7\u9700\u8981\u5c11\u4e8e\u4e00\u4e2a\u5b57\u8282\u6765\u7f16\u7801\uff0c\u56e0\u6b64\u4f5c\u4e3a\u4f18\u5316\uff0c\u53ef\u4ee5\u51b3\u5b9a\u5c06\u8fd9\u4e9b\u6807\u7b7e\u7528\u4e8e\u5e38\u7528\u6216\u91cd\u590d\u7684\u5143\u7d20\uff0c\u5c06\u6807\u7b7e16\u548c\u66f4\u5927\u6570\u5b57\u7684\u6807\u7b7e\u53f7\u7559\u7ed9\u4e0d\u592a\u5e38\u7528\u7684\u53ef\u9009\u5143\u7d20\u3002\u91cd\u590d\u5b57\u6bb5\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u9700\u8981\u91cd\u65b0\u7f16\u7801\u6807\u8bb0\u53f7\uff0c\u56e0\u6b64\u91cd\u590d\u5b57\u6bb5\u7279\u522b\u9002\u5408\u6b64\u4f18\u5316\u3002 \u5982\u679c\u672a\u8bbe\u7f6e\u5b57\u6bb5\u7684\u503c\uff0c\u5219\u4f7f\u7528 \u9ed8\u8ba4\u503c \uff1a\u6570\u5b57\u7c7b\u578b\u4e3a\u96f6\uff0c\u5b57\u7b26\u4e32\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u5e03\u5c14\u578b\u4e3afalse\u3002\u5bf9\u4e8e\u5d4c\u5165\u5f0f\u6d88\u606f\uff0c\u9ed8\u8ba4\u503c\u59cb\u7ec8\u662f\u6d88\u606f\u7684\u201c\u9ed8\u8ba4\u5b9e\u4f8b\u201d\u6216\u201c\u539f\u578b\u201d\uff0c\u5176\u4e2d\u6ca1\u6709\u8bbe\u7f6e\u5176\u5b57\u6bb5\u3002\u8c03\u7528\u8bbf\u95ee\u5668\u4ee5\u83b7\u53d6\u5c1a\u672a\u663e\u5f0f\u8bbe\u7f6e\u7684\u5b57\u6bb5\u7684\u503c\u59cb\u7ec8\u8fd4\u56de\u8be5\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u5bf9\u4e8e\u91cd\u590d\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u53ef\u4ee5\u91cd\u590d\u4efb\u610f\u6b21\u6570\uff08\u5305\u62ec\u96f6\uff09\u3002\u91cd\u590d\u503c\u7684\u987a\u5e8f\u5c06\u4fdd\u7559\u5728 protocol buffers \u4e2d\u3002\u5c06\u91cd\u590d\u5b57\u6bb5\u89c6\u4e3a\u52a8\u6001\u6570\u7ec4\u3002 \u5728 Protocol Buffer\u6307\u5357 \u4e2d\u627e\u5230\u7f16\u5199 .proto \u6587\u4ef6\u7684\u5b8c\u6574\u6307\u5357\uff0c\u5305\u62ec\u6240\u6709\u53ef\u80fd\u7684\u5b57\u6bb5\u7c7b\u578b\u3002\u4e0d\u8981\u53bb\u5bfb\u627e\u7c7b\u7ee7\u627f\u8fd9\u6837\u7684\u5de5\u5177\uff0c protocol buffers \u4e0d\u4f1a\u8fd9\u6837\u505a\u3002 \u7f16\u8bd1 Protocol Buffers \u65e2\u7136\u6709\u4e00\u4e2a .proto \u6587\u4ef6\uff0c\u9700\u8981\u505a\u7684\u4e0b\u4e00\u4ef6\u4e8b\u662f\u751f\u6210\u8bfb\u53d6\u548c\u5199\u5165 AddressBook \uff08\u4ee5\u53ca Person \u548c PhoneNumber \uff09\u6d88\u606f\u6240\u9700\u7684\u7c7b\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u5728 .proto \u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 protoc \uff1a \u5982\u679c\u5c1a\u672a\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7 \u4e0b\u8f7d\u8be5\u8f6f\u4ef6\u5305 \u5e76\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5Go protocol buffers \u63d2\u4ef6 bash go get -u github.com/golang/protobuf/protoc-gen-go \u7f16\u8bd1\u5668\u63d2\u4ef6 protoc-gen-go \u5c06\u88ab\u5b89\u88c5\u5728 $GOBIN \u4e2d\uff0c\u9ed8\u8ba4\u4e3a $GOPATH/bin \u3002\u8be5\u8def\u5f84\u5fc5\u987b\u5728 $PATH \u4e2d\uff0c\u534f\u8bae\u7f16\u8bd1\u5668 protoc \u624d\u80fd\u627e\u5230\u5b83\u3002 \u73b0\u5728\u8fd0\u884c\u7f16\u8bd1\u5668\uff1a \u6307\u5b9a\u6e90\u76ee\u5f55 \uff08\u5e94\u7528\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u4e0d\u63d0\u4f9b\u503c\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\uff09\uff0c \u6307\u5b9a\u76ee\u7684\u76ee\u5f55 \uff08\u5e0c\u671b\u751f\u6210\u7684\u4ee3\u7801\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u901a\u5e38\u4e0e $SRC_DIR \u76f8\u540c\uff09\uff0c \u6307\u5b9a .proto \u7684\u8def\u5f84 \u3002 \u5982\u4e0b\u6240\u793a\uff1a ```bash protoc -I=$SRC_DIR --go_out=$DST_DIR $SRC_DIR/addressbook.proto ``` \u56e0\u4e3a\u9700\u8981Go\u7c7b\uff0c\u6240\u4ee5\u4f7f\u7528`--go_out`\u9009\u9879\uff0c\u5176\u4ed6\u652f\u6301\u7684\u8bed\u8a00\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u7c7b\u4f3c\u7684\u9009\u9879\u3002 \u8fd9\u4f1a\u5728\u6307\u5b9a\u7684\u76ee\u6807\u76ee\u5f55\uff08 $DST_DIR \uff09\u4e2d\u751f\u6210 addressbook.pb.go \u3002 Protocol Buffers API \u751f\u6210\u7684 addressbook.pb.go \u63d0\u4f9b\u4ee5\u4e0b\u6709\u7528\u7c7b\u578b\uff1a \u5177\u6709 People \u5b57\u6bb5\u7684 AddressBook \u7ed3\u6784\u4f53\u3002 \u5177\u6709 Name \uff0c Id \uff0c Email \u548c Phones \u5b57\u6bb5\u7684 Person \u7ed3\u6784\u4f53\u3002 Person_PhoneNumber \u7ed3\u6784\u4f53\uff0c\u5305\u542b Number \u548c Type \u5b57\u6bb5\u3002 Person_PhoneType \u7c7b\u578b\u548c\u4e3a Person.PhoneType \u679a\u4e3e\u4e2d\u7684\u6bcf\u4e2a\u503c\u5b9a\u4e49\u7684\u503c\u3002 \u53ef\u4ee5\u9605\u8bfb\u66f4\u591a\u6709\u5173\u201c\u751f\u6210\u4ee3\u7801\u201d\u6307\u5357\u4e2d\u751f\u6210\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f46\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u89c6\u4e3a\u5b8c\u5168\u666e\u901a\u7684Go\u7c7b\u578b\u3002 \u8fd9\u662f list_people \u547d\u4ee4\u5173\u4e8e\u5982\u4f55\u521b\u5efa Person \u5b9e\u4f8b\u7684\u5355\u5143\u6d4b\u8bd5\u7684\u793a\u4f8b\uff1a p := pb.Person{ Id: 1234, Name: John Doe , Email: jdoe@example.com , Phones: []*pb.Person_PhoneNumber{ {Number: 555-4321 , Type: pb.Person_HOME}, }, } \u5199\u4e00\u6761\u6d88\u606f \u4f7f\u7528 protocol buffers \u7684\u76ee\u7684\u662f\u5e8f\u5217\u5316\u6570\u636e\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5728\u5176\u4ed6\u5730\u65b9\u89e3\u6790\u5b83\u3002\u5728Go\u4e2d\uff0c\u4f7f\u7528 proto \u5e93\u7684 Marshal \u51fd\u6570\u6765\u5e8f\u5217\u5316 protocol buffers \u6570\u636e\u3002\u6307\u5411 protocol buffers \u6d88\u606f\u7684 struct \u7684\u6307\u9488\u5b9e\u73b0\u4e86 proto.Message \u63a5\u53e3\u3002\u8c03\u7528 proto.Marshal \u4f1a\u8fd4\u56de\u4ee5\u4f20\u8f93\u683c\u5f0f\u7f16\u7801\u7684 protocol buffers \u3002\u4f8b\u5982\uff0c\u5728 add_person \u547d\u4ee4\u4e2d\u4f7f\u7528\u6b64\u51fd\u6570\uff1a book := pb.AddressBook{} // ... // Write the new address book back to disk. out, err := proto.Marshal(book) if err != nil { log.Fatalln( Failed to encode address book: , err) } if err := ioutil.WriteFile(fname, out, 0644); err != nil { log.Fatalln( Failed to write address book: , err) } \u8bfb\u4e00\u6761\u6d88\u606f \u8981\u89e3\u6790\u7f16\u7801\u7684\u6d88\u606f\uff0c\u4f7f\u7528 proto \u5e93\u7684 Unmarshal \u51fd\u6570\u3002\u8c03\u7528\u5b83\u5c06 buf \u4e2d\u7684\u6570\u636e\u89e3\u6790\u4e3a protocol buffers \uff0c\u5e76\u5c06\u7ed3\u679c\u653e\u5728 pb \u4e2d\u3002\u56e0\u6b64\uff0c\u8981\u5728 list_people \u547d\u4ee4\u4e2d\u89e3\u6790\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528\uff1a // Read the existing address book. in, err := ioutil.ReadFile(fname) if err != nil { log.Fatalln( Error reading file: , err) } book := pb.AddressBook{} if err := proto.Unmarshal(in, book); err != nil { log.Fatalln( Failed to parse address book: , err) } \u6269\u5c55\u4e00\u4e2a Protocol Buffers \u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u4f1a\u91ca\u653e\u4f7f\u7528 protocol buffers \u7684\u4ee3\u7801\uff0c\u6beb\u65e0\u7591\u95ee\u4f1a\u60f3\u8981\u201c\u6539\u8fdb\u201d protocol buffers \u7684\u5b9a\u4e49\u3002\u5982\u679c\u5e0c\u671b\u65b0\u7f13\u51b2\u533a\u5411\u540e\u517c\u5bb9\uff0c\u5e76\u4e14\u65e7\u7f13\u51b2\u533a\u662f\u5411\u524d\u517c\u5bb9\u7684\uff0c\u90a3\u4e48\u9700\u8981\u5728\u65b0\u5f97\u5230 protocol buffers \u4e2d\u9075\u5faa\u4e00\u4e9b\u89c4\u5219\uff1a \u4e0d\u5f97\u66f4\u6539\u4efb\u4f55\u73b0\u6709\u5b57\u6bb5\u7684\u6807\u8bb0\u53f7\u3002 \u53ef\u4ee5\u5220\u9664\u5b57\u6bb5\u3002 \u53ef\u4ee5\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u4f46\u5fc5\u987b\u4f7f\u7528\u65b0\u7684\u6807\u8bb0\u53f7\uff08\u5373\u4ece\u672a\u5728\u6b64\u534f\u8bae\u7f13\u51b2\u533a\u4e2d\u4f7f\u7528\u7684\u6807\u8bb0\u53f7\uff0c\u751a\u81f3\u4e0d\u5305\u62ec\u5df2\u5220\u9664\u7684\u5b57\u6bb5\uff09\u3002 (\u8fd9\u4e9b\u89c4\u5219\u6709 \u4e00\u4e9b\u4f8b\u5916 \uff0c\u4f46\u5b83\u4eec\u5f88\u5c11\u4f7f\u7528\u3002\uff09 \u5982\u679c\u9075\u5faa\u8fd9\u4e9b\u89c4\u5219\uff0c\u65e7\u4ee3\u7801\u5c06\u5f88\u4e50\u610f\u9605\u8bfb\u65b0\u6d88\u606f\u5e76\u7b80\u5355\u5730\u5ffd\u7565\u4efb\u4f55\u65b0\u5b57\u6bb5\u3002\u5bf9\u4e8e\u65e7\u4ee3\u7801\uff0c\u5df2\u5220\u9664\u7684\u5355\u4e2a\u5b57\u6bb5\u5c06\u53ea\u5177\u6709\u5176\u9ed8\u8ba4\u503c\uff0c\u5220\u9664\u7684\u91cd\u590d\u5b57\u6bb5\u5c06\u4e3a\u7a7a\u3002\u65b0\u4ee3\u7801\u4e5f\u5c06\u900f\u660e\u5730\u8bfb\u53d6\u65e7\u6d88\u606f\u3002 \u4f46\u662f\uff0c\u8bf7\u8bb0\u4f4f\u65e7\u6d88\u606f\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u65b0\u5b57\u6bb5\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u503c\u6267\u884c\u5408\u7406\u7684\u64cd\u4f5c\u3002\u4f7f\u7528\u7279\u5b9a\u4e8e\u7c7b\u578b\u7684 \u9ed8\u8ba4\u503c \uff1a \u5bf9\u4e8e\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32 \u5bf9\u4e8e\u5e03\u5c14\u503c\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a\u96f6","title":"`Protocol Buffers`\uff1aGo\u8bed\u8a00\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#protocol-buffersgo","text":"\u672c\u6559\u7a0b\u4f7f\u7528 proto3 \u7248\u672c\u7684 protocol buffers \u8bed\u8a00\uff0c\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u672c\u7684Go\u7a0b\u5e8f\u5458\u4f7f\u7528 protocol buffers \u7684\u4ecb\u7ecd\u3002\u901a\u8fc7\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\uff0c\u5c55\u793a\u5982\u4f55\uff1a \u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u6d88\u606f\u683c\u5f0f \u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668 \u4f7f\u7528 Go protocol buffers API\u6765\u7f16\u5199\u548c\u8bfb\u53d6\u6d88\u606f \u8fd9\u4e0d\u662f\u5728Go\u4e2d\u4f7f\u7528 protocol buffers \u7684\u7efc\u5408\u6307\u5357\u3002\u6709\u5173\u66f4\u8be6\u7ec6\u7684\u53c2\u8003\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c protocol buffers \u8bed\u8a00\u6307\u5357 \u201d\uff0c\u201c Go API\u53c2\u8003 \u201d\uff0c\u201c \u751f\u6210\u4ee3\u7801\u6307\u5357 \u201d\u548c\u201c \u7f16\u7801\u53c2\u8003 \u201d\u3002","title":"Protocol Buffers\uff1aGo\u8bed\u8a00\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#protocol-buffers","text":"\u5c06\u8981\u4f7f\u7528\u7684\u793a\u4f8b\u662f\u4e00\u4e2a\u975e\u5e38\u7b80\u5355\u7684\u201c\u5730\u5740\u7c3f\u201d\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5728\u6587\u4ef6\u4e2d\u8bfb\u53d6\u548c\u5199\u5165\u4eba\u5458\u7684\u8be6\u7ec6\u4fe1\u606f\u3002\u5730\u5740\u7c3f\u4e2d\u7684\u6bcf\u4e2a\u4eba\u90fd\u6709 \u59d3\u540d \uff0c ID \uff0c \u7535\u5b50\u90ae\u4ef6\u5730\u5740 \u548c \u8054\u7cfb\u7535\u8bdd\u53f7\u7801 \u3002 \u5982\u4f55\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u8fd9\u6837\u7684\u7ed3\u6784\u5316\u6570\u636e \uff1f\u6709\u51e0\u79cd\u65b9\u6cd5\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a \u4f7f\u7528 gobs \u5e8f\u5217\u5316Go\u6570\u636e\u7ed3\u6784\u3002\u8fd9\u662fGo\u7279\u5b9a\u73af\u5883\u4e2d\u7684\u4e00\u4e2a\u5f88\u597d\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u4f46\u5982\u679c\u9700\u8981\u4e0e\u4e3a\u5176\u4ed6\u5e73\u53f0\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u5171\u4eab\u6570\u636e\uff0c\u5b83\u5c06\u65e0\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002 \u53ef\u4ee5\u53d1\u660e\u4e00\u79cd\u7279\u6b8a\u7684\u65b9\u6cd5\u5c06\u6570\u636e\u9879\u7f16\u7801\u4e3a\u5355\u4e2a\u5b57\u7b26\u4e32,\u4f8b\u5982\u5c064\u4e2a\u6574\u6570\u7f16\u7801\u4e3a \u201c12:3:-23:67\u201d \u3002\u8fd9\u662f\u4e00\u79cd\u7b80\u5355\u800c\u7075\u6d3b\u7684\u65b9\u6cd5\uff0c\u867d\u7136\u5b83\u786e\u5b9e\u9700\u8981\u7f16\u5199\u4e00\u6b21\u6027\u7f16\u7801\u548c\u89e3\u6790\u4ee3\u7801\uff0c\u5e76\u4e14\u89e3\u6790\u4f1a\u4ea7\u751f\u8f83\u5c0f\u7684\u8fd0\u884c\u65f6\u6210\u672c\u3002\u8fd9\u6700\u9002\u5408\u7f16\u7801\u975e\u5e38\u7b80\u5355\u7684\u6570\u636e\u3002 \u5c06\u6570\u636e\u5e8f\u5217\u5316\u4e3a XML \u3002\u8fd9\u79cd\u65b9\u6cd5\u975e\u5e38\u6709\u5438\u5f15\u529b\uff0c\u56e0\u4e3a XML \u662f\u4eba\u7c7b\u53ef\u8bfb\u7684\uff0c\u5e76\u4e14\u5bf9\u8bb8\u591a\u7f16\u7a0b\u8bed\u8a00\u90fd\u6709\u7ed1\u5b9a\u5e93\u3002\u5982\u679c\u60f3\u4e0e\u5176\u4ed6\u5e94\u7528\u7a0b\u5e8f/\u9879\u76ee\u5171\u4eab\u6570\u636e\uff0c\u8fd9\u53ef\u80fd\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002\u7136\u800c\uff0c XML \u662f\u7a7a\u95f4\u5bc6\u96c6\u578b\uff0c\u5e76\u4e14\u7f16\u7801/\u89e3\u7801\u5b83\u4f1a\u5bf9\u5e94\u7528\u7a0b\u5e8f\u9020\u6210\u5de8\u5927\u7684\u6027\u80fd\u635f\u5931\u3002\u6b64\u5916\uff0c\u904d\u5386\u4e00\u9897 XML \u7684 DOM \u6811\u6bd4\u50cf\u901a\u5e38\u90a3\u6837\u5728\u7c7b\u4e2d\u904d\u5386\u7b80\u5355\u5b57\u6bb5\u8981\u590d\u6742\u5f97\u591a\u3002 protocol buffers \u662f\u7075\u6d3b\uff0c\u9ad8\u6548\uff0c\u81ea\u52a8\u5316\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u4f7f\u7528 protocol buffers \u7f16\u5199\u8981\u5b58\u50a8\u7684\u6570\u636e\u7ed3\u6784\u7684 .proto \u63cf\u8ff0\u6587\u4ef6\u3002\u7136\u540e protocol buffers \u7f16\u8bd1\u5668\u521b\u5efa\u4e00\u4e2a\u7c7b\uff0c\u8be5\u7c7b\u4f7f\u7528\u6709\u6548\u7684\u4e8c\u8fdb\u5236\u683c\u5f0f\u5b9e\u73b0 protocol buffers \u6570\u636e\u7684\u81ea\u52a8\u7f16\u7801\u548c\u89e3\u6790\u3002\u751f\u6210\u7684\u7c7b\u4e3a\u6784\u6210 protocol buffers \u7684\u5b57\u6bb5\u63d0\u4f9b getter \u548c setter \uff0c\u5e76\u751f\u6210\u4e00\u4e2a protocol buffers \uff0c\u5e76\u5c06 protocol buffers \u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u8bfb\u53d6\u548c\u5199\u5165\u8be6\u7ec6\u4fe1\u606f\u3002\u91cd\u8981\u7684\u662f\uff0c protocol buffers \u683c\u5f0f\u652f\u6301\u6269\u5c55\u683c\u5f0f\uff0c\u4f7f\u5f97\u4ee3\u7801\u4ecd\u7136\u53ef\u4ee5\u8bfb\u53d6\u7528\u65e7\u683c\u5f0f\u7f16\u7801\u7684\u6570\u636e\u3002","title":"\u4e3a\u4f55\u4f7f\u7528Protocol Buffers"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#_1","text":"\u6211\u4eec\u7684\u793a\u4f8b\u662f\u4e00\u7ec4\u7528\u4e8e\u7ba1\u7406\u5730\u5740\u7c3f\u6570\u636e\u6587\u4ef6\u7684\u547d\u4ee4\u884c\u5e94\u7528\u7a0b\u5e8f\uff0c\u4f7f\u7528 protocol buffers \u8fdb\u884c\u7f16\u7801\u3002\u547d\u4ee4add_person_go\u5411\u6570\u636e\u6587\u4ef6\u6dfb\u52a0\u65b0\u6761\u76ee\u3002\u547d\u4ee4list_people_go\u89e3\u6790\u6570\u636e\u6587\u4ef6\u5e76\u5c06\u6570\u636e\u6253\u5370\u5230\u63a7\u5236\u53f0\u3002 \u53ef\u4ee5\u5728GitHub\u5b58\u50a8\u5e93\u7684 examples \u76ee\u5f55\u4e2d\u627e\u5230\u5b8c\u6574\u7684\u793a\u4f8b\u3002","title":"\u5728\u54ea\u91cc\u67e5\u770b\u6837\u4f8b\u4ee3\u7801"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#_2","text":"\u8981\u521b\u5efa\u5730\u5740\u7c3f\u5e94\u7528\u7a0b\u5e8f\uff0c\u9700\u8981\u4ece .proto \u6587\u4ef6\u5f00\u59cb\u3002 .proto \u6587\u4ef6\u4e2d\u7684\u5b9a\u4e49\u5f88\u7b80\u5355\uff1a\u4e3a\u8981\u5e8f\u5217\u5316\u7684\u6bcf\u4e2a\u6570\u636e\u7ed3\u6784\u6dfb\u52a0\u6d88\u606f\uff0c\u7136\u540e\u4e3a\u6d88\u606f\u4e2d\u7684\u6bcf\u4e2a\u5b57\u6bb5\u6307\u5b9a\u540d\u79f0\u548c\u7c7b\u578b\u3002\u5728\u793a\u4f8b\u4e2d\uff0c\u5b9a\u4e49\u6d88\u606f\u7684 .proto \u6587\u4ef6\u662f addressbook.proto \u3002 .proto \u6587\u4ef6\u4ee5\u5305\u58f0\u660e\u5f00\u5934\uff0c\u8fd9\u6709\u52a9\u4e8e\u9632\u6b62\u4e0d\u540c\u9879\u76ee\u4e4b\u95f4\u7684\u547d\u540d\u51b2\u7a81\u3002 syntax = proto3 ; package tutorial; import google/protobuf/timestamp.proto ; \u5728Go\u4e2d\uff0c\u5305\u540d\u79f0\u7528\u4f5cGo\u5305\uff0c\u9664\u975e\u6307\u5b9a\u4e86 go_package \u3002\u5373\u4f7f\u786e\u5b9e\u63d0\u4f9b\u4e86 go_package \uff0c\u4ecd\u7136\u5e94\u8be5\u5b9a\u4e49\u4e00\u4e2a\u666e\u901a\u7684\u5305\uff0c\u4ee5\u907f\u514d\u5728 Protocol Buffers \u540d\u79f0\u7a7a\u95f4\u548c\u975eGo\u8bed\u8a00\u4e2d\u53d1\u751f\u540d\u79f0\u51b2\u7a81\u3002 \u63a5\u4e0b\u6765\u662f\u6d88\u606f\u5b9a\u4e49\u3002\u6d88\u606f\u53ea\u662f\u5305\u542b\u4e00\u7ec4\u7c7b\u578b\u5b57\u6bb5\u7684\u805a\u5408\u3002\u8bb8\u591a\u6807\u51c6\u7684\u7b80\u5355\u6570\u636e\u7c7b\u578b\u90fd\u53ef\u7528\u4f5c\u5b57\u6bb5\u7c7b\u578b\uff0c\u5305\u62ec bool \uff0c int32 \uff0c float \uff0c double \u548c string \u3002\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6d88\u606f\u7c7b\u578b\u4f5c\u4e3a\u5b57\u6bb5\u7c7b\u578b\uff0c\u4e3a\u6d88\u606f\u6dfb\u52a0\u66f4\u591a\u7ed3\u6784\u3002 message Person { string name = 1; int32 id = 2; // Unique ID number for this person. string email = 3; enum PhoneType { MOBILE = 0; HOME = 1; WORK = 2; } message PhoneNumber { string number = 1; PhoneType type = 2; } repeated PhoneNumber phones = 4; google.protobuf.Timestamp last_updated = 5; } // Our address book file is just one of these. message AddressBook { repeated Person people = 1; } \u5728\u4e0a\u9762\u7684\u793a\u4f8b\u4e2d\uff0c Person \u6d88\u606f\u5305\u542b PhoneNumber \u6d88\u606f\uff0c\u800c AddressBook \u6d88\u606f\u5305\u542b Person \u6d88\u606f\u3002 \u751a\u81f3\u53ef\u4ee5\u5b9a\u4e49\u5d4c\u5957\u5728\u5176\u4ed6\u6d88\u606f\u4e2d\u7684\u6d88\u606f\u7c7b\u578b\uff0c\u5982\u4e0a\u6240\u793a\uff0c PhoneNumber \u7c7b\u578b\u5728 Person \u4e2d\u5b9a\u4e49\u3002 \u5982\u679c\u5e0c\u671b\u5176\u4e2d\u4e00\u4e2a\u5b57\u6bb5\u5177\u6709\u9884\u5b9a\u4e49\u7684\u503c\u5217\u8868\u4e4b\u4e00\uff0c\u8fd8\u53ef\u4ee5\u5b9a\u4e49\u679a\u4e3e\u7c7b\u578b\uff0c\u6b64\u5904\u8981\u6307\u5b9a\u7535\u8bdd\u53f7\u7801\u53ef\u4ee5\u662f MOBILE \uff0c HOME \u6216 WORK \u4e4b\u4e00\u3002 \u6bcf\u4e2a\u5143\u7d20\u4e0a\u7684 \u201c=1\u201d \uff0c \u201c=2\u201d \u6807\u8bc6\u8be5\u5b57\u6bb5\u5728\u4e8c\u8fdb\u5236\u7f16\u7801\u4e2d\u4f7f\u7528\u7684\u552f\u4e00\u201c\u6807\u8bb0\u201d\u3002\u6807\u7b7e\u53f7 1-15 \u76f8\u5bf9\u4e8e\u66f4\u5927\u6570\u5b57\u7684\u6807\u7b7e\u53f7\u9700\u8981\u5c11\u4e8e\u4e00\u4e2a\u5b57\u8282\u6765\u7f16\u7801\uff0c\u56e0\u6b64\u4f5c\u4e3a\u4f18\u5316\uff0c\u53ef\u4ee5\u51b3\u5b9a\u5c06\u8fd9\u4e9b\u6807\u7b7e\u7528\u4e8e\u5e38\u7528\u6216\u91cd\u590d\u7684\u5143\u7d20\uff0c\u5c06\u6807\u7b7e16\u548c\u66f4\u5927\u6570\u5b57\u7684\u6807\u7b7e\u53f7\u7559\u7ed9\u4e0d\u592a\u5e38\u7528\u7684\u53ef\u9009\u5143\u7d20\u3002\u91cd\u590d\u5b57\u6bb5\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u9700\u8981\u91cd\u65b0\u7f16\u7801\u6807\u8bb0\u53f7\uff0c\u56e0\u6b64\u91cd\u590d\u5b57\u6bb5\u7279\u522b\u9002\u5408\u6b64\u4f18\u5316\u3002 \u5982\u679c\u672a\u8bbe\u7f6e\u5b57\u6bb5\u7684\u503c\uff0c\u5219\u4f7f\u7528 \u9ed8\u8ba4\u503c \uff1a\u6570\u5b57\u7c7b\u578b\u4e3a\u96f6\uff0c\u5b57\u7b26\u4e32\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u5e03\u5c14\u578b\u4e3afalse\u3002\u5bf9\u4e8e\u5d4c\u5165\u5f0f\u6d88\u606f\uff0c\u9ed8\u8ba4\u503c\u59cb\u7ec8\u662f\u6d88\u606f\u7684\u201c\u9ed8\u8ba4\u5b9e\u4f8b\u201d\u6216\u201c\u539f\u578b\u201d\uff0c\u5176\u4e2d\u6ca1\u6709\u8bbe\u7f6e\u5176\u5b57\u6bb5\u3002\u8c03\u7528\u8bbf\u95ee\u5668\u4ee5\u83b7\u53d6\u5c1a\u672a\u663e\u5f0f\u8bbe\u7f6e\u7684\u5b57\u6bb5\u7684\u503c\u59cb\u7ec8\u8fd4\u56de\u8be5\u5b57\u6bb5\u7684\u9ed8\u8ba4\u503c\u3002 \u5bf9\u4e8e\u91cd\u590d\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u53ef\u4ee5\u91cd\u590d\u4efb\u610f\u6b21\u6570\uff08\u5305\u62ec\u96f6\uff09\u3002\u91cd\u590d\u503c\u7684\u987a\u5e8f\u5c06\u4fdd\u7559\u5728 protocol buffers \u4e2d\u3002\u5c06\u91cd\u590d\u5b57\u6bb5\u89c6\u4e3a\u52a8\u6001\u6570\u7ec4\u3002 \u5728 Protocol Buffer\u6307\u5357 \u4e2d\u627e\u5230\u7f16\u5199 .proto \u6587\u4ef6\u7684\u5b8c\u6574\u6307\u5357\uff0c\u5305\u62ec\u6240\u6709\u53ef\u80fd\u7684\u5b57\u6bb5\u7c7b\u578b\u3002\u4e0d\u8981\u53bb\u5bfb\u627e\u7c7b\u7ee7\u627f\u8fd9\u6837\u7684\u5de5\u5177\uff0c protocol buffers \u4e0d\u4f1a\u8fd9\u6837\u505a\u3002","title":"\u81ea\u5b9a\u4e49\u534f\u8bae\u683c\u5f0f"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#protocol-buffers_1","text":"\u65e2\u7136\u6709\u4e00\u4e2a .proto \u6587\u4ef6\uff0c\u9700\u8981\u505a\u7684\u4e0b\u4e00\u4ef6\u4e8b\u662f\u751f\u6210\u8bfb\u53d6\u548c\u5199\u5165 AddressBook \uff08\u4ee5\u53ca Person \u548c PhoneNumber \uff09\u6d88\u606f\u6240\u9700\u7684\u7c7b\u3002\u4e3a\u6b64\uff0c\u9700\u8981\u5728 .proto \u4e0a\u8fd0\u884c protocol buffers \u7f16\u8bd1\u5668 protoc \uff1a \u5982\u679c\u5c1a\u672a\u5b89\u88c5\u7f16\u8bd1\u5668\uff0c\u8bf7 \u4e0b\u8f7d\u8be5\u8f6f\u4ef6\u5305 \u5e76\u6309\u7167\u81ea\u8ff0\u6587\u4ef6\u4e2d\u7684\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 \u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u5b89\u88c5Go protocol buffers \u63d2\u4ef6 bash go get -u github.com/golang/protobuf/protoc-gen-go \u7f16\u8bd1\u5668\u63d2\u4ef6 protoc-gen-go \u5c06\u88ab\u5b89\u88c5\u5728 $GOBIN \u4e2d\uff0c\u9ed8\u8ba4\u4e3a $GOPATH/bin \u3002\u8be5\u8def\u5f84\u5fc5\u987b\u5728 $PATH \u4e2d\uff0c\u534f\u8bae\u7f16\u8bd1\u5668 protoc \u624d\u80fd\u627e\u5230\u5b83\u3002 \u73b0\u5728\u8fd0\u884c\u7f16\u8bd1\u5668\uff1a \u6307\u5b9a\u6e90\u76ee\u5f55 \uff08\u5e94\u7528\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u4e0d\u63d0\u4f9b\u503c\uff0c\u5219\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\uff09\uff0c \u6307\u5b9a\u76ee\u7684\u76ee\u5f55 \uff08\u5e0c\u671b\u751f\u6210\u7684\u4ee3\u7801\u5b58\u653e\u7684\u4f4d\u7f6e\uff0c\u901a\u5e38\u4e0e $SRC_DIR \u76f8\u540c\uff09\uff0c \u6307\u5b9a .proto \u7684\u8def\u5f84 \u3002 \u5982\u4e0b\u6240\u793a\uff1a ```bash protoc -I=$SRC_DIR --go_out=$DST_DIR $SRC_DIR/addressbook.proto ``` \u56e0\u4e3a\u9700\u8981Go\u7c7b\uff0c\u6240\u4ee5\u4f7f\u7528`--go_out`\u9009\u9879\uff0c\u5176\u4ed6\u652f\u6301\u7684\u8bed\u8a00\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u7c7b\u4f3c\u7684\u9009\u9879\u3002 \u8fd9\u4f1a\u5728\u6307\u5b9a\u7684\u76ee\u6807\u76ee\u5f55\uff08 $DST_DIR \uff09\u4e2d\u751f\u6210 addressbook.pb.go \u3002","title":"\u7f16\u8bd1Protocol Buffers"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#protocol-buffers-api","text":"\u751f\u6210\u7684 addressbook.pb.go \u63d0\u4f9b\u4ee5\u4e0b\u6709\u7528\u7c7b\u578b\uff1a \u5177\u6709 People \u5b57\u6bb5\u7684 AddressBook \u7ed3\u6784\u4f53\u3002 \u5177\u6709 Name \uff0c Id \uff0c Email \u548c Phones \u5b57\u6bb5\u7684 Person \u7ed3\u6784\u4f53\u3002 Person_PhoneNumber \u7ed3\u6784\u4f53\uff0c\u5305\u542b Number \u548c Type \u5b57\u6bb5\u3002 Person_PhoneType \u7c7b\u578b\u548c\u4e3a Person.PhoneType \u679a\u4e3e\u4e2d\u7684\u6bcf\u4e2a\u503c\u5b9a\u4e49\u7684\u503c\u3002 \u53ef\u4ee5\u9605\u8bfb\u66f4\u591a\u6709\u5173\u201c\u751f\u6210\u4ee3\u7801\u201d\u6307\u5357\u4e2d\u751f\u6210\u7684\u5185\u5bb9\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u4f46\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e9b\u89c6\u4e3a\u5b8c\u5168\u666e\u901a\u7684Go\u7c7b\u578b\u3002 \u8fd9\u662f list_people \u547d\u4ee4\u5173\u4e8e\u5982\u4f55\u521b\u5efa Person \u5b9e\u4f8b\u7684\u5355\u5143\u6d4b\u8bd5\u7684\u793a\u4f8b\uff1a p := pb.Person{ Id: 1234, Name: John Doe , Email: jdoe@example.com , Phones: []*pb.Person_PhoneNumber{ {Number: 555-4321 , Type: pb.Person_HOME}, }, }","title":"Protocol Buffers API"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#_3","text":"\u4f7f\u7528 protocol buffers \u7684\u76ee\u7684\u662f\u5e8f\u5217\u5316\u6570\u636e\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5728\u5176\u4ed6\u5730\u65b9\u89e3\u6790\u5b83\u3002\u5728Go\u4e2d\uff0c\u4f7f\u7528 proto \u5e93\u7684 Marshal \u51fd\u6570\u6765\u5e8f\u5217\u5316 protocol buffers \u6570\u636e\u3002\u6307\u5411 protocol buffers \u6d88\u606f\u7684 struct \u7684\u6307\u9488\u5b9e\u73b0\u4e86 proto.Message \u63a5\u53e3\u3002\u8c03\u7528 proto.Marshal \u4f1a\u8fd4\u56de\u4ee5\u4f20\u8f93\u683c\u5f0f\u7f16\u7801\u7684 protocol buffers \u3002\u4f8b\u5982\uff0c\u5728 add_person \u547d\u4ee4\u4e2d\u4f7f\u7528\u6b64\u51fd\u6570\uff1a book := pb.AddressBook{} // ... // Write the new address book back to disk. out, err := proto.Marshal(book) if err != nil { log.Fatalln( Failed to encode address book: , err) } if err := ioutil.WriteFile(fname, out, 0644); err != nil { log.Fatalln( Failed to write address book: , err) }","title":"\u5199\u4e00\u6761\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#_4","text":"\u8981\u89e3\u6790\u7f16\u7801\u7684\u6d88\u606f\uff0c\u4f7f\u7528 proto \u5e93\u7684 Unmarshal \u51fd\u6570\u3002\u8c03\u7528\u5b83\u5c06 buf \u4e2d\u7684\u6570\u636e\u89e3\u6790\u4e3a protocol buffers \uff0c\u5e76\u5c06\u7ed3\u679c\u653e\u5728 pb \u4e2d\u3002\u56e0\u6b64\uff0c\u8981\u5728 list_people \u547d\u4ee4\u4e2d\u89e3\u6790\u6587\u4ef6\uff0c\u6211\u4eec\u4f7f\u7528\uff1a // Read the existing address book. in, err := ioutil.ReadFile(fname) if err != nil { log.Fatalln( Error reading file: , err) } book := pb.AddressBook{} if err := proto.Unmarshal(in, book); err != nil { log.Fatalln( Failed to parse address book: , err) }","title":"\u8bfb\u4e00\u6761\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/07-Go\u8bed\u8a00\u6307\u5357/#protocol-buffers_2","text":"\u4e00\u6bb5\u65f6\u95f4\u540e\uff0c\u4f1a\u91ca\u653e\u4f7f\u7528 protocol buffers \u7684\u4ee3\u7801\uff0c\u6beb\u65e0\u7591\u95ee\u4f1a\u60f3\u8981\u201c\u6539\u8fdb\u201d protocol buffers \u7684\u5b9a\u4e49\u3002\u5982\u679c\u5e0c\u671b\u65b0\u7f13\u51b2\u533a\u5411\u540e\u517c\u5bb9\uff0c\u5e76\u4e14\u65e7\u7f13\u51b2\u533a\u662f\u5411\u524d\u517c\u5bb9\u7684\uff0c\u90a3\u4e48\u9700\u8981\u5728\u65b0\u5f97\u5230 protocol buffers \u4e2d\u9075\u5faa\u4e00\u4e9b\u89c4\u5219\uff1a \u4e0d\u5f97\u66f4\u6539\u4efb\u4f55\u73b0\u6709\u5b57\u6bb5\u7684\u6807\u8bb0\u53f7\u3002 \u53ef\u4ee5\u5220\u9664\u5b57\u6bb5\u3002 \u53ef\u4ee5\u6dfb\u52a0\u65b0\u5b57\u6bb5\uff0c\u4f46\u5fc5\u987b\u4f7f\u7528\u65b0\u7684\u6807\u8bb0\u53f7\uff08\u5373\u4ece\u672a\u5728\u6b64\u534f\u8bae\u7f13\u51b2\u533a\u4e2d\u4f7f\u7528\u7684\u6807\u8bb0\u53f7\uff0c\u751a\u81f3\u4e0d\u5305\u62ec\u5df2\u5220\u9664\u7684\u5b57\u6bb5\uff09\u3002 (\u8fd9\u4e9b\u89c4\u5219\u6709 \u4e00\u4e9b\u4f8b\u5916 \uff0c\u4f46\u5b83\u4eec\u5f88\u5c11\u4f7f\u7528\u3002\uff09 \u5982\u679c\u9075\u5faa\u8fd9\u4e9b\u89c4\u5219\uff0c\u65e7\u4ee3\u7801\u5c06\u5f88\u4e50\u610f\u9605\u8bfb\u65b0\u6d88\u606f\u5e76\u7b80\u5355\u5730\u5ffd\u7565\u4efb\u4f55\u65b0\u5b57\u6bb5\u3002\u5bf9\u4e8e\u65e7\u4ee3\u7801\uff0c\u5df2\u5220\u9664\u7684\u5355\u4e2a\u5b57\u6bb5\u5c06\u53ea\u5177\u6709\u5176\u9ed8\u8ba4\u503c\uff0c\u5220\u9664\u7684\u91cd\u590d\u5b57\u6bb5\u5c06\u4e3a\u7a7a\u3002\u65b0\u4ee3\u7801\u4e5f\u5c06\u900f\u660e\u5730\u8bfb\u53d6\u65e7\u6d88\u606f\u3002 \u4f46\u662f\uff0c\u8bf7\u8bb0\u4f4f\u65e7\u6d88\u606f\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u65b0\u5b57\u6bb5\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528\u9ed8\u8ba4\u503c\u6267\u884c\u5408\u7406\u7684\u64cd\u4f5c\u3002\u4f7f\u7528\u7279\u5b9a\u4e8e\u7c7b\u578b\u7684 \u9ed8\u8ba4\u503c \uff1a \u5bf9\u4e8e\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32 \u5bf9\u4e8e\u5e03\u5c14\u503c\uff0c\u9ed8\u8ba4\u503c\u4e3afalse \u5bf9\u4e8e\u6570\u5b57\u7c7b\u578b\uff0c\u9ed8\u8ba4\u503c\u4e3a\u96f6","title":"\u6269\u5c55\u4e00\u4e2aProtocol Buffers"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/","text":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357 \u6b64\u9875\u9762\u51c6\u786e\u63cf\u8ff0\u4e86 protocol buffers \u7f16\u8bd1\u5668\u4e3a\u4efb\u4f55\u7ed9\u5b9a\u534f\u8bae\u5b9a\u4e49\u751f\u6210\u7684Go\u4ee3\u7801\u3002 proto2 \u548c proto3 \u751f\u6210\u7684\u4ee3\u7801\u4e4b\u95f4\u7684\u4efb\u4f55\u5dee\u5f02\u90fd\u4f1a\u7a81\u51fa\u663e\u793a\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u5dee\u5f02\u5728\u672c\u6587\u6863\u4e2d\u63cf\u8ff0\u7684\u751f\u6210\u4ee3\u7801\u4e2d\uff0c\u800c\u4e0d\u662f\u57fa\u672cAPI\uff0c\u4e24\u4e2a\u7248\u672c\u4e2d\u7684API\u76f8\u540c\u3002\u5728\u9605\u8bfb\u672c\u6587\u6863\u4e4b\u524d\uff0c\u5e94\u8be5\u9605\u8bfb proto2 \u8bed\u8a00\u6307\u5357 \u548c\u6216 proto3 \u8bed\u8a00\u6307\u5357 \u3002 \u7f16\u8bd1\u5668\u8c03\u7528 protocol buffers \u7f16\u8bd1\u5668\u9700\u8981\u4e00\u4e2a \u63d2\u4ef6\u751f\u6210Go\u4ee3\u7801 \u3002\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5\uff1a go get github.com/golang/protobuf/protoc-gen-go \u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 --go_out \u6807\u5fd7\u65f6\uff0c\u7531 protoc \u7f16\u8bd1\u5668\u8c03\u7528 protoc-gen-go \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 --go_out \u6807\u5fd7\u544a\u8bc9\u7f16\u8bd1\u5668Go\u6e90\u6587\u4ef6\u8f93\u51fa\u4f4d\u7f6e\u3002\u7f16\u8bd1\u5668\u4e3a\u6bcf\u4e2a .proto \u6587\u4ef6\u521b\u5efa\u5355\u4e2a\u6e90\u6587\u4ef6\u3002 \u8f93\u51fa\u6587\u4ef6\u7684\u540d\u79f0\u662f\u8ba1\u7b97 .proto \u6587\u4ef6\u7684\u540d\u79f0\u5f97\u6765\u7684\uff0c\u5728\u4e24\u4e2a\u5730\u65b9\u53ef\u4ee5\u66f4\u6539\uff1a \u6269\u5c55\u540d\uff08 .proto \uff09\u66ff\u6362\u4e3a .pb.go \u3002\u4f8b\u5982\uff0c\u540d\u4e3a player_record.proto \u7684\u6587\u4ef6\u4f1a\u751f\u6210\u4e00\u4e2a\u540d\u4e3a player_record.pb.go \u7684\u8f93\u51fa\u6587\u4ef6\u3002 proto\u8def\u5f84\uff08\u4f7f\u7528 --proto_path \u6216 -I \u547d\u4ee4\u884c\u6807\u5fd7\u6307\u5b9a\uff09\u5c06\u66ff\u6362\u4e3a\u8f93\u51fa\u8def\u5f84\uff08\u4f7f\u7528 --go_out \u6807\u5fd7\u6307\u5b9a\uff09\u3002 \u5f53\u50cf\u4e0b\u9762\u8fd9\u6837\u8fd0\u884c proto \u7f16\u8bd1\u5668\u65f6\uff1a protoc --proto_path=src --go_out=build/gen src/foo.proto src/bar/baz.proto \u7f16\u8bd1\u5668\u5c06\u8bfb\u53d6 src/foo.proto \u548c src/bar/baz.proto \u6587\u4ef6\u3002\u5b83\u4ea7\u751f\u4e24\u4e2a\u8f93\u51fa\u6587\u4ef6\uff1a build/gen/foo.pb.go \u548c build/gen/bar/baz.pb.go \u3002 \u5982\u6709\u5fc5\u8981\uff0c\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u521b\u5efa build/gen/bar \u76ee\u5f55\uff0c\u4f46\u4e0d\u4f1a\u521b\u5efa build \u6216 build/gen \u76ee\u5f55\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u76ee\u5f55\u5fc5\u987b\u5df2\u7ecf\u5b58\u5728\u3002 \u5305 \u5982\u679c .proto \u6587\u4ef6\u4e2d\u6709 package \u58f0\u660e\uff0c\u5219\u751f\u6210\u7684\u4ee3\u7801\u4f7f\u7528proto\u7684 package \u58f0\u660e\u4f5c\u4e3a\u5176Go\u5305\u540d\u79f0\uff0c\u5176\u4e2d\u5c06 \".\" \u8f6c\u6362\u4e3a \"_\" \u3002\u4f8b\u5982\uff0c example.high_score \u7684proto\u7684 package \u540d\u79f0\u751f\u6210\u7684Go\u5305\u540d\u79f0\u4e3a example_high_score \u3002 \u53ef\u4ee5\u4f7f\u7528 .proto \u6587\u4ef6\u4e2d\u7684 go_package \u9009\u9879\u8986\u76d6\u7279\u5b9a .proto \u9ed8\u8ba4\u751f\u6210\u7684\u5305\u3002\u5982\u4e0b .proto \u6587\u4ef6\uff0c\u751f\u6210\u7684Go\u5305\u540d\u4e3a hs \u3002 package example.high_score; option go_package = hs ; \u5426\u5219\uff0c\u5982\u679c .proto \u6587\u4ef6\u4e0d\u5305\u542b package \u58f0\u660e\uff0c\u5219\u751f\u6210\u7684\u4ee3\u7801\u4f7f\u7528\u6587\u4ef6\u540d\uff08\u51cf\u53bb\u6269\u5c55\u540d\uff09\u4f5c\u4e3aGo\u5305\u540d\u79f0\uff0c\u5e76\u5c06 \".\" \u8f6c\u6362\u4e3a \"_\u201c \u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u540d\u4e3a high.score.proto \u7684proto\u5305\uff0c\u5176\u4e2d\u7684\u6ca1\u6709 package \u58f0\u660e\uff0c\u5c06\u751f\u6210\u5728 high_score \u5305\u4e2d\u751f\u6210\u4e00\u4e2a\u540d\u4e3a high.score.pb.go \u7684\u6587\u4ef6\u3002 \u6d88\u606f \u7ed9\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\u6d88\u606f\u58f0\u660e\uff1a message Foo {} protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Foo \u7684\u7ed3\u6784\u548c\u4e00\u4e2a\u5b9e\u73b0\u4e86 Message \u63a5\u53e3\u7684 * Foo \u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u5185\u8054\u6ce8\u91ca\u3002 type Foo struct { } // Reset sets the proto's state to default values. func (m *Foo) Reset() { *m = Foo{} } // String returns a string representation of the proto. func (m *Foo) String() string { return proto.CompactTextString(m) } // ProtoMessage acts as a tag to make sure no one accidentally implements the // proto.Message interface. func (*Foo) ProtoMessage() {} \u8bf7\u6ce8\u610f\uff0c\u6240\u6709\u8fd9\u4e9b\u6210\u5458\u59cb\u7ec8\u5b58\u5728; optimize_for \u9009\u9879\u4e0d\u4f1a\u5f71\u54cdGo\u4ee3\u7801\u751f\u6210\u5668\u7684\u8f93\u51fa\u3002 \u5d4c\u5957\u7c7b\u578b \u53ef\u4ee5\u5728\u4e00\u4e2a\u6761\u6d88\u606f\u4e2d\u5d4c\u5957\u58f0\u660e\u53e6\u4e00\u4e2a\u6d88\u606f\u3002\u4f8b\u5982\uff1a message Foo { message Bar { } } \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e24\u4e2a\u7ed3\u6784\uff1a Foo \u548c Foo_Bar \u3002 \u77e5\u540d\u7c7b\u578b Protobufs \u5e26\u6709\u4e00\u7ec4\u9884\u5b9a\u4e49\u7684\u6d88\u606f\uff0c\u79f0\u4e3a \u77e5\u540d\u7c7b\u578b( WKT ) \u3002\u8fd9\u4e9b\u7c7b\u578b\u53ef\u4ee5\u7528\u4e8e\u4e0e\u5176\u4ed6\u670d\u52a1\u7684\u4e92\u64cd\u4f5c\u6027\uff0c\u6216\u8005\u4ec5\u4ec5\u56e0\u4e3a\u5b83\u4eec\u7b80\u6d01\u5730\u8868\u793a\u5e38\u89c1\u7684\u6709\u7528\u6a21\u5f0f\u3002 \u4f8b\u5982\uff0c Struct \u6d88\u606f\u8868\u793a\u4efb\u610fC\u98ce\u683c\u7684\u7ed3\u6784\u4f53\u3002 WKT \u7684\u9884\u751f\u6210Go\u4ee3\u7801\u4f5c\u4e3a Go protobuf \u5e93\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u5206\u53d1\uff0c\u5982\u679c\u4f7f\u7528 WKT \uff0c\u5219\u751f\u6210\u7684\u6d88\u606f\u7684Go\u4ee3\u7801\u4f1a\u5f15\u7528\u6b64\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u7ed9\u51fa\u5982\u4e0b\u6d88\u606f\uff1a import google/protobuf/struct.proto import google/protobuf/timestamp.proto message NamedStruct { string name = 1; google.protobuf.Struct definition = 2; google.protobuf.Timestamp last_modified = 3; } \u751f\u6210\u7684Go\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a import google_protobuf github.com/golang/protobuf/ptypes/struct import google_protobuf1 github.com/golang/protobuf/ptypes/timestamp ... type NamedStruct struct { Name string Definition *google_protobuf.Struct LastModified *google_protobuf1.Timestamp } \u4e00\u822c\u6765\u8bf4\uff0c\u4e0d\u9700\u8981\u5c06\u8fd9\u4e9b\u7c7b\u578b\u76f4\u63a5\u5bfc\u5165\u4ee3\u7801\u4e2d\u3002\u4f46\u662f\uff0c\u5982\u679c\u9700\u8981\u76f4\u63a5\u5f15\u7528\u5176\u4e2d\u4e00\u79cd\u7c7b\u578b\uff0c\u53ea\u9700\u5bfc\u5165 github.com/golang/protobuf/ptypes/[TYPE] \u5305\uff0c\u5e76\u6b63\u5e38\u4f7f\u7528\u8be5\u7c7b\u578b\u3002 \u5b57\u6bb5 protocol buffers \u7f16\u8bd1\u5668\u4e3a\u6d88\u606f\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2a\u5b57\u6bb5\u751f\u6210\u7ed3\u6784\u4f53\u7684\u5b57\u6bb5\u3002\u8be5\u5b57\u6bb5\u7684\u786e\u5207\u6027\u8d28\u53d6\u51b3\u4e8e\u5b83\u7684\u7c7b\u578b\u4ee5\u53ca\u5b83\u662f\u5426\u662f singular , repeated , map \u6216\u8005 oneof \u5b57\u6bb5\u3002 \u8bf7\u6ce8\u610f\uff0c\u751f\u6210\u7684Go\u5b57\u6bb5\u540d\u79f0\u59cb\u7ec8\u4f7f\u7528\u5927\u9a7c\u5cf0\u5f0f\uff08CamelCase\uff09\u547d\u540d\uff0c\u5373\u4f7f .proto \u6587\u4ef6\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u4f7f\u7528\u5e26\u6709\u4e0b\u5212\u7ebf\u7684\u5c0f\u5199\uff08 \u5e94\u8be5\u5982\u6b64 \uff09\u3002\u5927\u5c0f\u5199\u8f6c\u6362\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a \u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f\u5bfc\u5165\u7684\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c\u5219\u5c06\u5176\u5220\u9664\u5e76\u6dfb\u52a0\u5927\u5199\u5b57\u6bcd X \u3002 \u5982\u679c\u5185\u90e8\u4e0b\u5212\u7ebf\u540e\u8ddf\u5c0f\u5199\u5b57\u6bcd\uff0c\u5219\u5220\u9664\u4e0b\u5212\u7ebf\uff0c\u5e76\u5c06\u540e\u9762\u7684\u5b57\u6bcd\u5927\u5199\u3002 \u56e0\u6b64\uff1a \u539f\u5b57\u6bb5 foo_bar_baz \u5728Go\u4e2d\u53d8\u4e3a FooBarBaz \u539f\u5b57\u6bb5 _my_field_name_2 \u5728GO\u4e2d\u53d8\u4e3a XMyFieldName_2 \u5355\u4e2a\u6807\u91cf\u5b57\u6bb5 (proto2) \u5bf9\u4e8e\u4ee5\u4e0b\u4efb\u4e00\u5b57\u6bb5\u5b9a\u4e49\uff1a optional int32 foo = 1; required int32 foo = 1; \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a Foo \u7684 *int32 \u5b57\u6bb5\u548c\u4e00\u4e2a\u8bbf\u95ee\u5668\u65b9\u6cd5 GetFoo() \u5b83\u8fd4\u56de Foo \u4e2d\u7684 int32 \u503c\u6216\u9ed8\u8ba4\u503c\uff08\u5982\u679c\u8be5\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff09\u3002\u5982\u679c\u672a\u663e\u5f0f\u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff0c\u5219\u4f7f\u7528\u8be5\u7c7b\u578b\u7684 \u96f6\u503c \uff080\u8868\u793a\u6570\u5b57\uff0c\u7a7a\u5b57\u7b26\u4e32\u8868\u793a\u5b57\u7b26\u4e32\uff09\u3002 \u5bf9\u4e8e\u5176\u4ed6\u6807\u91cf\u5b57\u6bb5\u7c7b\u578b\uff08\u5305\u62ec bool \uff0c bytes \u548c string \uff09\uff0c *int32 \u5c06\u6839\u636e \u6807\u91cf\u503c\u7c7b\u578b \u8868\u66ff\u6362\u4e3a\u76f8\u5e94\u7684Go\u7c7b\u578b\u3002 \u5355\u4e2a\u6807\u91cf\u5b57\u6bb5 (proto3) \u5bf9\u4e8e\u6b64\u5b57\u6bb5\u5b9a\u4e49\uff1a int32 foo = 1; \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Foo \u7684 int32 \u5b57\u6bb5\u548c\u4e00\u4e2a\u8bbf\u95ee\u5668\u65b9\u6cd5 GetFoo() \u7684\u7ed3\u6784\u4f53\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de Foo \u4e2d\u7684 int32 \u503c\u6216\u8be5\u5b57\u6bb5\u7684 \u96f6\u503c \uff0c\u5982\u679c\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff080\u8868\u793a\u6570\u5b57\uff0c\u5b57\u7b26\u4e32\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff09\u3002 \u5bf9\u4e8e\u5176\u4ed6\u6807\u91cf\u5b57\u6bb5\u7c7b\u578b\uff08\u5305\u62ec bool \uff0c bytes \u548c string \uff09\uff0c\u6839\u636e \u6807\u91cf\u503c\u7c7b\u578b \u5c06 int32 \u66ff\u6362\u4e3a\u76f8\u5e94\u7684Go\u7c7b\u578b\u3002proto\u4e2d\u7684\u672a\u8bbe\u7f6e\u503c\u5c06\u8868\u793a\u4e3a\u8be5\u7c7b\u578b\u7684 \u96f6\u503c \uff080\u8868\u793a\u6570\u5b57\uff0c\u7a7a\u5b57\u7b26\u4e32\u8868\u793a\u5b57\u7b26\u4e32\uff09\u3002 \u5355\u4e2a\u6d88\u606f\u5b57\u6bb5 \u7ed9\u5b9a\u6d88\u606f\u7c7b\u578b\uff1a message Bar {} \u5bf9\u4e8e\u5e26\u6709Bar\u5b57\u6bb5\u7684\u6d88\u606f: // proto2 message Baz { optional Bar foo = 1; // The generated code is the same result if required instead of optional. } // proto3 message Baz { Bar foo = 1; } \u7f16\u8bd1\u5668\u5c06\u751f\u6210Go\u7ed3\u6784: type Baz struct { Foo *Bar } \u6d88\u606f\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\u4e3a nil \uff0c\u8fd9\u610f\u5473\u7740\u8be5\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff0c\u6709\u6548\u7684\u6e05\u9664\u8be5\u5b57\u6bb5\u3002\u8fd9\u4e0d\u7b49\u540c\u4e8e\u5c06\u503c\u8bbe\u7f6e\u4e3a\u6d88\u606f\u7ed3\u6784\u4f53\u7684\u201c\u7a7a\u201d\u5b9e\u4f8b\u3002 \u7f16\u8bd1\u5668\u8fd8\u751f\u6210\u4e00\u4e2a func(m * Baz)GetFoo() *Bar \u8f85\u52a9\u51fd\u6570\u3002\u8fd9\u4f7f\u5f97\u53ef\u4ee5\u5728\u6ca1\u6709\u4e2d\u95f4 nil \u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u94fe\u63a5\u83b7\u53d6\u8c03\u7528\u3002 Repeated \u5b57\u6bb5 \u6bcf\u4e2a repeated \u5b57\u6bb5\u751f\u6210\u4e00\u4e2a T \u5b57\u6bb5\u7684\u5207\u7247( slice )\u5728Go\u7ed3\u6784\u4e2d\uff0c\u5176\u4e2d T \u662f\u5b57\u6bb5\u7684\u5143\u7d20\u7c7b\u578b\u3002\u5982\u4e0b\u6d88\u606f\u5e26\u6709 repeated \u5b57\u6bb5: message Baz { repeated Bar foo = 1; } \u7f16\u8bd1\u5668\u751f\u6210Go\u7ed3\u6784\uff1a type Baz struct { Foo []*Bar } \u540c\u6837: \u5bf9\u4e8e\u5b57\u6bb5\u5b9a\u4e49 repeated bytes foo = 1 \uff1b\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Foo \u7684 [][]bytes \u5b57\u6bb5\u7684Go\u7ed3\u6784 \u5bf9\u4e8e\u91cd\u590d\u7684 \u679a\u4e3e repeated MyEnum bar = 2 \uff1b\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Bar \u7684 []MyEnum \u5b57\u6bb5\u7684Go\u7ed3\u6784 Map \u5b57\u6bb5 \u6bcf\u4e2a map \u5b57\u6bb5\u4ee5\u7c7b\u578b map[TKey]TValue \u5728\u7ed3\u6784\u4f53\u4e2d\u751f\u6210\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2d TKey \u662f\u5b57\u6bb5\u7684\u952e\u7c7b\u578b\uff0c TValue \u662f\u5b57\u6bb5\u7684\u503c\u7c7b\u578b\u3002\u5982\u4e0b\u6d88\u606f\u5e26\u6709 map \u5b57\u6bb5\uff1a message Bar {} message Baz { map string, Bar foo = 1; } \u7f16\u8bd1\u5668\u751f\u6210Go\u7ed3\u6784\uff1a type Baz struct { Foo map[string]*Bar } Oneof \u5b57\u6bb5 \u5bf9\u4e8e oneof \u5b57\u6bb5\uff0c protobuf \u7f16\u8bd1\u5668\u751f\u6210\u5177\u6709\u63a5\u53e3\u7c7b\u578b isMessageName_MyField \u7684\u5355\u72ec\u5b57\u6bb5\u3002\u5e76\u4e14\u8fd8\u4e3a oneof \u4e2d\u7684\u6bcf\u4e2a\u5355\u72ec\u5b57\u6bb5\u751f\u6210\u4e00\u4e2a\u7ed3\u6784\u4f53\u3002\u8fd9\u4e9b\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e2a isMessageName_MyField \u63a5\u53e3\u3002 \u5bf9\u4e8e\u5e26\u6709oneof\u5b57\u6bb5\u7684\u6b64\u6d88\u606f\uff1a package account; message Profile { oneof avatar { string image_url = 1; bytes image_data = 2; } } \u7f16\u8bd1\u5668\u751f\u6210\u7684\u7ed3\u6784\u4f53\uff1a type Profile struct { // Types that are valid to be assigned to Avatar: // *Profile_ImageUrl // *Profile_ImageData Avatar isProfile_Avatar `protobuf_oneof: avatar ` } type Profile_ImageUrl struct { ImageUrl string } type Profile_ImageData struct { ImageData []byte } *Profile_ImageUrl \u548c *Profile_ImageData \u90fd\u901a\u8fc7\u63d0\u4f9b\u7a7a\u7684 isProfile_Avatar() \u65b9\u6cd5\u6765\u5b9e\u73b0 isProfile_Avatar \u3002 \u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u5982\u4f55\u8bbe\u7f6e\u5b57\u6bb5\uff1a p1 := account.Profile{ Avatar: account.Profile_ImageUrl{ http://example.com/image.png }, } // imageData is []byte imageData := getImageData() p2 := account.Profile{ Avatar: account.Profile_ImageData{imageData}, } \u8981\u8bbf\u95ee\u8be5\u5b57\u6bb5\uff0c\u53ef\u4ee5\u4f7f\u7528\u503c\u4e0a\u7684\u7c7b\u578b\u5f00\u5173\u6765\u5904\u7406\u4e0d\u540c\u7684\u6d88\u606f\u7c7b\u578b\u3002 switch x := m.Avatar.(type) { case *account.Profile_ImageUrl: // Load profile image based on URL // using x.ImageUrl case *account.Profile_ImageData: // Load profile image based on bytes // using x.ImageData case nil: // The field is not set. default: return fmt.Errorf( Profile.Avatar has unexpected type %T , x) } \u7f16\u8bd1\u5668\u8fd8\u751f\u6210get\u65b9\u6cd5 func (m * Profile) GetImageUrl() string \u548c func (m * Profile) GetImageData() []byte \u3002\u6bcf\u4e2aget\u51fd\u6570\u8fd4\u56de\u8be5\u5b57\u6bb5\u7684\u503c\uff0c\u5982\u679c\u672a\u8bbe\u7f6e\u5219\u8fd4\u56de\u96f6\u503c\u3002 \u679a\u4e3e \u7ed9\u51fa\u5982\u4e0b\u679a\u4e3e\uff1a message SearchRequest { enum Corpus { UNIVERSAL = 0; WEB = 1; IMAGES = 2; LOCAL = 3; NEWS = 4; PRODUCTS = 5; VIDEO = 6; } Corpus corpus = 1; ... } protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a \u7c7b\u578b \u548c\u4e00\u7cfb\u5217\u8be5\u7c7b\u578b\u7684 \u5e38\u91cf \u3002 \u5bf9\u4e8e\u4e0a\u9762\u6d88\u606f\u4e2d\u7684\u679a\u4e3e\uff0c\u7c7b\u578b\u540d\u79f0\u4ee5\u6d88\u606f\u540d\u79f0\u5f00\u5934\uff1a type SearchRequest_Corpus int32 \u5bf9\u4e8e\u5305\u7ea7\u522b\u7684\u679a\u4e3e\uff1a enum Foo { DEFAULT_BAR = 0; BAR_BELLS = 1; BAR_B_CUE = 2; } Go\u751f\u6210\u7684\u7c7b\u578b\u540d\u79f0\u4ece\u672a\u4fee\u6539\u7684 proto \u679a\u4e3e\u540d\u79f0\u5f97\u6765: type Foo int32 \u6b64\u7c7b\u578b\u5177\u6709 String() \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5b9a\u503c\u7684\u540d\u79f0\u3002 Enum() \u65b9\u6cd5\u4f7f\u7528\u7ed9\u5b9a\u503c\u521d\u59cb\u5316\u65b0\u5206\u914d\u7684\u5185\u5b58\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u6307\u9488\uff1a func (Foo) Enum() *Foo protocol buffers \u7f16\u8bd1\u5668\u4e3a\u679a\u4e3e\u4e2d\u7684\u6bcf\u4e2a\u503c\u751f\u6210\u4e00\u4e2a\u5e38\u91cf\u3002\u5bf9\u4e8e\u6d88\u606f\u4e2d\u7684\u679a\u4e3e\uff0c\u5e38\u91cf\u4ee5\u6d88\u606f\u7684\u540d\u79f0\u5f00\u5934\uff1a const ( SearchRequest_UNIVERSAL SearchRequest_Corpus = 0 SearchRequest_WEB SearchRequest_Corpus = 1 SearchRequest_IMAGES SearchRequest_Corpus = 2 SearchRequest_LOCAL SearchRequest_Corpus = 3 SearchRequest_NEWS SearchRequest_Corpus = 4 SearchRequest_PRODUCTS SearchRequest_Corpus = 5 SearchRequest_VIDEO SearchRequest_Corpus = 6 ) \u5bf9\u4e8e\u5305\u7ea7\u522b\u7684\u679a\u4e3e\uff0c\u5e38\u91cf\u4ee5\u679a\u4e3e\u540d\u79f0\u5f00\u5934\uff1a const ( Foo_DEFAULT_BAR Foo = 0 Foo_BAR_BELLS Foo = 1 Foo_BAR_B_CUE Foo = 2 ) protobuf \u7f16\u8bd1\u5668\u8fd8\u751f\u6210\u4ece\u6574\u6570\u503c\u5230\u5b57\u7b26\u4e32\u540d\u79f0\u7684\u6620\u5c04\u4ee5\u53ca\u4ece\u540d\u79f0\u5230\u503c\u7684\u6620\u5c04\uff1a var Foo_name = map[int32]string{ 0: DEFAULT_BAR , 1: BAR_BELLS , 2: BAR_B_CUE , } var Foo_value = map[string]int32{ DEFAULT_BAR : 0, BAR_BELLS : 1, BAR_B_CUE : 2, } \u8bf7\u6ce8\u610f\uff0c .proto \u5141\u8bb8\u591a\u4e2a\u679a\u4e3e\u7b26\u53f7\u5177\u6709\u76f8\u540c\u7684\u6570\u503c\uff0c\u5177\u6709\u76f8\u540c\u6570\u503c\u7684\u7b26\u53f7\u662f\u540c\u4e49\u8bcd\u3002\u8fd9\u4e9b\u5728Go\u4e2d\u4ee5\u5b8c\u5168\u76f8\u540c\u7684\u65b9\u5f0f\u8868\u793a\uff0c\u591a\u4e2a\u540d\u79f0\u5bf9\u5e94\u4e8e\u76f8\u540c\u7684\u6570\u503c\u3002\u53cd\u5411\u6620\u5c04\u5305\u542b\u6570\u503c\u7684\u5355\u4e2a\u6761\u76ee\uff0c\u8be5\u6761\u76ee\u7b2c\u4e00\u4e2a\u51fa\u73b0\u5728 .proto \u6587\u4ef6\u4e2d\u3002 \u6269\u5c55\uff08proto2\uff09 \u6269\u5c55\u4ec5\u5b58\u5728\u4e8eproto2\u4e2d\u3002\u6709\u5173proto2\u6269\u5c55\u7684Go\u751f\u6210\u4ee3\u7801API\u7684\u6587\u6863\uff0c\u8bf7\u53c2\u9605proto\u5305 doc \u3002 \u670d\u52a1 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGo\u4ee3\u7801\u751f\u6210\u5668\u4e0d\u4f1a\u4e3a\u670d\u52a1\u751f\u6210\u8f93\u51fa\u3002\u5982\u679c\u542f\u7528 gRPC \u63d2\u4ef6\uff08\u8bf7\u53c2\u9605 gRPC Go\u5feb\u901f\u5165\u95e8\u6307\u5357 \uff09\uff0c\u5219\u4f1a\u751f\u6210\u4ee3\u7801\u4ee5\u652f\u6301gRPC\u3002","title":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#go","text":"\u6b64\u9875\u9762\u51c6\u786e\u63cf\u8ff0\u4e86 protocol buffers \u7f16\u8bd1\u5668\u4e3a\u4efb\u4f55\u7ed9\u5b9a\u534f\u8bae\u5b9a\u4e49\u751f\u6210\u7684Go\u4ee3\u7801\u3002 proto2 \u548c proto3 \u751f\u6210\u7684\u4ee3\u7801\u4e4b\u95f4\u7684\u4efb\u4f55\u5dee\u5f02\u90fd\u4f1a\u7a81\u51fa\u663e\u793a\u3002\u8bf7\u6ce8\u610f\uff0c\u8fd9\u4e9b\u5dee\u5f02\u5728\u672c\u6587\u6863\u4e2d\u63cf\u8ff0\u7684\u751f\u6210\u4ee3\u7801\u4e2d\uff0c\u800c\u4e0d\u662f\u57fa\u672cAPI\uff0c\u4e24\u4e2a\u7248\u672c\u4e2d\u7684API\u76f8\u540c\u3002\u5728\u9605\u8bfb\u672c\u6587\u6863\u4e4b\u524d\uff0c\u5e94\u8be5\u9605\u8bfb proto2 \u8bed\u8a00\u6307\u5357 \u548c\u6216 proto3 \u8bed\u8a00\u6307\u5357 \u3002","title":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_1","text":"protocol buffers \u7f16\u8bd1\u5668\u9700\u8981\u4e00\u4e2a \u63d2\u4ef6\u751f\u6210Go\u4ee3\u7801 \u3002\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u6765\u5b89\u88c5\uff1a go get github.com/golang/protobuf/protoc-gen-go \u5728\u547d\u4ee4\u884c\u4e2d\u4f7f\u7528 --go_out \u6807\u5fd7\u65f6\uff0c\u7531 protoc \u7f16\u8bd1\u5668\u8c03\u7528 protoc-gen-go \u4e8c\u8fdb\u5236\u6587\u4ef6\u3002 --go_out \u6807\u5fd7\u544a\u8bc9\u7f16\u8bd1\u5668Go\u6e90\u6587\u4ef6\u8f93\u51fa\u4f4d\u7f6e\u3002\u7f16\u8bd1\u5668\u4e3a\u6bcf\u4e2a .proto \u6587\u4ef6\u521b\u5efa\u5355\u4e2a\u6e90\u6587\u4ef6\u3002 \u8f93\u51fa\u6587\u4ef6\u7684\u540d\u79f0\u662f\u8ba1\u7b97 .proto \u6587\u4ef6\u7684\u540d\u79f0\u5f97\u6765\u7684\uff0c\u5728\u4e24\u4e2a\u5730\u65b9\u53ef\u4ee5\u66f4\u6539\uff1a \u6269\u5c55\u540d\uff08 .proto \uff09\u66ff\u6362\u4e3a .pb.go \u3002\u4f8b\u5982\uff0c\u540d\u4e3a player_record.proto \u7684\u6587\u4ef6\u4f1a\u751f\u6210\u4e00\u4e2a\u540d\u4e3a player_record.pb.go \u7684\u8f93\u51fa\u6587\u4ef6\u3002 proto\u8def\u5f84\uff08\u4f7f\u7528 --proto_path \u6216 -I \u547d\u4ee4\u884c\u6807\u5fd7\u6307\u5b9a\uff09\u5c06\u66ff\u6362\u4e3a\u8f93\u51fa\u8def\u5f84\uff08\u4f7f\u7528 --go_out \u6807\u5fd7\u6307\u5b9a\uff09\u3002 \u5f53\u50cf\u4e0b\u9762\u8fd9\u6837\u8fd0\u884c proto \u7f16\u8bd1\u5668\u65f6\uff1a protoc --proto_path=src --go_out=build/gen src/foo.proto src/bar/baz.proto \u7f16\u8bd1\u5668\u5c06\u8bfb\u53d6 src/foo.proto \u548c src/bar/baz.proto \u6587\u4ef6\u3002\u5b83\u4ea7\u751f\u4e24\u4e2a\u8f93\u51fa\u6587\u4ef6\uff1a build/gen/foo.pb.go \u548c build/gen/bar/baz.pb.go \u3002 \u5982\u6709\u5fc5\u8981\uff0c\u7f16\u8bd1\u5668\u4f1a\u81ea\u52a8\u521b\u5efa build/gen/bar \u76ee\u5f55\uff0c\u4f46\u4e0d\u4f1a\u521b\u5efa build \u6216 build/gen \u76ee\u5f55\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u76ee\u5f55\u5fc5\u987b\u5df2\u7ecf\u5b58\u5728\u3002","title":"\u7f16\u8bd1\u5668\u8c03\u7528"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_2","text":"\u5982\u679c .proto \u6587\u4ef6\u4e2d\u6709 package \u58f0\u660e\uff0c\u5219\u751f\u6210\u7684\u4ee3\u7801\u4f7f\u7528proto\u7684 package \u58f0\u660e\u4f5c\u4e3a\u5176Go\u5305\u540d\u79f0\uff0c\u5176\u4e2d\u5c06 \".\" \u8f6c\u6362\u4e3a \"_\" \u3002\u4f8b\u5982\uff0c example.high_score \u7684proto\u7684 package \u540d\u79f0\u751f\u6210\u7684Go\u5305\u540d\u79f0\u4e3a example_high_score \u3002 \u53ef\u4ee5\u4f7f\u7528 .proto \u6587\u4ef6\u4e2d\u7684 go_package \u9009\u9879\u8986\u76d6\u7279\u5b9a .proto \u9ed8\u8ba4\u751f\u6210\u7684\u5305\u3002\u5982\u4e0b .proto \u6587\u4ef6\uff0c\u751f\u6210\u7684Go\u5305\u540d\u4e3a hs \u3002 package example.high_score; option go_package = hs ; \u5426\u5219\uff0c\u5982\u679c .proto \u6587\u4ef6\u4e0d\u5305\u542b package \u58f0\u660e\uff0c\u5219\u751f\u6210\u7684\u4ee3\u7801\u4f7f\u7528\u6587\u4ef6\u540d\uff08\u51cf\u53bb\u6269\u5c55\u540d\uff09\u4f5c\u4e3aGo\u5305\u540d\u79f0\uff0c\u5e76\u5c06 \".\" \u8f6c\u6362\u4e3a \"_\u201c \u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u540d\u4e3a high.score.proto \u7684proto\u5305\uff0c\u5176\u4e2d\u7684\u6ca1\u6709 package \u58f0\u660e\uff0c\u5c06\u751f\u6210\u5728 high_score \u5305\u4e2d\u751f\u6210\u4e00\u4e2a\u540d\u4e3a high.score.pb.go \u7684\u6587\u4ef6\u3002","title":"\u5305"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_3","text":"\u7ed9\u51fa\u4e00\u4e2a\u7b80\u5355\u7684\u6d88\u606f\u58f0\u660e\uff1a message Foo {} protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Foo \u7684\u7ed3\u6784\u548c\u4e00\u4e2a\u5b9e\u73b0\u4e86 Message \u63a5\u53e3\u7684 * Foo \u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u5185\u8054\u6ce8\u91ca\u3002 type Foo struct { } // Reset sets the proto's state to default values. func (m *Foo) Reset() { *m = Foo{} } // String returns a string representation of the proto. func (m *Foo) String() string { return proto.CompactTextString(m) } // ProtoMessage acts as a tag to make sure no one accidentally implements the // proto.Message interface. func (*Foo) ProtoMessage() {} \u8bf7\u6ce8\u610f\uff0c\u6240\u6709\u8fd9\u4e9b\u6210\u5458\u59cb\u7ec8\u5b58\u5728; optimize_for \u9009\u9879\u4e0d\u4f1a\u5f71\u54cdGo\u4ee3\u7801\u751f\u6210\u5668\u7684\u8f93\u51fa\u3002","title":"\u6d88\u606f"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_4","text":"\u53ef\u4ee5\u5728\u4e00\u4e2a\u6761\u6d88\u606f\u4e2d\u5d4c\u5957\u58f0\u660e\u53e6\u4e00\u4e2a\u6d88\u606f\u3002\u4f8b\u5982\uff1a message Foo { message Bar { } } \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7f16\u8bd1\u5668\u751f\u6210\u4e24\u4e2a\u7ed3\u6784\uff1a Foo \u548c Foo_Bar \u3002","title":"\u5d4c\u5957\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_5","text":"Protobufs \u5e26\u6709\u4e00\u7ec4\u9884\u5b9a\u4e49\u7684\u6d88\u606f\uff0c\u79f0\u4e3a \u77e5\u540d\u7c7b\u578b( WKT ) \u3002\u8fd9\u4e9b\u7c7b\u578b\u53ef\u4ee5\u7528\u4e8e\u4e0e\u5176\u4ed6\u670d\u52a1\u7684\u4e92\u64cd\u4f5c\u6027\uff0c\u6216\u8005\u4ec5\u4ec5\u56e0\u4e3a\u5b83\u4eec\u7b80\u6d01\u5730\u8868\u793a\u5e38\u89c1\u7684\u6709\u7528\u6a21\u5f0f\u3002 \u4f8b\u5982\uff0c Struct \u6d88\u606f\u8868\u793a\u4efb\u610fC\u98ce\u683c\u7684\u7ed3\u6784\u4f53\u3002 WKT \u7684\u9884\u751f\u6210Go\u4ee3\u7801\u4f5c\u4e3a Go protobuf \u5e93\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u5206\u53d1\uff0c\u5982\u679c\u4f7f\u7528 WKT \uff0c\u5219\u751f\u6210\u7684\u6d88\u606f\u7684Go\u4ee3\u7801\u4f1a\u5f15\u7528\u6b64\u4ee3\u7801\u3002\u4f8b\u5982\uff0c\u7ed9\u51fa\u5982\u4e0b\u6d88\u606f\uff1a import google/protobuf/struct.proto import google/protobuf/timestamp.proto message NamedStruct { string name = 1; google.protobuf.Struct definition = 2; google.protobuf.Timestamp last_modified = 3; } \u751f\u6210\u7684Go\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a import google_protobuf github.com/golang/protobuf/ptypes/struct import google_protobuf1 github.com/golang/protobuf/ptypes/timestamp ... type NamedStruct struct { Name string Definition *google_protobuf.Struct LastModified *google_protobuf1.Timestamp } \u4e00\u822c\u6765\u8bf4\uff0c\u4e0d\u9700\u8981\u5c06\u8fd9\u4e9b\u7c7b\u578b\u76f4\u63a5\u5bfc\u5165\u4ee3\u7801\u4e2d\u3002\u4f46\u662f\uff0c\u5982\u679c\u9700\u8981\u76f4\u63a5\u5f15\u7528\u5176\u4e2d\u4e00\u79cd\u7c7b\u578b\uff0c\u53ea\u9700\u5bfc\u5165 github.com/golang/protobuf/ptypes/[TYPE] \u5305\uff0c\u5e76\u6b63\u5e38\u4f7f\u7528\u8be5\u7c7b\u578b\u3002","title":"\u77e5\u540d\u7c7b\u578b"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_6","text":"protocol buffers \u7f16\u8bd1\u5668\u4e3a\u6d88\u606f\u4e2d\u5b9a\u4e49\u7684\u6bcf\u4e2a\u5b57\u6bb5\u751f\u6210\u7ed3\u6784\u4f53\u7684\u5b57\u6bb5\u3002\u8be5\u5b57\u6bb5\u7684\u786e\u5207\u6027\u8d28\u53d6\u51b3\u4e8e\u5b83\u7684\u7c7b\u578b\u4ee5\u53ca\u5b83\u662f\u5426\u662f singular , repeated , map \u6216\u8005 oneof \u5b57\u6bb5\u3002 \u8bf7\u6ce8\u610f\uff0c\u751f\u6210\u7684Go\u5b57\u6bb5\u540d\u79f0\u59cb\u7ec8\u4f7f\u7528\u5927\u9a7c\u5cf0\u5f0f\uff08CamelCase\uff09\u547d\u540d\uff0c\u5373\u4f7f .proto \u6587\u4ef6\u4e2d\u7684\u5b57\u6bb5\u540d\u79f0\u4f7f\u7528\u5e26\u6709\u4e0b\u5212\u7ebf\u7684\u5c0f\u5199\uff08 \u5e94\u8be5\u5982\u6b64 \uff09\u3002\u5927\u5c0f\u5199\u8f6c\u6362\u7684\u5de5\u4f5c\u539f\u7406\u5982\u4e0b\uff1a \u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f\u5bfc\u5165\u7684\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f\u4e0b\u5212\u7ebf\uff0c\u5219\u5c06\u5176\u5220\u9664\u5e76\u6dfb\u52a0\u5927\u5199\u5b57\u6bcd X \u3002 \u5982\u679c\u5185\u90e8\u4e0b\u5212\u7ebf\u540e\u8ddf\u5c0f\u5199\u5b57\u6bcd\uff0c\u5219\u5220\u9664\u4e0b\u5212\u7ebf\uff0c\u5e76\u5c06\u540e\u9762\u7684\u5b57\u6bcd\u5927\u5199\u3002 \u56e0\u6b64\uff1a \u539f\u5b57\u6bb5 foo_bar_baz \u5728Go\u4e2d\u53d8\u4e3a FooBarBaz \u539f\u5b57\u6bb5 _my_field_name_2 \u5728GO\u4e2d\u53d8\u4e3a XMyFieldName_2","title":"\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#proto2","text":"\u5bf9\u4e8e\u4ee5\u4e0b\u4efb\u4e00\u5b57\u6bb5\u5b9a\u4e49\uff1a optional int32 foo = 1; required int32 foo = 1; \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a\u7ed3\u6784\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u540d\u4e3a Foo \u7684 *int32 \u5b57\u6bb5\u548c\u4e00\u4e2a\u8bbf\u95ee\u5668\u65b9\u6cd5 GetFoo() \u5b83\u8fd4\u56de Foo \u4e2d\u7684 int32 \u503c\u6216\u9ed8\u8ba4\u503c\uff08\u5982\u679c\u8be5\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff09\u3002\u5982\u679c\u672a\u663e\u5f0f\u8bbe\u7f6e\u9ed8\u8ba4\u503c\uff0c\u5219\u4f7f\u7528\u8be5\u7c7b\u578b\u7684 \u96f6\u503c \uff080\u8868\u793a\u6570\u5b57\uff0c\u7a7a\u5b57\u7b26\u4e32\u8868\u793a\u5b57\u7b26\u4e32\uff09\u3002 \u5bf9\u4e8e\u5176\u4ed6\u6807\u91cf\u5b57\u6bb5\u7c7b\u578b\uff08\u5305\u62ec bool \uff0c bytes \u548c string \uff09\uff0c *int32 \u5c06\u6839\u636e \u6807\u91cf\u503c\u7c7b\u578b \u8868\u66ff\u6362\u4e3a\u76f8\u5e94\u7684Go\u7c7b\u578b\u3002","title":"\u5355\u4e2a\u6807\u91cf\u5b57\u6bb5 (proto2)"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#proto3","text":"\u5bf9\u4e8e\u6b64\u5b57\u6bb5\u5b9a\u4e49\uff1a int32 foo = 1; \u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Foo \u7684 int32 \u5b57\u6bb5\u548c\u4e00\u4e2a\u8bbf\u95ee\u5668\u65b9\u6cd5 GetFoo() \u7684\u7ed3\u6784\u4f53\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de Foo \u4e2d\u7684 int32 \u503c\u6216\u8be5\u5b57\u6bb5\u7684 \u96f6\u503c \uff0c\u5982\u679c\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff080\u8868\u793a\u6570\u5b57\uff0c\u5b57\u7b26\u4e32\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff09\u3002 \u5bf9\u4e8e\u5176\u4ed6\u6807\u91cf\u5b57\u6bb5\u7c7b\u578b\uff08\u5305\u62ec bool \uff0c bytes \u548c string \uff09\uff0c\u6839\u636e \u6807\u91cf\u503c\u7c7b\u578b \u5c06 int32 \u66ff\u6362\u4e3a\u76f8\u5e94\u7684Go\u7c7b\u578b\u3002proto\u4e2d\u7684\u672a\u8bbe\u7f6e\u503c\u5c06\u8868\u793a\u4e3a\u8be5\u7c7b\u578b\u7684 \u96f6\u503c \uff080\u8868\u793a\u6570\u5b57\uff0c\u7a7a\u5b57\u7b26\u4e32\u8868\u793a\u5b57\u7b26\u4e32\uff09\u3002","title":"\u5355\u4e2a\u6807\u91cf\u5b57\u6bb5 (proto3)"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_7","text":"\u7ed9\u5b9a\u6d88\u606f\u7c7b\u578b\uff1a message Bar {} \u5bf9\u4e8e\u5e26\u6709Bar\u5b57\u6bb5\u7684\u6d88\u606f: // proto2 message Baz { optional Bar foo = 1; // The generated code is the same result if required instead of optional. } // proto3 message Baz { Bar foo = 1; } \u7f16\u8bd1\u5668\u5c06\u751f\u6210Go\u7ed3\u6784: type Baz struct { Foo *Bar } \u6d88\u606f\u5b57\u6bb5\u53ef\u4ee5\u8bbe\u7f6e\u4e3a nil \uff0c\u8fd9\u610f\u5473\u7740\u8be5\u5b57\u6bb5\u672a\u8bbe\u7f6e\uff0c\u6709\u6548\u7684\u6e05\u9664\u8be5\u5b57\u6bb5\u3002\u8fd9\u4e0d\u7b49\u540c\u4e8e\u5c06\u503c\u8bbe\u7f6e\u4e3a\u6d88\u606f\u7ed3\u6784\u4f53\u7684\u201c\u7a7a\u201d\u5b9e\u4f8b\u3002 \u7f16\u8bd1\u5668\u8fd8\u751f\u6210\u4e00\u4e2a func(m * Baz)GetFoo() *Bar \u8f85\u52a9\u51fd\u6570\u3002\u8fd9\u4f7f\u5f97\u53ef\u4ee5\u5728\u6ca1\u6709\u4e2d\u95f4 nil \u68c0\u67e5\u7684\u60c5\u51b5\u4e0b\u94fe\u63a5\u83b7\u53d6\u8c03\u7528\u3002","title":"\u5355\u4e2a\u6d88\u606f\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#repeated","text":"\u6bcf\u4e2a repeated \u5b57\u6bb5\u751f\u6210\u4e00\u4e2a T \u5b57\u6bb5\u7684\u5207\u7247( slice )\u5728Go\u7ed3\u6784\u4e2d\uff0c\u5176\u4e2d T \u662f\u5b57\u6bb5\u7684\u5143\u7d20\u7c7b\u578b\u3002\u5982\u4e0b\u6d88\u606f\u5e26\u6709 repeated \u5b57\u6bb5: message Baz { repeated Bar foo = 1; } \u7f16\u8bd1\u5668\u751f\u6210Go\u7ed3\u6784\uff1a type Baz struct { Foo []*Bar } \u540c\u6837: \u5bf9\u4e8e\u5b57\u6bb5\u5b9a\u4e49 repeated bytes foo = 1 \uff1b\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Foo \u7684 [][]bytes \u5b57\u6bb5\u7684Go\u7ed3\u6784 \u5bf9\u4e8e\u91cd\u590d\u7684 \u679a\u4e3e repeated MyEnum bar = 2 \uff1b\u7f16\u8bd1\u5668\u5c06\u751f\u6210\u4e00\u4e2a\u5e26\u6709\u540d\u4e3a Bar \u7684 []MyEnum \u5b57\u6bb5\u7684Go\u7ed3\u6784","title":"Repeated\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#map","text":"\u6bcf\u4e2a map \u5b57\u6bb5\u4ee5\u7c7b\u578b map[TKey]TValue \u5728\u7ed3\u6784\u4f53\u4e2d\u751f\u6210\u4e00\u4e2a\u5b57\u6bb5\uff0c\u5176\u4e2d TKey \u662f\u5b57\u6bb5\u7684\u952e\u7c7b\u578b\uff0c TValue \u662f\u5b57\u6bb5\u7684\u503c\u7c7b\u578b\u3002\u5982\u4e0b\u6d88\u606f\u5e26\u6709 map \u5b57\u6bb5\uff1a message Bar {} message Baz { map string, Bar foo = 1; } \u7f16\u8bd1\u5668\u751f\u6210Go\u7ed3\u6784\uff1a type Baz struct { Foo map[string]*Bar }","title":"Map\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#oneof","text":"\u5bf9\u4e8e oneof \u5b57\u6bb5\uff0c protobuf \u7f16\u8bd1\u5668\u751f\u6210\u5177\u6709\u63a5\u53e3\u7c7b\u578b isMessageName_MyField \u7684\u5355\u72ec\u5b57\u6bb5\u3002\u5e76\u4e14\u8fd8\u4e3a oneof \u4e2d\u7684\u6bcf\u4e2a\u5355\u72ec\u5b57\u6bb5\u751f\u6210\u4e00\u4e2a\u7ed3\u6784\u4f53\u3002\u8fd9\u4e9b\u90fd\u5b9e\u73b0\u4e86\u8fd9\u4e2a isMessageName_MyField \u63a5\u53e3\u3002 \u5bf9\u4e8e\u5e26\u6709oneof\u5b57\u6bb5\u7684\u6b64\u6d88\u606f\uff1a package account; message Profile { oneof avatar { string image_url = 1; bytes image_data = 2; } } \u7f16\u8bd1\u5668\u751f\u6210\u7684\u7ed3\u6784\u4f53\uff1a type Profile struct { // Types that are valid to be assigned to Avatar: // *Profile_ImageUrl // *Profile_ImageData Avatar isProfile_Avatar `protobuf_oneof: avatar ` } type Profile_ImageUrl struct { ImageUrl string } type Profile_ImageData struct { ImageData []byte } *Profile_ImageUrl \u548c *Profile_ImageData \u90fd\u901a\u8fc7\u63d0\u4f9b\u7a7a\u7684 isProfile_Avatar() \u65b9\u6cd5\u6765\u5b9e\u73b0 isProfile_Avatar \u3002 \u4ee5\u4e0b\u793a\u4f8b\u663e\u793a\u5982\u4f55\u8bbe\u7f6e\u5b57\u6bb5\uff1a p1 := account.Profile{ Avatar: account.Profile_ImageUrl{ http://example.com/image.png }, } // imageData is []byte imageData := getImageData() p2 := account.Profile{ Avatar: account.Profile_ImageData{imageData}, } \u8981\u8bbf\u95ee\u8be5\u5b57\u6bb5\uff0c\u53ef\u4ee5\u4f7f\u7528\u503c\u4e0a\u7684\u7c7b\u578b\u5f00\u5173\u6765\u5904\u7406\u4e0d\u540c\u7684\u6d88\u606f\u7c7b\u578b\u3002 switch x := m.Avatar.(type) { case *account.Profile_ImageUrl: // Load profile image based on URL // using x.ImageUrl case *account.Profile_ImageData: // Load profile image based on bytes // using x.ImageData case nil: // The field is not set. default: return fmt.Errorf( Profile.Avatar has unexpected type %T , x) } \u7f16\u8bd1\u5668\u8fd8\u751f\u6210get\u65b9\u6cd5 func (m * Profile) GetImageUrl() string \u548c func (m * Profile) GetImageData() []byte \u3002\u6bcf\u4e2aget\u51fd\u6570\u8fd4\u56de\u8be5\u5b57\u6bb5\u7684\u503c\uff0c\u5982\u679c\u672a\u8bbe\u7f6e\u5219\u8fd4\u56de\u96f6\u503c\u3002","title":"Oneof\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_8","text":"\u7ed9\u51fa\u5982\u4e0b\u679a\u4e3e\uff1a message SearchRequest { enum Corpus { UNIVERSAL = 0; WEB = 1; IMAGES = 2; LOCAL = 3; NEWS = 4; PRODUCTS = 5; VIDEO = 6; } Corpus corpus = 1; ... } protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u4e00\u4e2a \u7c7b\u578b \u548c\u4e00\u7cfb\u5217\u8be5\u7c7b\u578b\u7684 \u5e38\u91cf \u3002 \u5bf9\u4e8e\u4e0a\u9762\u6d88\u606f\u4e2d\u7684\u679a\u4e3e\uff0c\u7c7b\u578b\u540d\u79f0\u4ee5\u6d88\u606f\u540d\u79f0\u5f00\u5934\uff1a type SearchRequest_Corpus int32 \u5bf9\u4e8e\u5305\u7ea7\u522b\u7684\u679a\u4e3e\uff1a enum Foo { DEFAULT_BAR = 0; BAR_BELLS = 1; BAR_B_CUE = 2; } Go\u751f\u6210\u7684\u7c7b\u578b\u540d\u79f0\u4ece\u672a\u4fee\u6539\u7684 proto \u679a\u4e3e\u540d\u79f0\u5f97\u6765: type Foo int32 \u6b64\u7c7b\u578b\u5177\u6709 String() \u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de\u7ed9\u5b9a\u503c\u7684\u540d\u79f0\u3002 Enum() \u65b9\u6cd5\u4f7f\u7528\u7ed9\u5b9a\u503c\u521d\u59cb\u5316\u65b0\u5206\u914d\u7684\u5185\u5b58\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u6307\u9488\uff1a func (Foo) Enum() *Foo protocol buffers \u7f16\u8bd1\u5668\u4e3a\u679a\u4e3e\u4e2d\u7684\u6bcf\u4e2a\u503c\u751f\u6210\u4e00\u4e2a\u5e38\u91cf\u3002\u5bf9\u4e8e\u6d88\u606f\u4e2d\u7684\u679a\u4e3e\uff0c\u5e38\u91cf\u4ee5\u6d88\u606f\u7684\u540d\u79f0\u5f00\u5934\uff1a const ( SearchRequest_UNIVERSAL SearchRequest_Corpus = 0 SearchRequest_WEB SearchRequest_Corpus = 1 SearchRequest_IMAGES SearchRequest_Corpus = 2 SearchRequest_LOCAL SearchRequest_Corpus = 3 SearchRequest_NEWS SearchRequest_Corpus = 4 SearchRequest_PRODUCTS SearchRequest_Corpus = 5 SearchRequest_VIDEO SearchRequest_Corpus = 6 ) \u5bf9\u4e8e\u5305\u7ea7\u522b\u7684\u679a\u4e3e\uff0c\u5e38\u91cf\u4ee5\u679a\u4e3e\u540d\u79f0\u5f00\u5934\uff1a const ( Foo_DEFAULT_BAR Foo = 0 Foo_BAR_BELLS Foo = 1 Foo_BAR_B_CUE Foo = 2 ) protobuf \u7f16\u8bd1\u5668\u8fd8\u751f\u6210\u4ece\u6574\u6570\u503c\u5230\u5b57\u7b26\u4e32\u540d\u79f0\u7684\u6620\u5c04\u4ee5\u53ca\u4ece\u540d\u79f0\u5230\u503c\u7684\u6620\u5c04\uff1a var Foo_name = map[int32]string{ 0: DEFAULT_BAR , 1: BAR_BELLS , 2: BAR_B_CUE , } var Foo_value = map[string]int32{ DEFAULT_BAR : 0, BAR_BELLS : 1, BAR_B_CUE : 2, } \u8bf7\u6ce8\u610f\uff0c .proto \u5141\u8bb8\u591a\u4e2a\u679a\u4e3e\u7b26\u53f7\u5177\u6709\u76f8\u540c\u7684\u6570\u503c\uff0c\u5177\u6709\u76f8\u540c\u6570\u503c\u7684\u7b26\u53f7\u662f\u540c\u4e49\u8bcd\u3002\u8fd9\u4e9b\u5728Go\u4e2d\u4ee5\u5b8c\u5168\u76f8\u540c\u7684\u65b9\u5f0f\u8868\u793a\uff0c\u591a\u4e2a\u540d\u79f0\u5bf9\u5e94\u4e8e\u76f8\u540c\u7684\u6570\u503c\u3002\u53cd\u5411\u6620\u5c04\u5305\u542b\u6570\u503c\u7684\u5355\u4e2a\u6761\u76ee\uff0c\u8be5\u6761\u76ee\u7b2c\u4e00\u4e2a\u51fa\u73b0\u5728 .proto \u6587\u4ef6\u4e2d\u3002","title":"\u679a\u4e3e"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#proto2_1","text":"\u6269\u5c55\u4ec5\u5b58\u5728\u4e8eproto2\u4e2d\u3002\u6709\u5173proto2\u6269\u5c55\u7684Go\u751f\u6210\u4ee3\u7801API\u7684\u6587\u6863\uff0c\u8bf7\u53c2\u9605proto\u5305 doc \u3002","title":"\u6269\u5c55\uff08proto2\uff09"},{"location":"Frameworks/Protocol-Buffers/08-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_9","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGo\u4ee3\u7801\u751f\u6210\u5668\u4e0d\u4f1a\u4e3a\u670d\u52a1\u751f\u6210\u8f93\u51fa\u3002\u5982\u679c\u542f\u7528 gRPC \u63d2\u4ef6\uff08\u8bf7\u53c2\u9605 gRPC Go\u5feb\u901f\u5165\u95e8\u6307\u5357 \uff09\uff0c\u5219\u4f1a\u751f\u6210\u4ee3\u7801\u4ee5\u652f\u6301gRPC\u3002","title":"\u670d\u52a1"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/","text":"proto3 \u89c4\u8303 \u8fd9\u662f Protocol Buffers \u8bed\u8a00\uff08 proto3 \uff09\u7b2c3\u7248\u7684\u8bed\u8a00\u89c4\u8303\u53c2\u8003\u3002\u4f7f\u7528Extended Backus-Naur Form\uff08EBNF\uff09\u6307\u5b9a\u8bed\u6cd5\uff1a | alternation () grouping [] option (zero or one time) {} repetition (any number of times) \u6709\u5173\u4f7f\u7528proto3\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u8bed\u8a00\u6307\u5357 \u3002 \u8bcd\u6c47\u5143\u7d20 \u5b57\u6bcd\u548c\u6570\u5b57 letter = A \u2026 Z | a \u2026 z decimalDigit = 0 \u2026 9 octalDigit = 0 \u2026 7 hexDigit = 0 \u2026 9 | A \u2026 F | a \u2026 f \u8eab\u4efd\u6807\u8bc6 ident = letter { letter | decimalDigit | _ } fullIdent = ident { . ident } messageName = ident enumName = ident fieldName = ident oneofName = ident mapName = ident serviceName = ident rpcName = ident messageType = [ . ] { ident . } messageName enumType = [ . ] { ident . } enumName \u6574\u6570 intLit = decimalLit | octalLit | hexLit decimalLit = ( 1 \u2026 9 ) { decimalDigit } octalLit = 0 { octalDigit } hexLit = 0 ( x | X ) hexDigit { hexDigit } \u6d6e\u70b9\u6570 floatLit = ( decimals . [ decimals ] [ exponent ] | decimals exponent | . decimals [ exponent ] ) | inf | nan decimals = decimalDigit { decimalDigit } exponent = ( e | E ) [ + | - ] decimals \u5e03\u5c14 boolLit = true | false \u5b57\u7b26\u4e32 strLit = ( ' { charValue } ' ) | ( ' ' { charValue } ' ' ) charValue = hexEscape | octEscape | charEscape | /[^\\0\\n\\\\]/ hexEscape = '\\' ( x | X ) hexDigit hexDigit octEscape = '\\' octalDigit octalDigit octalDigit charEscape = '\\' ( a | b | f | n | r | t | v | '\\' | ' | ' ' ) quote = ' | ' ' \u7a7a\u58f0\u660e emptyStatement = ; \u5e38\u91cf constant = fullIdent | ( [ - | + ] intLit ) | ( [ - | + ] floatLit ) | strLit | boolLit \u53e5\u6cd5 \u8bed\u6cd5( syntax )\u8bed\u53e5\u7528\u4e8e\u5b9a\u4e49 protobuf \u7248\u672c\u3002 syntax = syntax = quote proto3 quote ; # \u4f8b\u5982 syntax = proto3 ; \u5bfc\u5165\u8bed\u53e5 import \u8bed\u53e5\u7528\u4e8e\u5bfc\u5165\u53e6\u4e00\u4e2a .proto \u7684\u5b9a\u4e49\u3002 import = import [ weak | public ] strLit ; # \u4f8b\u5982 import public other.proto ; \u5305 \u5305\u8bf4\u660e\u7b26\u53ef\u7528\u4e8e\u9632\u6b62\u534f\u8bae\u6d88\u606f\u7c7b\u578b\u4e4b\u95f4\u7684\u540d\u79f0\u51b2\u7a81\u3002 package = package fullIdent ; # \u4f8b\u5982 package foo.bar; \u53ef\u7528\u9009\u9879 \u9009\u9879\u53ef\u7528\u4e8e proto \u6587\u4ef6\uff0c\u6d88\u606f\uff0c\u679a\u4e3e\u548c\u670d\u52a1\u3002\u53ef\u7528\u9009\u9879\u53ef\u4ee5\u662f protobuf \u5b9a\u4e49\u7684\u9009\u9879\u6216\u81ea\u5b9a\u4e49\u9009\u9879\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u8bed\u8a00\u6307\u5357\u4e2d\u7684\u9009\u9879 \u3002 option = option optionName = constant ; optionName = ( ident | ( fullIdent ) ) { . ident } // \u4f8b\u5982 option java_package = com.example.foo ; \u5b57\u6bb5 \u5b57\u6bb5\u662f protocol buffers \u6d88\u606f\u7684\u57fa\u672c\u5143\u7d20\u3002\u5b57\u6bb5\u53ef\u4ee5\u662f\u666e\u901a\u5b57\u6bb5\uff0c oneof \u5b57\u6bb5\u6216 map \u5b57\u6bb5\u3002\u5b57\u6bb5\u5177\u6709\u7c7b\u578b\u548c\u5b57\u6bb5\u7f16\u53f7\u3002 type = double | float | int32 | int64 | uint32 | uint64 | sint32 | sint64 | fixed32 | fixed64 | sfixed32 | sfixed64 | bool | string | bytes | messageType | enumType fieldNumber = intLit; \u666e\u901a\u5b57\u6bb5 \u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u7c7b\u578b\uff0c\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002\u5b83\u53ef\u80fd\u6709\u5b57\u6bb5\u9009\u9879\u3002 field = [ repeated ] type fieldName = fieldNumber [ [ fieldOptions ] ] ; fieldOptions = fieldOption { , fieldOption } fieldOption = optionName = constant // \u4f8b\u5982 foo.bar nested_message = 2; repeated int32 samples = 4 [packed=true]; Oneof \u96c6\u5408 oneof \u5b57\u6bb5 oneof \u7531 oneof \u5b57\u6bb5\u548c oneof \u540d\u79f0\u7ec4\u6210\u3002 oneof = oneof oneofName { { oneofField | emptyStatement } } oneofField = type fieldName = fieldNumber [ [ fieldOptions ] ] ; // \u4f8b\u5982 oneof foo { string name = 4; SubMessage sub_message = 9; } Map \u5b57\u6bb5 map \u5b57\u6bb5\u5177\u6709\u952e\u7c7b\u578b\uff0c\u503c\u7c7b\u578b\uff0c\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002\u952e\u7c7b\u578b\u53ef\u4ee5\u662f\u4efb\u4f55\u6574\u6570\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u3002 mapField = map keyType , type mapName = fieldNumber [ [ fieldOptions ] ] ; keyType = int32 | int64 | uint32 | uint64 | sint32 | sint64 | fixed32 | fixed64 | sfixed32 | sfixed64 | bool | string // \u4f8b\u5982 map string, Project projects = 3; \u4fdd\u7559\u7684(Reserved) \u4fdd\u7559\u8bed\u53e5\u58f0\u660e\u4e86\u4e00\u7cfb\u5217\u4e0d\u80fd\u5728\u6b64\u6d88\u606f\u4e2d\u4f7f\u7528\u7684\u5b57\u6bb5\u7f16\u53f7\u6216\u5b57\u6bb5\u540d\u79f0\u3002 reserved = reserved ( ranges | fieldNames ) ; ranges = range { , range } range = intLit [ to ( intLit | max ) ] fieldNames = fieldName { , fieldName } // \u4f8b\u5982 reserved 2, 15, 9 to 11; reserved foo , bar ; \u9876\u7ea7\u5b9a\u4e49 \u679a\u4e3e\u5b9a\u4e49 \u679a\u4e3e\u5b9a\u4e49\u7531\u540d\u79f0\u548c\u679a\u4e3e\u4e3b\u4f53\u7ec4\u6210\u3002\u679a\u4e3e\u4e3b\u4f53\u53ef\u4ee5\u6709\u9009\u9879\u548c\u679a\u4e3e\u5b57\u6bb5\u3002\u679a\u4e3e\u5b9a\u4e49\u5fc5\u987b\u4ee5\u679a\u4e3e\u503c\u96f6\u5f00\u59cb\u3002 enum = enum enumName enumBody enumBody = { { option | enumField | emptyStatement } } enumField = ident = intLit [ [ enumValueOption { , enumValueOption } ] ] ; enumValueOption = optionName = constant // \u4f8b\u5982 enum EnumAllowingAlias { option allow_alias = true; UNKNOWN = 0; STARTED = 1; RUNNING = 2 [(custom_option) = hello world ]; } \u6d88\u606f\u5b9a\u4e49 \u6d88\u606f\u7531\u6d88\u606f\u540d\u79f0\u548c\u6d88\u606f\u6b63\u6587\u7ec4\u6210\u3002\u6d88\u606f\u6b63\u6587\u53ef\u4ee5\u5305\u542b\u5b57\u6bb5\uff0c\u5d4c\u5957\u679a\u4e3e\u5b9a\u4e49\uff0c\u5d4c\u5957\u6d88\u606f\u5b9a\u4e49\uff0c\u53ef\u7528\u9009\u9879\uff0c oneof \u5b57\u6bb5\uff0c map \u5b57\u6bb5\u548c\u4fdd\u7559\u8bed\u53e5\u3002 message = message messageName messageBody messageBody = { { field | enum | message | option | oneof | mapField | reserved | emptyStatement } } // \u4f8b\u5982 message Outer { option (my_option).a = true; message Inner { // Level 2 int64 ival = 1; } map int32, string my_map = 2; } \u670d\u52a1\u5b9a\u4e49 service = service serviceName { { option | rpc | emptyStatement } } rpc = rpc rpcName ( [ stream ] messageType ) returns ( [ stream ] messageType ) (( { {option | emptyStatement } } ) | ; ) // \u4f8b\u5982 service SearchService { rpc Search (SearchRequest) returns (SearchResponse); } Proto \u6587\u4ef6 proto = syntax { import | package | option | topLevelDef | emptyStatement } topLevelDef = message | enum | service \u793a\u4f8b .proto \u6587\u4ef6 syntax = proto3 ; import public other.proto ; option java_package = com.example.foo ; enum EnumAllowingAlias { option allow_alias = true; UNKNOWN = 0; STARTED = 1; RUNNING = 2 [(custom_option) = hello world ]; } message outer { option (my_option).a = true; message inner { // Level 2 int64 ival = 1; } repeated inner inner_message = 2; EnumAllowingAlias enum_field =3; map int32, string my_map = 4; }","title":"`proto3`\u89c4\u8303"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#proto3","text":"\u8fd9\u662f Protocol Buffers \u8bed\u8a00\uff08 proto3 \uff09\u7b2c3\u7248\u7684\u8bed\u8a00\u89c4\u8303\u53c2\u8003\u3002\u4f7f\u7528Extended Backus-Naur Form\uff08EBNF\uff09\u6307\u5b9a\u8bed\u6cd5\uff1a | alternation () grouping [] option (zero or one time) {} repetition (any number of times) \u6709\u5173\u4f7f\u7528proto3\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u8bed\u8a00\u6307\u5357 \u3002","title":"proto3\u89c4\u8303"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_1","text":"","title":"\u8bcd\u6c47\u5143\u7d20"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_2","text":"letter = A \u2026 Z | a \u2026 z decimalDigit = 0 \u2026 9 octalDigit = 0 \u2026 7 hexDigit = 0 \u2026 9 | A \u2026 F | a \u2026 f","title":"\u5b57\u6bcd\u548c\u6570\u5b57"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_3","text":"ident = letter { letter | decimalDigit | _ } fullIdent = ident { . ident } messageName = ident enumName = ident fieldName = ident oneofName = ident mapName = ident serviceName = ident rpcName = ident messageType = [ . ] { ident . } messageName enumType = [ . ] { ident . } enumName","title":"\u8eab\u4efd\u6807\u8bc6"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_4","text":"intLit = decimalLit | octalLit | hexLit decimalLit = ( 1 \u2026 9 ) { decimalDigit } octalLit = 0 { octalDigit } hexLit = 0 ( x | X ) hexDigit { hexDigit }","title":"\u6574\u6570"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_5","text":"floatLit = ( decimals . [ decimals ] [ exponent ] | decimals exponent | . decimals [ exponent ] ) | inf | nan decimals = decimalDigit { decimalDigit } exponent = ( e | E ) [ + | - ] decimals","title":"\u6d6e\u70b9\u6570"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_6","text":"boolLit = true | false","title":"\u5e03\u5c14"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_7","text":"strLit = ( ' { charValue } ' ) | ( ' ' { charValue } ' ' ) charValue = hexEscape | octEscape | charEscape | /[^\\0\\n\\\\]/ hexEscape = '\\' ( x | X ) hexDigit hexDigit octEscape = '\\' octalDigit octalDigit octalDigit charEscape = '\\' ( a | b | f | n | r | t | v | '\\' | ' | ' ' ) quote = ' | ' '","title":"\u5b57\u7b26\u4e32"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_8","text":"emptyStatement = ;","title":"\u7a7a\u58f0\u660e"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_9","text":"constant = fullIdent | ( [ - | + ] intLit ) | ( [ - | + ] floatLit ) | strLit | boolLit","title":"\u5e38\u91cf"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_10","text":"\u8bed\u6cd5( syntax )\u8bed\u53e5\u7528\u4e8e\u5b9a\u4e49 protobuf \u7248\u672c\u3002 syntax = syntax = quote proto3 quote ; # \u4f8b\u5982 syntax = proto3 ;","title":"\u53e5\u6cd5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_11","text":"import \u8bed\u53e5\u7528\u4e8e\u5bfc\u5165\u53e6\u4e00\u4e2a .proto \u7684\u5b9a\u4e49\u3002 import = import [ weak | public ] strLit ; # \u4f8b\u5982 import public other.proto ;","title":"\u5bfc\u5165\u8bed\u53e5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_12","text":"\u5305\u8bf4\u660e\u7b26\u53ef\u7528\u4e8e\u9632\u6b62\u534f\u8bae\u6d88\u606f\u7c7b\u578b\u4e4b\u95f4\u7684\u540d\u79f0\u51b2\u7a81\u3002 package = package fullIdent ; # \u4f8b\u5982 package foo.bar;","title":"\u5305"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_13","text":"\u9009\u9879\u53ef\u7528\u4e8e proto \u6587\u4ef6\uff0c\u6d88\u606f\uff0c\u679a\u4e3e\u548c\u670d\u52a1\u3002\u53ef\u7528\u9009\u9879\u53ef\u4ee5\u662f protobuf \u5b9a\u4e49\u7684\u9009\u9879\u6216\u81ea\u5b9a\u4e49\u9009\u9879\u3002\u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u8bed\u8a00\u6307\u5357\u4e2d\u7684\u9009\u9879 \u3002 option = option optionName = constant ; optionName = ( ident | ( fullIdent ) ) { . ident } // \u4f8b\u5982 option java_package = com.example.foo ;","title":"\u53ef\u7528\u9009\u9879"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_14","text":"\u5b57\u6bb5\u662f protocol buffers \u6d88\u606f\u7684\u57fa\u672c\u5143\u7d20\u3002\u5b57\u6bb5\u53ef\u4ee5\u662f\u666e\u901a\u5b57\u6bb5\uff0c oneof \u5b57\u6bb5\u6216 map \u5b57\u6bb5\u3002\u5b57\u6bb5\u5177\u6709\u7c7b\u578b\u548c\u5b57\u6bb5\u7f16\u53f7\u3002 type = double | float | int32 | int64 | uint32 | uint64 | sint32 | sint64 | fixed32 | fixed64 | sfixed32 | sfixed64 | bool | string | bytes | messageType | enumType fieldNumber = intLit;","title":"\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_15","text":"\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u6709\u7c7b\u578b\uff0c\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002\u5b83\u53ef\u80fd\u6709\u5b57\u6bb5\u9009\u9879\u3002 field = [ repeated ] type fieldName = fieldNumber [ [ fieldOptions ] ] ; fieldOptions = fieldOption { , fieldOption } fieldOption = optionName = constant // \u4f8b\u5982 foo.bar nested_message = 2; repeated int32 samples = 4 [packed=true];","title":"\u666e\u901a\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#oneofoneof","text":"oneof \u7531 oneof \u5b57\u6bb5\u548c oneof \u540d\u79f0\u7ec4\u6210\u3002 oneof = oneof oneofName { { oneofField | emptyStatement } } oneofField = type fieldName = fieldNumber [ [ fieldOptions ] ] ; // \u4f8b\u5982 oneof foo { string name = 4; SubMessage sub_message = 9; }","title":"Oneof\u96c6\u5408oneof\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#map","text":"map \u5b57\u6bb5\u5177\u6709\u952e\u7c7b\u578b\uff0c\u503c\u7c7b\u578b\uff0c\u540d\u79f0\u548c\u5b57\u6bb5\u7f16\u53f7\u3002\u952e\u7c7b\u578b\u53ef\u4ee5\u662f\u4efb\u4f55\u6574\u6570\u6216\u5b57\u7b26\u4e32\u7c7b\u578b\u3002 mapField = map keyType , type mapName = fieldNumber [ [ fieldOptions ] ] ; keyType = int32 | int64 | uint32 | uint64 | sint32 | sint64 | fixed32 | fixed64 | sfixed32 | sfixed64 | bool | string // \u4f8b\u5982 map string, Project projects = 3;","title":"Map\u5b57\u6bb5"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#reserved","text":"\u4fdd\u7559\u8bed\u53e5\u58f0\u660e\u4e86\u4e00\u7cfb\u5217\u4e0d\u80fd\u5728\u6b64\u6d88\u606f\u4e2d\u4f7f\u7528\u7684\u5b57\u6bb5\u7f16\u53f7\u6216\u5b57\u6bb5\u540d\u79f0\u3002 reserved = reserved ( ranges | fieldNames ) ; ranges = range { , range } range = intLit [ to ( intLit | max ) ] fieldNames = fieldName { , fieldName } // \u4f8b\u5982 reserved 2, 15, 9 to 11; reserved foo , bar ;","title":"\u4fdd\u7559\u7684(Reserved)"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_16","text":"","title":"\u9876\u7ea7\u5b9a\u4e49"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_17","text":"\u679a\u4e3e\u5b9a\u4e49\u7531\u540d\u79f0\u548c\u679a\u4e3e\u4e3b\u4f53\u7ec4\u6210\u3002\u679a\u4e3e\u4e3b\u4f53\u53ef\u4ee5\u6709\u9009\u9879\u548c\u679a\u4e3e\u5b57\u6bb5\u3002\u679a\u4e3e\u5b9a\u4e49\u5fc5\u987b\u4ee5\u679a\u4e3e\u503c\u96f6\u5f00\u59cb\u3002 enum = enum enumName enumBody enumBody = { { option | enumField | emptyStatement } } enumField = ident = intLit [ [ enumValueOption { , enumValueOption } ] ] ; enumValueOption = optionName = constant // \u4f8b\u5982 enum EnumAllowingAlias { option allow_alias = true; UNKNOWN = 0; STARTED = 1; RUNNING = 2 [(custom_option) = hello world ]; }","title":"\u679a\u4e3e\u5b9a\u4e49"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_18","text":"\u6d88\u606f\u7531\u6d88\u606f\u540d\u79f0\u548c\u6d88\u606f\u6b63\u6587\u7ec4\u6210\u3002\u6d88\u606f\u6b63\u6587\u53ef\u4ee5\u5305\u542b\u5b57\u6bb5\uff0c\u5d4c\u5957\u679a\u4e3e\u5b9a\u4e49\uff0c\u5d4c\u5957\u6d88\u606f\u5b9a\u4e49\uff0c\u53ef\u7528\u9009\u9879\uff0c oneof \u5b57\u6bb5\uff0c map \u5b57\u6bb5\u548c\u4fdd\u7559\u8bed\u53e5\u3002 message = message messageName messageBody messageBody = { { field | enum | message | option | oneof | mapField | reserved | emptyStatement } } // \u4f8b\u5982 message Outer { option (my_option).a = true; message Inner { // Level 2 int64 ival = 1; } map int32, string my_map = 2; }","title":"\u6d88\u606f\u5b9a\u4e49"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#_19","text":"service = service serviceName { { option | rpc | emptyStatement } } rpc = rpc rpcName ( [ stream ] messageType ) returns ( [ stream ] messageType ) (( { {option | emptyStatement } } ) | ; ) // \u4f8b\u5982 service SearchService { rpc Search (SearchRequest) returns (SearchResponse); }","title":"\u670d\u52a1\u5b9a\u4e49"},{"location":"Frameworks/Protocol-Buffers/09-proto3\u89c4\u8303/#proto","text":"proto = syntax { import | package | option | topLevelDef | emptyStatement } topLevelDef = message | enum | service \u793a\u4f8b .proto \u6587\u4ef6 syntax = proto3 ; import public other.proto ; option java_package = com.example.foo ; enum EnumAllowingAlias { option allow_alias = true; UNKNOWN = 0; STARTED = 1; RUNNING = 2 [(custom_option) = hello world ]; } message outer { option (my_option).a = true; message inner { // Level 2 int64 ival = 1; } repeated inner inner_message = 2; EnumAllowingAlias enum_field =3; map int32, string my_map = 4; }","title":"Proto\u6587\u4ef6"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/","text":"gRPC RPC\u6846\u67b6\u539f\u7406 RPC\u6846\u67b6\u7684\u76ee\u6807\u5c31\u662f\u8ba9 \u8fdc\u7a0b\u670d\u52a1\u8c03\u7528\u66f4\u52a0\u7b80\u5355\u3001\u900f\u660e \uff0cRPC\u6846\u67b6\u8d1f\u8d23\u5c4f\u853d\u5e95\u5c42\u7684\u4f20\u8f93\u65b9\u5f0f\uff08 TCP \u6216\u8005 UDP \uff09\u3001\u5e8f\u5217\u5316\u65b9\u5f0f\uff08 XML / JSON / \u4e8c\u8fdb\u5236 \uff09\u548c\u901a\u4fe1\u7ec6\u8282\u3002\u670d\u52a1\u8c03\u7528\u8005\u53ef\u4ee5\u50cf\u8c03\u7528\u672c\u5730\u63a5\u53e3\u4e00\u6837\u8c03\u7528\u8fdc\u7a0b\u7684\u670d\u52a1\u63d0\u4f9b\u8005\uff0c\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u5e95\u5c42\u901a\u4fe1\u7ec6\u8282\u548c\u8c03\u7528\u8fc7\u7a0b\u3002 RPC\u6846\u67b6\u7684\u8c03\u7528\u539f\u7406\u56fe\u5982\u4e0b\u6240\u793a\uff1a \u4e3b\u6d41\u7684RPC\u6846\u67b6 \u4e1a\u754c\u4e3b\u6d41\u7684RPC\u6846\u67b6\u6574\u4f53\u4e0a\u5206\u4e3a\u4e09\u7c7b\uff1a \u652f\u6301 \u591a\u8bed\u8a00 \u7684RPC\u6846\u67b6: Google\u7684 gRPC Apache\uff08Facebook\uff09\u7684 Thrift \u53ea\u652f\u6301\u7279\u5b9a\u8bed\u8a00\u7684RPC\u6846\u67b6:\u65b0\u6d6a\u5fae\u535a\u7684 Motan \u652f\u6301 \u670d\u52a1\u6cbb\u7406 \u7b49\u670d\u52a1\u5316\u7279\u6027\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u6846\u67b6\uff0c\u5176\u5e95\u5c42\u5185\u6838\u4ecd\u7136\u662fRPC\u6846\u67b6:\u963f\u91cc\u7684 Dubbo \u968f\u7740\u5fae\u670d\u52a1\u7684\u53d1\u5c55\uff0c\u57fa\u4e8e\u8bed\u8a00\u4e2d\u7acb\u6027\u539f\u5219\u6784\u5efa\u5fae\u670d\u52a1\uff0c\u9010\u6e10\u6210\u4e3a\u4e00\u79cd\u4e3b\u6d41\u6a21\u5f0f\uff0c\u4f8b\u5982: \u5bf9\u4e8e\u540e\u7aef\u5e76\u53d1\u5904\u7406\u8981\u6c42\u9ad8\u7684\u5fae\u670d\u52a1\uff0c\u6bd4\u8f83\u9002\u5408\u91c7\u7528 Go\u8bed\u8a00 \u6784\u5efa \u5bf9\u4e8e\u524d\u7aef\u7684Web\u754c\u9762\uff0c\u5219\u66f4\u9002\u5408 Java \u548c JavaScript \u56e0\u6b64\uff0c\u57fa\u4e8e\u591a\u8bed\u8a00\u7684RPC\u6846\u67b6\u6765\u6784\u5efa\u5fae\u670d\u52a1\uff0c\u662f\u4e00\u79cd\u6bd4\u8f83\u597d\u7684\u6280\u672f\u9009\u62e9\u3002 \u4f8b\u5982Netflix\u7684API\u670d\u52a1\u7f16\u6392\u5c42\u548c\u540e\u7aef\u7684\u5fae\u670d\u52a1\u4e4b\u95f4\u5c31\u91c7\u7528gRPC\u8fdb\u884c\u901a\u4fe1\u3002 gRPC\u7b80\u4ecb \u672c\u6587\u6863\u4ecb\u7ecdgRPC\u548cprotocol buffers\uff0cgRPC\u53ef\u4ee5\u4f7f\u7528protocol buffers\u4f5c\u4e3a\u5176\u63a5\u53e3\u5b9a\u4e49\u8bed\u8a00\uff08Interface Definition Language,IDL\uff09\u548c\u5176\u57fa\u7840\u6d88\u606f\u4ea4\u6362\u683c\u5f0f\u3002 \u5728gRPC\u4e2d\uff0c\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u65b9\u6cd5\uff0c\u5c31\u50cf\u5b83\u662f\u672c\u5730\u5bf9\u8c61\u4e00\u6837\uff0c\u53ef\u4ee5\u66f4\u8f7b\u677e\u5730\u521b\u5efa\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u3002\u4e0e\u8bb8\u591aRPC\u7cfb\u7edf\u4e00\u6837\uff0cgRPC \u57fa\u4e8e\u5b9a\u4e49\u670d\u52a1\u7684\u601d\u60f3 \uff0c\u6307\u5b9a\u53ef\u4ee5\u4f7f\u7528\u5176\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u7684\u8fdc\u7a0b\u8c03\u7528\u65b9\u6cd5\u3002 \u5728\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u5668\u5b9e\u73b0\u6b64\u63a5\u53e3\u5e76\u8fd0\u884cgRPC\u670d\u52a1\u5668\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8c03\u7528 \u5728\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u6709\u4e00\u4e2a\u5b58\u6839\uff08\u5728\u67d0\u4e9b\u8bed\u8a00\u4e2d\u79f0\u4e3a\u5ba2\u6237\u7aef\uff09\uff0c\u5b83\u63d0\u4f9b\u4e0e\u670d\u52a1\u5668\u76f8\u540c\u7684\u65b9\u6cd5 gRPC\u7684\u8c03\u7528\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5404\u79cd\u73af\u5883\u4e2d\u76f8\u4e92\u8fd0\u884c\u548c\u901a\u4fe1\uff08\u4eceGoogle\u5185\u90e8\u7684\u670d\u52a1\u5668\u5230\u684c\u9762\u5e94\u7528\uff09\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55gRPC\u652f\u6301\u7684\u8bed\u8a00\u7f16\u5199\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u4f7f\u7528Go\uff0cPython\u6216Ruby\u8f7b\u677e\u521b\u5efagRPC\u5ba2\u6237\u7aef\u4e0e\u4f7f\u7528Java\u7f16\u5199\u7684gRPC\u670d\u52a1\u7aef\u901a\u4fe1\u3002\u6b64\u5916\uff0c\u6700\u65b0\u7684Google API\u5c06\u5177\u6709gRPC\u7248\u672c\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u8f7b\u677e\u5730\u5728\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6784\u5efaGoogle\u63d0\u4f9b\u7684\u529f\u80fd\u548c\u670d\u52a1\u3002 gRPC\u7279\u70b9 \u8bed\u8a00\u4e2d\u7acb\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\uff1b \u57fa\u4e8eIDL\u6587\u4ef6\u5b9a\u4e49\u670d\u52a1\uff0c\u901a\u8fc7protoc\u5de5\u5177\u751f\u6210\u6307\u5b9a\u8bed\u8a00\u7684\u6570\u636e\u7ed3\u6784\u3001\u670d\u52a1\u7aef\u63a5\u53e3\u4ee5\u53ca\u5ba2\u6237\u7aefStub\uff1b \u901a\u4fe1\u534f\u8bae\u57fa\u4e8e\u6807\u51c6\u7684HTTP/2\u8bbe\u8ba1\uff0c\u652f\u6301\u53cc\u5411\u6d41\u3001\u6d88\u606f\u5934\u538b\u7f29\u3001\u5355TCP\u7684\u591a\u8def\u590d\u7528\u3001\u670d\u52a1\u7aef\u63a8\u9001\u7b49\u7279\u6027\uff0c\u8fd9\u4e9b\u7279\u6027\u4f7f\u5f97gRPC\u5728\u79fb\u52a8\u7aef\u8bbe\u5907\u4e0a\u66f4\u52a0\u7701\u7535\u548c\u8282\u7701\u7f51\u7edc\u6d41\u91cf\uff1b \u5e8f\u5217\u5316\u652f\u6301PB\uff08ProtocolBuffer\uff09\u548cJSON\uff0cPB\u662f\u4e00\u79cd\u8bed\u8a00\u65e0\u5173\u7684\u9ad8\u6027\u80fd\u5e8f\u5217\u5316\u6846\u67b6\uff0c\u57fa\u4e8eHTTP/2 + PB\uff0c\u4fdd\u969c\u4e86RPC\u8c03\u7528\u7684\u9ad8\u6027\u80fd\u3002 \u4f7f\u7528Protocol Buffers \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \uff0c\u8fd9\u662fGoogle\u6210\u719f\u7684\u5f00\u6e90\u673a\u5236\uff0c\u7528\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u6570\u636e\uff08\u5c3d\u7ba1\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u683c\u5f0f\uff0c\u5982JSON\u4e00\u8d77\u4f7f\u7528\uff09\u3002 \u4f7f\u7528protocol buffers\u7684\u7b2c\u4e00\u6b65\u662f\uff0c\u5b9a\u4e49\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u5e8f\u5217\u5316\u7684\u6570\u636e\u7684\u7ed3\u6784\uff08\u8fd9\u662f\u4e00\u4e2a\u6269\u5c55\u540d\u4e3a .proto \u7684\u666e\u901a\u6587\u672c\u6587\u4ef6\uff09\u3002 protocol buffers\u4e2d\u7684\u6570\u636e\u88ab\u6784\u9020\u4e3a\u6d88\u606f\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6d88\u606f\u662f\u5305\u542b\u4e00\u7cfb\u5217\u79f0\u4e3a\u5b57\u6bb5\u7684\u952e\u503c\u7684\u903b\u8f91\u8bb0\u5f55\u3002\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a message Person { string name = 1; int32 id = 2; bool has_ponycopter = 3; } \u4e00\u65e6\u6307\u5b9a\u4e86\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528protocol buffers\u7f16\u8bd1\u5668 protoc \u4ece\u539f\u578b\u5b9a\u4e49\u751f\u6210 \u9996\u9009\u8bed\u8a00 \u7684 \u6570\u636e\u8bbf\u95ee\u7c7b : \u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u8bbf\u95ee\u5668\uff0c\u5982 name() \u548c set_name() \u5c06\u6574\u4e2a\u7ed3\u6784\u5e8f\u5217\u5316\u4e3a\u539f\u59cb\u5b57\u8282\u7684\u65b9\u6cd5 \u4f8b\u5982\uff0c\u5982\u679c\u9009\u62e9\u7684\u8bed\u8a00\u662fC++\uff0c\u5219\u8fd0\u884c\u7f16\u8bd1\u5668\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Person \u7684\u7c7b\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6b64\u7c7b\u6765\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22Person protocol buffers\u6d88\u606f\u3002 \u6b63\u5982\u5c06\u5728\u793a\u4f8b\u4e2d\u66f4\u8be6\u7ec6\u5730\u770b\u5230\u7684\u90a3\u6837\uff0c\u53ef\u4ee5\u5728\u666e\u901a\u7684proto\u6587\u4ef6\u4e2d\u5b9a\u4e49gRPC\u670d\u52a1\uff0c\u5e76\u5c06RPC\u65b9\u6cd5\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u6307\u5b9a\u4e3aprotocol buffers\u6d88\u606f\uff1a // \u670d\u52a1\u5b9a\u4e49 service Greeter { rpc SayHello (HelloRequest) returns (HelloReply) ; } // \u8bf7\u6c42\u6d88\u606f message HelloRequest { string name = 1; } // \u54cd\u5e94\u6d88\u606f message HelloReply { string message = 1; } gRPC\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5e26\u6709\u7279\u6b8agRPC\u63d2\u4ef6\u7684 protoc \u6765\u751f\u6210proto\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u3002\u5982\u679c\uff0c\u4f7f\u7528gRPC\u63d2\u4ef6\uff0c\u5c06\u83b7\u5f97\u751f\u6210\u7684gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801\uff0c\u4ee5\u53ca\u7528\u4e8e\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u6d88\u606f\u7c7b\u578b\u7684\u5e38\u89c4protocol buffers\u4ee3\u7801\u3002 \u53ef\u4ee5\u5728 Protocol Buffers\u6587\u6863 \u4e2d\u627e\u5230\u6709\u5173protocol buffers\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u5e76\u4e86\u89e3\u5982\u4f55\u4f7f\u7528\u6240\u9009\u8bed\u8a00\u7684\u5feb\u901f\u5165\u95e8\u6765\u83b7\u53d6\u548c\u5b89\u88c5\u5e26\u6709gRPC\u63d2\u4ef6\u7684 protoc \u3002 protocol buffers\u7684\u7248\u672c \u867d\u7136\u5728\u5f88\u65e9\u4e4b\u524d\uff0cprotocol buffers\u5df2\u7ecf\u53ef\u4f9b\u5f00\u6e90\u7528\u6237\u4f7f\u7528\uff0c\u4f46\u5728\u793a\u4f8b\u4e2d\u4f7f\u7528\u4e86\u4e00\u79cd\u65b0\u7684protocol buffers\uff0c\u79f0\u4e3aproto3\uff0c\u5b83\u5177\u6709\u7565\u5fae\u7b80\u5316\u7684\u8bed\u6cd5\uff0c\u4e00\u4e9b\u6709\u7528\u7684\u65b0\u529f\u80fd\uff0c\u5e76\u652f\u6301\u66f4\u591a\u8bed\u8a00\u3002 \u76ee\u524d\u63d0\u4f9bJava\uff0cC++\uff0cPython\uff0cObjective-C\uff0cC\uff03\uff0clite-runtime\uff08Android Java\uff09\uff0cRuby\u548cJavaScript\uff0c\u90fd\u6765\u81ea protocol buffers GitHub repo \uff0c\u4ee5\u53ca\u6765\u81ea golang/protobuf GitHub \u7684Go\u8bed\u8a00\u751f\u6210\u5668\uff0c\u8fd8\u6709\u66f4\u591a\u8bed\u8a00\u5728\u5f00\u53d1\u4e2d\u3002 \u53ef\u4ee5\u5728 proto3\u8bed\u8a00\u6307\u5357 \u548c\u6bcf\u79cd\u8bed\u8a00\u7684 \u53c2\u8003\u6587\u6863 \u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\uff0c \u53c2\u8003\u6587\u6863 \u8fd8\u5305\u62ec .proto \u6587\u4ef6\u683c\u5f0f\u7684\u6b63\u5f0f\u89c4\u8303\u3002 \u901a\u5e38\uff0c\u867d\u7136\u53ef\u4ee5\u4f7f\u7528proto2\uff08\u5f53\u524d\u7684\u9ed8\u8ba4protocol buffers\u7248\u672c\uff09\uff0c\u4f46\u5efa\u8bae\u5c06proto3\u4e0egRPC\u4e00\u8d77\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u4f7f\u7528\u5168\u7cfb\u5217\u7684gRPC\u652f\u6301\u7684\u8bed\u8a00\uff0c\u4ee5\u53ca\u907f\u514d\u4e0eproto2\u5ba2\u6237\u7aef\u4e0eproto3\u670d\u52a1\u7aef\u901a\u4fe1\u65f6\u7684\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002","title":"gRPC"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#grpc","text":"","title":"gRPC"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#rpc","text":"RPC\u6846\u67b6\u7684\u76ee\u6807\u5c31\u662f\u8ba9 \u8fdc\u7a0b\u670d\u52a1\u8c03\u7528\u66f4\u52a0\u7b80\u5355\u3001\u900f\u660e \uff0cRPC\u6846\u67b6\u8d1f\u8d23\u5c4f\u853d\u5e95\u5c42\u7684\u4f20\u8f93\u65b9\u5f0f\uff08 TCP \u6216\u8005 UDP \uff09\u3001\u5e8f\u5217\u5316\u65b9\u5f0f\uff08 XML / JSON / \u4e8c\u8fdb\u5236 \uff09\u548c\u901a\u4fe1\u7ec6\u8282\u3002\u670d\u52a1\u8c03\u7528\u8005\u53ef\u4ee5\u50cf\u8c03\u7528\u672c\u5730\u63a5\u53e3\u4e00\u6837\u8c03\u7528\u8fdc\u7a0b\u7684\u670d\u52a1\u63d0\u4f9b\u8005\uff0c\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u5e95\u5c42\u901a\u4fe1\u7ec6\u8282\u548c\u8c03\u7528\u8fc7\u7a0b\u3002 RPC\u6846\u67b6\u7684\u8c03\u7528\u539f\u7406\u56fe\u5982\u4e0b\u6240\u793a\uff1a","title":"RPC\u6846\u67b6\u539f\u7406"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#rpc_1","text":"\u4e1a\u754c\u4e3b\u6d41\u7684RPC\u6846\u67b6\u6574\u4f53\u4e0a\u5206\u4e3a\u4e09\u7c7b\uff1a \u652f\u6301 \u591a\u8bed\u8a00 \u7684RPC\u6846\u67b6: Google\u7684 gRPC Apache\uff08Facebook\uff09\u7684 Thrift \u53ea\u652f\u6301\u7279\u5b9a\u8bed\u8a00\u7684RPC\u6846\u67b6:\u65b0\u6d6a\u5fae\u535a\u7684 Motan \u652f\u6301 \u670d\u52a1\u6cbb\u7406 \u7b49\u670d\u52a1\u5316\u7279\u6027\u7684\u5206\u5e03\u5f0f\u670d\u52a1\u6846\u67b6\uff0c\u5176\u5e95\u5c42\u5185\u6838\u4ecd\u7136\u662fRPC\u6846\u67b6:\u963f\u91cc\u7684 Dubbo \u968f\u7740\u5fae\u670d\u52a1\u7684\u53d1\u5c55\uff0c\u57fa\u4e8e\u8bed\u8a00\u4e2d\u7acb\u6027\u539f\u5219\u6784\u5efa\u5fae\u670d\u52a1\uff0c\u9010\u6e10\u6210\u4e3a\u4e00\u79cd\u4e3b\u6d41\u6a21\u5f0f\uff0c\u4f8b\u5982: \u5bf9\u4e8e\u540e\u7aef\u5e76\u53d1\u5904\u7406\u8981\u6c42\u9ad8\u7684\u5fae\u670d\u52a1\uff0c\u6bd4\u8f83\u9002\u5408\u91c7\u7528 Go\u8bed\u8a00 \u6784\u5efa \u5bf9\u4e8e\u524d\u7aef\u7684Web\u754c\u9762\uff0c\u5219\u66f4\u9002\u5408 Java \u548c JavaScript \u56e0\u6b64\uff0c\u57fa\u4e8e\u591a\u8bed\u8a00\u7684RPC\u6846\u67b6\u6765\u6784\u5efa\u5fae\u670d\u52a1\uff0c\u662f\u4e00\u79cd\u6bd4\u8f83\u597d\u7684\u6280\u672f\u9009\u62e9\u3002 \u4f8b\u5982Netflix\u7684API\u670d\u52a1\u7f16\u6392\u5c42\u548c\u540e\u7aef\u7684\u5fae\u670d\u52a1\u4e4b\u95f4\u5c31\u91c7\u7528gRPC\u8fdb\u884c\u901a\u4fe1\u3002","title":"\u4e3b\u6d41\u7684RPC\u6846\u67b6"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#grpc_1","text":"\u672c\u6587\u6863\u4ecb\u7ecdgRPC\u548cprotocol buffers\uff0cgRPC\u53ef\u4ee5\u4f7f\u7528protocol buffers\u4f5c\u4e3a\u5176\u63a5\u53e3\u5b9a\u4e49\u8bed\u8a00\uff08Interface Definition Language,IDL\uff09\u548c\u5176\u57fa\u7840\u6d88\u606f\u4ea4\u6362\u683c\u5f0f\u3002 \u5728gRPC\u4e2d\uff0c\u5ba2\u6237\u7aef\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u4e0d\u540c\u8ba1\u7b97\u673a\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u65b9\u6cd5\uff0c\u5c31\u50cf\u5b83\u662f\u672c\u5730\u5bf9\u8c61\u4e00\u6837\uff0c\u53ef\u4ee5\u66f4\u8f7b\u677e\u5730\u521b\u5efa\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u3002\u4e0e\u8bb8\u591aRPC\u7cfb\u7edf\u4e00\u6837\uff0cgRPC \u57fa\u4e8e\u5b9a\u4e49\u670d\u52a1\u7684\u601d\u60f3 \uff0c\u6307\u5b9a\u53ef\u4ee5\u4f7f\u7528\u5176\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u7684\u8fdc\u7a0b\u8c03\u7528\u65b9\u6cd5\u3002 \u5728\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u5668\u5b9e\u73b0\u6b64\u63a5\u53e3\u5e76\u8fd0\u884cgRPC\u670d\u52a1\u5668\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8c03\u7528 \u5728\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u6709\u4e00\u4e2a\u5b58\u6839\uff08\u5728\u67d0\u4e9b\u8bed\u8a00\u4e2d\u79f0\u4e3a\u5ba2\u6237\u7aef\uff09\uff0c\u5b83\u63d0\u4f9b\u4e0e\u670d\u52a1\u5668\u76f8\u540c\u7684\u65b9\u6cd5 gRPC\u7684\u8c03\u7528\u793a\u4f8b\u5982\u4e0b\u6240\u793a\uff1a gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5404\u79cd\u73af\u5883\u4e2d\u76f8\u4e92\u8fd0\u884c\u548c\u901a\u4fe1\uff08\u4eceGoogle\u5185\u90e8\u7684\u670d\u52a1\u5668\u5230\u684c\u9762\u5e94\u7528\uff09\uff0c\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528\u4efb\u4f55gRPC\u652f\u6301\u7684\u8bed\u8a00\u7f16\u5199\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u4f7f\u7528Go\uff0cPython\u6216Ruby\u8f7b\u677e\u521b\u5efagRPC\u5ba2\u6237\u7aef\u4e0e\u4f7f\u7528Java\u7f16\u5199\u7684gRPC\u670d\u52a1\u7aef\u901a\u4fe1\u3002\u6b64\u5916\uff0c\u6700\u65b0\u7684Google API\u5c06\u5177\u6709gRPC\u7248\u672c\u7684\u63a5\u53e3\uff0c\u53ef\u4ee5\u8f7b\u677e\u5730\u5728\u7f16\u5199\u7684\u5e94\u7528\u7a0b\u5e8f\u4e2d\u6784\u5efaGoogle\u63d0\u4f9b\u7684\u529f\u80fd\u548c\u670d\u52a1\u3002","title":"gRPC\u7b80\u4ecb"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#grpc_2","text":"\u8bed\u8a00\u4e2d\u7acb\uff0c\u652f\u6301\u591a\u79cd\u8bed\u8a00\uff1b \u57fa\u4e8eIDL\u6587\u4ef6\u5b9a\u4e49\u670d\u52a1\uff0c\u901a\u8fc7protoc\u5de5\u5177\u751f\u6210\u6307\u5b9a\u8bed\u8a00\u7684\u6570\u636e\u7ed3\u6784\u3001\u670d\u52a1\u7aef\u63a5\u53e3\u4ee5\u53ca\u5ba2\u6237\u7aefStub\uff1b \u901a\u4fe1\u534f\u8bae\u57fa\u4e8e\u6807\u51c6\u7684HTTP/2\u8bbe\u8ba1\uff0c\u652f\u6301\u53cc\u5411\u6d41\u3001\u6d88\u606f\u5934\u538b\u7f29\u3001\u5355TCP\u7684\u591a\u8def\u590d\u7528\u3001\u670d\u52a1\u7aef\u63a8\u9001\u7b49\u7279\u6027\uff0c\u8fd9\u4e9b\u7279\u6027\u4f7f\u5f97gRPC\u5728\u79fb\u52a8\u7aef\u8bbe\u5907\u4e0a\u66f4\u52a0\u7701\u7535\u548c\u8282\u7701\u7f51\u7edc\u6d41\u91cf\uff1b \u5e8f\u5217\u5316\u652f\u6301PB\uff08ProtocolBuffer\uff09\u548cJSON\uff0cPB\u662f\u4e00\u79cd\u8bed\u8a00\u65e0\u5173\u7684\u9ad8\u6027\u80fd\u5e8f\u5217\u5316\u6846\u67b6\uff0c\u57fa\u4e8eHTTP/2 + PB\uff0c\u4fdd\u969c\u4e86RPC\u8c03\u7528\u7684\u9ad8\u6027\u80fd\u3002","title":"gRPC\u7279\u70b9"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#protocol-buffers","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \uff0c\u8fd9\u662fGoogle\u6210\u719f\u7684\u5f00\u6e90\u673a\u5236\uff0c\u7528\u4e8e\u5e8f\u5217\u5316\u7ed3\u6784\u5316\u6570\u636e\uff08\u5c3d\u7ba1\u5b83\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6570\u636e\u683c\u5f0f\uff0c\u5982JSON\u4e00\u8d77\u4f7f\u7528\uff09\u3002 \u4f7f\u7528protocol buffers\u7684\u7b2c\u4e00\u6b65\u662f\uff0c\u5b9a\u4e49\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u5e8f\u5217\u5316\u7684\u6570\u636e\u7684\u7ed3\u6784\uff08\u8fd9\u662f\u4e00\u4e2a\u6269\u5c55\u540d\u4e3a .proto \u7684\u666e\u901a\u6587\u672c\u6587\u4ef6\uff09\u3002 protocol buffers\u4e2d\u7684\u6570\u636e\u88ab\u6784\u9020\u4e3a\u6d88\u606f\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6d88\u606f\u662f\u5305\u542b\u4e00\u7cfb\u5217\u79f0\u4e3a\u5b57\u6bb5\u7684\u952e\u503c\u7684\u903b\u8f91\u8bb0\u5f55\u3002\u8fd9\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\uff1a message Person { string name = 1; int32 id = 2; bool has_ponycopter = 3; } \u4e00\u65e6\u6307\u5b9a\u4e86\u6570\u636e\u7ed3\u6784\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528protocol buffers\u7f16\u8bd1\u5668 protoc \u4ece\u539f\u578b\u5b9a\u4e49\u751f\u6210 \u9996\u9009\u8bed\u8a00 \u7684 \u6570\u636e\u8bbf\u95ee\u7c7b : \u4e3a\u6bcf\u4e2a\u5b57\u6bb5\u63d0\u4f9b\u4e86\u7b80\u5355\u7684\u8bbf\u95ee\u5668\uff0c\u5982 name() \u548c set_name() \u5c06\u6574\u4e2a\u7ed3\u6784\u5e8f\u5217\u5316\u4e3a\u539f\u59cb\u5b57\u8282\u7684\u65b9\u6cd5 \u4f8b\u5982\uff0c\u5982\u679c\u9009\u62e9\u7684\u8bed\u8a00\u662fC++\uff0c\u5219\u8fd0\u884c\u7f16\u8bd1\u5668\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u751f\u6210\u4e00\u4e2a\u540d\u4e3a Person \u7684\u7c7b\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u5728\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u6b64\u7c7b\u6765\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22Person protocol buffers\u6d88\u606f\u3002 \u6b63\u5982\u5c06\u5728\u793a\u4f8b\u4e2d\u66f4\u8be6\u7ec6\u5730\u770b\u5230\u7684\u90a3\u6837\uff0c\u53ef\u4ee5\u5728\u666e\u901a\u7684proto\u6587\u4ef6\u4e2d\u5b9a\u4e49gRPC\u670d\u52a1\uff0c\u5e76\u5c06RPC\u65b9\u6cd5\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u6307\u5b9a\u4e3aprotocol buffers\u6d88\u606f\uff1a // \u670d\u52a1\u5b9a\u4e49 service Greeter { rpc SayHello (HelloRequest) returns (HelloReply) ; } // \u8bf7\u6c42\u6d88\u606f message HelloRequest { string name = 1; } // \u54cd\u5e94\u6d88\u606f message HelloReply { string message = 1; } gRPC\u8fd8\u53ef\u4ee5\u4f7f\u7528\u5e26\u6709\u7279\u6b8agRPC\u63d2\u4ef6\u7684 protoc \u6765\u751f\u6210proto\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u3002\u5982\u679c\uff0c\u4f7f\u7528gRPC\u63d2\u4ef6\uff0c\u5c06\u83b7\u5f97\u751f\u6210\u7684gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801\uff0c\u4ee5\u53ca\u7528\u4e8e\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u6d88\u606f\u7c7b\u578b\u7684\u5e38\u89c4protocol buffers\u4ee3\u7801\u3002 \u53ef\u4ee5\u5728 Protocol Buffers\u6587\u6863 \u4e2d\u627e\u5230\u6709\u5173protocol buffers\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u5e76\u4e86\u89e3\u5982\u4f55\u4f7f\u7528\u6240\u9009\u8bed\u8a00\u7684\u5feb\u901f\u5165\u95e8\u6765\u83b7\u53d6\u548c\u5b89\u88c5\u5e26\u6709gRPC\u63d2\u4ef6\u7684 protoc \u3002","title":"\u4f7f\u7528Protocol Buffers"},{"location":"Frameworks/gRPC/01-gRPC\u7b80\u4ecb/#protocol-buffers_1","text":"\u867d\u7136\u5728\u5f88\u65e9\u4e4b\u524d\uff0cprotocol buffers\u5df2\u7ecf\u53ef\u4f9b\u5f00\u6e90\u7528\u6237\u4f7f\u7528\uff0c\u4f46\u5728\u793a\u4f8b\u4e2d\u4f7f\u7528\u4e86\u4e00\u79cd\u65b0\u7684protocol buffers\uff0c\u79f0\u4e3aproto3\uff0c\u5b83\u5177\u6709\u7565\u5fae\u7b80\u5316\u7684\u8bed\u6cd5\uff0c\u4e00\u4e9b\u6709\u7528\u7684\u65b0\u529f\u80fd\uff0c\u5e76\u652f\u6301\u66f4\u591a\u8bed\u8a00\u3002 \u76ee\u524d\u63d0\u4f9bJava\uff0cC++\uff0cPython\uff0cObjective-C\uff0cC\uff03\uff0clite-runtime\uff08Android Java\uff09\uff0cRuby\u548cJavaScript\uff0c\u90fd\u6765\u81ea protocol buffers GitHub repo \uff0c\u4ee5\u53ca\u6765\u81ea golang/protobuf GitHub \u7684Go\u8bed\u8a00\u751f\u6210\u5668\uff0c\u8fd8\u6709\u66f4\u591a\u8bed\u8a00\u5728\u5f00\u53d1\u4e2d\u3002 \u53ef\u4ee5\u5728 proto3\u8bed\u8a00\u6307\u5357 \u548c\u6bcf\u79cd\u8bed\u8a00\u7684 \u53c2\u8003\u6587\u6863 \u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\uff0c \u53c2\u8003\u6587\u6863 \u8fd8\u5305\u62ec .proto \u6587\u4ef6\u683c\u5f0f\u7684\u6b63\u5f0f\u89c4\u8303\u3002 \u901a\u5e38\uff0c\u867d\u7136\u53ef\u4ee5\u4f7f\u7528proto2\uff08\u5f53\u524d\u7684\u9ed8\u8ba4protocol buffers\u7248\u672c\uff09\uff0c\u4f46\u5efa\u8bae\u5c06proto3\u4e0egRPC\u4e00\u8d77\u4f7f\u7528\uff0c\u56e0\u4e3a\u5b83\u5141\u8bb8\u4f7f\u7528\u5168\u7cfb\u5217\u7684gRPC\u652f\u6301\u7684\u8bed\u8a00\uff0c\u4ee5\u53ca\u907f\u514d\u4e0eproto2\u5ba2\u6237\u7aef\u4e0eproto3\u670d\u52a1\u7aef\u901a\u4fe1\u65f6\u7684\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002","title":"protocol buffers\u7684\u7248\u672c"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/","text":"gRPC\u6982\u5ff5 \u672c\u6587\u6863\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u5173\u952e\u7684gRPC\u6982\u5ff5\uff0c\u6982\u8ff0\u4e86gRPC\u7684\u4f53\u7cfb\u7ed3\u6784\u548cRPC\u751f\u547d\u5468\u671f\u3002 \u5047\u8bbe\u5df2\u9605\u8bfb\u4e86\u4e0a\u6587 gRPC\u7b80\u4ecb \uff0c \u6709\u5173\u7279\u5b9a\u8bed\u8a00\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684\u5feb\u901f\u5165\u95e8\uff0c\u6559\u7a0b\u548c\u53c2\u8003\u6587\u6863\uff08\u5982\u679c\u6709\uff09\uff08\u5b8c\u6574\u7684\u53c2\u8003\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002 \u6982\u8ff0 \u670d\u52a1\u5b9a\u4e49 \u4e0e\u8bb8\u591aRPC\u7cfb\u7edf\u4e00\u6837\uff0cgRPC\u57fa\u4e8e\u5b9a\u4e49\u670d\u52a1\u7684\u601d\u60f3\uff0c\u6307\u5b9a\u53ef\u4ee5\u88ab\u8fdc\u7a0b\u8c03\u7528\u7684\u65b9\u6cd5\uff0c\u5305\u62ec\u65b9\u6cd5\u7684\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u63a5\u53e3\u5b9a\u4e49\u8bed\u8a00\uff08IDL\uff09\u6765\u63cf\u8ff0 \u670d\u52a1\u63a5\u53e3 \u548c \u6709\u6548\u6d88\u606f\u8d1f\u8f7d\u7684\u7ed3\u6784 \u3002\u5982\u679c\u9700\u8981\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u66ff\u4ee3\u65b9\u6848\u3002 service HelloService { rpc SayHello (HelloRequest) returns (HelloResponse); } message HelloRequest { string greeting = 1; } message HelloResponse { string reply = 1; } gRPC\u5141\u8bb8\u60a8\u5b9a\u4e49\u56db\u79cd\u670d\u52a1\u65b9\u6cd5\uff1a \u7b80\u5355RPC \uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\uff0c\u5c31\u50cf\u6b63\u5e38\u7684\u51fd\u6570\u8c03\u7528\u4e00\u6837\u3002 rpc SayHello(HelloRequest) returns (HelloResponse); \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u83b7\u53d6\u8fd4\u56de\u6d41\u4ee5\u8bfb\u53d6\u6d88\u606f\u5e8f\u5217\uff0c\u5ba2\u6237\u7aef\u4ece\u8fd4\u56de\u7684\u6d41\u4e2d\u8bfb\u53d6\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff0cgRPC\u4fdd\u8bc1\u5355\u4e2aRPC\u8c03\u7528\u4e2d\u7684\u6d88\u606f\u7684\u987a\u5e8f\u3002 rpc LotsOfReplies(HelloRequest) returns (stream HelloResponse); \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636ePC \uff0c\u5ba2\u6237\u7aef\u591a\u6b21\u4f7f\u7528\u63d0\u4f9b\u7684\u6d41\u5199\u5165\u4e00\u7cfb\u5217\u6d88\u606f\u5e76\u5c06\u5176\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002 \u4e00\u65e6\u5ba2\u6237\u7aef\u5199\u5b8c\u6d88\u606f\uff0c\u5b83\u5c31\u7b49\u5f85\u670d\u52a1\u7aef\u8bfb\u53d6\u5e76\u8fd4\u56de\u54cd\u5e94\uff0cgRPC\u4fdd\u8bc1\u5728\u5355\u4e2aRPC\u8c03\u7528\u4e2d\u7684\u6d88\u606f\u7684\u987a\u5e8f\u3002 rpc LotsOfGreetings(stream HelloRequest) returns (HelloResponse) ; \u53cc\u5411\u6d41\u6570\u636eRPC \uff0c\u53cc\u65b9\u4f7f\u7528\u8bfb\u5199\u6d41\u53d1\u9001\u4e00\u7cfb\u5217\u6d88\u606f\uff0c\u8fd9\u4e24\u4e2a\u6d41\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u6b64\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u559c\u6b22\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff08\u4f8b\u5982\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5199\u5165\u54cd\u5e94\u4e4b\u524d\u7b49\u5f85\u63a5\u6536\u6240\u6709\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u6216\u8005\u5b83\u53ef\u4ee5\u4ea4\u66ff\u5730\u8bfb\u53d6\u6d88\u606f\u7136\u540e\u5199\u5165\u6d88\u606f\uff0c\u6216\u8005\u5176\u4ed6\u4e00\u4e9b\u8bfb\u5199\u7ec4\u5408\uff09\u3002gRPC\u4fdd\u7559\u6bcf\u4e2a\u6d41\u4e2d\u7684\u6d88\u606f\u987a\u5e8f\u3002 rpc BidiHello(stream HelloRequest) returns (stream HelloResponse); \u6211\u4eec\u5c06\u5728\u4e0b\u9762\u7684RPC\u751f\u547d\u5468\u671f\u90e8\u5206\u4e2d\u66f4\u8be6\u7ec6\u5730\u4ecb\u7ecd\u4e0d\u540c\u7c7b\u578b\u7684RPC\u3002 \u4f7f\u7528API surface \u4ece .proto \u6587\u4ef6\u4e2d\u7684\u670d\u52a1\u5b9a\u4e49\u5f00\u59cb\uff0cgRPC\u63d0\u4f9b\u4e86\u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801\u7684 protocol buffers \u7f16\u8bd1\u5668\u63d2\u4ef6\u3002gRPC\u7528\u6237\u901a\u5e38\u5728\u5ba2\u6237\u7aef\u8c03\u7528\u8fd9\u4e9bAPI\uff0c\u5e76\u5728\u670d\u52a1\u7aef\u5b9e\u73b0\u76f8\u5e94\u7684API\u3002 \u5728 \u670d\u52a1\u7aef \u5b9e\u73b0\u670d\u52a1\u5b9a\u4e49\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\uff0c\u5e76\u8fd0\u884cgRPC\u670d\u52a1\u5668\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8c03\u7528\u3002gRPC\u6846\u67b6\u89e3\u7801\u4f20\u5165\u8bf7\u6c42\uff0c\u7136\u540e\u6267\u884c\u670d\u52a1\u7aef\u65b9\u6cd5\u5e76\u5c06\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u4fe1\u606f\u7f16\u7801\u540e\u8fd4\u56de\u3002 \u5728 \u5ba2\u6237\u7aef \u6709\u4e00\u4e2a\u79f0\u4e3a\u5b58\u6839\uff08stub\uff09\u7684\u672c\u5730\u5bf9\u8c61\uff08\u5bf9\u4e8e\u67d0\u4e9b\u8bed\u8a00\uff0c\u4e5f\u79f0\u4e3aclient\uff09\uff0c\u5b83\u5b9e\u73b0\u4e0e\u670d\u52a1\u7aef\u76f8\u540c\u7684\u65b9\u6cd5\uff0c\u7136\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4ec5\u5728\u672c\u5730\u5bf9\u8c61\u4e0a\u8c03\u7528\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u5e76\u5c06\u8c03\u7528\u7684\u65b9\u6cd5\u65f6\u7684\u53c2\u6570\u5305\u88c5\u5728\u5408\u9002\u7684 protocol buffers \u6d88\u606f\u7c7b\u578b\u4e2d\uff0cgRPC\u6846\u67b6\u5c06\u5305\u88c5\u597d\u7684\u8bf7\u6c42\u53d1\u9001\u5230\u670d\u52a1\u7aef\u5e76\u63a5\u6536\u670d\u52a1\u7aef protocol buffers \u54cd\u5e94\u7684\u8fd4\u56de\u6d88\u606f\u3002 \u540c\u6b65\u4e0e\u5f02\u6b65 \u540c\u6b65RPC\u8c03\u7528 \u5c06\u4f1a\u963b\u585e\u76f4\u5230\u6536\u5230\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u54cd\u5e94\uff0c\u8fd9\u662f\u6700\u63a5\u8fd1RPC\u6240\u671f\u671b\u7684 \u8fc7\u7a0b\u8c03\u7528\u62bd\u8c61 \u3002\u7f51\u7edc\u672c\u8d28\u4e0a\u662f\u5f02\u6b65\u7684\uff0c\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u80fd\u591f\u5728\u4e0d\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\u542f\u52a8RPC\u5c06\u975e\u5e38\u6709\u7528\u3002 \u5927\u591a\u6570\u8bed\u8a00\u7684gRPC\u7f16\u7a0bsurface\u90fd\u6709\u540c\u6b65\u548c\u5f02\u6b65\u4e24\u79cd\u7248\u672c\u3002\u53ef\u4ee5\u5728\u6bcf\u79cd\u8bed\u8a00\u7684\u6559\u7a0b\u548c\u53c2\u8003\u6587\u6863\u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\uff08\u5b8c\u6574\u7684\u53c2\u8003\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002 RPC\u751f\u547d\u5468\u671f \u73b0\u5728\u8ba9\u6211\u4eec\u4ed4\u7ec6\u770b\u770b\u5f53gRPC\u5ba2\u6237\u7aef\u8c03\u7528gRPC\u670d\u52a1\u7aef\u65b9\u6cd5\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u6211\u4eec\u4e0d\u4f1a\u67e5\u770b\u5b9e\u73b0\u7ec6\u8282\uff0c\u60a8\u53ef\u4ee5\u5728\u6211\u4eec\u7279\u5b9a\u8bed\u8a00\u7684\u9875\u9762\u4e2d\u627e\u5230\u6709\u5173\u8fd9\u4e9b\u5185\u5bb9\u7684\u66f4\u591a\u4fe1\u606f\u3002 \u7b80\u5355RPC \u9996\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u6700\u7b80\u5355\u7684RPC\u7c7b\u578b\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\u3002 \u5ba2\u6237\u7aef\u5728 stub/client \u5bf9\u8c61\u4e0a\u8c03\u7528\u65b9\u6cd5\u540e\uff0c\u5c06\u901a\u77e5\u670d\u52a1\u7aef\u6b64RPC\u8c03\u7528\u5df2\u88ab\u6fc0\u6d3b\uff0c\u901a\u77e5\u4e2d\u5c06\u5305\u542b\u6b64\u6b21\u8c03\u7528\u65f6\u5ba2\u6237\u7aef\u7684 \u5143\u6570\u636e \uff0c\u65b9\u6cd5\u540d\u79f0\u548c\u6307\u5b9a\u7684 \u622a\u6b62\u65f6\u95f4 \uff08\u5982\u679c\u6307\u5b9a\uff09\u3002 \u670d\u52a1\u7aef\u53ef\u4ee5\u7acb\u5373\u8fd4\u56de\u81ea\u5df1\u7684\u521d\u59cb\u5143\u6570\u636e\uff08\u5fc5\u987b\u5728\u8fd4\u56de\u4efb\u4f55\u54cd\u5e94\u6570\u636e\u4e4b\u524d\u53d1\u9001\uff09\uff0c\u6216\u8005\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\uff08\u9996\u5148\u7531\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\uff09\u3002 \u4e00\u65e6\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\uff0c\u5b83\u5c31\u4f1a\u6267\u884c\u521b\u5efa\u548c\u586b\u5145\u5176\u8fd4\u56de\u54cd\u5e94\u6240\u9700\u7684\u6240\u6709\u5de5\u4f5c\u3002\u7136\u540e\u5c06\u54cd\u5e94\u4e0e\u72b6\u6001\u8be6\u7ec6\u4fe1\u606f\uff08\u72b6\u6001\u4ee3\u7801\u548c\u53ef\u9009\u72b6\u6001\u6d88\u606f\uff09\u4ee5\u53ca\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\u4e00\u8d77\u8fd4\u56de\uff08\u5982\u679c\u6210\u529f\uff09\u5230\u5ba2\u6237\u7aef\u3002 \u5982\u679c\u72b6\u6001\u4e3aOK\uff0c\u5219\u5ba2\u6237\u7aef\u83b7\u53d6\u8fd4\u56de\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u5b8c\u6210\u5ba2\u6237\u7aef\u7684\u8c03\u7528\u3002 \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684 \u7b80\u5355RPC \uff0c\u53ea\u662f\u670d\u52a1\u5668\u5728\u83b7\u53d6\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\u540e\u8fd4\u56de\u54cd\u5e94\u6d41\u3002\u5728\u8fd4\u56de\u6240\u6709\u54cd\u5e94\u4e4b\u540e\uff0c\u670d\u52a1\u7aef\u72b6\u6001\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u72b6\u6001\u4ee3\u7801\u548c\u53ef\u9009\u72b6\u6001\u6d88\u606f\uff09\u548c\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\u90fd\u4e00\u8d77\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\uff0c\u6b64\u65f6\u670d\u52a1\u7aef\u6240\u6709\u64cd\u4f5c\u90fd\u5b8c\u6210\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u62e5\u6709\u6240\u6709\u670d\u52a1\u5668\u7684\u54cd\u5e94\uff0c\u5ba2\u6237\u7aef\u7684\u8c03\u7528\u5c31\u5b8c\u6210\u3002 \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC\u4e5f\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684 \u7b80\u5355RPC \uff0c\u53ea\u662f\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u7684\u662f\u8bf7\u6c42\u6d41\u800c\u4e0d\u662f\u5355\u4e2a\u8bf7\u6c42\u3002\u670d\u52a1\u5668\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\u4ee5\u53ca\u5176\u72b6\u6001\u8be6\u7ec6\u4fe1\u606f\u548c\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\uff0c\u901a\u5e38\u4e0d\u4e00\u5b9a\u5728\u6536\u5230\u6240\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42\u540e\u624d\u8fd4\u56de\u54cd\u5e94\u4fe1\u606f\u3002 \u53cc\u5411\u6d41\u6570\u636eRPC \u5728\u53cc\u5411\u6d41\u6570\u636eRPC\u4e2d\uff0c\u8c03\u7528\u7531\u8c03\u7528\u65b9\u6cd5\u7684\u5ba2\u6237\u7aef\u548c\u63a5\u6536\u5ba2\u6237\u7aef\u5143\u6570\u636e\u3001\u65b9\u6cd5\u540d\u79f0\u548c\u622a\u6b62\u65f6\u95f4\u7684\u670d\u52a1\u7aef\u542f\u52a8\u3002\u670d\u52a1\u7aef\u53ef\u4ee5\u9009\u62e9\u5148\u8fd4\u56de\u5176\u521d\u59cb\u5143\u6570\u636e\u6216\u7b49\u5f85\u5ba2\u6237\u7aef\u5f00\u59cb\u53d1\u9001\u8bf7\u6c42\u3002 \u63a5\u4e0b\u6765\u4f1a\u53d1\u751f\u4ec0\u4e48\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u56e0\u4e3a\u6d41\u662f\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u7684\u3002\u4f8b\u5982\uff1b \u670d\u52a1\u7aef\u53ef\u4ee5\u7b49\u5230\u5b83\u6536\u5230\u6240\u6709\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\u4e4b\u540e\u518d\u5199\u5165\u5176\u54cd\u5e94 \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7c7b\u4f3c\u201c\u4e52\u4e53\u7403\u201d\u7684\u65b9\u5f0f\u8fdb\u884c\u4ea4\u4e92\uff1a\u670d\u52a1\u7aef\u63a5\u6536\u8bf7\u6c42\uff0c\u7136\u540e\u8fd4\u56de\u54cd\u5e94\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u53d1\u9001\u53e6\u4e00\u4e2a\u57fa\u4e8e\u54cd\u5e94\u7684\u8bf7\u6c42\uff0c\u7b49\u7b49\u3002 \u622a\u6b62\u65e5\u671f/\u8d85\u65f6\u65f6\u95f4 gRPC\u5141\u8bb8\u5ba2\u6237\u7aef\u6307\u5b9a\u4e00\u4e2a\u613f\u610f\u7b49\u5f85RPC\u5b8c\u6210\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u8be5\u7b49\u5f85\u65f6\u95f4\u7528\u4e8e\u5728RPC\u4ee5\u9519\u8bef DEADLINE_EXCEEDED \u7ec8\u6b62\u4e4b\u524d\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\u3002\u5728\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u6765\u5224\u65ad\u7279\u5b9a\u7684RPC\u662f\u5426\u5df2\u8d85\u65f6\uff0c\u6216\u8005\u5269\u4f59\u591a\u5c11\u65f6\u95f4\u6765\u5b8c\u6210\u8be5RPC\u3002 \u6307\u5b9a\u622a\u6b62\u65e5\u671f\u6216\u8d85\u65f6\u65f6\u95f4\u7684\u65b9\u5f0f\u56e0\u7f16\u7a0b\u8bed\u8a00\u800c\u5f02\uff0c\u5e76\u975e\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u6709\u9ed8\u8ba4\u622a\u6b62\u65e5\u671f/\u8d85\u65f6\u65f6\u95f4\uff1a \u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u7684API\u652f\u6301\u8bbe\u7f6e\u622a\u6b62\u65e5\u671f\uff08\u56fa\u5b9a\u5230\u67d0\u4e2a\u65f6\u95f4\u70b9\uff09 \u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u7684API\u652f\u6301\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 \uff08\u6301\u7eed\u7684\u65f6\u95f4\u957f\u5ea6\uff09 RPC\u7ec8\u6b62 \u5728gRPC\u4e2d\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u4f1a\u5bf9\u662f\u5426\u8c03\u7528\u6210\u529f\u8fdb\u884c\u672c\u5730\u7684\u3001\u72ec\u7acb\u7684\u5224\u65ad\uff0c\u5e76\u4e14\u4e24\u8005\u5f97\u5230\u7684\u7ed3\u8bba\u5f88\u53ef\u80fd\u662f\u4e0d\u5339\u914d\u7684\u3002\u8fd9\u610f\u5473\u7740\uff1a \u5728\u670d\u52a1\u7aef\u6210\u529f\u5224\u65adRPC\u5b8c\u6210\uff08\u201c\u6211\u5df2\u7ecf\u53d1\u9001\u4e86\u6240\u6709\u54cd\u5e94\uff01\u201d\uff09\uff0c\u4f46\u5728\u5ba2\u6237\u7aef\u5224\u65adRPC\u5931\u8d25\uff08\u201c\u54cd\u5e94\u5728\u622a\u6b62\u65e5\u671f\u540e\u624d\u5230\u8fbe\uff01\u201d\uff09 \u5728\u5ba2\u6237\u7aef\u53d1\u9001\u6240\u6709\u8bf7\u6c42\u4e4b\u524d\uff0c\u670d\u52a1\u7aef\u5c31\u5df2\u7ecf\u5224\u65adRPC\u5b8c\u6210 \u53d6\u6d88RPC \u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u53ef\u4ee5\u968f\u65f6\u53d6\u6d88RPC\uff0c\u53d6\u6d88\u5c06\u7acb\u5373\u7ec8\u6b62RPC\uff0c\u4ee5\u4fbf\u4e0d\u518d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5de5\u4f5c\u3002\u53d6\u6d88\u64cd\u4f5c\u5e76\u4e0d\u662f\u201c\u64a4\u6d88\u201d\uff0c\u6240\u4ee5\u5728\u53d6\u6d88\u64cd\u4f5c\u4e4b\u524d\u6240\u505a\u7684\u66f4\u6539\u90fd\u5c06\u4e0d\u4f1a\u88ab\u56de\u6eda\u3002 \u5143\u6570\u636e \u5143\u6570\u636e\u662f\u5173\u4e8e\u7279\u5b9aRPC\u64cd\u4f5c\u7684\u4fe1\u606f\uff08\u4f8b\u5982 \u8eab\u4efd\u9a8c\u8bc1\u8be6\u7ec6\u4fe1\u606f \uff09\uff0c\u5b83\u4ee5\u952e\u503c\u5bf9\u5217\u8868\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u5176\u4e2d\u952e\u662f\u5b57\u7b26\u4e32\uff0c\u503c\u901a\u5e38\u4e5f\u662f\u5b57\u7b26\u4e32\uff08\u4f46\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u6570\u636e\uff09\u3002\u5143\u6570\u636e\u5bf9\u4e8egRPC\u6765\u8bf4\uff0c\u672c\u8eab\u4e5f\u662f\u4e0d\u900f\u660e\u7684\uff0c\u5b83\u5141\u8bb8\u5ba2\u6237\u7aef\u5728\u8c03\u7528\u662f\u63d0\u4f9b\u76f8\u5173\u4fe1\u606f\u7ed9\u670d\u52a1\u7aef\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002 \u5bf9\u5143\u6570\u636e\u7684\u8bbf\u95ee\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\u3002 \u901a\u9053 gRPC\u901a\u9053\u63d0\u4f9b\u4e0e\u7279\u5b9a\u4e3b\u673a\u548c\u7aef\u53e3\u4e0a\u7684gRPC\u670d\u52a1\u7aef\u7684\u4e00\u4e2a\u8fde\u63a5\uff0c\u901a\u5e38\u5728\u521b\u5efa\u5ba2\u6237\u7aef stub/client \u65f6\u4f7f\u7528\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u6307\u5b9a\u901a\u9053\u53c2\u6570\u6765\u4fee\u6539gRPC\u7684\u9ed8\u8ba4\u884c\u4e3a\uff0c\u4f8b\u5982\u6253\u5f00\u548c\u5173\u95ed\u6d88\u606f\u538b\u7f29\u3002\u901a\u9053\u5177\u6709\u72b6\u6001\uff0c\u5305\u62ec \u5df2\u8fde\u63a5 \u548c \u7a7a\u95f2 \u3002 gRPC\u5982\u4f55\u5904\u7406\u5173\u95ed\u901a\u9053\u4e0e\u7f16\u7a0b\u8bed\u8a00\u6709\u5173\u3002\u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u8fd8\u5141\u8bb8\u67e5\u8be2\u901a\u9053\u72b6\u6001\u3002","title":"gRPC\u6982\u5ff5"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#grpc","text":"\u672c\u6587\u6863\u4ecb\u7ecd\u4e86\u4e00\u4e9b\u5173\u952e\u7684gRPC\u6982\u5ff5\uff0c\u6982\u8ff0\u4e86gRPC\u7684\u4f53\u7cfb\u7ed3\u6784\u548cRPC\u751f\u547d\u5468\u671f\u3002 \u5047\u8bbe\u5df2\u9605\u8bfb\u4e86\u4e0a\u6587 gRPC\u7b80\u4ecb \uff0c \u6709\u5173\u7279\u5b9a\u8bed\u8a00\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6240\u9009\u8bed\u8a00\u7684\u5feb\u901f\u5165\u95e8\uff0c\u6559\u7a0b\u548c\u53c2\u8003\u6587\u6863\uff08\u5982\u679c\u6709\uff09\uff08\u5b8c\u6574\u7684\u53c2\u8003\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002","title":"gRPC\u6982\u5ff5"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_1","text":"","title":"\u6982\u8ff0"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_2","text":"\u4e0e\u8bb8\u591aRPC\u7cfb\u7edf\u4e00\u6837\uff0cgRPC\u57fa\u4e8e\u5b9a\u4e49\u670d\u52a1\u7684\u601d\u60f3\uff0c\u6307\u5b9a\u53ef\u4ee5\u88ab\u8fdc\u7a0b\u8c03\u7528\u7684\u65b9\u6cd5\uff0c\u5305\u62ec\u65b9\u6cd5\u7684\u53c2\u6570\u548c\u8fd4\u56de\u7c7b\u578b\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cgRPC\u4f7f\u7528 protocol buffers \u4f5c\u4e3a\u63a5\u53e3\u5b9a\u4e49\u8bed\u8a00\uff08IDL\uff09\u6765\u63cf\u8ff0 \u670d\u52a1\u63a5\u53e3 \u548c \u6709\u6548\u6d88\u606f\u8d1f\u8f7d\u7684\u7ed3\u6784 \u3002\u5982\u679c\u9700\u8981\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u66ff\u4ee3\u65b9\u6848\u3002 service HelloService { rpc SayHello (HelloRequest) returns (HelloResponse); } message HelloRequest { string greeting = 1; } message HelloResponse { string reply = 1; } gRPC\u5141\u8bb8\u60a8\u5b9a\u4e49\u56db\u79cd\u670d\u52a1\u65b9\u6cd5\uff1a \u7b80\u5355RPC \uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\uff0c\u5c31\u50cf\u6b63\u5e38\u7684\u51fd\u6570\u8c03\u7528\u4e00\u6837\u3002 rpc SayHello(HelloRequest) returns (HelloResponse); \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff0c\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u83b7\u53d6\u8fd4\u56de\u6d41\u4ee5\u8bfb\u53d6\u6d88\u606f\u5e8f\u5217\uff0c\u5ba2\u6237\u7aef\u4ece\u8fd4\u56de\u7684\u6d41\u4e2d\u8bfb\u53d6\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff0cgRPC\u4fdd\u8bc1\u5355\u4e2aRPC\u8c03\u7528\u4e2d\u7684\u6d88\u606f\u7684\u987a\u5e8f\u3002 rpc LotsOfReplies(HelloRequest) returns (stream HelloResponse); \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636ePC \uff0c\u5ba2\u6237\u7aef\u591a\u6b21\u4f7f\u7528\u63d0\u4f9b\u7684\u6d41\u5199\u5165\u4e00\u7cfb\u5217\u6d88\u606f\u5e76\u5c06\u5176\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002 \u4e00\u65e6\u5ba2\u6237\u7aef\u5199\u5b8c\u6d88\u606f\uff0c\u5b83\u5c31\u7b49\u5f85\u670d\u52a1\u7aef\u8bfb\u53d6\u5e76\u8fd4\u56de\u54cd\u5e94\uff0cgRPC\u4fdd\u8bc1\u5728\u5355\u4e2aRPC\u8c03\u7528\u4e2d\u7684\u6d88\u606f\u7684\u987a\u5e8f\u3002 rpc LotsOfGreetings(stream HelloRequest) returns (HelloResponse) ; \u53cc\u5411\u6d41\u6570\u636eRPC \uff0c\u53cc\u65b9\u4f7f\u7528\u8bfb\u5199\u6d41\u53d1\u9001\u4e00\u7cfb\u5217\u6d88\u606f\uff0c\u8fd9\u4e24\u4e2a\u6d41\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u6b64\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u559c\u6b22\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff08\u4f8b\u5982\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5199\u5165\u54cd\u5e94\u4e4b\u524d\u7b49\u5f85\u63a5\u6536\u6240\u6709\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u6216\u8005\u5b83\u53ef\u4ee5\u4ea4\u66ff\u5730\u8bfb\u53d6\u6d88\u606f\u7136\u540e\u5199\u5165\u6d88\u606f\uff0c\u6216\u8005\u5176\u4ed6\u4e00\u4e9b\u8bfb\u5199\u7ec4\u5408\uff09\u3002gRPC\u4fdd\u7559\u6bcf\u4e2a\u6d41\u4e2d\u7684\u6d88\u606f\u987a\u5e8f\u3002 rpc BidiHello(stream HelloRequest) returns (stream HelloResponse); \u6211\u4eec\u5c06\u5728\u4e0b\u9762\u7684RPC\u751f\u547d\u5468\u671f\u90e8\u5206\u4e2d\u66f4\u8be6\u7ec6\u5730\u4ecb\u7ecd\u4e0d\u540c\u7c7b\u578b\u7684RPC\u3002","title":"\u670d\u52a1\u5b9a\u4e49"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#api-surface","text":"\u4ece .proto \u6587\u4ef6\u4e2d\u7684\u670d\u52a1\u5b9a\u4e49\u5f00\u59cb\uff0cgRPC\u63d0\u4f9b\u4e86\u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801\u7684 protocol buffers \u7f16\u8bd1\u5668\u63d2\u4ef6\u3002gRPC\u7528\u6237\u901a\u5e38\u5728\u5ba2\u6237\u7aef\u8c03\u7528\u8fd9\u4e9bAPI\uff0c\u5e76\u5728\u670d\u52a1\u7aef\u5b9e\u73b0\u76f8\u5e94\u7684API\u3002 \u5728 \u670d\u52a1\u7aef \u5b9e\u73b0\u670d\u52a1\u5b9a\u4e49\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\uff0c\u5e76\u8fd0\u884cgRPC\u670d\u52a1\u5668\u6765\u5904\u7406\u5ba2\u6237\u7aef\u8c03\u7528\u3002gRPC\u6846\u67b6\u89e3\u7801\u4f20\u5165\u8bf7\u6c42\uff0c\u7136\u540e\u6267\u884c\u670d\u52a1\u7aef\u65b9\u6cd5\u5e76\u5c06\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u4fe1\u606f\u7f16\u7801\u540e\u8fd4\u56de\u3002 \u5728 \u5ba2\u6237\u7aef \u6709\u4e00\u4e2a\u79f0\u4e3a\u5b58\u6839\uff08stub\uff09\u7684\u672c\u5730\u5bf9\u8c61\uff08\u5bf9\u4e8e\u67d0\u4e9b\u8bed\u8a00\uff0c\u4e5f\u79f0\u4e3aclient\uff09\uff0c\u5b83\u5b9e\u73b0\u4e0e\u670d\u52a1\u7aef\u76f8\u540c\u7684\u65b9\u6cd5\uff0c\u7136\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u4ec5\u5728\u672c\u5730\u5bf9\u8c61\u4e0a\u8c03\u7528\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u5e76\u5c06\u8c03\u7528\u7684\u65b9\u6cd5\u65f6\u7684\u53c2\u6570\u5305\u88c5\u5728\u5408\u9002\u7684 protocol buffers \u6d88\u606f\u7c7b\u578b\u4e2d\uff0cgRPC\u6846\u67b6\u5c06\u5305\u88c5\u597d\u7684\u8bf7\u6c42\u53d1\u9001\u5230\u670d\u52a1\u7aef\u5e76\u63a5\u6536\u670d\u52a1\u7aef protocol buffers \u54cd\u5e94\u7684\u8fd4\u56de\u6d88\u606f\u3002","title":"\u4f7f\u7528API surface"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_3","text":"\u540c\u6b65RPC\u8c03\u7528 \u5c06\u4f1a\u963b\u585e\u76f4\u5230\u6536\u5230\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u54cd\u5e94\uff0c\u8fd9\u662f\u6700\u63a5\u8fd1RPC\u6240\u671f\u671b\u7684 \u8fc7\u7a0b\u8c03\u7528\u62bd\u8c61 \u3002\u7f51\u7edc\u672c\u8d28\u4e0a\u662f\u5f02\u6b65\u7684\uff0c\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u80fd\u591f\u5728\u4e0d\u963b\u585e\u5f53\u524d\u7ebf\u7a0b\u7684\u60c5\u51b5\u4e0b\u542f\u52a8RPC\u5c06\u975e\u5e38\u6709\u7528\u3002 \u5927\u591a\u6570\u8bed\u8a00\u7684gRPC\u7f16\u7a0bsurface\u90fd\u6709\u540c\u6b65\u548c\u5f02\u6b65\u4e24\u79cd\u7248\u672c\u3002\u53ef\u4ee5\u5728\u6bcf\u79cd\u8bed\u8a00\u7684\u6559\u7a0b\u548c\u53c2\u8003\u6587\u6863\u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\uff08\u5b8c\u6574\u7684\u53c2\u8003\u6587\u6863\u5373\u5c06\u63a8\u51fa\uff09\u3002","title":"\u540c\u6b65\u4e0e\u5f02\u6b65"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc","text":"\u73b0\u5728\u8ba9\u6211\u4eec\u4ed4\u7ec6\u770b\u770b\u5f53gRPC\u5ba2\u6237\u7aef\u8c03\u7528gRPC\u670d\u52a1\u7aef\u65b9\u6cd5\u65f6\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\u6211\u4eec\u4e0d\u4f1a\u67e5\u770b\u5b9e\u73b0\u7ec6\u8282\uff0c\u60a8\u53ef\u4ee5\u5728\u6211\u4eec\u7279\u5b9a\u8bed\u8a00\u7684\u9875\u9762\u4e2d\u627e\u5230\u6709\u5173\u8fd9\u4e9b\u5185\u5bb9\u7684\u66f4\u591a\u4fe1\u606f\u3002","title":"RPC\u751f\u547d\u5468\u671f"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_1","text":"\u9996\u5148\u8ba9\u6211\u4eec\u770b\u4e00\u4e0b\u6700\u7b80\u5355\u7684RPC\u7c7b\u578b\uff0c\u5ba2\u6237\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\u3002 \u5ba2\u6237\u7aef\u5728 stub/client \u5bf9\u8c61\u4e0a\u8c03\u7528\u65b9\u6cd5\u540e\uff0c\u5c06\u901a\u77e5\u670d\u52a1\u7aef\u6b64RPC\u8c03\u7528\u5df2\u88ab\u6fc0\u6d3b\uff0c\u901a\u77e5\u4e2d\u5c06\u5305\u542b\u6b64\u6b21\u8c03\u7528\u65f6\u5ba2\u6237\u7aef\u7684 \u5143\u6570\u636e \uff0c\u65b9\u6cd5\u540d\u79f0\u548c\u6307\u5b9a\u7684 \u622a\u6b62\u65f6\u95f4 \uff08\u5982\u679c\u6307\u5b9a\uff09\u3002 \u670d\u52a1\u7aef\u53ef\u4ee5\u7acb\u5373\u8fd4\u56de\u81ea\u5df1\u7684\u521d\u59cb\u5143\u6570\u636e\uff08\u5fc5\u987b\u5728\u8fd4\u56de\u4efb\u4f55\u54cd\u5e94\u6570\u636e\u4e4b\u524d\u53d1\u9001\uff09\uff0c\u6216\u8005\u7b49\u5f85\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\uff08\u9996\u5148\u7531\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\uff09\u3002 \u4e00\u65e6\u670d\u52a1\u7aef\u6536\u5230\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\uff0c\u5b83\u5c31\u4f1a\u6267\u884c\u521b\u5efa\u548c\u586b\u5145\u5176\u8fd4\u56de\u54cd\u5e94\u6240\u9700\u7684\u6240\u6709\u5de5\u4f5c\u3002\u7136\u540e\u5c06\u54cd\u5e94\u4e0e\u72b6\u6001\u8be6\u7ec6\u4fe1\u606f\uff08\u72b6\u6001\u4ee3\u7801\u548c\u53ef\u9009\u72b6\u6001\u6d88\u606f\uff09\u4ee5\u53ca\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\u4e00\u8d77\u8fd4\u56de\uff08\u5982\u679c\u6210\u529f\uff09\u5230\u5ba2\u6237\u7aef\u3002 \u5982\u679c\u72b6\u6001\u4e3aOK\uff0c\u5219\u5ba2\u6237\u7aef\u83b7\u53d6\u8fd4\u56de\u7684\u54cd\u5e94\uff0c\u4ece\u800c\u5b8c\u6210\u5ba2\u6237\u7aef\u7684\u8c03\u7528\u3002","title":"\u7b80\u5355RPC"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_2","text":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684 \u7b80\u5355RPC \uff0c\u53ea\u662f\u670d\u52a1\u5668\u5728\u83b7\u53d6\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\u540e\u8fd4\u56de\u54cd\u5e94\u6d41\u3002\u5728\u8fd4\u56de\u6240\u6709\u54cd\u5e94\u4e4b\u540e\uff0c\u670d\u52a1\u7aef\u72b6\u6001\u7684\u8be6\u7ec6\u4fe1\u606f\uff08\u72b6\u6001\u4ee3\u7801\u548c\u53ef\u9009\u72b6\u6001\u6d88\u606f\uff09\u548c\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\u90fd\u4e00\u8d77\u8fd4\u56de\u5230\u5ba2\u6237\u7aef\uff0c\u6b64\u65f6\u670d\u52a1\u7aef\u6240\u6709\u64cd\u4f5c\u90fd\u5b8c\u6210\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u62e5\u6709\u6240\u6709\u670d\u52a1\u5668\u7684\u54cd\u5e94\uff0c\u5ba2\u6237\u7aef\u7684\u8c03\u7528\u5c31\u5b8c\u6210\u3002","title":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_3","text":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC\u4e5f\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684 \u7b80\u5355RPC \uff0c\u53ea\u662f\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u5668\u53d1\u9001\u7684\u662f\u8bf7\u6c42\u6d41\u800c\u4e0d\u662f\u5355\u4e2a\u8bf7\u6c42\u3002\u670d\u52a1\u5668\u8fd4\u56de\u5355\u4e2a\u54cd\u5e94\u4ee5\u53ca\u5176\u72b6\u6001\u8be6\u7ec6\u4fe1\u606f\u548c\u53ef\u9009\u7684\u5c3e\u968f\u5143\u6570\u636e\uff0c\u901a\u5e38\u4e0d\u4e00\u5b9a\u5728\u6536\u5230\u6240\u6709\u5ba2\u6237\u7aef\u8bf7\u6c42\u540e\u624d\u8fd4\u56de\u54cd\u5e94\u4fe1\u606f\u3002","title":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_4","text":"\u5728\u53cc\u5411\u6d41\u6570\u636eRPC\u4e2d\uff0c\u8c03\u7528\u7531\u8c03\u7528\u65b9\u6cd5\u7684\u5ba2\u6237\u7aef\u548c\u63a5\u6536\u5ba2\u6237\u7aef\u5143\u6570\u636e\u3001\u65b9\u6cd5\u540d\u79f0\u548c\u622a\u6b62\u65f6\u95f4\u7684\u670d\u52a1\u7aef\u542f\u52a8\u3002\u670d\u52a1\u7aef\u53ef\u4ee5\u9009\u62e9\u5148\u8fd4\u56de\u5176\u521d\u59cb\u5143\u6570\u636e\u6216\u7b49\u5f85\u5ba2\u6237\u7aef\u5f00\u59cb\u53d1\u9001\u8bf7\u6c42\u3002 \u63a5\u4e0b\u6765\u4f1a\u53d1\u751f\u4ec0\u4e48\u53d6\u51b3\u4e8e\u5e94\u7528\u7a0b\u5e8f\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u56e0\u4e3a\u6d41\u662f\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u7684\u3002\u4f8b\u5982\uff1b \u670d\u52a1\u7aef\u53ef\u4ee5\u7b49\u5230\u5b83\u6536\u5230\u6240\u6709\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u6d88\u606f\u4e4b\u540e\u518d\u5199\u5165\u5176\u54cd\u5e94 \u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u53ef\u4ee5\u7c7b\u4f3c\u201c\u4e52\u4e53\u7403\u201d\u7684\u65b9\u5f0f\u8fdb\u884c\u4ea4\u4e92\uff1a\u670d\u52a1\u7aef\u63a5\u6536\u8bf7\u6c42\uff0c\u7136\u540e\u8fd4\u56de\u54cd\u5e94\uff0c\u7136\u540e\u5ba2\u6237\u7aef\u53d1\u9001\u53e6\u4e00\u4e2a\u57fa\u4e8e\u54cd\u5e94\u7684\u8bf7\u6c42\uff0c\u7b49\u7b49\u3002","title":"\u53cc\u5411\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_4","text":"gRPC\u5141\u8bb8\u5ba2\u6237\u7aef\u6307\u5b9a\u4e00\u4e2a\u613f\u610f\u7b49\u5f85RPC\u5b8c\u6210\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\uff0c\u8be5\u7b49\u5f85\u65f6\u95f4\u7528\u4e8e\u5728RPC\u4ee5\u9519\u8bef DEADLINE_EXCEEDED \u7ec8\u6b62\u4e4b\u524d\u7684\u6700\u957f\u7b49\u5f85\u65f6\u95f4\u3002\u5728\u670d\u52a1\u7aef\uff0c\u670d\u52a1\u5668\u53ef\u4ee5\u901a\u8fc7\u67e5\u8be2\u6765\u5224\u65ad\u7279\u5b9a\u7684RPC\u662f\u5426\u5df2\u8d85\u65f6\uff0c\u6216\u8005\u5269\u4f59\u591a\u5c11\u65f6\u95f4\u6765\u5b8c\u6210\u8be5RPC\u3002 \u6307\u5b9a\u622a\u6b62\u65e5\u671f\u6216\u8d85\u65f6\u65f6\u95f4\u7684\u65b9\u5f0f\u56e0\u7f16\u7a0b\u8bed\u8a00\u800c\u5f02\uff0c\u5e76\u975e\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u6709\u9ed8\u8ba4\u622a\u6b62\u65e5\u671f/\u8d85\u65f6\u65f6\u95f4\uff1a \u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u7684API\u652f\u6301\u8bbe\u7f6e\u622a\u6b62\u65e5\u671f\uff08\u56fa\u5b9a\u5230\u67d0\u4e2a\u65f6\u95f4\u70b9\uff09 \u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u7684API\u652f\u6301\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4 \uff08\u6301\u7eed\u7684\u65f6\u95f4\u957f\u5ea6\uff09","title":"\u622a\u6b62\u65e5\u671f/\u8d85\u65f6\u65f6\u95f4"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_5","text":"\u5728gRPC\u4e2d\uff0c\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u4f1a\u5bf9\u662f\u5426\u8c03\u7528\u6210\u529f\u8fdb\u884c\u672c\u5730\u7684\u3001\u72ec\u7acb\u7684\u5224\u65ad\uff0c\u5e76\u4e14\u4e24\u8005\u5f97\u5230\u7684\u7ed3\u8bba\u5f88\u53ef\u80fd\u662f\u4e0d\u5339\u914d\u7684\u3002\u8fd9\u610f\u5473\u7740\uff1a \u5728\u670d\u52a1\u7aef\u6210\u529f\u5224\u65adRPC\u5b8c\u6210\uff08\u201c\u6211\u5df2\u7ecf\u53d1\u9001\u4e86\u6240\u6709\u54cd\u5e94\uff01\u201d\uff09\uff0c\u4f46\u5728\u5ba2\u6237\u7aef\u5224\u65adRPC\u5931\u8d25\uff08\u201c\u54cd\u5e94\u5728\u622a\u6b62\u65e5\u671f\u540e\u624d\u5230\u8fbe\uff01\u201d\uff09 \u5728\u5ba2\u6237\u7aef\u53d1\u9001\u6240\u6709\u8bf7\u6c42\u4e4b\u524d\uff0c\u670d\u52a1\u7aef\u5c31\u5df2\u7ecf\u5224\u65adRPC\u5b8c\u6210","title":"RPC\u7ec8\u6b62"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#rpc_6","text":"\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u53ef\u4ee5\u968f\u65f6\u53d6\u6d88RPC\uff0c\u53d6\u6d88\u5c06\u7acb\u5373\u7ec8\u6b62RPC\uff0c\u4ee5\u4fbf\u4e0d\u518d\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5de5\u4f5c\u3002\u53d6\u6d88\u64cd\u4f5c\u5e76\u4e0d\u662f\u201c\u64a4\u6d88\u201d\uff0c\u6240\u4ee5\u5728\u53d6\u6d88\u64cd\u4f5c\u4e4b\u524d\u6240\u505a\u7684\u66f4\u6539\u90fd\u5c06\u4e0d\u4f1a\u88ab\u56de\u6eda\u3002","title":"\u53d6\u6d88RPC"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_5","text":"\u5143\u6570\u636e\u662f\u5173\u4e8e\u7279\u5b9aRPC\u64cd\u4f5c\u7684\u4fe1\u606f\uff08\u4f8b\u5982 \u8eab\u4efd\u9a8c\u8bc1\u8be6\u7ec6\u4fe1\u606f \uff09\uff0c\u5b83\u4ee5\u952e\u503c\u5bf9\u5217\u8868\u7684\u5f62\u5f0f\u5b58\u5728\uff0c\u5176\u4e2d\u952e\u662f\u5b57\u7b26\u4e32\uff0c\u503c\u901a\u5e38\u4e5f\u662f\u5b57\u7b26\u4e32\uff08\u4f46\u53ef\u4ee5\u662f\u4e8c\u8fdb\u5236\u6570\u636e\uff09\u3002\u5143\u6570\u636e\u5bf9\u4e8egRPC\u6765\u8bf4\uff0c\u672c\u8eab\u4e5f\u662f\u4e0d\u900f\u660e\u7684\uff0c\u5b83\u5141\u8bb8\u5ba2\u6237\u7aef\u5728\u8c03\u7528\u662f\u63d0\u4f9b\u76f8\u5173\u4fe1\u606f\u7ed9\u670d\u52a1\u7aef\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002 \u5bf9\u5143\u6570\u636e\u7684\u8bbf\u95ee\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\u3002","title":"\u5143\u6570\u636e"},{"location":"Frameworks/gRPC/02-gRPC\u6982\u5ff5/#_6","text":"gRPC\u901a\u9053\u63d0\u4f9b\u4e0e\u7279\u5b9a\u4e3b\u673a\u548c\u7aef\u53e3\u4e0a\u7684gRPC\u670d\u52a1\u7aef\u7684\u4e00\u4e2a\u8fde\u63a5\uff0c\u901a\u5e38\u5728\u521b\u5efa\u5ba2\u6237\u7aef stub/client \u65f6\u4f7f\u7528\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u6307\u5b9a\u901a\u9053\u53c2\u6570\u6765\u4fee\u6539gRPC\u7684\u9ed8\u8ba4\u884c\u4e3a\uff0c\u4f8b\u5982\u6253\u5f00\u548c\u5173\u95ed\u6d88\u606f\u538b\u7f29\u3002\u901a\u9053\u5177\u6709\u72b6\u6001\uff0c\u5305\u62ec \u5df2\u8fde\u63a5 \u548c \u7a7a\u95f2 \u3002 gRPC\u5982\u4f55\u5904\u7406\u5173\u95ed\u901a\u9053\u4e0e\u7f16\u7a0b\u8bed\u8a00\u6709\u5173\u3002\u67d0\u4e9b\u7f16\u7a0b\u8bed\u8a00\u8fd8\u5141\u8bb8\u67e5\u8be2\u901a\u9053\u72b6\u6001\u3002","title":"\u901a\u9053"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/","text":"\u8ba4\u8bc1 \u672c\u6587\u6863\u6982\u8ff0\u4e86gRPC\u8ba4\u8bc1\u673a\u5236\uff0c\u5305\u62ec\u5185\u7f6e\u652f\u6301\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff0c\u5982\u4f55\u63d2\u5165\u81ea\u5df1\u7684\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf\uff0c\u4ee5\u53ca\u5982\u4f55\u5728\u652f\u6301\u7684\u8bed\u8a00\u4e2d\u4f7f\u7528gRPC\u8ba4\u8bc1\u673a\u5236\u7684\u793a\u4f8b\u3002 \u6982\u8ff0 gRPC\u65e8\u5728\u4e0e\u5404\u79cd\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u8f7b\u677e\u5b89\u5168\u5730\u4f7f\u7528gRPC\u4e0e\u5176\u4ed6\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\u3002\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u652f\u6301\u7684\u673a\u5236\uff1a \u5e26\u6216\u4e0d\u5e26\u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u7684SSL/TLS \u901a\u8fc7\u6269\u5c55\u6211\u4eec\u63d0\u4f9b\u7684\u4ee3\u7801\u6765\u63d2\u5165\u81ea\u5df1\u7684\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf gRPC\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1API\uff0c\u5141\u8bb8\u5728\u521b\u5efa\u901a\u9053\u6216\u53d1\u8d77\u8c03\u7528\u65f6\u63d0\u4f9b\u6240\u6709\u5fc5\u8981\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u4f5c\u4e3a\u51ed\u636e\u3002 \u652f\u6301\u7684\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236 gRPC\u5185\u7f6e\u4e86\u4ee5\u4e0b\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff1a SSL/TLS \uff1agRPC\u96c6\u6210\u4e86SSL/TLS\uff0c\u5e76\u63a8\u8350\u4f7f\u7528SSL/TLS\u5bf9\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u5bf9\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4e4b\u95f4\u4ea4\u6362\u7684\u6240\u6709\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\u3002\u53ef\u9009\u673a\u5236\u53ef\u4f9b\u5ba2\u6237\u7aef\u63d0\u4f9b\u76f8\u4e92\u8eab\u4efd\u9a8c\u8bc1\u7684\u8bc1\u4e66\u3002 \u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1 \uff1agRPC\u63d0\u4f9b\u4e86\u4e00\u79cd\u901a\u7528\u673a\u5236\uff08\u5982\u4e0b\u6240\u8ff0\uff09\uff0c\u7528\u4e8e\u5c06\u57fa\u4e8e\u51ed\u636e\u7684\u5143\u6570\u636e\u9644\u52a0\u5230\u8bf7\u6c42\u548c\u54cd\u5e94\u4e2d\u3002\u6b64\u5916\uff0c\u67d0\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u6d41\u7a0b\u63d0\u4f9b\u4e86\u901a\u8fc7gRPC\u8bbf\u95eeGoogle API\u65f6\u83b7\u53d6\u8bbf\u95ee\u4ee4\u724c\uff08\u4f8b\u5982\uff0cOAuth2\u4ee4\u724c\uff09\u7684\u652f\u6301\uff1a\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\u770b\u5230\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u3002\u901a\u5e38\uff0c\u5fc5\u987b\u4f7f\u7528\u6b64\u673a\u5236\u5c31\u50cf\u5fc5\u987b\u5728\u901a\u9053\u4e0a\u4f7f\u7528SSL/TLS\uff08Google\u4e0d\u5141\u8bb8\u6ca1\u6709SSL/TLS\u7684\u8fde\u63a5\uff09\uff0c\u5e76\u4e14\u5927\u591a\u6570\u5b9e\u73b0gRPC\u7684\u7f16\u7a0b\u8bed\u73b0\u90fd\u4e0d\u5141\u8bb8\u5728\u672a\u52a0\u5bc6\u7684\u901a\u9053\u4e0a\u53d1\u9001\u51ed\u636e\u3002 \u8b66\u544a \uff1aGoogle\u51ed\u636e\u53ea\u80fd\u7528\u4e8e\u8fde\u63a5Google\u670d\u52a1\u3002\u5c06Google\u53d1\u5e03\u7684OAuth2\u4ee4\u724c\u53d1\u9001\u5230\u975eGoogle\u670d\u52a1\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6b64\u4ee4\u724c\u88ab\u76d7\u5e76\u7528\u4e8e\u5192\u5145\u5ba2\u6237\u7aef\u8bbf\u95eeGoogle\u670d\u52a1\u3002 \u8ba4\u8bc1API gRPC\u63d0\u4f9b\u57fa\u4e8e\u51ed\u636e\u5bf9\u8c61\u7edf\u4e00\u6982\u5ff5\u7684\u7b80\u5355\u8ba4\u8bc1API\uff0c\u53ef\u5728\u521b\u5efa\u6574\u4e2agRPC\u901a\u9053\u6216\u5355\u4e2a\u8bf7\u6c42\u65f6\u4f7f\u7528\u3002 \u51ed\u636e\u7c7b\u578b \u51ed\u636e\u6709\u4e24\u79cd\u7c7b\u578b\uff1a \u901a\u9053\u51ed\u636e\uff08 ChannelCredentials \uff09 \uff1a\u9644\u52a0\u5230\u4e00\u4e2a\u901a\u9053\u4e0a\uff0c\u4f8b\u5982SSL\u51ed\u636e \u8c03\u7528\u51ed\u636e\uff08 CallCredentials \uff09 \uff1a\u9644\u52a0\u5230\u4e00\u4e2a\u8c03\u7528\u4e0a\uff08\u6216\u8005\u662fC++\u4e2d\u7684 ClientContext \uff09 \u8fd8\u53ef\u4ee5\u5728\u7efc\u5408\u901a\u9053\u51ed\u636e\uff08 CompositeChannelCredentials \uff09\u4e2d\u7ec4\u5408\u4f7f\u7528\u8fd9\u4e24\u79cd\u51ed\u636e\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u6307\u5b9a\u901a\u9053\u7684SSL\u4ee5\u53ca\u5728\u901a\u9053\u4e2d\u8fdb\u884c\u7684\u6bcf\u4e2a\u8c03\u7528\u7684\u8c03\u7528\u51ed\u636e\u3002 \u7efc\u5408\u901a\u9053\u51ed\u636e\u5c06\u901a\u9053\u51ed\u636e\u4e0e\u8c03\u7528\u51ed\u636e\u76f8\u5173\u8054\uff0c\u4ee5\u521b\u5efa\u65b0\u7684\u901a\u9053\u51ed\u636e\u3002\u7ed3\u679c\u5c31\u662f\u5c06\u53d1\u9001\u4e0e\u5728\u901a\u9053\u4e0a\u8fdb\u884c\u7684\u6bcf\u6b21\u8c03\u7528\u76f8\u5173\u8054\u7684\u8c03\u7528\u51ed\u636e\u7ec4\u5408\u800c\u6210\u7684\u8ba4\u8bc1\u6570\u636e\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u4ece SslCredentials \u548c AccessTokenCredentials \u521b\u5efa\u901a\u9053\u51ed\u636e\u3002\u7ed3\u679c\u5c31\u662f\u5f53\u5e94\u7528\u5728\u4e00\u4e2a\u901a\u9053\u65f6\u5c06\u4e3a\u6b64\u901a\u9053\u4e0a\u7684\u6bcf\u4e2a\u8c03\u7528\u53d1\u9001\u76f8\u5e94\u7684\u8bbf\u95ee\u4ee4\u724c\uff08token\uff09\u3002 \u5355\u4e2a\u8c03\u7528\u51ed\u636e\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7efc\u5408\u8c03\u7528\u51ed\u636e\uff08 CompositeCallCredentials \uff09\u7ec4\u6210\u3002\u5728\u4e00\u4e2a\u8c03\u7528\u4e2d\u4f7f\u7528\u7efc\u5408\u8c03\u7528\u51ed\u636e\u751f\u6210\u7684\u8c03\u7528\u51ed\u636e\u65f6\uff0c\u5c06\u89e6\u53d1\u53d1\u9001\u4e0e\u4e24\u4e2a\u8c03\u7528\u51ed\u636e\u5173\u8054\u7684\u8ba4\u8bc1\u6570\u636e\u3002 \u4f7f\u7528\u5ba2\u6237\u7aefSSL/TLS \u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u51ed\u636e\u5982\u4f55\u4e0e\u6211\u4eec\u652f\u6301\u7684\u8ba4\u8bc1\u673a\u5236\u4e00\u8d77\u5de5\u4f5c\u3002\u8fd9\u662f\u6700\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6848\uff0c\u5ba2\u6237\u7aef\u53ea\u60f3\u9a8c\u8bc1\u670d\u52a1\u7aef\u5e76\u52a0\u5bc6\u6240\u6709\u6570\u636e\u3002\u8be5\u793a\u4f8b\u4f7f\u7528\u7684\u662fC++\uff0c\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u7684API\u90fd\u7c7b\u4f3c\uff1a\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u90e8\u5206\u4e2d\u770b\u5230\u5982\u4f55\u5728\u66f4\u591a\u8bed\u8a00\u4e2d\u542f\u7528SSL/TLS\u3002 // Create a default SSL ChannelCredentials object. auto channel_creds = grpc::SslCredentials(grpc::SslCredentialsOptions()); // Create a channel using the credentials created in the previous step. auto channel = grpc::CreateChannel(server_name, channel_creds); // Create a stub on the channel. std::unique_ptr Greeter::Stub stub(Greeter::NewStub(channel)); // Make actual RPC calls on the stub. grpc::Status s = stub- sayHello( context, *request, response); \u5bf9\u4e8e\u9ad8\u7ea7\u7528\u4f8b\uff0c\u4f8b\u5982\u4fee\u6539\u6839CA\u6216\u4f7f\u7528\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u53ef\u4ee5\u5728\u4f20\u9012\u7ed9\u5de5\u5382\u6a21\u5f0f\u7684 SslCredentialsOptions \u53c2\u6570\u4e2d\u8bbe\u7f6e\u76f8\u5e94\u7684\u9009\u9879\u3002 \u4f7f\u7528\u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1 gRPC\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684API\u521b\u5efa\u51ed\u636e\uff0c\u8be5\u51ed\u636e\u53ef\u7528\u4e8e\u5728\u5404\u79cd\u90e8\u7f72\u65b9\u6848\u4e2d\u4e0eGoogle\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u540c\u6837\uff0c\u6211\u4eec\u7684\u793a\u4f8b\u662f\u5728C++\u4e2d\uff0c\u4f46\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u793a\u4f8b\u90e8\u5206\u4e2d\u627e\u5230\u5176\u4ed6\u8bed\u8a00\u7684\u793a\u4f8b\u3002 auto creds = grpc::GoogleDefaultCredentials(); // Create a channel, stub and make RPC calls (same as in the previous example) auto channel = grpc::CreateChannel(server_name, creds); std::unique_ptr Greeter::Stub stub(Greeter::NewStub(channel)); grpc::Status s = stub- sayHello( context, *request, response); \u6b64\u901a\u9053\u51ed\u636e\u5bf9\u8c61\u9002\u7528\u4e8e\u4f7f\u7528 Service Account \u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u8005\u5728Google Compute Engine\uff08GCE\uff09\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u524d\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c Service Account \u7684\u79c1\u94a5\u662f\u4ece\u73af\u5883\u53d8\u91cf GOOGLE_APPLICATION_CREDENTIALS \u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\u52a0\u8f7d\u7684\u3002\u5bc6\u94a5\u7528\u4e8e\u751f\u6210\u627f\u8f7d\u4ee4\u724c\uff0c\u8be5\u4ee4\u724c\u9644\u52a0\u5230\u76f8\u5e94\u901a\u9053\u7684\u6bcf\u4e2a\u4f20\u51faRPC\u4e0a\u3002 \u5bf9\u4e8e\u5728GCE\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5728VM\u542f\u52a8\u671f\u95f4\u914d\u7f6e\u9ed8\u8ba4\u7684 Service Account \u548c\u5bf9\u5e94\u7684OAuth2\u4f5c\u7528\u57df\u3002\u5728\u8fd0\u884c\u65f6\uff0c\u6b64\u51ed\u636e\u5904\u7406\u4e0e\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf\u7684\u901a\u4fe1\u6765\u83b7\u5f97OAuth2\u8bbf\u95ee\u4ee4\u724c\uff0c\u5e76\u5c06\u83b7\u5f97\u7684\u8bbf\u95ee\u4ee4\u724c\u9644\u52a0\u5230\u76f8\u5e94\u901a\u9053\u7684\u6bcf\u4e2a\u4f20\u51faRPC\u4e0a\u3002 \u6269\u5c55gRPC\u4ee5\u652f\u6301\u5176\u4ed6\u8ba4\u8bc1\u673a\u5236 \u51ed\u636e\u63d2\u4ef6API\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u63d2\u5165\u81ea\u5df1\u7684\u51ed\u636e\u7c7b\u578b\uff0c\u5305\u62ec\uff1a MetadataCredentialsPlugin \u62bd\u8c61\u7c7b\uff0c\u5b83\u5305\u542b\u9700\u8981\u7531\u5f00\u53d1\u4eba\u5458\u521b\u5efa\u7684\u5b50\u7c7b\u5b9e\u73b0\u7684\u7eaf\u865a\u62df GetMetadata \u65b9\u6cd5\u3002 MetadataCredentialsFromPlugin \u51fd\u6570\uff0c\u5b83\u4ece MetadataCredentialsPlugin \u521b\u5efa\u8c03\u7528\u51ed\u636e\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u51ed\u7684\u636e\u63d2\u4ef6\u7684\u793a\u4f8b\uff0c\u8be5\u63d2\u4ef6\u5728\u81ea\u5b9a\u4e49\u6807\u5934\u4e2d\u8bbe\u7f6e\u8ba4\u8bc1\u7968\u636e\u3002 class MyCustomAuthenticator : public grpc::MetadataCredentialsPlugin { public: MyCustomAuthenticator(const grpc::string ticket) : ticket_(ticket) {} grpc::Status GetMetadata( grpc::string_ref service_url, grpc::string_ref method_name, const grpc::AuthContext channel_auth_context, std::multimap grpc::string, grpc::string * metadata) override { metadata- insert(std::make_pair( x-custom-auth-ticket , ticket_)); return grpc::Status::OK; } private: grpc::string ticket_; }; auto call_creds = grpc::MetadataCredentialsFromPlugin( std::unique_ptr grpc::MetadataCredentialsPlugin ( new MyCustomAuthenticator( super-secret-ticket ))); \u901a\u8fc7\u5728\u6838\u5fc3\u7ea7\u522b\u63d2\u5165gRPC\u51ed\u8bc1\u53ef\u4ee5\u5b9e\u73b0\u66f4\u6df1\u5165\u7684\u96c6\u6210\u3002gRPC\u5185\u90e8\u8fd8\u5141\u8bb8\u4f7f\u7528\u5176\u4ed6\u52a0\u5bc6\u673a\u5236\u5207\u6362SSL/TLS\u3002 \u6837\u4f8b \u6240\u6709gRPC\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u90fd\u53ef\u4ee5\u63d0\u4f9b\u8fd9\u6837\u7684\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u3002\u4ee5\u4e0b\u90e8\u5206\u6f14\u793a\u4e86\u5982\u4f55\u5728\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u4e0a\u8ff0\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u529f\u80fd\uff1a\u5373\u5c06\u63a8\u51fa\u66f4\u591a\u8bed\u8a00\u3002 Golang \u57fa\u7840\u4f8b\u5b50\uff0c\u6ca1\u6709\u52a0\u5bc6\u548c\u8ba4\u8bc1 // \u5ba2\u6237\u7aef conn, _ := grpc.Dial( localhost:50051 , grpc.WithInsecure()) // error handling omitted client := pb.NewGreeterClient(conn) // ... // \u670d\u52a1\u7aef s := grpc.NewServer() lis, _ := net.Listen( tcp , localhost:50051 ) // error handling omitted s.Serve(lis) \u5e26\u6709SSL/TLS\u8ba4\u8bc1\u7684\u670d\u52a1 // \u5ba2\u6237\u7aef creds, _ := credentials.NewClientTLSFromFile(certFile, ) conn, _ := grpc.Dial( localhost:50051 , grpc.WithTransportCredentials(creds)) // error handling omitted client := pb.NewGreeterClient(conn) // ... // \u670d\u52a1\u7aef creds, _ := credentials.NewServerTLSFromFile(certFile, keyFile) s := grpc.NewServer(grpc.Creds(creds)) lis, _ := net.Listen( tcp , localhost:50051 ) // error handling omitted s.Serve(lis) \u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1 pool, _ := x509.SystemCertPool() // error handling omitted creds := credentials.NewClientTLSFromCert(pool, ) perRPC, _ := oauth.NewServiceAccountFromFile( service-account.json , scope) conn, _ := grpc.Dial( greeter.googleapis.com , grpc.WithTransportCredentials(creds), grpc.WithPerRPCCredentials(perRPC), ) // error handling omitted client := pb.NewGreeterClient(conn) // ...","title":"\u8ba4\u8bc1"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_1","text":"\u672c\u6587\u6863\u6982\u8ff0\u4e86gRPC\u8ba4\u8bc1\u673a\u5236\uff0c\u5305\u62ec\u5185\u7f6e\u652f\u6301\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff0c\u5982\u4f55\u63d2\u5165\u81ea\u5df1\u7684\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf\uff0c\u4ee5\u53ca\u5982\u4f55\u5728\u652f\u6301\u7684\u8bed\u8a00\u4e2d\u4f7f\u7528gRPC\u8ba4\u8bc1\u673a\u5236\u7684\u793a\u4f8b\u3002","title":"\u8ba4\u8bc1"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_2","text":"gRPC\u65e8\u5728\u4e0e\u5404\u79cd\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\u914d\u5408\u4f7f\u7528\uff0c\u53ef\u4ee5\u8f7b\u677e\u5b89\u5168\u5730\u4f7f\u7528gRPC\u4e0e\u5176\u4ed6\u7cfb\u7edf\u8fdb\u884c\u901a\u4fe1\u3002\u53ef\u4ee5\u4f7f\u7528\u6211\u4eec\u652f\u6301\u7684\u673a\u5236\uff1a \u5e26\u6216\u4e0d\u5e26\u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8eab\u4efd\u9a8c\u8bc1\u7684SSL/TLS \u901a\u8fc7\u6269\u5c55\u6211\u4eec\u63d0\u4f9b\u7684\u4ee3\u7801\u6765\u63d2\u5165\u81ea\u5df1\u7684\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf gRPC\u8fd8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1API\uff0c\u5141\u8bb8\u5728\u521b\u5efa\u901a\u9053\u6216\u53d1\u8d77\u8c03\u7528\u65f6\u63d0\u4f9b\u6240\u6709\u5fc5\u8981\u7684\u8eab\u4efd\u9a8c\u8bc1\u4fe1\u606f\u4f5c\u4e3a\u51ed\u636e\u3002","title":"\u6982\u8ff0"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_3","text":"gRPC\u5185\u7f6e\u4e86\u4ee5\u4e0b\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff1a SSL/TLS \uff1agRPC\u96c6\u6210\u4e86SSL/TLS\uff0c\u5e76\u63a8\u8350\u4f7f\u7528SSL/TLS\u5bf9\u670d\u52a1\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u5bf9\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4e4b\u95f4\u4ea4\u6362\u7684\u6240\u6709\u6570\u636e\u8fdb\u884c\u52a0\u5bc6\u3002\u53ef\u9009\u673a\u5236\u53ef\u4f9b\u5ba2\u6237\u7aef\u63d0\u4f9b\u76f8\u4e92\u8eab\u4efd\u9a8c\u8bc1\u7684\u8bc1\u4e66\u3002 \u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1 \uff1agRPC\u63d0\u4f9b\u4e86\u4e00\u79cd\u901a\u7528\u673a\u5236\uff08\u5982\u4e0b\u6240\u8ff0\uff09\uff0c\u7528\u4e8e\u5c06\u57fa\u4e8e\u51ed\u636e\u7684\u5143\u6570\u636e\u9644\u52a0\u5230\u8bf7\u6c42\u548c\u54cd\u5e94\u4e2d\u3002\u6b64\u5916\uff0c\u67d0\u4e9b\u8eab\u4efd\u9a8c\u8bc1\u6d41\u7a0b\u63d0\u4f9b\u4e86\u901a\u8fc7gRPC\u8bbf\u95eeGoogle API\u65f6\u83b7\u53d6\u8bbf\u95ee\u4ee4\u724c\uff08\u4f8b\u5982\uff0cOAuth2\u4ee4\u724c\uff09\u7684\u652f\u6301\uff1a\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u4ee3\u7801\u793a\u4f8b\u4e2d\u770b\u5230\u5b83\u7684\u5de5\u4f5c\u539f\u7406\u3002\u901a\u5e38\uff0c\u5fc5\u987b\u4f7f\u7528\u6b64\u673a\u5236\u5c31\u50cf\u5fc5\u987b\u5728\u901a\u9053\u4e0a\u4f7f\u7528SSL/TLS\uff08Google\u4e0d\u5141\u8bb8\u6ca1\u6709SSL/TLS\u7684\u8fde\u63a5\uff09\uff0c\u5e76\u4e14\u5927\u591a\u6570\u5b9e\u73b0gRPC\u7684\u7f16\u7a0b\u8bed\u73b0\u90fd\u4e0d\u5141\u8bb8\u5728\u672a\u52a0\u5bc6\u7684\u901a\u9053\u4e0a\u53d1\u9001\u51ed\u636e\u3002 \u8b66\u544a \uff1aGoogle\u51ed\u636e\u53ea\u80fd\u7528\u4e8e\u8fde\u63a5Google\u670d\u52a1\u3002\u5c06Google\u53d1\u5e03\u7684OAuth2\u4ee4\u724c\u53d1\u9001\u5230\u975eGoogle\u670d\u52a1\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6b64\u4ee4\u724c\u88ab\u76d7\u5e76\u7528\u4e8e\u5192\u5145\u5ba2\u6237\u7aef\u8bbf\u95eeGoogle\u670d\u52a1\u3002","title":"\u652f\u6301\u7684\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#api","text":"gRPC\u63d0\u4f9b\u57fa\u4e8e\u51ed\u636e\u5bf9\u8c61\u7edf\u4e00\u6982\u5ff5\u7684\u7b80\u5355\u8ba4\u8bc1API\uff0c\u53ef\u5728\u521b\u5efa\u6574\u4e2agRPC\u901a\u9053\u6216\u5355\u4e2a\u8bf7\u6c42\u65f6\u4f7f\u7528\u3002","title":"\u8ba4\u8bc1API"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_4","text":"\u51ed\u636e\u6709\u4e24\u79cd\u7c7b\u578b\uff1a \u901a\u9053\u51ed\u636e\uff08 ChannelCredentials \uff09 \uff1a\u9644\u52a0\u5230\u4e00\u4e2a\u901a\u9053\u4e0a\uff0c\u4f8b\u5982SSL\u51ed\u636e \u8c03\u7528\u51ed\u636e\uff08 CallCredentials \uff09 \uff1a\u9644\u52a0\u5230\u4e00\u4e2a\u8c03\u7528\u4e0a\uff08\u6216\u8005\u662fC++\u4e2d\u7684 ClientContext \uff09 \u8fd8\u53ef\u4ee5\u5728\u7efc\u5408\u901a\u9053\u51ed\u636e\uff08 CompositeChannelCredentials \uff09\u4e2d\u7ec4\u5408\u4f7f\u7528\u8fd9\u4e24\u79cd\u51ed\u636e\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u6307\u5b9a\u901a\u9053\u7684SSL\u4ee5\u53ca\u5728\u901a\u9053\u4e2d\u8fdb\u884c\u7684\u6bcf\u4e2a\u8c03\u7528\u7684\u8c03\u7528\u51ed\u636e\u3002 \u7efc\u5408\u901a\u9053\u51ed\u636e\u5c06\u901a\u9053\u51ed\u636e\u4e0e\u8c03\u7528\u51ed\u636e\u76f8\u5173\u8054\uff0c\u4ee5\u521b\u5efa\u65b0\u7684\u901a\u9053\u51ed\u636e\u3002\u7ed3\u679c\u5c31\u662f\u5c06\u53d1\u9001\u4e0e\u5728\u901a\u9053\u4e0a\u8fdb\u884c\u7684\u6bcf\u6b21\u8c03\u7528\u76f8\u5173\u8054\u7684\u8c03\u7528\u51ed\u636e\u7ec4\u5408\u800c\u6210\u7684\u8ba4\u8bc1\u6570\u636e\u3002 \u4f8b\u5982\uff0c\u53ef\u4ee5\u4ece SslCredentials \u548c AccessTokenCredentials \u521b\u5efa\u901a\u9053\u51ed\u636e\u3002\u7ed3\u679c\u5c31\u662f\u5f53\u5e94\u7528\u5728\u4e00\u4e2a\u901a\u9053\u65f6\u5c06\u4e3a\u6b64\u901a\u9053\u4e0a\u7684\u6bcf\u4e2a\u8c03\u7528\u53d1\u9001\u76f8\u5e94\u7684\u8bbf\u95ee\u4ee4\u724c\uff08token\uff09\u3002 \u5355\u4e2a\u8c03\u7528\u51ed\u636e\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7efc\u5408\u8c03\u7528\u51ed\u636e\uff08 CompositeCallCredentials \uff09\u7ec4\u6210\u3002\u5728\u4e00\u4e2a\u8c03\u7528\u4e2d\u4f7f\u7528\u7efc\u5408\u8c03\u7528\u51ed\u636e\u751f\u6210\u7684\u8c03\u7528\u51ed\u636e\u65f6\uff0c\u5c06\u89e6\u53d1\u53d1\u9001\u4e0e\u4e24\u4e2a\u8c03\u7528\u51ed\u636e\u5173\u8054\u7684\u8ba4\u8bc1\u6570\u636e\u3002","title":"\u51ed\u636e\u7c7b\u578b"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#ssltls","text":"\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u51ed\u636e\u5982\u4f55\u4e0e\u6211\u4eec\u652f\u6301\u7684\u8ba4\u8bc1\u673a\u5236\u4e00\u8d77\u5de5\u4f5c\u3002\u8fd9\u662f\u6700\u7b80\u5355\u7684\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6848\uff0c\u5ba2\u6237\u7aef\u53ea\u60f3\u9a8c\u8bc1\u670d\u52a1\u7aef\u5e76\u52a0\u5bc6\u6240\u6709\u6570\u636e\u3002\u8be5\u793a\u4f8b\u4f7f\u7528\u7684\u662fC++\uff0c\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u7684API\u90fd\u7c7b\u4f3c\uff1a\u53ef\u4ee5\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u90e8\u5206\u4e2d\u770b\u5230\u5982\u4f55\u5728\u66f4\u591a\u8bed\u8a00\u4e2d\u542f\u7528SSL/TLS\u3002 // Create a default SSL ChannelCredentials object. auto channel_creds = grpc::SslCredentials(grpc::SslCredentialsOptions()); // Create a channel using the credentials created in the previous step. auto channel = grpc::CreateChannel(server_name, channel_creds); // Create a stub on the channel. std::unique_ptr Greeter::Stub stub(Greeter::NewStub(channel)); // Make actual RPC calls on the stub. grpc::Status s = stub- sayHello( context, *request, response); \u5bf9\u4e8e\u9ad8\u7ea7\u7528\u4f8b\uff0c\u4f8b\u5982\u4fee\u6539\u6839CA\u6216\u4f7f\u7528\u5ba2\u6237\u7aef\u8bc1\u4e66\uff0c\u53ef\u4ee5\u5728\u4f20\u9012\u7ed9\u5de5\u5382\u6a21\u5f0f\u7684 SslCredentialsOptions \u53c2\u6570\u4e2d\u8bbe\u7f6e\u76f8\u5e94\u7684\u9009\u9879\u3002","title":"\u4f7f\u7528\u5ba2\u6237\u7aefSSL/TLS"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#google","text":"gRPC\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684API\u521b\u5efa\u51ed\u636e\uff0c\u8be5\u51ed\u636e\u53ef\u7528\u4e8e\u5728\u5404\u79cd\u90e8\u7f72\u65b9\u6848\u4e2d\u4e0eGoogle\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u540c\u6837\uff0c\u6211\u4eec\u7684\u793a\u4f8b\u662f\u5728C++\u4e2d\uff0c\u4f46\u53ef\u4ee5\u5728\u6211\u4eec\u7684\u793a\u4f8b\u90e8\u5206\u4e2d\u627e\u5230\u5176\u4ed6\u8bed\u8a00\u7684\u793a\u4f8b\u3002 auto creds = grpc::GoogleDefaultCredentials(); // Create a channel, stub and make RPC calls (same as in the previous example) auto channel = grpc::CreateChannel(server_name, creds); std::unique_ptr Greeter::Stub stub(Greeter::NewStub(channel)); grpc::Status s = stub- sayHello( context, *request, response); \u6b64\u901a\u9053\u51ed\u636e\u5bf9\u8c61\u9002\u7528\u4e8e\u4f7f\u7528 Service Account \u7684\u5e94\u7528\u7a0b\u5e8f\u6216\u8005\u5728Google Compute Engine\uff08GCE\uff09\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\u3002 \u524d\u4e00\u79cd\u60c5\u51b5\u4e0b\uff0c Service Account \u7684\u79c1\u94a5\u662f\u4ece\u73af\u5883\u53d8\u91cf GOOGLE_APPLICATION_CREDENTIALS \u4e2d\u6307\u5b9a\u7684\u6587\u4ef6\u52a0\u8f7d\u7684\u3002\u5bc6\u94a5\u7528\u4e8e\u751f\u6210\u627f\u8f7d\u4ee4\u724c\uff0c\u8be5\u4ee4\u724c\u9644\u52a0\u5230\u76f8\u5e94\u901a\u9053\u7684\u6bcf\u4e2a\u4f20\u51faRPC\u4e0a\u3002 \u5bf9\u4e8e\u5728GCE\u4e2d\u8fd0\u884c\u7684\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u5728VM\u542f\u52a8\u671f\u95f4\u914d\u7f6e\u9ed8\u8ba4\u7684 Service Account \u548c\u5bf9\u5e94\u7684OAuth2\u4f5c\u7528\u57df\u3002\u5728\u8fd0\u884c\u65f6\uff0c\u6b64\u51ed\u636e\u5904\u7406\u4e0e\u8eab\u4efd\u9a8c\u8bc1\u7cfb\u7edf\u7684\u901a\u4fe1\u6765\u83b7\u5f97OAuth2\u8bbf\u95ee\u4ee4\u724c\uff0c\u5e76\u5c06\u83b7\u5f97\u7684\u8bbf\u95ee\u4ee4\u724c\u9644\u52a0\u5230\u76f8\u5e94\u901a\u9053\u7684\u6bcf\u4e2a\u4f20\u51faRPC\u4e0a\u3002","title":"\u4f7f\u7528\u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#grpc","text":"\u51ed\u636e\u63d2\u4ef6API\u5141\u8bb8\u5f00\u53d1\u4eba\u5458\u63d2\u5165\u81ea\u5df1\u7684\u51ed\u636e\u7c7b\u578b\uff0c\u5305\u62ec\uff1a MetadataCredentialsPlugin \u62bd\u8c61\u7c7b\uff0c\u5b83\u5305\u542b\u9700\u8981\u7531\u5f00\u53d1\u4eba\u5458\u521b\u5efa\u7684\u5b50\u7c7b\u5b9e\u73b0\u7684\u7eaf\u865a\u62df GetMetadata \u65b9\u6cd5\u3002 MetadataCredentialsFromPlugin \u51fd\u6570\uff0c\u5b83\u4ece MetadataCredentialsPlugin \u521b\u5efa\u8c03\u7528\u51ed\u636e\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u51ed\u7684\u636e\u63d2\u4ef6\u7684\u793a\u4f8b\uff0c\u8be5\u63d2\u4ef6\u5728\u81ea\u5b9a\u4e49\u6807\u5934\u4e2d\u8bbe\u7f6e\u8ba4\u8bc1\u7968\u636e\u3002 class MyCustomAuthenticator : public grpc::MetadataCredentialsPlugin { public: MyCustomAuthenticator(const grpc::string ticket) : ticket_(ticket) {} grpc::Status GetMetadata( grpc::string_ref service_url, grpc::string_ref method_name, const grpc::AuthContext channel_auth_context, std::multimap grpc::string, grpc::string * metadata) override { metadata- insert(std::make_pair( x-custom-auth-ticket , ticket_)); return grpc::Status::OK; } private: grpc::string ticket_; }; auto call_creds = grpc::MetadataCredentialsFromPlugin( std::unique_ptr grpc::MetadataCredentialsPlugin ( new MyCustomAuthenticator( super-secret-ticket ))); \u901a\u8fc7\u5728\u6838\u5fc3\u7ea7\u522b\u63d2\u5165gRPC\u51ed\u8bc1\u53ef\u4ee5\u5b9e\u73b0\u66f4\u6df1\u5165\u7684\u96c6\u6210\u3002gRPC\u5185\u90e8\u8fd8\u5141\u8bb8\u4f7f\u7528\u5176\u4ed6\u52a0\u5bc6\u673a\u5236\u5207\u6362SSL/TLS\u3002","title":"\u6269\u5c55gRPC\u4ee5\u652f\u6301\u5176\u4ed6\u8ba4\u8bc1\u673a\u5236"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_5","text":"\u6240\u6709gRPC\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u90fd\u53ef\u4ee5\u63d0\u4f9b\u8fd9\u6837\u7684\u8eab\u4efd\u8ba4\u8bc1\u673a\u5236\u3002\u4ee5\u4e0b\u90e8\u5206\u6f14\u793a\u4e86\u5982\u4f55\u5728\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u4e2d\u4f7f\u7528\u4e0a\u8ff0\u8eab\u4efd\u9a8c\u8bc1\u548c\u6388\u6743\u529f\u80fd\uff1a\u5373\u5c06\u63a8\u51fa\u66f4\u591a\u8bed\u8a00\u3002","title":"\u6837\u4f8b"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#golang","text":"","title":"Golang"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#_6","text":"// \u5ba2\u6237\u7aef conn, _ := grpc.Dial( localhost:50051 , grpc.WithInsecure()) // error handling omitted client := pb.NewGreeterClient(conn) // ... // \u670d\u52a1\u7aef s := grpc.NewServer() lis, _ := net.Listen( tcp , localhost:50051 ) // error handling omitted s.Serve(lis)","title":"\u57fa\u7840\u4f8b\u5b50\uff0c\u6ca1\u6709\u52a0\u5bc6\u548c\u8ba4\u8bc1"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#ssltls_1","text":"// \u5ba2\u6237\u7aef creds, _ := credentials.NewClientTLSFromFile(certFile, ) conn, _ := grpc.Dial( localhost:50051 , grpc.WithTransportCredentials(creds)) // error handling omitted client := pb.NewGreeterClient(conn) // ... // \u670d\u52a1\u7aef creds, _ := credentials.NewServerTLSFromFile(certFile, keyFile) s := grpc.NewServer(grpc.Creds(creds)) lis, _ := net.Listen( tcp , localhost:50051 ) // error handling omitted s.Serve(lis)","title":"\u5e26\u6709SSL/TLS\u8ba4\u8bc1\u7684\u670d\u52a1"},{"location":"Frameworks/gRPC/03-\u8ba4\u8bc1/#google_1","text":"pool, _ := x509.SystemCertPool() // error handling omitted creds := credentials.NewClientTLSFromCert(pool, ) perRPC, _ := oauth.NewServiceAccountFromFile( service-account.json , scope) conn, _ := grpc.Dial( greeter.googleapis.com , grpc.WithTransportCredentials(creds), grpc.WithPerRPCCredentials(perRPC), ) // error handling omitted client := pb.NewGreeterClient(conn) // ...","title":"\u57fa\u4e8eGoogle\u4ee4\u724c\u7684\u8ba4\u8bc1"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/","text":"\u9519\u8bef\u5904\u7406 \u672c\u6587\u63cf\u8ff0\u4e86gRPC\u5982\u4f55\u5904\u7406\u9519\u8bef\uff0c\u5305\u62ecgRPC\u7684\u5185\u7f6e\u9519\u8bef\u72b6\u6001\u7801\u3002\u53ef\u4ee5\u5728\u6b64\u5904\u770b\u5230\u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\u7684\u793a\u4f8b\u4ee3\u7801\u3002 \u6807\u51c6\u9519\u8bef\u6a21\u578b \u6b63\u5982\u5728\u6211\u4eec\u7684 \u6982\u5ff5\u6587\u6863\u548c\u793a\u4f8b \u4e2d\u6240\u770b\u5230\u7684\uff0c\u5f53gRPC\u8c03\u7528\u6210\u529f\u5e76\u8c03\u7528\u5b8c\u6210\u65f6\uff0c\u670d\u52a1\u7aef\u4f1a\u5411\u5ba2\u6237\u7aef\u8fd4\u56de OK \u72b6\u6001\uff08\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\uff0cOK\u72b6\u6001\u53ef\u80fd\u4f1a\u4e5f\u53ef\u80fd\u4e0d\u4f1a\u76f4\u63a5\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\uff09\u3002\u90a3\u4e48\uff0c\u5982\u679c\u8c03\u7528\u4e0d\u6210\u529f\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f \u5982\u679c\u53d1\u751f\u9519\u8bef\uff0cgRPC\u4f1a\u8fd4\u56de\u5176\u9519\u8bef\u72b6\u6001\u7801\uff0c\u5e76\u5e26\u6709\u53ef\u9009\u7684\u5b57\u7b26\u4e32\u9519\u8bef\u6d88\u606f\uff0c\u8be5\u6d88\u606f\u63d0\u4f9b\u6709\u5173\u6240\u53d1\u751f\u60c5\u51b5\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002\u6240\u6709\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684gRPC\u5ba2\u6237\u7aef\u90fd\u53ef\u4ee5\u4f7f\u7528\u9519\u8bef\u4fe1\u606f\u3002 \u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b \u6807\u51c6\u9519\u8bef\u6a21\u578b \u662fgRPC\u5b98\u65b9\u7684\u9519\u8bef\u6a21\u578b\uff0c\u53d7\u6240\u6709gRPC\u5ba2\u6237\u7aef/\u670d\u52a1\u7aef\u5e93\u7684\u652f\u6301\uff0c\u5e76\u4e14\u72ec\u7acb\u4e8egRPC\u6570\u636e\u683c\u5f0f\uff08\u65e0\u8bba\u662fprotocol buffers\u8fd8\u662f\u5176\u4ed6\u683c\u5f0f\uff09\u3002\u6807\u51c6\u9519\u8bef\u6a21\u578b\u975e\u5e38\u6709\u9650\uff0c\u5e76\u4e14\u4e0d\u5305\u62ec\u4f20\u8fbe\u9519\u8bef\u8be6\u60c5\u7684\u80fd\u529b\u3002 \u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528protocol buffers\u4f5c\u4e3a\u6570\u636e\u683c\u5f0f\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8003\u8651\u4f7f\u7528Google\u5f00\u53d1\u548c\u4f7f\u7528\u7684\u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b\uff0c\u5982 \u6b64\u5904\u6240\u8ff0 \u3002\u6b64\u6a21\u578b\u5728\u670d\u52a1\u7aef\u8fd4\u56de\u5e76\u5728\u5ba2\u6237\u7aef\u6d88\u8d39\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\uff0c\u8fd9\u4e9b\u9519\u8bef\u8be6\u60c5\u7531\u4e00\u4e2a\u6216\u591a\u4e2aprotobuf\u6d88\u606f\u8868\u793a\u3002\u8fd9\u79cd\u6a21\u578b\u8fdb\u4e00\u6b65\u6307\u5b9a\u4e86 \u4e00\u7ec4\u6807\u51c6\u7684\u9519\u8bef\u6d88\u606f\u7c7b\u578b \uff0c\u4ee5\u6ee1\u8db3\u6700\u5e38\u89c1\u7684\u9700\u6c42\uff08\u4f8b\u5982\uff0c\u65e0\u6548\u53c2\u6570\u3001\u914d\u989d\u8fdd\u89c4\u3001\u5806\u6808\u8ddf\u8e2a\u7b49\uff09\u3002\u8fd9\u4e9b\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\u7684protobuf\u4e8c\u8fdb\u5236\u7f16\u7801\u5728\u54cd\u5e94\u4e2d\u4f5c\u4e3a\u5c3e\u968f\u5143\u6570\u636e\u63d0\u4f9b\u3002 \u8fd9\u4e2a\u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b\u5df2\u7ecf\u5728C++\uff0cGo\uff0cJava\uff0cPython\u548cRuby\u5e93\u4e2d\u5f97\u5230\u652f\u6301\uff0c\u5e76\u4e14\u81f3\u5c11\u5728grpc-web\u548cNode.js\u7684\u5e93\u4e2d\u5f00\u4e86issue\u8ba8\u8bba\u9700\u8981\u5b9e\u73b0\u5b83\u3002\u5982\u679c\u6709\u9700\u6c42\uff0c\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u5e93\u53ef\u80fd\u4f1a\u5728\u5c06\u6765\u6dfb\u52a0\u652f\u6301\uff0c\u5982\u679c\u611f\u5174\u8da3\u53ef\u4ee5\u67e5\u770b\u4ed6\u4eec\u7684github\u5b58\u50a8\u5e93\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u7528C\u8bed\u8a00\u7f16\u5199\u7684 grpc-core \u5e93\u4e0d\u592a\u53ef\u80fd\u652f\u6301\u5b83\uff0c\u56e0\u4e3a\u5b83\u6709\u76ee\u7684\u5b9e\u73b0\u4e3a\u4e0e\u6570\u636e\u683c\u5f0f\u65e0\u5173\uff08it is purposely data format agnostic\uff09\u3002 \u5982\u679c\u6ca1\u6709\u4f7f\u7528protocol buffers\uff0c\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff08\u5728\u54cd\u5e94\u7684\u5c3e\u968f\u5143\u6570\u636e\u4e2d\u653e\u7f6e\u9519\u8bef\u8be6\u60c5\uff09\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u53ef\u80fd\u9700\u8981\u67e5\u627e\u6216\u5f00\u53d1\u7528\u4e8e\u8bbf\u95ee\u6b64\u6570\u636e\u7684\u5e93\u652f\u6301\uff0c\u4ee5\u4fbf\u5728\u4f60\u7f16\u5199\u7684API\u4e2d\u5b9e\u9645\u4f7f\u7528\u5b83\u3002 \u5728\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u8fd9\u6837\u7684\u6269\u5c55\u9519\u8bef\u6a21\u578b\u65f6\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u91cd\u8981\u7684\u6ce8\u610f\u4e8b\u9879\uff0c\u5305\u62ec\uff1a \u5728\u9519\u8bef\u8be6\u60c5\u6709\u6548\u8d1f\u8f7d\u7684\u671f\u671b\u548c\u9700\u6c42\u65b9\u9762\uff0c\u6269\u5c55\u9519\u8bef\u6a21\u578b\u7684\u5e93\u5b9e\u73b0\u53ef\u80fd\u4e0e\u7f16\u7a0b\u8bed\u8a00\u4e4b\u95f4\u4e0d\u4e00\u81f4 \u5df2\u6709\u7684\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u65e5\u5fd7\u8bb0\u5f55\u5668\u548c\u5176\u4ed6\u6807\u51c6HTTP\u8bf7\u6c42\u5904\u7406\u5668\u65e0\u6cd5\u67e5\u770b\u9519\u8bef\u8be6\u60c5\uff0c\u56e0\u6b64\u65e0\u6cd5\u5c06\u5176\u7528\u4e8e\u76d1\u89c6\u6216\u5176\u4ed6\u76ee\u7684 \u5728\u5c3e\u90e8\u8ffd\u52a0\u63a5\u53e3\u4e2d\u7684\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\u5c06\u4f1a\u51fa\u73b0 \u961f\u5934\u963b\u585e \uff08Head-of-line blocking\uff0cHOL blocking\uff09\uff0c\u5e76\u4e14\uff0c\u7531\u4e8e\u66f4\u9891\u7e41\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u4f1a\u964d\u4f4eHTTP/2\u62a5\u5934\u7684\u538b\u7f29\u6548\u7387 \u66f4\u5927\u7684\u9519\u8bef\u8be6\u60c5\u6709\u6548\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u9047\u5230\u534f\u8bae\u9650\u5236\uff08\u4f8b\u5982\uff0c\u6700\u5927\u6807\u5934\u5927\u5c0f\u9650\u5236\uff09\uff0c\u4ece\u800c\u4e22\u5931\u539f\u59cb\u9519\u8bef \u961f\u5934\u963b\u585e\uff08Head-of-line blocking\u6216\u7f29\u5199\u4e3aHOL blocking\uff09\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u8303\u7574\u4e2d\u662f\u4e00\u79cd\u6027\u80fd\u53d7\u9650\u7684\u73b0\u8c61\u3002\u5b83\u7684\u539f\u56e0\u662f\u4e00\u5217\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u5305\uff08\u961f\u5934\uff09\u53d7\u963b\u800c\u5bfc\u81f4\u6574\u5217\u6570\u636e\u5305\u53d7\u963b\u3002 \u4f8b\u5982\u5b83\u6709\u53ef\u80fd\u5728\u7f13\u5b58\u5f0f\u8f93\u5165\u7684\u4ea4\u6362\u673a\u4e2d\u51fa\u73b0\uff0c\u6709\u53ef\u80fd\u56e0\u4e3a\u4f20\u8f93\u987a\u5e8f\u9519\u4e71\u800c\u51fa\u73b0\uff0c\u4ea6\u6709\u53ef\u80fd\u5728HTTP\u6d41\u6c34\u7ebf\u4e2d\u6709\u591a\u4e2a\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\u51fa\u73b0\u3002 \u9519\u8bef\u72b6\u6001\u7801 \u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\u9519\u8bef\u7531gRPC\u5f15\u8d77\uff0c\u4ece\u7f51\u7edc\u6545\u969c\u5230\u672a\u7ecf\u8ba4\u8bc1\u7684\u8fde\u63a5\uff0c\u6bcf\u4e00\u79cd\u9519\u8bef\u90fd\u6709\u4e0e\u4e4b\u76f8\u5173\u8054\u7684\u7279\u5b9a\u7684\u72b6\u6001\u7801\u3002\u6240\u6709gRPC\u7f16\u7a0b\u8bed\u8a00\u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u9519\u8bef\u72b6\u6001\u4ee3\u7801\u3002 \u4e00\u822c\u9519\u8bef \u6848\u4f8b \u72b6\u6001\u7801 \u5ba2\u6237\u7aef\u5e94\u7528\u53d6\u6d88\u8bf7\u6c42 GRPC_STATUS_CANCELLED \u5728\u670d\u52a1\u7aef\u8fd4\u56de\u72b6\u6001\u65f6\u5df2\u8d85\u8fc7\u622a\u6b62\u65e5\u671f GRPC_STATUS_DEADLINE_EXCEEDED \u670d\u52a1\u7aef\u672a\u627e\u5230\u5bf9\u5e94\u65b9\u6cd5 GRPC_STATUS_UNIMPLEMENTED \u670d\u52a1\u7aef\u5b95\u673a GRPC_STATUS_UNAVAILABLE \u670d\u52a1\u7aef\u629b\u51fa\u5f02\u5e38\uff08\u6216\u8005\u6267\u884c\u4e86\u9664\u8fd4\u56de\u72b6\u6001\u7801\u4ee5\u7ec8\u6b62RPC\u4e4b\u5916\u7684\u5176\u4ed6\u64cd\u4f5c\uff09 GRPC_STATUS_UNKNOWN \u7f51\u7edc\u6545\u969c \u6848\u4f8b \u72b6\u6001\u7801 \u5728\u622a\u6b62\u65e5\u671f\u5230\u671f\u524d\uff0c\u65e0\u6570\u636e\u4f20\u8f93\u6216\u8005\u4f20\u8f93\u4e86\u67d0\u4e9b\u6570\u636e\u5e76\u4e14\u672a\u68c0\u6d4b\u5230\u5176\u4ed6\u6545\u969c GRPC_STATUS_DEADLINE_EXCEEDED \u5728\u8fde\u63a5\u7ec8\u7aef\u4e4b\u524d\u5df2\u7ecf\u4f20\u8f93\u4e86\u67d0\u4e9b\u6570\u636e\uff08\u4f8b\u5982\uff0c\u8bf7\u6c42\u5143\u6570\u636e\u5df2\u7ecf\u88ab\u5199\u5165TCP\u8fde\u63a5\u4e2d\uff09 GRPC_STATUS_UNAVAILABLE \u534f\u8bae\u9519\u8bef \u6848\u4f8b \u72b6\u6001\u7801 \u65e0\u6cd5\u89e3\u538b\u7f29\u4f46\u652f\u6301\u538b\u7f29\u7b97\u6cd5 GRPC_STATUS_INTERNAL \u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u538b\u7f29\u673a\u5236\u4e0d\u53d7\u670d\u52a1\u7aef\u652f\u6301 GRPC_STATUS_UNIMPLEMENTED \u8fbe\u5230\u6d41\u91cf\u63a7\u5236\u8d44\u6e90\u9650\u5236 GRPC_STATUS_RESOURCE_EXHAUSTED \u6d41\u91cf\u63a7\u5236\u534f\u8bae\u8fdd\u89c4 GRPC_STATUS_INTERNAL \u89e3\u6790\u8fd4\u56de\u72b6\u6001\u51fa\u9519 GRPC_STATUS_UNKNOWN \u672a\u8ba4\u8bc1\uff1a\u51ed\u636e\u65e0\u6cd5\u83b7\u53d6\u5143\u6570\u636e GRPC_STATUS_UNAUTHENTICATED \u4e3b\u673a\u96c6\u5728\u8ba4\u8bc1\u5143\u6570\u636e\u4e2d\u65e0\u6548 GRPC_STATUS_UNAUTHENTICATED \u89e3\u6790\u8fd4\u56de\u7684protocol buffers\u65f6\u51fa\u9519 GRPC_STATUS_INTERNAL \u89e3\u6790\u8bf7\u6c42protocol buffers\u65f6\u51fa\u9519 GRPC_STATUS_INTERNAL","title":"\u9519\u8bef\u5904\u7406"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_1","text":"\u672c\u6587\u63cf\u8ff0\u4e86gRPC\u5982\u4f55\u5904\u7406\u9519\u8bef\uff0c\u5305\u62ecgRPC\u7684\u5185\u7f6e\u9519\u8bef\u72b6\u6001\u7801\u3002\u53ef\u4ee5\u5728\u6b64\u5904\u770b\u5230\u4e0d\u540c\u7f16\u7a0b\u8bed\u8a00\u7684\u793a\u4f8b\u4ee3\u7801\u3002","title":"\u9519\u8bef\u5904\u7406"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_2","text":"\u6b63\u5982\u5728\u6211\u4eec\u7684 \u6982\u5ff5\u6587\u6863\u548c\u793a\u4f8b \u4e2d\u6240\u770b\u5230\u7684\uff0c\u5f53gRPC\u8c03\u7528\u6210\u529f\u5e76\u8c03\u7528\u5b8c\u6210\u65f6\uff0c\u670d\u52a1\u7aef\u4f1a\u5411\u5ba2\u6237\u7aef\u8fd4\u56de OK \u72b6\u6001\uff08\u53d6\u51b3\u4e8e\u7f16\u7a0b\u8bed\u8a00\uff0cOK\u72b6\u6001\u53ef\u80fd\u4f1a\u4e5f\u53ef\u80fd\u4e0d\u4f1a\u76f4\u63a5\u5728\u4ee3\u7801\u4e2d\u4f7f\u7528\uff09\u3002\u90a3\u4e48\uff0c\u5982\u679c\u8c03\u7528\u4e0d\u6210\u529f\u4f1a\u53d1\u751f\u4ec0\u4e48\uff1f \u5982\u679c\u53d1\u751f\u9519\u8bef\uff0cgRPC\u4f1a\u8fd4\u56de\u5176\u9519\u8bef\u72b6\u6001\u7801\uff0c\u5e76\u5e26\u6709\u53ef\u9009\u7684\u5b57\u7b26\u4e32\u9519\u8bef\u6d88\u606f\uff0c\u8be5\u6d88\u606f\u63d0\u4f9b\u6709\u5173\u6240\u53d1\u751f\u60c5\u51b5\u7684\u66f4\u591a\u8be6\u7ec6\u4fe1\u606f\u3002\u6240\u6709\u652f\u6301\u7684\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684gRPC\u5ba2\u6237\u7aef\u90fd\u53ef\u4ee5\u4f7f\u7528\u9519\u8bef\u4fe1\u606f\u3002","title":"\u6807\u51c6\u9519\u8bef\u6a21\u578b"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_3","text":"\u6807\u51c6\u9519\u8bef\u6a21\u578b \u662fgRPC\u5b98\u65b9\u7684\u9519\u8bef\u6a21\u578b\uff0c\u53d7\u6240\u6709gRPC\u5ba2\u6237\u7aef/\u670d\u52a1\u7aef\u5e93\u7684\u652f\u6301\uff0c\u5e76\u4e14\u72ec\u7acb\u4e8egRPC\u6570\u636e\u683c\u5f0f\uff08\u65e0\u8bba\u662fprotocol buffers\u8fd8\u662f\u5176\u4ed6\u683c\u5f0f\uff09\u3002\u6807\u51c6\u9519\u8bef\u6a21\u578b\u975e\u5e38\u6709\u9650\uff0c\u5e76\u4e14\u4e0d\u5305\u62ec\u4f20\u8fbe\u9519\u8bef\u8be6\u60c5\u7684\u80fd\u529b\u3002 \u4f46\u662f\uff0c\u5982\u679c\u4f7f\u7528protocol buffers\u4f5c\u4e3a\u6570\u636e\u683c\u5f0f\uff0c\u5219\u53ef\u80fd\u9700\u8981\u8003\u8651\u4f7f\u7528Google\u5f00\u53d1\u548c\u4f7f\u7528\u7684\u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b\uff0c\u5982 \u6b64\u5904\u6240\u8ff0 \u3002\u6b64\u6a21\u578b\u5728\u670d\u52a1\u7aef\u8fd4\u56de\u5e76\u5728\u5ba2\u6237\u7aef\u6d88\u8d39\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\uff0c\u8fd9\u4e9b\u9519\u8bef\u8be6\u60c5\u7531\u4e00\u4e2a\u6216\u591a\u4e2aprotobuf\u6d88\u606f\u8868\u793a\u3002\u8fd9\u79cd\u6a21\u578b\u8fdb\u4e00\u6b65\u6307\u5b9a\u4e86 \u4e00\u7ec4\u6807\u51c6\u7684\u9519\u8bef\u6d88\u606f\u7c7b\u578b \uff0c\u4ee5\u6ee1\u8db3\u6700\u5e38\u89c1\u7684\u9700\u6c42\uff08\u4f8b\u5982\uff0c\u65e0\u6548\u53c2\u6570\u3001\u914d\u989d\u8fdd\u89c4\u3001\u5806\u6808\u8ddf\u8e2a\u7b49\uff09\u3002\u8fd9\u4e9b\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\u7684protobuf\u4e8c\u8fdb\u5236\u7f16\u7801\u5728\u54cd\u5e94\u4e2d\u4f5c\u4e3a\u5c3e\u968f\u5143\u6570\u636e\u63d0\u4f9b\u3002 \u8fd9\u4e2a\u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b\u5df2\u7ecf\u5728C++\uff0cGo\uff0cJava\uff0cPython\u548cRuby\u5e93\u4e2d\u5f97\u5230\u652f\u6301\uff0c\u5e76\u4e14\u81f3\u5c11\u5728grpc-web\u548cNode.js\u7684\u5e93\u4e2d\u5f00\u4e86issue\u8ba8\u8bba\u9700\u8981\u5b9e\u73b0\u5b83\u3002\u5982\u679c\u6709\u9700\u6c42\uff0c\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u5e93\u53ef\u80fd\u4f1a\u5728\u5c06\u6765\u6dfb\u52a0\u652f\u6301\uff0c\u5982\u679c\u611f\u5174\u8da3\u53ef\u4ee5\u67e5\u770b\u4ed6\u4eec\u7684github\u5b58\u50a8\u5e93\u3002\u4f46\u8bf7\u6ce8\u610f\uff0c\u7528C\u8bed\u8a00\u7f16\u5199\u7684 grpc-core \u5e93\u4e0d\u592a\u53ef\u80fd\u652f\u6301\u5b83\uff0c\u56e0\u4e3a\u5b83\u6709\u76ee\u7684\u5b9e\u73b0\u4e3a\u4e0e\u6570\u636e\u683c\u5f0f\u65e0\u5173\uff08it is purposely data format agnostic\uff09\u3002 \u5982\u679c\u6ca1\u6709\u4f7f\u7528protocol buffers\uff0c\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff08\u5728\u54cd\u5e94\u7684\u5c3e\u968f\u5143\u6570\u636e\u4e2d\u653e\u7f6e\u9519\u8bef\u8be6\u60c5\uff09\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u53ef\u80fd\u9700\u8981\u67e5\u627e\u6216\u5f00\u53d1\u7528\u4e8e\u8bbf\u95ee\u6b64\u6570\u636e\u7684\u5e93\u652f\u6301\uff0c\u4ee5\u4fbf\u5728\u4f60\u7f16\u5199\u7684API\u4e2d\u5b9e\u9645\u4f7f\u7528\u5b83\u3002 \u5728\u51b3\u5b9a\u662f\u5426\u4f7f\u7528\u8fd9\u6837\u7684\u6269\u5c55\u9519\u8bef\u6a21\u578b\u65f6\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u91cd\u8981\u7684\u6ce8\u610f\u4e8b\u9879\uff0c\u5305\u62ec\uff1a \u5728\u9519\u8bef\u8be6\u60c5\u6709\u6548\u8d1f\u8f7d\u7684\u671f\u671b\u548c\u9700\u6c42\u65b9\u9762\uff0c\u6269\u5c55\u9519\u8bef\u6a21\u578b\u7684\u5e93\u5b9e\u73b0\u53ef\u80fd\u4e0e\u7f16\u7a0b\u8bed\u8a00\u4e4b\u95f4\u4e0d\u4e00\u81f4 \u5df2\u6709\u7684\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u65e5\u5fd7\u8bb0\u5f55\u5668\u548c\u5176\u4ed6\u6807\u51c6HTTP\u8bf7\u6c42\u5904\u7406\u5668\u65e0\u6cd5\u67e5\u770b\u9519\u8bef\u8be6\u60c5\uff0c\u56e0\u6b64\u65e0\u6cd5\u5c06\u5176\u7528\u4e8e\u76d1\u89c6\u6216\u5176\u4ed6\u76ee\u7684 \u5728\u5c3e\u90e8\u8ffd\u52a0\u63a5\u53e3\u4e2d\u7684\u989d\u5916\u7684\u9519\u8bef\u8be6\u60c5\u5c06\u4f1a\u51fa\u73b0 \u961f\u5934\u963b\u585e \uff08Head-of-line blocking\uff0cHOL blocking\uff09\uff0c\u5e76\u4e14\uff0c\u7531\u4e8e\u66f4\u9891\u7e41\u7684\u7f13\u5b58\u672a\u547d\u4e2d\u4f1a\u964d\u4f4eHTTP/2\u62a5\u5934\u7684\u538b\u7f29\u6548\u7387 \u66f4\u5927\u7684\u9519\u8bef\u8be6\u60c5\u6709\u6548\u8d1f\u8f7d\u53ef\u80fd\u4f1a\u9047\u5230\u534f\u8bae\u9650\u5236\uff08\u4f8b\u5982\uff0c\u6700\u5927\u6807\u5934\u5927\u5c0f\u9650\u5236\uff09\uff0c\u4ece\u800c\u4e22\u5931\u539f\u59cb\u9519\u8bef \u961f\u5934\u963b\u585e\uff08Head-of-line blocking\u6216\u7f29\u5199\u4e3aHOL blocking\uff09\u5728\u8ba1\u7b97\u673a\u7f51\u7edc\u7684\u8303\u7574\u4e2d\u662f\u4e00\u79cd\u6027\u80fd\u53d7\u9650\u7684\u73b0\u8c61\u3002\u5b83\u7684\u539f\u56e0\u662f\u4e00\u5217\u7684\u7b2c\u4e00\u4e2a\u6570\u636e\u5305\uff08\u961f\u5934\uff09\u53d7\u963b\u800c\u5bfc\u81f4\u6574\u5217\u6570\u636e\u5305\u53d7\u963b\u3002 \u4f8b\u5982\u5b83\u6709\u53ef\u80fd\u5728\u7f13\u5b58\u5f0f\u8f93\u5165\u7684\u4ea4\u6362\u673a\u4e2d\u51fa\u73b0\uff0c\u6709\u53ef\u80fd\u56e0\u4e3a\u4f20\u8f93\u987a\u5e8f\u9519\u4e71\u800c\u51fa\u73b0\uff0c\u4ea6\u6709\u53ef\u80fd\u5728HTTP\u6d41\u6c34\u7ebf\u4e2d\u6709\u591a\u4e2a\u8bf7\u6c42\u7684\u60c5\u51b5\u4e0b\u51fa\u73b0\u3002","title":"\u66f4\u4e30\u5bcc\u7684\u9519\u8bef\u6a21\u578b"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_4","text":"\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\u9519\u8bef\u7531gRPC\u5f15\u8d77\uff0c\u4ece\u7f51\u7edc\u6545\u969c\u5230\u672a\u7ecf\u8ba4\u8bc1\u7684\u8fde\u63a5\uff0c\u6bcf\u4e00\u79cd\u9519\u8bef\u90fd\u6709\u4e0e\u4e4b\u76f8\u5173\u8054\u7684\u7279\u5b9a\u7684\u72b6\u6001\u7801\u3002\u6240\u6709gRPC\u7f16\u7a0b\u8bed\u8a00\u90fd\u652f\u6301\u4ee5\u4e0b\u7684\u9519\u8bef\u72b6\u6001\u4ee3\u7801\u3002","title":"\u9519\u8bef\u72b6\u6001\u7801"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_5","text":"\u6848\u4f8b \u72b6\u6001\u7801 \u5ba2\u6237\u7aef\u5e94\u7528\u53d6\u6d88\u8bf7\u6c42 GRPC_STATUS_CANCELLED \u5728\u670d\u52a1\u7aef\u8fd4\u56de\u72b6\u6001\u65f6\u5df2\u8d85\u8fc7\u622a\u6b62\u65e5\u671f GRPC_STATUS_DEADLINE_EXCEEDED \u670d\u52a1\u7aef\u672a\u627e\u5230\u5bf9\u5e94\u65b9\u6cd5 GRPC_STATUS_UNIMPLEMENTED \u670d\u52a1\u7aef\u5b95\u673a GRPC_STATUS_UNAVAILABLE \u670d\u52a1\u7aef\u629b\u51fa\u5f02\u5e38\uff08\u6216\u8005\u6267\u884c\u4e86\u9664\u8fd4\u56de\u72b6\u6001\u7801\u4ee5\u7ec8\u6b62RPC\u4e4b\u5916\u7684\u5176\u4ed6\u64cd\u4f5c\uff09 GRPC_STATUS_UNKNOWN","title":"\u4e00\u822c\u9519\u8bef"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_6","text":"\u6848\u4f8b \u72b6\u6001\u7801 \u5728\u622a\u6b62\u65e5\u671f\u5230\u671f\u524d\uff0c\u65e0\u6570\u636e\u4f20\u8f93\u6216\u8005\u4f20\u8f93\u4e86\u67d0\u4e9b\u6570\u636e\u5e76\u4e14\u672a\u68c0\u6d4b\u5230\u5176\u4ed6\u6545\u969c GRPC_STATUS_DEADLINE_EXCEEDED \u5728\u8fde\u63a5\u7ec8\u7aef\u4e4b\u524d\u5df2\u7ecf\u4f20\u8f93\u4e86\u67d0\u4e9b\u6570\u636e\uff08\u4f8b\u5982\uff0c\u8bf7\u6c42\u5143\u6570\u636e\u5df2\u7ecf\u88ab\u5199\u5165TCP\u8fde\u63a5\u4e2d\uff09 GRPC_STATUS_UNAVAILABLE","title":"\u7f51\u7edc\u6545\u969c"},{"location":"Frameworks/gRPC/04-\u9519\u8bef\u5904\u7406\u548c\u8c03\u8bd5/#_7","text":"\u6848\u4f8b \u72b6\u6001\u7801 \u65e0\u6cd5\u89e3\u538b\u7f29\u4f46\u652f\u6301\u538b\u7f29\u7b97\u6cd5 GRPC_STATUS_INTERNAL \u5ba2\u6237\u7aef\u4f7f\u7528\u7684\u538b\u7f29\u673a\u5236\u4e0d\u53d7\u670d\u52a1\u7aef\u652f\u6301 GRPC_STATUS_UNIMPLEMENTED \u8fbe\u5230\u6d41\u91cf\u63a7\u5236\u8d44\u6e90\u9650\u5236 GRPC_STATUS_RESOURCE_EXHAUSTED \u6d41\u91cf\u63a7\u5236\u534f\u8bae\u8fdd\u89c4 GRPC_STATUS_INTERNAL \u89e3\u6790\u8fd4\u56de\u72b6\u6001\u51fa\u9519 GRPC_STATUS_UNKNOWN \u672a\u8ba4\u8bc1\uff1a\u51ed\u636e\u65e0\u6cd5\u83b7\u53d6\u5143\u6570\u636e GRPC_STATUS_UNAUTHENTICATED \u4e3b\u673a\u96c6\u5728\u8ba4\u8bc1\u5143\u6570\u636e\u4e2d\u65e0\u6548 GRPC_STATUS_UNAUTHENTICATED \u89e3\u6790\u8fd4\u56de\u7684protocol buffers\u65f6\u51fa\u9519 GRPC_STATUS_INTERNAL \u89e3\u6790\u8bf7\u6c42protocol buffers\u65f6\u51fa\u9519 GRPC_STATUS_INTERNAL","title":"\u534f\u8bae\u9519\u8bef"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/","text":"\u57fa\u51c6\u5316\u5206\u6790\u6cd5 gRPC\u662f\u652f\u6301\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u9ad8\u6027\u80fd\u5f00\u6e90RPC\u3002\u672c\u6587\u6863\u4ecb\u7ecd\u4e86\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\uff0c\u6d4b\u8bd5\u6240\u8003\u8651\u7684\u65b9\u6848\u4ee5\u53ca\u6d4b\u8bd5\u57fa\u7840\u67b6\u6784\u3002 \u6982\u8ff0 gRPC\u4e13\u7528\u4e8e\u8bbe\u8ba1\u9ad8\u6027\u80fd\u548c\u9ad8\u751f\u4ea7\u7387\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u800c\u8bbe\u8ba1\u3002\u6301\u7eed\u7684\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u662fgRPC\u5f00\u53d1\u5de5\u4f5c\u6d41\u7a0b\u7684\u5173\u952e\u90e8\u5206\u3002\u9488\u5bf9\u4e3b\u5206\u652f\u6bcf\u5c0f\u65f6\u8fd0\u884c\u591a\u8bed\u8a00\u6027\u80fd\u6d4b\u8bd5\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6d4b\u8bd5\u6570\u636e\u62a5\u544a\u7ed9\u4eea\u8868\u677f\u4ee5\u8fdb\u884c\u6570\u636e\u53ef\u89c6\u5316\u3002 \u591a\u8bed\u8a00\u6027\u80fd\u4eea\u8868\u677f@latest_release\uff08\u6700\u65b0\u53ef\u7528\u7a33\u5b9a\u7248\uff09 \u591a\u8bed\u8a00\u6027\u80fd\u4eea\u8868\u677f@master\uff08\u6700\u65b0\u5f00\u53d1\u7248\uff09 C++\u8be6\u7ec6\u6027\u80fd\u4eea\u8868\u677f@master\uff08\u6700\u65b0\u5f00\u53d1\u7248\uff09 \u989d\u5916\u7684\u57fa\u51c6\u6d4b\u8bd5\u53ef\u4ee5\u63d0\u4f9b\u6709\u5173CPU\u4f7f\u7528\u60c5\u51b5\u7684\u7ec6\u7c92\u5ea6\u6d1e\u5bdf\u3002 C++ full-stack microbenchmarks C Core filter benchmarks C Core shared component benchmarks C Core HTTP/2 microbenchmarks \u6027\u80fd\u6d4b\u8bd5\u8bbe\u8ba1 \u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u90fd\u5b9e\u73b0\u4e86\u4e00\u4e2agRPC WorkerService \u7684\u6027\u80fd\u6d4b\u8bd5worker\u3002\u6b64\u670d\u52a1\u6307\u793aworker\u5145\u5f53\u5b9e\u9645\u57fa\u51c6\u6d4b\u8bd5\u7684\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u5668\uff0c\u8868\u793a\u4e3a BenchmarkService \u3002\u8be5\u670d\u52a1\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a \u7b80\u5355\u8c03\u7528\uff1a\u4e00\u4e2a\u7b80\u5355\u7684PC\u8bf7\u6c42\uff0c\u5b83\u6307\u5b9a\u5728\u54cd\u5e94\u4e2d\u8fd4\u56de\u7684\u5b57\u8282\u6570 \u6d41\u6570\u636e\u8c03\u7528\uff1a\u4e00\u4e2a\u6d41\u6570\u636eRPC\u5141\u8bb8\u91cd\u590d\u7684\u5728\u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u95f4\u4ea4\u4e92\uff0c\u6bcf\u4e00\u6b21\u4ea4\u4e92\u8fc7\u7a0b\u90fd\u7c7b\u4f3c\u4e8e\u7b80\u7b54\u8c03\u7528 \u8fd9\u4e9bworker\u8fdb\u7a0b\u7531 \u9a71\u52a8\u7a0b\u5e8f \u63a7\u5236\uff0c\u8be5\u9a71\u52a8\u7a0b\u5e8f\u5c06\u573a\u666f\u63cf\u8ff0\uff08\u91c7\u7528JSON\u683c\u5f0f\uff09\u548c\u6307\u5b9a\u6bcf\u4e2aworker\u8fdb\u7a0b\u7684host\uff1aport\u7684\u73af\u5883\u53d8\u91cf\u4f5c\u4e3a\u8f93\u5165\u3002 \u7f16\u7a0b\u8bed\u8a00\u6d4b\u8bd5 \u4ee5\u4e0b\u7f16\u7a0b\u8bed\u8a00\u4f5c\u4e3amaster\u4e0a\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u8fdb\u884c\u8fde\u7eed\u6027\u80fd\u6d4b\u8bd5\uff1a C++ Java Go C# node.js Python Ruby \u6b64\u5916\uff0c\u4eceC core\u6d3e\u751f\u7684\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u5728\u6bcf\u6b21\u62c9\u53d6\u8bf7\u6c42\u65f6\u8fdb\u884c\u4e86\u6709\u9650\u7684\u6027\u80fd\u6d4b\u8bd5\uff08\u70df\u56f1\u6d4b\u8bd5\uff09\u3002 \u9664\u4e86\u4f5c\u4e3a\u6027\u80fd\u6d4b\u8bd5\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u8fd0\u884c\u4e4b\u5916\uff0c\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u4e0eC++\u7248\u672c\u8fdb\u884c\u4ea4\u53c9\u6d4b\u8bd5\uff1a \u4f5c\u4e3a\u9488\u5bf9C++\u670d\u52a1\u7aef\u7684\u5ba2\u6237\u7aef\u8fdb\u884c\u6d4b\u8bd5 \u4f5c\u4e3a\u9488\u5bf9C++\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u7aef\u8fdb\u884c\u6d4b\u8bd5 \u6b64\u6d4b\u8bd5\u65e8\u5728\u4e3a\u7ed9\u5b9a\u8bed\u8a00\u7684\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u5b9e\u73b0\u63d0\u4f9b\u5f53\u524d\u7684\u6027\u80fd\u4e0a\u9650\uff0c\u800c\u65e0\u9700\u6d4b\u8bd5\u53e6\u4e00\u65b9\u3002 \u867d\u7136PHP\u6216\u79fb\u52a8\u73af\u5883\u4e0d\u652f\u6301gRPC\u670d\u52a1\u7aef\uff08\u6211\u4eec\u7684\u6027\u80fd\u6d4b\u8bd5\u9700\u8981\uff09\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u79cd\u7f16\u7a0b\u8bed\u8a00\u7f16\u5199\u7684\u4ee3\u7406WorkerService\u5bf9\u5176\u5ba2\u6237\u7aef\u6027\u80fd\u8fdb\u884c\u57fa\u51c6\u6d4b\u8bd5\u3002\u6b64\u4ee3\u7801\u662f\u4e3aPHP\u5b9e\u73b0\u7684\uff0c\u4f46\u5c1a\u672a\u5904\u4e8e\u8fde\u7eed\u6d4b\u8bd5\u6a21\u5f0f\u3002 \u5e94\u7528\u573a\u666f\u6d4b\u8bd5 \u6709\u51e0\u4e2a\u91cd\u8981\u7684\u573a\u666f\u6b63\u5728\u6d4b\u8bd5\u4e2d\u5e76\u663e\u793a\u5728\u4e0a\u9762\u7684\u4eea\u8868\u677f\u4e2d\uff0c\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a \u65e0\u7ade\u4e89\u5ef6\u8fdf\uff1a\u53ea\u67091\u4e2a\u5ba2\u6237\u7aef\u4f7f\u7528\u6d41\u6570\u636e\u8c03\u7528\uff0c\u4e00\u6b21\u53d1\u9001\u4e00\u6761\u6d88\u606f\u65f6\u770b\u5230\u7684\u4e2d\u4f4d\u6570\u548c\u5c3e\u90e8\u54cd\u5e94\u5ef6\u8fdf QPS\uff08Query Per Second\uff09\uff1a\u67092\u4e2a\u5ba2\u6237\u7aef\u548c\u603b\u517164\u4e2a\u901a\u9053\u65f6\u7684\u6bcf\u79d2\u5904\u7406\u6d88\u606f\u7684\u901f\u7387\uff0c\u6bcf\u4e2a\u901a\u9053\u4f7f\u7528\u6d41\u6570\u636e\u8c03\u7528\u4e00\u6b21\u53d1\u9001100\u4e2a\u672a\u5b8c\u6210\u7684\u6d88\u606f \u53ef\u4f38\u7f29\u6027\uff08\u9488\u5bf9\u6240\u9009\u7f16\u7a0b\u8bed\u8a00\uff09\uff1a\u6bcf\u4e2a\u670d\u52a1\u7aef\u6838\u5fc3\u7684\u6bcf\u79d2\u6d88\u606f\u5904\u7406\u901f\u7387 \u5927\u591a\u6570\u6027\u80fd\u6d4b\u8bd5\u90fd\u4f7f\u7528\u5b89\u5168\u901a\u4fe1\u548cprotobuf\u3002 \u4e00\u4e9bC++\u6d4b\u8bd5\u8fd8\u4f7f\u7528\u4e0d\u5b89\u5168\u7684\u901a\u4fe1\u548c\u901a\u7528\uff08\u975eprotobuf\uff09API\u6765\u663e\u793a\u5cf0\u503c\u6027\u80fd\u3002 \u6d4b\u8bd5\u57fa\u7840\u67b6\u6784 \u6240\u6709\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u90fd\u901a\u8fc7\u6211\u4eec\u7684Jenkins\u6d4b\u8bd5\u57fa\u7840\u67b6\u6784\u4f5c\u4e3aGCE\u4e2d\u7684\u5b9e\u4f8b\u8fd0\u884c\u3002\u9664\u4e86\u4e0a\u9762\u63cf\u8ff0\u7684gRPC\u6027\u80fd\u65b9\u6848\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u8fd0\u884c\u57fa\u7ebf netperf TCP_RR \u5ef6\u8fdf\u6570\uff0c\u4ee5\u4fbf\u4e86\u89e3\u5e95\u5c42\u7f51\u7edc\u7279\u5f81\u3002\u8fd9\u4e9b\u6570\u5b57\u51fa\u73b0\u5728\u6211\u4eec\u7684\u4eea\u8868\u677f\u4e0a\uff0c\u6709\u65f6\u4f1a\u6839\u636e\u6211\u4eec\u7684\u5b9e\u4f8b\u5728GCE\u4e2d\u7684\u5206\u914d\u4f4d\u7f6e\u800c\u6709\u6240\u4e0d\u540c\u3002 \u5927\u591a\u6570\u6d4b\u8bd5\u5b9e\u4f8b\u90fd\u662f8\u6838\u7cfb\u7edf\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u7528\u4e8e\u5ef6\u8fdf\u548cQPS\u6d4b\u91cf\u3002\u5bf9\u4e8eC++\u548cJava\uff0c\u6211\u4eec\u8fd8\u652f\u6301\u572832\u6838\u7cfb\u7edf\u4e0a\u8fdb\u884cQPS\u6d4b\u8bd5\u3002\u6240\u6709QPS\u6d4b\u8bd5\u90fd\u4e3a\u6bcf\u53f0\u670d\u52a1\u5668\u4f7f\u75282\u53f0\u76f8\u540c\u7684\u5ba2\u6237\u7aef\u8ba1\u7b97\u673a\uff0c\u4ee5\u786e\u4fddQPS\u6d4b\u91cf\u4e0d\u53d7\u5ba2\u6237\u7aef\u9650\u5236\u3002","title":"\u57fa\u51c6\u5316\u5206\u6790\u6cd5"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_1","text":"gRPC\u662f\u652f\u6301\u591a\u79cd\u7f16\u7a0b\u8bed\u8a00\u7684\u9ad8\u6027\u80fd\u5f00\u6e90RPC\u3002\u672c\u6587\u6863\u4ecb\u7ecd\u4e86\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u5de5\u5177\uff0c\u6d4b\u8bd5\u6240\u8003\u8651\u7684\u65b9\u6848\u4ee5\u53ca\u6d4b\u8bd5\u57fa\u7840\u67b6\u6784\u3002","title":"\u57fa\u51c6\u5316\u5206\u6790\u6cd5"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_2","text":"gRPC\u4e13\u7528\u4e8e\u8bbe\u8ba1\u9ad8\u6027\u80fd\u548c\u9ad8\u751f\u4ea7\u7387\u7684\u5206\u5e03\u5f0f\u5e94\u7528\u7a0b\u5e8f\u800c\u8bbe\u8ba1\u3002\u6301\u7eed\u7684\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u662fgRPC\u5f00\u53d1\u5de5\u4f5c\u6d41\u7a0b\u7684\u5173\u952e\u90e8\u5206\u3002\u9488\u5bf9\u4e3b\u5206\u652f\u6bcf\u5c0f\u65f6\u8fd0\u884c\u591a\u8bed\u8a00\u6027\u80fd\u6d4b\u8bd5\uff0c\u5e76\u5c06\u8fd9\u4e9b\u6d4b\u8bd5\u6570\u636e\u62a5\u544a\u7ed9\u4eea\u8868\u677f\u4ee5\u8fdb\u884c\u6570\u636e\u53ef\u89c6\u5316\u3002 \u591a\u8bed\u8a00\u6027\u80fd\u4eea\u8868\u677f@latest_release\uff08\u6700\u65b0\u53ef\u7528\u7a33\u5b9a\u7248\uff09 \u591a\u8bed\u8a00\u6027\u80fd\u4eea\u8868\u677f@master\uff08\u6700\u65b0\u5f00\u53d1\u7248\uff09 C++\u8be6\u7ec6\u6027\u80fd\u4eea\u8868\u677f@master\uff08\u6700\u65b0\u5f00\u53d1\u7248\uff09 \u989d\u5916\u7684\u57fa\u51c6\u6d4b\u8bd5\u53ef\u4ee5\u63d0\u4f9b\u6709\u5173CPU\u4f7f\u7528\u60c5\u51b5\u7684\u7ec6\u7c92\u5ea6\u6d1e\u5bdf\u3002 C++ full-stack microbenchmarks C Core filter benchmarks C Core shared component benchmarks C Core HTTP/2 microbenchmarks","title":"\u6982\u8ff0"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_3","text":"\u6bcf\u79cd\u7f16\u7a0b\u8bed\u8a00\u90fd\u5b9e\u73b0\u4e86\u4e00\u4e2agRPC WorkerService \u7684\u6027\u80fd\u6d4b\u8bd5worker\u3002\u6b64\u670d\u52a1\u6307\u793aworker\u5145\u5f53\u5b9e\u9645\u57fa\u51c6\u6d4b\u8bd5\u7684\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u5668\uff0c\u8868\u793a\u4e3a BenchmarkService \u3002\u8be5\u670d\u52a1\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a \u7b80\u5355\u8c03\u7528\uff1a\u4e00\u4e2a\u7b80\u5355\u7684PC\u8bf7\u6c42\uff0c\u5b83\u6307\u5b9a\u5728\u54cd\u5e94\u4e2d\u8fd4\u56de\u7684\u5b57\u8282\u6570 \u6d41\u6570\u636e\u8c03\u7528\uff1a\u4e00\u4e2a\u6d41\u6570\u636eRPC\u5141\u8bb8\u91cd\u590d\u7684\u5728\u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u95f4\u4ea4\u4e92\uff0c\u6bcf\u4e00\u6b21\u4ea4\u4e92\u8fc7\u7a0b\u90fd\u7c7b\u4f3c\u4e8e\u7b80\u7b54\u8c03\u7528 \u8fd9\u4e9bworker\u8fdb\u7a0b\u7531 \u9a71\u52a8\u7a0b\u5e8f \u63a7\u5236\uff0c\u8be5\u9a71\u52a8\u7a0b\u5e8f\u5c06\u573a\u666f\u63cf\u8ff0\uff08\u91c7\u7528JSON\u683c\u5f0f\uff09\u548c\u6307\u5b9a\u6bcf\u4e2aworker\u8fdb\u7a0b\u7684host\uff1aport\u7684\u73af\u5883\u53d8\u91cf\u4f5c\u4e3a\u8f93\u5165\u3002","title":"\u6027\u80fd\u6d4b\u8bd5\u8bbe\u8ba1"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_4","text":"\u4ee5\u4e0b\u7f16\u7a0b\u8bed\u8a00\u4f5c\u4e3amaster\u4e0a\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u8fdb\u884c\u8fde\u7eed\u6027\u80fd\u6d4b\u8bd5\uff1a C++ Java Go C# node.js Python Ruby \u6b64\u5916\uff0c\u4eceC core\u6d3e\u751f\u7684\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u5728\u6bcf\u6b21\u62c9\u53d6\u8bf7\u6c42\u65f6\u8fdb\u884c\u4e86\u6709\u9650\u7684\u6027\u80fd\u6d4b\u8bd5\uff08\u70df\u56f1\u6d4b\u8bd5\uff09\u3002 \u9664\u4e86\u4f5c\u4e3a\u6027\u80fd\u6d4b\u8bd5\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u8fd0\u884c\u4e4b\u5916\uff0c\u6240\u6709\u7f16\u7a0b\u8bed\u8a00\u90fd\u4e0eC++\u7248\u672c\u8fdb\u884c\u4ea4\u53c9\u6d4b\u8bd5\uff1a \u4f5c\u4e3a\u9488\u5bf9C++\u670d\u52a1\u7aef\u7684\u5ba2\u6237\u7aef\u8fdb\u884c\u6d4b\u8bd5 \u4f5c\u4e3a\u9488\u5bf9C++\u5ba2\u6237\u7aef\u7684\u670d\u52a1\u7aef\u8fdb\u884c\u6d4b\u8bd5 \u6b64\u6d4b\u8bd5\u65e8\u5728\u4e3a\u7ed9\u5b9a\u8bed\u8a00\u7684\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u5b9e\u73b0\u63d0\u4f9b\u5f53\u524d\u7684\u6027\u80fd\u4e0a\u9650\uff0c\u800c\u65e0\u9700\u6d4b\u8bd5\u53e6\u4e00\u65b9\u3002 \u867d\u7136PHP\u6216\u79fb\u52a8\u73af\u5883\u4e0d\u652f\u6301gRPC\u670d\u52a1\u7aef\uff08\u6211\u4eec\u7684\u6027\u80fd\u6d4b\u8bd5\u9700\u8981\uff09\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528\u53e6\u4e00\u79cd\u7f16\u7a0b\u8bed\u8a00\u7f16\u5199\u7684\u4ee3\u7406WorkerService\u5bf9\u5176\u5ba2\u6237\u7aef\u6027\u80fd\u8fdb\u884c\u57fa\u51c6\u6d4b\u8bd5\u3002\u6b64\u4ee3\u7801\u662f\u4e3aPHP\u5b9e\u73b0\u7684\uff0c\u4f46\u5c1a\u672a\u5904\u4e8e\u8fde\u7eed\u6d4b\u8bd5\u6a21\u5f0f\u3002","title":"\u7f16\u7a0b\u8bed\u8a00\u6d4b\u8bd5"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_5","text":"\u6709\u51e0\u4e2a\u91cd\u8981\u7684\u573a\u666f\u6b63\u5728\u6d4b\u8bd5\u4e2d\u5e76\u663e\u793a\u5728\u4e0a\u9762\u7684\u4eea\u8868\u677f\u4e2d\uff0c\u5305\u62ec\u4ee5\u4e0b\u5185\u5bb9\uff1a \u65e0\u7ade\u4e89\u5ef6\u8fdf\uff1a\u53ea\u67091\u4e2a\u5ba2\u6237\u7aef\u4f7f\u7528\u6d41\u6570\u636e\u8c03\u7528\uff0c\u4e00\u6b21\u53d1\u9001\u4e00\u6761\u6d88\u606f\u65f6\u770b\u5230\u7684\u4e2d\u4f4d\u6570\u548c\u5c3e\u90e8\u54cd\u5e94\u5ef6\u8fdf QPS\uff08Query Per Second\uff09\uff1a\u67092\u4e2a\u5ba2\u6237\u7aef\u548c\u603b\u517164\u4e2a\u901a\u9053\u65f6\u7684\u6bcf\u79d2\u5904\u7406\u6d88\u606f\u7684\u901f\u7387\uff0c\u6bcf\u4e2a\u901a\u9053\u4f7f\u7528\u6d41\u6570\u636e\u8c03\u7528\u4e00\u6b21\u53d1\u9001100\u4e2a\u672a\u5b8c\u6210\u7684\u6d88\u606f \u53ef\u4f38\u7f29\u6027\uff08\u9488\u5bf9\u6240\u9009\u7f16\u7a0b\u8bed\u8a00\uff09\uff1a\u6bcf\u4e2a\u670d\u52a1\u7aef\u6838\u5fc3\u7684\u6bcf\u79d2\u6d88\u606f\u5904\u7406\u901f\u7387 \u5927\u591a\u6570\u6027\u80fd\u6d4b\u8bd5\u90fd\u4f7f\u7528\u5b89\u5168\u901a\u4fe1\u548cprotobuf\u3002 \u4e00\u4e9bC++\u6d4b\u8bd5\u8fd8\u4f7f\u7528\u4e0d\u5b89\u5168\u7684\u901a\u4fe1\u548c\u901a\u7528\uff08\u975eprotobuf\uff09API\u6765\u663e\u793a\u5cf0\u503c\u6027\u80fd\u3002","title":"\u5e94\u7528\u573a\u666f\u6d4b\u8bd5"},{"location":"Frameworks/gRPC/05-\u57fa\u51c6\u5316\u5206\u6790\u6cd5/#_6","text":"\u6240\u6709\u6027\u80fd\u57fa\u51c6\u6d4b\u8bd5\u90fd\u901a\u8fc7\u6211\u4eec\u7684Jenkins\u6d4b\u8bd5\u57fa\u7840\u67b6\u6784\u4f5c\u4e3aGCE\u4e2d\u7684\u5b9e\u4f8b\u8fd0\u884c\u3002\u9664\u4e86\u4e0a\u9762\u63cf\u8ff0\u7684gRPC\u6027\u80fd\u65b9\u6848\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u8fd0\u884c\u57fa\u7ebf netperf TCP_RR \u5ef6\u8fdf\u6570\uff0c\u4ee5\u4fbf\u4e86\u89e3\u5e95\u5c42\u7f51\u7edc\u7279\u5f81\u3002\u8fd9\u4e9b\u6570\u5b57\u51fa\u73b0\u5728\u6211\u4eec\u7684\u4eea\u8868\u677f\u4e0a\uff0c\u6709\u65f6\u4f1a\u6839\u636e\u6211\u4eec\u7684\u5b9e\u4f8b\u5728GCE\u4e2d\u7684\u5206\u914d\u4f4d\u7f6e\u800c\u6709\u6240\u4e0d\u540c\u3002 \u5927\u591a\u6570\u6d4b\u8bd5\u5b9e\u4f8b\u90fd\u662f8\u6838\u7cfb\u7edf\uff0c\u8fd9\u4e9b\u7cfb\u7edf\u7528\u4e8e\u5ef6\u8fdf\u548cQPS\u6d4b\u91cf\u3002\u5bf9\u4e8eC++\u548cJava\uff0c\u6211\u4eec\u8fd8\u652f\u6301\u572832\u6838\u7cfb\u7edf\u4e0a\u8fdb\u884cQPS\u6d4b\u8bd5\u3002\u6240\u6709QPS\u6d4b\u8bd5\u90fd\u4e3a\u6bcf\u53f0\u670d\u52a1\u5668\u4f7f\u75282\u53f0\u76f8\u540c\u7684\u5ba2\u6237\u7aef\u8ba1\u7b97\u673a\uff0c\u4ee5\u786e\u4fddQPS\u6d4b\u91cf\u4e0d\u53d7\u5ba2\u6237\u7aef\u9650\u5236\u3002","title":"\u6d4b\u8bd5\u57fa\u7840\u67b6\u6784"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/","text":"gRPC over HTTP2 \u4ecb\u7ecd \u672c\u6587\u6863\u7528\u4f5c HTTP2 framing \u627f\u8f7d\u7684gRPC\u5b9e\u73b0\u7684\u8be6\u7ec6\u63cf\u8ff0\u3002\u5b83\u5047\u8bbe\u60a8\u719f\u6089HTTP2\u89c4\u8303\u3002 Protocol Production rules are using ABNF syntax . Outline The following is the general sequence of message atoms in a GRPC request response message stream Request \u2192 Request-Headers *Length-Prefixed-Message EOS Response \u2192 (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only Requests Request \u2192 Request-Headers *Length-Prefixed-Message EOS Request-Headers are delivered as HTTP2 headers in HEADERS + CONTINUATION frames. Request-Headers \u2192 Call-Definition *Custom-Metadata Call-Definition \u2192 Method Scheme Path TE [Authority] [Timeout] Content-Type [Message-Type] [Message-Encoding] [Message-Accept-Encoding] [User-Agent] Method \u2192 \":method POST\" Scheme \u2192 \":scheme \" (\"http\" / \"https\") Path \u2192 \":path\" \"/\" Service-Name \"/\" { method name } # But see note below. Service-Name \u2192 { IDL-specific service name } Authority \u2192 \":authority\" { virtual host name of authority } TE \u2192 \"te\" \"trailers\" # Used to detect incompatible proxies Timeout \u2192 \"grpc-timeout\" TimeoutValue TimeoutUnit TimeoutValue \u2192 { positive integer as ASCII string of at most 8 digits } TimeoutUnit \u2192 Hour / Minute / Second / Millisecond / Microsecond / Nanosecond Hour \u2192 \"H\" Minute \u2192 \"M\" Second \u2192 \"S\" Millisecond \u2192 \"m\" Microsecond \u2192 \"u\" Nanosecond \u2192 \"n\" Content-Type \u2192 \"content-type\" \"application/grpc\" [(\"+proto\" / \"+json\" / { custom })] Content-Coding \u2192 \"identity\" / \"gzip\" / \"deflate\" / \"snappy\" / { custom } Message-Encoding \u2192 \"grpc-encoding\" Content-Coding Message-Accept-Encoding \u2192 \"grpc-accept-encoding\" Content-Coding *(\",\" Content-Coding) User-Agent \u2192 \"user-agent\" { structured user-agent string } Message-Type \u2192 \"grpc-message-type\" { type name for message schema } Custom-Metadata \u2192 Binary-Header / ASCII-Header Binary-Header \u2192 {Header-Name \"-bin\" } { base64 encoded value } ASCII-Header \u2192 Header-Name ASCII-Value Header-Name \u2192 1*( %x30-39 / %x61-7A / \"_\" / \"-\" / \".\") ; 0-9 a-z _ - . ASCII-Value \u2192 1*( %x20-%x7E ) ; space and printable ASCII HTTP2 requires that reserved headers, ones starting with \":\" appear before all other headers. Additionally implementations should send Timeout immediately after the reserved headers and they should send the Call-Definition headers before sending Custom-Metadata . Some gRPC implementations may allow the Path format shown above to be overridden, but this functionality is strongly discouraged. gRPC does not go out of its way to break users that are using this kind of override, but we do not actively support it, and some functionality (e.g., service config support) will not work when the path is not of the form shown above. If Timeout is omitted a server should assume an infinite timeout. Client implementations are free to send a default minimum timeout based on their deployment requirements. If Content-Type does not begin with \"application/grpc\", gRPC servers SHOULD respond with HTTP status of 415 (Unsupported Media Type). This will prevent other HTTP/2 clients from interpreting a gRPC error response, which uses status 200 (OK), as successful. Custom-Metadata is an arbitrary set of key-value pairs defined by the application layer. Header names starting with \"grpc-\" but not listed here are reserved for future GRPC use and should not be used by applications as Custom-Metadata . Note that HTTP2 does not allow arbitrary octet sequences for header values so binary header values must be encoded using Base64 as per https://tools.ietf.org/html/rfc4648#section-4. Implementations MUST accept padded and un-padded values and should emit un-padded values. Applications define binary headers by having their names end with \"-bin\". Runtime libraries use this suffix to detect binary headers and properly apply base64 encoding decoding as headers are sent and received. Custom-Metadata header order is not guaranteed to be preserved except for values with duplicate header names. Duplicate header names may have their values joined with \",\" as the delimiter and be considered semantically equivalent. Implementations must split Binary-Header s on \",\" before decoding the Base64-encoded values. ASCII-Value should not have leading or trailing whitespace. If it contains leading or trailing whitespace, it may be stripped. The ASCII-Value character range defined is more strict than HTTP. Implementations must not error due to receiving an invalid ASCII-Value that's a valid field-value in HTTP, but the precise behavior is not strictly defined: they may throw the value away or accept the value. If accepted, care must be taken to make sure that the application is permitted to echo the value back as metadata. For example, if the metadata is provided to the application as a list in a request, the application should not trigger an error by providing that same list as the metadata in the response. Servers may limit the size of Request-Headers , with a default of 8 KiB suggested. Implementations are encouraged to compute total header size like HTTP/2's SETTINGS_MAX_HEADER_LIST_SIZE : the sum of all header fields, for each field the sum of the uncompressed field name and value lengths plus 32, with binary values' lengths being post-Base64. The repeated sequence of Length-Prefixed-Message items is delivered in DATA frames Length-Prefixed-Message \u2192 Compressed-Flag Message-Length Message Compressed-Flag \u2192 0 / 1 # encoded as 1 byte unsigned integer Message-Length \u2192 { length of Message } # encoded as 4 byte unsigned integer (big endian) Message \u2192 *{binary octet} A Compressed-Flag value of 1 indicates that the binary octet sequence of Message is compressed using the mechanism declared by the Message-Encoding header. A value of 0 indicates that no encoding of Message bytes has occurred. Compression contexts are NOT maintained over message boundaries, implementations must create a new context for each message in the stream. If the Message-Encoding header is omitted then the Compressed-Flag must be 0. For requests, EOS (end-of-stream) is indicated by the presence of the END_STREAM flag on the last received DATA frame. In scenarios where the Request stream needs to be closed but no data remains to be sent implementations MUST send an empty DATA frame with this flag set. Responses Response \u2192 (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only Response-Headers \u2192 HTTP-Status [Message-Encoding] [Message-Accept-Encoding] Content-Type *Custom-Metadata Trailers-Only \u2192 HTTP-Status Content-Type Trailers Trailers \u2192 Status [Status-Message] *Custom-Metadata HTTP-Status \u2192 \":status 200\" Status \u2192 \"grpc-status\" 1*DIGIT ; 0-9 Status-Message \u2192 \"grpc-message\" Percent-Encoded Percent-Encoded \u2192 1*(Percent-Byte-Unencoded / Percent-Byte-Encoded) Percent-Byte-Unencoded \u2192 1*( %x20-%x24 / %x26-%x7E ) ; space and VCHAR, except % Percent-Byte-Encoded \u2192 \"%\" 2HEXDIGIT ; 0-9 A-F Response-Headers Trailers-Only are each delivered in a single HTTP2 HEADERS frame block. Most responses are expected to have both headers and trailers but Trailers-Only is permitted for calls that produce an immediate error. Status must be sent in Trailers even if the status code is OK. For responses end-of-stream is indicated by the presence of the END_STREAM flag on the last received HEADERS frame that carries Trailers . Implementations should expect broken deployments to send non-200 HTTP status codes in responses as well as a variety of non-GRPC content-types and to omit Status Status-Message . Implementations must synthesize a Status Status-Message to propagate to the application layer when this occurs. Clients may limit the size of Response-Headers , Trailers , and Trailers-Only , with a default of 8 KiB each suggested. The value portion of Status is a decimal-encoded integer as an ASCII string, without any leading zeros. The value portion of Status-Message is conceptually a Unicode string description of the error, physically encoded as UTF-8 followed by percent-encoding. Percent-encoding is specified in RFC 3986 \u00a72.1 , although the form used here has different restricted characters. When decoding invalid values, implementations MUST NOT error or throw away the message. At worst, the implementation can abort decoding the status message altogether such that the user would received the raw percent-encoded form. Alternatively, the implementation can decode valid portions while leaving broken %-encodings as-is or replacing them with a replacement character (e.g., '?' or the Unicode replacement character). Example Sample unary-call showing HTTP2 framing sequence Request HEADERS (flags = END_HEADERS) :method = POST :scheme = http :path = /google.pubsub.v2.PublisherService/CreateTopic :authority = pubsub.googleapis.com grpc-timeout = 1S content-type = application/grpc+proto grpc-encoding = gzip authorization = Bearer y235.wef315yfh138vh31hv93hv8h3v DATA (flags = END_STREAM) Length-Prefixed Message Response HEADERS (flags = END_HEADERS) :status = 200 grpc-encoding = gzip content-type = application/grpc+proto DATA Length-Prefixed Message HEADERS (flags = END_STREAM, END_HEADERS) grpc-status = 0 # OK trace-proto-bin = jher831yy13JHy3hc User Agents While the protocol does not require a user-agent to function it is recommended that clients provide a structured user-agent string that provides a basic description of the calling library, version platform to facilitate issue diagnosis in heterogeneous environments. The following structure is recommended to library developers User-Agent \u2192 grpc- Language ?( - Variant) / Version ?( ( *(AdditionalProperty ; ) ) ) E.g. grpc-java/1.2.3 grpc-ruby/1.2.3 grpc-ruby-jruby/1.3.4 grpc-java-android/0.9.1 (gingerbread/1.2.4; nexus5; tmobile) Idempotency and Retries Unless explicitly defined to be, gRPC Calls are not assumed to be idempotent. Specifically: Calls that cannot be proven to have started will not be retried. There is no mechanism for duplicate suppression as it is not necessary. Calls that are marked as idempotent may be sent multiple times. HTTP2 Transport Mapping Stream Identification All GRPC calls need to specify an internal ID. We will use HTTP2 stream-ids as call identifiers in this scheme. NOTE: These ids are contextual to an open HTTP2 session and will not be unique within a given process that is handling more than one HTTP2 session nor can they be used as GUIDs. Data Frames DATA frame boundaries have no relation to Length-Prefixed-Message boundaries and implementations should make no assumptions about their alignment. Errors When an application or runtime error occurs during an RPC a Status and Status-Message are delivered in Trailers . In some cases it is possible that the framing of the message stream has become corrupt and the RPC runtime will choose to use an RST_STREAM frame to indicate this state to its peer. RPC runtime implementations should interpret RST_STREAM as immediate full-closure of the stream and should propagate an error up to the calling application layer. The following mapping from RST_STREAM error codes to GRPC error codes is applied. HTTP2 Code GRPC Code NO_ERROR(0) INTERNAL - An explicit GRPC status of OK should have been sent but this might be used to aggressively lameduck in some scenarios. PROTOCOL_ERROR(1) INTERNAL INTERNAL_ERROR(2) INTERNAL FLOW_CONTROL_ERROR(3) INTERNAL SETTINGS_TIMEOUT(4) INTERNAL STREAM_CLOSED No mapping as there is no open stream to propagate to. Implementations should log. FRAME_SIZE_ERROR INTERNAL REFUSED_STREAM UNAVAILABLE - Indicates that no processing occurred and the request can be retried, possibly elsewhere. CANCEL(8) Mapped to call cancellation when sent by a client.Mapped to CANCELLED when sent by a server. Note that servers should only use this mechanism when they need to cancel a call but the payload byte sequence is incomplete. COMPRESSION_ERROR INTERNAL CONNECT_ERROR INTERNAL ENHANCE_YOUR_CALM RESOURCE_EXHAUSTED ...with additional error detail provided by runtime to indicate that the exhausted resource is bandwidth. INADEQUATE_SECURITY PERMISSION_DENIED \u2026 with additional detail indicating that permission was denied as protocol is not secure enough for call. Security The HTTP2 specification mandates the use of TLS 1.2 or higher when TLS is used with HTTP2. It also places some additional constraints on the allowed ciphers in deployments to avoid known-problems as well as requiring SNI support. It is also expected that HTTP2 will be used in conjunction with proprietary transport security mechanisms about which the specification can make no meaningful recommendations. Connection Management GOAWAY Frame Sent by servers to clients to indicate that they will no longer accept any new streams on the associated connections. This frame includes the id of the last successfully accepted stream by the server. Clients should consider any stream initiated after the last successfully accepted stream as UNAVAILABLE and retry the call elsewhere. Clients are free to continue working with the already accepted streams until they complete or the connection is terminated. Servers should send GOAWAY before terminating a connection to reliably inform clients which work has been accepted by the server and is being executed. PING Frame Both clients and servers can send a PING frame that the peer must respond to by precisely echoing what they received. This is used to assert that the connection is still live as well as providing a means to estimate end-to-end latency. If a server initiated PING does not receive a response within the deadline expected by the runtime all outstanding calls on the server will be closed with a CANCELLED status. An expired client initiated PING will cause all calls to be closed with an UNAVAILABLE status. Note that the frequency of PINGs is highly dependent on the network environment, implementations are free to adjust PING frequency based on network and application requirements. Connection failure If a detectable connection failure occurs on the client all calls will be closed with an UNAVAILABLE status. For servers open calls will be closed with a CANCELLED status. Appendix A - GRPC for Protobuf The service interfaces declared by protobuf are easily mapped onto GRPC by code generation extensions to protoc. The following defines the mapping to be used. Service-Name \u2192 ?( { proto package name } \".\" ) { service name } Message-Type \u2192 { fully qualified proto message name } Content-Type \u2192 \"application/grpc+proto\"","title":"gRPC over HTTP2"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#grpc-over-http2","text":"","title":"gRPC over HTTP2"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#_1","text":"\u672c\u6587\u6863\u7528\u4f5c HTTP2 framing \u627f\u8f7d\u7684gRPC\u5b9e\u73b0\u7684\u8be6\u7ec6\u63cf\u8ff0\u3002\u5b83\u5047\u8bbe\u60a8\u719f\u6089HTTP2\u89c4\u8303\u3002","title":"\u4ecb\u7ecd"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#protocol","text":"Production rules are using ABNF syntax .","title":"Protocol"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#outline","text":"The following is the general sequence of message atoms in a GRPC request response message stream Request \u2192 Request-Headers *Length-Prefixed-Message EOS Response \u2192 (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only","title":"Outline"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#requests","text":"Request \u2192 Request-Headers *Length-Prefixed-Message EOS Request-Headers are delivered as HTTP2 headers in HEADERS + CONTINUATION frames. Request-Headers \u2192 Call-Definition *Custom-Metadata Call-Definition \u2192 Method Scheme Path TE [Authority] [Timeout] Content-Type [Message-Type] [Message-Encoding] [Message-Accept-Encoding] [User-Agent] Method \u2192 \":method POST\" Scheme \u2192 \":scheme \" (\"http\" / \"https\") Path \u2192 \":path\" \"/\" Service-Name \"/\" { method name } # But see note below. Service-Name \u2192 { IDL-specific service name } Authority \u2192 \":authority\" { virtual host name of authority } TE \u2192 \"te\" \"trailers\" # Used to detect incompatible proxies Timeout \u2192 \"grpc-timeout\" TimeoutValue TimeoutUnit TimeoutValue \u2192 { positive integer as ASCII string of at most 8 digits } TimeoutUnit \u2192 Hour / Minute / Second / Millisecond / Microsecond / Nanosecond Hour \u2192 \"H\" Minute \u2192 \"M\" Second \u2192 \"S\" Millisecond \u2192 \"m\" Microsecond \u2192 \"u\" Nanosecond \u2192 \"n\" Content-Type \u2192 \"content-type\" \"application/grpc\" [(\"+proto\" / \"+json\" / { custom })] Content-Coding \u2192 \"identity\" / \"gzip\" / \"deflate\" / \"snappy\" / { custom } Message-Encoding \u2192 \"grpc-encoding\" Content-Coding Message-Accept-Encoding \u2192 \"grpc-accept-encoding\" Content-Coding *(\",\" Content-Coding) User-Agent \u2192 \"user-agent\" { structured user-agent string } Message-Type \u2192 \"grpc-message-type\" { type name for message schema } Custom-Metadata \u2192 Binary-Header / ASCII-Header Binary-Header \u2192 {Header-Name \"-bin\" } { base64 encoded value } ASCII-Header \u2192 Header-Name ASCII-Value Header-Name \u2192 1*( %x30-39 / %x61-7A / \"_\" / \"-\" / \".\") ; 0-9 a-z _ - . ASCII-Value \u2192 1*( %x20-%x7E ) ; space and printable ASCII HTTP2 requires that reserved headers, ones starting with \":\" appear before all other headers. Additionally implementations should send Timeout immediately after the reserved headers and they should send the Call-Definition headers before sending Custom-Metadata . Some gRPC implementations may allow the Path format shown above to be overridden, but this functionality is strongly discouraged. gRPC does not go out of its way to break users that are using this kind of override, but we do not actively support it, and some functionality (e.g., service config support) will not work when the path is not of the form shown above. If Timeout is omitted a server should assume an infinite timeout. Client implementations are free to send a default minimum timeout based on their deployment requirements. If Content-Type does not begin with \"application/grpc\", gRPC servers SHOULD respond with HTTP status of 415 (Unsupported Media Type). This will prevent other HTTP/2 clients from interpreting a gRPC error response, which uses status 200 (OK), as successful. Custom-Metadata is an arbitrary set of key-value pairs defined by the application layer. Header names starting with \"grpc-\" but not listed here are reserved for future GRPC use and should not be used by applications as Custom-Metadata . Note that HTTP2 does not allow arbitrary octet sequences for header values so binary header values must be encoded using Base64 as per https://tools.ietf.org/html/rfc4648#section-4. Implementations MUST accept padded and un-padded values and should emit un-padded values. Applications define binary headers by having their names end with \"-bin\". Runtime libraries use this suffix to detect binary headers and properly apply base64 encoding decoding as headers are sent and received. Custom-Metadata header order is not guaranteed to be preserved except for values with duplicate header names. Duplicate header names may have their values joined with \",\" as the delimiter and be considered semantically equivalent. Implementations must split Binary-Header s on \",\" before decoding the Base64-encoded values. ASCII-Value should not have leading or trailing whitespace. If it contains leading or trailing whitespace, it may be stripped. The ASCII-Value character range defined is more strict than HTTP. Implementations must not error due to receiving an invalid ASCII-Value that's a valid field-value in HTTP, but the precise behavior is not strictly defined: they may throw the value away or accept the value. If accepted, care must be taken to make sure that the application is permitted to echo the value back as metadata. For example, if the metadata is provided to the application as a list in a request, the application should not trigger an error by providing that same list as the metadata in the response. Servers may limit the size of Request-Headers , with a default of 8 KiB suggested. Implementations are encouraged to compute total header size like HTTP/2's SETTINGS_MAX_HEADER_LIST_SIZE : the sum of all header fields, for each field the sum of the uncompressed field name and value lengths plus 32, with binary values' lengths being post-Base64. The repeated sequence of Length-Prefixed-Message items is delivered in DATA frames Length-Prefixed-Message \u2192 Compressed-Flag Message-Length Message Compressed-Flag \u2192 0 / 1 # encoded as 1 byte unsigned integer Message-Length \u2192 { length of Message } # encoded as 4 byte unsigned integer (big endian) Message \u2192 *{binary octet} A Compressed-Flag value of 1 indicates that the binary octet sequence of Message is compressed using the mechanism declared by the Message-Encoding header. A value of 0 indicates that no encoding of Message bytes has occurred. Compression contexts are NOT maintained over message boundaries, implementations must create a new context for each message in the stream. If the Message-Encoding header is omitted then the Compressed-Flag must be 0. For requests, EOS (end-of-stream) is indicated by the presence of the END_STREAM flag on the last received DATA frame. In scenarios where the Request stream needs to be closed but no data remains to be sent implementations MUST send an empty DATA frame with this flag set.","title":"Requests"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#responses","text":"Response \u2192 (Response-Headers *Length-Prefixed-Message Trailers) / Trailers-Only Response-Headers \u2192 HTTP-Status [Message-Encoding] [Message-Accept-Encoding] Content-Type *Custom-Metadata Trailers-Only \u2192 HTTP-Status Content-Type Trailers Trailers \u2192 Status [Status-Message] *Custom-Metadata HTTP-Status \u2192 \":status 200\" Status \u2192 \"grpc-status\" 1*DIGIT ; 0-9 Status-Message \u2192 \"grpc-message\" Percent-Encoded Percent-Encoded \u2192 1*(Percent-Byte-Unencoded / Percent-Byte-Encoded) Percent-Byte-Unencoded \u2192 1*( %x20-%x24 / %x26-%x7E ) ; space and VCHAR, except % Percent-Byte-Encoded \u2192 \"%\" 2HEXDIGIT ; 0-9 A-F Response-Headers Trailers-Only are each delivered in a single HTTP2 HEADERS frame block. Most responses are expected to have both headers and trailers but Trailers-Only is permitted for calls that produce an immediate error. Status must be sent in Trailers even if the status code is OK. For responses end-of-stream is indicated by the presence of the END_STREAM flag on the last received HEADERS frame that carries Trailers . Implementations should expect broken deployments to send non-200 HTTP status codes in responses as well as a variety of non-GRPC content-types and to omit Status Status-Message . Implementations must synthesize a Status Status-Message to propagate to the application layer when this occurs. Clients may limit the size of Response-Headers , Trailers , and Trailers-Only , with a default of 8 KiB each suggested. The value portion of Status is a decimal-encoded integer as an ASCII string, without any leading zeros. The value portion of Status-Message is conceptually a Unicode string description of the error, physically encoded as UTF-8 followed by percent-encoding. Percent-encoding is specified in RFC 3986 \u00a72.1 , although the form used here has different restricted characters. When decoding invalid values, implementations MUST NOT error or throw away the message. At worst, the implementation can abort decoding the status message altogether such that the user would received the raw percent-encoded form. Alternatively, the implementation can decode valid portions while leaving broken %-encodings as-is or replacing them with a replacement character (e.g., '?' or the Unicode replacement character).","title":"Responses"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#example","text":"Sample unary-call showing HTTP2 framing sequence Request HEADERS (flags = END_HEADERS) :method = POST :scheme = http :path = /google.pubsub.v2.PublisherService/CreateTopic :authority = pubsub.googleapis.com grpc-timeout = 1S content-type = application/grpc+proto grpc-encoding = gzip authorization = Bearer y235.wef315yfh138vh31hv93hv8h3v DATA (flags = END_STREAM) Length-Prefixed Message Response HEADERS (flags = END_HEADERS) :status = 200 grpc-encoding = gzip content-type = application/grpc+proto DATA Length-Prefixed Message HEADERS (flags = END_STREAM, END_HEADERS) grpc-status = 0 # OK trace-proto-bin = jher831yy13JHy3hc","title":"Example"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#user-agents","text":"While the protocol does not require a user-agent to function it is recommended that clients provide a structured user-agent string that provides a basic description of the calling library, version platform to facilitate issue diagnosis in heterogeneous environments. The following structure is recommended to library developers User-Agent \u2192 grpc- Language ?( - Variant) / Version ?( ( *(AdditionalProperty ; ) ) ) E.g. grpc-java/1.2.3 grpc-ruby/1.2.3 grpc-ruby-jruby/1.3.4 grpc-java-android/0.9.1 (gingerbread/1.2.4; nexus5; tmobile)","title":"User Agents"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#idempotency-and-retries","text":"Unless explicitly defined to be, gRPC Calls are not assumed to be idempotent. Specifically: Calls that cannot be proven to have started will not be retried. There is no mechanism for duplicate suppression as it is not necessary. Calls that are marked as idempotent may be sent multiple times.","title":"Idempotency and Retries"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#http2-transport-mapping","text":"","title":"HTTP2 Transport Mapping"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#stream-identification","text":"All GRPC calls need to specify an internal ID. We will use HTTP2 stream-ids as call identifiers in this scheme. NOTE: These ids are contextual to an open HTTP2 session and will not be unique within a given process that is handling more than one HTTP2 session nor can they be used as GUIDs.","title":"Stream Identification"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#data-frames","text":"DATA frame boundaries have no relation to Length-Prefixed-Message boundaries and implementations should make no assumptions about their alignment.","title":"Data Frames"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#errors","text":"When an application or runtime error occurs during an RPC a Status and Status-Message are delivered in Trailers . In some cases it is possible that the framing of the message stream has become corrupt and the RPC runtime will choose to use an RST_STREAM frame to indicate this state to its peer. RPC runtime implementations should interpret RST_STREAM as immediate full-closure of the stream and should propagate an error up to the calling application layer. The following mapping from RST_STREAM error codes to GRPC error codes is applied. HTTP2 Code GRPC Code NO_ERROR(0) INTERNAL - An explicit GRPC status of OK should have been sent but this might be used to aggressively lameduck in some scenarios. PROTOCOL_ERROR(1) INTERNAL INTERNAL_ERROR(2) INTERNAL FLOW_CONTROL_ERROR(3) INTERNAL SETTINGS_TIMEOUT(4) INTERNAL STREAM_CLOSED No mapping as there is no open stream to propagate to. Implementations should log. FRAME_SIZE_ERROR INTERNAL REFUSED_STREAM UNAVAILABLE - Indicates that no processing occurred and the request can be retried, possibly elsewhere. CANCEL(8) Mapped to call cancellation when sent by a client.Mapped to CANCELLED when sent by a server. Note that servers should only use this mechanism when they need to cancel a call but the payload byte sequence is incomplete. COMPRESSION_ERROR INTERNAL CONNECT_ERROR INTERNAL ENHANCE_YOUR_CALM RESOURCE_EXHAUSTED ...with additional error detail provided by runtime to indicate that the exhausted resource is bandwidth. INADEQUATE_SECURITY PERMISSION_DENIED \u2026 with additional detail indicating that permission was denied as protocol is not secure enough for call.","title":"Errors"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#security","text":"The HTTP2 specification mandates the use of TLS 1.2 or higher when TLS is used with HTTP2. It also places some additional constraints on the allowed ciphers in deployments to avoid known-problems as well as requiring SNI support. It is also expected that HTTP2 will be used in conjunction with proprietary transport security mechanisms about which the specification can make no meaningful recommendations.","title":"Security"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#connection-management","text":"","title":"Connection Management"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#goaway-frame","text":"Sent by servers to clients to indicate that they will no longer accept any new streams on the associated connections. This frame includes the id of the last successfully accepted stream by the server. Clients should consider any stream initiated after the last successfully accepted stream as UNAVAILABLE and retry the call elsewhere. Clients are free to continue working with the already accepted streams until they complete or the connection is terminated. Servers should send GOAWAY before terminating a connection to reliably inform clients which work has been accepted by the server and is being executed.","title":"GOAWAY Frame"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#ping-frame","text":"Both clients and servers can send a PING frame that the peer must respond to by precisely echoing what they received. This is used to assert that the connection is still live as well as providing a means to estimate end-to-end latency. If a server initiated PING does not receive a response within the deadline expected by the runtime all outstanding calls on the server will be closed with a CANCELLED status. An expired client initiated PING will cause all calls to be closed with an UNAVAILABLE status. Note that the frequency of PINGs is highly dependent on the network environment, implementations are free to adjust PING frequency based on network and application requirements.","title":"PING Frame"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#connection-failure","text":"If a detectable connection failure occurs on the client all calls will be closed with an UNAVAILABLE status. For servers open calls will be closed with a CANCELLED status.","title":"Connection failure"},{"location":"Frameworks/gRPC/06-gRPC\u7f16\u5199\u683c\u5f0f/#appendix-a-grpc-for-protobuf","text":"The service interfaces declared by protobuf are easily mapped onto GRPC by code generation extensions to protoc. The following defines the mapping to be used. Service-Name \u2192 ?( { proto package name } \".\" ) { service name } Message-Type \u2192 { fully qualified proto message name } Content-Type \u2192 \"application/grpc+proto\"","title":"Appendix A - GRPC for Protobuf"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/","text":"Go \u5feb\u901f\u5165\u95e8 \u672c\u6307\u5357\u4ee5\u7b80\u5355\u7684\u5de5\u4f5c\u793a\u4f8b\u4e3a\u60a8\u4ecb\u7ecdGo\u4e2d\u7684gRPC\u3002 \u5148\u51b3\u6761\u4ef6 Go \u7248\u672c gRPC\u8981\u6c42Go\u7248\u672c\u5927\u4e8e\u7b49\u4e8e1.6\uff1a sugoi@Sugoi-PC:~$ go version go version go1.12.7 linux/amd64 \u6709\u5173\u5b89\u88c5\u8bf4\u660e\uff0c\u8bf7\u9075\u5faa\u4ee5\u4e0b\u6307\u5357\uff1a \u5165\u95e8-Go\u7f16\u7a0b\u8bed\u8a00 \u3002 \u5b89\u88c5gRPC \u4f7f\u7528\u4e0b\u9762\u7684\u6307\u4ee4\u5b89\u88c5gRPC: go get -u google.golang.org/grpc \u5b89\u88c5protocol buffers v3 \u5b89\u88c5\u7528\u4e8e\u751f\u6210gRPC\u670d\u52a1\u4ee3\u7801\u7684protoc\u7f16\u8bd1\u5668\u3002\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4ece \u6b64\u5904 \u4e0b\u8f7d\u9002\u7528\u4e8e\u60a8\u7684\u5e73\u53f0\u7684\u9884\u7f16\u8bd1\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08 protoc- version - platform .zip \uff09\uff1a \u89e3\u538b\u7f29\u6b64\u6587\u4ef6 \u66f4\u65b0\u73af\u5883\u53d8\u91cfPATH\u4ee5\u5305\u542bprotoc\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u8def\u5f84 # protoc environment export PATH=$PATH:/opt/protoc/bin \u63a5\u4e0b\u6765\uff0c\u4e3aGo\u5b89\u88c5protoc\u63d2\u4ef6\u3002 go get -u github.com/golang/protobuf/protoc-gen-go \u7f16\u8bd1\u5668\u63d2\u4ef6 protoc-gen-go \u5c06\u5b89\u88c5\u5728 $GOBIN \u4e2d\uff0c\u9ed8\u8ba4\u4e3a $GOPATH/bin ,\u5b83\u5fc5\u987b\u5728\u4f60\u7684 $PATH \u4e2d\uff0c\u8fd9\u6837protocol\u7684\u7f16\u8bd1\u5668 protoc \u624d\u80fd\u627e\u5230\u5b83\u3002 # Golang environment export GOPATH=/home/sugoi/go export PATH=$PATH:/opt/go/bin:$GOPATH/bin \u4e0b\u8f7d\u793a\u4f8b \u4f7f\u7528 go get google.golang.org/grpc \u83b7\u53d6\u7684grpc\u4ee3\u7801\u4e5f\u5305\u542b\u5b83\u793a\u4f8b\u3002\u5b83\u4eec\u53ef\u4ee5\u5728\u793a\u4f8b dir:$GOPATH/src/google.golang.org/grpc/examples \u4e0b\u627e\u5230\u3002 \u7f16\u8bd1\u793a\u4f8b \u8fdb\u5165\u793a\u4f8b\u6240\u5728\u7684\u76ee\u5f55\u4e0b\uff1a cd $GOPATH/src/google.golang.org/grpc/examples/helloworld gRPC\u670d\u52a1\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u8be5\u6587\u4ef6\u7528\u4e8e\u751f\u6210\u76f8\u5e94\u7684 .pb.go \u6587\u4ef6\u3002 .pb.go \u6587\u4ef6\u662f\u901a\u8fc7\u4f7f\u7528protocol\u7f16\u8bd1\u5668\uff08 protoc \uff09\u7f16\u8bd1 .proto \u6587\u4ef6\u751f\u6210\u7684\u3002 \u6b64\u793a\u4f8b\u5df2\u751f\u6210 helloworld.pb.go \u6587\u4ef6\uff08\u901a\u8fc7\u7f16\u8bd1 helloworld.proto \u751f\u6210\uff09\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6b64\u76ee\u5f55\u4e2d\u627e\u5230\uff1a $GOPATH/src/google.golang.org/grpc/examples/helloworld/helloworld helloworld.pb.go \u6587\u4ef6\u5305\u542b\uff1a \u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u4ee3\u7801 \u7528\u4e8e\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22 HelloRequest \u548c HelloReply \u6d88\u606f\u7c7b\u578b\u7684\u4ee3\u7801 \u5c1d\u8bd5\u4e00\u4e0b \u4f7f\u7528 go run \u4ee3\u7801\u6765\u7f16\u8bd1\u5e76\u6267\u884c\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\uff0c\u5728\u793a\u4f8b\u76ee\u5f55\u4e0b\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a # \u5728\u7b2c\u4e00\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef $ go run greeter_server/main.go # \u5728\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef $ go run greeter_client/main.go \u5982\u679c\u4e00\u5207\u987a\u5229\u7684\u8bdd\uff0c\u5c06\u4f1a\u5728\u8fd0\u884c\u5ba2\u6237\u7aef\u7684\u547d\u4ee4\u884c\u7ec8\u7aef\u4e2d\u770b\u5230\u8f93\u51fa\u4fe1\u606f\uff1a Greeting: Hello World \u3002 \u8fd9\u6837\u5c31\u6210\u529f\u7684\u4f7f\u7528gRPC\u8fd0\u884c\u5ba2\u6237\u7aef-\u670d\u52a1\u7aef\u5e94\u7528\u7a0b\u5e8f\u3002 \u66f4\u65b0gRPC\u670d\u52a1\u7aef \u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u4e2d\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u4ee5\u4f9b\u5ba2\u6237\u7aef\u8c03\u7528\u3002\u6211\u4eec\u7684gRPC\u670d\u52a1\u662f\u4f7f\u7528protocol buffers\u5b9a\u4e49\u7684\uff1b\u53ef\u4ee5\u5728 gRPC\u7b80\u4ecb \u548c gRPC\u57fa\u7840:Go \u4e2d\u627e\u5230\u66f4\u591a\u5173\u4e8e\u5982\u4f55\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u670d\u52a1\u7684\u77e5\u8bc6\u3002\u73b0\u5728\u9700\u8981\u77e5\u9053\u7684\u662f\uff0c\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u662fstub\u90fd\u6709\u4e00\u4e2a SayHello RPC\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6 HelloRequest \u53c2\u6570\u5e76\u4ece\u670d\u52a1\u5668\u8fd4\u56de HelloReply \uff0c\u6b64\u65b9\u6cd5\u5b9a\u4e49\u5982\u4e0b\uff1a // The greeting service definition. service Greeter { // Sends a greeting rpc SayHello (HelloRequest) returns (HelloReply) {} } // The request message containing the user's name. message HelloRequest { string name = 1; } // The response message containing the greetings message HelloReply { string message = 1; } \u8ba9\u6211\u4eec\u66f4\u65b0\u4e00\u4e0b\u4ee3\u7801\uff0c\u4f7f Greeter \u670d\u52a1\u6709\u4e24\u79cd\u65b9\u6cd5\u3002\u786e\u4fdd\u5728\u793a\u4f8b\u76ee\u5f55\u4e0b\uff08 $GOPATH/src/google.golang.org/grpc/examples/helloworld \uff09\u3002 \u7f16\u8f91 helloworld/helloworld.proto \u5e76\u4f7f\u7528\u65b0\u7684 SayHelloAgain \u65b9\u6cd5\u66f4\u65b0\u5b83\uff0c\u65b0\u65b9\u6cd5\u5177\u6709\u76f8\u540c\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u7c7b\u578b\uff1a // The greeting service definition. service Greeter { // Sends a greeting rpc SayHello (HelloRequest) returns (HelloReply) {} // Sends another greeting rpc SayHelloAgain (HelloRequest) returns (HelloReply) {} } // The request message containing the user's name. message HelloRequest { string name = 1; } // The response message containing the greetings message HelloReply { string message = 1; } \u751f\u6210gRPC\u4ee3\u7801 \u63a5\u4e0b\u6765\uff0c\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u7684gRPC\u4ee3\u7801\u4ee5\u4f7f\u7528\u65b0\u7684\u670d\u52a1\u5b9a\u4e49\uff0c\u8fd8\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u76ee\u5f55\uff08 $GOPATH/src/google.golang.org/grpc/examples/helloworld \uff09 protoc -I helloworld/ helloworld/helloworld.proto --go_out=plugins=grpc:helloworld \u8fd9\u4f1a\u4f7f\u6211\u4eec\u7684\u66f4\u6539\u91cd\u65b0\u751f\u6210 helloworld.pb.go \u6587\u4ef6\u3002 \u66f4\u65b0\u5e76\u8fd0\u884c\u5e94\u7528 \u73b0\u5728\u6709\u4e86\u65b0\u751f\u6210\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\uff0c\u8fd8\u9700\u8981\u5728\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\u7684\u624b\u52a8\u7f16\u5199\u90e8\u5206\u4e2d\u5b9e\u73b0\u5e76\u8c03\u7528\u65b0\u65b9\u6cd5\u3002 \u66f4\u65b0\u670d\u52a1\u7aef \u7f16\u8f91 greeter_server/main.go \u5e76\u5411\u5176\u6dfb\u52a0\u4ee5\u4e0b\u51fd\u6570\uff1a func (s *server) SayHelloAgain(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) { return pb.HelloReply{Message: Hello again + in.Name}, nil } \u66f4\u65b0\u5ba2\u6237\u7aef \u7f16\u8f91 greeter_client/main.go \u5e76\u5411\u5176\u6dfb\u52a0\u4ee5\u4e0b\u51fd\u6570\uff1a r, err = c.SayHelloAgain(ctx, pb.HelloRequest{Name: name}) if err != nil { log.Fatalf( could not greet: %v , err) } log.Printf( Greeting: %s , r.Message) \u8fd0\u884c # \u7b2c\u4e00\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef\uff0c\u8fd0\u884c\u670d\u52a1\u7aef $ go run greeter_server/main.go # \u7b2c\u4e8c\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef\uff0c\u8fd0\u884c\u5ba2\u6237\u7aef $ go run greeter_client/main.go # \u5f97\u5230\u5982\u4e0b\u8f93\u51fa Greeting: Hello world Greeting: Hello again world","title":"Go \u5feb\u901f\u5165\u95e8"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#go","text":"\u672c\u6307\u5357\u4ee5\u7b80\u5355\u7684\u5de5\u4f5c\u793a\u4f8b\u4e3a\u60a8\u4ecb\u7ecdGo\u4e2d\u7684gRPC\u3002","title":"Go \u5feb\u901f\u5165\u95e8"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_1","text":"","title":"\u5148\u51b3\u6761\u4ef6"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#go_1","text":"gRPC\u8981\u6c42Go\u7248\u672c\u5927\u4e8e\u7b49\u4e8e1.6\uff1a sugoi@Sugoi-PC:~$ go version go version go1.12.7 linux/amd64 \u6709\u5173\u5b89\u88c5\u8bf4\u660e\uff0c\u8bf7\u9075\u5faa\u4ee5\u4e0b\u6307\u5357\uff1a \u5165\u95e8-Go\u7f16\u7a0b\u8bed\u8a00 \u3002","title":"Go \u7248\u672c"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#grpc","text":"\u4f7f\u7528\u4e0b\u9762\u7684\u6307\u4ee4\u5b89\u88c5gRPC: go get -u google.golang.org/grpc","title":"\u5b89\u88c5gRPC"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#protocol-buffers-v3","text":"\u5b89\u88c5\u7528\u4e8e\u751f\u6210gRPC\u670d\u52a1\u4ee3\u7801\u7684protoc\u7f16\u8bd1\u5668\u3002\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u4ece \u6b64\u5904 \u4e0b\u8f7d\u9002\u7528\u4e8e\u60a8\u7684\u5e73\u53f0\u7684\u9884\u7f16\u8bd1\u4e8c\u8fdb\u5236\u6587\u4ef6\uff08 protoc- version - platform .zip \uff09\uff1a \u89e3\u538b\u7f29\u6b64\u6587\u4ef6 \u66f4\u65b0\u73af\u5883\u53d8\u91cfPATH\u4ee5\u5305\u542bprotoc\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u8def\u5f84 # protoc environment export PATH=$PATH:/opt/protoc/bin \u63a5\u4e0b\u6765\uff0c\u4e3aGo\u5b89\u88c5protoc\u63d2\u4ef6\u3002 go get -u github.com/golang/protobuf/protoc-gen-go \u7f16\u8bd1\u5668\u63d2\u4ef6 protoc-gen-go \u5c06\u5b89\u88c5\u5728 $GOBIN \u4e2d\uff0c\u9ed8\u8ba4\u4e3a $GOPATH/bin ,\u5b83\u5fc5\u987b\u5728\u4f60\u7684 $PATH \u4e2d\uff0c\u8fd9\u6837protocol\u7684\u7f16\u8bd1\u5668 protoc \u624d\u80fd\u627e\u5230\u5b83\u3002 # Golang environment export GOPATH=/home/sugoi/go export PATH=$PATH:/opt/go/bin:$GOPATH/bin","title":"\u5b89\u88c5protocol buffers v3"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_2","text":"\u4f7f\u7528 go get google.golang.org/grpc \u83b7\u53d6\u7684grpc\u4ee3\u7801\u4e5f\u5305\u542b\u5b83\u793a\u4f8b\u3002\u5b83\u4eec\u53ef\u4ee5\u5728\u793a\u4f8b dir:$GOPATH/src/google.golang.org/grpc/examples \u4e0b\u627e\u5230\u3002","title":"\u4e0b\u8f7d\u793a\u4f8b"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_3","text":"\u8fdb\u5165\u793a\u4f8b\u6240\u5728\u7684\u76ee\u5f55\u4e0b\uff1a cd $GOPATH/src/google.golang.org/grpc/examples/helloworld gRPC\u670d\u52a1\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\uff0c\u8be5\u6587\u4ef6\u7528\u4e8e\u751f\u6210\u76f8\u5e94\u7684 .pb.go \u6587\u4ef6\u3002 .pb.go \u6587\u4ef6\u662f\u901a\u8fc7\u4f7f\u7528protocol\u7f16\u8bd1\u5668\uff08 protoc \uff09\u7f16\u8bd1 .proto \u6587\u4ef6\u751f\u6210\u7684\u3002 \u6b64\u793a\u4f8b\u5df2\u751f\u6210 helloworld.pb.go \u6587\u4ef6\uff08\u901a\u8fc7\u7f16\u8bd1 helloworld.proto \u751f\u6210\uff09\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6b64\u76ee\u5f55\u4e2d\u627e\u5230\uff1a $GOPATH/src/google.golang.org/grpc/examples/helloworld/helloworld helloworld.pb.go \u6587\u4ef6\u5305\u542b\uff1a \u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u7684\u4ee3\u7801 \u7528\u4e8e\u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22 HelloRequest \u548c HelloReply \u6d88\u606f\u7c7b\u578b\u7684\u4ee3\u7801","title":"\u7f16\u8bd1\u793a\u4f8b"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_4","text":"\u4f7f\u7528 go run \u4ee3\u7801\u6765\u7f16\u8bd1\u5e76\u6267\u884c\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\uff0c\u5728\u793a\u4f8b\u76ee\u5f55\u4e0b\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a # \u5728\u7b2c\u4e00\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef $ go run greeter_server/main.go # \u5728\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef $ go run greeter_client/main.go \u5982\u679c\u4e00\u5207\u987a\u5229\u7684\u8bdd\uff0c\u5c06\u4f1a\u5728\u8fd0\u884c\u5ba2\u6237\u7aef\u7684\u547d\u4ee4\u884c\u7ec8\u7aef\u4e2d\u770b\u5230\u8f93\u51fa\u4fe1\u606f\uff1a Greeting: Hello World \u3002 \u8fd9\u6837\u5c31\u6210\u529f\u7684\u4f7f\u7528gRPC\u8fd0\u884c\u5ba2\u6237\u7aef-\u670d\u52a1\u7aef\u5e94\u7528\u7a0b\u5e8f\u3002","title":"\u5c1d\u8bd5\u4e00\u4e0b"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#grpc_1","text":"\u73b0\u5728\u8ba9\u6211\u4eec\u770b\u770b\u5982\u4f55\u4f7f\u7528\u5176\u4ed6\u65b9\u6cd5\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u4e2d\u670d\u52a1\u7aef\u7684\u4ee3\u7801\u4ee5\u4f9b\u5ba2\u6237\u7aef\u8c03\u7528\u3002\u6211\u4eec\u7684gRPC\u670d\u52a1\u662f\u4f7f\u7528protocol buffers\u5b9a\u4e49\u7684\uff1b\u53ef\u4ee5\u5728 gRPC\u7b80\u4ecb \u548c gRPC\u57fa\u7840:Go \u4e2d\u627e\u5230\u66f4\u591a\u5173\u4e8e\u5982\u4f55\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u670d\u52a1\u7684\u77e5\u8bc6\u3002\u73b0\u5728\u9700\u8981\u77e5\u9053\u7684\u662f\uff0c\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u662fstub\u90fd\u6709\u4e00\u4e2a SayHello RPC\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6 HelloRequest \u53c2\u6570\u5e76\u4ece\u670d\u52a1\u5668\u8fd4\u56de HelloReply \uff0c\u6b64\u65b9\u6cd5\u5b9a\u4e49\u5982\u4e0b\uff1a // The greeting service definition. service Greeter { // Sends a greeting rpc SayHello (HelloRequest) returns (HelloReply) {} } // The request message containing the user's name. message HelloRequest { string name = 1; } // The response message containing the greetings message HelloReply { string message = 1; } \u8ba9\u6211\u4eec\u66f4\u65b0\u4e00\u4e0b\u4ee3\u7801\uff0c\u4f7f Greeter \u670d\u52a1\u6709\u4e24\u79cd\u65b9\u6cd5\u3002\u786e\u4fdd\u5728\u793a\u4f8b\u76ee\u5f55\u4e0b\uff08 $GOPATH/src/google.golang.org/grpc/examples/helloworld \uff09\u3002 \u7f16\u8f91 helloworld/helloworld.proto \u5e76\u4f7f\u7528\u65b0\u7684 SayHelloAgain \u65b9\u6cd5\u66f4\u65b0\u5b83\uff0c\u65b0\u65b9\u6cd5\u5177\u6709\u76f8\u540c\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u7c7b\u578b\uff1a // The greeting service definition. service Greeter { // Sends a greeting rpc SayHello (HelloRequest) returns (HelloReply) {} // Sends another greeting rpc SayHelloAgain (HelloRequest) returns (HelloReply) {} } // The request message containing the user's name. message HelloRequest { string name = 1; } // The response message containing the greetings message HelloReply { string message = 1; }","title":"\u66f4\u65b0gRPC\u670d\u52a1\u7aef"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#grpc_2","text":"\u63a5\u4e0b\u6765\uff0c\u66f4\u65b0\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u7684gRPC\u4ee3\u7801\u4ee5\u4f7f\u7528\u65b0\u7684\u670d\u52a1\u5b9a\u4e49\uff0c\u8fd8\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u76ee\u5f55\uff08 $GOPATH/src/google.golang.org/grpc/examples/helloworld \uff09 protoc -I helloworld/ helloworld/helloworld.proto --go_out=plugins=grpc:helloworld \u8fd9\u4f1a\u4f7f\u6211\u4eec\u7684\u66f4\u6539\u91cd\u65b0\u751f\u6210 helloworld.pb.go \u6587\u4ef6\u3002","title":"\u751f\u6210gRPC\u4ee3\u7801"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_5","text":"\u73b0\u5728\u6709\u4e86\u65b0\u751f\u6210\u7684\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\uff0c\u8fd8\u9700\u8981\u5728\u793a\u4f8b\u5e94\u7528\u7a0b\u5e8f\u7684\u624b\u52a8\u7f16\u5199\u90e8\u5206\u4e2d\u5b9e\u73b0\u5e76\u8c03\u7528\u65b0\u65b9\u6cd5\u3002","title":"\u66f4\u65b0\u5e76\u8fd0\u884c\u5e94\u7528"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_6","text":"\u7f16\u8f91 greeter_server/main.go \u5e76\u5411\u5176\u6dfb\u52a0\u4ee5\u4e0b\u51fd\u6570\uff1a func (s *server) SayHelloAgain(ctx context.Context, in *pb.HelloRequest) (*pb.HelloReply, error) { return pb.HelloReply{Message: Hello again + in.Name}, nil }","title":"\u66f4\u65b0\u670d\u52a1\u7aef"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_7","text":"\u7f16\u8f91 greeter_client/main.go \u5e76\u5411\u5176\u6dfb\u52a0\u4ee5\u4e0b\u51fd\u6570\uff1a r, err = c.SayHelloAgain(ctx, pb.HelloRequest{Name: name}) if err != nil { log.Fatalf( could not greet: %v , err) } log.Printf( Greeting: %s , r.Message)","title":"\u66f4\u65b0\u5ba2\u6237\u7aef"},{"location":"Frameworks/gRPC/07-Golang\u5feb\u901f\u5165\u95e8/#_8","text":"# \u7b2c\u4e00\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef\uff0c\u8fd0\u884c\u670d\u52a1\u7aef $ go run greeter_server/main.go # \u7b2c\u4e8c\u4e2a\u547d\u4ee4\u884c\u7ec8\u7aef\uff0c\u8fd0\u884c\u5ba2\u6237\u7aef $ go run greeter_client/main.go # \u5f97\u5230\u5982\u4e0b\u8f93\u51fa Greeting: Hello world Greeting: Hello again world","title":"\u8fd0\u884c"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/","text":"gRPC Basic - Go \u672c\u6559\u7a0b\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u672c\u5bf9Go\u7a0b\u5e8f\u5458\u7684\u6307\u5bfc\u5173\u4e8e\u5982\u4f55\u4f7f\u7528gRPC\u3002 \u901a\u8fc7\u7ec3\u4e60\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u53ef\u4ee5\u5b66\u4e60\u5230\u5982\u4e0b\u77e5\u8bc6\uff1a \u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u670d\u52a1\u3002 \u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\u3002 \u4f7f\u7528Go gRPC API\u4e3a\u4f60\u7684\u670d\u52a1\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u3002 \u5047\u5b9a\u5df2\u9605\u8bfb \u6982\u8ff0 \u5e76\u719f\u6089 protocol buffers \u3002\u8bf7\u6ce8\u610f\uff0c\u672c\u6559\u7a0b\u4e2d\u7684\u793a\u4f8b\u4f7f\u7528 protocol buffers \u7684 proto3 \u7248\u672c\uff1a\u53ef\u4ee5\u5728 proto3\u8bed\u8a00\u6307\u5357 \u548c Go\u4ee3\u7801\u751f\u6210\u6307\u5357 \u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\u3002 \u4e3a\u4f55\u4f7f\u7528gRPC \u6211\u4eec\u7684\u793a\u4f8b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8def\u5f84\u6620\u5c04\u5e94\u7528\u7a0b\u5e8f\uff0c\u5141\u8bb8\u5ba2\u6237\u7aef\u83b7\u53d6\u6709\u5173\u5176\u8def\u5f84 Feature \u7684\u4fe1\u606f\uff0c\u5e76\u521b\u5efa\u5176 RouteSummary \u540e\u4e0e\u5176\u4ed6\u670d\u52a1\u7aef\u6216\u5ba2\u6237\u7aef\u4ea4\u6362\u8def\u5f84\u4fe1\u606f\uff0c\u5982\uff0c\u8fdb\u884c\u6d41\u91cf\u66f4\u65b0\u3002 \u4f7f\u7528gRPC\uff0c\u53ea\u9700\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e00\u6b21\u670d\u52a1\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528gRPC\u652f\u6301\u7684\u4efb\u4f55\u8bed\u8a00\u5b9e\u73b0\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u800c\u8fd9\u4e9b\u8bed\u8a00\u53c8\u53ef\u4ee5\u5728\u8c37\u6b4c\u5185\u90e8\u7684\u670d\u52a1\u5668\u6216\u4e2a\u4eba\u5e73\u677f\u7535\u8111\u7b49\u5404\u79cd\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u4e0d\u540c\u7684\u8bed\u8a00\u548c\u73af\u5883\u4e4b\u95f4\u901a\u4fe1\u7684\u590d\u6742\u6027\u90fd\u7531gRPC\u5904\u7406\u3002\u6211\u4eec\u8fd8\u83b7\u5f97\u4e86\u4f7f\u7528 protocol buffers \u7684\u6240\u6709\u4f18\u52bf\uff0c\u5305\u62ec \u9ad8\u6548\u7684\u5e8f\u5217\u5316 \uff0c \u7b80\u5355\u7684IDL \u548c \u7b80\u5355\u7684\u63a5\u53e3\u66f4\u65b0 \u3002 \u6837\u4f8b\u4ee3\u7801\u4e0e\u8bbe\u7f6e \u672c\u4f8b\u5b50\u7684\u6837\u4f8b\u4ee3\u7801\u5728GitHub\u7684 grcp-go\u4ed3\u5e93 \u4e2d\u3002\u6267\u884c\u5982\u4e0b\u6307\u4ee4\u6765\u514b\u9686\u4ed3\u5e93\u4e2d\u7684\u4ee3\u7801\uff1a go get google.golang.org/grpc \u7136\u540e\uff0c\u5207\u6362\u5230\u6837\u4f8b\u76ee\u5f55 $GOPATH/src/grpc-go/examples/route_guide \u4e2d\uff1a cd $GOPATH/src/google.golang.org/grpc/examples/route_guide \u8fd8\u5e94\u8be5\u5b89\u88c5\u76f8\u5173\u5de5\u5177\u6765\u751f\u6210\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u63a5\u53e3\u4ee3\u7801\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u51c6\u5907\u597d\uff0c\u8bf7\u6309\u7167 Go\u5feb\u901f\u5165\u95e8\u6307\u5357 \u4e2d\u7684\u8bbe\u7f6e\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002 \u5b9a\u4e49\u670d\u52a1 \u7b2c\u4e00\u6b65\uff0c\u4f7f\u7528 protocol buffers \u5b9a\u4e49\uff1a gRPC\u670d\u52a1 \u65b9\u6cd5\u8bf7\u6c42\u7c7b\u578b \u65b9\u6cd5\u54cd\u5e94\u7684\u7c7b\u578b \u5b8c\u6574\u7684 .proto \u6587\u4ef6 \u5728\u8fd9\u91cc\u3002 \u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\u9700\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u6307\u5b9a\u670d\u52a1\u7684\u540d\u5b57\uff1a service RouteGuide { ... } \u7136\u540e\u5728\u5b9a\u4e49\u7684\u670d\u52a1\u4e2d\u5b9a\u4e49 rpc \u65b9\u6cd5\uff0c\u6307\u5b9a\u65b9\u6cd5\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u7c7b\u578b\u3002gRPC\u5141\u8bb8\u5b9a\u4e49\u56db\u79cd\u7c7b\u578b\u7684\u670d\u52a1\u65b9\u6cd5\uff0c\u5728\u793a\u4f8b\u670d\u52a1 RouterGuide \u4e2d\u90fd\u7528\u5230\u4e86\uff0c\u5177\u4f53\u5982\u4e0b\u3002 \u7b80\u5355RPC \uff1a\u5ba2\u6237\u7aef\u4f7f\u7528 stub \u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\u7136\u540e\u7b49\u5f85\u54cd\u5e94\u8fd4\u56de\uff0c\u5c31\u50cf\u666e\u901a\u7684\u65b9\u6cd5\u8c03\u7528\uff1a go // \u83b7\u5f97\u7ed9\u5b9a\u4f4d\u7f6e\u7684\u7279\u5f81\u3002 rpc GetFeature(Point) returns (Feature) {} \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff1a\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u83b7\u53d6\u8fd4\u56de\u6d41\u4ee5\u8bfb\u53d6\u6d88\u606f\u5e8f\u5217\u3002\u5ba2\u6237\u7aef\u4ece\u8fd4\u56de\u7684\u6d41\u4e2d\u8bfb\u53d6\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\u3002\u6b63\u5982\u5728\u793a\u4f8b\u4e2d\u6240\u5199\u7684\u90a3\u6837\uff0c\u5c06 stream \u5173\u952e\u5b57\u653e\u5728 \u54cd\u5e94\u7c7b\u578b \u4e4b\u524d\u6765\u6307\u5b9a\u670d\u52a1\u5668\u7aef\u6d41\u65b9\u6cd5\u3002 go // \u83b7\u5f97\u7ed9\u5b9aRectangle\u4e2d\u53ef\u7528\u7684\u7279\u5f81\u3002 // \u5f97\u5230\u7684\u7ed3\u679c\u662f\u6d41\u5f0f\u4f20\u8f93\u800c\u4e0d\u662f\u4e00\u6b21\u8fd4\u56de\uff08\u4f8b\u5982\uff0c\u5728\u54cd\u5e94\u6d88\u606f\u4e2d\u6709\u91cd\u590d\u5b57\u6bb5\uff09\uff0c // \u56e0\u4e3arectangle\u53ef\u80fd\u8986\u76d6\u5f88\u5927\u9762\u79ef\u5e76\u4e14\u5305\u542b\u5927\u91cf\u7684\u7279\u5f81\u3002 rpc ListFeatures(Rectangle) returns (stream Feature) {} \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff1a\u5ba2\u6237\u7aef\u591a\u6b21\u4f7f\u7528\u63d0\u4f9b\u7684\u6d41\u5199\u5165\u4e00\u7cfb\u5217\u6d88\u606f\u5e76\u5c06\u5b83\u4eec\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u5199\u5b8c\u6d88\u606f\uff0c\u5b83\u5c31\u7b49\u5f85\u670d\u52a1\u7aef\u5168\u90e8\u8bfb\u53d6\u5e76\u8fd4\u56de\u54cd\u5e94\u7684\u54cd\u5e94\u3002\u901a\u8fc7\u5728 \u8bf7\u6c42\u7c7b\u578b \u4e4b\u524d\u653e\u7f6e stream \u5173\u952e\u5b57\u6765\u6307\u5b9a\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u3002 go // \u63a5\u53d7\u6b63\u5728\u904d\u5386\u7684\u8def\u5f84\u4e0a\u7684Points\u6d88\u606f\u7c7b\u578b\u7684\u6d41\uff0c\u5728\u904d\u5386\u5b8c\u6210\u65f6\u8fd4\u56deRouteSummary\u3002 rpc RecordRoute(stream Point) returns (RouteSummary) {} \u53cc\u5411\u6d41\u6570\u636eRPC \uff1a\u53cc\u65b9\u4f7f\u7528\u8bfb\u5199\u6d41\u53d1\u9001\u4e00\u7cfb\u5217\u6d88\u606f\uff0c\u8fd9\u4e24\u4e2a\u6d41\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u6b64\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u559c\u6b22\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\u3002\uff08\u4f8b\u5982\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5199\u5165\u54cd\u5e94\u4e4b\u524d\u7b49\u5f85\u63a5\u6536\u6240\u6709\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u6216\u8005\u5b83\u53ef\u4ee5\u4ea4\u66ff\u5730\u8bfb\u53d6\u6d88\u606f\u7136\u540e\u5199\u5165\u54cd\u5e94\u6d88\u606f\uff0c\u6216\u8005\u5176\u4ed6\u4e00\u4e9b\u8bfb\u5199\u7ec4\u5408\uff09\u3002\u6bcf\u4e2a\u6d41\u4e2d\u7684\u6d88\u606f\u987a\u5e8f\u90fd\u80fd\u5f97\u5230\u4fdd\u8bc1\u3002\u53ef\u4ee5\u901a\u8fc7\u5728\u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u524d\u653e\u7f6e stream \u5173\u952e\u5b57\u6765\u6307\u5b9a\u6b64\u7c7b\u65b9\u6cd5\u3002 go // \u63a5\u53d7\u5728\u904d\u5386\u8def\u5f84\u65f6\u53d1\u9001\u7684RouteNotes\u6d88\u606f\u7c7b\u578b\u7684\u6d41\uff0c\u540c\u65f6\u63a5\u6536\u5176\u4ed6RouteNotes\u6d88\u606f\u7c7b\u578b\u7684\u6d88\u606f\uff08\u4f8b\u5982\uff0c\u6765\u81ea\u5176\u4ed6\u7528\u6237\uff09\u3002 rpc RouteChat(stream RouteNote) returns (stream RouteNote) {} .proto \u6587\u4ef6\u8fd8\u5305\u542b\u670d\u52a1\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u7c7b\u578b\u7684 protocol buffers \u6d88\u606f\u7c7b\u578b\u5b9a\u4e49\uff0c\u4f8b\u5982\uff0c\u8fd9\u91cc\u662fPoint\u6d88\u606f\u7c7b\u578b\uff1a message Point { int32 latitude = 1; int32 longitude = 2; } \u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801 \u7b2c\u4e8c\u6b65\uff0c\u4f7f\u7528 protoc ( protocol buffers \u7684\u7f16\u8bd1\u5668)\u548c\u7279\u5b9a\u7684 gRPC-GO \u63d2\u4ef6( protoc-gen-go )\uff0c\u6839\u636e .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u670d\u52a1\u751f\u6210gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u63a5\u53e3\u3002\u8fd9\u4e0e \u5feb\u901f\u5165\u95e8 \u4e2d\u7684\u64cd\u4f5c\u4e00\u6837\u3002 \u5728 route_guide \u7684\u793a\u4f8b\u76ee\u5f55\u4e2d\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff1a protoc -I routeguide/ routeguide/route_guide.proto --go_out=plugins=grpc:routeguide # \u5728\u76ee\u5f55\u4e0b\u751f\u6210\u5982\u4e0b\u6587\u4ef6 route_guide.pb.go route_guide.pb.go\u6587\u4ef6\u5305\u542b\uff1a \u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u8bf7\u6c42\u548c\u54cd\u5e94\u6d88\u606f\u7c7b\u578b\u7684\u6240\u6709 protocol buffers \u4ee3\u7801 \u5b9e\u73b0 RouteGuide \u670d\u52a1\u4e2d\u5b9a\u4e49\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7c7b\u578b\u6216stub\uff08\u5b58\u6839\uff09\u548c\u65b9\u6cd5 \u5b9e\u73b0 RouteGuide \u670d\u52a1\u4e2d\u5b9a\u4e49\u7684\u670d\u52a1\u7aef\u63a5\u53e3\u7c7b\u578b\u548c\u65b9\u6cd5 \u521b\u5efa\u670d\u52a1\u7aef \u9996\u5148\u521b\u5efa RouteGuide \u670d\u52a1\u7aef\u3002\u5982\u679c\u53ea\u5bf9\u521b\u5efagRPC\u5ba2\u6237\u7aef\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u8df3\u8fc7\u672c\u8282\u76f4\u63a5\u9605\u8bfb \u521b\u5efa\u5ba2\u6237\u7aef \u3002 \u8981\u4f7f RouteGuide \u670d\u52a1\u80fd\u591f\u6b63\u5e38\u63d0\u4f9b\u5b83\u7684\u670d\u52a1\uff0c\u6709\u4e24\u4e2a\u90e8\u5206\u9700\u8981\u5b8c\u6210\uff1a \u5b9e\u73b0\u4ece\u670d\u52a1\u5b9a\u4e49\u4e2d\u751f\u6210\u7684\u670d\u52a1\u63a5\u53e3\uff1a\u5b83\u6267\u884c\u670d\u52a1\u7684\u5b9e\u9645\u201c\u5de5\u4f5c\u201d \u8fd0\u884cgRPC\u670d\u52a1\u4ee5\u76d1\u542c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5e76\u5c06\u5176\u5206\u6d3e\u7ed9\u6b63\u786e\u7684\u670d\u52a1\u7aef\u5b9e\u73b0 \u5728 grpc-go/examples/route_guide/server/server.go \u4e2d\u53ef\u4ee5\u770b\u5230 RouteGuide \u670d\u52a1\u7aef\u6837\u4f8b\u3002 \u5b9e\u73b0 RouteGuide \u5982\u4e0b\u6240\u793a\uff0c\u670d\u52a1\u7aef\u6709\u4e00\u4e2a\u53eb routeGuideServer \u7684\u7ed3\u6784\u4f53\u7c7b\u578b\u5b83\u5b9e\u73b0\u4e86\u81ea\u52a8\u751f\u6210\u7684 RouteGuideServer \u63a5\u53e3\u3002 type routeGuideServer struct { ... } ... func (s *routeGuideServer) GetFeature(ctx context.Context, point *pb.Point) (*pb.Feature, error) { ... } ... func (s *routeGuideServer) ListFeatures(rect *pb.Rectangle, stream pb.RouteGuide_ListFeaturesServer) error { ... } ... func (s *routeGuideServer) RecordRoute(stream pb.RouteGuide_RecordRouteServer) error { ... } ... func (s *routeGuideServer) RouteChat(stream pb.RouteGuide_RouteChatServer) error { ... } ... \u7b80\u5355RPC routeGuideServer \u5b9e\u73b0\u4e86\u6240\u6709\u7684\u670d\u52a1\u65b9\u6cd5\uff0c\u5148\u770b\u770b\u6700\u7b80\u5355\u7684\u7c7b\u578b GetFeature() \uff0c\u5b83\u53ea\u662f\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6\u4e00\u4e2a Point \u5e76\u4ece\u67d0\u4e2a Feature \u81ea\u5df1\u7684\u6570\u636e\u5e93\u4e2d\u8fd4\u56de\u76f8\u5e94\u7684\u7279\u5f81\u4fe1\u606f\u3002 func (s *routeGuideServer) GetFeature(ctx context.Context, point *pb.Point) (*pb.Feature, error) { for _, feature := range s.savedFeatures { if proto.Equal(feature.Location, point) { return feature, nil } } // No feature was found, return an unnamed feature return pb.Feature{ , point}, nil } \u8be5\u65b9\u6cd5\u4f20\u9012RPC\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\u548c\u5ba2\u6237\u7aef Point \u7c7b\u578b\u7684 protocol buffers \u8bf7\u6c42\u3002\u5b83\u8fd4\u56de\u4e00\u4e2a Feature \u7c7b\u578b\u7684 protocol buffers \u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u54cd\u5e94\u4fe1\u606f\u548c\u9519\u8bef\u3002\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9002\u5f53\u7684\u4fe1\u606f\u586b\u5145 Feature \uff0c\u7136\u540e\u5c06\u5176\u4e0e nil \u9519\u8bef\u4e00\u8d77\u8fd4\u56de\u6765\u544a\u8bc9gRPC\u5df2\u7ecf\u5b8c\u6210\u4e86RPC\u7684\u5904\u7406\uff0c\u7136\u540e Feature \u5c31\u53ef\u4ee5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \u73b0\u5728\u770b\u4e00\u4e0b\u6d41\u6570\u636eRPC\u3002 ListFeatures() \u65b9\u6cd5\u662f\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC\uff0c\u56e0\u6b64\u9700\u8981\u5c06\u591a\u4e2a Feature \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 func (s *routeGuideServer) ListFeatures(rect *pb.Rectangle, stream pb.RouteGuide_ListFeaturesServer) error { for _, feature := range s.savedFeatures { if inRange(feature.Location, rect) { if err := stream.Send(feature); err != nil { return err } } } return nil } \u5982\u4e0a\u6240\u793a\uff0c\u6b64\u65b9\u6cd5\u4e0d\u662f\u5728\u65b9\u6cd5\u53c2\u6570\u4e2d\u83b7\u53d6\u7b80\u5355\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u5bf9\u8c61\uff0c\u800c\u662f\u5f97\u5230\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\uff08\u5728 Feature \u4e2d\u5ba2\u6237\u7aef\u60f3\u8981\u67e5\u627e\u7684 Rectangle \uff09\u548c\u4e00\u4e2a\u7279\u5b9a\u7684 RouteGuide_ListFeaturesServer \u5bf9\u8c61\u6765\u7f16\u5199\u6211\u4eec\u7684\u54cd\u5e94\u3002 \u5728\u8be5\u65b9\u6cd5\u4e2d\uff0c\u586b\u5145\u5c3d\u53ef\u80fd\u591a\u7684\u9700\u8981\u88ab\u8fd4\u56de\u7684 Feature \u5bf9\u8c61\uff0c\u5e76\u4f7f\u7528\u5176 Send() \u65b9\u6cd5\u5c06 Feature \u90fd\u5199\u5165 RouteGuide_ListFeaturesServer \u3002\u6700\u540e\uff0c\u5c31\u50cf\u5728\u7b80\u5355RPC\u65b9\u6cd5\u4e2d\u90a3\u6837\uff0c\u8fd4\u56de\u4e00\u4e2a nil \u9519\u8bef\u544a\u8bc9gRPC\u5df2\u7ecf\u5b8c\u6210\u4e86\u5199\u54cd\u5e94\u4fe1\u606f\u7684\u64cd\u4f5c\u3002\u5982\u679c\u5728\u6b64\u8c03\u7528\u4e2d\u53d1\u751f\u4efb\u4f55\u9519\u8bef\uff0c\u90a3\u4e48\u5c06\u8fd4\u56de\u975e\u96f6\u9519\u8bef; gRPC\u5c42\u4f1a\u5c06\u5176\u8f6c\u6362\u4e3a\u9002\u5f53\u7684RPC\u72b6\u6001\uff0c\u4ee5\u4fbf\u5728\u7ebf\u8def\u4e0a\u53d1\u9001\u3002 \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC \u73b0\u5728\u6765\u770b\u4e00\u4e9b\u66f4\u590d\u6742\u7684\u4e1c\u897f\uff1a\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 RecordRoute() \uff0c\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6 Points \u7c7b\u578b\u7684\u6d41\u5e76\u8fd4\u56de\u5355\u4e2a\u5305\u542b\u6709\u5173\u4f20\u8f93\u94fe\u8def\u4fe1\u606f\u7684 RouteSummary \u3002\u5982\u4e0b\u6240\u793a\uff0c\u8be5\u65b9\u6cd5\u6839\u672c\u6ca1\u6709\u8bf7\u6c42\u53c2\u6570\u3002\u76f8\u53cd\uff0c\u5b83\u83b7\u53d6 RouteGuide_RecordRouteServer \u6d41\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u4f7f\u7528\u8be5\u6d41\u6765\u8bfb\u53d6\u548c\u5199\u5165\u6d88\u606f\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684 Recv() \u65b9\u6cd5\u63a5\u6536\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u5e76\u4f7f\u7528\u5b83\u7684 SendAndClose() \u65b9\u6cd5\u8fd4\u56de\u5176\u5355\u4e2a\u54cd\u5e94\u3002 func (s *routeGuideServer) RecordRoute(stream pb.RouteGuide_RecordRouteServer) error { var pointCount, featureCount, distance int32 var lastPoint *pb.Point startTime := time.Now() for { point, err := stream.Recv() if err == io.EOF { endTime := time.Now() return stream.SendAndClose( pb.RouteSummary{ PointCount: pointCount, FeatureCount: featureCount, Distance: distance, ElapsedTime: int32(endTime.Sub(startTime).Seconds()), }) } if err != nil { return err } pointCount++ for _, feature := range s.savedFeatures { if proto.Equal(feature.Location, point) { featureCount++ } } if lastPoint != nil { distance += calcDistance(lastPoint, point) } lastPoint = point } } \u5728\u65b9\u6cd5\u4f53\u4e2d\uff0c\u4f7f\u7528 RouteGuide_RecordRouteServer \u7684 Recv() \u65b9\u6cd5\u91cd\u590d\u8bfb\u53d6\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\uff08\u5728\u672c\u4f8b\u4e2d\u4e3a\u4e00\u4e2a Point \uff09\u7684\u8bf7\u6c42\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff0c\u670d\u52a1\u7aef\u9700\u8981\u68c0\u67e5\u6bcf\u6b21\u8c03\u7528 Recv() \u65b9\u6cd5\u540e\u4ece\u4e2d\u8fd4\u56de\u7684\u9519\u8bef err \u3002 \u5982\u679c\u9519\u8bef\u662f nil \uff0c\u90a3\u4e48\u8bf4\u660e\u6d41\u4ecd\u7136\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\u5e76\u4e14\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u8bfb\u53d6\u64cd\u4f5c \u5982\u679c\u9519\u8bef\u662f io.EOF \uff0c\u90a3\u4e48\u8bf4\u660e\u6d88\u606f\u6d41\u5df2\u7ecf\u7ed3\u675f\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u8fd4\u56de\u5b83\u7684 RouteSummary \u5982\u679c\u9519\u8bef\u662f\u4efb\u4f55\u5176\u4ed6\u503c\uff0c\u90a3\u4e48\u5c06\u201c\u6309\u539f\u6837\u201d\u8fd4\u56de\u9519\u8bef\uff0c\u4ee5\u4fbfgRPC\u5c42\u5c06\u5176\u8f6c\u6362\u4e3aRPC\u72b6\u6001 \u53cc\u5411\u6d41\u6570\u636eRPC \u6700\u540e\uff0c\u770b\u4e00\u4e0b\u53cc\u5411\u6d41\u6570\u636ePRC RouteChat() \u65b9\u6cd5\u3002 func (s *routeGuideServer) RouteChat(stream pb.RouteGuide_RouteChatServer) error { for { in, err := stream.Recv() if err == io.EOF { return nil } if err != nil { return err } key := serialize(in.Location) ... // \u6b64\u5904\u4ee3\u7801 \u5bfb\u627e\u8981\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684note for _, note := range s.routeNotes[key] { if err := stream.Send(note); err != nil { return err } } } } \u5f97\u5230\u4e00\u4e2a RouteGuide_RouteChatServer \u6d41\uff0c\u5c31\u50cf\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u793a\u4f8b\u90a3\u6837\uff0c\u53ef\u7528\u4e8e\u8bfb\u53d6\u548c\u5199\u5165\u6d88\u606f\u3002\u4f46\u662f\uff0c\u5728\u8fd9\u91cc\u901a\u8fc7\u65b9\u6cd5\u7684\u6d41\u6765\u8fd4\u56de\u503c\uff0c\u54ea\u6015\u6b64\u65f6\u5ba2\u6237\u7aef\u4ecd\u5728\u5411\u5176\u6d88\u606f\u6d41\u5199\u5165\u6d88\u606f\u3002 \u8fd9\u91cc\u7684\u8bfb\u5199\u8bed\u6cd5\u4e0e\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u4e2d\u7684\u8bed\u6cd5\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u6b64\u5904\u670d\u52a1\u7aef\u4f7f\u7528\u6d41\u7684 Send() \u65b9\u6cd5\u800c\u4e0d\u662f SendAndClose() \u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u6b63\u5728\u5199\u5165\u591a\u4e2a\u54cd\u5e94\u3002\u5c3d\u7ba1\u6bcf\u4e00\u65b9\u90fd\u4f1a\u6309\u7167\u5199\u5165\u7684\u987a\u5e8f\u83b7\u53d6\u5bf9\u65b9\u7684\u6d88\u606f\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u56e0\u4e3a\uff0c\u8fd9\u4e9b\u6d41\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u3002 \u542f\u52a8\u670d\u52a1\u7aef \u5b9e\u73b0\u4e86\u6240\u6709\u65b9\u6cd5\u540e\uff0c\u8fd8\u9700\u8981\u542f\u52a8\u4e00\u4e2agRPC\u670d\u52a1\u7aef\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u53ef\u4ee5\u5b9e\u9645\u4f7f\u7528\u6211\u4eec\u7684\u670d\u52a1\u3002\u4ee5\u4e0b\u4ee3\u7801\u6bb5\u663e\u793a\u4e86\u5982\u4f55\u4e3a RouteGuide \u670d\u52a1\u6267\u884c\u6b64\u64cd\u4f5c\uff1a flag.Parse() lis, err := net.Listen( tcp , fmt.Sprintf( :%d , *port)) if err != nil { log.Fatalf( failed to listen: %v , err) } grpcServer := grpc.NewServer() pb.RegisterRouteGuideServer(grpcServer, routeGuideServer{}) ... // \u6b64\u5904\u4ee3\u7801 \u786e\u5b9a\u662f\u5426\u542f\u52a8TLS grpcServer.Serve(lis) \u8981\u6784\u5efa\u548c\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u6211\u4eec\u9700\u8981\uff1a \u4f7f\u7528 lis, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", *port)). \u6307\u5b9a\u9700\u8981\u76d1\u542c\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u7aef\u53e3 \u4f7f\u7528 grpc.NewServer() \u521b\u5efa\u4e00\u4e2agRPC\u670d\u52a1\u7aef\u5b9e\u4f8b \u4f7f\u7528gRPC\u670d\u52a1\u7aef\u6ce8\u518c\u6211\u4eec\u5b9e\u73b0\u7684\u670d\u52a1 \u4f7f\u7528\u7aef\u53e3\u8be6\u7ec6\u4fe1\u606f\u8c03\u7528\u670d\u52a1\u7aef\u7684 Serve() \u65b9\u6cd5\u8fdb\u884c\u963b\u585e\u7b49\u5f85\uff0c\u76f4\u5230\u8fdb\u7a0b\u88ab\u7ec8\u6b62\u6216\u8c03\u7528 Stop() \u3002 \u521b\u5efa\u5ba2\u6237\u7aef \u5728\u672c\u8282\u4e2d\uff0c\u5c06\u4ecb\u7ecd\u5982\u4f55\u4e3a RouteGuide \u670d\u52a1\u521b\u5efaGo\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u5728 grpc-go/examples/route_guide/client/client.go \u4e2d\u67e5\u770b\u5b8c\u6574\u7684\u793a\u4f8b\u5ba2\u6237\u7aef\u4ee3\u7801\u3002 \u521b\u5efa\u4e00\u4e2astub\uff08\u5b58\u6839\uff09 \u8981\u8c03\u7528\u670d\u52a1\u7aef\u7684\u65b9\u6cd5\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u4e00\u4e2agRPC\u901a\u9053\u6765\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u3002\u901a\u8fc7\u5c06\u670d\u52a1\u5668\u5730\u5740\u548c\u7aef\u53e3\u53f7\u4f20\u9012\u7ed9 grpc.Dial() \u6765\u521b\u5efa\u5b83\uff0c\u5982\u4e0b\u6240\u793a\uff1a conn, err := grpc.Dial(*serverAddr) if err != nil { ... } defer conn.Close() \u5982\u679c\u8bf7\u6c42\u7684\u670d\u52a1\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\uff0c\u53ef\u4ee5\u4f7f\u7528 DialOptions \u5728 grpc.Dial() \u65b9\u6cd5\u4e2d\u8bbe\u7f6e\u8eab\u4efd\u9a8c\u8bc1\u51ed\u636e\uff08\u4f8b\u5982\uff0cTLS\uff0cGCE\u51ed\u636e\uff0cJWT\u51ed\u8bc1\uff0c\u4f46\u662f\uff0c\u5728\u8fd9\u91cc\u7684 RouteGuide \u670d\u52a1\u4e2d\u4e0d\u9700\u8981\u6267\u884c\u6b64\u64cd\u4f5c\u3002 \u4e00\u65e6gRPC\u901a\u9053\u5efa\u7acb\u8d77\u6765\uff0c\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u5ba2\u6237\u7aefstub(\u5b58\u6839)\u6765\u6267\u884cRPC\u8c03\u7528\u3002\u6211\u4eec\u4f7f\u7528\u4ece .proto \u6587\u4ef6\u4e2d\u751f\u6210\u7684\u5728 pb \u5305\u4e2d\u63d0\u4f9b\u7684 NewRouteGuideClient() \u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u5ba2\u6237\u7aefstub\u3002 client := pb.NewRouteGuideClient(conn) \u8c03\u7528\u670d\u52a1\u7aef\u65b9\u6cd5 \u73b0\u5728\u6765\u770b\u770b\u5982\u4f55\u8c03\u7528\u670d\u52a1\u65b9\u6cd5\u3002\u8bf7\u6ce8\u610f\uff0c\u5728 gRPC-Go \u4e2d\uff0cRPC\u4ee5 \u963b\u585e/\u540c\u6b65 \u6a21\u5f0f\u8fd0\u884c\uff0c\u8fd9\u610f\u5473\u7740RPC\u8c03\u7528\u7b49\u5f85\u670d\u52a1\u7aef\u54cd\u5e94\uff0c\u5e76\u5c06\u8fd4\u56de\u54cd\u5e94\u6216\u9519\u8bef\u3002 \u7b80\u5355RPC \u8c03\u7528\u7b80\u5355RPC\u7684 GetFeature() \u65b9\u6cd5\u51e0\u4e4e\u4e0e\u8c03\u7528\u672c\u5730\u65b9\u6cd5\u4e00\u6837\u7b80\u5355\u3002 feature, err := client.GetFeature(context.Background(), pb.Point{409146138, -746188906}) if err != nil { ... } \u5982\u4e0a\u6240\u793a\uff1a\u5728\u4e4b\u524d\u83b7\u5f97\u7684 stub \u4e0a\u8c03\u7528\u8be5\u65b9\u6cd5\uff0c\u5728\u65b9\u6cd5\u53c2\u6570\u4e2d\uff0c\u521b\u5efa\u5e76\u586b\u5145\u8bf7\u6c42 protocol buffers \u5bf9\u8c61\uff08\u5728\u4f8b\u5b50\u4e2d\u4e3a Point \uff09\u3002 \u8fd8\u4f20\u9012\u4e00\u4e2a context.Context \u5bf9\u8c61\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5728\u5fc5\u8981\u65f6\u66f4\u6539RPC\u7684\u884c\u4e3a\uff0c\u4f8b\u5982\u8d85\u65f6/\u53d6\u6d88\u6267\u884c\u4e2d\u7684RPC\u8bf7\u6c42\u3002\u5982\u679c\u8c03\u7528\u6ca1\u6709\u8fd4\u56de\u9519\u8bef\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece\u7b2c\u4e00\u4e2a\u8fd4\u56de\u503c\u4e2d\u8bfb\u53d6\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u4fe1\u606f\u3002 log.Println(feature) \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \u8fd9\u662f\u8c03\u7528\u670d\u52a1\u7aef\u6d41\u65b9\u6cd5 ListFeatures() \u7684\u5730\u65b9\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de\u5730\u7406 Feature \u6d41\u3002\u5982\u679c\u5df2\u7ecf\u9605\u8bfb\u8fc7 \u521b\u5efa\u670d\u52a1\u7aef \uff0c\u5176\u4e2d\u4e00\u4e9b\u90e8\u5206\u53ef\u80fd\u770b\u8d77\u6765\u975e\u5e38\u719f\u6089\uff1a\u6d41\u6570\u636eRPC\u5728\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4e4b\u95f4\u90fd\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002 rect := pb.Rectangle{ ... } // initialize a pb.Rectangle stream, err := client.ListFeatures(context.Background(), rect) if err != nil { ... } for { feature, err := stream.Recv() if err == io.EOF { break } if err != nil { log.Fatalf( %v.ListFeatures(_) = _, %v , client, err) } log.Println(feature) } \u4e0e\u7b80\u5355\u7684RPC\u4e00\u6837\uff0c\u4f20\u9012\u4e0a\u4e0b\u6587\u548c\u8bf7\u6c42\u7ed9\u65b9\u6cd5\uff0c\u4f46\u662f\u5728\u8fd9\u91cc\u4e0d\u4f1a\u8fd4\u56de\u54cd\u5e94\u5bf9\u8c61\uff0c\u800c\u662f\u8fd4\u56de RouteGuide_ListFeaturesClient \u7684\u5b9e\u4f8b\u3002\u8fd9\u4e2a\u5ba2\u6237\u7aef\u5b9e\u4f8b\u53ef\u4ee5\u4f7f\u7528 RouteGuide_ListFeaturesClient \u6d41\u6765\u8bfb\u53d6\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u3002 \u4f7f\u7528 RouteGuide_ListFeaturesClient \u7684 Recv() \u65b9\u6cd5\u91cd\u590d\u7684\u5728\u670d\u52a1\u5668\u7684\u54cd\u5e94\u4e2d\u8bfb\u53d6protocol buffers\u5bf9\u8c61\uff08\u5728\u672c\u4f8b\u4e2d\u4e3aFeature\uff09\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff1a\u8fd9\u4e2a\u5ba2\u6237\u7aef\u5b9e\u4f8b\u9700\u8981\u68c0\u67e5\u6bcf\u6b21\u8c03\u7528 Recv() \u8fd4\u56de\u7684\u9519\u8bef err \u3002 \u5982\u679c\u662f nil \uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u4e2a\u6d41\u4ecd\u7136\u662f\u6b63\u5e38\u7684\u5e76\u4e14\u53ef\u4ee5\u7ee7\u7eed\u8bfb\u53d6 \u5982\u679c\u662f io.EOF \uff0c\u90a3\u4e48\u8bf4\u660e\u6d88\u606f\u6d41\u5df2\u7ecf\u7ed3\u675f \u5426\u5219\u5fc5\u987b\u6709\u4e00\u4e2aRPC\u9519\u8bef\uff0c\u5b83\u901a\u8fc7 err \u53c2\u6570\u4f20\u9012\u3002 \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC \u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5 RecordRoute \u7c7b\u4f3c\u4e8e\u670d\u52a1\u5668\u7aef\u65b9\u6cd5\uff0c\u4e0d\u8fc7\u53ea\u4f20\u9012\u7ed9\u65b9\u6cd5\u4e00\u4e2a\u4e0a\u4e0b\u6587\uff0c\u7136\u540e\u4f1a\u83b7\u53d6\u4e00\u4e2a RouteGuide_RecordRouteClient \u6d41\u7684\u8fd4\u56de\uff0c\u8fd9\u4e2a\u6d41\u53ef\u4ee5\u7528\u6765\u5199\u548c\u8bfb\u6d88\u606f\u3002 // Create a random number of random points r := rand.New(rand.NewSource(time.Now().UnixNano())) pointCount := int(r.Int31n(100)) + 2 // Traverse at least two points var points []*pb.Point for i := 0; i pointCount; i++ { points = append(points, randomPoint(r)) } log.Printf( Traversing %d points. , len(points)) stream, err := client.RecordRoute(context.Background()) if err != nil { log.Fatalf( %v.RecordRoute(_) = _, %v , client, err) } for _, point := range points { if err := stream.Send(point); err != nil { if err == io.EOF { break } log.Fatalf( %v.Send(%v) = %v , stream, point, err) } } reply, err := stream.CloseAndRecv() if err != nil { log.Fatalf( %v.CloseAndRecv() got error %v, want %v , stream, err, nil) } log.Printf( Route summary: %v , reply) RouteGuide_RecordRouteClient \u6709\u4e00\u4e2a Send() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u7528\u5b83\u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\u3002\u4e00\u65e6\u4f7f\u7528 Send() \u5c06\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5411\u6d41\u4e2d\u5199\u5165\u5b8c\u6210\uff0c\u5c31\u9700\u8981\u5728\u6d41\u4e0a\u8c03\u7528 CloseAndRecv() \u65b9\u6cd5\u8ba9gRPC\u77e5\u9053\u6211\u4eec\u5df2\u5b8c\u6210\u5199\u5165\u5e76\u671f\u671b\u6536\u5230\u54cd\u5e94\u3002\u53ef\u4ee5\u4ece CloseAndRecv() \u8fd4\u56de\u7684\u9519\u8bef err \u4e2d\u83b7\u53d6RPC\u72b6\u6001\uff0c\u5982\u679c\u72b6\u6001\u4e3a nil \uff0c\u90a3\u4e48 CloseAndRecv() \u7684\u7b2c\u4e00\u4e2a\u8fd4\u56de\u503c\u5c06\u662f\u6709\u6548\u7684\u670d\u52a1\u7aef\u54cd\u5e94\u3002 \u53cc\u5411\u6d41\u6570\u636eRPC \u6700\u540e\u662f\u53cc\u5411\u6d41\u6570\u636eRPC RouteChat() \u3002\u4e0e RecordRoute \u7684\u60c5\u51b5\u4e00\u6837\uff0c\u53ea\u7ed9\u65b9\u6cd5\u4f20\u9012\u4e00\u4e2a\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff0c\u7136\u540e\u83b7\u5f97\u8fd4\u56de\u4e00\u4e2a\u53ef\u7528\u4e8e\u5199\u5165\u548c\u8bfb\u53d6\u6d88\u606f\u7684\u6d41\u3002\u4f46\u662f\uff0c\u8fd9\u6b21\u901a\u8fc7\u65b9\u6cd5\u7684\u6d41\u8fd4\u56de\u503c\uff0c\u800c\u670d\u52a1\u7aef\u4ecd\u5728\u5411\u5176\u6d88\u606f\u6d41\u5199\u5165\u6d88\u606f\u3002 stream, err := client.RouteChat(context.Background()) waitc := make(chan struct{}) go func() { for { in, err := stream.Recv() if err == io.EOF { // read done. close(waitc) return } if err != nil { log.Fatalf( Failed to receive a note : %v , err) } log.Printf( Got message %s at point(%d, %d) , in.Message, in.Location.Latitude, in.Location.Longitude) } }() for _, note := range notes { if err := stream.Send(note); err != nil { log.Fatalf( Failed to send a note: %v , err) } } stream.CloseSend() -waitc \u8fd9\u91cc\u7684\u8bfb\u5199\u8bed\u6cd5\u4e0e\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u7684\u8bed\u6cd5\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u5728\u5b8c\u6210\u8c03\u7528\u540e\u4f7f\u7528\u6d41\u7684 CloseSend() \u65b9\u6cd5\u3002\u5c3d\u7ba1\u6bcf\u4e00\u65b9\u90fd\u4f1a\u6309\u7167\u5199\u5165\u987a\u5e8f\u83b7\u53d6\u5bf9\u65b9\u7684\u6d88\u606f\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u8fd9\u4e9b\u6d41\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u3002 \u641e\u8d77\u6765 \u8981\u7f16\u8bd1\u548c\u8fd0\u884c\u670d\u52a1\u7aef\uff0c\u5047\u8bbe\u4f4d\u4e8e $GOPATH/src/google.golang.org/grpc/examples/route_guide \u6587\u4ef6\u5939\u4e2d\uff0c\u53ea\u9700\uff1a go run server/server.go \u540c\u6837\uff0c\u8981\u8fd0\u884c\u5ba2\u6237\u7aef\uff1a go run client/client.go","title":"gRPC Basic - Go"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#grpc-basic-go","text":"\u672c\u6559\u7a0b\u63d0\u4f9b\u4e86\u4e00\u4e2a\u57fa\u672c\u5bf9Go\u7a0b\u5e8f\u5458\u7684\u6307\u5bfc\u5173\u4e8e\u5982\u4f55\u4f7f\u7528gRPC\u3002 \u901a\u8fc7\u7ec3\u4e60\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u53ef\u4ee5\u5b66\u4e60\u5230\u5982\u4e0b\u77e5\u8bc6\uff1a \u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u670d\u52a1\u3002 \u4f7f\u7528 protocol buffers \u7f16\u8bd1\u5668\u751f\u6210\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4ee3\u7801\u3002 \u4f7f\u7528Go gRPC API\u4e3a\u4f60\u7684\u670d\u52a1\u7f16\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u3002 \u5047\u5b9a\u5df2\u9605\u8bfb \u6982\u8ff0 \u5e76\u719f\u6089 protocol buffers \u3002\u8bf7\u6ce8\u610f\uff0c\u672c\u6559\u7a0b\u4e2d\u7684\u793a\u4f8b\u4f7f\u7528 protocol buffers \u7684 proto3 \u7248\u672c\uff1a\u53ef\u4ee5\u5728 proto3\u8bed\u8a00\u6307\u5357 \u548c Go\u4ee3\u7801\u751f\u6210\u6307\u5357 \u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\u3002","title":"gRPC Basic - Go"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#grpc","text":"\u6211\u4eec\u7684\u793a\u4f8b\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u8def\u5f84\u6620\u5c04\u5e94\u7528\u7a0b\u5e8f\uff0c\u5141\u8bb8\u5ba2\u6237\u7aef\u83b7\u53d6\u6709\u5173\u5176\u8def\u5f84 Feature \u7684\u4fe1\u606f\uff0c\u5e76\u521b\u5efa\u5176 RouteSummary \u540e\u4e0e\u5176\u4ed6\u670d\u52a1\u7aef\u6216\u5ba2\u6237\u7aef\u4ea4\u6362\u8def\u5f84\u4fe1\u606f\uff0c\u5982\uff0c\u8fdb\u884c\u6d41\u91cf\u66f4\u65b0\u3002 \u4f7f\u7528gRPC\uff0c\u53ea\u9700\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e00\u6b21\u670d\u52a1\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528gRPC\u652f\u6301\u7684\u4efb\u4f55\u8bed\u8a00\u5b9e\u73b0\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\uff0c\u800c\u8fd9\u4e9b\u8bed\u8a00\u53c8\u53ef\u4ee5\u5728\u8c37\u6b4c\u5185\u90e8\u7684\u670d\u52a1\u5668\u6216\u4e2a\u4eba\u5e73\u677f\u7535\u8111\u7b49\u5404\u79cd\u73af\u5883\u4e2d\u8fd0\u884c\uff0c\u4e0d\u540c\u7684\u8bed\u8a00\u548c\u73af\u5883\u4e4b\u95f4\u901a\u4fe1\u7684\u590d\u6742\u6027\u90fd\u7531gRPC\u5904\u7406\u3002\u6211\u4eec\u8fd8\u83b7\u5f97\u4e86\u4f7f\u7528 protocol buffers \u7684\u6240\u6709\u4f18\u52bf\uff0c\u5305\u62ec \u9ad8\u6548\u7684\u5e8f\u5217\u5316 \uff0c \u7b80\u5355\u7684IDL \u548c \u7b80\u5355\u7684\u63a5\u53e3\u66f4\u65b0 \u3002","title":"\u4e3a\u4f55\u4f7f\u7528gRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_1","text":"\u672c\u4f8b\u5b50\u7684\u6837\u4f8b\u4ee3\u7801\u5728GitHub\u7684 grcp-go\u4ed3\u5e93 \u4e2d\u3002\u6267\u884c\u5982\u4e0b\u6307\u4ee4\u6765\u514b\u9686\u4ed3\u5e93\u4e2d\u7684\u4ee3\u7801\uff1a go get google.golang.org/grpc \u7136\u540e\uff0c\u5207\u6362\u5230\u6837\u4f8b\u76ee\u5f55 $GOPATH/src/grpc-go/examples/route_guide \u4e2d\uff1a cd $GOPATH/src/google.golang.org/grpc/examples/route_guide \u8fd8\u5e94\u8be5\u5b89\u88c5\u76f8\u5173\u5de5\u5177\u6765\u751f\u6210\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u63a5\u53e3\u4ee3\u7801\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u51c6\u5907\u597d\uff0c\u8bf7\u6309\u7167 Go\u5feb\u901f\u5165\u95e8\u6307\u5357 \u4e2d\u7684\u8bbe\u7f6e\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\u3002","title":"\u6837\u4f8b\u4ee3\u7801\u4e0e\u8bbe\u7f6e"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_2","text":"\u7b2c\u4e00\u6b65\uff0c\u4f7f\u7528 protocol buffers \u5b9a\u4e49\uff1a gRPC\u670d\u52a1 \u65b9\u6cd5\u8bf7\u6c42\u7c7b\u578b \u65b9\u6cd5\u54cd\u5e94\u7684\u7c7b\u578b \u5b8c\u6574\u7684 .proto \u6587\u4ef6 \u5728\u8fd9\u91cc\u3002 \u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\u9700\u8981\u5728 .proto \u6587\u4ef6\u4e2d\u6307\u5b9a\u670d\u52a1\u7684\u540d\u5b57\uff1a service RouteGuide { ... } \u7136\u540e\u5728\u5b9a\u4e49\u7684\u670d\u52a1\u4e2d\u5b9a\u4e49 rpc \u65b9\u6cd5\uff0c\u6307\u5b9a\u65b9\u6cd5\u8bf7\u6c42\u548c\u54cd\u5e94\u7684\u7c7b\u578b\u3002gRPC\u5141\u8bb8\u5b9a\u4e49\u56db\u79cd\u7c7b\u578b\u7684\u670d\u52a1\u65b9\u6cd5\uff0c\u5728\u793a\u4f8b\u670d\u52a1 RouterGuide \u4e2d\u90fd\u7528\u5230\u4e86\uff0c\u5177\u4f53\u5982\u4e0b\u3002 \u7b80\u5355RPC \uff1a\u5ba2\u6237\u7aef\u4f7f\u7528 stub \u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\u7136\u540e\u7b49\u5f85\u54cd\u5e94\u8fd4\u56de\uff0c\u5c31\u50cf\u666e\u901a\u7684\u65b9\u6cd5\u8c03\u7528\uff1a go // \u83b7\u5f97\u7ed9\u5b9a\u4f4d\u7f6e\u7684\u7279\u5f81\u3002 rpc GetFeature(Point) returns (Feature) {} \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff1a\u5ba2\u6237\u7aef\u5411\u670d\u52a1\u7aef\u53d1\u9001\u5355\u4e2a\u8bf7\u6c42\u5e76\u83b7\u53d6\u8fd4\u56de\u6d41\u4ee5\u8bfb\u53d6\u6d88\u606f\u5e8f\u5217\u3002\u5ba2\u6237\u7aef\u4ece\u8fd4\u56de\u7684\u6d41\u4e2d\u8bfb\u53d6\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\u3002\u6b63\u5982\u5728\u793a\u4f8b\u4e2d\u6240\u5199\u7684\u90a3\u6837\uff0c\u5c06 stream \u5173\u952e\u5b57\u653e\u5728 \u54cd\u5e94\u7c7b\u578b \u4e4b\u524d\u6765\u6307\u5b9a\u670d\u52a1\u5668\u7aef\u6d41\u65b9\u6cd5\u3002 go // \u83b7\u5f97\u7ed9\u5b9aRectangle\u4e2d\u53ef\u7528\u7684\u7279\u5f81\u3002 // \u5f97\u5230\u7684\u7ed3\u679c\u662f\u6d41\u5f0f\u4f20\u8f93\u800c\u4e0d\u662f\u4e00\u6b21\u8fd4\u56de\uff08\u4f8b\u5982\uff0c\u5728\u54cd\u5e94\u6d88\u606f\u4e2d\u6709\u91cd\u590d\u5b57\u6bb5\uff09\uff0c // \u56e0\u4e3arectangle\u53ef\u80fd\u8986\u76d6\u5f88\u5927\u9762\u79ef\u5e76\u4e14\u5305\u542b\u5927\u91cf\u7684\u7279\u5f81\u3002 rpc ListFeatures(Rectangle) returns (stream Feature) {} \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC \uff1a\u5ba2\u6237\u7aef\u591a\u6b21\u4f7f\u7528\u63d0\u4f9b\u7684\u6d41\u5199\u5165\u4e00\u7cfb\u5217\u6d88\u606f\u5e76\u5c06\u5b83\u4eec\u53d1\u9001\u5230\u670d\u52a1\u7aef\u3002\u4e00\u65e6\u5ba2\u6237\u7aef\u5199\u5b8c\u6d88\u606f\uff0c\u5b83\u5c31\u7b49\u5f85\u670d\u52a1\u7aef\u5168\u90e8\u8bfb\u53d6\u5e76\u8fd4\u56de\u54cd\u5e94\u7684\u54cd\u5e94\u3002\u901a\u8fc7\u5728 \u8bf7\u6c42\u7c7b\u578b \u4e4b\u524d\u653e\u7f6e stream \u5173\u952e\u5b57\u6765\u6307\u5b9a\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u3002 go // \u63a5\u53d7\u6b63\u5728\u904d\u5386\u7684\u8def\u5f84\u4e0a\u7684Points\u6d88\u606f\u7c7b\u578b\u7684\u6d41\uff0c\u5728\u904d\u5386\u5b8c\u6210\u65f6\u8fd4\u56deRouteSummary\u3002 rpc RecordRoute(stream Point) returns (RouteSummary) {} \u53cc\u5411\u6d41\u6570\u636eRPC \uff1a\u53cc\u65b9\u4f7f\u7528\u8bfb\u5199\u6d41\u53d1\u9001\u4e00\u7cfb\u5217\u6d88\u606f\uff0c\u8fd9\u4e24\u4e2a\u6d41\u72ec\u7acb\u8fd0\u884c\uff0c\u56e0\u6b64\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u53ef\u4ee5\u6309\u7167\u81ea\u5df1\u559c\u6b22\u7684\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\u3002\uff08\u4f8b\u5982\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u5728\u5199\u5165\u54cd\u5e94\u4e4b\u524d\u7b49\u5f85\u63a5\u6536\u6240\u6709\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u6216\u8005\u5b83\u53ef\u4ee5\u4ea4\u66ff\u5730\u8bfb\u53d6\u6d88\u606f\u7136\u540e\u5199\u5165\u54cd\u5e94\u6d88\u606f\uff0c\u6216\u8005\u5176\u4ed6\u4e00\u4e9b\u8bfb\u5199\u7ec4\u5408\uff09\u3002\u6bcf\u4e2a\u6d41\u4e2d\u7684\u6d88\u606f\u987a\u5e8f\u90fd\u80fd\u5f97\u5230\u4fdd\u8bc1\u3002\u53ef\u4ee5\u901a\u8fc7\u5728\u8bf7\u6c42\u548c\u54cd\u5e94\u4e4b\u524d\u653e\u7f6e stream \u5173\u952e\u5b57\u6765\u6307\u5b9a\u6b64\u7c7b\u65b9\u6cd5\u3002 go // \u63a5\u53d7\u5728\u904d\u5386\u8def\u5f84\u65f6\u53d1\u9001\u7684RouteNotes\u6d88\u606f\u7c7b\u578b\u7684\u6d41\uff0c\u540c\u65f6\u63a5\u6536\u5176\u4ed6RouteNotes\u6d88\u606f\u7c7b\u578b\u7684\u6d88\u606f\uff08\u4f8b\u5982\uff0c\u6765\u81ea\u5176\u4ed6\u7528\u6237\uff09\u3002 rpc RouteChat(stream RouteNote) returns (stream RouteNote) {} .proto \u6587\u4ef6\u8fd8\u5305\u542b\u670d\u52a1\u65b9\u6cd5\u4e2d\u4f7f\u7528\u7684\u6240\u6709\u8bf7\u6c42\u548c\u54cd\u5e94\u7c7b\u578b\u7684 protocol buffers \u6d88\u606f\u7c7b\u578b\u5b9a\u4e49\uff0c\u4f8b\u5982\uff0c\u8fd9\u91cc\u662fPoint\u6d88\u606f\u7c7b\u578b\uff1a message Point { int32 latitude = 1; int32 longitude = 2; }","title":"\u5b9a\u4e49\u670d\u52a1"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_3","text":"\u7b2c\u4e8c\u6b65\uff0c\u4f7f\u7528 protoc ( protocol buffers \u7684\u7f16\u8bd1\u5668)\u548c\u7279\u5b9a\u7684 gRPC-GO \u63d2\u4ef6( protoc-gen-go )\uff0c\u6839\u636e .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u7684\u670d\u52a1\u751f\u6210gRPC\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u63a5\u53e3\u3002\u8fd9\u4e0e \u5feb\u901f\u5165\u95e8 \u4e2d\u7684\u64cd\u4f5c\u4e00\u6837\u3002 \u5728 route_guide \u7684\u793a\u4f8b\u76ee\u5f55\u4e2d\u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff1a protoc -I routeguide/ routeguide/route_guide.proto --go_out=plugins=grpc:routeguide # \u5728\u76ee\u5f55\u4e0b\u751f\u6210\u5982\u4e0b\u6587\u4ef6 route_guide.pb.go route_guide.pb.go\u6587\u4ef6\u5305\u542b\uff1a \u586b\u5145\uff0c\u5e8f\u5217\u5316\u548c\u68c0\u7d22\u8bf7\u6c42\u548c\u54cd\u5e94\u6d88\u606f\u7c7b\u578b\u7684\u6240\u6709 protocol buffers \u4ee3\u7801 \u5b9e\u73b0 RouteGuide \u670d\u52a1\u4e2d\u5b9a\u4e49\u7684\u5ba2\u6237\u7aef\u63a5\u53e3\u7c7b\u578b\u6216stub\uff08\u5b58\u6839\uff09\u548c\u65b9\u6cd5 \u5b9e\u73b0 RouteGuide \u670d\u52a1\u4e2d\u5b9a\u4e49\u7684\u670d\u52a1\u7aef\u63a5\u53e3\u7c7b\u578b\u548c\u65b9\u6cd5","title":"\u751f\u6210\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4ee3\u7801"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_4","text":"\u9996\u5148\u521b\u5efa RouteGuide \u670d\u52a1\u7aef\u3002\u5982\u679c\u53ea\u5bf9\u521b\u5efagRPC\u5ba2\u6237\u7aef\u611f\u5174\u8da3\uff0c\u53ef\u4ee5\u8df3\u8fc7\u672c\u8282\u76f4\u63a5\u9605\u8bfb \u521b\u5efa\u5ba2\u6237\u7aef \u3002 \u8981\u4f7f RouteGuide \u670d\u52a1\u80fd\u591f\u6b63\u5e38\u63d0\u4f9b\u5b83\u7684\u670d\u52a1\uff0c\u6709\u4e24\u4e2a\u90e8\u5206\u9700\u8981\u5b8c\u6210\uff1a \u5b9e\u73b0\u4ece\u670d\u52a1\u5b9a\u4e49\u4e2d\u751f\u6210\u7684\u670d\u52a1\u63a5\u53e3\uff1a\u5b83\u6267\u884c\u670d\u52a1\u7684\u5b9e\u9645\u201c\u5de5\u4f5c\u201d \u8fd0\u884cgRPC\u670d\u52a1\u4ee5\u76d1\u542c\u6765\u81ea\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5e76\u5c06\u5176\u5206\u6d3e\u7ed9\u6b63\u786e\u7684\u670d\u52a1\u7aef\u5b9e\u73b0 \u5728 grpc-go/examples/route_guide/server/server.go \u4e2d\u53ef\u4ee5\u770b\u5230 RouteGuide \u670d\u52a1\u7aef\u6837\u4f8b\u3002","title":"\u521b\u5efa\u670d\u52a1\u7aef"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#routeguide","text":"\u5982\u4e0b\u6240\u793a\uff0c\u670d\u52a1\u7aef\u6709\u4e00\u4e2a\u53eb routeGuideServer \u7684\u7ed3\u6784\u4f53\u7c7b\u578b\u5b83\u5b9e\u73b0\u4e86\u81ea\u52a8\u751f\u6210\u7684 RouteGuideServer \u63a5\u53e3\u3002 type routeGuideServer struct { ... } ... func (s *routeGuideServer) GetFeature(ctx context.Context, point *pb.Point) (*pb.Feature, error) { ... } ... func (s *routeGuideServer) ListFeatures(rect *pb.Rectangle, stream pb.RouteGuide_ListFeaturesServer) error { ... } ... func (s *routeGuideServer) RecordRoute(stream pb.RouteGuide_RecordRouteServer) error { ... } ... func (s *routeGuideServer) RouteChat(stream pb.RouteGuide_RouteChatServer) error { ... } ...","title":"\u5b9e\u73b0 RouteGuide"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc","text":"routeGuideServer \u5b9e\u73b0\u4e86\u6240\u6709\u7684\u670d\u52a1\u65b9\u6cd5\uff0c\u5148\u770b\u770b\u6700\u7b80\u5355\u7684\u7c7b\u578b GetFeature() \uff0c\u5b83\u53ea\u662f\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6\u4e00\u4e2a Point \u5e76\u4ece\u67d0\u4e2a Feature \u81ea\u5df1\u7684\u6570\u636e\u5e93\u4e2d\u8fd4\u56de\u76f8\u5e94\u7684\u7279\u5f81\u4fe1\u606f\u3002 func (s *routeGuideServer) GetFeature(ctx context.Context, point *pb.Point) (*pb.Feature, error) { for _, feature := range s.savedFeatures { if proto.Equal(feature.Location, point) { return feature, nil } } // No feature was found, return an unnamed feature return pb.Feature{ , point}, nil } \u8be5\u65b9\u6cd5\u4f20\u9012RPC\u7684\u4e0a\u4e0b\u6587\u5bf9\u8c61\u548c\u5ba2\u6237\u7aef Point \u7c7b\u578b\u7684 protocol buffers \u8bf7\u6c42\u3002\u5b83\u8fd4\u56de\u4e00\u4e2a Feature \u7c7b\u578b\u7684 protocol buffers \u5bf9\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u54cd\u5e94\u4fe1\u606f\u548c\u9519\u8bef\u3002\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u9002\u5f53\u7684\u4fe1\u606f\u586b\u5145 Feature \uff0c\u7136\u540e\u5c06\u5176\u4e0e nil \u9519\u8bef\u4e00\u8d77\u8fd4\u56de\u6765\u544a\u8bc9gRPC\u5df2\u7ecf\u5b8c\u6210\u4e86RPC\u7684\u5904\u7406\uff0c\u7136\u540e Feature \u5c31\u53ef\u4ee5\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002","title":"\u7b80\u5355RPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_1","text":"\u73b0\u5728\u770b\u4e00\u4e0b\u6d41\u6570\u636eRPC\u3002 ListFeatures() \u65b9\u6cd5\u662f\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC\uff0c\u56e0\u6b64\u9700\u8981\u5c06\u591a\u4e2a Feature \u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 func (s *routeGuideServer) ListFeatures(rect *pb.Rectangle, stream pb.RouteGuide_ListFeaturesServer) error { for _, feature := range s.savedFeatures { if inRange(feature.Location, rect) { if err := stream.Send(feature); err != nil { return err } } } return nil } \u5982\u4e0a\u6240\u793a\uff0c\u6b64\u65b9\u6cd5\u4e0d\u662f\u5728\u65b9\u6cd5\u53c2\u6570\u4e2d\u83b7\u53d6\u7b80\u5355\u7684\u8bf7\u6c42\u548c\u54cd\u5e94\u5bf9\u8c61\uff0c\u800c\u662f\u5f97\u5230\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\uff08\u5728 Feature \u4e2d\u5ba2\u6237\u7aef\u60f3\u8981\u67e5\u627e\u7684 Rectangle \uff09\u548c\u4e00\u4e2a\u7279\u5b9a\u7684 RouteGuide_ListFeaturesServer \u5bf9\u8c61\u6765\u7f16\u5199\u6211\u4eec\u7684\u54cd\u5e94\u3002 \u5728\u8be5\u65b9\u6cd5\u4e2d\uff0c\u586b\u5145\u5c3d\u53ef\u80fd\u591a\u7684\u9700\u8981\u88ab\u8fd4\u56de\u7684 Feature \u5bf9\u8c61\uff0c\u5e76\u4f7f\u7528\u5176 Send() \u65b9\u6cd5\u5c06 Feature \u90fd\u5199\u5165 RouteGuide_ListFeaturesServer \u3002\u6700\u540e\uff0c\u5c31\u50cf\u5728\u7b80\u5355RPC\u65b9\u6cd5\u4e2d\u90a3\u6837\uff0c\u8fd4\u56de\u4e00\u4e2a nil \u9519\u8bef\u544a\u8bc9gRPC\u5df2\u7ecf\u5b8c\u6210\u4e86\u5199\u54cd\u5e94\u4fe1\u606f\u7684\u64cd\u4f5c\u3002\u5982\u679c\u5728\u6b64\u8c03\u7528\u4e2d\u53d1\u751f\u4efb\u4f55\u9519\u8bef\uff0c\u90a3\u4e48\u5c06\u8fd4\u56de\u975e\u96f6\u9519\u8bef; gRPC\u5c42\u4f1a\u5c06\u5176\u8f6c\u6362\u4e3a\u9002\u5f53\u7684RPC\u72b6\u6001\uff0c\u4ee5\u4fbf\u5728\u7ebf\u8def\u4e0a\u53d1\u9001\u3002","title":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_2","text":"\u73b0\u5728\u6765\u770b\u4e00\u4e9b\u66f4\u590d\u6742\u7684\u4e1c\u897f\uff1a\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 RecordRoute() \uff0c\u4ece\u5ba2\u6237\u7aef\u83b7\u53d6 Points \u7c7b\u578b\u7684\u6d41\u5e76\u8fd4\u56de\u5355\u4e2a\u5305\u542b\u6709\u5173\u4f20\u8f93\u94fe\u8def\u4fe1\u606f\u7684 RouteSummary \u3002\u5982\u4e0b\u6240\u793a\uff0c\u8be5\u65b9\u6cd5\u6839\u672c\u6ca1\u6709\u8bf7\u6c42\u53c2\u6570\u3002\u76f8\u53cd\uff0c\u5b83\u83b7\u53d6 RouteGuide_RecordRouteServer \u6d41\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u4f7f\u7528\u8be5\u6d41\u6765\u8bfb\u53d6\u548c\u5199\u5165\u6d88\u606f\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684 Recv() \u65b9\u6cd5\u63a5\u6536\u5ba2\u6237\u7aef\u6d88\u606f\uff0c\u5e76\u4f7f\u7528\u5b83\u7684 SendAndClose() \u65b9\u6cd5\u8fd4\u56de\u5176\u5355\u4e2a\u54cd\u5e94\u3002 func (s *routeGuideServer) RecordRoute(stream pb.RouteGuide_RecordRouteServer) error { var pointCount, featureCount, distance int32 var lastPoint *pb.Point startTime := time.Now() for { point, err := stream.Recv() if err == io.EOF { endTime := time.Now() return stream.SendAndClose( pb.RouteSummary{ PointCount: pointCount, FeatureCount: featureCount, Distance: distance, ElapsedTime: int32(endTime.Sub(startTime).Seconds()), }) } if err != nil { return err } pointCount++ for _, feature := range s.savedFeatures { if proto.Equal(feature.Location, point) { featureCount++ } } if lastPoint != nil { distance += calcDistance(lastPoint, point) } lastPoint = point } } \u5728\u65b9\u6cd5\u4f53\u4e2d\uff0c\u4f7f\u7528 RouteGuide_RecordRouteServer \u7684 Recv() \u65b9\u6cd5\u91cd\u590d\u8bfb\u53d6\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\uff08\u5728\u672c\u4f8b\u4e2d\u4e3a\u4e00\u4e2a Point \uff09\u7684\u8bf7\u6c42\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff0c\u670d\u52a1\u7aef\u9700\u8981\u68c0\u67e5\u6bcf\u6b21\u8c03\u7528 Recv() \u65b9\u6cd5\u540e\u4ece\u4e2d\u8fd4\u56de\u7684\u9519\u8bef err \u3002 \u5982\u679c\u9519\u8bef\u662f nil \uff0c\u90a3\u4e48\u8bf4\u660e\u6d41\u4ecd\u7136\u5904\u4e8e\u6b63\u5e38\u72b6\u6001\u5e76\u4e14\u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u8bfb\u53d6\u64cd\u4f5c \u5982\u679c\u9519\u8bef\u662f io.EOF \uff0c\u90a3\u4e48\u8bf4\u660e\u6d88\u606f\u6d41\u5df2\u7ecf\u7ed3\u675f\uff0c\u670d\u52a1\u7aef\u53ef\u4ee5\u8fd4\u56de\u5b83\u7684 RouteSummary \u5982\u679c\u9519\u8bef\u662f\u4efb\u4f55\u5176\u4ed6\u503c\uff0c\u90a3\u4e48\u5c06\u201c\u6309\u539f\u6837\u201d\u8fd4\u56de\u9519\u8bef\uff0c\u4ee5\u4fbfgRPC\u5c42\u5c06\u5176\u8f6c\u6362\u4e3aRPC\u72b6\u6001","title":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_3","text":"\u6700\u540e\uff0c\u770b\u4e00\u4e0b\u53cc\u5411\u6d41\u6570\u636ePRC RouteChat() \u65b9\u6cd5\u3002 func (s *routeGuideServer) RouteChat(stream pb.RouteGuide_RouteChatServer) error { for { in, err := stream.Recv() if err == io.EOF { return nil } if err != nil { return err } key := serialize(in.Location) ... // \u6b64\u5904\u4ee3\u7801 \u5bfb\u627e\u8981\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u7684note for _, note := range s.routeNotes[key] { if err := stream.Send(note); err != nil { return err } } } } \u5f97\u5230\u4e00\u4e2a RouteGuide_RouteChatServer \u6d41\uff0c\u5c31\u50cf\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u793a\u4f8b\u90a3\u6837\uff0c\u53ef\u7528\u4e8e\u8bfb\u53d6\u548c\u5199\u5165\u6d88\u606f\u3002\u4f46\u662f\uff0c\u5728\u8fd9\u91cc\u901a\u8fc7\u65b9\u6cd5\u7684\u6d41\u6765\u8fd4\u56de\u503c\uff0c\u54ea\u6015\u6b64\u65f6\u5ba2\u6237\u7aef\u4ecd\u5728\u5411\u5176\u6d88\u606f\u6d41\u5199\u5165\u6d88\u606f\u3002 \u8fd9\u91cc\u7684\u8bfb\u5199\u8bed\u6cd5\u4e0e\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u4e2d\u7684\u8bed\u6cd5\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u6b64\u5904\u670d\u52a1\u7aef\u4f7f\u7528\u6d41\u7684 Send() \u65b9\u6cd5\u800c\u4e0d\u662f SendAndClose() \u65b9\u6cd5\uff0c\u56e0\u4e3a\u5b83\u6b63\u5728\u5199\u5165\u591a\u4e2a\u54cd\u5e94\u3002\u5c3d\u7ba1\u6bcf\u4e00\u65b9\u90fd\u4f1a\u6309\u7167\u5199\u5165\u7684\u987a\u5e8f\u83b7\u53d6\u5bf9\u65b9\u7684\u6d88\u606f\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u56e0\u4e3a\uff0c\u8fd9\u4e9b\u6d41\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u3002","title":"\u53cc\u5411\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_5","text":"\u5b9e\u73b0\u4e86\u6240\u6709\u65b9\u6cd5\u540e\uff0c\u8fd8\u9700\u8981\u542f\u52a8\u4e00\u4e2agRPC\u670d\u52a1\u7aef\uff0c\u4ee5\u4fbf\u5ba2\u6237\u7aef\u53ef\u4ee5\u5b9e\u9645\u4f7f\u7528\u6211\u4eec\u7684\u670d\u52a1\u3002\u4ee5\u4e0b\u4ee3\u7801\u6bb5\u663e\u793a\u4e86\u5982\u4f55\u4e3a RouteGuide \u670d\u52a1\u6267\u884c\u6b64\u64cd\u4f5c\uff1a flag.Parse() lis, err := net.Listen( tcp , fmt.Sprintf( :%d , *port)) if err != nil { log.Fatalf( failed to listen: %v , err) } grpcServer := grpc.NewServer() pb.RegisterRouteGuideServer(grpcServer, routeGuideServer{}) ... // \u6b64\u5904\u4ee3\u7801 \u786e\u5b9a\u662f\u5426\u542f\u52a8TLS grpcServer.Serve(lis) \u8981\u6784\u5efa\u548c\u542f\u52a8\u4e00\u4e2a\u670d\u52a1\u7aef\uff0c\u6211\u4eec\u9700\u8981\uff1a \u4f7f\u7528 lis, err := net.Listen(\"tcp\", fmt.Sprintf(\":%d\", *port)). \u6307\u5b9a\u9700\u8981\u76d1\u542c\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u7aef\u53e3 \u4f7f\u7528 grpc.NewServer() \u521b\u5efa\u4e00\u4e2agRPC\u670d\u52a1\u7aef\u5b9e\u4f8b \u4f7f\u7528gRPC\u670d\u52a1\u7aef\u6ce8\u518c\u6211\u4eec\u5b9e\u73b0\u7684\u670d\u52a1 \u4f7f\u7528\u7aef\u53e3\u8be6\u7ec6\u4fe1\u606f\u8c03\u7528\u670d\u52a1\u7aef\u7684 Serve() \u65b9\u6cd5\u8fdb\u884c\u963b\u585e\u7b49\u5f85\uff0c\u76f4\u5230\u8fdb\u7a0b\u88ab\u7ec8\u6b62\u6216\u8c03\u7528 Stop() \u3002","title":"\u542f\u52a8\u670d\u52a1\u7aef"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_6","text":"\u5728\u672c\u8282\u4e2d\uff0c\u5c06\u4ecb\u7ecd\u5982\u4f55\u4e3a RouteGuide \u670d\u52a1\u521b\u5efaGo\u5ba2\u6237\u7aef\uff0c\u53ef\u4ee5\u5728 grpc-go/examples/route_guide/client/client.go \u4e2d\u67e5\u770b\u5b8c\u6574\u7684\u793a\u4f8b\u5ba2\u6237\u7aef\u4ee3\u7801\u3002","title":"\u521b\u5efa\u5ba2\u6237\u7aef"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#stub","text":"\u8981\u8c03\u7528\u670d\u52a1\u7aef\u7684\u65b9\u6cd5\uff0c\u9996\u5148\u9700\u8981\u521b\u5efa\u4e00\u4e2agRPC\u901a\u9053\u6765\u4e0e\u670d\u52a1\u7aef\u901a\u4fe1\u3002\u901a\u8fc7\u5c06\u670d\u52a1\u5668\u5730\u5740\u548c\u7aef\u53e3\u53f7\u4f20\u9012\u7ed9 grpc.Dial() \u6765\u521b\u5efa\u5b83\uff0c\u5982\u4e0b\u6240\u793a\uff1a conn, err := grpc.Dial(*serverAddr) if err != nil { ... } defer conn.Close() \u5982\u679c\u8bf7\u6c42\u7684\u670d\u52a1\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\uff0c\u53ef\u4ee5\u4f7f\u7528 DialOptions \u5728 grpc.Dial() \u65b9\u6cd5\u4e2d\u8bbe\u7f6e\u8eab\u4efd\u9a8c\u8bc1\u51ed\u636e\uff08\u4f8b\u5982\uff0cTLS\uff0cGCE\u51ed\u636e\uff0cJWT\u51ed\u8bc1\uff0c\u4f46\u662f\uff0c\u5728\u8fd9\u91cc\u7684 RouteGuide \u670d\u52a1\u4e2d\u4e0d\u9700\u8981\u6267\u884c\u6b64\u64cd\u4f5c\u3002 \u4e00\u65e6gRPC\u901a\u9053\u5efa\u7acb\u8d77\u6765\uff0c\u5c31\u9700\u8981\u6709\u4e00\u4e2a\u5ba2\u6237\u7aefstub(\u5b58\u6839)\u6765\u6267\u884cRPC\u8c03\u7528\u3002\u6211\u4eec\u4f7f\u7528\u4ece .proto \u6587\u4ef6\u4e2d\u751f\u6210\u7684\u5728 pb \u5305\u4e2d\u63d0\u4f9b\u7684 NewRouteGuideClient() \u65b9\u6cd5\u521b\u5efa\u4e00\u4e2a\u5ba2\u6237\u7aefstub\u3002 client := pb.NewRouteGuideClient(conn)","title":"\u521b\u5efa\u4e00\u4e2astub\uff08\u5b58\u6839\uff09"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_7","text":"\u73b0\u5728\u6765\u770b\u770b\u5982\u4f55\u8c03\u7528\u670d\u52a1\u65b9\u6cd5\u3002\u8bf7\u6ce8\u610f\uff0c\u5728 gRPC-Go \u4e2d\uff0cRPC\u4ee5 \u963b\u585e/\u540c\u6b65 \u6a21\u5f0f\u8fd0\u884c\uff0c\u8fd9\u610f\u5473\u7740RPC\u8c03\u7528\u7b49\u5f85\u670d\u52a1\u7aef\u54cd\u5e94\uff0c\u5e76\u5c06\u8fd4\u56de\u54cd\u5e94\u6216\u9519\u8bef\u3002","title":"\u8c03\u7528\u670d\u52a1\u7aef\u65b9\u6cd5"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_4","text":"\u8c03\u7528\u7b80\u5355RPC\u7684 GetFeature() \u65b9\u6cd5\u51e0\u4e4e\u4e0e\u8c03\u7528\u672c\u5730\u65b9\u6cd5\u4e00\u6837\u7b80\u5355\u3002 feature, err := client.GetFeature(context.Background(), pb.Point{409146138, -746188906}) if err != nil { ... } \u5982\u4e0a\u6240\u793a\uff1a\u5728\u4e4b\u524d\u83b7\u5f97\u7684 stub \u4e0a\u8c03\u7528\u8be5\u65b9\u6cd5\uff0c\u5728\u65b9\u6cd5\u53c2\u6570\u4e2d\uff0c\u521b\u5efa\u5e76\u586b\u5145\u8bf7\u6c42 protocol buffers \u5bf9\u8c61\uff08\u5728\u4f8b\u5b50\u4e2d\u4e3a Point \uff09\u3002 \u8fd8\u4f20\u9012\u4e00\u4e2a context.Context \u5bf9\u8c61\uff0c\u5b83\u5141\u8bb8\u6211\u4eec\u5728\u5fc5\u8981\u65f6\u66f4\u6539RPC\u7684\u884c\u4e3a\uff0c\u4f8b\u5982\u8d85\u65f6/\u53d6\u6d88\u6267\u884c\u4e2d\u7684RPC\u8bf7\u6c42\u3002\u5982\u679c\u8c03\u7528\u6ca1\u6709\u8fd4\u56de\u9519\u8bef\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece\u7b2c\u4e00\u4e2a\u8fd4\u56de\u503c\u4e2d\u8bfb\u53d6\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u4fe1\u606f\u3002 log.Println(feature)","title":"\u7b80\u5355RPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_5","text":"\u8fd9\u662f\u8c03\u7528\u670d\u52a1\u7aef\u6d41\u65b9\u6cd5 ListFeatures() \u7684\u5730\u65b9\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de\u5730\u7406 Feature \u6d41\u3002\u5982\u679c\u5df2\u7ecf\u9605\u8bfb\u8fc7 \u521b\u5efa\u670d\u52a1\u7aef \uff0c\u5176\u4e2d\u4e00\u4e9b\u90e8\u5206\u53ef\u80fd\u770b\u8d77\u6765\u975e\u5e38\u719f\u6089\uff1a\u6d41\u6570\u636eRPC\u5728\u670d\u52a1\u7aef\u548c\u5ba2\u6237\u7aef\u4e4b\u95f4\u90fd\u4ee5\u7c7b\u4f3c\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002 rect := pb.Rectangle{ ... } // initialize a pb.Rectangle stream, err := client.ListFeatures(context.Background(), rect) if err != nil { ... } for { feature, err := stream.Recv() if err == io.EOF { break } if err != nil { log.Fatalf( %v.ListFeatures(_) = _, %v , client, err) } log.Println(feature) } \u4e0e\u7b80\u5355\u7684RPC\u4e00\u6837\uff0c\u4f20\u9012\u4e0a\u4e0b\u6587\u548c\u8bf7\u6c42\u7ed9\u65b9\u6cd5\uff0c\u4f46\u662f\u5728\u8fd9\u91cc\u4e0d\u4f1a\u8fd4\u56de\u54cd\u5e94\u5bf9\u8c61\uff0c\u800c\u662f\u8fd4\u56de RouteGuide_ListFeaturesClient \u7684\u5b9e\u4f8b\u3002\u8fd9\u4e2a\u5ba2\u6237\u7aef\u5b9e\u4f8b\u53ef\u4ee5\u4f7f\u7528 RouteGuide_ListFeaturesClient \u6d41\u6765\u8bfb\u53d6\u670d\u52a1\u7aef\u7684\u54cd\u5e94\u3002 \u4f7f\u7528 RouteGuide_ListFeaturesClient \u7684 Recv() \u65b9\u6cd5\u91cd\u590d\u7684\u5728\u670d\u52a1\u5668\u7684\u54cd\u5e94\u4e2d\u8bfb\u53d6protocol buffers\u5bf9\u8c61\uff08\u5728\u672c\u4f8b\u4e2d\u4e3aFeature\uff09\uff0c\u76f4\u5230\u6ca1\u6709\u66f4\u591a\u6d88\u606f\uff1a\u8fd9\u4e2a\u5ba2\u6237\u7aef\u5b9e\u4f8b\u9700\u8981\u68c0\u67e5\u6bcf\u6b21\u8c03\u7528 Recv() \u8fd4\u56de\u7684\u9519\u8bef err \u3002 \u5982\u679c\u662f nil \uff0c\u90a3\u4e48\u8bf4\u660e\u8fd9\u4e2a\u6d41\u4ecd\u7136\u662f\u6b63\u5e38\u7684\u5e76\u4e14\u53ef\u4ee5\u7ee7\u7eed\u8bfb\u53d6 \u5982\u679c\u662f io.EOF \uff0c\u90a3\u4e48\u8bf4\u660e\u6d88\u606f\u6d41\u5df2\u7ecf\u7ed3\u675f \u5426\u5219\u5fc5\u987b\u6709\u4e00\u4e2aRPC\u9519\u8bef\uff0c\u5b83\u901a\u8fc7 err \u53c2\u6570\u4f20\u9012\u3002","title":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_6","text":"\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5 RecordRoute \u7c7b\u4f3c\u4e8e\u670d\u52a1\u5668\u7aef\u65b9\u6cd5\uff0c\u4e0d\u8fc7\u53ea\u4f20\u9012\u7ed9\u65b9\u6cd5\u4e00\u4e2a\u4e0a\u4e0b\u6587\uff0c\u7136\u540e\u4f1a\u83b7\u53d6\u4e00\u4e2a RouteGuide_RecordRouteClient \u6d41\u7684\u8fd4\u56de\uff0c\u8fd9\u4e2a\u6d41\u53ef\u4ee5\u7528\u6765\u5199\u548c\u8bfb\u6d88\u606f\u3002 // Create a random number of random points r := rand.New(rand.NewSource(time.Now().UnixNano())) pointCount := int(r.Int31n(100)) + 2 // Traverse at least two points var points []*pb.Point for i := 0; i pointCount; i++ { points = append(points, randomPoint(r)) } log.Printf( Traversing %d points. , len(points)) stream, err := client.RecordRoute(context.Background()) if err != nil { log.Fatalf( %v.RecordRoute(_) = _, %v , client, err) } for _, point := range points { if err := stream.Send(point); err != nil { if err == io.EOF { break } log.Fatalf( %v.Send(%v) = %v , stream, point, err) } } reply, err := stream.CloseAndRecv() if err != nil { log.Fatalf( %v.CloseAndRecv() got error %v, want %v , stream, err, nil) } log.Printf( Route summary: %v , reply) RouteGuide_RecordRouteClient \u6709\u4e00\u4e2a Send() \u65b9\u6cd5\uff0c\u53ef\u4ee5\u7528\u5b83\u5411\u670d\u52a1\u7aef\u53d1\u9001\u8bf7\u6c42\u3002\u4e00\u65e6\u4f7f\u7528 Send() \u5c06\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u5411\u6d41\u4e2d\u5199\u5165\u5b8c\u6210\uff0c\u5c31\u9700\u8981\u5728\u6d41\u4e0a\u8c03\u7528 CloseAndRecv() \u65b9\u6cd5\u8ba9gRPC\u77e5\u9053\u6211\u4eec\u5df2\u5b8c\u6210\u5199\u5165\u5e76\u671f\u671b\u6536\u5230\u54cd\u5e94\u3002\u53ef\u4ee5\u4ece CloseAndRecv() \u8fd4\u56de\u7684\u9519\u8bef err \u4e2d\u83b7\u53d6RPC\u72b6\u6001\uff0c\u5982\u679c\u72b6\u6001\u4e3a nil \uff0c\u90a3\u4e48 CloseAndRecv() \u7684\u7b2c\u4e00\u4e2a\u8fd4\u56de\u503c\u5c06\u662f\u6709\u6548\u7684\u670d\u52a1\u7aef\u54cd\u5e94\u3002","title":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#rpc_7","text":"\u6700\u540e\u662f\u53cc\u5411\u6d41\u6570\u636eRPC RouteChat() \u3002\u4e0e RecordRoute \u7684\u60c5\u51b5\u4e00\u6837\uff0c\u53ea\u7ed9\u65b9\u6cd5\u4f20\u9012\u4e00\u4e2a\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff0c\u7136\u540e\u83b7\u5f97\u8fd4\u56de\u4e00\u4e2a\u53ef\u7528\u4e8e\u5199\u5165\u548c\u8bfb\u53d6\u6d88\u606f\u7684\u6d41\u3002\u4f46\u662f\uff0c\u8fd9\u6b21\u901a\u8fc7\u65b9\u6cd5\u7684\u6d41\u8fd4\u56de\u503c\uff0c\u800c\u670d\u52a1\u7aef\u4ecd\u5728\u5411\u5176\u6d88\u606f\u6d41\u5199\u5165\u6d88\u606f\u3002 stream, err := client.RouteChat(context.Background()) waitc := make(chan struct{}) go func() { for { in, err := stream.Recv() if err == io.EOF { // read done. close(waitc) return } if err != nil { log.Fatalf( Failed to receive a note : %v , err) } log.Printf( Got message %s at point(%d, %d) , in.Message, in.Location.Latitude, in.Location.Longitude) } }() for _, note := range notes { if err := stream.Send(note); err != nil { log.Fatalf( Failed to send a note: %v , err) } } stream.CloseSend() -waitc \u8fd9\u91cc\u7684\u8bfb\u5199\u8bed\u6cd5\u4e0e\u5ba2\u6237\u7aef\u6d41\u65b9\u6cd5\u7684\u8bed\u6cd5\u975e\u5e38\u76f8\u4f3c\uff0c\u53ea\u662f\u5728\u5b8c\u6210\u8c03\u7528\u540e\u4f7f\u7528\u6d41\u7684 CloseSend() \u65b9\u6cd5\u3002\u5c3d\u7ba1\u6bcf\u4e00\u65b9\u90fd\u4f1a\u6309\u7167\u5199\u5165\u987a\u5e8f\u83b7\u53d6\u5bf9\u65b9\u7684\u6d88\u606f\uff0c\u4f46\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u90fd\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u8bfb\u5199\uff0c\u8fd9\u4e9b\u6d41\u5b8c\u5168\u72ec\u7acb\u8fd0\u884c\u3002","title":"\u53cc\u5411\u6d41\u6570\u636eRPC"},{"location":"Frameworks/gRPC/08-Golang\u5e94\u7528/#_8","text":"\u8981\u7f16\u8bd1\u548c\u8fd0\u884c\u670d\u52a1\u7aef\uff0c\u5047\u8bbe\u4f4d\u4e8e $GOPATH/src/google.golang.org/grpc/examples/route_guide \u6587\u4ef6\u5939\u4e2d\uff0c\u53ea\u9700\uff1a go run server/server.go \u540c\u6837\uff0c\u8981\u8fd0\u884c\u5ba2\u6237\u7aef\uff1a go run client/client.go","title":"\u641e\u8d77\u6765"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/","text":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357 \u672c\u6307\u5357\u63cf\u8ff0\u4e86\u4f7f\u7528 protoc \u7f16\u8bd1 .proto \u6587\u4ef6\u65f6\u5728 protoc-gen-go \u63d2\u4ef6\u4e2d\u4f7f\u7528 grpc \u63d2\u4ef6\u751f\u6210\u4ee3\u7801\u3002 \u5728 \u670d\u52a1\u5b9a\u4e49 \u7ae0\u8282\u4e2d\u67e5\u770b\u5982\u4f55\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\u3002 \u7ebf\u7a0b\u5b89\u5168 \uff1a\u6ce8\u610f\u5ba2\u6237\u7aefRPC\u8c03\u7528\u548c\u670d\u52a1\u7aefRPC\u5904\u7406\u90fd\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u8fd9\u610f\u5473\u7740\u80fd\u5728\u5e76\u53d1\u7684 goroutine \u4e2d\u8fd0\u884c\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e\u5355\u4e2a\u6d41\u6765\u8bf4\uff0c\u4f20\u5165\u548c\u4f20\u51fa\u6570\u636e\u662f\u53cc\u5411\u4e32\u884c\u7684\uff0c\u6240\u4ee5\u5355\u4e2a\u6d41\u4e0d\u652f\u6301\u5e76\u53d1\u8bfb\u53d6\u5e76\u53d1\u5199\u5165\uff08\u4f46\u5e76\u53d1\u6267\u884c\u8bfb\u5165\u548c\u5199\u5165\u662f\u5b89\u5168\u7684\uff09\u3002 \u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u7684\u65b9\u6cd5 \u5728\u670d\u52a1\u7aef\uff0c .proto \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u90fd\u4f1a\u751f\u6210\u5982\u4e0b\u51fd\u6570\uff1a func RegisterBarServer(s *grpc.Server, srv BarServer) \u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5b9a\u4e49 BarServer \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u5e76\u4f7f\u7528\u6b64\u51fd\u6570\u5c06\u5176\u6ce8\u518c\u5230 grpc.Server \u5b9e\u4f8b\uff08\u5728\u542f\u52a8\u670d\u52a1\u7aef\u5b9e\u4f8b\u4e4b\u524d\uff09\u3002 \u7b80\u5355\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(context.Context, *MsgA) (*MsgB, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d: MsgA \uff1a\u662f\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u7684 protobuf \u6d88\u606f MsgB \uff1a\u662f\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684 protobuf \u6d88\u606f \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(*MsgA, ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a MsgA \uff1a\u662f\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u5355\u4e2a\u8bf7\u6c42 ServiceName _FooServer \uff1a\u53c2\u6570\u4ee3\u8868\u4f20\u9001 MsgB \u6d88\u606f\u7684\uff0c\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41 ServiceName _FooServer \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { Send(*MsgB) error grpc.ServerStream } \u670d\u52a1\u7aef\u7684\u5904\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u7684 Send \u65b9\u6cd5\u53d1\u9001 protobuf \u6d88\u606f\u6d41\u5230\u5ba2\u6237\u7aef\u3002\u6839\u636e\u670d\u52a1\u7aef\u5904\u7406\u5668\u65b9\u6cd5\u7684\u8fd4\u56de\u7ed3\u679c\u6765\u5224\u65ad\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41\u662f\u5426\u7ed3\u675f\u3002 \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo( ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d: ServiceName _FooServer \uff1a \u65e2\u53ef\u4ee5\u7528\u6765\u8bfb\u53d6\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41 \u4e5f\u53ef\u4ee5\u7528\u6765\u53d1\u9001\u5355\u4e2a\u7684\u670d\u52a1\u54cd\u5e94\u6d88\u606f ServiceName _FooServer \uff1a\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { SendAndClose(*MsgA) error Recv() (*MsgB, error) grpc.ServerStream } \u670d\u52a1\u7aef\u7684\u5904\u7406\u5668\u53ef\u4ee5\u5728\u8fd9\u4e2a\u53c2\u6570\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u6765\u63a5\u6536\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u6d41\u4e2d\u7684\u5168\u90e8\u6d88\u606f\u3002\u4e00\u65e6\u5230\u8fbe\u6d41\u7684\u672b\u5c3e Recv() \u5c06\u8fd4\u56de (nil,io.EOF) \u3002\u670d\u52a1\u7aef\u5355\u72ec\u7684\u54cd\u5e94\u6d88\u606f\u662f\u901a\u8fc7\u8c03\u7528 ServiceName _FooServer \u53c2\u6570\u4e2d\u7684 SendAndClose() \u65b9\u6cd5\u53d1\u9001\u7684\u3002 \u8bf7\u6ce8\u610f\uff0cSendAndClose()\u65b9\u6cd5\u80fd\u4e14\u4ec5\u80fd\u8c03\u7528\u4e00\u6b21 \u3002 \u53cc\u5411\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo( ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooServer \uff1a \u7528\u4e8e\u8fde\u63a5\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41 \u4e5f\u7528\u4e8e\u8fde\u63a5\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41 ServiceName _FooServer \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { Send(*MsgA) error Recv() (*MsgB, error) grpc.ServerStream } \u670d\u52a1\u7aef\u5904\u7406\u5668\u53ef\u4ee5\u5728\u8fd9\u4e2a\u53c2\u6570\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\u6765\u8bfb\u53d6\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u4e00\u65e6\u5230\u8fbe\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d41\u7684\u672b\u5c3e Recv() \u8fd4\u56de (nil,io.EOF) \u3002 \u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u6d88\u606f\u6d41\u662f\u901a\u8fc7\u91cd\u590d\u8c03\u7528 ServiceName _FooServer \u53c2\u6570\u7684 Send() \u65b9\u6cd5\u53d1\u9001\u51fa\u6765\u7684\u3002 bidi \uff08\u53cc\u5411\uff09\u65b9\u6cd5\u5904\u7406\u5668\u7684\u8fd4\u56de\u7684\u7ed3\u679c\u8868\u793a\u4ece\u670d\u52a1\u5668\u5230\u5ba2\u6237\u7aef\u6d41\u7684\u7ed3\u675f\u3002 \u751f\u6210\u5ba2\u6237\u7aef\u63a5\u53e3\u7684\u65b9\u6cd5 \u5bf9\u4e8e\u5ba2\u6237\u7aef\u7684\u4f7f\u7528\u6765\u8bf4\uff0c\u5728 .proto \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e0b\u51fd\u6570: func BarClient(cc *grpc.ClientConn) BarClient \u5b83\u8fd4\u56de BarClient \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff08\u8fd9\u4e2a\u5177\u4f53\u5b9e\u73b0\u4e5f\u5b58\u5728\u4e8e\u751f\u6210\u7684 .pb.go \u6587\u4ef6\u4e2d\uff09\u3002 \u7b80\u5355\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a (ctx context.Context, in *MsgA, opts ...grpc.CallOption) (*MsgB, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a MsgA \uff1a\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u4e00\u4e2a\u5355\u4e00\u8bf7\u6c42 MsgB \uff1a\u5305\u542b\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u54cd\u5e94\u4fe1\u606f \u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, in *MsgA, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4e86\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u5305\u542b MsgB \u6d88\u606f\u7684\u6d41 \u8fd9\u4e2a\u6d41\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u5982\u4e0b\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Recv() (*MsgB, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u8fd9\u4e2a\u6d41\u5c31\u5f00\u59cb\u4e86\u3002\u8fd9\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u8bfb\u53d6\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u6d88\u606f\u6d41\u3002\u4e00\u65e6\u5b8c\u5168\u8bfb\u53d6\u4e86\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41\uff0c Recv() \u65b9\u6cd5\u8fd4\u56de (nil,io.EOF) \u3002 \u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u5305\u542b MsgA \u6d88\u606f\u7684\u6d41 ServiceName _FooClient \uff1a\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Send(*MsgA) error CloseAndRecv() (*MsgA, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u6d41\u5f00\u59cb\u3002\u5ba2\u6237\u7aef\u4f1a\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Send() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u53d1\u9001\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u8fd9\u4e2a\u6d41\u7684 CloseAndRecv() \u65b9\u6cd5 \u80fd\u4e14\u4ec5\u80fd\u8c03\u7528\u4e00\u6b21 \uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u5173\u95ed\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u6d41\u7684\u540c\u65f6\u63a5\u6536\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u5355\u4e2a\u54cd\u5e94\u6d88\u606f\u3002 \u53cc\u5411\u6d41\u6570\u636e\u65b9\u6cd5 \u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\uff0c\u4e5f\u4ee3\u8868\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41 ServiceName _FooClient \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u5982\u4e0b\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Send(*MsgA) error Recv() (*MsgB, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u6d41\u5f00\u59cb\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u4e0a\u91cd\u590d\u8c03\u7528 Send() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u53d1\u9001\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u5ba2\u6237\u7aef\u4e5f\u53ef\u4ee5\u5728\u8fd9\u4e2a\u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u63a5\u6536\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41\u4e2d\u5168\u90e8\u6d88\u606f\u3002 \u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u6d41\u7684\u7ed3\u675f\u7531\u6d41\u7684 Recv() \u65b9\u6cd5\u4e0a\u7684\u8fd4\u56de\u503c (nil,io.EOF) \u6307\u793a\u3002 \u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u6d41\u7684\u7ed3\u675f\u7531\u5ba2\u6237\u7aef\u901a\u8fc7\u5728\u6d41\u4e0a\u8c03\u7528 CloseSend() \u65b9\u6cd5\u6307\u793a\u3002 \u5305\u548c\u547d\u540d\u7a7a\u95f4 \u4f7f\u7528 --go_out=plugins=grpc: \u8c03\u7528 protoc \u7f16\u8bd1\u5668\u65f6\uff0c\u4ece proto \u5305\u5230 Go \u5305\u7684\u8f6c\u6362\u4e0e\u4f7f\u7528 protoc-gen-go \u63d2\u4ef6\u800c\u4e0d\u4f7f\u7528 grpc \u63d2\u4ef6\u7684\u5de5\u4f5c\u65b9\u5f0f\u76f8\u540c\u3002 \u56e0\u6b64\uff0c\u4f8b\u5982\uff0c\u5982\u679c foo.proto \u58f0\u660e\u81ea\u5df1\u5728\u5305 foo \u4e2d\uff0c\u90a3\u4e48\u751f\u6210\u7684 foo.pb.go \u6587\u4ef6\u4e5f\u5c06\u5728Go\u5305 foo \u4e2d\u3002","title":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#go","text":"\u672c\u6307\u5357\u63cf\u8ff0\u4e86\u4f7f\u7528 protoc \u7f16\u8bd1 .proto \u6587\u4ef6\u65f6\u5728 protoc-gen-go \u63d2\u4ef6\u4e2d\u4f7f\u7528 grpc \u63d2\u4ef6\u751f\u6210\u4ee3\u7801\u3002 \u5728 \u670d\u52a1\u5b9a\u4e49 \u7ae0\u8282\u4e2d\u67e5\u770b\u5982\u4f55\u5728 .proto \u6587\u4ef6\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u670d\u52a1\u3002 \u7ebf\u7a0b\u5b89\u5168 \uff1a\u6ce8\u610f\u5ba2\u6237\u7aefRPC\u8c03\u7528\u548c\u670d\u52a1\u7aefRPC\u5904\u7406\u90fd\u662f\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u8fd9\u610f\u5473\u7740\u80fd\u5728\u5e76\u53d1\u7684 goroutine \u4e2d\u8fd0\u884c\u3002\u4f46\u662f\u8bf7\u6ce8\u610f\uff0c\u5bf9\u4e8e\u5355\u4e2a\u6d41\u6765\u8bf4\uff0c\u4f20\u5165\u548c\u4f20\u51fa\u6570\u636e\u662f\u53cc\u5411\u4e32\u884c\u7684\uff0c\u6240\u4ee5\u5355\u4e2a\u6d41\u4e0d\u652f\u6301\u5e76\u53d1\u8bfb\u53d6\u5e76\u53d1\u5199\u5165\uff08\u4f46\u5e76\u53d1\u6267\u884c\u8bfb\u5165\u548c\u5199\u5165\u662f\u5b89\u5168\u7684\uff09\u3002","title":"Go\u751f\u6210\u4ee3\u7801\u6307\u5357"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_1","text":"\u5728\u670d\u52a1\u7aef\uff0c .proto \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u90fd\u4f1a\u751f\u6210\u5982\u4e0b\u51fd\u6570\uff1a func RegisterBarServer(s *grpc.Server, srv BarServer) \u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u5b9a\u4e49 BarServer \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u5e76\u4f7f\u7528\u6b64\u51fd\u6570\u5c06\u5176\u6ce8\u518c\u5230 grpc.Server \u5b9e\u4f8b\uff08\u5728\u542f\u52a8\u670d\u52a1\u7aef\u5b9e\u4f8b\u4e4b\u524d\uff09\u3002","title":"\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u7684\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_2","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(context.Context, *MsgA) (*MsgB, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d: MsgA \uff1a\u662f\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u7684 protobuf \u6d88\u606f MsgB \uff1a\u662f\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684 protobuf \u6d88\u606f","title":"\u7b80\u5355\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_3","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(*MsgA, ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a MsgA \uff1a\u662f\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u5355\u4e2a\u8bf7\u6c42 ServiceName _FooServer \uff1a\u53c2\u6570\u4ee3\u8868\u4f20\u9001 MsgB \u6d88\u606f\u7684\uff0c\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41 ServiceName _FooServer \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { Send(*MsgB) error grpc.ServerStream } \u670d\u52a1\u7aef\u7684\u5904\u7406\u5668\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u53c2\u6570\u7684 Send \u65b9\u6cd5\u53d1\u9001 protobuf \u6d88\u606f\u6d41\u5230\u5ba2\u6237\u7aef\u3002\u6839\u636e\u670d\u52a1\u7aef\u5904\u7406\u5668\u65b9\u6cd5\u7684\u8fd4\u56de\u7ed3\u679c\u6765\u5224\u65ad\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41\u662f\u5426\u7ed3\u675f\u3002","title":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_4","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo( ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d: ServiceName _FooServer \uff1a \u65e2\u53ef\u4ee5\u7528\u6765\u8bfb\u53d6\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41 \u4e5f\u53ef\u4ee5\u7528\u6765\u53d1\u9001\u5355\u4e2a\u7684\u670d\u52a1\u54cd\u5e94\u6d88\u606f ServiceName _FooServer \uff1a\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { SendAndClose(*MsgA) error Recv() (*MsgB, error) grpc.ServerStream } \u670d\u52a1\u7aef\u7684\u5904\u7406\u5668\u53ef\u4ee5\u5728\u8fd9\u4e2a\u53c2\u6570\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u6765\u63a5\u6536\u4ece\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u6d41\u4e2d\u7684\u5168\u90e8\u6d88\u606f\u3002\u4e00\u65e6\u5230\u8fbe\u6d41\u7684\u672b\u5c3e Recv() \u5c06\u8fd4\u56de (nil,io.EOF) \u3002\u670d\u52a1\u7aef\u5355\u72ec\u7684\u54cd\u5e94\u6d88\u606f\u662f\u901a\u8fc7\u8c03\u7528 ServiceName _FooServer \u53c2\u6570\u4e2d\u7684 SendAndClose() \u65b9\u6cd5\u53d1\u9001\u7684\u3002 \u8bf7\u6ce8\u610f\uff0cSendAndClose()\u65b9\u6cd5\u80fd\u4e14\u4ec5\u80fd\u8c03\u7528\u4e00\u6b21 \u3002","title":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_5","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u670d\u52a1\u7aef\u63a5\u53e3\u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo( ServiceName _FooServer) error \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooServer \uff1a \u7528\u4e8e\u8fde\u63a5\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41 \u4e5f\u7528\u4e8e\u8fde\u63a5\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41 ServiceName _FooServer \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ServerStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooServer interface { Send(*MsgA) error Recv() (*MsgB, error) grpc.ServerStream } \u670d\u52a1\u7aef\u5904\u7406\u5668\u53ef\u4ee5\u5728\u8fd9\u4e2a\u53c2\u6570\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\u6765\u8bfb\u53d6\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u4e00\u65e6\u5230\u8fbe\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d41\u7684\u672b\u5c3e Recv() \u8fd4\u56de (nil,io.EOF) \u3002 \u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u6d88\u606f\u6d41\u662f\u901a\u8fc7\u91cd\u590d\u8c03\u7528 ServiceName _FooServer \u53c2\u6570\u7684 Send() \u65b9\u6cd5\u53d1\u9001\u51fa\u6765\u7684\u3002 bidi \uff08\u53cc\u5411\uff09\u65b9\u6cd5\u5904\u7406\u5668\u7684\u8fd4\u56de\u7684\u7ed3\u679c\u8868\u793a\u4ece\u670d\u52a1\u5668\u5230\u5ba2\u6237\u7aef\u6d41\u7684\u7ed3\u675f\u3002","title":"\u53cc\u5411\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_6","text":"\u5bf9\u4e8e\u5ba2\u6237\u7aef\u7684\u4f7f\u7528\u6765\u8bf4\uff0c\u5728 .proto \u6587\u4ef6\u4e2d\u7684\u6bcf\u4e2a\u670d\u52a1\u90fd\u4f1a\u4ea7\u751f\u4e00\u4e0b\u51fd\u6570: func BarClient(cc *grpc.ClientConn) BarClient \u5b83\u8fd4\u56de BarClient \u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff08\u8fd9\u4e2a\u5177\u4f53\u5b9e\u73b0\u4e5f\u5b58\u5728\u4e8e\u751f\u6210\u7684 .pb.go \u6587\u4ef6\u4e2d\uff09\u3002","title":"\u751f\u6210\u5ba2\u6237\u7aef\u63a5\u53e3\u7684\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_7","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a (ctx context.Context, in *MsgA, opts ...grpc.CallOption) (*MsgB, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a MsgA \uff1a\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u4e00\u4e2a\u5355\u4e00\u8bf7\u6c42 MsgB \uff1a\u5305\u542b\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u54cd\u5e94\u4fe1\u606f","title":"\u7b80\u5355\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_8","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, in *MsgA, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4e86\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u5305\u542b MsgB \u6d88\u606f\u7684\u6d41 \u8fd9\u4e2a\u6d41\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u5982\u4e0b\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Recv() (*MsgB, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u8fd9\u4e2a\u6d41\u5c31\u5f00\u59cb\u4e86\u3002\u8fd9\u4e2a\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u8bfb\u53d6\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\u6d88\u606f\u6d41\u3002\u4e00\u65e6\u5b8c\u5168\u8bfb\u53d6\u4e86\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d41\uff0c Recv() \u65b9\u6cd5\u8fd4\u56de (nil,io.EOF) \u3002","title":"\u670d\u52a1\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_9","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u5305\u542b MsgA \u6d88\u606f\u7684\u6d41 ServiceName _FooClient \uff1a\u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u4e0b\u9762\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Send(*MsgA) error CloseAndRecv() (*MsgA, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u6d41\u5f00\u59cb\u3002\u5ba2\u6237\u7aef\u4f1a\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Send() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u53d1\u9001\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u8fd9\u4e2a\u6d41\u7684 CloseAndRecv() \u65b9\u6cd5 \u80fd\u4e14\u4ec5\u80fd\u8c03\u7528\u4e00\u6b21 \uff0c\u4ee5\u4fbf\u80fd\u591f\u5728\u5173\u95ed\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u6d41\u7684\u540c\u65f6\u63a5\u6536\u4ece\u670d\u52a1\u7aef\u8fd4\u56de\u7684\u5355\u4e2a\u54cd\u5e94\u6d88\u606f\u3002","title":"\u5ba2\u6237\u7aef\u4fa7\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_10","text":"\u8fd9\u4e9b\u65b9\u6cd5\u5728\u751f\u6210\u5ba2\u6237\u7aef stub \u65f6\u5177\u6709\u5982\u4e0b\u7b7e\u540d\uff1a Foo(ctx context.Context, opts ...grpc.CallOption) ( ServiceName _FooClient, error) \u5728\u8fd9\u4e2a\u4e0a\u4e0b\u6587\u4e2d\uff1a ServiceName _FooClient \uff1a\u4ee3\u8868\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\uff0c\u4e5f\u4ee3\u8868\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41 ServiceName _FooClient \u6709\u4e00\u4e2a\u5d4c\u5165\u7684 grpc.ClientStream \u548c\u5982\u4e0b\u7684\u63a5\u53e3\uff1a type ServiceName _FooClient interface { Send(*MsgA) error Recv() (*MsgB, error) grpc.ClientStream } \u5f53\u5ba2\u6237\u7aef\u5728 stub \u4e0a\u8c03\u7528 Foo \u65b9\u6cd5\u65f6\u6d41\u5f00\u59cb\u3002\u5ba2\u6237\u7aef\u53ef\u4ee5\u5728\u8fd4\u56de\u7684 ServiceName _FooClient \u4e0a\u91cd\u590d\u8c03\u7528 Send() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u53d1\u9001\u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u7684\u6d88\u606f\u6d41\u3002\u5ba2\u6237\u7aef\u4e5f\u53ef\u4ee5\u5728\u8fd9\u4e2a\u6d41\u4e0a\u91cd\u590d\u8c03\u7528 Recv() \u65b9\u6cd5\uff0c\u4ee5\u4fbf\u63a5\u6536\u4ece\u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u7684\u6d88\u606f\u6d41\u4e2d\u5168\u90e8\u6d88\u606f\u3002 \u670d\u52a1\u7aef\u5230\u5ba2\u6237\u7aef\u6d41\u7684\u7ed3\u675f\u7531\u6d41\u7684 Recv() \u65b9\u6cd5\u4e0a\u7684\u8fd4\u56de\u503c (nil,io.EOF) \u6307\u793a\u3002 \u4ece\u5ba2\u6237\u7aef\u5230\u670d\u52a1\u7aef\u6d41\u7684\u7ed3\u675f\u7531\u5ba2\u6237\u7aef\u901a\u8fc7\u5728\u6d41\u4e0a\u8c03\u7528 CloseSend() \u65b9\u6cd5\u6307\u793a\u3002","title":"\u53cc\u5411\u6d41\u6570\u636e\u65b9\u6cd5"},{"location":"Frameworks/gRPC/09-Go\u751f\u6210\u4ee3\u7801\u6307\u5357/#_11","text":"\u4f7f\u7528 --go_out=plugins=grpc: \u8c03\u7528 protoc \u7f16\u8bd1\u5668\u65f6\uff0c\u4ece proto \u5305\u5230 Go \u5305\u7684\u8f6c\u6362\u4e0e\u4f7f\u7528 protoc-gen-go \u63d2\u4ef6\u800c\u4e0d\u4f7f\u7528 grpc \u63d2\u4ef6\u7684\u5de5\u4f5c\u65b9\u5f0f\u76f8\u540c\u3002 \u56e0\u6b64\uff0c\u4f8b\u5982\uff0c\u5982\u679c foo.proto \u58f0\u660e\u81ea\u5df1\u5728\u5305 foo \u4e2d\uff0c\u90a3\u4e48\u751f\u6210\u7684 foo.pb.go \u6587\u4ef6\u4e5f\u5c06\u5728Go\u5305 foo \u4e2d\u3002","title":"\u5305\u548c\u547d\u540d\u7a7a\u95f4"},{"location":"IDE/VSCode/01-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u7684\u8bbe\u7f6e\u4e0e\u547d\u4ee4/","text":"\u6269\u5c55\u7a0b\u5e8f\u4e2d\u7684\u8bbe\u7f6e\u4e0e\u547d\u4ee4 \u53ef\u4ee5\u5728VSCode\u7684\u6269\u5c55\u7a0b\u5e8f\u4e2d\u67e5\u770b\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\u548c\u63cf\u8ff0\u3002 Ctrl+Shift+x \u6765\u6253\u5f00\u6269\u5c55\u7a0b\u5e8f\u7a97\u53e3 \u627e\u5230Go\u6269\u5c55\u7a0b\u5e8f\uff0c\u5355\u51fb\u6765\u6253\u5f00\u6269\u5c55\u7a0b\u5e8f\u7684\u7f16\u8f91\u5668 \u5355\u51fb Contributes \u6807\u7b7e\u9875 \u6eda\u52a8\u67e5\u770b \u5982\u679c\u9700\u8981\u4fee\u6539\u5176\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff1a \u5728\u7528\u6237\u9996\u9009\u9879( cmd+, \u6216\u8005 ctrl+, ) \u5728\u5de5\u4f5c\u7a7a\u95f4\u8bbe\u7f6e( .vscode/settings.json ) \u4e2d\u8fdb\u884c\u4fee\u6539\u3002 \u5982\u679c\u4e0d\u8fdb\u884c\u4fee\u6539\uff0c\u4e0d\u9700\u8981\u62f7\u8d1d\u8fd9\u4e9b\u53c2\u6570 \u3002 \u5411\u4e0b\u6eda\u52a8\u53ef\u4ee5\u770b\u5230\u4fdd\u62a4\u8be6\u7ec6\u63cf\u8ff0\u4fe1\u606f\u7684\u6240\u6709\u547d\u4ee4\u7684\u5217\u8868\u3002","title":"\u6269\u5c55\u7a0b\u5e8f\u4e2d\u7684\u8bbe\u7f6e\u4e0e\u547d\u4ee4"},{"location":"IDE/VSCode/01-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u7684\u8bbe\u7f6e\u4e0e\u547d\u4ee4/#_1","text":"\u53ef\u4ee5\u5728VSCode\u7684\u6269\u5c55\u7a0b\u5e8f\u4e2d\u67e5\u770b\u8bbe\u7f6e\u7684\u9ed8\u8ba4\u503c\u548c\u63cf\u8ff0\u3002 Ctrl+Shift+x \u6765\u6253\u5f00\u6269\u5c55\u7a0b\u5e8f\u7a97\u53e3 \u627e\u5230Go\u6269\u5c55\u7a0b\u5e8f\uff0c\u5355\u51fb\u6765\u6253\u5f00\u6269\u5c55\u7a0b\u5e8f\u7684\u7f16\u8f91\u5668 \u5355\u51fb Contributes \u6807\u7b7e\u9875 \u6eda\u52a8\u67e5\u770b \u5982\u679c\u9700\u8981\u4fee\u6539\u5176\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff1a \u5728\u7528\u6237\u9996\u9009\u9879( cmd+, \u6216\u8005 ctrl+, ) \u5728\u5de5\u4f5c\u7a7a\u95f4\u8bbe\u7f6e( .vscode/settings.json ) \u4e2d\u8fdb\u884c\u4fee\u6539\u3002 \u5982\u679c\u4e0d\u8fdb\u884c\u4fee\u6539\uff0c\u4e0d\u9700\u8981\u62f7\u8d1d\u8fd9\u4e9b\u53c2\u6570 \u3002 \u5411\u4e0b\u6eda\u52a8\u53ef\u4ee5\u770b\u5230\u4fdd\u62a4\u8be6\u7ec6\u63cf\u8ff0\u4fe1\u606f\u7684\u6240\u6709\u547d\u4ee4\u7684\u5217\u8868\u3002","title":"\u6269\u5c55\u7a0b\u5e8f\u4e2d\u7684\u8bbe\u7f6e\u4e0e\u547d\u4ee4"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/","text":"\u5728VSCode\u4e2d\u7f16\u8bd1\u3001\u8c03\u8bd5\u5e76\u5728\u4fa7\u8fb9\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f \u53ef\u4ee5\u5728\u6269\u5c55\u7a0b\u5e8f\u5f00\u53d1\u671f\u95f4\u8bbe\u7f6e\u7528\u4e8e\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u3002 \u7f16\u8bd1\u548c\u8c03\u8bd5\u6269\u5c55\u6210\u7a0b\u5e8f \u5b89\u88c5 node \u514b\u9686\u4ee3\u7801\u4ed3\u5e93 \u6267\u884c npm install \uff0c\u5e76\u6253\u5f00Code\u7684\u5f00\u53d1\u5b9e\u4f8b git clone https://github.com/Microsoft/vscode-go cd vscode-go npm install code . \u68c0\u67e5\u4e00\u4e0b window.openFileFoldersInNewWindow \u53c2\u6570\u662f\u5426\u8bbe\u7f6e\u4e3a no \u3002 \u7136\u540e\u70b9\u51fb\u8c03\u8bd5\u6309\u94ae( Ctrl+Shift+D )\u7136\u540e\u9009\u62e9 Lunch Extension \u7136\u540e\u6267\u884c( F5 )\u3002 \u5728\u539f\u6765\u7684VS Code\u7a97\u53e3\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u5728\u7b2c\u4e8c\u4e2a\u4ee3\u7801\u7a97\u4e2d\u4f7f\u7528\u7684\u4efb\u4f55\u6269\u5c55\u7a0b\u5e8f\u7684\u529f\u80fd\u65f6\u88ab\u547d\u4e2d\u7684\u65ad\u70b9\u3002 \u5982\u679c\u662f\u5728\u6269\u5c55\u540d\u4e3a .ts \u7684\u6587\u4ef6\u4e2d\u8fdb\u884c\u7f16\u8f91\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u52a0\u8f7d(cmd-r) \u4ee3\u7801\u7684[ Extension Development Host ]\u5b9e\u4f8b\uff0c\u4ee5\u52a0\u8f7d\u65b0\u7684\u6269\u5c55\u7a0b\u5e8f\u4ee3\u7801\u3002\u5904\u4e8e\u8c03\u8bd5\u4e2d\u7684\u5b9e\u4f8b\u5c06\u4f1a\u81ea\u52a8\u7684\u91cd\u65b0\u9644\u52a0\u3002 \u5982\u679c\u8981\u8c03\u8bd5\u8c03\u8bd5\u5668\uff0c\u8bf7\u67e5\u770b\u8c03\u8bd5\u5668\u7684 \u63cf\u8ff0\u6587\u6863 \u3002 \u8fd0\u884c\u6d4b\u8bd5 \u8981\u8fd0\u884c\u672c\u5730\u6d4b\u8bd5\uff0c\u53ea\u9700\u8981\u6253\u5f00( Ctrl+Shift+D )\u8c03\u8bd5\u5668\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9 Lanuch Tests ,\u7136\u540e\u6267\u884c( F5 )\u3002 \u5728\u4fa7\u680f\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f \u5728\u4fee\u6539\u7a0b\u5e8f\u540e\uff0c\u901a\u5e38\u60f3\u8981\u8fdb\u884c\u7aef\u5230\u7aef\u7684\u6d4b\u8bd5\u800c\u4e0d\u662f\u5728\u8c03\u8bd5\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5b83\u3002\u4e3a\u6b64\u53ef\u4ee5\u5728\u4fa7\u680f\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u51c6\u5907\u6269\u5c55\u7a0b\u5e8f\u5e76\u76f4\u63a5\u52a0\u8f7d\u6765\u5b8c\u6210\u3002 \u6267\u884c npm install -g vscode \u547d\u4ee4\u6765\u68c0\u67e5\u662f\u5426\u5728\u5168\u5c40\u8303\u56f4\u5185\u5b89\u88c5\u4e86 vsce \u6267\u884c git clone https://github.com/Microsoft/vscode-go \u6765\u514b\u9686\u6574\u4e2a\u4ed3\u5e93 \u8fdb\u5165 vs-code \u76ee\u5f55 \u6267\u884c npm install \u6765\u5b89\u88c5\u4f9d\u8d56 \u6267\u884c vsce package \u547d\u4ee4\u6765\u7f16\u8bd1\u6574\u4e2a\u5305\uff0c\u8fd9\u5c06\u4f1a\u751f\u6210\u6269\u5c55\u540d\u4e3a vsix \u7684\u6587\u4ef6 \u6267\u884c Extensions: Install from VSIX... \u547d\u4ee4\uff0c\u5e76\u9009\u62e9\u4e0a\u4e00\u6b65\u751f\u4ea7\u7684\u90a3\u4e2a\u6587\u4ef6 \u4f7f\u7528\u6269\u5c55\u7a0b\u5e8f\u7684\u6d4b\u8bd5\u7248 \u5982\u679c\u60f3\u8981\u5e2e\u52a9\u6d4b\u8bd5\u4e0b\u4e00\u4e2a\u65b0\u7248\u672c\uff0c\u6216\u8005\u4f7f\u7528\u5c1a\u672a\u53d1\u5e03\u7684\u65b0\u529f\u80fd\uff0c\u8bf7\u67e5\u9605 \u4f7f\u7528Go\u6269\u5c55\u7a0b\u5e8f\u6d4b\u8bd5\u7248\u6587\u6863 \u3002","title":"\u5728VSCode\u4e2d\u7f16\u8bd1\u3001\u8c03\u8bd5\u5e76\u5728\u4fa7\u8fb9\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/#vscode","text":"\u53ef\u4ee5\u5728\u6269\u5c55\u7a0b\u5e8f\u5f00\u53d1\u671f\u95f4\u8bbe\u7f6e\u7528\u4e8e\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f\u7684\u5f00\u53d1\u73af\u5883\u3002","title":"\u5728VSCode\u4e2d\u7f16\u8bd1\u3001\u8c03\u8bd5\u5e76\u5728\u4fa7\u8fb9\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/#_1","text":"\u5b89\u88c5 node \u514b\u9686\u4ee3\u7801\u4ed3\u5e93 \u6267\u884c npm install \uff0c\u5e76\u6253\u5f00Code\u7684\u5f00\u53d1\u5b9e\u4f8b git clone https://github.com/Microsoft/vscode-go cd vscode-go npm install code . \u68c0\u67e5\u4e00\u4e0b window.openFileFoldersInNewWindow \u53c2\u6570\u662f\u5426\u8bbe\u7f6e\u4e3a no \u3002 \u7136\u540e\u70b9\u51fb\u8c03\u8bd5\u6309\u94ae( Ctrl+Shift+D )\u7136\u540e\u9009\u62e9 Lunch Extension \u7136\u540e\u6267\u884c( F5 )\u3002 \u5728\u539f\u6765\u7684VS Code\u7a97\u53e3\u4e2d\u53ef\u4ee5\u6dfb\u52a0\u5728\u7b2c\u4e8c\u4e2a\u4ee3\u7801\u7a97\u4e2d\u4f7f\u7528\u7684\u4efb\u4f55\u6269\u5c55\u7a0b\u5e8f\u7684\u529f\u80fd\u65f6\u88ab\u547d\u4e2d\u7684\u65ad\u70b9\u3002 \u5982\u679c\u662f\u5728\u6269\u5c55\u540d\u4e3a .ts \u7684\u6587\u4ef6\u4e2d\u8fdb\u884c\u7f16\u8f91\uff0c\u53ea\u9700\u8981\u91cd\u65b0\u52a0\u8f7d(cmd-r) \u4ee3\u7801\u7684[ Extension Development Host ]\u5b9e\u4f8b\uff0c\u4ee5\u52a0\u8f7d\u65b0\u7684\u6269\u5c55\u7a0b\u5e8f\u4ee3\u7801\u3002\u5904\u4e8e\u8c03\u8bd5\u4e2d\u7684\u5b9e\u4f8b\u5c06\u4f1a\u81ea\u52a8\u7684\u91cd\u65b0\u9644\u52a0\u3002 \u5982\u679c\u8981\u8c03\u8bd5\u8c03\u8bd5\u5668\uff0c\u8bf7\u67e5\u770b\u8c03\u8bd5\u5668\u7684 \u63cf\u8ff0\u6587\u6863 \u3002","title":"\u7f16\u8bd1\u548c\u8c03\u8bd5\u6269\u5c55\u6210\u7a0b\u5e8f"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/#_2","text":"\u8981\u8fd0\u884c\u672c\u5730\u6d4b\u8bd5\uff0c\u53ea\u9700\u8981\u6253\u5f00( Ctrl+Shift+D )\u8c03\u8bd5\u5668\u754c\u9762\uff0c\u7136\u540e\u9009\u62e9 Lanuch Tests ,\u7136\u540e\u6267\u884c( F5 )\u3002","title":"\u8fd0\u884c\u6d4b\u8bd5"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/#_3","text":"\u5728\u4fee\u6539\u7a0b\u5e8f\u540e\uff0c\u901a\u5e38\u60f3\u8981\u8fdb\u884c\u7aef\u5230\u7aef\u7684\u6d4b\u8bd5\u800c\u4e0d\u662f\u5728\u8c03\u8bd5\u6a21\u5f0f\u4e0b\u8fd0\u884c\u5b83\u3002\u4e3a\u6b64\u53ef\u4ee5\u5728\u4fa7\u680f\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u51c6\u5907\u6269\u5c55\u7a0b\u5e8f\u5e76\u76f4\u63a5\u52a0\u8f7d\u6765\u5b8c\u6210\u3002 \u6267\u884c npm install -g vscode \u547d\u4ee4\u6765\u68c0\u67e5\u662f\u5426\u5728\u5168\u5c40\u8303\u56f4\u5185\u5b89\u88c5\u4e86 vsce \u6267\u884c git clone https://github.com/Microsoft/vscode-go \u6765\u514b\u9686\u6574\u4e2a\u4ed3\u5e93 \u8fdb\u5165 vs-code \u76ee\u5f55 \u6267\u884c npm install \u6765\u5b89\u88c5\u4f9d\u8d56 \u6267\u884c vsce package \u547d\u4ee4\u6765\u7f16\u8bd1\u6574\u4e2a\u5305\uff0c\u8fd9\u5c06\u4f1a\u751f\u6210\u6269\u5c55\u540d\u4e3a vsix \u7684\u6587\u4ef6 \u6267\u884c Extensions: Install from VSIX... \u547d\u4ee4\uff0c\u5e76\u9009\u62e9\u4e0a\u4e00\u6b65\u751f\u4ea7\u7684\u90a3\u4e2a\u6587\u4ef6","title":"\u5728\u4fa7\u680f\u52a0\u8f7d\u6269\u5c55\u7a0b\u5e8f"},{"location":"IDE/VSCode/02-\u7f16\u8bd1\u8c03\u8bd5\u6269\u5c55\u7a0b\u5e8f/#_4","text":"\u5982\u679c\u60f3\u8981\u5e2e\u52a9\u6d4b\u8bd5\u4e0b\u4e00\u4e2a\u65b0\u7248\u672c\uff0c\u6216\u8005\u4f7f\u7528\u5c1a\u672a\u53d1\u5e03\u7684\u65b0\u529f\u80fd\uff0c\u8bf7\u67e5\u9605 \u4f7f\u7528Go\u6269\u5c55\u7a0b\u5e8f\u6d4b\u8bd5\u7248\u6587\u6863 \u3002","title":"\u4f7f\u7528\u6269\u5c55\u7a0b\u5e8f\u7684\u6d4b\u8bd5\u7248"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/","text":"\u4f7f\u7528 VSCode \u8c03\u8bd5Go\u8bed\u8a00 \u5b89\u88c5 delve \u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b89\u88c5 delve : \u6267\u884c\u6307\u4ee4 Go: Install/Update Tools \uff0c\u7136\u540e\u9009\u62e9 dlv ,\u70b9\u51fb ok \u6765\u5b89\u88c5\u6216\u8005\u66f4\u65b0 delve \u53c2\u7167 \u5b89\u88c5\u6307\u5357 \u624b\u52a8\u5b89\u88c5 \u5728 settings \u4e2d\u8fdb\u884c\u8bbe\u7f6e \u8c03\u8bd5\u5668\u4f7f\u7528\u4ee5\u4e0b\u7684\u8bbe\u7f6e\u9879\uff0c\u4f60\u53ef\u80fd\u4e0d\u9700\u8981\u6dfb\u52a0/\u66f4\u6539\u5b83\u4eec\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff0c\u4ee5\u4fbf\u5728\u7b80\u5355\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8c03\u8bd5\uff0c\u4f46\u6709\u65f6\u4f1a\u7ed9\u5b83\u4eec\u8bfb\u53d6\u4e00\u4e9b\u914d\u7f6e\uff1a go.gopath \uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e GOPATH go.inferGopath \uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e GOPATH go.delveConfig \uff1a apiVersion \uff1a\u63a7\u5236\u5c06\u8981\u5728\u65e0\u5934\u670d\u52a1\u4e2d\u88ab\u4f7f\u7528\u7684 delve apis \u7684\u7248\u672c\uff0c\u9ed8\u8ba4\u503c\u4e3a2\u3002 dlvLoadConfig \uff1a\u5f53 apiVersion \u4e3a1\u65f6\u4e0d\u9002\u7528\u3002\u8fd9\u4e2a\u914d\u7f6e\u4f1a\u4f20\u9012\u7ed9 delve \u3002\u63a7\u5236 delve \u7684 \u5404\u79cd\u529f\u80fd \uff0c\u8fd9\u4e9b\u529f\u80fd\u4f1a\u5f71\u54cd\u8c03\u8bd5\u7a97\u683c\u4e2d\u663e\u793a\u7684\u53d8\u91cf\u3002 maxStringLen \uff1a\u4ece\u5b57\u7b26\u4e32\u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5b57\u8282\u6570 maxArrayValues \uff1a\u4ece\u6570\u7ec4\uff0c\u5207\u7247\u6216 map \u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5143\u7d20\u6570 maxStructFields \uff1a\u4ece\u7ed3\u6784\u4f53\u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5b57\u6bb5\u6570\uff0c -1 \u8868\u793a\u5c06\u8bfb\u53d6\u6240\u6709\u5b57\u6bb5 maxVariableRecurse \uff1a\u8bc4\u4f30\u5d4c\u5957\u7c7b\u578b\u65f6\u9012\u5f52\u7684\u7a0b\u5ea6 followPointers \uff1a\u8bf7\u6c42\u6307\u9488\u81ea\u52a8\u89e3\u9664\u5f15\u7528 \u4e00\u4e9b\u5e38\u89c1\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u60f3\u8981\u8c03\u6574\u4f20\u9012\u7ed9delve\u7684\u914d\u7f6e\uff1a \u5728\u8c03\u8bd5\u6a21\u5f0f\u4e2d\u67e5\u770b\u53d8\u91cf\u65f6\uff0c\u66f4\u6539\u5b57\u7b26\u4e32\u548c\u6570\u7ec4\u957f\u5ea6\u7684\u9ed8\u8ba4\u4e0a\u965064\u3002 \u5728\u8c03\u8bd5\u6a21\u5f0f\u4e2d\u68c0\u67e5\u548c\u8bc4\u4f30\u5d4c\u5957\u7684\u53d8\u91cf\u3002 \u5728 launch.json \u4e2d\u8bbe\u7f6e\u914d\u7f6e\u9879 \u5b89\u88c5 delve \u540e\uff0c\u8fd0\u884c\u547d\u4ee4 Debug\uff1aOpen launch.json \u3002\u5982\u679c\u8fd8\u6ca1\u6709 launch.json \u6587\u4ef6\uff0c\u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u4ee5\u4e0b\u9ed8\u8ba4\u914d\u7f6e\u7684\u6587\u4ef6\uff0c\u8be5\u914d\u7f6e\u53ef\u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u5305\u3002 { version : 0.2.0 , configurations : [ { name : Launch , type : go , request : launch , mode : auto , program : ${fileDirname} , env : {}, args : [] } ] } \u4ee5\u4e0b\u662f\u53ef\u4ee5\u5728\u8c03\u8bd5\u914d\u7f6e\u4e2d\u8c03\u6574\u7684\u4e00\u4e9b\u5e38\u89c1\u5c5e\u6027\u7684\u66f4\u591a\u4fe1\u606f\uff1a \u5c5e\u6027 \u63cf\u8ff0 name Debug\u89c6\u56fe\u4e0b\u62c9\u5217\u8868\u4e2d\u663e\u793a\u7684\u914d\u7f6e\u7684\u540d\u79f0 type \u59cb\u7ec8\u8bbe\u7f6e\u4e3a \u201cgo\u201d \uff0cVS Code\u4f7f\u7528\u5b83\u6765\u786e\u5b9a\u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u6269\u5c55\u7a0b\u5e8f\u6765\u8c03\u8bd5\u4ee3\u7801 request launch \u6216\u8005 attach \uff0c\u4f7f\u7528 attach \u5f53\u9700\u8981\u9644\u52a0\u5230\u4e00\u4e2a\u5df2\u7ecf\u5728\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f mode \u5bf9\u4e8e\u4e0a\u4e2a\u5c5e\u6027\u4e2d\u7684 launch \uff0c\u53ef\u9009\u62e9 auto , debug , remote , test , exec \uff1b\u5bf9\u4e8e\u4e0a\u4e2a\u5c5e\u6027\u4e2d\u7684 attach \uff0c\u53ef\u9009\u62e9 local \uff0c remote program \u5728 debug \u548c test \u6a21\u5f0f\u4e0b\uff0c\u6307\u5b9a\u8981\u8c03\u8bd5\u7684\u5305\u6216\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u6216\u8005\u5728 exec \u6a21\u5f0f\u4e0b\u8c03\u8bd5\u7684\u9884\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff1b\u4e0d\u9002\u7528\u4e8e attach env \u8c03\u8bd5\u65f6\u8981\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5982 { \"ENVNAME\": \"ENVVALUE\" } envFile \u5305\u542b\u73af\u5883\u53d8\u91cf\u5b9a\u4e49\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c env \u5c5e\u6027\u4e2d\u4f20\u9012\u7684\u73af\u5883\u53d8\u91cf\u4f1a\u8986\u76d6\u6b64\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf args \u5c06\u4f20\u9012\u7ed9\u6b63\u5728\u8c03\u8bd5\u7684\u7a0b\u5e8f\u7684\u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4 showLogs \u5e03\u5c14\u503c\uff0c\u6307\u793a\u662f\u5426\u5e94\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u6253\u5370\u6765\u81ea delve \u7684\u65e5\u5fd7 logOutput \u4ee5\u9017\u53f7\u5206\u9694\u7684 delve \u7ec4\u4ef6\u5217\u8868\uff08 debugger \uff0c gdbwire \uff0c lldbout \uff0c debuglineerr \uff0c rpc \uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\u5e94\u751f\u6210\u8c03\u8bd5\u8f93\u51fa buildFlags \u8981\u4f20\u9012\u7ed9Go\u7f16\u8bd1\u5668\u7684\u6784\u5efa( build )\u6807\u5fd7 remotePath \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u6b63\u5728\u8c03\u8bd5\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5373 mode \u8bbe\u7f6e\u4e3a remote \u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c \u8fdc\u7a0b\u8c03\u8bd5 \u201d\u4e00\u8282 processeid \u4ec5\u5728\u4f7f\u7528 local mode\u7684 attach request\u65f6\u9002\u7528\uff0c\u8fd9\u662f\u8fd0\u884c\u9700\u8981\u8c03\u8bd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8fdb\u7a0b\u7684id \u5728\u8c03\u8bd5\u8bbe\u7f6e\u4e2d\u4f7f\u7528 VSCode \u53d8\u91cf \u8c03\u8bd5\u914d\u7f6e\u4e2d\u91c7\u7528\u6587\u4ef6\u5939/\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u5c5e\u6027\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b VSCode \u53d8\u91cf\uff1a ${workspaceFolder} \uff1a\u8c03\u8bd5\u5728 VSCode \u4e2d\u6253\u5f00\u7684\u5de5\u4f5c\u7a7a\u95f4\u7684\u6839\u76ee\u5f55\u4e0b\u7684\u7a0b\u5e8f\u5305 ${file} \uff1a\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6 ${fileDirname} \uff1a\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6\u6240\u5c5e\u7684\u5305 \u4f7f\u7528\u6784\u5efa\u6807\u7b7e \u5982\u679c\u6784\u5efa\u65f6\u9700\u8981\u6784\u5efa\u6807\u8bb0\uff08\u4f8b\u5982 go build -tags=whatever_tag \uff09\uff0c\u90a3\u4e48\u6dfb\u52a0\u53c2\u6570 buildFlags \uff0c\u5185\u5bb9\u4e3a\u201c -tags=whatever_tag \u201d\u3002 \u652f\u6301\u591a\u4e2a\u6807\u8bb0\uff0c\u5c06\u5b83\u4eec\u7528\u53cc\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u201c-tags='first_tag second_tag third_tag'\u201d \u3002 \u8c03\u8bd5\u914d\u7f6e\u7684\u4ee3\u7801\u6bb5 \u7f16\u8f91 launch.json \u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee3\u7801\u6bb5\u8fdb\u884c\u8c03\u8bd5\u914d\u7f6e\u3002\u8f93\u5165 \u201cGo\u201d \uff0c\u5c06\u83b7\u5f97\u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6/\u5305\uff0c\u6d4b\u8bd5\u529f\u80fd\u7b49\u7684\u7247\u6bb5\u3002 \u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6\u7684\u793a\u4f8b\u914d\u7f6e { name : Launch file , type : go , request : launch , mode : auto , program : ${file} } \u7528\u4e8e\u8c03\u8bd5\u5355\u4e2a\u6d4b\u8bd5\u7684\u793a\u4f8b\u914d\u7f6e { name : Launch test function , type : go , request : launch , mode : test , program : ${workspaceFolder} , args : [ -test.run , MyTestFunction ] } \u7528\u4e8e\u8c03\u8bd5\u5305\u4e2d\u6240\u6709\u6d4b\u8bd5\u7684\u793a\u4f8b\u914d\u7f6e { name : Launch test package , type : go , request : launch , mode : test , program : ${workspaceFolder} } \u7528\u4e8e\u8c03\u8bd5\u9884\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u793a\u4f8b\u914d\u7f6e { name : Launch executable , type : go , request : launch , mode : exec , program : absolute-path-to-the-executable } \u4f7f\u7528 processId \u9644\u52a0\u5230\u5df2\u5728\u8fd0\u884c\u7684\u672c\u5730\u8fdb\u7a0b\u7684\u793a\u4f8b\u914d\u7f6e { name : Attach to local process , type : go , request : attach , mode : local , processId : 0 } \u8fdc\u7a0b\u8c03\u8bd5 \u8981\u4f7f\u7528 VSCode \u8fdb\u884c\u8fdc\u7a0b\u8c03\u8bd5\uff0c\u5fc5\u987b\u9996\u5148\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u65e0\u5934\u7684 Delve \u670d\u52a1\u5668\u3002\u4f8b\u5982\uff1a dlv debug --headless --listen=:2345 --log --api-version=2 \u8981\u4f20\u9012\u7ed9\u6b63\u5728\u8c03\u8bd5\u7684\u7a0b\u5e8f\u7684\u4efb\u4f55\u53c2\u6570\u90fd\u5fc5\u987b\u4f20\u9012\u7ed9\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u7684 Delve \u670d\u52a1\u5668\u3002\u4f8b\u5982\uff1a dlv debug --headless --listen=:2345 --log -- -myArg=123 \u7136\u540e\uff0c\u5728VS Code launch.json \u4e2d\u521b\u5efa\u8fdc\u7a0b\u8c03\u8bd5\u914d\u7f6e\u3002 { name : Launch remote , type : go , request : launch , mode : remote , remotePath : absolute-path-to-the-file-being-debugged-on-the-remote-machine , port : 2345, host : 127.0.0.1 , program : absolute-path-to-the-file-on-the-local-machine , env : {} } \u4e0a\u9762\u7684\u793a\u4f8b\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u672c\u5730\u8fd0\u884c\u65e0\u5934 dlv \u670d\u52a1\u5668\u548cVScode\u8c03\u8bd5\u5668\u3002\u6839\u636e\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u7684\u8bbe\u7f6e\u66f4\u65b0 \u7aef\u53e3 \u548c \u4e3b\u673a \u3002 remotePath \u5e94\u6307\u5411\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e2d\u6b63\u5728\u8c03\u8bd5\u7684\u6587\u4ef6\uff08\u5728\u6e90\u4ee3\u7801\u4e2d\uff09\u7684\u7edd\u5bf9\u8def\u5f84 program \u5e94\u6307\u5411\u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u4e0e remotePath \u4e2d\u5bf9\u5e94\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84 \u5f53\u9009\u62e9\u6b64\u65b0\u7684 Launch remote \u76ee\u6807\u542f\u52a8\u8c03\u8bd5\u5668\u65f6\uff0c VS Code \u4f1a\u5c06\u8c03\u8bd5\u547d\u4ee4\u53d1\u9001\u5230\u4e4b\u524d\u542f\u52a8\u7684 dlv \u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u9488\u5bf9\u5e94\u7528\u542f\u52a8\u5b83\u81ea\u5df1\u7684 dlv \u5b9e\u4f8b\u3002 \u8bf7\u53c2\u9605 https://github.com/lukehoban/webapp-go/tree/debugging \u4e2d\u8c03\u8bd5\u5728docker\u4e3b\u673a\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u7684\u793a\u4f8b\u3002 \u6545\u969c\u6392\u9664 \u5982\u679c\u5728\u8c03\u8bd5Go\u4ee3\u7801\u65f6\u9047\u5230\u95ee\u9898\uff0c\u8bf7\u9996\u5148\u5c1d\u8bd5\u66f4\u65b0\u7684 delve \u7248\u672c\uff0c\u4ee5\u786e\u4fdd\u4f7f\u7528\u7684\u662f\u6700\u65b0\u7248\u672c\uff0c\u5e76\u4e14\u5df2\u4f7f\u7528\u5f53\u524d\u7684Go\u7248\u672c\u8fdb\u884c\u7f16\u8bd1\u3002\u8981\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u8bf7\u8fd0\u884c\u547d\u4ee4 Go\uff1aInstall/Update Tools \uff0c\u9009\u62e9 dlv \uff0c\u7136\u540e\u70b9\u51fb ok \u3002 \u542f\u52a8\u8c03\u8bd5\u65e5\u5fd7 \u5c06\u8c03\u8bd5\u914d\u7f6e\u4e2d\u7684 showLog \u5c5e\u6027\u8bbe\u7f6e\u4e3a true \u3002\u5c06\u4ece delve \u4e2d\u770b\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u7684\u65e5\u5fd7\u3002 \u5728\u8c03\u8bd5\u914d\u7f6e\u4e2d\u8bbe\u7f6e trace \u5c5e\u6027\u4ee5\u8fdb\u884c\u8bb0\u5f55\u3002\u5c06\u4eceGo\u6269\u5c55\u7a0b\u5e8f\u7684\u8c03\u8bd5\u9002\u914d\u5668\u4e2d\u770b\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u7684\u65e5\u5fd7\u3002\u8fd9\u4e9b\u65e5\u5fd7\u5c06\u4fdd\u5b58\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u7684\u8def\u5f84\u5c06\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u7684\u5f00\u5934\u6253\u5370\u3002 \u5c06\u8c03\u8bd5\u914d\u7f6e\u4e2d\u7684 logOutput \u5c5e\u6027\u8bbe\u7f6e\u4e3a rpc \u3002\u5c06\u770b\u5230\u5bf9\u5e94\u4e8e\u5728 VS Code \u548c delve \u4e4b\u95f4\u6765\u56de\u4f20\u9012\u7684 RPC \u6d88\u606f\u7684\u65e5\u5fd7\u3002\u8bf7\u6ce8\u610f\uff0c\u9996\u5148\u9700\u8981\u5c06 showLog \u8bbe\u7f6e\u4e3a true \u3002 logOutput \u5c5e\u6027\u5bf9\u5e94\u4e8e delve \u4f7f\u7528\u7684 --log-output \u6807\u5fd7\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u9017\u53f7\u5206\u9694\u7684\u7ec4\u4ef6\u5217\u8868\uff0c\u5b83\u5e94\u8be5\u751f\u6210\u8c03\u8bd5\u8f93\u51fa\u3002 \u4f7f\u7528\u6e90\u4ee3\u7801\u8c03\u8bd5\u8c03\u8bd5\u5668 \u5982\u679c\u60f3\u6df1\u5165\u6316\u6398\u5e76\u4f7f\u7528\u6b64\u6269\u5c55\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\u8c03\u8bd5\u8c03\u8bd5\u5668\uff0c\u8bf7\u53c2\u9605 build-and-debugging-the-extension \u3002 \u5e38\u89c1\u95ee\u9898 \u8c03\u8bd5\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u672a\u9a8c\u8bc1\u65ad\u70b9\u6216\u53d8\u91cf \u786e\u4fdd\u6b63\u5728\u8c03\u8bd5\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u662f\u5728\u6ca1\u6709\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u6784\u5efa\u7684\u3002\u5728\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u4f7f\u7528\u6807\u5fd7 -gcflags=\"all = -N -l\" \u3002 Cannot find package \"..\" in any of ... \u8c03\u8bd5\u5668\u6ca1\u6709\u4f7f\u7528\u6b63\u786e\u7684 GOPATH \u3002\u8fd9\u4e0d\u5e94\u8be5\u53d1\u751f\uff0c\u5982\u679c\u786e\u5b9e\u5982\u6b64\uff0c\u8bf7\u8bb0\u5f55\u4e00\u4e2a\u9519\u8bef\u3002 \u5728\u8bb0\u5f55\u7684\u9519\u8bef\u88ab\u89e3\u51b3\u4e4b\u524d\uff0c\u89e3\u51b3\u65b9\u6cd5\u662f\u5728 launch.json \u6587\u4ef6\u7684 env \u5c5e\u6027\u4e2d\u5c06 GOPATH \u6dfb\u52a0\u4e3a env var \u3002 Failed to continue: \"Error: spawn EACCES\" dlv \u4ece\u547d\u4ee4\u884c\u8fd0\u884c\u5f97\u5f88\u597d\uff0c\u4f46 VS Code \u63d0\u4f9b\u6b64\u8bbf\u95ee\u76f8\u5173\u7684\u9519\u8bef\u3002\u5982\u679c\u6269\u5c55\u7a0b\u5e8f\u8bd5\u56fe\u4ece\u9519\u8bef\u7684\u4f4d\u7f6e\u8fd0\u884c dlv \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5219\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002Go\u6269\u5c55\u9996\u5148\u5c1d\u8bd5\u5728 $GOPATH/bin \u4e2d\u627e\u5230 dlv \uff0c\u7136\u540e\u5728 $PATH \u4e2d\u627e\u5230\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c dlv \u3002\u5982\u679c\u8fd9\u4e0e GOPATH/bin \u4e0d\u5339\u914d\uff0c\u5219\u5220\u9664 GOPATH/bin \u4e2d\u7684 dlv \u6587\u4ef6 could not launch process: stat ***/debug.test: no such file or directory \u53ef\u4ee5\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u770b\u5230\u6b64\u4fe1\u606f\uff0c\u540c\u65f6\u5c1d\u8bd5\u5728\u6d4b\u8bd5\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002\u5f53\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u6ca1\u6709\u6d4b\u8bd5\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u65f6\uff0c\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u786e\u4fdd\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u5305\u542b\u8981\u8fd0\u884c\u7684\u6d4b\u8bd5\u6587\u4ef6\u7684\u6587\u4ef6\u5939 could not launch process: could not fork/exec OSX \u7531\u4e8e\u7b7e\u540d\u95ee\u9898\uff0c\u8fd9\u901a\u5e38\u53d1\u751f\u5728OSX\u4e2d\u3002\u8bf7\u53c2\u9605\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 \uff03717 \uff0c \uff03269 \u548c derekparker/delve/357 \u89e3\u51b3\u65b9\u6848\uff1a\u53ef\u80fd\u5fc5\u987b\u5378\u8f7d dlv \u5e76\u6309\u7167 \u8bf4\u660e \u624b\u52a8\u5b89\u88c5\u5b83 Linux/Docker Docker\u5177\u6709\u5b89\u5168\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u5728\u5bb9\u5668\u5185\u9ed8\u8ba4\u963b\u6b62 ptrace(2) \u64cd\u4f5c\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u8981\u4e0d\u5b89\u5168\u5730\u8fd0\u884c\u5bb9\u5668\uff0c\u8bf7\u5728\u542f\u52a8\u65f6\u5c06 --security-opt=seccomp:unconfined \u4f20\u9012\u7ed9 docker \u3002\u53c2\u8003\uff1a derekparker/delve/515 could not launch process: exec: \"lldb-server\": executable file not found in $PATH \u5bf9\u4e8e\u4f7f\u7528\u7248\u672c 0.12.2 \u6216\u66f4\u9ad8\u7248\u672c\u7684\u7248\u672c\u7684 Mac \u7528\u6237\uff0c\u6b64\u9519\u8bef\u53ef\u80fd\u4f1a\u663e\u793a\u3002\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u4f46\u662f\u505a xcode-select --install \u5df2\u7ecf\u89e3\u51b3\u4e86\u770b\u5230\u8fd9\u4e2a\u95ee\u9898\u7684\u7528\u6237\u7684\u95ee\u9898\u3002 \u8fdc\u7a0b\u8c03\u8bd5\u672a\u9a8c\u8bc1\u7684\u65ad\u70b9 \u68c0\u67e5 remote delve process \u4f7f\u7528\u7684 delve api \u7684\u7248\u672c\uff0c\u5373\u68c0\u67e5\u6807\u5fd7 -api-version \u7684\u503c\u3002\u8fd9\u9700\u8981\u5339\u914dGo\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684\u7248\u672c\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f7f\u7528\u7248\u672c2\u3002\u53ef\u4ee5\u901a\u8fc7\u7f16\u8f91 launch.json \u6587\u4ef6\u4e2d\u7684\u8c03\u8bd5\u914d\u7f6e\u6765\u66f4\u6539\u6269\u5c55\u4f7f\u7528\u7684 api \u7248\u672c\u3002 \u5c1d\u8bd5\u4f7f\u7528\u7ec8\u7aef/\u547d\u4ee4\u884c\u4e2d\u7684 dlv \u5c06 \"trace\"\uff1a\"log\" \u6dfb\u52a0\u5230\u8c03\u8bd5\u914d\u7f6e\u5e76\u5728 VS Code \u4e2d\u8c03\u8bd5\u3002\u8fd9\u4f1a\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u67e5\u770b\u5bf9 dlv \u7684\u5b9e\u9645\u8c03\u7528\u3002\u53ef\u4ee5\u590d\u5236\u5e76\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u5b83","title":"\u4f7f\u7528`VSCode`\u8c03\u8bd5Go\u8bed\u8a00"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#vscodego","text":"","title":"\u4f7f\u7528VSCode\u8c03\u8bd5Go\u8bed\u8a00"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#delve","text":"\u6709\u4e24\u79cd\u65b9\u6cd5\u53ef\u4ee5\u5b89\u88c5 delve : \u6267\u884c\u6307\u4ee4 Go: Install/Update Tools \uff0c\u7136\u540e\u9009\u62e9 dlv ,\u70b9\u51fb ok \u6765\u5b89\u88c5\u6216\u8005\u66f4\u65b0 delve \u53c2\u7167 \u5b89\u88c5\u6307\u5357 \u624b\u52a8\u5b89\u88c5","title":"\u5b89\u88c5delve"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#settings","text":"\u8c03\u8bd5\u5668\u4f7f\u7528\u4ee5\u4e0b\u7684\u8bbe\u7f6e\u9879\uff0c\u4f60\u53ef\u80fd\u4e0d\u9700\u8981\u6dfb\u52a0/\u66f4\u6539\u5b83\u4eec\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\uff0c\u4ee5\u4fbf\u5728\u7b80\u5355\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u8c03\u8bd5\uff0c\u4f46\u6709\u65f6\u4f1a\u7ed9\u5b83\u4eec\u8bfb\u53d6\u4e00\u4e9b\u914d\u7f6e\uff1a go.gopath \uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e GOPATH go.inferGopath \uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e GOPATH go.delveConfig \uff1a apiVersion \uff1a\u63a7\u5236\u5c06\u8981\u5728\u65e0\u5934\u670d\u52a1\u4e2d\u88ab\u4f7f\u7528\u7684 delve apis \u7684\u7248\u672c\uff0c\u9ed8\u8ba4\u503c\u4e3a2\u3002 dlvLoadConfig \uff1a\u5f53 apiVersion \u4e3a1\u65f6\u4e0d\u9002\u7528\u3002\u8fd9\u4e2a\u914d\u7f6e\u4f1a\u4f20\u9012\u7ed9 delve \u3002\u63a7\u5236 delve \u7684 \u5404\u79cd\u529f\u80fd \uff0c\u8fd9\u4e9b\u529f\u80fd\u4f1a\u5f71\u54cd\u8c03\u8bd5\u7a97\u683c\u4e2d\u663e\u793a\u7684\u53d8\u91cf\u3002 maxStringLen \uff1a\u4ece\u5b57\u7b26\u4e32\u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5b57\u8282\u6570 maxArrayValues \uff1a\u4ece\u6570\u7ec4\uff0c\u5207\u7247\u6216 map \u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5143\u7d20\u6570 maxStructFields \uff1a\u4ece\u7ed3\u6784\u4f53\u4e2d\u8bfb\u53d6\u7684\u6700\u5927\u5b57\u6bb5\u6570\uff0c -1 \u8868\u793a\u5c06\u8bfb\u53d6\u6240\u6709\u5b57\u6bb5 maxVariableRecurse \uff1a\u8bc4\u4f30\u5d4c\u5957\u7c7b\u578b\u65f6\u9012\u5f52\u7684\u7a0b\u5ea6 followPointers \uff1a\u8bf7\u6c42\u6307\u9488\u81ea\u52a8\u89e3\u9664\u5f15\u7528 \u4e00\u4e9b\u5e38\u89c1\u7684\u60c5\u51b5\uff0c\u53ef\u80fd\u60f3\u8981\u8c03\u6574\u4f20\u9012\u7ed9delve\u7684\u914d\u7f6e\uff1a \u5728\u8c03\u8bd5\u6a21\u5f0f\u4e2d\u67e5\u770b\u53d8\u91cf\u65f6\uff0c\u66f4\u6539\u5b57\u7b26\u4e32\u548c\u6570\u7ec4\u957f\u5ea6\u7684\u9ed8\u8ba4\u4e0a\u965064\u3002 \u5728\u8c03\u8bd5\u6a21\u5f0f\u4e2d\u68c0\u67e5\u548c\u8bc4\u4f30\u5d4c\u5957\u7684\u53d8\u91cf\u3002","title":"\u5728settings\u4e2d\u8fdb\u884c\u8bbe\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#launchjson","text":"\u5b89\u88c5 delve \u540e\uff0c\u8fd0\u884c\u547d\u4ee4 Debug\uff1aOpen launch.json \u3002\u5982\u679c\u8fd8\u6ca1\u6709 launch.json \u6587\u4ef6\uff0c\u5219\u4f1a\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u4ee5\u4e0b\u9ed8\u8ba4\u914d\u7f6e\u7684\u6587\u4ef6\uff0c\u8be5\u914d\u7f6e\u53ef\u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u5305\u3002 { version : 0.2.0 , configurations : [ { name : Launch , type : go , request : launch , mode : auto , program : ${fileDirname} , env : {}, args : [] } ] } \u4ee5\u4e0b\u662f\u53ef\u4ee5\u5728\u8c03\u8bd5\u914d\u7f6e\u4e2d\u8c03\u6574\u7684\u4e00\u4e9b\u5e38\u89c1\u5c5e\u6027\u7684\u66f4\u591a\u4fe1\u606f\uff1a \u5c5e\u6027 \u63cf\u8ff0 name Debug\u89c6\u56fe\u4e0b\u62c9\u5217\u8868\u4e2d\u663e\u793a\u7684\u914d\u7f6e\u7684\u540d\u79f0 type \u59cb\u7ec8\u8bbe\u7f6e\u4e3a \u201cgo\u201d \uff0cVS Code\u4f7f\u7528\u5b83\u6765\u786e\u5b9a\u5e94\u8be5\u4f7f\u7528\u54ea\u4e2a\u6269\u5c55\u7a0b\u5e8f\u6765\u8c03\u8bd5\u4ee3\u7801 request launch \u6216\u8005 attach \uff0c\u4f7f\u7528 attach \u5f53\u9700\u8981\u9644\u52a0\u5230\u4e00\u4e2a\u5df2\u7ecf\u5728\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f mode \u5bf9\u4e8e\u4e0a\u4e2a\u5c5e\u6027\u4e2d\u7684 launch \uff0c\u53ef\u9009\u62e9 auto , debug , remote , test , exec \uff1b\u5bf9\u4e8e\u4e0a\u4e2a\u5c5e\u6027\u4e2d\u7684 attach \uff0c\u53ef\u9009\u62e9 local \uff0c remote program \u5728 debug \u548c test \u6a21\u5f0f\u4e0b\uff0c\u6307\u5b9a\u8981\u8c03\u8bd5\u7684\u5305\u6216\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u6216\u8005\u5728 exec \u6a21\u5f0f\u4e0b\u8c03\u8bd5\u7684\u9884\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff1b\u4e0d\u9002\u7528\u4e8e attach env \u8c03\u8bd5\u65f6\u8981\u4f7f\u7528\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5982 { \"ENVNAME\": \"ENVVALUE\" } envFile \u5305\u542b\u73af\u5883\u53d8\u91cf\u5b9a\u4e49\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c env \u5c5e\u6027\u4e2d\u4f20\u9012\u7684\u73af\u5883\u53d8\u91cf\u4f1a\u8986\u76d6\u6b64\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf args \u5c06\u4f20\u9012\u7ed9\u6b63\u5728\u8c03\u8bd5\u7684\u7a0b\u5e8f\u7684\u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4 showLogs \u5e03\u5c14\u503c\uff0c\u6307\u793a\u662f\u5426\u5e94\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u6253\u5370\u6765\u81ea delve \u7684\u65e5\u5fd7 logOutput \u4ee5\u9017\u53f7\u5206\u9694\u7684 delve \u7ec4\u4ef6\u5217\u8868\uff08 debugger \uff0c gdbwire \uff0c lldbout \uff0c debuglineerr \uff0c rpc \uff09\uff0c\u5f53\u8bbe\u7f6e\u4e3atrue\u65f6\u5e94\u751f\u6210\u8c03\u8bd5\u8f93\u51fa buildFlags \u8981\u4f20\u9012\u7ed9Go\u7f16\u8bd1\u5668\u7684\u6784\u5efa( build )\u6807\u5fd7 remotePath \u8fdc\u7a0b\u8c03\u8bd5\u65f6\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u6b63\u5728\u8c03\u8bd5\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u5373 mode \u8bbe\u7f6e\u4e3a remote \u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u201c \u8fdc\u7a0b\u8c03\u8bd5 \u201d\u4e00\u8282 processeid \u4ec5\u5728\u4f7f\u7528 local mode\u7684 attach request\u65f6\u9002\u7528\uff0c\u8fd9\u662f\u8fd0\u884c\u9700\u8981\u8c03\u8bd5\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8fdb\u7a0b\u7684id","title":"\u5728launch.json\u4e2d\u8bbe\u7f6e\u914d\u7f6e\u9879"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#vscode","text":"\u8c03\u8bd5\u914d\u7f6e\u4e2d\u91c7\u7528\u6587\u4ef6\u5939/\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u5c5e\u6027\u90fd\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b VSCode \u53d8\u91cf\uff1a ${workspaceFolder} \uff1a\u8c03\u8bd5\u5728 VSCode \u4e2d\u6253\u5f00\u7684\u5de5\u4f5c\u7a7a\u95f4\u7684\u6839\u76ee\u5f55\u4e0b\u7684\u7a0b\u5e8f\u5305 ${file} \uff1a\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6 ${fileDirname} \uff1a\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6\u6240\u5c5e\u7684\u5305","title":"\u5728\u8c03\u8bd5\u8bbe\u7f6e\u4e2d\u4f7f\u7528VSCode\u53d8\u91cf"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_1","text":"\u5982\u679c\u6784\u5efa\u65f6\u9700\u8981\u6784\u5efa\u6807\u8bb0\uff08\u4f8b\u5982 go build -tags=whatever_tag \uff09\uff0c\u90a3\u4e48\u6dfb\u52a0\u53c2\u6570 buildFlags \uff0c\u5185\u5bb9\u4e3a\u201c -tags=whatever_tag \u201d\u3002 \u652f\u6301\u591a\u4e2a\u6807\u8bb0\uff0c\u5c06\u5b83\u4eec\u7528\u53cc\u5f15\u53f7\u62ec\u8d77\u6765\uff0c\u5982\u4e0b\u6240\u793a\uff1a \u201c-tags='first_tag second_tag third_tag'\u201d \u3002","title":"\u4f7f\u7528\u6784\u5efa\u6807\u7b7e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_2","text":"\u7f16\u8f91 launch.json \u6587\u4ef6\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee3\u7801\u6bb5\u8fdb\u884c\u8c03\u8bd5\u914d\u7f6e\u3002\u8f93\u5165 \u201cGo\u201d \uff0c\u5c06\u83b7\u5f97\u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6/\u5305\uff0c\u6d4b\u8bd5\u529f\u80fd\u7b49\u7684\u7247\u6bb5\u3002","title":"\u8c03\u8bd5\u914d\u7f6e\u7684\u4ee3\u7801\u6bb5"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_3","text":"{ name : Launch file , type : go , request : launch , mode : auto , program : ${file} }","title":"\u7528\u4e8e\u8c03\u8bd5\u5f53\u524d\u6587\u4ef6\u7684\u793a\u4f8b\u914d\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_4","text":"{ name : Launch test function , type : go , request : launch , mode : test , program : ${workspaceFolder} , args : [ -test.run , MyTestFunction ] }","title":"\u7528\u4e8e\u8c03\u8bd5\u5355\u4e2a\u6d4b\u8bd5\u7684\u793a\u4f8b\u914d\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_5","text":"{ name : Launch test package , type : go , request : launch , mode : test , program : ${workspaceFolder} }","title":"\u7528\u4e8e\u8c03\u8bd5\u5305\u4e2d\u6240\u6709\u6d4b\u8bd5\u7684\u793a\u4f8b\u914d\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_6","text":"{ name : Launch executable , type : go , request : launch , mode : exec , program : absolute-path-to-the-executable }","title":"\u7528\u4e8e\u8c03\u8bd5\u9884\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684\u793a\u4f8b\u914d\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#processid","text":"{ name : Attach to local process , type : go , request : attach , mode : local , processId : 0 }","title":"\u4f7f\u7528processId\u9644\u52a0\u5230\u5df2\u5728\u8fd0\u884c\u7684\u672c\u5730\u8fdb\u7a0b\u7684\u793a\u4f8b\u914d\u7f6e"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_7","text":"\u8981\u4f7f\u7528 VSCode \u8fdb\u884c\u8fdc\u7a0b\u8c03\u8bd5\uff0c\u5fc5\u987b\u9996\u5148\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u65e0\u5934\u7684 Delve \u670d\u52a1\u5668\u3002\u4f8b\u5982\uff1a dlv debug --headless --listen=:2345 --log --api-version=2 \u8981\u4f20\u9012\u7ed9\u6b63\u5728\u8c03\u8bd5\u7684\u7a0b\u5e8f\u7684\u4efb\u4f55\u53c2\u6570\u90fd\u5fc5\u987b\u4f20\u9012\u7ed9\u5728\u76ee\u6807\u8ba1\u7b97\u673a\u4e0a\u8fd0\u884c\u7684 Delve \u670d\u52a1\u5668\u3002\u4f8b\u5982\uff1a dlv debug --headless --listen=:2345 --log -- -myArg=123 \u7136\u540e\uff0c\u5728VS Code launch.json \u4e2d\u521b\u5efa\u8fdc\u7a0b\u8c03\u8bd5\u914d\u7f6e\u3002 { name : Launch remote , type : go , request : launch , mode : remote , remotePath : absolute-path-to-the-file-being-debugged-on-the-remote-machine , port : 2345, host : 127.0.0.1 , program : absolute-path-to-the-file-on-the-local-machine , env : {} } \u4e0a\u9762\u7684\u793a\u4f8b\u5728\u540c\u4e00\u53f0\u673a\u5668\u4e0a\u672c\u5730\u8fd0\u884c\u65e0\u5934 dlv \u670d\u52a1\u5668\u548cVScode\u8c03\u8bd5\u5668\u3002\u6839\u636e\u5728\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e0a\u7684\u8bbe\u7f6e\u66f4\u65b0 \u7aef\u53e3 \u548c \u4e3b\u673a \u3002 remotePath \u5e94\u6307\u5411\u8fdc\u7a0b\u8ba1\u7b97\u673a\u4e2d\u6b63\u5728\u8c03\u8bd5\u7684\u6587\u4ef6\uff08\u5728\u6e90\u4ee3\u7801\u4e2d\uff09\u7684\u7edd\u5bf9\u8def\u5f84 program \u5e94\u6307\u5411\u672c\u5730\u8ba1\u7b97\u673a\u4e0a\u4e0e remotePath \u4e2d\u5bf9\u5e94\u7684\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84 \u5f53\u9009\u62e9\u6b64\u65b0\u7684 Launch remote \u76ee\u6807\u542f\u52a8\u8c03\u8bd5\u5668\u65f6\uff0c VS Code \u4f1a\u5c06\u8c03\u8bd5\u547d\u4ee4\u53d1\u9001\u5230\u4e4b\u524d\u542f\u52a8\u7684 dlv \u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u9488\u5bf9\u5e94\u7528\u542f\u52a8\u5b83\u81ea\u5df1\u7684 dlv \u5b9e\u4f8b\u3002 \u8bf7\u53c2\u9605 https://github.com/lukehoban/webapp-go/tree/debugging \u4e2d\u8c03\u8bd5\u5728docker\u4e3b\u673a\u4e2d\u8fd0\u884c\u7684\u8fdb\u7a0b\u7684\u793a\u4f8b\u3002","title":"\u8fdc\u7a0b\u8c03\u8bd5"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_8","text":"\u5982\u679c\u5728\u8c03\u8bd5Go\u4ee3\u7801\u65f6\u9047\u5230\u95ee\u9898\uff0c\u8bf7\u9996\u5148\u5c1d\u8bd5\u66f4\u65b0\u7684 delve \u7248\u672c\uff0c\u4ee5\u786e\u4fdd\u4f7f\u7528\u7684\u662f\u6700\u65b0\u7248\u672c\uff0c\u5e76\u4e14\u5df2\u4f7f\u7528\u5f53\u524d\u7684Go\u7248\u672c\u8fdb\u884c\u7f16\u8bd1\u3002\u8981\u6267\u884c\u6b64\u64cd\u4f5c\uff0c\u8bf7\u8fd0\u884c\u547d\u4ee4 Go\uff1aInstall/Update Tools \uff0c\u9009\u62e9 dlv \uff0c\u7136\u540e\u70b9\u51fb ok \u3002","title":"\u6545\u969c\u6392\u9664"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_9","text":"\u5c06\u8c03\u8bd5\u914d\u7f6e\u4e2d\u7684 showLog \u5c5e\u6027\u8bbe\u7f6e\u4e3a true \u3002\u5c06\u4ece delve \u4e2d\u770b\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u7684\u65e5\u5fd7\u3002 \u5728\u8c03\u8bd5\u914d\u7f6e\u4e2d\u8bbe\u7f6e trace \u5c5e\u6027\u4ee5\u8fdb\u884c\u8bb0\u5f55\u3002\u5c06\u4eceGo\u6269\u5c55\u7a0b\u5e8f\u7684\u8c03\u8bd5\u9002\u914d\u5668\u4e2d\u770b\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u7684\u65e5\u5fd7\u3002\u8fd9\u4e9b\u65e5\u5fd7\u5c06\u4fdd\u5b58\u5230\u4e00\u4e2a\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u7684\u8def\u5f84\u5c06\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u7684\u5f00\u5934\u6253\u5370\u3002 \u5c06\u8c03\u8bd5\u914d\u7f6e\u4e2d\u7684 logOutput \u5c5e\u6027\u8bbe\u7f6e\u4e3a rpc \u3002\u5c06\u770b\u5230\u5bf9\u5e94\u4e8e\u5728 VS Code \u548c delve \u4e4b\u95f4\u6765\u56de\u4f20\u9012\u7684 RPC \u6d88\u606f\u7684\u65e5\u5fd7\u3002\u8bf7\u6ce8\u610f\uff0c\u9996\u5148\u9700\u8981\u5c06 showLog \u8bbe\u7f6e\u4e3a true \u3002 logOutput \u5c5e\u6027\u5bf9\u5e94\u4e8e delve \u4f7f\u7528\u7684 --log-output \u6807\u5fd7\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2a\u9017\u53f7\u5206\u9694\u7684\u7ec4\u4ef6\u5217\u8868\uff0c\u5b83\u5e94\u8be5\u751f\u6210\u8c03\u8bd5\u8f93\u51fa\u3002","title":"\u542f\u52a8\u8c03\u8bd5\u65e5\u5fd7"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_10","text":"\u5982\u679c\u60f3\u6df1\u5165\u6316\u6398\u5e76\u4f7f\u7528\u6b64\u6269\u5c55\u7a0b\u5e8f\u7684\u6e90\u4ee3\u7801\u8c03\u8bd5\u8c03\u8bd5\u5668\uff0c\u8bf7\u53c2\u9605 build-and-debugging-the-extension \u3002","title":"\u4f7f\u7528\u6e90\u4ee3\u7801\u8c03\u8bd5\u8c03\u8bd5\u5668"},{"location":"IDE/VSCode/03-\u4f7f\u7528VSCode\u8c03\u8bd5Go\u4ee3\u7801/#_11","text":"\u8c03\u8bd5\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u672a\u9a8c\u8bc1\u65ad\u70b9\u6216\u53d8\u91cf \u786e\u4fdd\u6b63\u5728\u8c03\u8bd5\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u662f\u5728\u6ca1\u6709\u4f18\u5316\u7684\u60c5\u51b5\u4e0b\u6784\u5efa\u7684\u3002\u5728\u6784\u5efa\u4e8c\u8fdb\u5236\u6587\u4ef6\u65f6\u4f7f\u7528\u6807\u5fd7 -gcflags=\"all = -N -l\" \u3002 Cannot find package \"..\" in any of ... \u8c03\u8bd5\u5668\u6ca1\u6709\u4f7f\u7528\u6b63\u786e\u7684 GOPATH \u3002\u8fd9\u4e0d\u5e94\u8be5\u53d1\u751f\uff0c\u5982\u679c\u786e\u5b9e\u5982\u6b64\uff0c\u8bf7\u8bb0\u5f55\u4e00\u4e2a\u9519\u8bef\u3002 \u5728\u8bb0\u5f55\u7684\u9519\u8bef\u88ab\u89e3\u51b3\u4e4b\u524d\uff0c\u89e3\u51b3\u65b9\u6cd5\u662f\u5728 launch.json \u6587\u4ef6\u7684 env \u5c5e\u6027\u4e2d\u5c06 GOPATH \u6dfb\u52a0\u4e3a env var \u3002 Failed to continue: \"Error: spawn EACCES\" dlv \u4ece\u547d\u4ee4\u884c\u8fd0\u884c\u5f97\u5f88\u597d\uff0c\u4f46 VS Code \u63d0\u4f9b\u6b64\u8bbf\u95ee\u76f8\u5173\u7684\u9519\u8bef\u3002\u5982\u679c\u6269\u5c55\u7a0b\u5e8f\u8bd5\u56fe\u4ece\u9519\u8bef\u7684\u4f4d\u7f6e\u8fd0\u884c dlv \u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u5219\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002Go\u6269\u5c55\u9996\u5148\u5c1d\u8bd5\u5728 $GOPATH/bin \u4e2d\u627e\u5230 dlv \uff0c\u7136\u540e\u5728 $PATH \u4e2d\u627e\u5230\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c dlv \u3002\u5982\u679c\u8fd9\u4e0e GOPATH/bin \u4e0d\u5339\u914d\uff0c\u5219\u5220\u9664 GOPATH/bin \u4e2d\u7684 dlv \u6587\u4ef6 could not launch process: stat ***/debug.test: no such file or directory \u53ef\u4ee5\u5728\u8c03\u8bd5\u63a7\u5236\u53f0\u4e2d\u770b\u5230\u6b64\u4fe1\u606f\uff0c\u540c\u65f6\u5c1d\u8bd5\u5728\u6d4b\u8bd5\u6a21\u5f0f\u4e0b\u8fd0\u884c\u3002\u5f53\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u6ca1\u6709\u6d4b\u8bd5\u6587\u4ef6\u7684\u6587\u4ef6\u5939\u65f6\uff0c\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u786e\u4fdd\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u5305\u542b\u8981\u8fd0\u884c\u7684\u6d4b\u8bd5\u6587\u4ef6\u7684\u6587\u4ef6\u5939 could not launch process: could not fork/exec OSX \u7531\u4e8e\u7b7e\u540d\u95ee\u9898\uff0c\u8fd9\u901a\u5e38\u53d1\u751f\u5728OSX\u4e2d\u3002\u8bf7\u53c2\u9605\u8ba8\u8bba\uff0c\u8bf7\u53c2\u9605 \uff03717 \uff0c \uff03269 \u548c derekparker/delve/357 \u89e3\u51b3\u65b9\u6848\uff1a\u53ef\u80fd\u5fc5\u987b\u5378\u8f7d dlv \u5e76\u6309\u7167 \u8bf4\u660e \u624b\u52a8\u5b89\u88c5\u5b83 Linux/Docker Docker\u5177\u6709\u5b89\u5168\u8bbe\u7f6e\uff0c\u53ef\u4ee5\u5728\u5bb9\u5668\u5185\u9ed8\u8ba4\u963b\u6b62 ptrace(2) \u64cd\u4f5c\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u8981\u4e0d\u5b89\u5168\u5730\u8fd0\u884c\u5bb9\u5668\uff0c\u8bf7\u5728\u542f\u52a8\u65f6\u5c06 --security-opt=seccomp:unconfined \u4f20\u9012\u7ed9 docker \u3002\u53c2\u8003\uff1a derekparker/delve/515 could not launch process: exec: \"lldb-server\": executable file not found in $PATH \u5bf9\u4e8e\u4f7f\u7528\u7248\u672c 0.12.2 \u6216\u66f4\u9ad8\u7248\u672c\u7684\u7248\u672c\u7684 Mac \u7528\u6237\uff0c\u6b64\u9519\u8bef\u53ef\u80fd\u4f1a\u663e\u793a\u3002\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u4f46\u662f\u505a xcode-select --install \u5df2\u7ecf\u89e3\u51b3\u4e86\u770b\u5230\u8fd9\u4e2a\u95ee\u9898\u7684\u7528\u6237\u7684\u95ee\u9898\u3002 \u8fdc\u7a0b\u8c03\u8bd5\u672a\u9a8c\u8bc1\u7684\u65ad\u70b9 \u68c0\u67e5 remote delve process \u4f7f\u7528\u7684 delve api \u7684\u7248\u672c\uff0c\u5373\u68c0\u67e5\u6807\u5fd7 -api-version \u7684\u503c\u3002\u8fd9\u9700\u8981\u5339\u914dGo\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684\u7248\u672c\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f7f\u7528\u7248\u672c2\u3002\u53ef\u4ee5\u901a\u8fc7\u7f16\u8f91 launch.json \u6587\u4ef6\u4e2d\u7684\u8c03\u8bd5\u914d\u7f6e\u6765\u66f4\u6539\u6269\u5c55\u4f7f\u7528\u7684 api \u7248\u672c\u3002 \u5c1d\u8bd5\u4f7f\u7528\u7ec8\u7aef/\u547d\u4ee4\u884c\u4e2d\u7684 dlv \u5c06 \"trace\"\uff1a\"log\" \u6dfb\u52a0\u5230\u8c03\u8bd5\u914d\u7f6e\u5e76\u5728 VS Code \u4e2d\u8c03\u8bd5\u3002\u8fd9\u4f1a\u5c06\u65e5\u5fd7\u53d1\u9001\u5230\u8c03\u8bd5\u63a7\u5236\u53f0\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u67e5\u770b\u5bf9 dlv \u7684\u5b9e\u9645\u8c03\u7528\u3002\u53ef\u4ee5\u590d\u5236\u5e76\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u5b83","title":"\u5e38\u89c1\u95ee\u9898"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/","text":"VScode\u4e2dGo\u7684\u529f\u80fd \u667a\u80fd\u611f\u77e5 \u8f93\u5165\u65f6\u81ea\u52a8\u8865\u5168\uff08 gocode \uff09 \u8f93\u5165\u65f6\u663e\u793a\u51fd\u6570\u7684\u5e2e\u52a9\u4fe1\u606f\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09 \u9f20\u6807\u60ac\u505c\u663e\u793a\u4fe1\u606f\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09 \u4ee3\u7801\u5bfc\u822a \u8df3\u8f6c\u6216\u76f4\u63a5i\u897f\u5b89\u5e02\u7b26\u53f7\u7684\u5b9a\u4e49\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09 \u67e5\u770b\u7b26\u53f7\u7684\u5f15\u7528\u548c\u63a5\u53e3\u7684\u5b9e\u73b0\uff08 guru \uff09 \u8df3\u8f6c\u5230\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u6216\u8005\u67e5\u770b\u6587\u4ef6\u5927\u7eb2\uff08 go-outline \uff09 \u8df3\u8f6c\u5230\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u7684\u7b26\u53f7\uff08 go-symbols \uff09 \u5728Go\u7a0b\u5e8f\u548c\u76f8\u5e94\u7684\u6d4b\u8bd5\u6587\u4ef6\u4e4b\u95f4\u5207\u6362 \u4ee3\u7801\u7f16\u8f91 \u7528\u4e8e\u5feb\u901f\u5f00\u53d1\u7684\u4ee3\u7801\u7247\u6bb5 \u624b\u52a8\u683c\u5f0f\u5316\u6216\u8005\u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u683c\u5f0f\u5316\u4ee3\u7801\uff08 goreturns \u6216\u8005 goimports \u6216\u8005 gofmt \uff09 \u5b57\u7b26\u91cd\u547d\u540d\uff08 gorename ,\u6ce8\u610f:\u91cd\u547d\u540d\u540e\u5728\u7a97\u53e3\u4e2d\u6267\u884c\u64a4\u9500\u64cd\u4f5c\uff0c\u9700\u8981\u5728 path \u4e2d\u6709 diff \u5de5\u5177\uff09 \u5c06\u5bfc\u5165\u6dfb\u52a0\u5230\u5f53\u524d\u6587\u4ef6\u4e2d\uff08 gopkgs \uff09 \u5728\u7ed3\u6784\u4f53\u5b57\u6bb5\u4e0a\u6dfb\u52a0\u6216\u5220\u9664\u6807\u8bb0\uff08 gomodifytags \uff09 \u4e3a\u63a5\u53e3\u751f\u6210\u65b9\u6cd5 stub \uff08 impl \uff09 \u4f7f\u7528\u9ed8\u8ba4\u503c\u586b\u5145\u7ed3\u6784\u4f53\u5b57\u6bb5\uff08 fillstruct \uff09 \u8bca\u65ad \u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u7f16\u8bd1\u4ee3\u7801\u5e76\u663e\u793a\u7f16\u8bd1\u9519\u8bef\uff08 go build \u548c go test \uff09 \u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u8fd0\u884c go vet \u547d\u4ee4\u5e76\u5c06\u9519\u8bef\u4ee5\u8b66\u544a\u5f62\u5f0f\u663e\u793a \u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u5206\u6790\u4ee3\u7801\uff0c\u5e76\u5c06\u5206\u6790\u9519\u8bef\u4ee5\u8b66\u544a\u5f62\u5f0f\u663e\u793a\uff08 golint \uff0c gometalinter \uff0c megacheck \uff0c golang-ci-lint \uff0c revive \uff09 \u8f93\u5165\u65f6\u62a5\u544a\u8bed\u4e49\u6216\u8005\u8bed\u6cd5\u9519\u8bef\uff08 gotype-live \uff09 \u6d4b\u8bd5 \u4f7f\u7528\u547d\u4ee4\u6216\u8005 codelens \u5728\u6574\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u3001\u5f53\u524d\u4ee3\u7801\u5305\u3001\u5f53\u524d\u6587\u4ef6\u6216\u5149\u6807\u5904\u8fd0\u884c\u6d4b\u8bd5 \u4f7f\u7528\u547d\u4ee4\u6216\u8005 codelines \u5728\u5149\u6807\u5904\u6267\u884c\u57fa\u51c6\u6d4b\u8bd5 \u6839\u636e\u9700\u8981\u6216\u8005\u5728\u5305\u4e2d\u8fd0\u884c\u6d4b\u8bd5\u540e\u663e\u793a\u4ee3\u7801\u8986\u76d6\u7387 \u751f\u6210\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08 gotests \uff09","title":"VScode\u4e2dGo\u7684\u529f\u80fd"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#vscodego","text":"","title":"VScode\u4e2dGo\u7684\u529f\u80fd"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#_1","text":"\u8f93\u5165\u65f6\u81ea\u52a8\u8865\u5168\uff08 gocode \uff09 \u8f93\u5165\u65f6\u663e\u793a\u51fd\u6570\u7684\u5e2e\u52a9\u4fe1\u606f\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09 \u9f20\u6807\u60ac\u505c\u663e\u793a\u4fe1\u606f\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09","title":"\u667a\u80fd\u611f\u77e5"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#_2","text":"\u8df3\u8f6c\u6216\u76f4\u63a5i\u897f\u5b89\u5e02\u7b26\u53f7\u7684\u5b9a\u4e49\uff08 gogetdoc \u6216\u8005 godef + godoc \uff09 \u67e5\u770b\u7b26\u53f7\u7684\u5f15\u7528\u548c\u63a5\u53e3\u7684\u5b9e\u73b0\uff08 guru \uff09 \u8df3\u8f6c\u5230\u6587\u4ef6\u4e2d\u7684\u7b26\u53f7\u6216\u8005\u67e5\u770b\u6587\u4ef6\u5927\u7eb2\uff08 go-outline \uff09 \u8df3\u8f6c\u5230\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u7684\u7b26\u53f7\uff08 go-symbols \uff09 \u5728Go\u7a0b\u5e8f\u548c\u76f8\u5e94\u7684\u6d4b\u8bd5\u6587\u4ef6\u4e4b\u95f4\u5207\u6362","title":"\u4ee3\u7801\u5bfc\u822a"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#_3","text":"\u7528\u4e8e\u5feb\u901f\u5f00\u53d1\u7684\u4ee3\u7801\u7247\u6bb5 \u624b\u52a8\u683c\u5f0f\u5316\u6216\u8005\u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u683c\u5f0f\u5316\u4ee3\u7801\uff08 goreturns \u6216\u8005 goimports \u6216\u8005 gofmt \uff09 \u5b57\u7b26\u91cd\u547d\u540d\uff08 gorename ,\u6ce8\u610f:\u91cd\u547d\u540d\u540e\u5728\u7a97\u53e3\u4e2d\u6267\u884c\u64a4\u9500\u64cd\u4f5c\uff0c\u9700\u8981\u5728 path \u4e2d\u6709 diff \u5de5\u5177\uff09 \u5c06\u5bfc\u5165\u6dfb\u52a0\u5230\u5f53\u524d\u6587\u4ef6\u4e2d\uff08 gopkgs \uff09 \u5728\u7ed3\u6784\u4f53\u5b57\u6bb5\u4e0a\u6dfb\u52a0\u6216\u5220\u9664\u6807\u8bb0\uff08 gomodifytags \uff09 \u4e3a\u63a5\u53e3\u751f\u6210\u65b9\u6cd5 stub \uff08 impl \uff09 \u4f7f\u7528\u9ed8\u8ba4\u503c\u586b\u5145\u7ed3\u6784\u4f53\u5b57\u6bb5\uff08 fillstruct \uff09","title":"\u4ee3\u7801\u7f16\u8f91"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#_4","text":"\u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u7f16\u8bd1\u4ee3\u7801\u5e76\u663e\u793a\u7f16\u8bd1\u9519\u8bef\uff08 go build \u548c go test \uff09 \u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u8fd0\u884c go vet \u547d\u4ee4\u5e76\u5c06\u9519\u8bef\u4ee5\u8b66\u544a\u5f62\u5f0f\u663e\u793a \u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u81ea\u52a8\u5206\u6790\u4ee3\u7801\uff0c\u5e76\u5c06\u5206\u6790\u9519\u8bef\u4ee5\u8b66\u544a\u5f62\u5f0f\u663e\u793a\uff08 golint \uff0c gometalinter \uff0c megacheck \uff0c golang-ci-lint \uff0c revive \uff09 \u8f93\u5165\u65f6\u62a5\u544a\u8bed\u4e49\u6216\u8005\u8bed\u6cd5\u9519\u8bef\uff08 gotype-live \uff09","title":"\u8bca\u65ad"},{"location":"IDE/VSCode/04-VSCode\u4e2dGo\u7684\u529f\u80fd/#_5","text":"\u4f7f\u7528\u547d\u4ee4\u6216\u8005 codelens \u5728\u6574\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u3001\u5f53\u524d\u4ee3\u7801\u5305\u3001\u5f53\u524d\u6587\u4ef6\u6216\u5149\u6807\u5904\u8fd0\u884c\u6d4b\u8bd5 \u4f7f\u7528\u547d\u4ee4\u6216\u8005 codelines \u5728\u5149\u6807\u5904\u6267\u884c\u57fa\u51c6\u6d4b\u8bd5 \u6839\u636e\u9700\u8981\u6216\u8005\u5728\u5305\u4e2d\u8fd0\u884c\u6d4b\u8bd5\u540e\u663e\u793a\u4ee3\u7801\u8986\u76d6\u7387 \u751f\u6210\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\uff08 gotests \uff09","title":"\u6d4b\u8bd5"},{"location":"IDE/VSCode/05-VSCode\u652f\u6301Go-Modules/","text":"Go Modules VS Code\u4f7f\u7528\u5927\u91cf Go\u5de5\u5177 \u6765\u63d0\u4f9b\u4ee3\u7801\u5bfc\u822a\uff0c\u4ee3\u7801\u5b8c\u6210\uff0c\u6784\u5efa\uff0c\u5206\u6790\u7b49\u529f\u80fd\u3002 \u8fd9\u4e9b\u5de5\u5177\u8fd8\u6ca1\u6709\u4e3a Go\u6a21\u5757 \u63d0\u4f9b\u826f\u597d\u7684\u652f\u6301\u3002 \u65b0\u7684\u8bed\u8a00\u670d\u52a1\u5668 gopls \u652f\u6301 Go Modules \u3002\u5728 settings \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u4ee5\u4f7f\u7528\u5b83\u3002 go.useLanguageServer : true \u6ce8\u610f\uff1a\u4f7f\u7528 Go\uff1aInstall/Update Tools \u5b9a\u671f\u66f4\u65b0 gopls \u7248\u672c\uff0c\u4ee5\u4fbf\u4e0d\u65ad\u83b7\u5f97\u5bf9\u8bed\u8a00\u670d\u52a1\u5668\u6240\u505a\u7684\u6539\u8fdb\u3002 \u4f7f\u7528 gopls \u65f6 VS Code \u4e2d\u7684\u5df2\u77e5\u95ee\u9898: \u65e0\u6cd5\u81ea\u52a8\u6dfb\u52a0\u672a\u5bfc\u5165\u7684\u5305 \u67e5\u627e\u5f15\u7528\u5e76\u91cd\u547d\u540d\u4ec5\u5728\u5355\u4e2a\u5305\u4e2d\u751f\u6548 \u66f4\u591a\u67e5\u770b\u8fd9\u91cc\uff1a golps \u5df2\u77e5\u95ee\u9898 \u5728\u8fd9\u4e2a\u4ed3\u5e93\u4e2d\u7684\u5df2\u77e5\u95ee\u9898\u90fd\u5e26\u6709 go-modules \u6807\u7b7e \u8981\u5bf9\u8bed\u8a00\u670d\u52a1\u5668\u8fdb\u884c\u6545\u969c\u6392\u9664\uff0c\u8bf7\u53c2\u9605 \u6545\u969c\u6392\u9664 gopls \u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u8bf7\u4e86\u89e3\u5e76\u975e\u6b64\u6269\u5c55\u6240\u4f9d\u8d56\u7684\u6240\u6709Go\u5de5\u5177\u90fd\u652f\u6301Go\u6a21\u5757\u3002 https://github.com/golang/go/issues/24661 \u662fGo\u5de5\u5177\u56e2\u961f\u7528\u6765\u8ddf\u8e2a\u5404\u79cdGo\u5de5\u5177\u4e2dGo\u6a21\u5757\u652f\u6301\u66f4\u65b0\u7684\u95ee\u9898\u5217\u8868\u3002 FAQ \u4f7f\u7528Go\u6a21\u5757\u65f6\u53ef\u4ee5\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5417\uff1f \u53ef\u4ee5\uff0c\u8fd9\u662f VS Code \u4e2d\u6a21\u5757\u652f\u6301\u7684\u524d\u8fdb\u4e4b\u8def\u3002\u8bf7\u6ce8\u610f\u8bed\u8a00\u670d\u52a1\u5668\u672c\u8eab\u5904\u4e8ealpha\u6a21\u5f0f\uff0c\u6b63\u5728\u8fdb\u884c\u6d3b\u52a8\u5f00\u53d1\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6b64\u95ee\u9898\u4e0a\u65b9\u7684\u90e8\u5206\u3002 \u4f7f\u7528Go\u6a21\u5757\u65f6\uff0c\u4e3a\u4ec0\u4e48\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u8865\u5168\u901f\u5ea6\u4f1a\u53d8\u6162\uff1f \u4f7f\u7528Google\u7684\u8bed\u8a00\u670d\u52a1\u5668\u65f6\uff0c\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u8865\u5168\u80af\u5b9a\u4f1a\u66f4\u597d\u3002\u6240\u4ee5\uff0c\u8bf7\u8bd5\u4e00\u8bd5\u3002\u5982\u679c\u4e0d\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u8fd9\u4e3b\u8981\u7531\u4e8e godef \u548c gocode \u7684\u9650\u5236\u3002Google\u7684Go\u5de5\u5177\u56e2\u961f\u6b63\u5728\u5f00\u53d1\u4e00\u79cd \u8bed\u8a00\u670d\u52a1\u5668 \uff0c\u5b83\u5c06\u6210\u4e3a\u6240\u6709\u8bed\u8a00\u529f\u80fd\u7684\u957f\u671f\u89e3\u51b3\u65b9\u6848\u3002\u8bf7\u6309\u7167\u672c\u9875\u7b2c\u4e00\u90e8\u5206\u7684\u8bf4\u660e\u8bd5\u7528\u8bed\u8a00\u670d\u52a1\u5668\u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668: \u5982\u679c\u4ee3\u7801\u8865\u5168\u7f13\u6162\uff0c\u8bf7\u5728 gocode \u4ed3\u5e93 \u4e2d\u8bb0\u5f55\u4e00\u4e2a\u95ee\u9898\u3002 \u5982\u679c\u4ee3\u7801\u5bfc\u822a\u901f\u5ea6\u6162\uff0c\u8bf7\u5728 [godef\u4ed3\u5e93](https://github.com/rogpeppe/godef) \u4e2d\u8bb0\u5f55\u95ee\u9898\uff0c\u6216\u8005\u5982\u679c\u5728\u8bbe\u7f6e\u4e2d\u9009\u62e9\u4e86 gogetdoc \uff0c\u8bf7\u5728[ gogetdoc\u4ed3\u5e93](https://github.com/zmb3/gogetdoc) \u4e2d\u8bb0\u5f55\u95ee\u9898\u3002 \u6587\u4ef6\u4fdd\u5b58\u65f6\u4e0d\u518d\u81ea\u52a8\u5bfc\u5165\u3002\u4e3a\u4ec0\u4e48\uff1f \u5982\u679c\u4e0d\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u5219\u6b64\u6269\u5c55\u7a0b\u5e8f\u9ed8\u8ba4\u4f7f\u7528 goreturns \u5de5\u5177\u683c\u5f0f\u5316\u6587\u4ef6\u5e76\u81ea\u52a8\u5bfc\u5165\u7f3a\u5931\u7684\u5305\u3002\u7531\u4e8e\u6b64\u5de5\u5177\u4e0d\u652f\u6301\u6a21\u5757\uff0c\u56e0\u6b64\u6587\u4ef6\u4fdd\u5b58\u4e2d\u7684\u81ea\u52a8\u5bfc\u5165\u529f\u80fd\u4e0d\u518d\u6709\u6548\u3002\u6dfb\u52a0\u8bbe\u7f6e\" go.formatTool \"\uff1a\" goimports \"\uff0c\u7136\u540e\u4f7f\u7528 Go\uff1aInstall/Update Tools \u6765\u5b89\u88c5/\u66f4\u65b0 goimports \uff0c\u56e0\u4e3a\u5b83\u6700\u8fd1\u6dfb\u52a0\u4e86\u5bf9\u6a21\u5757\u7684\u652f\u6301\u3002","title":"Go Modules"},{"location":"IDE/VSCode/05-VSCode\u652f\u6301Go-Modules/#go-modules","text":"VS Code\u4f7f\u7528\u5927\u91cf Go\u5de5\u5177 \u6765\u63d0\u4f9b\u4ee3\u7801\u5bfc\u822a\uff0c\u4ee3\u7801\u5b8c\u6210\uff0c\u6784\u5efa\uff0c\u5206\u6790\u7b49\u529f\u80fd\u3002 \u8fd9\u4e9b\u5de5\u5177\u8fd8\u6ca1\u6709\u4e3a Go\u6a21\u5757 \u63d0\u4f9b\u826f\u597d\u7684\u652f\u6301\u3002 \u65b0\u7684\u8bed\u8a00\u670d\u52a1\u5668 gopls \u652f\u6301 Go Modules \u3002\u5728 settings \u4e2d\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\u4ee5\u4f7f\u7528\u5b83\u3002 go.useLanguageServer : true \u6ce8\u610f\uff1a\u4f7f\u7528 Go\uff1aInstall/Update Tools \u5b9a\u671f\u66f4\u65b0 gopls \u7248\u672c\uff0c\u4ee5\u4fbf\u4e0d\u65ad\u83b7\u5f97\u5bf9\u8bed\u8a00\u670d\u52a1\u5668\u6240\u505a\u7684\u6539\u8fdb\u3002 \u4f7f\u7528 gopls \u65f6 VS Code \u4e2d\u7684\u5df2\u77e5\u95ee\u9898: \u65e0\u6cd5\u81ea\u52a8\u6dfb\u52a0\u672a\u5bfc\u5165\u7684\u5305 \u67e5\u627e\u5f15\u7528\u5e76\u91cd\u547d\u540d\u4ec5\u5728\u5355\u4e2a\u5305\u4e2d\u751f\u6548 \u66f4\u591a\u67e5\u770b\u8fd9\u91cc\uff1a golps \u5df2\u77e5\u95ee\u9898 \u5728\u8fd9\u4e2a\u4ed3\u5e93\u4e2d\u7684\u5df2\u77e5\u95ee\u9898\u90fd\u5e26\u6709 go-modules \u6807\u7b7e \u8981\u5bf9\u8bed\u8a00\u670d\u52a1\u5668\u8fdb\u884c\u6545\u969c\u6392\u9664\uff0c\u8bf7\u53c2\u9605 \u6545\u969c\u6392\u9664 gopls \u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u8bf7\u4e86\u89e3\u5e76\u975e\u6b64\u6269\u5c55\u6240\u4f9d\u8d56\u7684\u6240\u6709Go\u5de5\u5177\u90fd\u652f\u6301Go\u6a21\u5757\u3002 https://github.com/golang/go/issues/24661 \u662fGo\u5de5\u5177\u56e2\u961f\u7528\u6765\u8ddf\u8e2a\u5404\u79cdGo\u5de5\u5177\u4e2dGo\u6a21\u5757\u652f\u6301\u66f4\u65b0\u7684\u95ee\u9898\u5217\u8868\u3002","title":"Go Modules"},{"location":"IDE/VSCode/05-VSCode\u652f\u6301Go-Modules/#faq","text":"\u4f7f\u7528Go\u6a21\u5757\u65f6\u53ef\u4ee5\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5417\uff1f \u53ef\u4ee5\uff0c\u8fd9\u662f VS Code \u4e2d\u6a21\u5757\u652f\u6301\u7684\u524d\u8fdb\u4e4b\u8def\u3002\u8bf7\u6ce8\u610f\u8bed\u8a00\u670d\u52a1\u5668\u672c\u8eab\u5904\u4e8ealpha\u6a21\u5f0f\uff0c\u6b63\u5728\u8fdb\u884c\u6d3b\u52a8\u5f00\u53d1\u3002\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u6b64\u95ee\u9898\u4e0a\u65b9\u7684\u90e8\u5206\u3002 \u4f7f\u7528Go\u6a21\u5757\u65f6\uff0c\u4e3a\u4ec0\u4e48\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u8865\u5168\u901f\u5ea6\u4f1a\u53d8\u6162\uff1f \u4f7f\u7528Google\u7684\u8bed\u8a00\u670d\u52a1\u5668\u65f6\uff0c\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u8865\u5168\u80af\u5b9a\u4f1a\u66f4\u597d\u3002\u6240\u4ee5\uff0c\u8bf7\u8bd5\u4e00\u8bd5\u3002\u5982\u679c\u4e0d\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u8fd9\u4e3b\u8981\u7531\u4e8e godef \u548c gocode \u7684\u9650\u5236\u3002Google\u7684Go\u5de5\u5177\u56e2\u961f\u6b63\u5728\u5f00\u53d1\u4e00\u79cd \u8bed\u8a00\u670d\u52a1\u5668 \uff0c\u5b83\u5c06\u6210\u4e3a\u6240\u6709\u8bed\u8a00\u529f\u80fd\u7684\u957f\u671f\u89e3\u51b3\u65b9\u6848\u3002\u8bf7\u6309\u7167\u672c\u9875\u7b2c\u4e00\u90e8\u5206\u7684\u8bf4\u660e\u8bd5\u7528\u8bed\u8a00\u670d\u52a1\u5668\u3002 \u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668: \u5982\u679c\u4ee3\u7801\u8865\u5168\u7f13\u6162\uff0c\u8bf7\u5728 gocode \u4ed3\u5e93 \u4e2d\u8bb0\u5f55\u4e00\u4e2a\u95ee\u9898\u3002 \u5982\u679c\u4ee3\u7801\u5bfc\u822a\u901f\u5ea6\u6162\uff0c\u8bf7\u5728 [godef\u4ed3\u5e93](https://github.com/rogpeppe/godef) \u4e2d\u8bb0\u5f55\u95ee\u9898\uff0c\u6216\u8005\u5982\u679c\u5728\u8bbe\u7f6e\u4e2d\u9009\u62e9\u4e86 gogetdoc \uff0c\u8bf7\u5728[ gogetdoc\u4ed3\u5e93](https://github.com/zmb3/gogetdoc) \u4e2d\u8bb0\u5f55\u95ee\u9898\u3002 \u6587\u4ef6\u4fdd\u5b58\u65f6\u4e0d\u518d\u81ea\u52a8\u5bfc\u5165\u3002\u4e3a\u4ec0\u4e48\uff1f \u5982\u679c\u4e0d\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u5219\u6b64\u6269\u5c55\u7a0b\u5e8f\u9ed8\u8ba4\u4f7f\u7528 goreturns \u5de5\u5177\u683c\u5f0f\u5316\u6587\u4ef6\u5e76\u81ea\u52a8\u5bfc\u5165\u7f3a\u5931\u7684\u5305\u3002\u7531\u4e8e\u6b64\u5de5\u5177\u4e0d\u652f\u6301\u6a21\u5757\uff0c\u56e0\u6b64\u6587\u4ef6\u4fdd\u5b58\u4e2d\u7684\u81ea\u52a8\u5bfc\u5165\u529f\u80fd\u4e0d\u518d\u6709\u6548\u3002\u6dfb\u52a0\u8bbe\u7f6e\" go.formatTool \"\uff1a\" goimports \"\uff0c\u7136\u540e\u4f7f\u7528 Go\uff1aInstall/Update Tools \u6765\u5b89\u88c5/\u66f4\u65b0 goimports \uff0c\u56e0\u4e3a\u5b83\u6700\u8fd1\u6dfb\u52a0\u4e86\u5bf9\u6a21\u5757\u7684\u652f\u6301\u3002","title":"FAQ"},{"location":"IDE/VSCode/06-\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177/","text":"Go\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177 VS Code\u7684Go\u6269\u5c55\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u5b89\u88c5\u5728 GOPATH \u4e2d\u7684\u5404\u79cdGo\u5de5\u5177\u3002 \u5176\u4e2d\u6709\u4e00\u4e9b\u5de5\u5177\u8d1f\u8d23\u901a\u7528\u7684\u7f16\u7a0b\u8bed\u8a00\u529f\u80fd\uff0c\u5982\uff1a \u4ee3\u7801\u5bfc\u822a \u81ea\u52a8\u8865\u5168 \u7b26\u53f7\u641c\u7d22 \u53e6\u5916\u7684\u4e00\u4e9b\u5de5\u5177\u5bf9Go\u6269\u5c55\u7a0b\u5e8f\u6765\u8bf4\u662f\u53ef\u9009\u7684\uff0c\u5b83\u4eec\u63d0\u4f9b\u65e5\u5e38\u7684\u8bed\u8a00\u652f\u6301\u3002 \u4ee5\u4e0b\u662fGo\u6269\u5c55\u7a0b\u5e8f\u7684\u5e38\u7528\u529f\u80fd\u5fc5\u987b\u7528\u5230\u7684\u5de5\u5177\u3002\u5982\u679c\u5df2\u7ecf\u9009\u62e9\u4f7f\u7528 Go\u8bed\u8a00\u7684\u670d\u52a1\u5668 \uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u4ee5\u4e0b\u5927\u90e8\u5206\u7684\u5de5\u5177\u4e86\uff0c\u56e0\u4e3a\u5728Go\u8bed\u8a00\u670d\u52a1\u5668\u4e2d\u5c06\u4f1a\u63d0\u4f9b\u76f8\u5e94\u7684\u529f\u80fd\u3002 \u6ce8\u610f \uff1a\u5982\u679c\u4f7f\u7528\u7684\u662f Go Modules \uff0c\u90a3\u4e48\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u5b83\u7684\u6027\u80fd\u8981\u6bd4\u4e0b\u9762\u7684\u5de5\u5177\u5f3a\u5f88\u591a\u3002 Go \u5de5\u5177 gocode \uff1a\u81ea\u52a8\u8865\u5168\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 go-outline \uff1a\u5728\u5f53\u524d\u6587\u4ef6\u4e2d\u8fdb\u884c\u53d8\u91cf\u641c\u7d22 go-symbols \uff1a\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u8fdb\u884c\u53d8\u91cf\u641c\u7d22 gopkgs \uff1a\u81ea\u52a8\u5bfc\u5165\u4f9d\u8d56\u7684\u5305 guru \uff1a\u67e5\u627e\u6240\u6709\u5f15\u7528 gorename \uff1a\u53d8\u91cf\u91cd\u547d\u540d goreturns \u6216\u8005 goimports \uff1a\u683c\u5f0f\u5316\u4ee3\u7801\uff08\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09\uff09 godef \u6216\u8005 gogetdoc \uff1a\u8df3\u8f6c\u5230\u5b9a\u4e49\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 godoc \u6216\u8005 gogetdoc \uff1a\u9f20\u6807\u60ac\u505c\u65f6\u663e\u793a\u6587\u6863\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 golint \u6216\u8005 gometalinter \u6216\u8005 megacheck \u6216\u8005 golangci-lint \u6216\u8005 revive \uff1a\u7528\u4e8e\u4ee3\u7801\u5206\u6790 dlv \uff1a\u7528\u4e8e\u8c03\u8bd5 \u5982\u679c\u5176\u4e2d\u7684\u67d0\u4e2a\u5de5\u5177\u7f3a\u5931\u65f6\uff0c\u5c06\u5728\u7f16\u8f91\u533a\u7684\u53f3\u4e0b\u89d2\u770b\u5230 Analysis Tools Missing \u7684\u8b66\u544a\u3002\u5355\u51fb\u8be5\u8b66\u544a\u65f6VSCode\u6216\u5e2e\u52a9\u5b89\u88c5\u7f3a\u5c11\u7684\u5de5\u5177\u3002 Go\u8bed\u8a00\u7684\u8fd9\u4e2a\u6269\u5c55\u7a0b\u5e8f\u8fd8\u6709\u5176\u4ed6\u7684\u529f\u80fd\uff0c\u867d\u7136\u4e0d\u662f\u6bcf\u5929\u90fd\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\u3002\u4f8b\u5982,\u751f\u6210\u5355\u5143\u6d4b\u8bd5\u3001\u751f\u6210\u63a5\u53e3\u7684 stub \u6216\u4fee\u6539 stub \u7684\u6807\u7b7e\u3002\u7528\u4e8e\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\u7684\u5de5\u5177\u5982\u4e0b\uff1a gomodifytags \uff1a\u4fee\u6539\u7ed3\u6784\u4f53\u7684\u6807\u7b7e goplay \uff1a\u5728 Go playground \u4e2d\u8fd0\u884c\u5f53\u524d\u6587\u4ef6 impl \uff1a\u751f\u6210\u63a5\u53e3\u7684 stub gotype-live \uff1a\u7ed9\u81ea\u5b9a\u4e49\u7c7b\u578b\u63d0\u4f9b\u8bca\u65ad gotests \uff1a\u751f\u6210\u5355\u5143\u6d4b\u8bd5 go-langserver \uff1a\u901a\u8fc7 Sourcegraph \u6765\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668 fillstruct \uff1a\u4f7f\u7528\u9ed8\u8ba4\u503c\u586b\u5145\u7ed3\u6784\u4f53\u4e2d\u53d8\u91cf \u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u547d\u4ee4 Go: Install/Update Tools \u7acb\u5373\u5b89\u88c5\u6240\u4ee5\u5de5\u5177\uff0c\u5982\u679c\u66f4\u6539\u4e86\u6b63\u5728\u4f7f\u7528\u7684Go\u7248\u672c\uff0c\u540c\u6837\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4\u4f7f\u5de5\u5177\u4fdd\u6301\u6700\u65b0\u7684\u540c\u65f6\u91cd\u65b0\u7f16\u8bd1\u3002 \u5982\u679c\u5e0c\u671b\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5355\u72ec\u7684 GOPATH \u6765\u5b58\u653e\u8fd9\u4e9bGo\u5de5\u5177\uff0c\u5728\u914d\u7f6e\u6587\u4ef6 setting.json \u7684 go.toolsGopath \u53c2\u6570\u4e2d\u8bbe\u7f6e\u5e0c\u671b\u7684\u5b58\u50a8\u8def\u5f84\u3002 \u5728\u5f53\u524d GOPATH \u4e2d\u624b\u52a8\u5b89\u88c5\u8fd9\u4e9b\u5de5\u5177\uff0c\u53ea\u8981\u62f7\u8d1d\u4e0b\u9762\u7684\u6307\u4ee4\u5e76\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u5373\u53ef: go get -u -v github.com/ramya-rao-a/go-outline go get -u -v github.com/acroca/go-symbols go get -u -v github.com/mdempsky/gocode go get -u -v github.com/rogpeppe/godef go get -u -v golang.org/x/tools/cmd/godoc go get -u -v github.com/zmb3/gogetdoc go get -u -v golang.org/x/lint/golint go get -u -v github.com/fatih/gomodifytags go get -u -v golang.org/x/tools/cmd/gorename go get -u -v sourcegraph.com/sqs/goreturns go get -u -v golang.org/x/tools/cmd/goimports go get -u -v github.com/cweill/gotests/... go get -u -v golang.org/x/tools/cmd/guru go get -u -v github.com/josharian/impl go get -u -v github.com/haya14busa/goplay/cmd/goplay go get -u -v github.com/uudashr/gopkgs/cmd/gopkgs go get -u -v github.com/davidrjenni/reftools/cmd/fillstruct go get -u -v github.com/alecthomas/gometalinter gometalinter --install \u5b89\u88c5\u8c03\u8bd5\u5de5\u5177\uff1a delve \u67e5\u770b\u8fd9\u7bc7 \u6307\u5357 \u3002 \u6309\u7167\u4e00\u4e0b\u6b65\u9aa4\u5728Linux\u7cfb\u7edf\u4e2d\u7f16\u8bd1\u548c\u5b89\u88c5\u8c03\u8bd5\uff1a \u65b9\u5f0f\u4e00\uff1a go get -u github.com/go-delve/delve/cmd/dlv \u65b9\u5f0f\u4e8c\uff1a \u9996\u5148\u4fdd\u8bc1 GOPATH \u73af\u5883\u53d8\u91cf\u5df2\u7ecf\u8bbe\u7f6e\u597d\u3002 git clone https://github.com/go-delve/delve.git $GOPATH/src/github.com/go-delve/delve cd $GOPATH/src/github.com/go-delve/delve make install \u6ce8\u610f\uff1a \u5982\u679c\u4f7f\u7528Go1.5\u7248\u672c\uff0c\u90a3\u4e48\u5fc5\u987b\u5148\u8bbe\u7f6eGO15VENDOREXPERIMENT=1`\u624d\u80fd\u7ee7\u7eed\u3002","title":"Go\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177"},{"location":"IDE/VSCode/06-\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177/#gogo","text":"VS Code\u7684Go\u6269\u5c55\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u5b89\u88c5\u5728 GOPATH \u4e2d\u7684\u5404\u79cdGo\u5de5\u5177\u3002 \u5176\u4e2d\u6709\u4e00\u4e9b\u5de5\u5177\u8d1f\u8d23\u901a\u7528\u7684\u7f16\u7a0b\u8bed\u8a00\u529f\u80fd\uff0c\u5982\uff1a \u4ee3\u7801\u5bfc\u822a \u81ea\u52a8\u8865\u5168 \u7b26\u53f7\u641c\u7d22 \u53e6\u5916\u7684\u4e00\u4e9b\u5de5\u5177\u5bf9Go\u6269\u5c55\u7a0b\u5e8f\u6765\u8bf4\u662f\u53ef\u9009\u7684\uff0c\u5b83\u4eec\u63d0\u4f9b\u65e5\u5e38\u7684\u8bed\u8a00\u652f\u6301\u3002 \u4ee5\u4e0b\u662fGo\u6269\u5c55\u7a0b\u5e8f\u7684\u5e38\u7528\u529f\u80fd\u5fc5\u987b\u7528\u5230\u7684\u5de5\u5177\u3002\u5982\u679c\u5df2\u7ecf\u9009\u62e9\u4f7f\u7528 Go\u8bed\u8a00\u7684\u670d\u52a1\u5668 \uff0c\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u4ee5\u4e0b\u5927\u90e8\u5206\u7684\u5de5\u5177\u4e86\uff0c\u56e0\u4e3a\u5728Go\u8bed\u8a00\u670d\u52a1\u5668\u4e2d\u5c06\u4f1a\u63d0\u4f9b\u76f8\u5e94\u7684\u529f\u80fd\u3002 \u6ce8\u610f \uff1a\u5982\u679c\u4f7f\u7528\u7684\u662f Go Modules \uff0c\u90a3\u4e48\u5f3a\u70c8\u5efa\u8bae\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u56e0\u4e3a\u5b83\u7684\u6027\u80fd\u8981\u6bd4\u4e0b\u9762\u7684\u5de5\u5177\u5f3a\u5f88\u591a\u3002","title":"Go\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177"},{"location":"IDE/VSCode/06-\u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177/#go","text":"gocode \uff1a\u81ea\u52a8\u8865\u5168\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 go-outline \uff1a\u5728\u5f53\u524d\u6587\u4ef6\u4e2d\u8fdb\u884c\u53d8\u91cf\u641c\u7d22 go-symbols \uff1a\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u8fdb\u884c\u53d8\u91cf\u641c\u7d22 gopkgs \uff1a\u81ea\u52a8\u5bfc\u5165\u4f9d\u8d56\u7684\u5305 guru \uff1a\u67e5\u627e\u6240\u6709\u5f15\u7528 gorename \uff1a\u53d8\u91cf\u91cd\u547d\u540d goreturns \u6216\u8005 goimports \uff1a\u683c\u5f0f\u5316\u4ee3\u7801\uff08\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09\uff09 godef \u6216\u8005 gogetdoc \uff1a\u8df3\u8f6c\u5230\u5b9a\u4e49\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 godoc \u6216\u8005 gogetdoc \uff1a\u9f20\u6807\u60ac\u505c\u65f6\u663e\u793a\u6587\u6863\uff08 \u5982\u679c\u4f7f\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5219\u4e0d\u9700\u8981\u8fd9\u4e2a\u5de5\u5177 \uff09 golint \u6216\u8005 gometalinter \u6216\u8005 megacheck \u6216\u8005 golangci-lint \u6216\u8005 revive \uff1a\u7528\u4e8e\u4ee3\u7801\u5206\u6790 dlv \uff1a\u7528\u4e8e\u8c03\u8bd5 \u5982\u679c\u5176\u4e2d\u7684\u67d0\u4e2a\u5de5\u5177\u7f3a\u5931\u65f6\uff0c\u5c06\u5728\u7f16\u8f91\u533a\u7684\u53f3\u4e0b\u89d2\u770b\u5230 Analysis Tools Missing \u7684\u8b66\u544a\u3002\u5355\u51fb\u8be5\u8b66\u544a\u65f6VSCode\u6216\u5e2e\u52a9\u5b89\u88c5\u7f3a\u5c11\u7684\u5de5\u5177\u3002 Go\u8bed\u8a00\u7684\u8fd9\u4e2a\u6269\u5c55\u7a0b\u5e8f\u8fd8\u6709\u5176\u4ed6\u7684\u529f\u80fd\uff0c\u867d\u7136\u4e0d\u662f\u6bcf\u5929\u90fd\u4f7f\u7528\u8fd9\u4e9b\u529f\u80fd\u3002\u4f8b\u5982,\u751f\u6210\u5355\u5143\u6d4b\u8bd5\u3001\u751f\u6210\u63a5\u53e3\u7684 stub \u6216\u4fee\u6539 stub \u7684\u6807\u7b7e\u3002\u7528\u4e8e\u5b9e\u73b0\u8fd9\u4e9b\u529f\u80fd\u7684\u5de5\u5177\u5982\u4e0b\uff1a gomodifytags \uff1a\u4fee\u6539\u7ed3\u6784\u4f53\u7684\u6807\u7b7e goplay \uff1a\u5728 Go playground \u4e2d\u8fd0\u884c\u5f53\u524d\u6587\u4ef6 impl \uff1a\u751f\u6210\u63a5\u53e3\u7684 stub gotype-live \uff1a\u7ed9\u81ea\u5b9a\u4e49\u7c7b\u578b\u63d0\u4f9b\u8bca\u65ad gotests \uff1a\u751f\u6210\u5355\u5143\u6d4b\u8bd5 go-langserver \uff1a\u901a\u8fc7 Sourcegraph \u6765\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668 fillstruct \uff1a\u4f7f\u7528\u9ed8\u8ba4\u503c\u586b\u5145\u7ed3\u6784\u4f53\u4e2d\u53d8\u91cf \u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u547d\u4ee4 Go: Install/Update Tools \u7acb\u5373\u5b89\u88c5\u6240\u4ee5\u5de5\u5177\uff0c\u5982\u679c\u66f4\u6539\u4e86\u6b63\u5728\u4f7f\u7528\u7684Go\u7248\u672c\uff0c\u540c\u6837\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4\u4f7f\u5de5\u5177\u4fdd\u6301\u6700\u65b0\u7684\u540c\u65f6\u91cd\u65b0\u7f16\u8bd1\u3002 \u5982\u679c\u5e0c\u671b\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5355\u72ec\u7684 GOPATH \u6765\u5b58\u653e\u8fd9\u4e9bGo\u5de5\u5177\uff0c\u5728\u914d\u7f6e\u6587\u4ef6 setting.json \u7684 go.toolsGopath \u53c2\u6570\u4e2d\u8bbe\u7f6e\u5e0c\u671b\u7684\u5b58\u50a8\u8def\u5f84\u3002 \u5728\u5f53\u524d GOPATH \u4e2d\u624b\u52a8\u5b89\u88c5\u8fd9\u4e9b\u5de5\u5177\uff0c\u53ea\u8981\u62f7\u8d1d\u4e0b\u9762\u7684\u6307\u4ee4\u5e76\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u5373\u53ef: go get -u -v github.com/ramya-rao-a/go-outline go get -u -v github.com/acroca/go-symbols go get -u -v github.com/mdempsky/gocode go get -u -v github.com/rogpeppe/godef go get -u -v golang.org/x/tools/cmd/godoc go get -u -v github.com/zmb3/gogetdoc go get -u -v golang.org/x/lint/golint go get -u -v github.com/fatih/gomodifytags go get -u -v golang.org/x/tools/cmd/gorename go get -u -v sourcegraph.com/sqs/goreturns go get -u -v golang.org/x/tools/cmd/goimports go get -u -v github.com/cweill/gotests/... go get -u -v golang.org/x/tools/cmd/guru go get -u -v github.com/josharian/impl go get -u -v github.com/haya14busa/goplay/cmd/goplay go get -u -v github.com/uudashr/gopkgs/cmd/gopkgs go get -u -v github.com/davidrjenni/reftools/cmd/fillstruct go get -u -v github.com/alecthomas/gometalinter gometalinter --install \u5b89\u88c5\u8c03\u8bd5\u5de5\u5177\uff1a delve \u67e5\u770b\u8fd9\u7bc7 \u6307\u5357 \u3002 \u6309\u7167\u4e00\u4e0b\u6b65\u9aa4\u5728Linux\u7cfb\u7edf\u4e2d\u7f16\u8bd1\u548c\u5b89\u88c5\u8c03\u8bd5\uff1a \u65b9\u5f0f\u4e00\uff1a go get -u github.com/go-delve/delve/cmd/dlv \u65b9\u5f0f\u4e8c\uff1a \u9996\u5148\u4fdd\u8bc1 GOPATH \u73af\u5883\u53d8\u91cf\u5df2\u7ecf\u8bbe\u7f6e\u597d\u3002 git clone https://github.com/go-delve/delve.git $GOPATH/src/github.com/go-delve/delve cd $GOPATH/src/github.com/go-delve/delve make install \u6ce8\u610f\uff1a \u5982\u679c\u4f7f\u7528Go1.5\u7248\u672c\uff0c\u90a3\u4e48\u5fc5\u987b\u5148\u8bbe\u7f6eGO15VENDOREXPERIMENT=1`\u624d\u80fd\u7ee7\u7eed\u3002","title":"Go \u5de5\u5177"},{"location":"IDE/VSCode/07-FAQ/","text":"FAQ \u5b89\u88c5\u4e86\u6269\u5c55\u7a0b\u5e8f\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c\uff1f \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u4e86\u6240\u6709\u4f9d\u8d56\u7684Go\u5de5\u5177\u3002\u6267\u884c Go: Install/Update Tools \u547d\u4ee4\u3002\u5982\u679c\u5e0c\u671b\u53ea\u662f\u5b89\u88c5\u6307\u5b9a\u7684\u5de5\u5177\uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177 \uff0c\u7136\u540e\u624b\u52a8\u5b89\u88c5\u9700\u8981\u7684\u5de5\u5177\u3002 \u5b89\u88c5\u5de5\u5177\u65f6\u663e\u793a git pull --ff-only \u9519\u8bef\uff1f \u6709\u53ef\u80fd\u65f6\u56e0\u4e3a\u6b63\u5728\u5b89\u88c5\u7684\u5de5\u5177\u5e93\u88ab\u5f3a\u5236push\uff0c\u5220\u9664\u76f8\u5173\u5de5\u5177\u5728 $GOPATH/src \uff08\u5982\u679c\u8bbe\u7f6e\u4e86 go.toolsGopath ,\u76f8\u5e94\u7684\u8def\u5f84\u4e5f\u9700\u8981\u68c0\u67e5\uff09\u4e2d\u7684\u6587\u4ef6\u5939\u7136\u540e\u91cd\u65b0\u5b89\u88c5\u3002 \u4e3a\u4ec0\u4e48\u5bfc\u5165\u7684\u8f6f\u4ef6\u5305\u4f1a\u88ab\u5220\u9664\u6216\u8005\u91cd\u65b0\u6392\u5e8f\uff1f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6269\u5c55\u7a0b\u5e8f\u4f1a\u683c\u5f0f\u5316\u4ee3\u7801\u5e76\u91cd\u65b0\u7ec4\u7ec7\u6bcf\u4e2a\u6587\u4ef6\u4e2d\u5bfc\u5165\u7684\u5305\uff08\u6dfb\u52a0\u7f3a\u5931\u7684\u5305\u3001\u5220\u9664\u672a\u7528\u7684\u5305\u3001\u91cd\u65b0\u6392\u5e8f\u5bfc\u5165\u5305\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u8bbe\u7f6e\u6765\u5173\u95ed\u6574\u4e2a\u529f\u80fd\u3002 \u5982\u679c\u6ca1\u6709\u4f7f\u7528 gopls \u8bed\u8a00\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u6dfb\u52a0 \"go.formatTools\": \"gofmt \u5230\u8bbe\u7f6e\u4e2d\u6765\u9009\u62e9\u4e00\u4e2a\u683c\u5f0f\u5316\u5de5\u5177\u6216\u8005\u7981\u7528\u5bfc\u5165\u65f6\u683c\u5f0f\u5316\u529f\u80fd\uff1a json \"[go]\": { \"editor.formatOnSave\": false } \u5982\u679c\u4f7f\u7528 gopls \u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u91cd\u65b0\u7ec4\u7ec7\u5bfc\u5165\u7684\u529f\u80fd\u5728\u683c\u5f0f\u5316\u8fdb\u7a0b\u4e4b\u5916\u6267\u884c\u3002\u8981\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7981\u7528\u6574\u4e2a\u529f\u80fd\uff0c\u6dfb\u52a0\u5982\u4e0b\u7684\u8bbe\u7f6e\uff1a json \"[go]\": { \"editor.codeActionsOnSave\": { \"source.organizeImports\": false } } \u4e3a\u4ec0\u4e48\u5728\u4fdd\u5b58\u6587\u4ef6\u65f6\uff0c\u7a7a\u683c\u88ab\u66ff\u6362\u4e3a\u5236\u8868\u7b26\uff1f \u56e0\u4e3a\u6b64\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684\u683c\u5f0f\u5316\u5de5\u5177 goreturns \uff0c goimports \u6216 gofmt \u90fd\u9075\u5faa\u4f7f\u7528\u5236\u8868\u7b26\u800c\u4e0d\u662f\u7a7a\u683c\u7684\u89c4\u5219\u3002 \u683c\u5f0f\u5316\u5de5\u5177\u4e2d\u4e00\u4e2a\u5236\u8868\u7b26\u7684\u5927\u5c0f\u662f\u5426\u4e3a8\uff1f \u5728VSCode\u4e2d\u5236\u8868\u7b26\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4\uff0c\u8981\u5728\u6bcf\u4e2aGo\u6587\u4ef6\u4e2d\u5c06\u5236\u8868\u7b26\u5927\u5c0f\u4fee\u6539\u4e3a8\uff0c\u90a3\u4e48\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a [go] : { editor.tabSize : 8 } \u6269\u5c55\u7a0b\u5e8f\u5982\u4f55\u786e\u5b9a\u8981\u4f7f\u7528\u7684 GOPATH ? \u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH \u3002 VSCode \u662f\u5426\u652f\u6301 Go Modules? \u67e5\u770b VSCode\u652f\u6301Go-Models \u3002 \u4f7f\u7528Go Modules\u65f6\uff0c\u4e3a\u4ec0\u4e48\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u5b8c\u6210\u901f\u5ea6\u4f1a\u53d8\u6162\uff1f \u67e5\u770b VSCode\u652f\u6301Go-Models \u3002 \u4f7f\u7528Go Modules\u65f6\u53ef\u4ee5\u53d7\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5417\uff1f \u67e5\u770b VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668 \u3002 \u5982\u4f55\u4ec5\u4ec5\u8fd0\u884c\u4ee3\u7801\u800c\u4e0d\u662f\u8c03\u8bd5\u4ee3\u7801\uff1f \u4f7f\u7528\u5feb\u6377\u952e Ctrl+F5 \u6216\u8005\u6267\u884c Debug: Start without Debugging \u547d\u4ee4\u3002 \u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u4f7f\u7528 go run \u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u3002\u56e0\u6b64\uff1a \u5982\u679c\u5df2\u7ecf\u6709\u4e00\u4e2a\u5e26\u6709\u9ed8\u8ba4\u914d\u7f6e\u7684 launch.json \u6587\u4ef6\uff0c\u8bf7\u5c06\u5176\u66f4\u65b0\u4e3a\u4f7f\u7528 ${file} \u800c\u4e0d\u662f ${fileDirname} \u5982\u679c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u8c03\u8bd5\u914d\u7f6e\uff0c\u8bf7\u914d\u7f6e\u7684\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u6587\u4ef6\u4e3a\u4e0d\u662f\u76ee\u5f55 \u5982\u679c\u7a0b\u5e8f\u5c5e\u6027\u4e2d\u6ca1\u6709\u6307\u5b9a\u6587\u4ef6\u8def\u5f84\uff0c\u90a3\u4e48 Start without Debugging \u547d\u4ee4\u5c06\u4f1a\u6062\u590d\u5230\u6b63\u5e38\u7684\u8c03\u8bd5\u3002 \u4e3a\u4ec0\u4e48\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684 GOPATH \u6ca1\u6709\u88ab\u63d2\u4ef6\u4f7f\u7528\uff1f\u4e3a\u4ec0\u4e48\u7a0b\u5e8f\u6ca1\u6709\u83b7\u53d6\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\uff1f \u6269\u5c55\u7a0b\u5e8f\u8fd0\u884c\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u8fdb\u7a0b\u4e2d\u800c\u4e0d\u662f\u5728\u7ec8\u7aef\u6216\u8005VSCode\u7a97\u53e3\u7684\u5176\u4ed6\u90e8\u5206\u3002\u56e0\u6b64\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u5bf9\u4e8e\u6269\u5c55\u7a0b\u5e8f\u65f6\u4e0d\u53ef\u89c1\u7684\u3002 \u5728\u54ea\u91cc\u53ef\u4ee5\u67e5\u770b\u5230\u6269\u5c55\u7a0b\u5e8f\u7684\u65e5\u5fd7\uff1f \u5728 View \u83dc\u5355\u4e2d\u9009\u62e9 Output ,\u5c06\u663e\u793a\u8f93\u51fa\u9762\u677f\u3002\u5728\u6b64\u9762\u677f\u7684\u53f3\u4e0a\u89d2\uff0c\u4ece\u4e0b\u62c9\u5217\u8868\u4e2d\u9009\u62e9 Log(Extension Host) \u3002 \u63d0\u793a\uff1a\u5982\u679c\u5728\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u540e\u67e5\u627e\u65e5\u5fd7\uff0c\u8bf7\u5148\u6e05\u9664\u65e5\u5fd7\u5e76\u518d\u6b21\u5c1d\u8bd5\u4ee5\u964d\u4f4e\u5176\u4ed6\u65e5\u5fd7\u7684\u5e72\u6270 \u3002 \u81ea\u52a8\u8865\u5168\u529f\u80fd\u4e0d\u751f\u6548\u4e86\uff0c\u548b\u6574\uff1f \u9996\u5148\u68c0\u67e5\u65e5\u5fd7\u4e2d\u7684\u9519\u8bef\u3002\uff08\u64cd\u4f5c\u95f4\u95ee\u989812\uff09 \u5982\u679c\u6b63\u5728\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b65\u4e2d\u7684\u8f93\u51fa\u7a97\u53e3\u9762\u677f\u7684\u4e0b\u62c9\u5e26\u5355\u4e2d\u6709\u4e0e\u4e00\u4e2a\u5173\u4e8e\u8bed\u8a00\u670d\u52a1\u5668\u7684\u6761\u76ee\uff0c\u9009\u62e9\u5e76\u67e5\u770b\u5b83\u7684\u8f93\u51fa\u3002 \u5982\u679c\u6ca1\u6709\u6ca1\u6709\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c \u5e76\u4e14\u8fd9\u662f\u7b2c\u4e09\u65b9\u7684\u5305\uff0c\u9996\u5148\u786e\u5b9a\u662f\u5426\u5b89\u88c5\u4e86\u3002\u53ef\u4ee5\u901a\u8fc7\u6267\u884c Go: Build Current Package \u547d\u4ee4\uff0c\u8fd9\u6837\u5c06\u4f1a\u5b89\u88c5\u6240\u6709\u7684\u4f9d\u8d56\uff0c\u540e\u8005\u624b\u52a8\u5b89\u88c5\u6240\u6709\u7684\u4f9d\u8d56\u901a\u8fc7\u547d\u4ee4 go install \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u5728\u7ec8\u7aef\u4e2d\u6267\u884c gocode close \u6216\u8005 gocode exit \u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u6267\u884c Go: Install/Updata Tools ,\u9009\u62e9 gocode \u6765\u66f4\u65b0\u8fd9\u4e9b\u5de5\u5177\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u5728\u7ec8\u7aef\u4e2d\u6267\u884c gocode -s -debug \u540e\u7acb\u5373\u6267\u884c gocode close \u6216\u8005 gocode exit \u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002 gocode \u7684\u7ed3\u679c\u5c06\u8f93\u51fa\u518d\u7ec8\u7aef\u4e2d\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u518d\u7ec8\u7aef\u4e2d\u770b\u5230\u9884\u671f\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u5728VSCode\u4e2d\u6ca1\u6709\u9884\u671f\u7684\u7ed3\u679c\uff0c\u90a3\u4e48\u5728 vscode-go\u7684\u4ed3\u5e93 \u548c gocode\u7684\u4ed3\u5e93 \u4e2d\u5f00\u4e00\u4e2a issue \u3002\u5982\u679c\u4f7f\u7528 Go Modules \u5728 \u8fd9\u91cc \u4e2d\u5f00\u4e00\u4e2a issue \u3002 \u4e3a\u4ec0\u4e48\u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u683c\u5f0f\u5316\u4e0d\u751f\u6548\uff1f \u67e5\u770b\u65e5\u5fd7\uff08\u64cd\u4f5c\u89c1\u95ee\u989812\uff09\uff0c\u5177\u4f53\u7684\u6d88\u606f\u5982 \"Formatting took too long\" \u6216\u8005 Format On Save feature could be aborted \u3002\u5982\u679c\u770b\u5230\u6b64\u7c7b\u6d88\u606f\uff0c\u5f88\u5927\u6982\u7387\u56e0\u4e3a\u683c\u5f0f\u5316\u82b1\u592a\u957f\u65f6\u95f4\u800c\u88ab\u4e2d\u6b62\uff0c\u8fd9\u5f71\u54cd\u5230\u4e86\u4fdd\u5b58\u4f53\u9a8c\u3002\u53ef\u4ee5\u8bbe\u7f6e editor.formatOnSaveTimeout \u6765\u63a7\u5236\u8d85\u65f6\u53c2\u6570\u3002 \u5bfc\u5165\u7684\u5305\u6709\u7ea2\u8272\u7684\u4e0b\u5212\u7ebf\u663e\u793a\u201c\u5305\u672a\u627e\u5230\u201d\uff1f \u8fd9\u4e9b\u662f\u6784\u5efa\u9519\u8bef\uff0c\u70b9\u51fb View - Output - \u4ece\u9762\u677f\u53f3\u4e0a\u89d2\u7684\u4e0b\u62c9\u83dc\u5355\u4e2d\u9009\u62e9 go \u3002\u7136\u540e\u5c31\u53ef\u4ee5\u770b\u5230 go build \u7684\u8f93\u51fa\uff08\u6216\u8005\u662f go test \u7684\u8f93\u51fa\uff0c\u5982\u679c\u5f53\u524d\u6587\u4ef6\u65f6\u6d4b\u8bd5\u6587\u4ef6\uff09\u3002\u5c06 go build \u547d\u4ee4\u548c\u53c2\u6570\u4e00\u8d77\u62f7\u8d1d\u540e\u5c1d\u8bd5\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u3002\u5982\u679c\u4ecd\u7136\u770b\u5230\u76f8\u540c\u7684\u9519\u8bef\uff0c\u90a3\u4e48\u95ee\u9898\u5728\u4e8e GOPATH \u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5b83\u8fd0\u884c\u6b63\u5e38\uff0c\u90a3\u4e48\u63d0\u4ea4\u4e00\u4e2a issue \u3002 \u5982\u4f55\u83b7\u53d6\u5df2\u5b9e\u73b0\u4f46\u5c1a\u672a\u53d1\u5e03\u7684\u529f\u80fd/\u9519\u8bef\u4fee\u590d\u7a0b\u5e8f\uff1f\u5982\u4f55\u83b7\u5f97Go\u6269\u5c55\u7684\u6d4b\u8bd5\u7248\uff1f \u67e5\u770b \u5b89\u88c5\u6d4b\u8bd5\u7248\u672c","title":"FAQ"},{"location":"IDE/VSCode/07-FAQ/#faq","text":"\u5b89\u88c5\u4e86\u6269\u5c55\u7a0b\u5e8f\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u529f\u80fd\u6b63\u5e38\u5de5\u4f5c\uff1f \u68c0\u67e5\u662f\u5426\u5b89\u88c5\u4e86\u6240\u6709\u4f9d\u8d56\u7684Go\u5de5\u5177\u3002\u6267\u884c Go: Install/Update Tools \u547d\u4ee4\u3002\u5982\u679c\u5e0c\u671b\u53ea\u662f\u5b89\u88c5\u6307\u5b9a\u7684\u5de5\u5177\uff0c\u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4f9d\u8d56\u7684Go\u5de5\u5177 \uff0c\u7136\u540e\u624b\u52a8\u5b89\u88c5\u9700\u8981\u7684\u5de5\u5177\u3002 \u5b89\u88c5\u5de5\u5177\u65f6\u663e\u793a git pull --ff-only \u9519\u8bef\uff1f \u6709\u53ef\u80fd\u65f6\u56e0\u4e3a\u6b63\u5728\u5b89\u88c5\u7684\u5de5\u5177\u5e93\u88ab\u5f3a\u5236push\uff0c\u5220\u9664\u76f8\u5173\u5de5\u5177\u5728 $GOPATH/src \uff08\u5982\u679c\u8bbe\u7f6e\u4e86 go.toolsGopath ,\u76f8\u5e94\u7684\u8def\u5f84\u4e5f\u9700\u8981\u68c0\u67e5\uff09\u4e2d\u7684\u6587\u4ef6\u5939\u7136\u540e\u91cd\u65b0\u5b89\u88c5\u3002 \u4e3a\u4ec0\u4e48\u5bfc\u5165\u7684\u8f6f\u4ef6\u5305\u4f1a\u88ab\u5220\u9664\u6216\u8005\u91cd\u65b0\u6392\u5e8f\uff1f \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6269\u5c55\u7a0b\u5e8f\u4f1a\u683c\u5f0f\u5316\u4ee3\u7801\u5e76\u91cd\u65b0\u7ec4\u7ec7\u6bcf\u4e2a\u6587\u4ef6\u4e2d\u5bfc\u5165\u7684\u5305\uff08\u6dfb\u52a0\u7f3a\u5931\u7684\u5305\u3001\u5220\u9664\u672a\u7528\u7684\u5305\u3001\u91cd\u65b0\u6392\u5e8f\u5bfc\u5165\u5305\uff09\u3002\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u8bbe\u7f6e\u6765\u5173\u95ed\u6574\u4e2a\u529f\u80fd\u3002 \u5982\u679c\u6ca1\u6709\u4f7f\u7528 gopls \u8bed\u8a00\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u6dfb\u52a0 \"go.formatTools\": \"gofmt \u5230\u8bbe\u7f6e\u4e2d\u6765\u9009\u62e9\u4e00\u4e2a\u683c\u5f0f\u5316\u5de5\u5177\u6216\u8005\u7981\u7528\u5bfc\u5165\u65f6\u683c\u5f0f\u5316\u529f\u80fd\uff1a json \"[go]\": { \"editor.formatOnSave\": false } \u5982\u679c\u4f7f\u7528 gopls \u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u91cd\u65b0\u7ec4\u7ec7\u5bfc\u5165\u7684\u529f\u80fd\u5728\u683c\u5f0f\u5316\u8fdb\u7a0b\u4e4b\u5916\u6267\u884c\u3002\u8981\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7981\u7528\u6574\u4e2a\u529f\u80fd\uff0c\u6dfb\u52a0\u5982\u4e0b\u7684\u8bbe\u7f6e\uff1a json \"[go]\": { \"editor.codeActionsOnSave\": { \"source.organizeImports\": false } } \u4e3a\u4ec0\u4e48\u5728\u4fdd\u5b58\u6587\u4ef6\u65f6\uff0c\u7a7a\u683c\u88ab\u66ff\u6362\u4e3a\u5236\u8868\u7b26\uff1f \u56e0\u4e3a\u6b64\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684\u683c\u5f0f\u5316\u5de5\u5177 goreturns \uff0c goimports \u6216 gofmt \u90fd\u9075\u5faa\u4f7f\u7528\u5236\u8868\u7b26\u800c\u4e0d\u662f\u7a7a\u683c\u7684\u89c4\u5219\u3002 \u683c\u5f0f\u5316\u5de5\u5177\u4e2d\u4e00\u4e2a\u5236\u8868\u7b26\u7684\u5927\u5c0f\u662f\u5426\u4e3a8\uff1f \u5728VSCode\u4e2d\u5236\u8868\u7b26\u7684\u9ed8\u8ba4\u5927\u5c0f\u662f4\uff0c\u8981\u5728\u6bcf\u4e2aGo\u6587\u4ef6\u4e2d\u5c06\u5236\u8868\u7b26\u5927\u5c0f\u4fee\u6539\u4e3a8\uff0c\u90a3\u4e48\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a [go] : { editor.tabSize : 8 } \u6269\u5c55\u7a0b\u5e8f\u5982\u4f55\u786e\u5b9a\u8981\u4f7f\u7528\u7684 GOPATH ? \u67e5\u770b \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH \u3002 VSCode \u662f\u5426\u652f\u6301 Go Modules? \u67e5\u770b VSCode\u652f\u6301Go-Models \u3002 \u4f7f\u7528Go Modules\u65f6\uff0c\u4e3a\u4ec0\u4e48\u4ee3\u7801\u5bfc\u822a\u548c\u4ee3\u7801\u5b8c\u6210\u901f\u5ea6\u4f1a\u53d8\u6162\uff1f \u67e5\u770b VSCode\u652f\u6301Go-Models \u3002 \u4f7f\u7528Go Modules\u65f6\u53ef\u4ee5\u53d7\u7528\u8bed\u8a00\u670d\u52a1\u5668\u5417\uff1f \u67e5\u770b VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668 \u3002 \u5982\u4f55\u4ec5\u4ec5\u8fd0\u884c\u4ee3\u7801\u800c\u4e0d\u662f\u8c03\u8bd5\u4ee3\u7801\uff1f \u4f7f\u7528\u5feb\u6377\u952e Ctrl+F5 \u6216\u8005\u6267\u884c Debug: Start without Debugging \u547d\u4ee4\u3002 \u5728\u8fd9\u79cd\u573a\u666f\u4e0b\uff0c\u6211\u4eec\u4f7f\u7528 go run \u6307\u5b9a\u4e00\u4e2a\u6587\u4ef6\u8def\u5f84\u3002\u56e0\u6b64\uff1a \u5982\u679c\u5df2\u7ecf\u6709\u4e00\u4e2a\u5e26\u6709\u9ed8\u8ba4\u914d\u7f6e\u7684 launch.json \u6587\u4ef6\uff0c\u8bf7\u5c06\u5176\u66f4\u65b0\u4e3a\u4f7f\u7528 ${file} \u800c\u4e0d\u662f ${fileDirname} \u5982\u679c\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u8c03\u8bd5\u914d\u7f6e\uff0c\u8bf7\u914d\u7f6e\u7684\u7a0b\u5e8f\u5c5e\u6027\u6307\u5411\u6587\u4ef6\u4e3a\u4e0d\u662f\u76ee\u5f55 \u5982\u679c\u7a0b\u5e8f\u5c5e\u6027\u4e2d\u6ca1\u6709\u6307\u5b9a\u6587\u4ef6\u8def\u5f84\uff0c\u90a3\u4e48 Start without Debugging \u547d\u4ee4\u5c06\u4f1a\u6062\u590d\u5230\u6b63\u5e38\u7684\u8c03\u8bd5\u3002 \u4e3a\u4ec0\u4e48\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684 GOPATH \u6ca1\u6709\u88ab\u63d2\u4ef6\u4f7f\u7528\uff1f\u4e3a\u4ec0\u4e48\u7a0b\u5e8f\u6ca1\u6709\u83b7\u53d6\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\uff1f \u6269\u5c55\u7a0b\u5e8f\u8fd0\u884c\u5728\u4e00\u4e2a\u72ec\u7acb\u7684\u8fdb\u7a0b\u4e2d\u800c\u4e0d\u662f\u5728\u7ec8\u7aef\u6216\u8005VSCode\u7a97\u53e3\u7684\u5176\u4ed6\u90e8\u5206\u3002\u56e0\u6b64\u5728\u7ec8\u7aef\u4e2d\u8bbe\u7f6e\u7684\u73af\u5883\u53d8\u91cf\u5bf9\u4e8e\u6269\u5c55\u7a0b\u5e8f\u65f6\u4e0d\u53ef\u89c1\u7684\u3002 \u5728\u54ea\u91cc\u53ef\u4ee5\u67e5\u770b\u5230\u6269\u5c55\u7a0b\u5e8f\u7684\u65e5\u5fd7\uff1f \u5728 View \u83dc\u5355\u4e2d\u9009\u62e9 Output ,\u5c06\u663e\u793a\u8f93\u51fa\u9762\u677f\u3002\u5728\u6b64\u9762\u677f\u7684\u53f3\u4e0a\u89d2\uff0c\u4ece\u4e0b\u62c9\u5217\u8868\u4e2d\u9009\u62e9 Log(Extension Host) \u3002 \u63d0\u793a\uff1a\u5982\u679c\u5728\u6267\u884c\u7279\u5b9a\u64cd\u4f5c\u540e\u67e5\u627e\u65e5\u5fd7\uff0c\u8bf7\u5148\u6e05\u9664\u65e5\u5fd7\u5e76\u518d\u6b21\u5c1d\u8bd5\u4ee5\u964d\u4f4e\u5176\u4ed6\u65e5\u5fd7\u7684\u5e72\u6270 \u3002 \u81ea\u52a8\u8865\u5168\u529f\u80fd\u4e0d\u751f\u6548\u4e86\uff0c\u548b\u6574\uff1f \u9996\u5148\u68c0\u67e5\u65e5\u5fd7\u4e2d\u7684\u9519\u8bef\u3002\uff08\u64cd\u4f5c\u95f4\u95ee\u989812\uff09 \u5982\u679c\u6b63\u5728\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u4e0a\u4e00\u6b65\u4e2d\u7684\u8f93\u51fa\u7a97\u53e3\u9762\u677f\u7684\u4e0b\u62c9\u5e26\u5355\u4e2d\u6709\u4e0e\u4e00\u4e2a\u5173\u4e8e\u8bed\u8a00\u670d\u52a1\u5668\u7684\u6761\u76ee\uff0c\u9009\u62e9\u5e76\u67e5\u770b\u5b83\u7684\u8f93\u51fa\u3002 \u5982\u679c\u6ca1\u6709\u6ca1\u6709\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668\uff0c \u5e76\u4e14\u8fd9\u662f\u7b2c\u4e09\u65b9\u7684\u5305\uff0c\u9996\u5148\u786e\u5b9a\u662f\u5426\u5b89\u88c5\u4e86\u3002\u53ef\u4ee5\u901a\u8fc7\u6267\u884c Go: Build Current Package \u547d\u4ee4\uff0c\u8fd9\u6837\u5c06\u4f1a\u5b89\u88c5\u6240\u6709\u7684\u4f9d\u8d56\uff0c\u540e\u8005\u624b\u52a8\u5b89\u88c5\u6240\u6709\u7684\u4f9d\u8d56\u901a\u8fc7\u547d\u4ee4 go install \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u5728\u7ec8\u7aef\u4e2d\u6267\u884c gocode close \u6216\u8005 gocode exit \u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u6267\u884c Go: Install/Updata Tools ,\u9009\u62e9 gocode \u6765\u66f4\u65b0\u8fd9\u4e9b\u5de5\u5177\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u4f9d\u7136\u4e0d\u8d77\u4f5c\u7528\uff0c\u5728\u7ec8\u7aef\u4e2d\u6267\u884c gocode -s -debug \u540e\u7acb\u5373\u6267\u884c gocode close \u6216\u8005 gocode exit \u7136\u540e\u518d\u8bd5\u4e00\u6b21\u3002 gocode \u7684\u7ed3\u679c\u5c06\u8f93\u51fa\u518d\u7ec8\u7aef\u4e2d\u3002\u5982\u679c\u4f7f\u7528 Go Modules \uff0c\u90a3\u4e48\u4f7f\u7528 gocode-gomod \u800c\u4e0d\u662f gocode \u3002 \u5982\u679c\u518d\u7ec8\u7aef\u4e2d\u770b\u5230\u9884\u671f\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u5728VSCode\u4e2d\u6ca1\u6709\u9884\u671f\u7684\u7ed3\u679c\uff0c\u90a3\u4e48\u5728 vscode-go\u7684\u4ed3\u5e93 \u548c gocode\u7684\u4ed3\u5e93 \u4e2d\u5f00\u4e00\u4e2a issue \u3002\u5982\u679c\u4f7f\u7528 Go Modules \u5728 \u8fd9\u91cc \u4e2d\u5f00\u4e00\u4e2a issue \u3002 \u4e3a\u4ec0\u4e48\u5728\u6587\u4ef6\u4fdd\u5b58\u65f6\u683c\u5f0f\u5316\u4e0d\u751f\u6548\uff1f \u67e5\u770b\u65e5\u5fd7\uff08\u64cd\u4f5c\u89c1\u95ee\u989812\uff09\uff0c\u5177\u4f53\u7684\u6d88\u606f\u5982 \"Formatting took too long\" \u6216\u8005 Format On Save feature could be aborted \u3002\u5982\u679c\u770b\u5230\u6b64\u7c7b\u6d88\u606f\uff0c\u5f88\u5927\u6982\u7387\u56e0\u4e3a\u683c\u5f0f\u5316\u82b1\u592a\u957f\u65f6\u95f4\u800c\u88ab\u4e2d\u6b62\uff0c\u8fd9\u5f71\u54cd\u5230\u4e86\u4fdd\u5b58\u4f53\u9a8c\u3002\u53ef\u4ee5\u8bbe\u7f6e editor.formatOnSaveTimeout \u6765\u63a7\u5236\u8d85\u65f6\u53c2\u6570\u3002 \u5bfc\u5165\u7684\u5305\u6709\u7ea2\u8272\u7684\u4e0b\u5212\u7ebf\u663e\u793a\u201c\u5305\u672a\u627e\u5230\u201d\uff1f \u8fd9\u4e9b\u662f\u6784\u5efa\u9519\u8bef\uff0c\u70b9\u51fb View - Output - \u4ece\u9762\u677f\u53f3\u4e0a\u89d2\u7684\u4e0b\u62c9\u83dc\u5355\u4e2d\u9009\u62e9 go \u3002\u7136\u540e\u5c31\u53ef\u4ee5\u770b\u5230 go build \u7684\u8f93\u51fa\uff08\u6216\u8005\u662f go test \u7684\u8f93\u51fa\uff0c\u5982\u679c\u5f53\u524d\u6587\u4ef6\u65f6\u6d4b\u8bd5\u6587\u4ef6\uff09\u3002\u5c06 go build \u547d\u4ee4\u548c\u53c2\u6570\u4e00\u8d77\u62f7\u8d1d\u540e\u5c1d\u8bd5\u5728\u7ec8\u7aef\u4e2d\u8fd0\u884c\u3002\u5982\u679c\u4ecd\u7136\u770b\u5230\u76f8\u540c\u7684\u9519\u8bef\uff0c\u90a3\u4e48\u95ee\u9898\u5728\u4e8e GOPATH \u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5b83\u8fd0\u884c\u6b63\u5e38\uff0c\u90a3\u4e48\u63d0\u4ea4\u4e00\u4e2a issue \u3002 \u5982\u4f55\u83b7\u53d6\u5df2\u5b9e\u73b0\u4f46\u5c1a\u672a\u53d1\u5e03\u7684\u529f\u80fd/\u9519\u8bef\u4fee\u590d\u7a0b\u5e8f\uff1f\u5982\u4f55\u83b7\u5f97Go\u6269\u5c55\u7684\u6d4b\u8bd5\u7248\uff1f \u67e5\u770b \u5b89\u88c5\u6d4b\u8bd5\u7248\u672c","title":"FAQ"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/","text":"Go \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e GOPATH \u5728\u4efb\u4f55\u4f7f\u7528\u90fd\u53ef\u4ee5\u4f7f\u7528 Go: Current GOPATH \u547d\u4ee4\u6765\u67e5\u770b\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684 GOPATH \u3002 \u4ece\u73af\u5883\u53d8\u91cf\u83b7\u5f97 GOPATH \u5f00\u7bb1\u5373\u7528\uff0c\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u73af\u5883\u53d8\u91cf GOPATH \u4e2d\u8bbe\u7f6e\u7684\u503c\u3002\u4eceGo1.8\u7248\u672c\u5f00\u59cb\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u90a3\u4e48\u4f1a\u4f7f\u7528 go env \u4e2d\u63cf\u8ff0\u7684 GOPATH \u503c\u3002 \u901a\u8fc7 go.gopath \u8bbe\u7f6e GOPATH \u5728 \u7528\u6237\u8bbe\u7f6e \u4e2d\u8bbe\u7f6e go.gopath \u4f1a\u8986\u76d6\u4ece\u4e0a\u9762\u7684\u903b\u8f91\u4e2d\u6d3e\u751f\u7684 GOPATH \u3002 \u5728 \u5de5\u4f5c\u7a7a\u95f4 \u4e2d\u8bbe\u7f6e go.gopath \u4f1a\u8986\u76d6\u7528\u6237\u8bbe\u7f6e\u4e2d\u7684 go.gopath \u3002\u53ef\u4ee5\u5728\u6b64\u6587\u4ef6\u4e2d\u5c06\u591a\u4e2a\u6587\u4ef6\u5939\u76ee\u5f55\u8bbe\u7f6e\u4e3a GOPATH \u3002 \u6ce8\u610f\uff0c\u591a\u4e2a\u76ee\u5f55\u4e4b\u95f4\u4f7f\u7528 : \u5206\u9694\uff08\u5728window\u7cfb\u7edf\u4e2d\u4f7f\u7528 ; \u5206\u9694\uff09 \u3002 \u901a\u8fc7 go.inferGopath \u8bbe\u7f6e GOPATH \u8bbe\u7f6e go.interGopath \u4f1a\u8986\u76d6\u5728 go.gopath \u4e2d\u8bbe\u7f6e\u7684\u503c\u3002 \u5982\u679c go.inferGopath \u8bbe\u7f6e\u4e3a true ,\u90a3\u4e48\u6269\u5c55\u7a0b\u5e8f\u5c06\u4f1a\u5c1d\u8bd5\u4ece\u5de5\u4f5c\u7a7a\u95f4\uff08\u4f8b\u5982\uff0cVSCode\u4e2d\u6253\u5f00\u7684\u76ee\u5f55\uff09\u7684\u8def\u5f84\u4e2d\u63a8\u65ad GOPATH \u3002\u6269\u5c55\u7a0b\u5e8f\u4f1a\u4ece src \u76ee\u5f55\u7684\u8def\u5f84\u5f00\u59cb\u5411\u4e0a\u641c\u7d22\uff0c\u5e76\u5c06 GOPATH \u8bbe\u7f6e\u4e3a\u9ad8\u4e8e\u8be5\u76ee\u5f55\u7684\u4e00\u4e2a\u7ea7\u522b\uff0c\u5176\u4e2d\u4e5f\u5305\u62ec\u5168\u5c40\u7684 GOPATH \u3002 \u8fd0\u884c\u547d\u4ee4 go env GOPATH \u6765\u67e5\u627e\u5168\u5c40\u7684 GOPATH \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u9879\u76ee\u662f\u8fd9\u6837\u7684 /aaa/bbb/ccc/src/... ,\u90a3\u4e48\u6253\u5f00\u76ee\u5f55 /aaa/bbb/ccc/src \u6216\u8005\u5176\u4e2d\u7684\u4efb\u4f55\u5b50\u5185\u5bb9\uff0c\u90fd\u5c06\u4f1a\u5bfc\u81f4\u6269\u5c55\u7a0b\u5e8f\u81ea\u52a8\u5411\u4e0a\u641c\u7d22\uff0c\u5728\u8def\u5f84\u4e2d\u627e\u5230 src \u76ee\u5f55\uff0c\u7136\u540e\u5c06 GOPATH \u8bbe\u7f6e\u4e3a\u9ad8\u4e8e\u5b83\u4e00\u4e2a\u7ea7\u522b\u7684\u503c\uff0c\u5373 GOPATH=/aaa/bbb/ccc \u5f53\u5904\u7406\u5177\u6709\u4e0d\u540c GOPATH \u7684Go\u9879\u76ee\u65f6\uff0c\u8fd9\u4e2a\u8bbe\u7f6e\u975e\u5e38\u6709\u7528\u3002 \u4e0d\u9700\u8981\u5728\u6bcf\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u8bbe\u7f6e GOPATH \uff0c\u4e5f\u4e0d\u9700\u8981\u5728\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u8bbe\u7f6e\u5168\u90e8\u7684\u76ee\u5f55\u7136\u540e\u7528 : \u6216 ; \u6765\u5206\u9694\u3002 \u53ea\u9700\u8981\u5c06 go.inferGopath \u8bbe\u7f6e\u4e3a true \uff0c\u6269\u5c55\u7a0b\u5e8f\u5c31\u4f1a\u81ea\u52a8\u641c\u7d22\u5e76\u4f7f\u7528\u6b63\u786e\u7684 GOPATH \u3002 \u901a\u8fc7 go.toolsGopath \u8bbe\u7f6eGo\u5de5\u5177\u7684 GOPATH \u4f7f\u7528 go get \u547d\u4ee4\u5728 GOPATH \u4e2d\u5b89\u88c5Go\u5de5\u5177\uff0c\u8981\u9632\u6b62Go\u5de5\u5177\u6270\u4e71 GOPATH ,\u53ef\u4ee5\u4f7f\u7528 go.toolsGopath \u8bbe\u7f6e\u6765\u63d0\u4f9b\u5355\u72ec\u7684 GOPATH \u4ec5\u7528\u4e8eGo\u5de5\u5177\u3002 \u7b2c\u4e00\u6b21\u8bbe\u7f6e go.toolsGopath \u65f6\uff0c\u9700\u8981\u8fd0\u884c GO: Install/Update Tools \u547d\u4ee4\uff0c\u8fd9\u6837Go\u5de5\u5177\u5c31\u80fd\u591f\u5b89\u88c5\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e\u3002 \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e go.toolsGopath \u6216\u8005\u5728\u5b83\u6307\u5b9a\u7684\u4f4d\u7f6e\u6ca1\u6709\u627e\u5230Go\u5de5\u5177\uff0c\u90a3\u4e48\u4f1a\u4f7f\u7528\u4e0a\u9762\u51e0\u8282\u4e2d\u63cf\u8ff0\u7684\u903b\u8f91\u6765\u627e GOPATH \u4e2d\u7684Go\u5de5\u5177\u3002\u5982\u679c\u5728\u90a3\u91cc\u4e5f\u6ca1\u6709\u627e\u5230Go\u5de5\u5177\uff0c\u90a3\u4e48\u5c31\u4f1a\u5728\u8def\u5f84\u627e\u4e2d\u67e5\u627e\uff0c\u8fd9\u4e9b\u8def\u5f84\u65f6 PATH \u73af\u5883\u53d8\u91cf\u7684\u4e00\u90e8\u5206\u3002","title":"Go \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6e`GOPATH`"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/#go-gopath","text":"\u5728\u4efb\u4f55\u4f7f\u7528\u90fd\u53ef\u4ee5\u4f7f\u7528 Go: Current GOPATH \u547d\u4ee4\u6765\u67e5\u770b\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684 GOPATH \u3002","title":"Go \u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/#gopath","text":"\u5f00\u7bb1\u5373\u7528\uff0c\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u73af\u5883\u53d8\u91cf GOPATH \u4e2d\u8bbe\u7f6e\u7684\u503c\u3002\u4eceGo1.8\u7248\u672c\u5f00\u59cb\uff0c\u5982\u679c\u6ca1\u6709\u8bbe\u7f6e\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u90a3\u4e48\u4f1a\u4f7f\u7528 go env \u4e2d\u63cf\u8ff0\u7684 GOPATH \u503c\u3002","title":"\u4ece\u73af\u5883\u53d8\u91cf\u83b7\u5f97GOPATH"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/#gogopathgopath","text":"\u5728 \u7528\u6237\u8bbe\u7f6e \u4e2d\u8bbe\u7f6e go.gopath \u4f1a\u8986\u76d6\u4ece\u4e0a\u9762\u7684\u903b\u8f91\u4e2d\u6d3e\u751f\u7684 GOPATH \u3002 \u5728 \u5de5\u4f5c\u7a7a\u95f4 \u4e2d\u8bbe\u7f6e go.gopath \u4f1a\u8986\u76d6\u7528\u6237\u8bbe\u7f6e\u4e2d\u7684 go.gopath \u3002\u53ef\u4ee5\u5728\u6b64\u6587\u4ef6\u4e2d\u5c06\u591a\u4e2a\u6587\u4ef6\u5939\u76ee\u5f55\u8bbe\u7f6e\u4e3a GOPATH \u3002 \u6ce8\u610f\uff0c\u591a\u4e2a\u76ee\u5f55\u4e4b\u95f4\u4f7f\u7528 : \u5206\u9694\uff08\u5728window\u7cfb\u7edf\u4e2d\u4f7f\u7528 ; \u5206\u9694\uff09 \u3002","title":"\u901a\u8fc7go.gopath\u8bbe\u7f6eGOPATH"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/#goinfergopathgopath","text":"\u8bbe\u7f6e go.interGopath \u4f1a\u8986\u76d6\u5728 go.gopath \u4e2d\u8bbe\u7f6e\u7684\u503c\u3002 \u5982\u679c go.inferGopath \u8bbe\u7f6e\u4e3a true ,\u90a3\u4e48\u6269\u5c55\u7a0b\u5e8f\u5c06\u4f1a\u5c1d\u8bd5\u4ece\u5de5\u4f5c\u7a7a\u95f4\uff08\u4f8b\u5982\uff0cVSCode\u4e2d\u6253\u5f00\u7684\u76ee\u5f55\uff09\u7684\u8def\u5f84\u4e2d\u63a8\u65ad GOPATH \u3002\u6269\u5c55\u7a0b\u5e8f\u4f1a\u4ece src \u76ee\u5f55\u7684\u8def\u5f84\u5f00\u59cb\u5411\u4e0a\u641c\u7d22\uff0c\u5e76\u5c06 GOPATH \u8bbe\u7f6e\u4e3a\u9ad8\u4e8e\u8be5\u76ee\u5f55\u7684\u4e00\u4e2a\u7ea7\u522b\uff0c\u5176\u4e2d\u4e5f\u5305\u62ec\u5168\u5c40\u7684 GOPATH \u3002 \u8fd0\u884c\u547d\u4ee4 go env GOPATH \u6765\u67e5\u627e\u5168\u5c40\u7684 GOPATH \u3002 \u4f8b\u5982\uff0c\u5982\u679c\u9879\u76ee\u662f\u8fd9\u6837\u7684 /aaa/bbb/ccc/src/... ,\u90a3\u4e48\u6253\u5f00\u76ee\u5f55 /aaa/bbb/ccc/src \u6216\u8005\u5176\u4e2d\u7684\u4efb\u4f55\u5b50\u5185\u5bb9\uff0c\u90fd\u5c06\u4f1a\u5bfc\u81f4\u6269\u5c55\u7a0b\u5e8f\u81ea\u52a8\u5411\u4e0a\u641c\u7d22\uff0c\u5728\u8def\u5f84\u4e2d\u627e\u5230 src \u76ee\u5f55\uff0c\u7136\u540e\u5c06 GOPATH \u8bbe\u7f6e\u4e3a\u9ad8\u4e8e\u5b83\u4e00\u4e2a\u7ea7\u522b\u7684\u503c\uff0c\u5373 GOPATH=/aaa/bbb/ccc \u5f53\u5904\u7406\u5177\u6709\u4e0d\u540c GOPATH \u7684Go\u9879\u76ee\u65f6\uff0c\u8fd9\u4e2a\u8bbe\u7f6e\u975e\u5e38\u6709\u7528\u3002 \u4e0d\u9700\u8981\u5728\u6bcf\u4e2a\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u8bbe\u7f6e GOPATH \uff0c\u4e5f\u4e0d\u9700\u8981\u5728\u5de5\u4f5c\u7a7a\u95f4\u4e2d\u8bbe\u7f6e\u5168\u90e8\u7684\u76ee\u5f55\u7136\u540e\u7528 : \u6216 ; \u6765\u5206\u9694\u3002 \u53ea\u9700\u8981\u5c06 go.inferGopath \u8bbe\u7f6e\u4e3a true \uff0c\u6269\u5c55\u7a0b\u5e8f\u5c31\u4f1a\u81ea\u52a8\u641c\u7d22\u5e76\u4f7f\u7528\u6b63\u786e\u7684 GOPATH \u3002","title":"\u901a\u8fc7go.inferGopath\u8bbe\u7f6eGOPATH"},{"location":"IDE/VSCode/08-\u6269\u5c55\u7a0b\u5e8f\u4e2d\u8bbe\u7f6eGOPATH/#gotoolsgopathgogopath","text":"\u4f7f\u7528 go get \u547d\u4ee4\u5728 GOPATH \u4e2d\u5b89\u88c5Go\u5de5\u5177\uff0c\u8981\u9632\u6b62Go\u5de5\u5177\u6270\u4e71 GOPATH ,\u53ef\u4ee5\u4f7f\u7528 go.toolsGopath \u8bbe\u7f6e\u6765\u63d0\u4f9b\u5355\u72ec\u7684 GOPATH \u4ec5\u7528\u4e8eGo\u5de5\u5177\u3002 \u7b2c\u4e00\u6b21\u8bbe\u7f6e go.toolsGopath \u65f6\uff0c\u9700\u8981\u8fd0\u884c GO: Install/Update Tools \u547d\u4ee4\uff0c\u8fd9\u6837Go\u5de5\u5177\u5c31\u80fd\u591f\u5b89\u88c5\u5728\u6307\u5b9a\u7684\u4f4d\u7f6e\u3002 \u5982\u679c\u6ca1\u6709\u8bbe\u7f6e go.toolsGopath \u6216\u8005\u5728\u5b83\u6307\u5b9a\u7684\u4f4d\u7f6e\u6ca1\u6709\u627e\u5230Go\u5de5\u5177\uff0c\u90a3\u4e48\u4f1a\u4f7f\u7528\u4e0a\u9762\u51e0\u8282\u4e2d\u63cf\u8ff0\u7684\u903b\u8f91\u6765\u627e GOPATH \u4e2d\u7684Go\u5de5\u5177\u3002\u5982\u679c\u5728\u90a3\u91cc\u4e5f\u6ca1\u6709\u627e\u5230Go\u5de5\u5177\uff0c\u90a3\u4e48\u5c31\u4f1a\u5728\u8def\u5f84\u627e\u4e2d\u67e5\u627e\uff0c\u8fd9\u4e9b\u8def\u5f84\u65f6 PATH \u73af\u5883\u53d8\u91cf\u7684\u4e00\u90e8\u5206\u3002","title":"\u901a\u8fc7go.toolsGopath\u8bbe\u7f6eGo\u5de5\u5177\u7684GOPATH"},{"location":"IDE/VSCode/09-\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd/","text":"\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd Go\u6269\u5c55\u7a0b\u5e8f\u9ed8\u8ba4\u5728\u6bcf\u4e2a\u6587\u4ef6\u4fdd\u5b58\u65f6\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u53ef\u4ee5\u5728\u8bbe\u7f6e\u4e2d\u5173\u95ed\u3002 \u6784\u5efa\uff1a go.buildOnSave \u5206\u6790\uff1a go.lintOnSave \u5ba1\u67e5\uff1a go.vetOnSave \u683c\u5f0f\u5316\uff1a\u5982\u4e0b\u53c2\u6570 [go] : { editor.formatOnSave : false } \u5728\u8bbe\u7f6e\u4e2d\u5f00\u542f\u540e\uff0c\u5f53\u6587\u4ef6\u4fdd\u5b58\u65f6\u53ef\u4ee5\u8fd0\u884c\u4e0b\u9762\u7684\u529f\u80fd\uff1a \u6d4b\u8bd5 \u4ee3\u7801\u8986\u76d6\u7387 \u4fdd\u5b58\u65f6\u6784\u5efa \u5728\u6bcf\u4e2a\u6587\u4ef6\u4fdd\u5b58\u65f6\uff0c\u6784\u5efa\u6587\u4ef6\u6240\u5c5e\u7684\u5305\u6765\u67e5\u627e\u4efb\u4f55\u7f16\u8bd1\u9519\u8bef\u3002\u5982\u679c\u6b64\u6587\u4ef6\u662f\u6d4b\u8bd5\u6587\u4ef6\uff0c\u90a3\u4e48\u5c06\u6267\u884c go test -i -c -o \u800c\u4e0d\u662f go build -i -o \u3002 \u6784\u5efa\u8fc7\u7a0b\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u88ab\u5199\u5165\u4e34\u65f6\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u6b64\u5904\u7684\u76ee\u7684\u662f\u4ec5\u67e5\u627e\u7f16\u8bd1\u9519\u8bef\u800c\u4e0d\u63d0\u4f9b\u4e8c\u8fdb\u5236\u6587\u4ef6/\u53ef\u6267\u884c\u6587\u4ef6\u3002 \u901a\u8fc7\u4ee5\u4e0b\u53c2\u6570\u63a7\u5236\u4fdd\u5b58\u65f6\u6784\u5efa\uff1a go.buildOnSave \uff1a\u4f7f\u7528\u6b64\u53c2\u6570\u65e2\u53ef\u4ee5\u7528\u6765\u5173\u95ed\u4fdd\u5b58\u65f6\u6784\u5efa\u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u4fee\u6539\u4e3a\u5728\u5305\u7ea7\u522b\u6216\u8005\u5de5\u4f5c\u7a7a\u95f4\u7ea7\u522b\u7684\u4fdd\u5b58\u65f6\u6784\u5efa\u3002 go.buildTags \uff1a\u6b64\u5904\u7684\u6807\u7b7e\u7528\u4e8e\u6784\u5efa( build )\u548c\u5ba1\u67e5( vet )\u8fdb\u7a0b\uff0c\u5c31\u50cf\u5176\u4ed6\u88ab\u672c\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684Go\u5de5\u5177\u90a3\u6837\u4f7f\u7528 -tags \u6807\u5fd7\u3002 go.buildFlags \uff1a\u88ab\u6784\u5efa\u548c\u6d4b\u8bd5\u8fdb\u7a0b\u4f7f\u7528\u3002 go.installDependenciesWhenBuilding \uff1a \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f20\u9012 -i \u6807\u5fd7\u6765\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b \u5982\u679c\u4e0d\u60f3\u4f7f\u7528 -i \u6807\u5fd7\uff0c\u5c31\u5c06 go.installDependenciesWhenBuilding \u8bbe\u7f6e\u4e3a false \u4fdd\u5b58\u65f6\u5206\u6790 \u5206\u6790\u5668( linter)\u65f6\u4e00\u79cd\u63d0\u4f9b\u7f16\u7801\u98ce\u683c\u53cd\u9988\u548c\u5efa\u8bae\u7684\u5de5\u5177\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684 golint`\u4f5c\u4e3a\u5206\u6790\u5668\u3002 \u53ef\u4ee5\u901a\u8fc7\u5728\u8bbe\u7f6e\u4e2d\u4fee\u6539 golintTool \u53c2\u6570\u4e3a gometalinter \u6765\u4f7f\u7528\u66f4\u9ad8\u7aef\u7684 Go Meta Linter \u66ff\u4ee3\u9ed8\u8ba4\u7684\u5206\u6790\u5668\u3002 \u6ce8\uff1agometalinter\u5df2\u7ecf\u5f03\u7528\uff0c\u66f4\u9ad8\u7ea7\u7684\u7248\u672c\u662f golangci-lint \u3002 Go Meta Linter\u662f\u591a\u79cd\u7531\u672c\u6269\u5c55\u7a0b\u5e8f\u5b89\u88c5\u7684\u5206\u6790\u5668\u7684\u96c6\u5408\u3002 \u51e0\u4e2a\u975e\u5e38\u6709\u7528\u7684\u5206\u6790\u5de5\u5177\u5982\u4e0b\uff1a errcheck \uff1a\u68c0\u67e5\u4ee3\u7801\u4e2d\u7684\u672a\u68c0\u67e5\u9519\u8bef varcheck \uff1a\u67e5\u627e\u672a\u4f7f\u7528\u7684\u5168\u5c40\u53d8\u91cf\u548c\u5e38\u91cf deadcode \uff1a\u67e5\u627e\u672a\u4f7f\u7528\u7684\u4ee3\u7801 \u5982\u679c\u53ea\u9700\u8981\u4f7f\u7528\u5176\u4e2d\u67d0\u4e2a\u5206\u6790\u5668\uff08\u67d0\u4e9b\u5206\u6790\u5668\u5f88\u6162\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6765\u6307\u5b9a\uff1a go.lintFlags : [ --disable-all , --enable=errcheck ], \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528 megacheck \uff0c\u5b83\u6bd4 gometalinter \u6027\u80fd\u66f4\u597d\uff0c\u540c\u4e8b\u53ea\u652f\u6301\u5de5\u5177\u7684\u5b50\u96c6\u3002 \u8981\u5728\u4fdd\u5b58\u65f6\u7981\u7528\u5206\u6790\uff0c\u5219\u5173\u95ed go.lintOnSave \u3002 \u4fdd\u5b58\u65f6\u683c\u5f0f\u5316 \u5982\u679c\u5f00\u542f\u4e86\u81ea\u52a8\u4fdd\u5b58\u529f\u80fd\uff0c\u90a3\u53ef\u80fd\u9700\u8981\u5173\u95ed\u4fdd\u5b58\u65f6\u683c\u5f0f\u5316\u529f\u80fd\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u4ee3\u7801\u4e0d\u65ad\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5982\u4e0b\u914d\u7f6e\uff1a [go] : { editor.formatOnSave : false } \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 goreturns \u5de5\u5177\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 go.formatTool \u53c2\u6570\u6765\u66f4\u6362\u4e3a goimports \u6216\u8005 gofmt \u5de5\u5177\u3002 \u5982\u679c\u53d1\u73b0\u672a\u4f7f\u7528\u7684\u5bfc\u5165\u81ea\u52a8\u6d88\u5931\u4e86\u6216\u8005\u672a\u5bfc\u5165\u7684\u5305\u81ea\u52a8\u6dfb\u52a0\u4e86\uff0c\u8fd9\u5c31\u662f goreturns \u5de5\u5177\u5728\u80cc\u540e\u8d77\u4f5c\u7528\u3002","title":"\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd"},{"location":"IDE/VSCode/09-\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd/#_1","text":"Go\u6269\u5c55\u7a0b\u5e8f\u9ed8\u8ba4\u5728\u6bcf\u4e2a\u6587\u4ef6\u4fdd\u5b58\u65f6\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u53ef\u4ee5\u5728\u8bbe\u7f6e\u4e2d\u5173\u95ed\u3002 \u6784\u5efa\uff1a go.buildOnSave \u5206\u6790\uff1a go.lintOnSave \u5ba1\u67e5\uff1a go.vetOnSave \u683c\u5f0f\u5316\uff1a\u5982\u4e0b\u53c2\u6570 [go] : { editor.formatOnSave : false } \u5728\u8bbe\u7f6e\u4e2d\u5f00\u542f\u540e\uff0c\u5f53\u6587\u4ef6\u4fdd\u5b58\u65f6\u53ef\u4ee5\u8fd0\u884c\u4e0b\u9762\u7684\u529f\u80fd\uff1a \u6d4b\u8bd5 \u4ee3\u7801\u8986\u76d6\u7387","title":"\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd"},{"location":"IDE/VSCode/09-\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd/#_2","text":"\u5728\u6bcf\u4e2a\u6587\u4ef6\u4fdd\u5b58\u65f6\uff0c\u6784\u5efa\u6587\u4ef6\u6240\u5c5e\u7684\u5305\u6765\u67e5\u627e\u4efb\u4f55\u7f16\u8bd1\u9519\u8bef\u3002\u5982\u679c\u6b64\u6587\u4ef6\u662f\u6d4b\u8bd5\u6587\u4ef6\uff0c\u90a3\u4e48\u5c06\u6267\u884c go test -i -c -o \u800c\u4e0d\u662f go build -i -o \u3002 \u6784\u5efa\u8fc7\u7a0b\u751f\u6210\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u88ab\u5199\u5165\u4e34\u65f6\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u6b64\u5904\u7684\u76ee\u7684\u662f\u4ec5\u67e5\u627e\u7f16\u8bd1\u9519\u8bef\u800c\u4e0d\u63d0\u4f9b\u4e8c\u8fdb\u5236\u6587\u4ef6/\u53ef\u6267\u884c\u6587\u4ef6\u3002 \u901a\u8fc7\u4ee5\u4e0b\u53c2\u6570\u63a7\u5236\u4fdd\u5b58\u65f6\u6784\u5efa\uff1a go.buildOnSave \uff1a\u4f7f\u7528\u6b64\u53c2\u6570\u65e2\u53ef\u4ee5\u7528\u6765\u5173\u95ed\u4fdd\u5b58\u65f6\u6784\u5efa\u529f\u80fd\uff0c\u4e5f\u53ef\u4ee5\u4fee\u6539\u4e3a\u5728\u5305\u7ea7\u522b\u6216\u8005\u5de5\u4f5c\u7a7a\u95f4\u7ea7\u522b\u7684\u4fdd\u5b58\u65f6\u6784\u5efa\u3002 go.buildTags \uff1a\u6b64\u5904\u7684\u6807\u7b7e\u7528\u4e8e\u6784\u5efa( build )\u548c\u5ba1\u67e5( vet )\u8fdb\u7a0b\uff0c\u5c31\u50cf\u5176\u4ed6\u88ab\u672c\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u7684Go\u5de5\u5177\u90a3\u6837\u4f7f\u7528 -tags \u6807\u5fd7\u3002 go.buildFlags \uff1a\u88ab\u6784\u5efa\u548c\u6d4b\u8bd5\u8fdb\u7a0b\u4f7f\u7528\u3002 go.installDependenciesWhenBuilding \uff1a \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f20\u9012 -i \u6807\u5fd7\u6765\u52a0\u901f\u6784\u5efa\u8fc7\u7a0b \u5982\u679c\u4e0d\u60f3\u4f7f\u7528 -i \u6807\u5fd7\uff0c\u5c31\u5c06 go.installDependenciesWhenBuilding \u8bbe\u7f6e\u4e3a false","title":"\u4fdd\u5b58\u65f6\u6784\u5efa"},{"location":"IDE/VSCode/09-\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd/#_3","text":"\u5206\u6790\u5668( linter)\u65f6\u4e00\u79cd\u63d0\u4f9b\u7f16\u7801\u98ce\u683c\u53cd\u9988\u548c\u5efa\u8bae\u7684\u5de5\u5177\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6b64\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5b98\u65b9\u63d0\u4f9b\u7684 golint`\u4f5c\u4e3a\u5206\u6790\u5668\u3002 \u53ef\u4ee5\u901a\u8fc7\u5728\u8bbe\u7f6e\u4e2d\u4fee\u6539 golintTool \u53c2\u6570\u4e3a gometalinter \u6765\u4f7f\u7528\u66f4\u9ad8\u7aef\u7684 Go Meta Linter \u66ff\u4ee3\u9ed8\u8ba4\u7684\u5206\u6790\u5668\u3002 \u6ce8\uff1agometalinter\u5df2\u7ecf\u5f03\u7528\uff0c\u66f4\u9ad8\u7ea7\u7684\u7248\u672c\u662f golangci-lint \u3002 Go Meta Linter\u662f\u591a\u79cd\u7531\u672c\u6269\u5c55\u7a0b\u5e8f\u5b89\u88c5\u7684\u5206\u6790\u5668\u7684\u96c6\u5408\u3002 \u51e0\u4e2a\u975e\u5e38\u6709\u7528\u7684\u5206\u6790\u5de5\u5177\u5982\u4e0b\uff1a errcheck \uff1a\u68c0\u67e5\u4ee3\u7801\u4e2d\u7684\u672a\u68c0\u67e5\u9519\u8bef varcheck \uff1a\u67e5\u627e\u672a\u4f7f\u7528\u7684\u5168\u5c40\u53d8\u91cf\u548c\u5e38\u91cf deadcode \uff1a\u67e5\u627e\u672a\u4f7f\u7528\u7684\u4ee3\u7801 \u5982\u679c\u53ea\u9700\u8981\u4f7f\u7528\u5176\u4e2d\u67d0\u4e2a\u5206\u6790\u5668\uff08\u67d0\u4e9b\u5206\u6790\u5668\u5f88\u6162\uff09\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u914d\u7f6e\u6765\u6307\u5b9a\uff1a go.lintFlags : [ --disable-all , --enable=errcheck ], \u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528 megacheck \uff0c\u5b83\u6bd4 gometalinter \u6027\u80fd\u66f4\u597d\uff0c\u540c\u4e8b\u53ea\u652f\u6301\u5de5\u5177\u7684\u5b50\u96c6\u3002 \u8981\u5728\u4fdd\u5b58\u65f6\u7981\u7528\u5206\u6790\uff0c\u5219\u5173\u95ed go.lintOnSave \u3002","title":"\u4fdd\u5b58\u65f6\u5206\u6790"},{"location":"IDE/VSCode/09-\u4fdd\u5b58\u65f6\u81ea\u52a8\u6267\u884c\u7684\u529f\u80fd/#_4","text":"\u5982\u679c\u5f00\u542f\u4e86\u81ea\u52a8\u4fdd\u5b58\u529f\u80fd\uff0c\u90a3\u53ef\u80fd\u9700\u8981\u5173\u95ed\u4fdd\u5b58\u65f6\u683c\u5f0f\u5316\u529f\u80fd\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u4ee3\u7801\u4e0d\u65ad\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539\u5982\u4e0b\u914d\u7f6e\uff1a [go] : { editor.formatOnSave : false } \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4f7f\u7528 goreturns \u5de5\u5177\u8fdb\u884c\u683c\u5f0f\u5316\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 go.formatTool \u53c2\u6570\u6765\u66f4\u6362\u4e3a goimports \u6216\u8005 gofmt \u5de5\u5177\u3002 \u5982\u679c\u53d1\u73b0\u672a\u4f7f\u7528\u7684\u5bfc\u5165\u81ea\u52a8\u6d88\u5931\u4e86\u6216\u8005\u672a\u5bfc\u5165\u7684\u5305\u81ea\u52a8\u6dfb\u52a0\u4e86\uff0c\u8fd9\u5c31\u662f goreturns \u5de5\u5177\u5728\u80cc\u540e\u8d77\u4f5c\u7528\u3002","title":"\u4fdd\u5b58\u65f6\u683c\u5f0f\u5316"},{"location":"IDE/VSCode/10-\u70df\u56f1\u6d4b\u8bd5/","text":"\u70df\u56f1\u6d4b\u8bd5 \u6d4b\u8bd5Go\u6269\u5c55\u7a0b\u5e8f\u7684\u5148\u51b3\u6761\u4ef6\u5982\u4e0b\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u5b89\u88c5Go\u548c\u672c\u6269\u5c55\u7a0b\u5e8f\uff1a \u5b89\u88c5Go \u6267\u884c go get github.com/golang/example/hello \u547d\u4ee4 \u5728\u4fa7\u680f\u5bfc\u5165Go\u6269\u5c55\u7a0b\u5e8f\u7136\u540e\u5728 VSCode \u4e2d\u6253\u5f00 $HOME/go/src/github.com/golang/example \u6587\u4ef6\u5939 \u6253\u5f00\u4efb\u610f\u7684\u4e00\u4e2aGo\u6587\u4ef6\uff0c\u5728\u72b6\u6001\u680f\u4f1a\u770b\u5230 Analysis Tools Missing \u7684\u63d0\u793a\uff0c\u70b9\u51fb\u8be5\u63d0\u793a\u6765\u5b89\u88c5\u6269\u5c55\u7a0b\u5e8f\u9700\u8981\u7684G0\u5de5\u5177 \u70df\u56f1\u6d4b\u8bd5\u7684\u529f\u80fd \u4ece\u5f53\u524d/\u6807\u51c6/\u7b2c\u4e09\u65b9\u7684\u8f6f\u4ef6\u5305\u4e2d\u5c1d\u8bd5\u51fd\u6570\uff0c\u7ed3\u6784\u548c\u63a5\u53e3\u7684\u4ee5\u4e0b\u529f\u80fd\uff1a \u8df3\u8f6c\u5230\u6216\u8005\u60ac\u505c\u5b9a\u4e49 \u67e5\u627e\u5f15\u7528 \u60ac\u505c\u4fe1\u606f \u5728\u5185\u7f6e\u51fd\u6570\uff08 fmt \uff0c strings \uff0c math \u7b49\uff09\u548c\u81ea\u5b9a\u4e49\u5305\uff08 hello \u9879\u76ee\u4e2d\u7684 stringutil \uff09\u4e2d\u5c1d\u8bd5\u4ee5\u4e0b\u529f\u80fd\uff1a \u81ea\u52a8\u8865\u5168 \u81ea\u5b9a\u8865\u5168\u672a\u5bfc\u5165\u7684\u5305 \u5c06 go.useCodeSnippetsOnFunctionSuggest \u8bbe\u7f6e\u4e3a true \u7136\u540e\u68c0\u67e5\u4ee3\u7801\u7247\u6bb5\u662f\u5426\u663e\u793a \u51fd\u6570\u7b7e\u540d\u5e2e\u52a9 \u542f\u7528\u4fdd\u5b58\u65f6\u6784\u5efa\uff0c\u5ba1\u67e5\uff0c\u5206\u6790\u548c\u683c\u5f0f\u5316\u7684\u529f\u80fd\uff0c\u5728go\u6587\u4ef6\u4e2d\u8fdb\u884c\u66f4\u6539\u5e76\u4fdd\u5b58\u3002\u5c1d\u8bd5\u8bbe\u7f6e\u503c\u7684\u8303\u56f4\u4e3a\u201c package \u201d\u548c\u201c workspace \u201d\uff1a Go\u7684\u8f93\u51fa\u901a\u9053\u5e94\u663e\u793a\u6784\u5efa\uff0c\u5ba1\u67e5\u548c\u5206\u6790\u7ed3\u679c \u5982\u679c\u6709\u9519\u8bef\uff0c\u7ea2\u8272\u6ce2\u6d6a\u7ebf\u5e94\u663e\u793a\u5728\u7f16\u8f91\u5668\u4e2d \u5220\u9664\u5bfc\u51fa\u6210\u5458\uff08\u540d\u79f0\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\uff09\u7684\u6ce8\u91ca\uff0c\u5e76\u68c0\u67e5\u5206\u6790\u5668\u8981\u6c42\u6dfb\u52a0\u7684\u6ce8\u91ca \u6dfb\u52a0\u6807\u7b7e\u548c\u989d\u5916\u7684\u884c\u5e76\u4e14\u5220\u9664\u5bfc\u5165\uff1a\u683c\u5f0f\u5316\u529f\u80fd\u5e94\u8be5\u4f1a\u4fee\u590d\u8fd9\u4e9b\u5730\u65b9 \u91cd\u547d\u540d\uff1a \u91cd\u547d\u540d\u4e00\u4e2a\u5c40\u90e8\u53d8\u91cf\uff0c\u91cd\u547d\u540d\u5c06\u4f1a\u751f\u6548\u7136\u540e\u6587\u4ef6\u8fdb\u5165\u810f\u72b6\u6001 \u91cd\u547d\u540d\u4e00\u4e2a\u5bfc\u51fa\u51fd\u6570\uff08\u4f8b\u5982\uff0c\u4ecehello\u9879\u76ee\u4e2d\u5bfc\u5165\uff09\uff0c\u91cd\u547d\u540d\u5c06\u4f1a\u8de8\u6587\u4ef6\u751f\u6548\uff0c\u6240\u6709\u53d7\u5f71\u54cd\u7684\u6587\u4ef6\u90fd\u5e94\u8be5\u6253\u5f00\u5e76\u5904\u4e8e\u810f\u72b6\u6001 \u6dfb\u52a0\u5bfc\u5165\uff1a \u547d\u4ee4\uff1a Go: Add import \u5e94\u8be5\u4f1a\u663e\u793a\u4e00\u4e2a\u53ef\u4ee5\u88ab\u5bfc\u5165\u7684\u5305\u5217\u8868 \u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u5e94\u8be5\u5411\u5f53\u524dgo\u6587\u4ef6\u6dfb\u52a0\u5bfc\u5165 \u5f53\u524d\u6587\u4ef6\u4e2d\u5df2\u5bfc\u5165\u7684\u5305\u4e0d\u5e94\u663e\u793a\u5728\u5217\u8868\u4e2d \u5176\u4ed6\u529f\u80fd\uff1a \u6587\u4ef6\u5927\u7eb2 \u8c03\u8bd5","title":"\u70df\u56f1\u6d4b\u8bd5"},{"location":"IDE/VSCode/10-\u70df\u56f1\u6d4b\u8bd5/#_1","text":"\u6d4b\u8bd5Go\u6269\u5c55\u7a0b\u5e8f\u7684\u5148\u51b3\u6761\u4ef6\u5982\u4e0b\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u5b89\u88c5Go\u548c\u672c\u6269\u5c55\u7a0b\u5e8f\uff1a \u5b89\u88c5Go \u6267\u884c go get github.com/golang/example/hello \u547d\u4ee4 \u5728\u4fa7\u680f\u5bfc\u5165Go\u6269\u5c55\u7a0b\u5e8f\u7136\u540e\u5728 VSCode \u4e2d\u6253\u5f00 $HOME/go/src/github.com/golang/example \u6587\u4ef6\u5939 \u6253\u5f00\u4efb\u610f\u7684\u4e00\u4e2aGo\u6587\u4ef6\uff0c\u5728\u72b6\u6001\u680f\u4f1a\u770b\u5230 Analysis Tools Missing \u7684\u63d0\u793a\uff0c\u70b9\u51fb\u8be5\u63d0\u793a\u6765\u5b89\u88c5\u6269\u5c55\u7a0b\u5e8f\u9700\u8981\u7684G0\u5de5\u5177","title":"\u70df\u56f1\u6d4b\u8bd5"},{"location":"IDE/VSCode/10-\u70df\u56f1\u6d4b\u8bd5/#_2","text":"\u4ece\u5f53\u524d/\u6807\u51c6/\u7b2c\u4e09\u65b9\u7684\u8f6f\u4ef6\u5305\u4e2d\u5c1d\u8bd5\u51fd\u6570\uff0c\u7ed3\u6784\u548c\u63a5\u53e3\u7684\u4ee5\u4e0b\u529f\u80fd\uff1a \u8df3\u8f6c\u5230\u6216\u8005\u60ac\u505c\u5b9a\u4e49 \u67e5\u627e\u5f15\u7528 \u60ac\u505c\u4fe1\u606f \u5728\u5185\u7f6e\u51fd\u6570\uff08 fmt \uff0c strings \uff0c math \u7b49\uff09\u548c\u81ea\u5b9a\u4e49\u5305\uff08 hello \u9879\u76ee\u4e2d\u7684 stringutil \uff09\u4e2d\u5c1d\u8bd5\u4ee5\u4e0b\u529f\u80fd\uff1a \u81ea\u52a8\u8865\u5168 \u81ea\u5b9a\u8865\u5168\u672a\u5bfc\u5165\u7684\u5305 \u5c06 go.useCodeSnippetsOnFunctionSuggest \u8bbe\u7f6e\u4e3a true \u7136\u540e\u68c0\u67e5\u4ee3\u7801\u7247\u6bb5\u662f\u5426\u663e\u793a \u51fd\u6570\u7b7e\u540d\u5e2e\u52a9 \u542f\u7528\u4fdd\u5b58\u65f6\u6784\u5efa\uff0c\u5ba1\u67e5\uff0c\u5206\u6790\u548c\u683c\u5f0f\u5316\u7684\u529f\u80fd\uff0c\u5728go\u6587\u4ef6\u4e2d\u8fdb\u884c\u66f4\u6539\u5e76\u4fdd\u5b58\u3002\u5c1d\u8bd5\u8bbe\u7f6e\u503c\u7684\u8303\u56f4\u4e3a\u201c package \u201d\u548c\u201c workspace \u201d\uff1a Go\u7684\u8f93\u51fa\u901a\u9053\u5e94\u663e\u793a\u6784\u5efa\uff0c\u5ba1\u67e5\u548c\u5206\u6790\u7ed3\u679c \u5982\u679c\u6709\u9519\u8bef\uff0c\u7ea2\u8272\u6ce2\u6d6a\u7ebf\u5e94\u663e\u793a\u5728\u7f16\u8f91\u5668\u4e2d \u5220\u9664\u5bfc\u51fa\u6210\u5458\uff08\u540d\u79f0\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\uff09\u7684\u6ce8\u91ca\uff0c\u5e76\u68c0\u67e5\u5206\u6790\u5668\u8981\u6c42\u6dfb\u52a0\u7684\u6ce8\u91ca \u6dfb\u52a0\u6807\u7b7e\u548c\u989d\u5916\u7684\u884c\u5e76\u4e14\u5220\u9664\u5bfc\u5165\uff1a\u683c\u5f0f\u5316\u529f\u80fd\u5e94\u8be5\u4f1a\u4fee\u590d\u8fd9\u4e9b\u5730\u65b9 \u91cd\u547d\u540d\uff1a \u91cd\u547d\u540d\u4e00\u4e2a\u5c40\u90e8\u53d8\u91cf\uff0c\u91cd\u547d\u540d\u5c06\u4f1a\u751f\u6548\u7136\u540e\u6587\u4ef6\u8fdb\u5165\u810f\u72b6\u6001 \u91cd\u547d\u540d\u4e00\u4e2a\u5bfc\u51fa\u51fd\u6570\uff08\u4f8b\u5982\uff0c\u4ecehello\u9879\u76ee\u4e2d\u5bfc\u5165\uff09\uff0c\u91cd\u547d\u540d\u5c06\u4f1a\u8de8\u6587\u4ef6\u751f\u6548\uff0c\u6240\u6709\u53d7\u5f71\u54cd\u7684\u6587\u4ef6\u90fd\u5e94\u8be5\u6253\u5f00\u5e76\u5904\u4e8e\u810f\u72b6\u6001 \u6dfb\u52a0\u5bfc\u5165\uff1a \u547d\u4ee4\uff1a Go: Add import \u5e94\u8be5\u4f1a\u663e\u793a\u4e00\u4e2a\u53ef\u4ee5\u88ab\u5bfc\u5165\u7684\u5305\u5217\u8868 \u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u5e94\u8be5\u5411\u5f53\u524dgo\u6587\u4ef6\u6dfb\u52a0\u5bfc\u5165 \u5f53\u524d\u6587\u4ef6\u4e2d\u5df2\u5bfc\u5165\u7684\u5305\u4e0d\u5e94\u663e\u793a\u5728\u5217\u8868\u4e2d \u5176\u4ed6\u529f\u80fd\uff1a \u6587\u4ef6\u5927\u7eb2 \u8c03\u8bd5","title":"\u70df\u56f1\u6d4b\u8bd5\u7684\u529f\u80fd"},{"location":"IDE/VSCode/11.\u4f7f\u7528Go\u6267\u884cVScode\u7684\u4efb\u52a1/","text":"\u4f7f\u7528Go\u6267\u884cVSCode\u7684\u4efb\u52a1 \u4ece\u547d\u4ee4\u9762\u677f\u4e2d\u8c03\u7528 Task: Configure Task Runner \u3002 \u8fd9\u5c06\u5728\u5de5\u4f5c\u7a7a\u95f4\uff08 .vscode \uff09\u6587\u4ef6\u5939\u4e2d\u7ea7\u5de5\u521b\u5efa task.json \u6587\u4ef6\uff0c\u7528\u4e0b\u9762\u7684\u5185\u5bb9\u66ff\u6362\u81ea\u52a8\u751f\u6210\u7684 JSON \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u3002 { version : 0.1.0 , command : go , isShellCommand : true, showOutput : silent , tasks : [ { taskName : install , args : [ -v , ./... ], isBuildCommand : true }, { taskName : test , args : [ -v , ./... ], isTestCommand : true } ] } { { version : 2.0.0 , type : shell , echoCommand : true, cwd : ${workspaceFolder} , tasks : [ { label : rungo , command : go run ${file} , group : { kind : build , isDefault : true } }, ] } \u901a\u8fc7 ctrl + shift + b \u6765\u8fd0\u884c go install -v ./... \u5e76\u4e14\u4f1a\u5728\u8f93\u51fa\u7a97\u53e3\u4e2d\u8fd4\u56de\u7ed3\u679c \u901a\u8fc7 ctrl + shift + t \u6765\u8fd0\u884c go test -v ./... \u5e76\u4e14\u4f1a\u5728\u8f93\u51fa\u7a97\u53e3\u4e2d\u8fd4\u56de\u7ed3\u679c \u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u6280\u5de7\u6765\u8c03\u7528\u5176\u4ed6\u6784\u5efa\u548c\u6d4b\u8bd5\u5de5\u5177\u3002\u4f8b\u5982\uff0c\u5728 makefile \u4e2d\u5b9a\u4e49\u6784\u5efa\u8fc7\u7a0b\uff0c\u5219\u8c03\u7528 makefile \u76ee\u6807\uff0c\u6216\u8005\u8c03\u7528\u7c7b\u4f3c go generate \u4e4b\u7c7b\u7684\u5de5\u5177\u3002 \u6709\u5173\u5728VSCode\u4e2d\u914d\u7f6e\u4efb\u52a1\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u67e5\u770b \u8fd9\u91cc \u3002 \u53ef\u4ee5\u5b9a\u4e49\u7279\u6b8a\u7684\u4ec5\u8fd0\u884c\u67d0\u4e9b\u6d4b\u8bd5\u7684\u4efb\u52a1\uff1a { version : 0.1.0 , command : go , isShellCommand : true, showOutput : silent , suppressTaskName : true, tasks : [ { taskName : Full test suite , args : [ test , v , ./... ] }, { taskName : Blog User test suite , args : [ test , ./... , -test.v , -test.run , User ] } ] } \u8be5\u4efb\u52a1\u5c06\u4f1a\u7528 User \u4e2d\u7684\u540d\u5b57\u6765\u8fd0\u884c\u6240\u6709\u7684\u6d4b\u8bd5\u3002","title":"\u4f7f\u7528Go\u6267\u884cVSCode\u7684\u4efb\u52a1"},{"location":"IDE/VSCode/11.\u4f7f\u7528Go\u6267\u884cVScode\u7684\u4efb\u52a1/#govscode","text":"\u4ece\u547d\u4ee4\u9762\u677f\u4e2d\u8c03\u7528 Task: Configure Task Runner \u3002 \u8fd9\u5c06\u5728\u5de5\u4f5c\u7a7a\u95f4\uff08 .vscode \uff09\u6587\u4ef6\u5939\u4e2d\u7ea7\u5de5\u521b\u5efa task.json \u6587\u4ef6\uff0c\u7528\u4e0b\u9762\u7684\u5185\u5bb9\u66ff\u6362\u81ea\u52a8\u751f\u6210\u7684 JSON \u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\u3002 { version : 0.1.0 , command : go , isShellCommand : true, showOutput : silent , tasks : [ { taskName : install , args : [ -v , ./... ], isBuildCommand : true }, { taskName : test , args : [ -v , ./... ], isTestCommand : true } ] } { { version : 2.0.0 , type : shell , echoCommand : true, cwd : ${workspaceFolder} , tasks : [ { label : rungo , command : go run ${file} , group : { kind : build , isDefault : true } }, ] } \u901a\u8fc7 ctrl + shift + b \u6765\u8fd0\u884c go install -v ./... \u5e76\u4e14\u4f1a\u5728\u8f93\u51fa\u7a97\u53e3\u4e2d\u8fd4\u56de\u7ed3\u679c \u901a\u8fc7 ctrl + shift + t \u6765\u8fd0\u884c go test -v ./... \u5e76\u4e14\u4f1a\u5728\u8f93\u51fa\u7a97\u53e3\u4e2d\u8fd4\u56de\u7ed3\u679c \u53ef\u4ee5\u4f7f\u7528\u540c\u6837\u7684\u6280\u5de7\u6765\u8c03\u7528\u5176\u4ed6\u6784\u5efa\u548c\u6d4b\u8bd5\u5de5\u5177\u3002\u4f8b\u5982\uff0c\u5728 makefile \u4e2d\u5b9a\u4e49\u6784\u5efa\u8fc7\u7a0b\uff0c\u5219\u8c03\u7528 makefile \u76ee\u6807\uff0c\u6216\u8005\u8c03\u7528\u7c7b\u4f3c go generate \u4e4b\u7c7b\u7684\u5de5\u5177\u3002 \u6709\u5173\u5728VSCode\u4e2d\u914d\u7f6e\u4efb\u52a1\u7684\u66f4\u591a\u4fe1\u606f\uff0c\u67e5\u770b \u8fd9\u91cc \u3002 \u53ef\u4ee5\u5b9a\u4e49\u7279\u6b8a\u7684\u4ec5\u8fd0\u884c\u67d0\u4e9b\u6d4b\u8bd5\u7684\u4efb\u52a1\uff1a { version : 0.1.0 , command : go , isShellCommand : true, showOutput : silent , suppressTaskName : true, tasks : [ { taskName : Full test suite , args : [ test , v , ./... ] }, { taskName : Blog User test suite , args : [ test , ./... , -test.v , -test.run , User ] } ] } \u8be5\u4efb\u52a1\u5c06\u4f1a\u7528 User \u4e2d\u7684\u540d\u5b57\u6765\u8fd0\u884c\u6240\u6709\u7684\u6d4b\u8bd5\u3002","title":"\u4f7f\u7528Go\u6267\u884cVSCode\u7684\u4efb\u52a1"},{"location":"IDE/VSCode/12-\u4f7f\u7528\u6269\u5c55\u7a0b\u5e8f\u6700\u65b0\u7684\u6d4b\u8bd5\u7248/","text":"\u4f7f\u7528\u6269\u5c55\u7a0b\u7a0b\u5e8f\u6700\u65b0\u7684\u6d4b\u8bd5\u7248 \u5982\u679c\u60f3\u8981\u5c1d\u8bd5\u4ece\u4e3b\u5206\u652f\u4e2d\u6784\u5efa\u6d4b\u8bd5\u7248\u7684Go\u6269\u5c55\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\uff1a \u4ece \u8fd9\u91cc \u4e0b\u8f7d vsix \u6587\u4ef6 \u6267\u884c code --install-extension Go-katest.vsix \u547d\u4ee4 \u91cd\u542fVSCode \u6ce8\u610f\uff1a \u6ca1\u6709\u81ea\u52a8\u66f4\u65b0\u673a\u5236\u6765\u81ea\u52a8\u5b89\u88c5\u6700\u65b0\u7684\u6d4b\u8bd5\u7248\u3002","title":"\u4f7f\u7528\u6269\u5c55\u7a0b\u7a0b\u5e8f\u6700\u65b0\u7684\u6d4b\u8bd5\u7248"},{"location":"IDE/VSCode/12-\u4f7f\u7528\u6269\u5c55\u7a0b\u5e8f\u6700\u65b0\u7684\u6d4b\u8bd5\u7248/#_1","text":"\u5982\u679c\u60f3\u8981\u5c1d\u8bd5\u4ece\u4e3b\u5206\u652f\u4e2d\u6784\u5efa\u6d4b\u8bd5\u7248\u7684Go\u6269\u5c55\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u6309\u7167\u5982\u4e0b\u8bf4\u660e\u8fdb\u884c\u64cd\u4f5c\uff1a \u4ece \u8fd9\u91cc \u4e0b\u8f7d vsix \u6587\u4ef6 \u6267\u884c code --install-extension Go-katest.vsix \u547d\u4ee4 \u91cd\u542fVSCode \u6ce8\u610f\uff1a \u6ca1\u6709\u81ea\u52a8\u66f4\u65b0\u673a\u5236\u6765\u81ea\u52a8\u5b89\u88c5\u6700\u65b0\u7684\u6d4b\u8bd5\u7248\u3002","title":"\u4f7f\u7528\u6269\u5c55\u7a0b\u7a0b\u5e8f\u6700\u65b0\u7684\u6d4b\u8bd5\u7248"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/","text":"Go \u8bed\u8a00\u670d\u52a1\u5668 Go\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5927\u91cf Go\u5de5\u5177 \u6765\u63d0\u4f9b\u5404\u79cd\u8bed\u8a00\u529f\u80fd\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u5355\u4e00\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u4f7f\u7528 \u8bed\u8a00\u670d\u52a1\u5668\u534f\u8bae \u63d0\u4f9b\u76f8\u540c\u7684\u529f\u80fd\u3002 \u4ee5\u524d\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86\u5bf9\u4f7f\u7528 go-langserver \uff08 Sourcegraph\u7684\u8bed\u8a00\u670d\u52a1\u5668 \uff09\u7684\u652f\u6301\u3002\u5b83\u4e0d\u518d\u6709\u6d3b\u8dc3\u7684\u5f00\u53d1\uff0c\u5b83\u4e0d\u652f\u6301Go\u6a21\u5757\u3002\u56e0\u6b64\uff0c\u73b0\u5728\u8f6c\u800c\u4f7f\u7528 gopls \uff0c Google\u7684\u8bed\u8a00\u670d\u52a1\u5668 \uff0c\u76ee\u524d\u6b63\u5728\u79ef\u6781\u5f00\u53d1\u4e2d\u3002 \u5982\u679c\u5df2\u7ecf\u4f7f\u7528\u00b7Sourcegraph\u00b7\u4e2d\u7684\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u53ea\u8981\u4e0d\u4f7f\u7528Go\u6a21\u5757\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u5b83\u3002\u5efa\u8bae\u7ee7\u7eed\u4f7f\u7528 gopls \u3002 \u4e3a\u6b64\uff0c\u8bf7\u5220\u9664\u8ba1\u7b97\u673a\u4e2d\u7684 go-langserver \u4e8c\u8fdb\u5236\u6587\u4ef6/\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6b64\u6269\u5c55\u7a0b\u5e8f\u5c06\u5728\u91cd\u65b0\u52a0\u8f7d VS Code \u7a97\u53e3\u540e\u63d0\u793a\u5b89\u88c5 gopls \u3002 \u7531\u4e8eGoogle\u7684\u8bed\u8a00\u670d\u52a1\u5668\u4e3aGo\u6a21\u5757\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u652f\u6301\uff0c\u5f53\u6269\u5c55\u7a0b\u5e8f\u68c0\u6d4b\u5230\u6b63\u5728\u4f7f\u7528Go\u6a21\u5757\u7684\u9879\u76ee\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u884c\u63d0\u793a\u3002 \u5982\u679c\u4e4b\u524d\u4ece\u672a\u4f7f\u7528\u8fc7\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u73b0\u5728\u9009\u62e9\u4f7f\u7528\u5b83\uff0c\u53ea\u8981\u4f7f\u7528 Go\u7248\u672c 1.10 \uff0c\u7cfb\u7edf\u5c31\u4f1a\u63d0\u793a\u5b89\u88c5\u5e76\u4f7f\u7528Google\u63d0\u4f9b\u7684\u8bed\u8a00\u670d\u52a1\u5668 \u8bbe\u7f6e\u4ee5\u63a7\u5236Go\u8bed\u8a00\u670d\u52a1\u5668 \u4ee5\u4e0b\u662f\u53ef\u7528\u4e8e\u63a7\u5236\u8bed\u8a00\u670d\u52a1\u5668\u4f7f\u7528\u7684\u8bbe\u7f6e\u3002\u9700\u8981\u91cd\u65b0\u52a0\u8f7d VS Code \u7a97\u53e3\u624d\u80fd\u4f7f\u8fd9\u4e9b\u8bbe\u7f6e\u4e2d\u7684\u4efb\u4f55\u66f4\u6539\u751f\u6548\u3002 \u5c06 go.useLanguageServer \u8bbe\u7f6e\u4e3a true \u4ee5\u542f\u7528\u8bed\u8a00\u670d\u52a1\u5668 \u4f7f\u7528 go.languageServerExperimentalFeatures \u8bbe\u7f6e\u6765\u63a7\u5236\u5e0c\u671b\u8bed\u8a00\u670d\u52a1\u5668\u4e3a\u54ea\u4e9b\u529f\u80fd\u63d0\u4f9b\u652f\u6301\u3002 \u8bbe\u7f6e \"go.languageServerFlags\"\uff1a[\" - logfile\"\uff0c\u201c\u5df2\u5b58\u5728\u7684\u6587\u672c\u6587\u4ef6\u7684\u8def\u5f84\"] \u4ee5\u6536\u96c6\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u65e5\u5fd7\u3002 \u8bbe\u7f6e \"go.languageServerFlags\"\uff1a[\" - rrp.trace\"] \u4ee5\u5728\u8f93\u51fa\u9762\u677f\u4e2d\u67e5\u770b\u5b8c\u6574\u7684rpc\u8ddf\u8e2a\uff08 View - Output - gopls \uff09 \u8bbe\u7f6e\u66f4\u6539\u6b63\u5728\u4f7f\u7528\u7684\u8bed\u8a00\u670d\u52a1\u5668 \u5982\u679c\u60f3\u5c1d\u8bd5\u5176\u4ed6\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u4f8b\u5982 bingo \uff0c\u8bf7\u5b89\u88c5\u5b83\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u8bbe\u7f6e go.alternateTools : { gopls : bingo } \u8fd9\u5c06\u544a\u8bc9Go\u6269\u5c55\u4f7f\u7528 bingo \u4ee3\u66ff gopls \u3002 \u63d0\u4f9b\u5173\u4e8e gopls \u7684\u53cd\u9988 \u5982\u679c\u5728\u4f7f\u7528gopls\u8bed\u8a00\u670d\u52a1\u5668\u65f6\u53d1\u73b0\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u9996\u5148\u67e5\u770b gopls \u7684\u73b0\u6709\u95ee\u9898\u5217\u8868 \uff0c\u5e76\u5728\u767b\u8bb0\u65b0\u6848\u4f8b\u4e4b\u524d\u66f4\u65b0\u76f8\u5173\u5df2\u7ecf\u6709\u6848\u4f8b\uff0c\u7f51\u5740\u4e3a https://github.com/golang/go/issues gopls \u7684\u6709\u7528\u94fe\u63a5 Wiki for gopls Troubleshooting for gopls Known bugs with gopls Github issues for gopls","title":"Go \u8bed\u8a00\u670d\u52a1\u5668"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/#go","text":"Go\u6269\u5c55\u7a0b\u5e8f\u4f7f\u7528\u5927\u91cf Go\u5de5\u5177 \u6765\u63d0\u4f9b\u5404\u79cd\u8bed\u8a00\u529f\u80fd\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528\u5355\u4e00\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u8be5\u670d\u52a1\u5668\u4f7f\u7528 \u8bed\u8a00\u670d\u52a1\u5668\u534f\u8bae \u63d0\u4f9b\u76f8\u540c\u7684\u529f\u80fd\u3002 \u4ee5\u524d\uff0c\u6211\u4eec\u6dfb\u52a0\u4e86\u5bf9\u4f7f\u7528 go-langserver \uff08 Sourcegraph\u7684\u8bed\u8a00\u670d\u52a1\u5668 \uff09\u7684\u652f\u6301\u3002\u5b83\u4e0d\u518d\u6709\u6d3b\u8dc3\u7684\u5f00\u53d1\uff0c\u5b83\u4e0d\u652f\u6301Go\u6a21\u5757\u3002\u56e0\u6b64\uff0c\u73b0\u5728\u8f6c\u800c\u4f7f\u7528 gopls \uff0c Google\u7684\u8bed\u8a00\u670d\u52a1\u5668 \uff0c\u76ee\u524d\u6b63\u5728\u79ef\u6781\u5f00\u53d1\u4e2d\u3002 \u5982\u679c\u5df2\u7ecf\u4f7f\u7528\u00b7Sourcegraph\u00b7\u4e2d\u7684\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u53ea\u8981\u4e0d\u4f7f\u7528Go\u6a21\u5757\uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u4f7f\u7528\u5b83\u3002\u5efa\u8bae\u7ee7\u7eed\u4f7f\u7528 gopls \u3002 \u4e3a\u6b64\uff0c\u8bf7\u5220\u9664\u8ba1\u7b97\u673a\u4e2d\u7684 go-langserver \u4e8c\u8fdb\u5236\u6587\u4ef6/\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u6b64\u6269\u5c55\u7a0b\u5e8f\u5c06\u5728\u91cd\u65b0\u52a0\u8f7d VS Code \u7a97\u53e3\u540e\u63d0\u793a\u5b89\u88c5 gopls \u3002 \u7531\u4e8eGoogle\u7684\u8bed\u8a00\u670d\u52a1\u5668\u4e3aGo\u6a21\u5757\u63d0\u4f9b\u4e86\u66f4\u597d\u7684\u652f\u6301\uff0c\u5f53\u6269\u5c55\u7a0b\u5e8f\u68c0\u6d4b\u5230\u6b63\u5728\u4f7f\u7528Go\u6a21\u5757\u7684\u9879\u76ee\u65f6\uff0c\u7cfb\u7edf\u4f1a\u8fdb\u884c\u63d0\u793a\u3002 \u5982\u679c\u4e4b\u524d\u4ece\u672a\u4f7f\u7528\u8fc7\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u73b0\u5728\u9009\u62e9\u4f7f\u7528\u5b83\uff0c\u53ea\u8981\u4f7f\u7528 Go\u7248\u672c 1.10 \uff0c\u7cfb\u7edf\u5c31\u4f1a\u63d0\u793a\u5b89\u88c5\u5e76\u4f7f\u7528Google\u63d0\u4f9b\u7684\u8bed\u8a00\u670d\u52a1\u5668","title":"Go \u8bed\u8a00\u670d\u52a1\u5668"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/#go_1","text":"\u4ee5\u4e0b\u662f\u53ef\u7528\u4e8e\u63a7\u5236\u8bed\u8a00\u670d\u52a1\u5668\u4f7f\u7528\u7684\u8bbe\u7f6e\u3002\u9700\u8981\u91cd\u65b0\u52a0\u8f7d VS Code \u7a97\u53e3\u624d\u80fd\u4f7f\u8fd9\u4e9b\u8bbe\u7f6e\u4e2d\u7684\u4efb\u4f55\u66f4\u6539\u751f\u6548\u3002 \u5c06 go.useLanguageServer \u8bbe\u7f6e\u4e3a true \u4ee5\u542f\u7528\u8bed\u8a00\u670d\u52a1\u5668 \u4f7f\u7528 go.languageServerExperimentalFeatures \u8bbe\u7f6e\u6765\u63a7\u5236\u5e0c\u671b\u8bed\u8a00\u670d\u52a1\u5668\u4e3a\u54ea\u4e9b\u529f\u80fd\u63d0\u4f9b\u652f\u6301\u3002 \u8bbe\u7f6e \"go.languageServerFlags\"\uff1a[\" - logfile\"\uff0c\u201c\u5df2\u5b58\u5728\u7684\u6587\u672c\u6587\u4ef6\u7684\u8def\u5f84\"] \u4ee5\u6536\u96c6\u65e5\u5fd7\u6587\u4ef6\u4e2d\u7684\u65e5\u5fd7\u3002 \u8bbe\u7f6e \"go.languageServerFlags\"\uff1a[\" - rrp.trace\"] \u4ee5\u5728\u8f93\u51fa\u9762\u677f\u4e2d\u67e5\u770b\u5b8c\u6574\u7684rpc\u8ddf\u8e2a\uff08 View - Output - gopls \uff09","title":"\u8bbe\u7f6e\u4ee5\u63a7\u5236Go\u8bed\u8a00\u670d\u52a1\u5668"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/#_1","text":"\u5982\u679c\u60f3\u5c1d\u8bd5\u5176\u4ed6\u8bed\u8a00\u670d\u52a1\u5668\uff0c\u4f8b\u5982 bingo \uff0c\u8bf7\u5b89\u88c5\u5b83\u5e76\u6dfb\u52a0\u4ee5\u4e0b\u8bbe\u7f6e go.alternateTools : { gopls : bingo } \u8fd9\u5c06\u544a\u8bc9Go\u6269\u5c55\u4f7f\u7528 bingo \u4ee3\u66ff gopls \u3002","title":"\u8bbe\u7f6e\u66f4\u6539\u6b63\u5728\u4f7f\u7528\u7684\u8bed\u8a00\u670d\u52a1\u5668"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/#gopls","text":"\u5982\u679c\u5728\u4f7f\u7528gopls\u8bed\u8a00\u670d\u52a1\u5668\u65f6\u53d1\u73b0\u4efb\u4f55\u95ee\u9898\uff0c\u8bf7\u9996\u5148\u67e5\u770b gopls \u7684\u73b0\u6709\u95ee\u9898\u5217\u8868 \uff0c\u5e76\u5728\u767b\u8bb0\u65b0\u6848\u4f8b\u4e4b\u524d\u66f4\u65b0\u76f8\u5173\u5df2\u7ecf\u6709\u6848\u4f8b\uff0c\u7f51\u5740\u4e3a https://github.com/golang/go/issues","title":"\u63d0\u4f9b\u5173\u4e8egopls\u7684\u53cd\u9988"},{"location":"IDE/VSCode/13-VSCode\u4e2d\u4f7f\u7528Go\u8bed\u8a00\u670d\u52a1\u5668/#gopls_1","text":"Wiki for gopls Troubleshooting for gopls Known bugs with gopls Github issues for gopls","title":"gopls\u7684\u6709\u7528\u94fe\u63a5"},{"location":"Issues/FAQ/","text":"\u9519\u8bef\u548c\u89e3\u51b3\u65b9\u6848 golang\u591a\u7248\u672c\u4f9d\u8d56\u51b2\u7a81\u95ee\u9898 \u89e3\u51b3\u65b9\u6848\uff1areplace github.com/ugorji/go v1.1.4 = github.com/ugorji/go/codec v0.0.0-20190204201341-e444a5086c43","title":"\u9519\u8bef\u548c\u89e3\u51b3\u65b9\u6848"},{"location":"Issues/FAQ/#_1","text":"golang\u591a\u7248\u672c\u4f9d\u8d56\u51b2\u7a81\u95ee\u9898 \u89e3\u51b3\u65b9\u6848\uff1areplace github.com/ugorji/go v1.1.4 = github.com/ugorji/go/codec v0.0.0-20190204201341-e444a5086c43","title":"\u9519\u8bef\u548c\u89e3\u51b3\u65b9\u6848"},{"location":"Language/Basic/00-Go\u5de5\u5177/","text":"Go\u8bed\u8a00\u5e38\u7528\u5185\u7f6e\u5de5\u5177\u7684\u4f7f\u7528\u65b9\u6cd5\u53ca\u53c2\u6570\u542b\u4e49\u3002 Go\u662f\u4e00\u4e2a\u7ba1\u7406Go\u6e90\u4ee3\u7801\u7684\u5de5\u5177\u3002 \u7528\u6cd5: go \u547d\u4ee4 [\u53c2\u6570] \u53ef\u9009\u7684\u547d\u4ee4\u5982\u4e0b\uff1a |\u547d\u4ee4|\u63cf\u8ff0|\u4e2d\u6587 ---|---|--- bug |start a bug report|\u542f\u52a8\u4e00\u4e2aBug\u62a5\u544a build |compile packages and dependencies|\u7f16\u8bd1\u5305\u548c\u4f9d\u8d56\u9879 clean |remove object files and cached files|\u5220\u9664\u76ee\u6807\u6587\u4ef6\u548c\u7f13\u5b58\u6587\u4ef6 doc |show documentation for package or symbol|\u663e\u793a\u5305\u6216\u7b26\u53f7\u7684\u6587\u6863 env |print Go environment information|\u6253\u5370Go\u73af\u5883\u4fe1\u606f fix |update packages to use new APIs|\u66f4\u65b0\u5305\u4ee5\u4f7f\u7528\u65b0API fmt |gofmt (reformat) package sources|\u91cd\u65b0\u683c\u5f0f\u5316\u6e90\u7801\u5305 generate |generate Go files by processing source|\u901a\u8fc7\u5904\u7406\u6e90\u751f\u6210Go\u6587\u4ef6 get |download and install packages and dependencies|\u4e0b\u8f7d\u5e76\u5b89\u88c5\u5305\u548c\u4f9d\u8d56\u9879 install |compile and install packages and dependencies|\u7f16\u8bd1\u548c\u5b89\u88c5\u5305\u548c\u4f9d\u8d56\u9879 list |list packages or modules|\u5217\u51fa\u5305\u6216\u6a21\u5757 mod |module maintenance|\u6a21\u5757\u7ef4\u62a4 run |compile and run Go program|\u7f16\u8bd1\u5e76\u8fd0\u884cGo\u7a0b\u5e8f test |test packages|\u6d4b\u8bd5\u5305 tool |run specified go tool|\u8fd0\u884c\u6307\u5b9a\u7684go\u5de5\u5177 version |print Go version|\u6253\u5370Go\u7248\u672c vet |report likely mistakes in packages|\u62a5\u544a\u5305\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef \u4f7f\u7528 go help \u547d\u4ee4 \u6765\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u547d\u4ee4\u7684\u4fe1\u606f\u3002 \u5176\u4ed6\u5e2e\u52a9\u4e3b\u9898\uff1a |\u4e3b\u9898|\u63cf\u8ff0|\u4e2d\u6587| ---|---|--- buildmode |build modes|\u7f16\u8bd1\u6a21\u5f0f c |calling between Go and C|\u5728GO\u548cC\u4e4b\u95f4\u8c03\u7528 cache |build and test caching|\u7f16\u8bd1\u548c\u6d4b\u8bd5\u7f13\u5b58 environment |environment variables|\u73af\u5883\u53d8\u91cf filetype |file types|\u6587\u4ef6\u7c7b\u578b go.mod |the go.mod file|go.mod\u6587\u4ef6 gopath |GOPATH environment variable|GOPATH\u73af\u5883\u53d8\u91cf gopath-get |legacy GOPATH go get| goproxy |module proxy protocol|\u6a21\u5757\u4ee3\u7406\u534f\u8bae importpath |import path syntax|\u5bfc\u5165\u8def\u5f84\u8bed\u6cd5 modules |modules, module versions, and more|\u6a21\u5757\u548c\u6a21\u5757\u7248\u672c\u7b49 module-get |module-aware go get| packages |package lists and patterns|\u5305\u5217\u8868\u548c\u6a21\u5f0f testflag |testing flags|\u6d4b\u8bd5\u6807\u5fd7 testfunc |testing functions|\u6d4b\u8bd5\u529f\u80fd \u4f7f\u7528 go help \u4e3b\u9898 \u6765\u83b7\u53d6\u66f4\u591a\u5173\u4e8e\u4e3b\u9898\u7684\u4fe1\u606f\u3002 go build \u9ed8\u8ba4\u4e0d\u4f1a\u7f16\u8bd1\u76ee\u6807\u4ee3\u7801\u5305\u6240\u4f9d\u8d56\u7684\u90a3\u4e9b\u4ee3\u7801\u5305\u3002 \u5982\u679c\u88ab\u4f9d\u8d56\u7684\u4ee3\u7801\u5305\u7684\u5f52\u6863\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u6e90\u7801\u6587\u4ef6\u6709\u4e86\u53d8\u5316\uff0c\u90a3\u4e48\u5b83\u8fd8\u662f\u4f1a\u88ab\u7f16\u8bd1\u7684 \u3002 \u7528\u6cd5\uff1a go build [-o output] [-i] [build flag] [packages] # \u7f16\u8bd1\u5bfc\u5165\u8def\u5f84\u547d\u540d\u7684\u5305\u4ee5\u53ca\u5b83\u7684\u4f9d\u8d56\u9879\uff0c\u4f46\u662f\u4e0d\u4f1a\u5b89\u88c5\u7f16\u8bd1\u7684\u7ed3\u679c # \u5982\u679c\u7f16\u8bd1\u7684\u53c2\u6570\u662f.go\u6587\u4ef6\u7684\u5217\u8868\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u5c06\u5b83\u4eec\u4f5c\u4e3a\u5355\u4e2a\u5305\u7684\u4e00\u7cfb\u5217\u6e90\u6587\u4ef6 \u7f16\u8bd1\u5355\u4e2a\u5305 \u5f53\u7f16\u8bd1\u5355\u4e2amain\u5305\u65f6\uff0c\u7f16\u8bd1\u8f93\u51fa\u7684\u7ed3\u679c\u6587\u4ef6\u547d\u540d\u5982\u4e0b\uff0c\uff08\u7f16\u5199windows\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u4ee5 .exe \u4e3a\u540e\u7f00\uff09\uff1a # \u540c\u4e00\u4e2amain\u5305\uff0c\u5bf9\u591a\u4e2a\u6e90\u6587\u4ef6\u7f16\u8bd1 go build ed.go rx.go # \u8f93\u51fa\u7ed3\u679c\u4e3a ed \u6216 ed.exe\uff0c\u4ee5\u7b2c\u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u540d\u4e3a\u8f93\u51fa\u6587\u4ef6\u540d # \u540c\u4e00\u4e2amain\u5305\uff0c\u5bf9\u6e90\u7801\u76ee\u5f55\u7f16\u8bd1 go build unix/sam # \u8f93\u51fa\u7ed3\u679c\u4e3a sam \u6216 sam.exe,\u4ee5\u6e90\u7801\u76ee\u5f55\u4e3a\u8f93\u51fa\u6587\u4ef6\u540d \u5f53\u7f16\u8bd1\u591a\u4e2a\u5305\u6216\u4e00\u4e2a\u975emain\u5305\u65f6\uff0c\u80fd\u591f\u7f16\u8bd1\u8fd9\u4e9b\u5305\u4f46\u4f1a\u4e22\u5f03\u7ed3\u679c\u6587\u4ef6\uff0c \u4ec5\u7528\u4f5c\u68c0\u67e5\u5305\u662f\u5426\u53ef\u4ee5\u7f16\u8bd1 \u3002 \u5728\u7f16\u8bd1\u5305\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u4f1a\u5ffd\u7565\u4ee5 _test.go \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002 \u53c2\u6570\u89e3\u91ca \u7f16\u8bd1\u65f6\u7528\u5230\u7684\u53c2\u6570\u6807\u5fd7\u88abbuild\u3001clean\u3001get\u3001install\u3001list\u3001run\u3001test\u5171\u4eab\u3002 -a \uff0c\u5f3a\u5236\u91cd\u65b0\u7f16\u8bd1\u6240\u6709\u4ee3\u7801\u5305\uff08\u542b\u6807\u51c6\u5e93\uff09 -i \uff0c\u5b89\u88c5\u88ab\u7f16\u8bd1\u76ee\u6807\u4f9d\u8d56\u7684\u5305 -n \uff0c\u4ec5\u663e\u793a\u7f16\u8bd1\u547d\u4ee4\uff0c\u4f46\u4e0d\u6267\u884c -o \uff0c\u53ea\u80fd\u5728\u7f16\u8bd1\u5355\u4e2a\u5305\u65f6\u4f7f\u7528\uff0c\u6307\u5b9a\u8f93\u51fa\u7ed3\u679c\u540d\uff08\u53d6\u4ee3\u4e0a\u9762\u4e24\u79cd\u65b9\u5f0f\u751f\u6210\u7684\u9ed8\u8ba4\u540d\uff09 -p n \uff0c\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982\u7f16\u8bd1\u547d\u4ee4\u6216\u6d4b\u8bd5\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f\u53ef\u7528\u7684CPU\u6570\u3002 -v \uff0c\u663e\u793a\u5f85\u7f16\u8bd1\u5305\u540d\uff0c\u901a\u5e38\u4e0e -a \u642d\u914d\u4f7f\u7528 -x \uff0c\u663e\u793a\u6b63\u5728\u6267\u884c\u7684\u7f16\u8bd1\u547d\u4ee4 asmflag ,\u4f20\u9012\u7ed9asm\u7684\u53c2\u6570 buildmode mode \uff0c\u7f16\u8bd1\u6a21\u5f0f compiler name \uff0c\u8981\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u540d\u79f0\uff08\u5982\u8fd0\u884c\u65f6\u7f16\u8bd1\u5668gccgo\u6216gc\uff09 gccflags ,\u4f20\u9012\u7ed9gcc\u7f16\u8bd1\u5668\u6216\u94fe\u63a5\u5668\u7684\u53c2\u6570 -gcflags \uff0c\u4f20\u9012\u7ed9\u7f16\u8bd1\u5668\u7684\u53c2\u6570 installsuffix suffix \uff0c\u5728\u4ee3\u7801\u5305\u5b89\u88c5\u76ee\u5f55\u540d\u79f0\u4e2d\u4f7f\u7528\u7684\u540e\u7f00\uff0c\u4ee5\u4fbf\u5c06\u8f93\u51fa\u4e0e\u9ed8\u8ba4\u7f16\u8bd1\u5206\u5f00 -ldflags \uff0c\u4f20\u9012\u7ed9\u94fe\u63a5\u5668\u7684\u53c2\u6570 linkshared ,\u94fe\u63a5\u4f7f\u7528 -buildmode=shared \u521b\u5efa\u7684\u5171\u4eab\u5e93 -mod mode \uff0c\u4e0b\u8f7d\u6a21\u5757\u6765\u4f7f\u7528\uff08readonly\u6216vendor\uff09 pkgdir dir ,\u4ecedir\u5b89\u88c5\u5e76\u52a0\u8f7d\u6240\u6709\u7684\u5305\uff08\u5982\u4f7f\u7528\u975e\u6807\u51c6\u7f16\u8bd1\u65f6\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\u5c06\u751f\u6210\u7684\u5305\u4fdd\u5b58\u5728\u5355\u72ec\u7684\u4f4d\u7f6e\uff09 masn \uff0c\u542f\u52a8\u4e0e\u5185\u5b58\u6e05\u7406\u7a0b\u5e8f\u7684\u4e92\u64cd\u4f5c\uff08\u4ec5\u652f\u6301amd64\uff0cclang/LLVM\u4f5c\u4e3aC\u7f16\u8bd1\u5668\uff09 -race ,\u542f\u52a8\u6570\u636e\u7ade\u4e89\u68c0\u67e5\uff08\u4ec5\u652f\u6301amd64\uff09 tags \uff0c \u4ee5\u7a7a\u683c\u5206\u9694\u7684\u7f16\u8bd1\u6807\u5fd7\u5217\u8868 toolexec \uff0c\u7528\u4e8e\u8c03\u7528vet\u548casm\u7b49\u5de5\u5177\u94fe\u7a0b\u5e8f\u7684\u7a0b\u5e8f -work ,\u663e\u793a\u4e34\u65f6\u5de5\u4f5c\u76ee\u5f55\uff0c\u5b8c\u6210\u540e\u4e0d\u5220\u9664 go get go get\u547d\u4ee4\u4f1a\u81ea\u52a8\u4ece\u4e00\u4e9b\u4e3b\u6d41\u7684\u516c\u7528\u4ee3\u7801\u5e93\uff08\u5982GitHub\uff09\u4e0b\u8f7d\u76ee\u6807\u4ee3\u7801\u5305\uff0c\u5e76\u5b89\u88c5\u5230GOPATH\u5185 \u7b2c\u4e00\u4e2a\u5de5\u4f5c\u533a \u5bf9\u5e94\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u5b58\u5728GOBIN\u73af\u5883\u53d8\u91cf\uff0c\u90a3\u4e48 \u4ec5\u5305\u542b\u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u7684\u4ee3\u7801\u4f1a\u88ab\u5b89\u88c5\u5230GOBIN\u6307\u5411\u7684\u76ee\u5f55\u4e2d\u3002 \u7528\u6cd5: go get [-d] [-f] [-t] [-u] [-v] [-fix] [-insecure] [build flags] [packages] \u53c2\u6570\u89e3\u91ca -d \uff0c\u53ea\u4e0b\u8f7d\u4ee3\u7801\u5305\uff0c\u4e0d\u5b89\u88c5 -f ,\u4ec5\u5728\u8bbe\u7f6e -u \u65f6\u6709\u6548\uff0c\u5f3a\u5236 get -u \u4e0d\u9a8c\u8bc1\u4ee3\u7801\u5305\u662f\u5426\u4e3a\u6e90\u4ed3\u5e93\u7684\u5206\u652f\uff08\u5982\u679c\u6e90\u662f\u539f\u59cb\u4ee3\u7801\u7684\u672c\u5730\u5206\u652f\uff0c\u8fd9\u5f88\u6709\u7528\uff09 -fix \uff0c\u5728\u4e0b\u8f7d\u4ee3\u7801\u5305\u540e\u5148\u6839\u636e\u5f53\u524dGo\u7248\u672c\u6267\u884c\u4ee3\u7801\u4fee\u6b63\u5de5\u5177\uff0c\u7136\u540e\u518d\u8fdb\u884c\u4f9d\u8d56\u9879\u89e3\u6790\u6216\u7f16\u8bd1\u4ee3\u7801\u5305 -insecure \uff0c\u5141\u8bb8\u901a\u8fc7\u975e\u5b89\u5168\u7684\u7f51\u7edc\u534f\u8bae\uff08\u5982HTTP\uff09\u4e0b\u8f7d\u548c\u5b89\u88c5\u4ee3\u7801\u5305 -t \uff0c\u540c\u65f6\u4e0b\u8f7d\u6d4b\u8bd5\u6240\u9700\u7684\u4ee3\u7801\u5305 -u \uff0c\u901a\u8fc7\u7f51\u7edc\u66f4\u65b0\u6307\u5b9a\u7684\u4ee3\u7801\u5305\u548c\u5b83\u7684\u4f9d\u8d56\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cget\u4f7f\u7528\u7f51\u7edc\u68c0\u67e5\u51fa\u7f3a\u5931\u7684\u5305\uff0c\u4f46\u4e0d\u4f7f\u7528\u5b83\u6765\u67e5\u627e\u73b0\u6709\u5305\u7684\u66f4\u65b0\uff09 -v \uff0c\u542f\u7528\u8be6\u7ec6\u8fdb\u5ea6\u548c\u8c03\u8bd5\u8f93\u51fa get\u547d\u4ee4\u540c\u6837\u652f\u6301\u4f7f\u7528build\u7684\u53c2\u6570\u6765\u63a7\u5236\u5b89\u88c5\u8fc7\u7a0b\u3002 Go\u8bed\u8a00\u5b98\u65b9\u63d0\u4f9b\u7684go get\u547d\u4ee4\u662f\u975e\u5e38\u57fa\u7840\u7684\uff0c\u5176\u4e2d\u5e76\u6ca1\u6709\u63d0\u4f9b \u4f9d\u8d56\u7ba1\u7406\u529f\u80fd \u3002\u76ee\u524dGitHub\u4e0a\u6709\u5f88\u591a\u63d0\u4f9b\u8fd9\u7c7b\u529f\u80fd\u7684\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u6bd4\u5982glide\u3001gb\u4ee5\u53ca\u5b98\u65b9\u51fa\u54c1\u7684dep\u3001vgo\u7b49\uff0c\u5b83\u4eec\u5728\u5185\u90e8\u5927\u591a\u4f1a\u76f4\u63a5\u53d7\u7528go get\u3002 \u67e5\u770b\u6216\u66f4\u65b0\u4ee3\u7801\u5305\u65f6\uff0c\u67e5\u627e\u6e90\u7aef\u4e0e\u672c\u5730\u5b89\u88c5\u7684Go\u7248\u672c\u5339\u914d\u7684\u5206\u652f\u6216\u6807\u8bb0\u3002 \u5982\u679c\u672c\u5730\u5b89\u88c5\u8fd0\u884c\u7248\u672c\u4e3a\u201cgo1\u201d\uff0c\u5219\u641c\u7d22\u540d\u4e3a\u201cgo1\u201d\u7684\u5206\u652f\u6216\u6807\u8bb0\u3002 \u5982\u679c\u4e0d\u5b58\u5728\u6b64\u7c7b\u7248\u672c\uff0c\u5219\u4f1a\u68c0\u7d22\u5305\u7684\u9ed8\u8ba4\u5206\u652f\u3002 \u5f53get\u67e5\u770b\u6216\u66f4\u65b0git\u5b58\u50a8\u5e93\u662f\uff0c\u5b83\u8fd8\u4f1a\u66f4\u65b0\u5b58\u50a8\u5e93\u5f15\u7528\u7684\u4efb\u4f55git\u5b50\u6a21\u5757\u3002 \u4fee\u6539\u6e90\u7801\u5b58\u50a8\u8def\u5f84 \u5f53\u4fee\u6539\u5b58\u50a8\u6e90\u7801\u7684\u4ee3\u7801\u4ed3\u5e93\u6216\u8005\u4ee3\u7801\u5305\u7684\u76f8\u5bf9\u8def\u5f84\u65f6\uff0c\u4e3a\u4e86\u8ba9\u4ee3\u7801\u5305\u7684\u8fdc\u7a0b\u5bfc\u5165\u8def\u5f84\u4e0d\u53d7\u6b64\u7c7b\u53d8\u66f4\u7684\u5f71\u54cd\uff0c\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u4ee3\u7801\u5305\u5bfc\u5165\u8def\u5f84\u3002 \u5bf9\u4ee3\u7801\u5305\u7684\u8fdc\u7a0b\u5bfc\u5165\u8def\u5f84\u8fdb\u884c\u81ea\u5b9a\u4e49\uff1a\u5728\u8be5\u4ee3\u7801\u5305\u4e2d\u7684 \u5e93\u6e90\u7801\u6587\u4ef6 \u7684\u5305\u58f0\u660e\u8bed\u53e5\u7684\u53f3\u4fa7\u52a0\u5165\u5bfc\u5165\u6ce8\u91ca\uff0c\u5982\u4e0b\uff1a package semaphore // import golang.org/x/sync/semaphore \u8fd9\u4e2a\u4ee3\u7801\u5305\u539f\u6765\u7684\u5b8c\u6574\u5bfc\u5165\u8def\u5f84\u662f github/golang/x/sync/semaphore \uff0c\u8fd9\u4e0e\u5b9e\u9645\u5b58\u50a8\u5b83\u7684\u7f51\u7edc\u5730\u5740\u4e00\u6837,\u8be5\u4ee3\u7801\u5305\u7684\u6e90\u7801\u5b9e\u9645\u5b58\u653e\u5728GitHub\u7f51\u7ad9\u7684golang\u7ec4\u7684sync\u4ee3\u7801\u4ed3\u5e93\u7684semaphore\u76ee\u5f55\u4e0b\u3002\u52a0\u5165\u5bfc\u5165\u6ce8\u91ca\u540e\uff0c\u7528\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u4e0b\u8f7d\u5e76\u5b89\u88c5\u8be5\u4ee3\u7801\u5305\u4e86\uff1a go get golang.org/x/sync/semaphore \u5728Go\u8bed\u8a00\u5b98\u7f51golang.org\u4e0b\u7684\u8def\u5f84 /x/sync/semaphore \u5e76\u4e0d\u5b58\u653esemaphore\u5305\u7684\u771f\u5b9e\u5730\u5740\u3002\u79f0\u4e4b\u4e3a\u4ee3\u7801\u5305\u7684\u81ea\u5b9a\u4e49\u5bfc\u5165\u8def\u5f84\u3002 \u4e0d\u8fc7\uff0c\u8fd9\u8fd8\u662f\u9700\u8981\u5728golang.org\u8fd9\u4e2a\u57df\u540d\u80cc\u540e\u7684\u670d\u52a1\u7aef\u7a0b\u5e8f\u4e0a\uff0c\u6dfb\u52a0\u4e00\u4e9b\u652f\u6301\u624d\u80fd\u4f7f\u8fd9\u6761\u547d\u4ee4\u6210\u529f\u3002\u5177\u4f53\u53c2\u8003\u8fd9\u91cc\uff1ahttps://github.com/hyper0x/go_command_tutorial/blob/master/0.3.md","title":"00 Go\u5de5\u5177"},{"location":"Language/Basic/00-Go\u5de5\u5177/#go-build","text":"\u9ed8\u8ba4\u4e0d\u4f1a\u7f16\u8bd1\u76ee\u6807\u4ee3\u7801\u5305\u6240\u4f9d\u8d56\u7684\u90a3\u4e9b\u4ee3\u7801\u5305\u3002 \u5982\u679c\u88ab\u4f9d\u8d56\u7684\u4ee3\u7801\u5305\u7684\u5f52\u6863\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u6216\u8005\u6e90\u7801\u6587\u4ef6\u6709\u4e86\u53d8\u5316\uff0c\u90a3\u4e48\u5b83\u8fd8\u662f\u4f1a\u88ab\u7f16\u8bd1\u7684 \u3002 \u7528\u6cd5\uff1a go build [-o output] [-i] [build flag] [packages] # \u7f16\u8bd1\u5bfc\u5165\u8def\u5f84\u547d\u540d\u7684\u5305\u4ee5\u53ca\u5b83\u7684\u4f9d\u8d56\u9879\uff0c\u4f46\u662f\u4e0d\u4f1a\u5b89\u88c5\u7f16\u8bd1\u7684\u7ed3\u679c # \u5982\u679c\u7f16\u8bd1\u7684\u53c2\u6570\u662f.go\u6587\u4ef6\u7684\u5217\u8868\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u5c06\u5b83\u4eec\u4f5c\u4e3a\u5355\u4e2a\u5305\u7684\u4e00\u7cfb\u5217\u6e90\u6587\u4ef6 \u7f16\u8bd1\u5355\u4e2a\u5305 \u5f53\u7f16\u8bd1\u5355\u4e2amain\u5305\u65f6\uff0c\u7f16\u8bd1\u8f93\u51fa\u7684\u7ed3\u679c\u6587\u4ef6\u547d\u540d\u5982\u4e0b\uff0c\uff08\u7f16\u5199windows\u53ef\u6267\u884c\u6587\u4ef6\u65f6\uff0c\u4ee5 .exe \u4e3a\u540e\u7f00\uff09\uff1a # \u540c\u4e00\u4e2amain\u5305\uff0c\u5bf9\u591a\u4e2a\u6e90\u6587\u4ef6\u7f16\u8bd1 go build ed.go rx.go # \u8f93\u51fa\u7ed3\u679c\u4e3a ed \u6216 ed.exe\uff0c\u4ee5\u7b2c\u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u540d\u4e3a\u8f93\u51fa\u6587\u4ef6\u540d # \u540c\u4e00\u4e2amain\u5305\uff0c\u5bf9\u6e90\u7801\u76ee\u5f55\u7f16\u8bd1 go build unix/sam # \u8f93\u51fa\u7ed3\u679c\u4e3a sam \u6216 sam.exe,\u4ee5\u6e90\u7801\u76ee\u5f55\u4e3a\u8f93\u51fa\u6587\u4ef6\u540d \u5f53\u7f16\u8bd1\u591a\u4e2a\u5305\u6216\u4e00\u4e2a\u975emain\u5305\u65f6\uff0c\u80fd\u591f\u7f16\u8bd1\u8fd9\u4e9b\u5305\u4f46\u4f1a\u4e22\u5f03\u7ed3\u679c\u6587\u4ef6\uff0c \u4ec5\u7528\u4f5c\u68c0\u67e5\u5305\u662f\u5426\u53ef\u4ee5\u7f16\u8bd1 \u3002 \u5728\u7f16\u8bd1\u5305\u7684\u65f6\u5019\uff0c\u7f16\u8bd1\u8fc7\u7a0b\u4f1a\u5ffd\u7565\u4ee5 _test.go \u7ed3\u5c3e\u7684\u6587\u4ef6\u3002","title":"go build"},{"location":"Language/Basic/00-Go\u5de5\u5177/#_1","text":"\u7f16\u8bd1\u65f6\u7528\u5230\u7684\u53c2\u6570\u6807\u5fd7\u88abbuild\u3001clean\u3001get\u3001install\u3001list\u3001run\u3001test\u5171\u4eab\u3002 -a \uff0c\u5f3a\u5236\u91cd\u65b0\u7f16\u8bd1\u6240\u6709\u4ee3\u7801\u5305\uff08\u542b\u6807\u51c6\u5e93\uff09 -i \uff0c\u5b89\u88c5\u88ab\u7f16\u8bd1\u76ee\u6807\u4f9d\u8d56\u7684\u5305 -n \uff0c\u4ec5\u663e\u793a\u7f16\u8bd1\u547d\u4ee4\uff0c\u4f46\u4e0d\u6267\u884c -o \uff0c\u53ea\u80fd\u5728\u7f16\u8bd1\u5355\u4e2a\u5305\u65f6\u4f7f\u7528\uff0c\u6307\u5b9a\u8f93\u51fa\u7ed3\u679c\u540d\uff08\u53d6\u4ee3\u4e0a\u9762\u4e24\u79cd\u65b9\u5f0f\u751f\u6210\u7684\u9ed8\u8ba4\u540d\uff09 -p n \uff0c\u53ef\u4ee5\u5e76\u884c\u8fd0\u884c\u7684\u7a0b\u5e8f\uff08\u4f8b\u5982\u7f16\u8bd1\u547d\u4ee4\u6216\u6d4b\u8bd5\u4e8c\u8fdb\u5236\u6587\u4ef6\uff09\u7684\u6570\u91cf\u3002\u9ed8\u8ba4\u503c\u662f\u53ef\u7528\u7684CPU\u6570\u3002 -v \uff0c\u663e\u793a\u5f85\u7f16\u8bd1\u5305\u540d\uff0c\u901a\u5e38\u4e0e -a \u642d\u914d\u4f7f\u7528 -x \uff0c\u663e\u793a\u6b63\u5728\u6267\u884c\u7684\u7f16\u8bd1\u547d\u4ee4 asmflag ,\u4f20\u9012\u7ed9asm\u7684\u53c2\u6570 buildmode mode \uff0c\u7f16\u8bd1\u6a21\u5f0f compiler name \uff0c\u8981\u4f7f\u7528\u7684\u7f16\u8bd1\u5668\u540d\u79f0\uff08\u5982\u8fd0\u884c\u65f6\u7f16\u8bd1\u5668gccgo\u6216gc\uff09 gccflags ,\u4f20\u9012\u7ed9gcc\u7f16\u8bd1\u5668\u6216\u94fe\u63a5\u5668\u7684\u53c2\u6570 -gcflags \uff0c\u4f20\u9012\u7ed9\u7f16\u8bd1\u5668\u7684\u53c2\u6570 installsuffix suffix \uff0c\u5728\u4ee3\u7801\u5305\u5b89\u88c5\u76ee\u5f55\u540d\u79f0\u4e2d\u4f7f\u7528\u7684\u540e\u7f00\uff0c\u4ee5\u4fbf\u5c06\u8f93\u51fa\u4e0e\u9ed8\u8ba4\u7f16\u8bd1\u5206\u5f00 -ldflags \uff0c\u4f20\u9012\u7ed9\u94fe\u63a5\u5668\u7684\u53c2\u6570 linkshared ,\u94fe\u63a5\u4f7f\u7528 -buildmode=shared \u521b\u5efa\u7684\u5171\u4eab\u5e93 -mod mode \uff0c\u4e0b\u8f7d\u6a21\u5757\u6765\u4f7f\u7528\uff08readonly\u6216vendor\uff09 pkgdir dir ,\u4ecedir\u5b89\u88c5\u5e76\u52a0\u8f7d\u6240\u6709\u7684\u5305\uff08\u5982\u4f7f\u7528\u975e\u6807\u51c6\u7f16\u8bd1\u65f6\uff0c\u4f7f\u7528\u8be5\u53c2\u6570\u5c06\u751f\u6210\u7684\u5305\u4fdd\u5b58\u5728\u5355\u72ec\u7684\u4f4d\u7f6e\uff09 masn \uff0c\u542f\u52a8\u4e0e\u5185\u5b58\u6e05\u7406\u7a0b\u5e8f\u7684\u4e92\u64cd\u4f5c\uff08\u4ec5\u652f\u6301amd64\uff0cclang/LLVM\u4f5c\u4e3aC\u7f16\u8bd1\u5668\uff09 -race ,\u542f\u52a8\u6570\u636e\u7ade\u4e89\u68c0\u67e5\uff08\u4ec5\u652f\u6301amd64\uff09 tags \uff0c \u4ee5\u7a7a\u683c\u5206\u9694\u7684\u7f16\u8bd1\u6807\u5fd7\u5217\u8868 toolexec \uff0c\u7528\u4e8e\u8c03\u7528vet\u548casm\u7b49\u5de5\u5177\u94fe\u7a0b\u5e8f\u7684\u7a0b\u5e8f -work ,\u663e\u793a\u4e34\u65f6\u5de5\u4f5c\u76ee\u5f55\uff0c\u5b8c\u6210\u540e\u4e0d\u5220\u9664","title":"\u53c2\u6570\u89e3\u91ca"},{"location":"Language/Basic/00-Go\u5de5\u5177/#go-get","text":"go get\u547d\u4ee4\u4f1a\u81ea\u52a8\u4ece\u4e00\u4e9b\u4e3b\u6d41\u7684\u516c\u7528\u4ee3\u7801\u5e93\uff08\u5982GitHub\uff09\u4e0b\u8f7d\u76ee\u6807\u4ee3\u7801\u5305\uff0c\u5e76\u5b89\u88c5\u5230GOPATH\u5185 \u7b2c\u4e00\u4e2a\u5de5\u4f5c\u533a \u5bf9\u5e94\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u5b58\u5728GOBIN\u73af\u5883\u53d8\u91cf\uff0c\u90a3\u4e48 \u4ec5\u5305\u542b\u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u7684\u4ee3\u7801\u4f1a\u88ab\u5b89\u88c5\u5230GOBIN\u6307\u5411\u7684\u76ee\u5f55\u4e2d\u3002 \u7528\u6cd5: go get [-d] [-f] [-t] [-u] [-v] [-fix] [-insecure] [build flags] [packages]","title":"go get"},{"location":"Language/Basic/00-Go\u5de5\u5177/#_2","text":"-d \uff0c\u53ea\u4e0b\u8f7d\u4ee3\u7801\u5305\uff0c\u4e0d\u5b89\u88c5 -f ,\u4ec5\u5728\u8bbe\u7f6e -u \u65f6\u6709\u6548\uff0c\u5f3a\u5236 get -u \u4e0d\u9a8c\u8bc1\u4ee3\u7801\u5305\u662f\u5426\u4e3a\u6e90\u4ed3\u5e93\u7684\u5206\u652f\uff08\u5982\u679c\u6e90\u662f\u539f\u59cb\u4ee3\u7801\u7684\u672c\u5730\u5206\u652f\uff0c\u8fd9\u5f88\u6709\u7528\uff09 -fix \uff0c\u5728\u4e0b\u8f7d\u4ee3\u7801\u5305\u540e\u5148\u6839\u636e\u5f53\u524dGo\u7248\u672c\u6267\u884c\u4ee3\u7801\u4fee\u6b63\u5de5\u5177\uff0c\u7136\u540e\u518d\u8fdb\u884c\u4f9d\u8d56\u9879\u89e3\u6790\u6216\u7f16\u8bd1\u4ee3\u7801\u5305 -insecure \uff0c\u5141\u8bb8\u901a\u8fc7\u975e\u5b89\u5168\u7684\u7f51\u7edc\u534f\u8bae\uff08\u5982HTTP\uff09\u4e0b\u8f7d\u548c\u5b89\u88c5\u4ee3\u7801\u5305 -t \uff0c\u540c\u65f6\u4e0b\u8f7d\u6d4b\u8bd5\u6240\u9700\u7684\u4ee3\u7801\u5305 -u \uff0c\u901a\u8fc7\u7f51\u7edc\u66f4\u65b0\u6307\u5b9a\u7684\u4ee3\u7801\u5305\u548c\u5b83\u7684\u4f9d\u8d56\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cget\u4f7f\u7528\u7f51\u7edc\u68c0\u67e5\u51fa\u7f3a\u5931\u7684\u5305\uff0c\u4f46\u4e0d\u4f7f\u7528\u5b83\u6765\u67e5\u627e\u73b0\u6709\u5305\u7684\u66f4\u65b0\uff09 -v \uff0c\u542f\u7528\u8be6\u7ec6\u8fdb\u5ea6\u548c\u8c03\u8bd5\u8f93\u51fa get\u547d\u4ee4\u540c\u6837\u652f\u6301\u4f7f\u7528build\u7684\u53c2\u6570\u6765\u63a7\u5236\u5b89\u88c5\u8fc7\u7a0b\u3002 Go\u8bed\u8a00\u5b98\u65b9\u63d0\u4f9b\u7684go get\u547d\u4ee4\u662f\u975e\u5e38\u57fa\u7840\u7684\uff0c\u5176\u4e2d\u5e76\u6ca1\u6709\u63d0\u4f9b \u4f9d\u8d56\u7ba1\u7406\u529f\u80fd \u3002\u76ee\u524dGitHub\u4e0a\u6709\u5f88\u591a\u63d0\u4f9b\u8fd9\u7c7b\u529f\u80fd\u7684\u7b2c\u4e09\u65b9\u5de5\u5177\uff0c\u6bd4\u5982glide\u3001gb\u4ee5\u53ca\u5b98\u65b9\u51fa\u54c1\u7684dep\u3001vgo\u7b49\uff0c\u5b83\u4eec\u5728\u5185\u90e8\u5927\u591a\u4f1a\u76f4\u63a5\u53d7\u7528go get\u3002 \u67e5\u770b\u6216\u66f4\u65b0\u4ee3\u7801\u5305\u65f6\uff0c\u67e5\u627e\u6e90\u7aef\u4e0e\u672c\u5730\u5b89\u88c5\u7684Go\u7248\u672c\u5339\u914d\u7684\u5206\u652f\u6216\u6807\u8bb0\u3002 \u5982\u679c\u672c\u5730\u5b89\u88c5\u8fd0\u884c\u7248\u672c\u4e3a\u201cgo1\u201d\uff0c\u5219\u641c\u7d22\u540d\u4e3a\u201cgo1\u201d\u7684\u5206\u652f\u6216\u6807\u8bb0\u3002 \u5982\u679c\u4e0d\u5b58\u5728\u6b64\u7c7b\u7248\u672c\uff0c\u5219\u4f1a\u68c0\u7d22\u5305\u7684\u9ed8\u8ba4\u5206\u652f\u3002 \u5f53get\u67e5\u770b\u6216\u66f4\u65b0git\u5b58\u50a8\u5e93\u662f\uff0c\u5b83\u8fd8\u4f1a\u66f4\u65b0\u5b58\u50a8\u5e93\u5f15\u7528\u7684\u4efb\u4f55git\u5b50\u6a21\u5757\u3002","title":"\u53c2\u6570\u89e3\u91ca"},{"location":"Language/Basic/00-Go\u5de5\u5177/#_3","text":"\u5f53\u4fee\u6539\u5b58\u50a8\u6e90\u7801\u7684\u4ee3\u7801\u4ed3\u5e93\u6216\u8005\u4ee3\u7801\u5305\u7684\u76f8\u5bf9\u8def\u5f84\u65f6\uff0c\u4e3a\u4e86\u8ba9\u4ee3\u7801\u5305\u7684\u8fdc\u7a0b\u5bfc\u5165\u8def\u5f84\u4e0d\u53d7\u6b64\u7c7b\u53d8\u66f4\u7684\u5f71\u54cd\uff0c\u53ef\u4ee5\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u4ee3\u7801\u5305\u5bfc\u5165\u8def\u5f84\u3002 \u5bf9\u4ee3\u7801\u5305\u7684\u8fdc\u7a0b\u5bfc\u5165\u8def\u5f84\u8fdb\u884c\u81ea\u5b9a\u4e49\uff1a\u5728\u8be5\u4ee3\u7801\u5305\u4e2d\u7684 \u5e93\u6e90\u7801\u6587\u4ef6 \u7684\u5305\u58f0\u660e\u8bed\u53e5\u7684\u53f3\u4fa7\u52a0\u5165\u5bfc\u5165\u6ce8\u91ca\uff0c\u5982\u4e0b\uff1a package semaphore // import golang.org/x/sync/semaphore \u8fd9\u4e2a\u4ee3\u7801\u5305\u539f\u6765\u7684\u5b8c\u6574\u5bfc\u5165\u8def\u5f84\u662f github/golang/x/sync/semaphore \uff0c\u8fd9\u4e0e\u5b9e\u9645\u5b58\u50a8\u5b83\u7684\u7f51\u7edc\u5730\u5740\u4e00\u6837,\u8be5\u4ee3\u7801\u5305\u7684\u6e90\u7801\u5b9e\u9645\u5b58\u653e\u5728GitHub\u7f51\u7ad9\u7684golang\u7ec4\u7684sync\u4ee3\u7801\u4ed3\u5e93\u7684semaphore\u76ee\u5f55\u4e0b\u3002\u52a0\u5165\u5bfc\u5165\u6ce8\u91ca\u540e\uff0c\u7528\u4ee5\u4e0b\u547d\u4ee4\u5373\u53ef\u4e0b\u8f7d\u5e76\u5b89\u88c5\u8be5\u4ee3\u7801\u5305\u4e86\uff1a go get golang.org/x/sync/semaphore \u5728Go\u8bed\u8a00\u5b98\u7f51golang.org\u4e0b\u7684\u8def\u5f84 /x/sync/semaphore \u5e76\u4e0d\u5b58\u653esemaphore\u5305\u7684\u771f\u5b9e\u5730\u5740\u3002\u79f0\u4e4b\u4e3a\u4ee3\u7801\u5305\u7684\u81ea\u5b9a\u4e49\u5bfc\u5165\u8def\u5f84\u3002 \u4e0d\u8fc7\uff0c\u8fd9\u8fd8\u662f\u9700\u8981\u5728golang.org\u8fd9\u4e2a\u57df\u540d\u80cc\u540e\u7684\u670d\u52a1\u7aef\u7a0b\u5e8f\u4e0a\uff0c\u6dfb\u52a0\u4e00\u4e9b\u652f\u6301\u624d\u80fd\u4f7f\u8fd9\u6761\u547d\u4ee4\u6210\u529f\u3002\u5177\u4f53\u53c2\u8003\u8fd9\u91cc\uff1ahttps://github.com/hyper0x/go_command_tutorial/blob/master/0.3.md","title":"\u4fee\u6539\u6e90\u7801\u5b58\u50a8\u8def\u5f84"},{"location":"Language/Basic/00-\u7a0b\u5e8f\u7ed3\u6784/","text":"\u7a0b\u5e8f\u7ed3\u6784 Go\u8bed\u8a00\u7684\u5927\u7a0b\u5e8f\u90fd\u4ece\u5c0f\u7684\u57fa\u672c\u7ec4\u4ef6\u6784\u5efa\u800c\u6765\u3002 \u53d8\u91cf \u5b58\u50a8\u503c \u7b80\u5355\u8868\u8fbe\u5f0f \u901a\u8fc7\u52a0\u51cf\u64cd\u4f5c\u5408\u5e76\u6210\u4e3a\u5927\u7684 \u57fa\u672c\u7c7b\u578b \u901a\u8fc7\u6570\u7ec4\u548c\u7ed3\u6784\u4f53\u8fdb\u884c\u805a\u5408 \u8868\u8fbe\u5f0f \u901a\u8fc7if\u548cfor\u7b49\u63a7\u5236\u8bed\u53e5\u6765\u51b3\u5b9a\u6267\u884c\u7684\u987a\u5e8f \u8bed\u53e5 \u88ab\u7ec4\u7ec7\u6210\u51fd\u6570\u7528\u4e8e\u9694\u79bb\u548c\u590d\u7528 \u51fd\u6570 \u7ec4\u7ec7\u6210\u6e90\u6587\u4ef6\u548c\u4ee3\u7801\u5305 \u540d\u79f0 Go\u4e2d\u51fd\u6570\u3001\u53d8\u91cf\u3001\u5e38\u91cf\u3001\u7c7b\u578b\u3001\u8bed\u53e5\u6807\u7b7e\u548c\u5305\u7684\u540d\u79f0\u90fd\u9075\u5faa\u5982\u4e0b\u89c4\u5219\uff1a \u540d\u79f0\u7684\u5f00\u5934\u662f\u4e00\u4e2a\u5b57\u6bcd\uff08Unicode\u4e2d\u7684\u5b57\u7b26\u5373\u53ef\uff09\u6216\u8005\u4e0b\u5212\u7ebf\uff0c\u540e\u9762\u53ef\u4ee5\u8ddf\u4efb\u610f\u6570\u91cf\u7684\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u5bf9\u5927\u5c0f\u5199\u654f\u611f\u3002 Go\u670925\u4e2a\u5173\u952e\u5b57\uff1a\u53ea\u80fd\u7528\u5728\u8bed\u6cd5\u5141\u8bb8\u7684\u5730\u65b9\uff1a \u5b57\u6bcd\u987a\u5e8f \u5173\u952e\u5b57 b break c case\u3001chan\u3001const\u3001continue d default\u3001defer e else f func\u3001fallthrough\u3001for g go\u3001goto i interface\u3001if\u3001import m map p package r range\u3001return s select\u3001struct\u3001switch t type v var Go\u670930\u591a\u4e2a\u5185\u7f6e\u7684\u9884\u58f0\u660e\u7684\u5e38\u91cf\u3001\u7c7b\u578b\u548c\u51fd\u6570\uff1a \u79cd\u7c7b \u5173\u952e\u5b57 \u5e38\u91cf true\u3001false\u3001iota\u3001nil int\u7c7b\u578b int\u3001int8\u3001int16\u3001int32\u3001int64 unit\u7c7b\u578b uint\u3001uint8\u3001unit16\u3001uint32\u3001unit64\u3001uintptr float\u7c7b\u578b float32\u3001float64\u3001complex64\u3001conplex64 \u5176\u4ed6\u7c7b\u578b bool\u3001byte\u3001rune\u3001string\u3001error \u51fd\u6570 make\u3001len\u3001cap\u3001new\u3001append\u3001copy\u3001close\u3001delete\u3001complex\u3001real\u3001imag\u3001panic\u3001recover \u8fd9\u4e9b\u540d\u79f0\u4e0d\u662f\u9884\u7559\u7684\uff0c\u53ef\u4ee5\u5728\u58f0\u660e\u4e2d\u4f7f\u7528\u5b83\u4eec\uff08\u5373\u5bf9\u8fd9\u4e9b\u540d\u79f0\u8fdb\u884c\u91cd\u58f0\u660e\uff09\uff0c\u4f46\u662f\u8fd9\u6837\u662f\u6709\u51b2\u7a81\u98ce\u9669\u7684\u3002 \u5982\u679c\u4e00\u4e2a\u5b9e\u4f53\u5728\u51fd\u6570\u5185\u58f0\u660e\u3002\u5b83\u53ea\u5728 \u51fd\u6570\u5c40\u90e8 \u6709\u6548 \u5982\u679c\u4e00\u4e2a\u5b9e\u4f53\u5728\u51fd\u6570\u5916\u58f0\u660e\uff0c\u5b83\u5c06\u5bf9 \u5305\u91cc\u9762\u7684\u6240\u6709\u6e90\u6587\u4ef6 \u53ef\u89c1 \u5b9e\u4f53\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f\u5426\u5927\u5199\u51b3\u5b9a\u4e86\u5176\u53ef\u89c1\u6027\u662f\u5426 \u8de8\u5305 \u3002\u5982fmt\u5305\u4e2d\u7684 Printf \u51fd\u6570\uff0c\u5305\u540d\u603b\u662f\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u3002 \u540d\u79f0\u7684\u957f\u5ea6\u6ca1\u6709\u9650\u5236\uff0c\u901a\u5e38\u4f5c\u7528\u57df\u8d8a\u5927\uff0c\u5c31\u662f\u8d8a\u957f\u4e14\u6709\u610f\u4e49\u7684\u540d\u79f0\u3002\u5f53\u7531\u591a\u4e2a\u5355\u8bcd\u7ec4\u6210\u65f6\uff0c\u901a\u5e38\u91c7\u7528 \u9a7c\u5cf0\u5f0f \u7684\u98ce\u683c\uff0c\u800c\u4e0d\u662f\u4e0b\u5212\u7ebf\u3002\u5f53\u5355\u8bcd\u4e2d\u5305\u542b\u9996\u5b57\u6bcd\u7f29\u5199\u7ec4\u6210\u7684\u5355\u8bcd\u65f6\uff08\u5982ASCII\u3001HTML\u8fd9\u6837\u7684\uff09\uff0c\u901a\u5e38\u4f7f\u7528\u76f8\u540c\u7684\u5927\u5c0f\u5199\uff08\u5168\u5927\u5199\u6216\u5168\u5c0f\u5199\uff09\u3002 \u58f0\u660e","title":"\u7a0b\u5e8f\u7ed3\u6784"},{"location":"Language/Basic/00-\u7a0b\u5e8f\u7ed3\u6784/#_1","text":"Go\u8bed\u8a00\u7684\u5927\u7a0b\u5e8f\u90fd\u4ece\u5c0f\u7684\u57fa\u672c\u7ec4\u4ef6\u6784\u5efa\u800c\u6765\u3002 \u53d8\u91cf \u5b58\u50a8\u503c \u7b80\u5355\u8868\u8fbe\u5f0f \u901a\u8fc7\u52a0\u51cf\u64cd\u4f5c\u5408\u5e76\u6210\u4e3a\u5927\u7684 \u57fa\u672c\u7c7b\u578b \u901a\u8fc7\u6570\u7ec4\u548c\u7ed3\u6784\u4f53\u8fdb\u884c\u805a\u5408 \u8868\u8fbe\u5f0f \u901a\u8fc7if\u548cfor\u7b49\u63a7\u5236\u8bed\u53e5\u6765\u51b3\u5b9a\u6267\u884c\u7684\u987a\u5e8f \u8bed\u53e5 \u88ab\u7ec4\u7ec7\u6210\u51fd\u6570\u7528\u4e8e\u9694\u79bb\u548c\u590d\u7528 \u51fd\u6570 \u7ec4\u7ec7\u6210\u6e90\u6587\u4ef6\u548c\u4ee3\u7801\u5305","title":"\u7a0b\u5e8f\u7ed3\u6784"},{"location":"Language/Basic/00-\u7a0b\u5e8f\u7ed3\u6784/#_2","text":"Go\u4e2d\u51fd\u6570\u3001\u53d8\u91cf\u3001\u5e38\u91cf\u3001\u7c7b\u578b\u3001\u8bed\u53e5\u6807\u7b7e\u548c\u5305\u7684\u540d\u79f0\u90fd\u9075\u5faa\u5982\u4e0b\u89c4\u5219\uff1a \u540d\u79f0\u7684\u5f00\u5934\u662f\u4e00\u4e2a\u5b57\u6bcd\uff08Unicode\u4e2d\u7684\u5b57\u7b26\u5373\u53ef\uff09\u6216\u8005\u4e0b\u5212\u7ebf\uff0c\u540e\u9762\u53ef\u4ee5\u8ddf\u4efb\u610f\u6570\u91cf\u7684\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u5bf9\u5927\u5c0f\u5199\u654f\u611f\u3002 Go\u670925\u4e2a\u5173\u952e\u5b57\uff1a\u53ea\u80fd\u7528\u5728\u8bed\u6cd5\u5141\u8bb8\u7684\u5730\u65b9\uff1a \u5b57\u6bcd\u987a\u5e8f \u5173\u952e\u5b57 b break c case\u3001chan\u3001const\u3001continue d default\u3001defer e else f func\u3001fallthrough\u3001for g go\u3001goto i interface\u3001if\u3001import m map p package r range\u3001return s select\u3001struct\u3001switch t type v var Go\u670930\u591a\u4e2a\u5185\u7f6e\u7684\u9884\u58f0\u660e\u7684\u5e38\u91cf\u3001\u7c7b\u578b\u548c\u51fd\u6570\uff1a \u79cd\u7c7b \u5173\u952e\u5b57 \u5e38\u91cf true\u3001false\u3001iota\u3001nil int\u7c7b\u578b int\u3001int8\u3001int16\u3001int32\u3001int64 unit\u7c7b\u578b uint\u3001uint8\u3001unit16\u3001uint32\u3001unit64\u3001uintptr float\u7c7b\u578b float32\u3001float64\u3001complex64\u3001conplex64 \u5176\u4ed6\u7c7b\u578b bool\u3001byte\u3001rune\u3001string\u3001error \u51fd\u6570 make\u3001len\u3001cap\u3001new\u3001append\u3001copy\u3001close\u3001delete\u3001complex\u3001real\u3001imag\u3001panic\u3001recover \u8fd9\u4e9b\u540d\u79f0\u4e0d\u662f\u9884\u7559\u7684\uff0c\u53ef\u4ee5\u5728\u58f0\u660e\u4e2d\u4f7f\u7528\u5b83\u4eec\uff08\u5373\u5bf9\u8fd9\u4e9b\u540d\u79f0\u8fdb\u884c\u91cd\u58f0\u660e\uff09\uff0c\u4f46\u662f\u8fd9\u6837\u662f\u6709\u51b2\u7a81\u98ce\u9669\u7684\u3002 \u5982\u679c\u4e00\u4e2a\u5b9e\u4f53\u5728\u51fd\u6570\u5185\u58f0\u660e\u3002\u5b83\u53ea\u5728 \u51fd\u6570\u5c40\u90e8 \u6709\u6548 \u5982\u679c\u4e00\u4e2a\u5b9e\u4f53\u5728\u51fd\u6570\u5916\u58f0\u660e\uff0c\u5b83\u5c06\u5bf9 \u5305\u91cc\u9762\u7684\u6240\u6709\u6e90\u6587\u4ef6 \u53ef\u89c1 \u5b9e\u4f53\u7684\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u662f\u5426\u5927\u5199\u51b3\u5b9a\u4e86\u5176\u53ef\u89c1\u6027\u662f\u5426 \u8de8\u5305 \u3002\u5982fmt\u5305\u4e2d\u7684 Printf \u51fd\u6570\uff0c\u5305\u540d\u603b\u662f\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\u3002 \u540d\u79f0\u7684\u957f\u5ea6\u6ca1\u6709\u9650\u5236\uff0c\u901a\u5e38\u4f5c\u7528\u57df\u8d8a\u5927\uff0c\u5c31\u662f\u8d8a\u957f\u4e14\u6709\u610f\u4e49\u7684\u540d\u79f0\u3002\u5f53\u7531\u591a\u4e2a\u5355\u8bcd\u7ec4\u6210\u65f6\uff0c\u901a\u5e38\u91c7\u7528 \u9a7c\u5cf0\u5f0f \u7684\u98ce\u683c\uff0c\u800c\u4e0d\u662f\u4e0b\u5212\u7ebf\u3002\u5f53\u5355\u8bcd\u4e2d\u5305\u542b\u9996\u5b57\u6bcd\u7f29\u5199\u7ec4\u6210\u7684\u5355\u8bcd\u65f6\uff08\u5982ASCII\u3001HTML\u8fd9\u6837\u7684\uff09\uff0c\u901a\u5e38\u4f7f\u7528\u76f8\u540c\u7684\u5927\u5c0f\u5199\uff08\u5168\u5927\u5199\u6216\u5168\u5c0f\u5199\uff09\u3002","title":"\u540d\u79f0"},{"location":"Language/Basic/00-\u7a0b\u5e8f\u7ed3\u6784/#_3","text":"","title":"\u58f0\u660e"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/","text":"\u7248\u672c\u7684\u7279\u6027\uff1a Go1.5 \u81ea\u4e3e\uff0c\u5373\u901a\u8fc7Go\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\u6765\u5b9e\u73b0Go\u8bed\u8a00\u81ea\u8eab Go1.7 \u6781\u901f\u5783\u573e\u56de\u6536\u5668 Go1.10 \u5bf9\u81ea\u5e26\u5de5\u5177\u5168\u9762\u5347\u7ea7 \u505a\u7a0b\u5e8f\u4f9d\u8d56\u7ba1\u7406\u7684go mod\u547d\u4ee4 \u73af\u5883\u53d8\u91cf GOROOT\uff1aGo\u8bed\u8a00\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u5373Go\u8bed\u8a00\u7684\u5b89\u88c5\u8def\u5f84 GOPATH\uff1a\u82e5\u5e72\u5de5\u4f5c\u533a\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u5de5\u4f5c\u7a7a\u95f4\u3010\u80cc\u540e\u7684\u6982\u5ff5\u6700\u591a\uff0c\u6700\u91cd\u8981\u3011 GOBIN\uff1aGo\u7a0b\u5e8f\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8def\u5f84 \u8bbe\u7f6eGOPATH\u6709\u4ec0\u4e48\u610f\u4e49\uff1f GOPATH\u662fGo\u8bed\u8a00\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u5b83\u7684\u503c\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u6bcf\u4e2a\u76ee\u5f55\u90fd\u4ee3\u8868Go\u8bed\u8a00\u7684\u4e00\u4e2a\u5de5\u4f5c\u533a\uff08Workspace\uff09\u3002 \u5229\u7528\u5de5\u4f5c\u533a\u53bb\u5b58\u653e\uff1a 1. Go\u8bed\u8a00\u7684\u6e90\u7801\u6587\u4ef6\uff08source file\uff09 2. \u5b89\u88c5\u540e\u7684\u5f52\u6863\u6587\u4ef6\uff08archive file\uff0c\u4ee5 .a \u4e3a\u6269\u5c55\u540d\u7684\u6587\u4ef6\uff09 3. \u53ef\u6267\u884c\u6587\u4ef6 \u4e8b\u5b9e\u4e0a\uff0cGo\u8bed\u8a00\u9879\u76ee\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u7684\u6240\u6709\u64cd\u4f5c\uff08\u7f16\u7801\u3001\u4f9d\u8d56\u7ba1\u7406\u3001\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u5b89\u88c5\u7b49\uff09\u57fa\u672c\u4e0a\u90fd\u662f\u56f4\u7ed5\u7740GOPATH\u548c\u5de5\u4f5c\u533a\u8fdb\u884c\u7684\u3002 GOPATH\u80cc\u540e\u6709\u4e09\u4e2a\u77e5\u8bc6\u70b9\uff1a 1. Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f\u662f\u600e\u6837\u7684 2. \u6e90\u7801\u5b89\u88c5\u540e\u7684\u7ed3\u679c\uff08\u53ea\u6709\u5728\u5b89\u88c5\u540e\uff0cGo\u8bed\u8a00\u6e90\u7801\u624d\u80fd\u88ab\u5176\u4ed6\u4ee3\u7801\u4f7f\u7528\uff09 3. \u7406\u89e3\u6784\u5efa\u548c\u5b89\u88c5Go\u7a0b\u5e8f\u7684\u8fc7\u7a0b\uff08\u5f00\u53d1\u95ee\u9898\u4ee5\u53ca\u67e5\u627e\u95ee\u9898\u7684\u65f6\u5019\u975e\u5e38\u6709\u7528\uff09 Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f Go\u8bed\u8a00\u7684\u6e90\u7801\u4ee5\u4ee3\u7801\u5305\u4e3a\u57fa\u672c\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u8fd9\u4e9b\u4ee3\u7801\u5305\u662f\u4e0e\u76ee\u5f55\u4e00\u4e00\u5bf9\u5e94\u7684\uff08\u76ee\u5f55\u6709\u5b50\u76ee\u5f55\uff0c\u6240\u4ee5\u4ee3\u7801\u5305\u6709\u5b50\u5305\uff09\u3002 \u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u5305\u542b\u591a\u4e2a\u4ee5 .go \u4e3a\u6269\u5c55\u540d\u7684\u6e90\u7801\u6587\u4ef6\uff0c \u8fd9\u4e9b\u6e90\u7801\u6587\u4ef6\u90fd\u9700\u8981\u88ab\u58f0\u660e\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4ee3\u7801\u5305 \u3002 \u4ee3\u7801\u5305\u7684\u540d\u79f0\u4e00\u822c\u4f1a\u4e0e\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u540c\u540d\u3002\uff08\u5982\u679c\u4e0d\u540c\u540d\uff0c\u5728\u6784\u5efa\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4ee5\u4ee3\u7801\u5305\u7684\u540d\u5b57\u4e3a\u51c6\uff09\u3002 \u6bcf\u4e2a\u4ee3\u7801\u5305\u90fd\u4f1a\u6709 \u5bfc\u5165\u8def\u5f84 \uff08\u5373\uff0c\u5176\u4ed6\u4ee3\u7801\u5728\u4f7f\u7528\u8be5\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u65f6\uff0c\u9700\u8981\u5f15\u5165\u7684\u8def\u5f84\uff09\u3002 \u5728\u5b9e\u9645\u4f7f\u7528\u7a0b\u5e8f\u5b9e\u4f53\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u5bfc\u5165\u5176\u6240\u5728\u7684\u4ee3\u7801\u5305\u3002\u5177\u4f53\u65b9\u5f0f\u5c31\u662fimport\u8be5\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\uff1a import github.com/labstack/echo \u5728\u5de5\u4f5c\u533a\u4e2d\uff0c\u4e00\u4e2a\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u5b9e\u9645\u5c31\u662f\u4ecesrc\u5b50\u76ee\u5f55\u5230\u8be5\u5305\u7684\u5b9e\u9645\u5b58\u50a8\u4f4d\u7f6e\u7684\u76f8\u5bf9\u8def\u5f84 \u3002 Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f\u5c31\u662f\u4ee5\u73af\u5883\u53d8\u91cfGOPATH\u3001\u5de5\u4f5c\u533a\u3001src\u76ee\u5f55\u548c\u4ee3\u7801\u5305\u4e3a\u4e3b\u7ebf\u7684\u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0cGo\u8bed\u8a00\u7684\u6e90\u7801\u6587\u4ef6\u90fd\u9700\u8981\u88ab\u5b58\u653e\u5728\u73af\u5883\u53d8\u91cfGOPATH\u5305\u542b\u7684\u67d0\u4e2a\u5de5\u4f5c\u533a\u4e2d\u7684src\u76ee\u5f55\u4e0b\u7684\u67d0\u4e2a\u5305\u4e2d\u3002 \u6e90\u7801\u5b89\u88c5\u540e\u7684\u7ed3\u679c Go\u8bed\u8a00\u6e90\u7801\u5728\u5b89\u88c5\u540e\u4f1a\u4ea7\u751f\u4ec0\u4e48\u6837\u7684\u7ed3\u679c\uff1f\u6e90\u7801\u6587\u4ef6\u4ee5\u53ca\u5b89\u88c5\u540e\u7684\u7ed3\u679c\u6587\u4ef6\uff08\u5f52\u6863\u6587\u4ef6\u4ee5 .a \u4e3a\u6269\u5c55\u540d\uff09\u4f1a\u5b58\u653e\u5728\u54ea\u91cc\uff1f \u6e90\u7801\u6587\u4ef6\u4f1a\u5b58\u653e\u5728\u5de5\u4f5c\u533a\u7684 src\u5b50\u76ee\u5f55 \u4e2d\uff0c\u5b89\u88c5\u540e\u7684\u5f52\u6863\u6587\u4ef6\u4f1a\u5b58\u653e\u5728\u5de5\u4f5c\u533a\u7684 pkg\u5b50\u76ee\u5f55 \u4e2d\uff0c\u5982\u679c\u5b89\u88c5\u540e\u4ea7\u751f\u4e86\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5c31\u53ef\u80fd\u4f1a\u653e\u5728\u8be5\u5de5\u4f5c\u533a\u7684 bin\u5b50\u76ee\u5f55 \u4e2d\u3002 \u6e90\u7801\u6587\u4ef6\u662f\u4ee5\u4ee3\u7801\u5305\u7684\u5f62\u5f0f\u7ec4\u7ec7\u8d77\u6765\u7684\uff0c\u4e00\u4e2a\u4ee3\u7801\u5305\u5bf9\u5e94\u4e00\u4e2a\u76ee\u5f55\uff0c\u5b89\u88c5\u67d0\u4e2a\u4ee3\u7801\u5305\u800c\u4ea7\u751f\u7684\u5f52\u6863\u6587\u4ef6\u662f\u4e0e\u8fd9\u4e2a\u4ee3\u7801\u5305\u540c\u540d\u7684\u3002 \u653e\u7f6e\u5b83\u7684\u76f8\u5bf9\u76ee\u5f55\u5c31\u662f\u8be5\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u7684\u76f4\u63a5\u7236\u7ea7 \u3002 \u4e3e\u4e2a\u4f8b\u5b50 \u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u5982\u4e0b\uff1a github.com/labstack/echo // \u8be5\u4ee3\u7801\u5305\u7684\u6e90\u7801\u6587\u4ef6\u5b58\u5728\u4e0eGitHub\u7f51\u7ad9\u7684labstack\u7ec4\u7684\u4ee3\u7801\u4ed3\u5e93echo\u4e2d \u6267\u884c\u5b89\u88c5\u547d\u4ee4\u540e\uff1a go install github.com/labstack/echo \u751f\u6210\u7684\u5f52\u6863\u6587\u4ef6\u7684\u76f8\u5bf9\u76ee\u5f55\u5c31\u662f github.com/labstack \uff0c\u6587\u4ef6\u540d\u4e3a echo.a \u3002 \u4e0a\u8ff0\u4f8b\u5b50\u4e2d\u3002\u4ee3\u7801\u5305\u7684\u5f52\u6863\u6587\u4ef6\u5c31\u4f1a\u88ab\u653e\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684\u5b50\u76ee\u5f55\uff1a pkg/linux_amd64/github.com/labstack \u4e2d \u3002 \u6ce8\u610f\uff1a\u5728\u5f52\u6863\u6587\u4ef6\u7684\u76f8\u5bf9\u76ee\u5f55\u4e0epkg\u76ee\u5f55\u4e4b\u95f4\u8fd8\u6709\u4e00\u7ea7\u76ee\u5f55\uff0c\u53eb\u505a \u5e73\u53f0\u76f8\u5173\u76ee\u5f55 \u3002 \u5e73\u53f0\u76f8\u5173\u76ee\u5f55\u7684\u540d\u79f0\u662f\u7531build(\u6784\u5efa)\u8fc7\u7a0b\u7684\uff1a\u76ee\u6807\u64cd\u4f5c\u7cfb\u7edf+\u4e0b\u5212\u7ebf+\u76ee\u6807\u8ba1\u7b97\u673a\u67b6\u6784\u7684\u4ee3\u53f7\u4e09\u90e8\u5206\u7ec4\u6210\u3002 \u603b\u4e4b\uff0c\u67d0\u4e2a\u5de5\u4f5c\u533a\u7684src\u5b50\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u5728\u5b89\u88c5\u4e4b\u540e\uff0c\u4e00\u822c\u4f1a\u88ab\u653e\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684pkg\u5b50\u76ee\u5f55\u4e0b\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u88ab\u76f4\u63a5\u653e\u7f6e\u5728\u8be5\u5de5\u4f5c\u533a\u7684bin\u5b50\u76ee\u5f55\u4e2d\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u6784\u5efa\u548c\u5b89\u88c5Go\u7a0b\u5e8f\u7684\u8fc7\u7a0b \u6784\u5efa\u4f7f\u7528go build \u5b89\u88c5\u4f7f\u7528go install \u6784\u5efa\u548c\u5b89\u88c5\u4ee3\u7801\u5305\u7684\u8fc7\u7a0b\u4e2d\u90fd\u4f1a\u6267\u884c\u7f16\u8bd1\u3001\u6253\u5305\u7b49\u64cd\u4f5c\uff0c\u5e76\u4e14\u64cd\u4f5c\u751f\u6210\u7684\u4efb\u4f55\u6587\u4ef6\u90fd\u4f1a\u5148\u88ab\u4fdd\u5b58\u5728\u67d0\u4e2a\u4e34\u65f6\u7684\u76ee\u5f55\u4e2d\u3002 \u6784\u5efa \u5982\u679c\u6784\u5efa\u7684\u662f \u5e93\u6e90\u7801\u6587\u4ef6 \uff0c\u90a3\u4e48\u64cd\u4f5c\u540e\u4ea7\u751f\u7684\u7ed3\u679c\u6587\u4ef6\u53ea\u4f1a\u5b58\u5728\u4e8e\u4e34\u65f6\u76ee\u5f55\u4e2d\u3002 \u8fd9\u91cc\u7684\u6784\u5efa\u4e3b\u8981\u610f\u4e49\u5728\u4e8e\u68c0\u67e5\u548c\u9a8c\u8bc1 \u3002 \u5982\u679c\u6784\u5efa\u7684\u662f \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \uff0c\u90a3\u4e48\u64cd\u4f5c\u7684\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u4e2d\u3002 \u5b89\u88c5 \u5b89\u88c5\u64cd\u4f5c\u4f1a\u5148\u6267\u884c\u6784\u5efa\uff0c\u7136\u540e\u8fd8\u4f1a\u8fdb\u884c\u94fe\u63a5\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u7ed3\u679c\u6587\u4ef6\u642c\u8fd0\u5230\u6307\u5b9a\u76ee\u5f55\u3002 \u5982\u679c\u5b89\u88c5\u7684\u662f \u5e93\u6e90\u6587\u4ef6 \uff0c\u90a3\u4e48\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u5b83\u6240\u5728\u5de5\u4f5c\u533a\u7684pkg\u76ee\u5f55\u4e0b\u7684\u67d0\u4e2a\u5b50\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u5b89\u88c5\u7684\u662f \u547d\u4ee4\u6e90\u6587\u4ef6 \uff0c\u90a3\u4e48\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u5b83\u6240\u5728\u5de5\u4f5c\u533a\u7684bin\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u73af\u5883\u53d8\u91cfGOBIN\u6307\u5411\u7684\u76ee\u5f55\u4e2d\u3002 \u603b\u7ed3 Go\u8bed\u8a00\u63d0\u4f9b\u7684\u5f88\u591a\u5de5\u5177\u90fd\u662f\u5728GOPATH\u548c\u5de5\u4f5c\u533a\u7684\u57fa\u7840\u4e0a\u8fd0\u884c\u7684\uff0c\u6bd4\u5982\uff0cgo build\u3001go install\u3001go get\u7b49\u3002","title":"\u7248\u672c\u7684\u7279\u6027\uff1a"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_1","text":"Go1.5 \u81ea\u4e3e\uff0c\u5373\u901a\u8fc7Go\u8bed\u8a00\u7f16\u5199\u7a0b\u5e8f\u6765\u5b9e\u73b0Go\u8bed\u8a00\u81ea\u8eab Go1.7 \u6781\u901f\u5783\u573e\u56de\u6536\u5668 Go1.10 \u5bf9\u81ea\u5e26\u5de5\u5177\u5168\u9762\u5347\u7ea7 \u505a\u7a0b\u5e8f\u4f9d\u8d56\u7ba1\u7406\u7684go mod\u547d\u4ee4","title":"\u7248\u672c\u7684\u7279\u6027\uff1a"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_2","text":"GOROOT\uff1aGo\u8bed\u8a00\u5b89\u88c5\u6839\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u5373Go\u8bed\u8a00\u7684\u5b89\u88c5\u8def\u5f84 GOPATH\uff1a\u82e5\u5e72\u5de5\u4f5c\u533a\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u5de5\u4f5c\u7a7a\u95f4\u3010\u80cc\u540e\u7684\u6982\u5ff5\u6700\u591a\uff0c\u6700\u91cd\u8981\u3011 GOBIN\uff1aGo\u7a0b\u5e8f\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u8def\u5f84","title":"\u73af\u5883\u53d8\u91cf"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#gopath","text":"GOPATH\u662fGo\u8bed\u8a00\u7684\u5de5\u4f5c\u76ee\u5f55\uff0c\u5b83\u7684\u503c\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u76ee\u5f55\u7684\u8def\u5f84\uff0c\u6bcf\u4e2a\u76ee\u5f55\u90fd\u4ee3\u8868Go\u8bed\u8a00\u7684\u4e00\u4e2a\u5de5\u4f5c\u533a\uff08Workspace\uff09\u3002 \u5229\u7528\u5de5\u4f5c\u533a\u53bb\u5b58\u653e\uff1a 1. Go\u8bed\u8a00\u7684\u6e90\u7801\u6587\u4ef6\uff08source file\uff09 2. \u5b89\u88c5\u540e\u7684\u5f52\u6863\u6587\u4ef6\uff08archive file\uff0c\u4ee5 .a \u4e3a\u6269\u5c55\u540d\u7684\u6587\u4ef6\uff09 3. \u53ef\u6267\u884c\u6587\u4ef6 \u4e8b\u5b9e\u4e0a\uff0cGo\u8bed\u8a00\u9879\u76ee\u5728\u5176\u751f\u547d\u5468\u671f\u5185\u7684\u6240\u6709\u64cd\u4f5c\uff08\u7f16\u7801\u3001\u4f9d\u8d56\u7ba1\u7406\u3001\u6784\u5efa\u3001\u6d4b\u8bd5\u3001\u5b89\u88c5\u7b49\uff09\u57fa\u672c\u4e0a\u90fd\u662f\u56f4\u7ed5\u7740GOPATH\u548c\u5de5\u4f5c\u533a\u8fdb\u884c\u7684\u3002 GOPATH\u80cc\u540e\u6709\u4e09\u4e2a\u77e5\u8bc6\u70b9\uff1a 1. Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f\u662f\u600e\u6837\u7684 2. \u6e90\u7801\u5b89\u88c5\u540e\u7684\u7ed3\u679c\uff08\u53ea\u6709\u5728\u5b89\u88c5\u540e\uff0cGo\u8bed\u8a00\u6e90\u7801\u624d\u80fd\u88ab\u5176\u4ed6\u4ee3\u7801\u4f7f\u7528\uff09 3. \u7406\u89e3\u6784\u5efa\u548c\u5b89\u88c5Go\u7a0b\u5e8f\u7684\u8fc7\u7a0b\uff08\u5f00\u53d1\u95ee\u9898\u4ee5\u53ca\u67e5\u627e\u95ee\u9898\u7684\u65f6\u5019\u975e\u5e38\u6709\u7528\uff09","title":"\u8bbe\u7f6eGOPATH\u6709\u4ec0\u4e48\u610f\u4e49\uff1f"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#go","text":"Go\u8bed\u8a00\u7684\u6e90\u7801\u4ee5\u4ee3\u7801\u5305\u4e3a\u57fa\u672c\u7ec4\u7ec7\u5355\u4f4d\uff0c\u5728\u6587\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u8fd9\u4e9b\u4ee3\u7801\u5305\u662f\u4e0e\u76ee\u5f55\u4e00\u4e00\u5bf9\u5e94\u7684\uff08\u76ee\u5f55\u6709\u5b50\u76ee\u5f55\uff0c\u6240\u4ee5\u4ee3\u7801\u5305\u6709\u5b50\u5305\uff09\u3002 \u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u5305\u542b\u591a\u4e2a\u4ee5 .go \u4e3a\u6269\u5c55\u540d\u7684\u6e90\u7801\u6587\u4ef6\uff0c \u8fd9\u4e9b\u6e90\u7801\u6587\u4ef6\u90fd\u9700\u8981\u88ab\u58f0\u660e\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4ee3\u7801\u5305 \u3002 \u4ee3\u7801\u5305\u7684\u540d\u79f0\u4e00\u822c\u4f1a\u4e0e\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u540c\u540d\u3002\uff08\u5982\u679c\u4e0d\u540c\u540d\uff0c\u5728\u6784\u5efa\u5b89\u88c5\u8fc7\u7a0b\u4e2d\u4ee5\u4ee3\u7801\u5305\u7684\u540d\u5b57\u4e3a\u51c6\uff09\u3002 \u6bcf\u4e2a\u4ee3\u7801\u5305\u90fd\u4f1a\u6709 \u5bfc\u5165\u8def\u5f84 \uff08\u5373\uff0c\u5176\u4ed6\u4ee3\u7801\u5728\u4f7f\u7528\u8be5\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u65f6\uff0c\u9700\u8981\u5f15\u5165\u7684\u8def\u5f84\uff09\u3002 \u5728\u5b9e\u9645\u4f7f\u7528\u7a0b\u5e8f\u5b9e\u4f53\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u5bfc\u5165\u5176\u6240\u5728\u7684\u4ee3\u7801\u5305\u3002\u5177\u4f53\u65b9\u5f0f\u5c31\u662fimport\u8be5\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\uff1a import github.com/labstack/echo \u5728\u5de5\u4f5c\u533a\u4e2d\uff0c\u4e00\u4e2a\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u5b9e\u9645\u5c31\u662f\u4ecesrc\u5b50\u76ee\u5f55\u5230\u8be5\u5305\u7684\u5b9e\u9645\u5b58\u50a8\u4f4d\u7f6e\u7684\u76f8\u5bf9\u8def\u5f84 \u3002 Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f\u5c31\u662f\u4ee5\u73af\u5883\u53d8\u91cfGOPATH\u3001\u5de5\u4f5c\u533a\u3001src\u76ee\u5f55\u548c\u4ee3\u7801\u5305\u4e3a\u4e3b\u7ebf\u7684\u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0cGo\u8bed\u8a00\u7684\u6e90\u7801\u6587\u4ef6\u90fd\u9700\u8981\u88ab\u5b58\u653e\u5728\u73af\u5883\u53d8\u91cfGOPATH\u5305\u542b\u7684\u67d0\u4e2a\u5de5\u4f5c\u533a\u4e2d\u7684src\u76ee\u5f55\u4e0b\u7684\u67d0\u4e2a\u5305\u4e2d\u3002","title":"Go\u8bed\u8a00\u6e90\u7801\u7684\u7ec4\u7ec7\u65b9\u5f0f"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_3","text":"Go\u8bed\u8a00\u6e90\u7801\u5728\u5b89\u88c5\u540e\u4f1a\u4ea7\u751f\u4ec0\u4e48\u6837\u7684\u7ed3\u679c\uff1f\u6e90\u7801\u6587\u4ef6\u4ee5\u53ca\u5b89\u88c5\u540e\u7684\u7ed3\u679c\u6587\u4ef6\uff08\u5f52\u6863\u6587\u4ef6\u4ee5 .a \u4e3a\u6269\u5c55\u540d\uff09\u4f1a\u5b58\u653e\u5728\u54ea\u91cc\uff1f \u6e90\u7801\u6587\u4ef6\u4f1a\u5b58\u653e\u5728\u5de5\u4f5c\u533a\u7684 src\u5b50\u76ee\u5f55 \u4e2d\uff0c\u5b89\u88c5\u540e\u7684\u5f52\u6863\u6587\u4ef6\u4f1a\u5b58\u653e\u5728\u5de5\u4f5c\u533a\u7684 pkg\u5b50\u76ee\u5f55 \u4e2d\uff0c\u5982\u679c\u5b89\u88c5\u540e\u4ea7\u751f\u4e86\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5c31\u53ef\u80fd\u4f1a\u653e\u5728\u8be5\u5de5\u4f5c\u533a\u7684 bin\u5b50\u76ee\u5f55 \u4e2d\u3002 \u6e90\u7801\u6587\u4ef6\u662f\u4ee5\u4ee3\u7801\u5305\u7684\u5f62\u5f0f\u7ec4\u7ec7\u8d77\u6765\u7684\uff0c\u4e00\u4e2a\u4ee3\u7801\u5305\u5bf9\u5e94\u4e00\u4e2a\u76ee\u5f55\uff0c\u5b89\u88c5\u67d0\u4e2a\u4ee3\u7801\u5305\u800c\u4ea7\u751f\u7684\u5f52\u6863\u6587\u4ef6\u662f\u4e0e\u8fd9\u4e2a\u4ee3\u7801\u5305\u540c\u540d\u7684\u3002 \u653e\u7f6e\u5b83\u7684\u76f8\u5bf9\u76ee\u5f55\u5c31\u662f\u8be5\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u7684\u76f4\u63a5\u7236\u7ea7 \u3002","title":"\u6e90\u7801\u5b89\u88c5\u540e\u7684\u7ed3\u679c"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_4","text":"\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84\u5982\u4e0b\uff1a github.com/labstack/echo // \u8be5\u4ee3\u7801\u5305\u7684\u6e90\u7801\u6587\u4ef6\u5b58\u5728\u4e0eGitHub\u7f51\u7ad9\u7684labstack\u7ec4\u7684\u4ee3\u7801\u4ed3\u5e93echo\u4e2d \u6267\u884c\u5b89\u88c5\u547d\u4ee4\u540e\uff1a go install github.com/labstack/echo \u751f\u6210\u7684\u5f52\u6863\u6587\u4ef6\u7684\u76f8\u5bf9\u76ee\u5f55\u5c31\u662f github.com/labstack \uff0c\u6587\u4ef6\u540d\u4e3a echo.a \u3002 \u4e0a\u8ff0\u4f8b\u5b50\u4e2d\u3002\u4ee3\u7801\u5305\u7684\u5f52\u6863\u6587\u4ef6\u5c31\u4f1a\u88ab\u653e\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684\u5b50\u76ee\u5f55\uff1a pkg/linux_amd64/github.com/labstack \u4e2d \u3002 \u6ce8\u610f\uff1a\u5728\u5f52\u6863\u6587\u4ef6\u7684\u76f8\u5bf9\u76ee\u5f55\u4e0epkg\u76ee\u5f55\u4e4b\u95f4\u8fd8\u6709\u4e00\u7ea7\u76ee\u5f55\uff0c\u53eb\u505a \u5e73\u53f0\u76f8\u5173\u76ee\u5f55 \u3002 \u5e73\u53f0\u76f8\u5173\u76ee\u5f55\u7684\u540d\u79f0\u662f\u7531build(\u6784\u5efa)\u8fc7\u7a0b\u7684\uff1a\u76ee\u6807\u64cd\u4f5c\u7cfb\u7edf+\u4e0b\u5212\u7ebf+\u76ee\u6807\u8ba1\u7b97\u673a\u67b6\u6784\u7684\u4ee3\u53f7\u4e09\u90e8\u5206\u7ec4\u6210\u3002 \u603b\u4e4b\uff0c\u67d0\u4e2a\u5de5\u4f5c\u533a\u7684src\u5b50\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u5728\u5b89\u88c5\u4e4b\u540e\uff0c\u4e00\u822c\u4f1a\u88ab\u653e\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684pkg\u5b50\u76ee\u5f55\u4e0b\u5bf9\u5e94\u7684\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u88ab\u76f4\u63a5\u653e\u7f6e\u5728\u8be5\u5de5\u4f5c\u533a\u7684bin\u5b50\u76ee\u5f55\u4e2d\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff1a","title":"\u4e3e\u4e2a\u4f8b\u5b50"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#go_1","text":"\u6784\u5efa\u4f7f\u7528go build \u5b89\u88c5\u4f7f\u7528go install \u6784\u5efa\u548c\u5b89\u88c5\u4ee3\u7801\u5305\u7684\u8fc7\u7a0b\u4e2d\u90fd\u4f1a\u6267\u884c\u7f16\u8bd1\u3001\u6253\u5305\u7b49\u64cd\u4f5c\uff0c\u5e76\u4e14\u64cd\u4f5c\u751f\u6210\u7684\u4efb\u4f55\u6587\u4ef6\u90fd\u4f1a\u5148\u88ab\u4fdd\u5b58\u5728\u67d0\u4e2a\u4e34\u65f6\u7684\u76ee\u5f55\u4e2d\u3002","title":"\u6784\u5efa\u548c\u5b89\u88c5Go\u7a0b\u5e8f\u7684\u8fc7\u7a0b"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_5","text":"\u5982\u679c\u6784\u5efa\u7684\u662f \u5e93\u6e90\u7801\u6587\u4ef6 \uff0c\u90a3\u4e48\u64cd\u4f5c\u540e\u4ea7\u751f\u7684\u7ed3\u679c\u6587\u4ef6\u53ea\u4f1a\u5b58\u5728\u4e8e\u4e34\u65f6\u76ee\u5f55\u4e2d\u3002 \u8fd9\u91cc\u7684\u6784\u5efa\u4e3b\u8981\u610f\u4e49\u5728\u4e8e\u68c0\u67e5\u548c\u9a8c\u8bc1 \u3002 \u5982\u679c\u6784\u5efa\u7684\u662f \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \uff0c\u90a3\u4e48\u64cd\u4f5c\u7684\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u4e2d\u3002","title":"\u6784\u5efa"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_6","text":"\u5b89\u88c5\u64cd\u4f5c\u4f1a\u5148\u6267\u884c\u6784\u5efa\uff0c\u7136\u540e\u8fd8\u4f1a\u8fdb\u884c\u94fe\u63a5\u64cd\u4f5c\uff0c\u5e76\u4e14\u628a\u7ed3\u679c\u6587\u4ef6\u642c\u8fd0\u5230\u6307\u5b9a\u76ee\u5f55\u3002 \u5982\u679c\u5b89\u88c5\u7684\u662f \u5e93\u6e90\u6587\u4ef6 \uff0c\u90a3\u4e48\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u5b83\u6240\u5728\u5de5\u4f5c\u533a\u7684pkg\u76ee\u5f55\u4e0b\u7684\u67d0\u4e2a\u5b50\u76ee\u5f55\u4e2d\u3002 \u5982\u679c\u5b89\u88c5\u7684\u662f \u547d\u4ee4\u6e90\u6587\u4ef6 \uff0c\u90a3\u4e48\u7ed3\u679c\u6587\u4ef6\u4f1a\u88ab\u642c\u8fd0\u5230\u5b83\u6240\u5728\u5de5\u4f5c\u533a\u7684bin\u76ee\u5f55\u4e2d\uff0c\u6216\u8005\u73af\u5883\u53d8\u91cfGOBIN\u6307\u5411\u7684\u76ee\u5f55\u4e2d\u3002","title":"\u5b89\u88c5"},{"location":"Language/Basic/01-GOPATH\u548c\u5de5\u4f5c\u533a/#_7","text":"Go\u8bed\u8a00\u63d0\u4f9b\u7684\u5f88\u591a\u5de5\u5177\u90fd\u662f\u5728GOPATH\u548c\u5de5\u4f5c\u533a\u7684\u57fa\u7840\u4e0a\u8fd0\u884c\u7684\uff0c\u6bd4\u5982\uff0cgo build\u3001go install\u3001go get\u7b49\u3002","title":"\u603b\u7ed3"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/","text":"\u73af\u5883\u53d8\u91cf GOPATH \u6307\u5411\u7684\u662f\u4e00\u4e2a\u6216\u591a\u4e2a\u5de5\u4f5c\u533a\uff0c\u6bcf\u4e2a\u5de5\u4f5c\u533a\u4e2d\u90fd\u4f1a\u6709\u4ee5\u4ee3\u7801\u5305\u4e3a\u57fa\u672c\u7ec4\u7ec7\u5f62\u5f0f\u7684\u6e90\u7801\u6587\u4ef6\u3002 \u8fd9\u91cc\u7684\u6e90\u7801\u6587\u4ef6\u5206\u4e3a\u4e09\u79cd\uff1a 1. \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 2. \u5e93\u6e90\u7801\u6587\u4ef6 3. \u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6 \u5b83\u4eec\u6709\u7740\u4e0d\u540c\u7684\u7528\u9014\u548c\u7f16\u5199\u89c4\u5219\u3002 ================================== \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u72ec\u7acb\u7684\u7a0b\u5e8f\u5165\u53e3 \u5c5e\u4e8emain\u5305\uff0c\u5305\u542b\u65e0\u53c2\u6570\u65e0\u7ed3\u679c\u7684main\u51fd\u6570 \u53ef\u901a\u8fc7go run \u547d\u4ee4\u8fd0\u884c\uff0c\u53ef\u63a5\u53d7\u547d\u4ee4\u884c\u53c2\u6570 main\u51fd\u6570\u6267\u884c\u7ed3\u675f\u610f\u5473\u7740\u5f53\u524d\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u675f \u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u4e0d\u8981\u653e\u591a\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u4e0e\u5e93\u6e90\u7801\u6587\u4ef6\u4e5f\u4e0d\u8981\u653e\u5728\u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d \u6784\u5efa \u6784\u5efa\u540e\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\uff08executable file\uff09 \u53ef\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u7684\u6587\u4ef6 \u5728Windows\u4e2d\u5c31\u662f\u6269\u5c55\u540d\u4e3a .exe \u7684\u6587\u4ef6 \u5728Linux\u4e2d\u4e00\u822c\u6ca1\u6709\u6269\u5c55\u540d \u751f\u6210\u4f4d\u7f6e\u5728\u547d\u4ee4\u6267\u884c\u76ee\u5f55 \u5b89\u88c5 \u5b89\u88c5\u540e\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6 \u751f\u6210\u4f4d\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684 bin \u5b50\u76ee\u5f55\u6216 GOPATH \u5305\u542b\u7684\u76ee\u5f55 \u5e93\u6e90\u7801\u6587\u4ef6 \u7528\u4e8e\u653e\u7f6e\u53ef\u4f9b\u5176\u4ed6\u4ee3\u7801\u4f7f\u7528\u7684\u7a0b\u5e8f\u5b9e\u4f53 \u6784\u5efa \u4f5c\u7528\u5728\u4e8e\u68c0\u67e5\u548c\u9a8c\u8bc1 \u6784\u5efa\u540e\u53ea\u751f\u6210\u4e34\u65f6\u6587\u4ef6 \u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e34\u65f6\u76ee\u5f55\u4e0b \u5f00\u53d1\u8005\u4e00\u822c\u4e0d\u5173\u5fc3 \u5b89\u88c5 \u5b89\u88c5\u540e\u751f\u6210\u5f52\u6863\u6587\u4ef6\uff08archive file\uff09 \u6269\u5c55\u540d\u4e3a .a \u7684\u6587\u4ef6 \u5373\u4e3a\u9759\u6001\u94fe\u63a5\u5e93\u6587\u4ef6 \u751f\u6210\u4f4d\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684 pkg \u5b50\u76ee\u5f55 \u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6 \u529f\u80fd\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6 \u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08TestXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08t *testing.T\uff09 \u6027\u80fd\uff08\u57fa\u51c6\uff09\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6 \u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08BenchmarkXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08b *testing.B\uff09 \u793a\u4f8b\uff08\u6837\u672c\uff09\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6 \u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08ExampleXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08\u6ca1\u6709\u786c\u6027\u8981\u6c42\uff09 \u6d4b\u8bd5\u51fd\u6570\u671f\u671b\u8f93\u51fa \u653e\u7f6e\u5728\u51fd\u6570\u672b\u5c3e \u7528\u6ce8\u91ca\u884c\u8868\u793a \u5f62\u5982//Output\uff1axxx \u5728\u5b66\u4e60Go\u8bed\u8a00\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u7f16\u5199\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u8fd9\u6837\u7684\u7a0b\u5e8f\u80af\u5b9a\u4f1a\u6d89\u53ca\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u7f16\u5199\uff0c\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4f7f\u7528go run \u547d\u4ee4\u542f\u52a8\u3002 \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u7528\u9014\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u7f16\u5199\uff1f \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u662f\u7a0b\u5e8f\u7684 \u8fd0\u884c\u5165\u53e3 \uff0c\u662f\u6bcf\u4e2a\u53ef\u72ec\u7acb\u8fd0\u884c\u7684\u7a0b\u5e8f\u5fc5\u987b\u62e5\u6709\u7684\u3002\u901a\u8fc7\u6784\u5efa\u6216\u5b89\u88c5\uff0c\u751f\u6210\u4e0e\u5176\u5bf9\u5e94\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u540e\u8005\u4e00\u822c\u4f1a\u4e0e\u8be5\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u76f4\u63a5\u7236\u76ee\u5f55\u540c\u540d\u3002 \u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u58f0\u660e\u5c5e\u4e8e main\u5305 \u5305\u542b\u4e00\u4e2a\u65e0\u53c2\u6570\u58f0\u660e\u4e14\u65e0\u7ed3\u679c\u58f0\u660e\u7684 main\u51fd\u6570 \u90a3\u4e48\u5b83\u5c31\u662f\u4e00\u4e2a \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u3002\u5982\u4e0b\u6240\u793a\uff1a package main import fmt func main() { fmt.Println( Hello, world! ) } \u6267\u884cgo run \u547d\u4ee4\u540e\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u5c31\u80fd\u770b\u5230 Hello, world! \u3002 \u5f53\u9700\u8981\u6a21\u5757\u5316\u7f16\u7a0b\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u4f1a\u5c06\u4ee3\u7801\u62c6\u5206\u5230\u591a\u4e2a\u6587\u4ef6\uff0c\u751a\u81f3\u62c6\u5206\u5230\u4e0d\u540c\u7684\u4ee3\u7801\u5305\u4e2d\u3002\u65e0\u8bba\u600e\u6837\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u6765\u8bf4\uff0c\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u6c38\u8fdc \u53ea\u6709\u4e5f\u53ea\u80fd\u6709\u4e00\u4e2a \u3002\u5982\u679c\u6709\u4e0e\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u540c\u5305\u7684\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u5b83\u4eec\u4e5f\u5e94\u8be5\u58f0\u660e\u5c5e\u4e8emain\u5305\u3002 \u4e0d\u8bba\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u7684\u547d\u4ee4\u90fd\u662f\u53ef\u4ee5\u63a5\u6536\u53c2\u6570\u7684\u3002\u901a\u8fc7\u6784\u5efa\u6216\u5b89\u88c5\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5c31\u53ef\u4ee5\u88ab\u770b\u4f5c\u662f \u547d\u4ee4 \uff0c\u6240\u4ee5\u5b83\u4e5f\u5177\u5907\u63a5\u6536\u53c2\u6570\u7684\u80fd\u529b\u3002 1. \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u5982\u4f55\u63a5\u6536\u53c2\u6570 package main import ( // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] fmt flag ) var name string func init() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[2] flag.StringVar( name, name , everyone , The greeting object. ) } func main() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[3] flag.Parse() fmt.Printf( Hello, %s!\\n , name) } \u5728\u6ce8\u91ca\u5904\u7f16\u5199\u4ee3\u7801\uff0c\u5b8c\u6210\u201c\u6839\u636e\u8fd0\u884c\u7a0b\u5e8f\u7ed9\u5b9a\u7684\u53c2\u6570\u95ee\u5019\u67d0\u4eba\u201d\u7684\u529f\u80fd\u3002 Go\u8bed\u8a00\u6807\u51c6\u5e93\u4e2d\u6709\u4e00\u4e2a\u4ee3\u7801\u5305\u4e13\u95e8\u7528\u4e8e\u63a5\u6536\u548c\u89e3\u6790\u547d\u4ee4\u53c2\u6570\u3002 flag \u5305\u3002\u4e3a\u4e86\u8c03\u7528\u8fd9\u4e2a\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u6765\u8bfb\u53d6\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u9996\u5148\u9700\u8981\u5148\u5c06\u8fd9\u4e2a\u5305\u5bfc\u5165\u3002 \u4ee3\u7801\u5305\u7684\u540d\u5b57\u9700\u8981\u7528\u82f1\u6587\u534a\u89d2\u7684\u5f15\u53f7\u5f15\u8d77\u6765 \u3002 \u4eba\u540d\u90fd\u662f\u7531\u5b57\u7b26\u4e32\u7ec4\u6210\uff0c\u56e0\u6b64\u8c03\u7528 flag \u5305\u4e2d\u7684 StringVar \u51fd\u6570\u3002 \u51fd\u6570flag.StringVar\u63a5\u65364\u4e2a\u53c2\u6570\uff1a \u7b2c\u4e00\u4e2a\u53c2\u6570\u7528\u4e8e\u5b58\u50a8\u8be5\u547d\u4ee4\u53c2\u6570\u503c\u7684\u5730\u5740\uff0c\u5373\u53d8\u91cfname\u7684\u5730\u5740\uff08 name\uff09 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u8be5\u547d\u4ee4\u53c2\u6570\u7684\u540d\u79f0\uff0c\u5373name \u7b2c\u4e09\u4e2a\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u5728\u672a\u8ffd\u52a0\u8be5\u547d\u4ee4\u53c2\u6570\u65f6\u7684\u9ed8\u8ba4\u503c\uff0c\u5373everyone \u7b2c\u56db\u4e2a\u53c2\u6570\u7528\u4e8e\u5bf9\u8be5\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bf4\u660e\uff0c\u8fd9\u5728\u6253\u5370\u547d\u4ee4\u8bf4\u660e\u65f6\u7528\u5230 \u5728\u4e3b\u51fd\u6570\u4e2d\u8c03\u7528 flag.Parse() \u51fd\u6570\uff0c\u7528\u4e8e\u771f\u6b63\u89e3\u6790\u547d\u4ee4\u53c2\u6570\uff0c\u5e76\u628a\u5b83\u7684\u503c\u8d4b\u7ed9\u76f8\u5e94\u7684\u53d8\u91cf\u3002\u5bf9\u8be5\u51fd\u6570\u7684\u8c03\u7528\u5fc5\u987b\u5728\u6240\u6709\u547d\u4ee4\u53c2\u6570\u5b58\u50a8\u8f7d\u4f53\u7684\u58f0\u660e\uff08 \u5373name\u53d8\u91cf \uff09\u548c\u8bbe\u7f6e\uff08 \u5373flag.StringVar\u51fd\u6570\u8c03\u7528 \uff09\u4e4b\u540e\uff0c\u5e76\u4e14\u5728\u8bfb\u53d6\u4efb\u4f55\u547d\u4ee4\u53c2\u6570\u503c \u4e4b\u524d \u3002\u6240\u4ee5\u5728\u6b64\u5904\u628aParse\u7684\u8c03\u7528\u653e\u5728main\u51fd\u6570\u7684\u7b2c\u4e00\u884c\u3002 flag\u8fd8\u6709\u4e00\u4e2aString\u51fd\u6570\uff0c\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5df2\u7ecf\u5206\u914d\u597d\u7684\u7528\u4e8e\u5b58\u50a8\u547d\u4ee4\u53c2\u6570\u503c\u7684\u5730\u5740\u3002 \u5982\u679c\u4f7f\u7528flag.String,\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\uff1a package main import ( // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] fmt flag ) func init() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[2] var name = flag.String( name , everyone , The greeting object. ) } func main() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[3] fmt.Printf( Hello, %s!\\n , name) } 2. \u5982\u4f55\u5728\u8fd0\u884c\u547d\u4ee4\u6e90\u6587\u4ef6\u7684\u65f6\u5019\u4f20\u5165\u53c2\u6570\uff0c\u5982\u4f55\u67e5\u770b\u53c2\u6570\u7684\u4f7f\u7528\u8bf4\u660e \u5047\u8bbe\u4e0a\u9762\u7684\u547d\u4ee4\u6e90\u6587\u4ef6\u540d\u5b57\u4e3ademo2.go\u3002 \u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff0c \u4e3a\u53c2\u6570name\u4f20\u503c \uff1a go run demo2.go -name=Robert # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Hello,Robert! \u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff0c \u67e5\u770b\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u53c2\u6570\u8bf4\u660e \uff1a go run demo2.go --help # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Usage of /var/folders/ts/7lg_tl_x2gd_k1lm5g_48c7w0000gn/T/go-build155438482/b001/exe/demo2: -name string The greeting object. (default everyone ) exit status 2 \u8f93\u51fa\u4e2d\u7684 /var/folders/ts/7lg_tl_x2gd_k1lm5g_48c7w0000gn/T/go-build155438482/b001/exe/demo2 \u662fgo run \u547d\u4ee4\u6784\u5efa\u4e0a\u8ff0\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u65f6\u4e34\u65f6\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u3002 \u6362\u4e2a\u65b9\u5f0f\uff0c\u5148\u6784\u5efa\u5728\u6267\u884c\uff1a go build demo2.go ./demo2 --help # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Usage of ./demo2: -name string The greeting object. (default everyone ) 3. \u5982\u4f55\u81ea\u5b9a\u4e49\u547d\u4ee4\u6e90\u6587\u4ef6\u7684\u53c2\u6570\u4f7f\u7528\u8bf4\u660e \u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\uff0c\u6700\u7b80\u5355\u7684\u662f\u5bf9\u53d8\u91cfflag.Usage\u91cd\u65b0\u8d4b\u503c\u3002flag.Usage\u7684\u7c7b\u578b\u662ffunc()\uff0c\u5373\u4e00\u79cd\u65e0\u53c2\u6570\u58f0\u660e\u4e14\u65e0\u7ed3\u679c\u58f0\u660e\u7684\u51fd\u6570\u7c7b\u578b\u3002 flag.Usage\u53d8\u91cf\u5728\u58f0\u660e\u65f6\u5c31\u5df2\u7ecf\u88ab\u8d4b\u503c\u4e86\uff0c\u6240\u4ee5\u5728\u8fd0\u884c\u4e0a\u8ff0go run demo2.go --help\u65f6\u770b\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002 \u5bf9flag.Usage\u7684\u8d4b\u503c\u5fc5\u987b\u5728\u8c03\u7528flag.Parse\u51fd\u6570\u4e4b\u524d \u3002 \u5728demo2.go\u7684\u57fa\u7840\u4e0a\u4fee\u6539demo3.go\uff0c\u5728main\u51fd\u6570\u7684\u5f00\u59cb\u5904\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a flag.Usage = func(){ fmt.Fprint(os.Stderr, Usage of %s:\\n , question ) flag.PrintDefault() } \u8fd0\u884cdemo3.go: go run demo3.go --help # \u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9 Usage of question: -name string The greeting object. (default everyone ) exit status 2 \u6df1\u5165\u4e00\u4e9b \u5728\u8c03\u7528flag\u5305\u4e2d\u7684\u4e00\u4e9b\u51fd\u6570\uff08StringVar\uff0cParse\u7b49\uff09\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u8c03\u7528flag.CommandLine\u53d8\u91cf\u7684\u5bf9\u5e94\u65b9\u6cd5\u3002 flag.CommandLine\u76f8\u5f53\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7684\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\u3002\u901a\u8fc7\u5bf9flag.CommandLine\u91cd\u65b0\u8d4b\u503c\uff0c\u53ef\u4ee5\u66f4\u6df1\u5c42\u6b21\u5730\u5b9a\u5236\u5f53\u524d\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u53c2\u6570\u4f7f\u7528\u8bf4\u660e\u3002 \u4fee\u6539demo2.go\u4e2d\u7684init\u51fd\u6570\u4f53\uff1a flag.CommandLine = flag.NewFlagSet( , flag.ExitOnError) flag.CommandLine.Usage = func(){ fmt.Fprint(os.Stderr, Usage of %s:\\n , question ) flag.PrintDefaults() } \u518d\u6b21\u6267\u884cgo run demo2.go --help\u8f93\u5165\u7684\u7ed3\u679c\u4e0edemo3.go\u76f8\u540c\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u66f4\u52a0\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539flag.NewFlagSet\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\u4e0d\u540c\u8f93\u51fa\u6548\u679c\u7684\u76ee\u7684\u3002\u5982\u4fee\u6539\u4e3a flag.PanicOnError ,\u8fd9\u4e9b\u90fd\u662fflag\u5305\u4e2d\u7684\u5e38\u91cf\u3002 flag.ExitOnError\uff1a\u544a\u8bc9\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\uff0c\u5f53\u547d\u4ee4\u540e\u8ddf--help\u6216\u8005\u53c2\u6570\u8bbe\u7f6e\u4e0d\u6b63\u786e\u7684\u65f6\u5019\uff0c\u5728\u6253\u5370\u547d\u4ee4\u53c2\u6570\u4f7f\u7528\u8bf4\u660e\u540e\u4ee5\u72b6\u6001\u78012\uff08\u8868\u793a\u7528\u6237\u9519\u8bef\u7684\u4f7f\u7528\u547d\u4ee4\uff09\u9000\u51fa\u5f53\u524d\u7a0b\u5e8f\u3002 flag.PanicOnError\uff1a\u4e0e\u4e0a\u9762\u7684\u533a\u522b\u5728\u4e8e\uff0c\u6700\u540e\u8dd1\u51fa\u4e00\u4e2a\u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09\u3002 \u8fd0\u884c\u65f6\u6050\u614c\u662fGo\u7a0b\u5e8f\u5904\u7406\u9519\u8bef\u7684\u65b9\u5f0f\u3002 \u518d\u8fdb\u4e00\u6b65\uff0c\u81ea\u5b9a\u4e49\u547d\u4ee4\u53c2\u6570\u5bb9\u5668 \u4e0d\u4f7f\u7528flag.CommandLine\uff0c\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u79c1\u6709\u7684\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\uff1a var cmdLine = flag.NewFlagSet( question , flag.ExitOnError) \u7136\u540e\uff0c\u628aflag.StringVar\u7684\u8c03\u7528\u66ff\u6362\u4e3acmdLine.StringVar\u8c03\u7528\uff0c\u518d\u628aflag.Parse()\u66ff\u6362\u4e3acmdLine.Parse(os.Args[1:])\u3002 *flag.FlagSet\u7c7b\u578b\u7684\u53d8\u91cfcmdLIne\u62e5\u6709\u5f88\u591a\u6709\u610f\u601d\u7684\u65b9\u6cd5\u3002 \u8fd9\u6837\u7684\u81ea\u5b9a\u4e49\u66f4\u7075\u6d3b\uff0c\u4e14\u4e0d\u4f1a\u5f71\u54cd\u5230\u5168\u5c40\u53d8\u91cfflag.CommandLine\u3002 \u603b\u7ed3 \u901a\u8fc7\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u5199\u547d\u4ee4\uff0c\u5e76\u4e14\u50cf\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u547d\u4ee4\u90a3\u6837\u88ab\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5d4c\u5165\u5230\u5404\u79cd\u811a\u672c\u4e2d\u3002","title":"02 \u547d\u4ee4\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_1","text":"","title":"=================================="},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_2","text":"\u72ec\u7acb\u7684\u7a0b\u5e8f\u5165\u53e3 \u5c5e\u4e8emain\u5305\uff0c\u5305\u542b\u65e0\u53c2\u6570\u65e0\u7ed3\u679c\u7684main\u51fd\u6570 \u53ef\u901a\u8fc7go run \u547d\u4ee4\u8fd0\u884c\uff0c\u53ef\u63a5\u53d7\u547d\u4ee4\u884c\u53c2\u6570 main\u51fd\u6570\u6267\u884c\u7ed3\u675f\u610f\u5473\u7740\u5f53\u524d\u7a0b\u5e8f\u8fd0\u884c\u7ed3\u675f \u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u4e0d\u8981\u653e\u591a\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u4e0e\u5e93\u6e90\u7801\u6587\u4ef6\u4e5f\u4e0d\u8981\u653e\u5728\u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d","title":"\u547d\u4ee4\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_3","text":"\u6784\u5efa\u540e\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6\uff08executable file\uff09 \u53ef\u5728\u547d\u4ee4\u884c\u4e2d\u8fd0\u884c\u7684\u6587\u4ef6 \u5728Windows\u4e2d\u5c31\u662f\u6269\u5c55\u540d\u4e3a .exe \u7684\u6587\u4ef6 \u5728Linux\u4e2d\u4e00\u822c\u6ca1\u6709\u6269\u5c55\u540d \u751f\u6210\u4f4d\u7f6e\u5728\u547d\u4ee4\u6267\u884c\u76ee\u5f55","title":"\u6784\u5efa"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_4","text":"\u5b89\u88c5\u540e\u751f\u6210\u53ef\u6267\u884c\u6587\u4ef6 \u751f\u6210\u4f4d\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684 bin \u5b50\u76ee\u5f55\u6216 GOPATH \u5305\u542b\u7684\u76ee\u5f55","title":"\u5b89\u88c5"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_5","text":"\u7528\u4e8e\u653e\u7f6e\u53ef\u4f9b\u5176\u4ed6\u4ee3\u7801\u4f7f\u7528\u7684\u7a0b\u5e8f\u5b9e\u4f53","title":"\u5e93\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_6","text":"\u4f5c\u7528\u5728\u4e8e\u68c0\u67e5\u548c\u9a8c\u8bc1 \u6784\u5efa\u540e\u53ea\u751f\u6210\u4e34\u65f6\u6587\u4ef6 \u5728\u64cd\u4f5c\u7cfb\u7edf\u7684\u4e34\u65f6\u76ee\u5f55\u4e0b \u5f00\u53d1\u8005\u4e00\u822c\u4e0d\u5173\u5fc3","title":"\u6784\u5efa"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_7","text":"\u5b89\u88c5\u540e\u751f\u6210\u5f52\u6863\u6587\u4ef6\uff08archive file\uff09 \u6269\u5c55\u540d\u4e3a .a \u7684\u6587\u4ef6 \u5373\u4e3a\u9759\u6001\u94fe\u63a5\u5e93\u6587\u4ef6 \u751f\u6210\u4f4d\u7f6e\u5728\u5f53\u524d\u5de5\u4f5c\u533a\u7684 pkg \u5b50\u76ee\u5f55","title":"\u5b89\u88c5"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_8","text":"","title":"\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_9","text":"\u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08TestXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08t *testing.T\uff09","title":"\u529f\u80fd\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_10","text":"\u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08BenchmarkXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08b *testing.B\uff09","title":"\u6027\u80fd\uff08\u57fa\u51c6\uff09\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_11","text":"\u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\uff08ExampleXXX\uff09 \u6d4b\u8bd5\u51fd\u6570\u7b7e\u540d\uff08\u6ca1\u6709\u786c\u6027\u8981\u6c42\uff09 \u6d4b\u8bd5\u51fd\u6570\u671f\u671b\u8f93\u51fa \u653e\u7f6e\u5728\u51fd\u6570\u672b\u5c3e \u7528\u6ce8\u91ca\u884c\u8868\u793a \u5f62\u5982//Output\uff1axxx \u5728\u5b66\u4e60Go\u8bed\u8a00\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ecf\u5e38\u4f1a\u7f16\u5199\u53ef\u4ee5\u76f4\u63a5\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u8fd9\u6837\u7684\u7a0b\u5e8f\u80af\u5b9a\u4f1a\u6d89\u53ca\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u7f16\u5199\uff0c\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4f7f\u7528go run \u547d\u4ee4\u542f\u52a8\u3002","title":"\u793a\u4f8b\uff08\u6837\u672c\uff09\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_12","text":"\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u662f\u7a0b\u5e8f\u7684 \u8fd0\u884c\u5165\u53e3 \uff0c\u662f\u6bcf\u4e2a\u53ef\u72ec\u7acb\u8fd0\u884c\u7684\u7a0b\u5e8f\u5fc5\u987b\u62e5\u6709\u7684\u3002\u901a\u8fc7\u6784\u5efa\u6216\u5b89\u88c5\uff0c\u751f\u6210\u4e0e\u5176\u5bf9\u5e94\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u540e\u8005\u4e00\u822c\u4f1a\u4e0e\u8be5\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u76f4\u63a5\u7236\u76ee\u5f55\u540c\u540d\u3002 \u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u58f0\u660e\u5c5e\u4e8e main\u5305 \u5305\u542b\u4e00\u4e2a\u65e0\u53c2\u6570\u58f0\u660e\u4e14\u65e0\u7ed3\u679c\u58f0\u660e\u7684 main\u51fd\u6570 \u90a3\u4e48\u5b83\u5c31\u662f\u4e00\u4e2a \u547d\u4ee4\u6e90\u7801\u6587\u4ef6 \u3002\u5982\u4e0b\u6240\u793a\uff1a package main import fmt func main() { fmt.Println( Hello, world! ) } \u6267\u884cgo run \u547d\u4ee4\u540e\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u5c31\u80fd\u770b\u5230 Hello, world! \u3002 \u5f53\u9700\u8981\u6a21\u5757\u5316\u7f16\u7a0b\u7684\u65f6\u5019\uff0c\u5f80\u5f80\u4f1a\u5c06\u4ee3\u7801\u62c6\u5206\u5230\u591a\u4e2a\u6587\u4ef6\uff0c\u751a\u81f3\u62c6\u5206\u5230\u4e0d\u540c\u7684\u4ee3\u7801\u5305\u4e2d\u3002\u65e0\u8bba\u600e\u6837\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u72ec\u7acb\u7684\u7a0b\u5e8f\u6765\u8bf4\uff0c\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u6c38\u8fdc \u53ea\u6709\u4e5f\u53ea\u80fd\u6709\u4e00\u4e2a \u3002\u5982\u679c\u6709\u4e0e\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u540c\u5305\u7684\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u5b83\u4eec\u4e5f\u5e94\u8be5\u58f0\u660e\u5c5e\u4e8emain\u5305\u3002 \u4e0d\u8bba\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5728\u547d\u4ee4\u884c\u4e2d\u6267\u884c\u7684\u547d\u4ee4\u90fd\u662f\u53ef\u4ee5\u63a5\u6536\u53c2\u6570\u7684\u3002\u901a\u8fc7\u6784\u5efa\u6216\u5b89\u88c5\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u5c31\u53ef\u4ee5\u88ab\u770b\u4f5c\u662f \u547d\u4ee4 \uff0c\u6240\u4ee5\u5b83\u4e5f\u5177\u5907\u63a5\u6536\u53c2\u6570\u7684\u80fd\u529b\u3002","title":"\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u7528\u9014\u662f\u4ec0\u4e48\uff1f\u5982\u4f55\u7f16\u5199\uff1f"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#1","text":"package main import ( // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] fmt flag ) var name string func init() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[2] flag.StringVar( name, name , everyone , The greeting object. ) } func main() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[3] flag.Parse() fmt.Printf( Hello, %s!\\n , name) } \u5728\u6ce8\u91ca\u5904\u7f16\u5199\u4ee3\u7801\uff0c\u5b8c\u6210\u201c\u6839\u636e\u8fd0\u884c\u7a0b\u5e8f\u7ed9\u5b9a\u7684\u53c2\u6570\u95ee\u5019\u67d0\u4eba\u201d\u7684\u529f\u80fd\u3002 Go\u8bed\u8a00\u6807\u51c6\u5e93\u4e2d\u6709\u4e00\u4e2a\u4ee3\u7801\u5305\u4e13\u95e8\u7528\u4e8e\u63a5\u6536\u548c\u89e3\u6790\u547d\u4ee4\u53c2\u6570\u3002 flag \u5305\u3002\u4e3a\u4e86\u8c03\u7528\u8fd9\u4e2a\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u6765\u8bfb\u53d6\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u9996\u5148\u9700\u8981\u5148\u5c06\u8fd9\u4e2a\u5305\u5bfc\u5165\u3002 \u4ee3\u7801\u5305\u7684\u540d\u5b57\u9700\u8981\u7528\u82f1\u6587\u534a\u89d2\u7684\u5f15\u53f7\u5f15\u8d77\u6765 \u3002 \u4eba\u540d\u90fd\u662f\u7531\u5b57\u7b26\u4e32\u7ec4\u6210\uff0c\u56e0\u6b64\u8c03\u7528 flag \u5305\u4e2d\u7684 StringVar \u51fd\u6570\u3002 \u51fd\u6570flag.StringVar\u63a5\u65364\u4e2a\u53c2\u6570\uff1a \u7b2c\u4e00\u4e2a\u53c2\u6570\u7528\u4e8e\u5b58\u50a8\u8be5\u547d\u4ee4\u53c2\u6570\u503c\u7684\u5730\u5740\uff0c\u5373\u53d8\u91cfname\u7684\u5730\u5740\uff08 name\uff09 \u7b2c\u4e8c\u4e2a\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u8be5\u547d\u4ee4\u53c2\u6570\u7684\u540d\u79f0\uff0c\u5373name \u7b2c\u4e09\u4e2a\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u5728\u672a\u8ffd\u52a0\u8be5\u547d\u4ee4\u53c2\u6570\u65f6\u7684\u9ed8\u8ba4\u503c\uff0c\u5373everyone \u7b2c\u56db\u4e2a\u53c2\u6570\u7528\u4e8e\u5bf9\u8be5\u547d\u4ee4\u53c2\u6570\u8fdb\u884c\u8bf4\u660e\uff0c\u8fd9\u5728\u6253\u5370\u547d\u4ee4\u8bf4\u660e\u65f6\u7528\u5230 \u5728\u4e3b\u51fd\u6570\u4e2d\u8c03\u7528 flag.Parse() \u51fd\u6570\uff0c\u7528\u4e8e\u771f\u6b63\u89e3\u6790\u547d\u4ee4\u53c2\u6570\uff0c\u5e76\u628a\u5b83\u7684\u503c\u8d4b\u7ed9\u76f8\u5e94\u7684\u53d8\u91cf\u3002\u5bf9\u8be5\u51fd\u6570\u7684\u8c03\u7528\u5fc5\u987b\u5728\u6240\u6709\u547d\u4ee4\u53c2\u6570\u5b58\u50a8\u8f7d\u4f53\u7684\u58f0\u660e\uff08 \u5373name\u53d8\u91cf \uff09\u548c\u8bbe\u7f6e\uff08 \u5373flag.StringVar\u51fd\u6570\u8c03\u7528 \uff09\u4e4b\u540e\uff0c\u5e76\u4e14\u5728\u8bfb\u53d6\u4efb\u4f55\u547d\u4ee4\u53c2\u6570\u503c \u4e4b\u524d \u3002\u6240\u4ee5\u5728\u6b64\u5904\u628aParse\u7684\u8c03\u7528\u653e\u5728main\u51fd\u6570\u7684\u7b2c\u4e00\u884c\u3002 flag\u8fd8\u6709\u4e00\u4e2aString\u51fd\u6570\uff0c\u76f4\u63a5\u8fd4\u56de\u4e00\u4e2a\u5df2\u7ecf\u5206\u914d\u597d\u7684\u7528\u4e8e\u5b58\u50a8\u547d\u4ee4\u53c2\u6570\u503c\u7684\u5730\u5740\u3002 \u5982\u679c\u4f7f\u7528flag.String,\u8fdb\u884c\u5982\u4e0b\u4fee\u6539\uff1a package main import ( // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] fmt flag ) func init() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[2] var name = flag.String( name , everyone , The greeting object. ) } func main() { // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[3] fmt.Printf( Hello, %s!\\n , name) }","title":"1. \u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u5982\u4f55\u63a5\u6536\u53c2\u6570"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#2","text":"\u5047\u8bbe\u4e0a\u9762\u7684\u547d\u4ee4\u6e90\u6587\u4ef6\u540d\u5b57\u4e3ademo2.go\u3002 \u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff0c \u4e3a\u53c2\u6570name\u4f20\u503c \uff1a go run demo2.go -name=Robert # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Hello,Robert! \u8fd0\u884c\u5982\u4e0b\u547d\u4ee4\uff0c \u67e5\u770b\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u53c2\u6570\u8bf4\u660e \uff1a go run demo2.go --help # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Usage of /var/folders/ts/7lg_tl_x2gd_k1lm5g_48c7w0000gn/T/go-build155438482/b001/exe/demo2: -name string The greeting object. (default everyone ) exit status 2 \u8f93\u51fa\u4e2d\u7684 /var/folders/ts/7lg_tl_x2gd_k1lm5g_48c7w0000gn/T/go-build155438482/b001/exe/demo2 \u662fgo run \u547d\u4ee4\u6784\u5efa\u4e0a\u8ff0\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u65f6\u4e34\u65f6\u751f\u6210\u7684\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\u3002 \u6362\u4e2a\u65b9\u5f0f\uff0c\u5148\u6784\u5efa\u5728\u6267\u884c\uff1a go build demo2.go ./demo2 --help # \u8fd0\u884c\u540e\uff0c\u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9\uff1a Usage of ./demo2: -name string The greeting object. (default everyone )","title":"2. \u5982\u4f55\u5728\u8fd0\u884c\u547d\u4ee4\u6e90\u6587\u4ef6\u7684\u65f6\u5019\u4f20\u5165\u53c2\u6570\uff0c\u5982\u4f55\u67e5\u770b\u53c2\u6570\u7684\u4f7f\u7528\u8bf4\u660e"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#3","text":"\u6709\u591a\u79cd\u65b9\u5f0f\u53ef\u4ee5\u5b9e\u73b0\uff0c\u6700\u7b80\u5355\u7684\u662f\u5bf9\u53d8\u91cfflag.Usage\u91cd\u65b0\u8d4b\u503c\u3002flag.Usage\u7684\u7c7b\u578b\u662ffunc()\uff0c\u5373\u4e00\u79cd\u65e0\u53c2\u6570\u58f0\u660e\u4e14\u65e0\u7ed3\u679c\u58f0\u660e\u7684\u51fd\u6570\u7c7b\u578b\u3002 flag.Usage\u53d8\u91cf\u5728\u58f0\u660e\u65f6\u5c31\u5df2\u7ecf\u88ab\u8d4b\u503c\u4e86\uff0c\u6240\u4ee5\u5728\u8fd0\u884c\u4e0a\u8ff0go run demo2.go --help\u65f6\u770b\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002 \u5bf9flag.Usage\u7684\u8d4b\u503c\u5fc5\u987b\u5728\u8c03\u7528flag.Parse\u51fd\u6570\u4e4b\u524d \u3002 \u5728demo2.go\u7684\u57fa\u7840\u4e0a\u4fee\u6539demo3.go\uff0c\u5728main\u51fd\u6570\u7684\u5f00\u59cb\u5904\u6dfb\u52a0\u5982\u4e0b\u4ee3\u7801\uff1a flag.Usage = func(){ fmt.Fprint(os.Stderr, Usage of %s:\\n , question ) flag.PrintDefault() } \u8fd0\u884cdemo3.go: go run demo3.go --help # \u5728\u6807\u51c6\u8f93\u51fa\u4e2d\u6253\u5370\u5982\u4e0b\u5185\u5bb9 Usage of question: -name string The greeting object. (default everyone ) exit status 2","title":"3. \u5982\u4f55\u81ea\u5b9a\u4e49\u547d\u4ee4\u6e90\u6587\u4ef6\u7684\u53c2\u6570\u4f7f\u7528\u8bf4\u660e"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_13","text":"\u5728\u8c03\u7528flag\u5305\u4e2d\u7684\u4e00\u4e9b\u51fd\u6570\uff08StringVar\uff0cParse\u7b49\uff09\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u8c03\u7528flag.CommandLine\u53d8\u91cf\u7684\u5bf9\u5e94\u65b9\u6cd5\u3002 flag.CommandLine\u76f8\u5f53\u4e8e\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7684\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\u3002\u901a\u8fc7\u5bf9flag.CommandLine\u91cd\u65b0\u8d4b\u503c\uff0c\u53ef\u4ee5\u66f4\u6df1\u5c42\u6b21\u5730\u5b9a\u5236\u5f53\u524d\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u7684\u53c2\u6570\u4f7f\u7528\u8bf4\u660e\u3002 \u4fee\u6539demo2.go\u4e2d\u7684init\u51fd\u6570\u4f53\uff1a flag.CommandLine = flag.NewFlagSet( , flag.ExitOnError) flag.CommandLine.Usage = func(){ fmt.Fprint(os.Stderr, Usage of %s:\\n , question ) flag.PrintDefaults() } \u518d\u6b21\u6267\u884cgo run demo2.go --help\u8f93\u5165\u7684\u7ed3\u679c\u4e0edemo3.go\u76f8\u540c\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u66f4\u52a0\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539flag.NewFlagSet\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u6765\u5b9e\u73b0\u4e0d\u540c\u8f93\u51fa\u6548\u679c\u7684\u76ee\u7684\u3002\u5982\u4fee\u6539\u4e3a flag.PanicOnError ,\u8fd9\u4e9b\u90fd\u662fflag\u5305\u4e2d\u7684\u5e38\u91cf\u3002 flag.ExitOnError\uff1a\u544a\u8bc9\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\uff0c\u5f53\u547d\u4ee4\u540e\u8ddf--help\u6216\u8005\u53c2\u6570\u8bbe\u7f6e\u4e0d\u6b63\u786e\u7684\u65f6\u5019\uff0c\u5728\u6253\u5370\u547d\u4ee4\u53c2\u6570\u4f7f\u7528\u8bf4\u660e\u540e\u4ee5\u72b6\u6001\u78012\uff08\u8868\u793a\u7528\u6237\u9519\u8bef\u7684\u4f7f\u7528\u547d\u4ee4\uff09\u9000\u51fa\u5f53\u524d\u7a0b\u5e8f\u3002 flag.PanicOnError\uff1a\u4e0e\u4e0a\u9762\u7684\u533a\u522b\u5728\u4e8e\uff0c\u6700\u540e\u8dd1\u51fa\u4e00\u4e2a\u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09\u3002 \u8fd0\u884c\u65f6\u6050\u614c\u662fGo\u7a0b\u5e8f\u5904\u7406\u9519\u8bef\u7684\u65b9\u5f0f\u3002","title":"\u6df1\u5165\u4e00\u4e9b"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_14","text":"\u4e0d\u4f7f\u7528flag.CommandLine\uff0c\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u79c1\u6709\u7684\u547d\u4ee4\u53c2\u6570\u5bb9\u5668\uff1a var cmdLine = flag.NewFlagSet( question , flag.ExitOnError) \u7136\u540e\uff0c\u628aflag.StringVar\u7684\u8c03\u7528\u66ff\u6362\u4e3acmdLine.StringVar\u8c03\u7528\uff0c\u518d\u628aflag.Parse()\u66ff\u6362\u4e3acmdLine.Parse(os.Args[1:])\u3002 *flag.FlagSet\u7c7b\u578b\u7684\u53d8\u91cfcmdLIne\u62e5\u6709\u5f88\u591a\u6709\u610f\u601d\u7684\u65b9\u6cd5\u3002 \u8fd9\u6837\u7684\u81ea\u5b9a\u4e49\u66f4\u7075\u6d3b\uff0c\u4e14\u4e0d\u4f1a\u5f71\u54cd\u5230\u5168\u5c40\u53d8\u91cfflag.CommandLine\u3002","title":"\u518d\u8fdb\u4e00\u6b65\uff0c\u81ea\u5b9a\u4e49\u547d\u4ee4\u53c2\u6570\u5bb9\u5668"},{"location":"Language/Basic/02-\u547d\u4ee4\u6e90\u7801\u6587\u4ef6/#_15","text":"\u901a\u8fc7\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u5199\u547d\u4ee4\uff0c\u5e76\u4e14\u50cf\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u547d\u4ee4\u90a3\u6837\u88ab\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5d4c\u5165\u5230\u5404\u79cd\u811a\u672c\u4e2d\u3002","title":"\u603b\u7ed3"},{"location":"Language/Basic/03-\u5e93\u6e90\u7801\u6587\u4ef6/","text":"\u5e93\u6e90\u7801\u6587\u4ef6\u662f\u4e0d\u80fd\u88ab\u76f4\u63a5\u8fd0\u884c\u7684\u6e90\u7801\u6587\u4ef6\uff0c\u5b83\u4ec5\u7528\u4e8e\u5b58\u653e\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u8fd9\u4e9b\u7a0b\u5e8f\u5b9e\u4f53\u53ef\u4ee5\u88ab\u5176\u4ed6\u4ee3\u7801\u4f7f\u7528\uff08\u9075\u4eceGo\u8bed\u8a00\u89c4\u8303\uff09\u3002 \u5176\u4ed6\u4ee3\u7801\u7684\u4f4d\u7f6e \uff1a 1. \u4e0e\u88ab\u4f7f\u7528\u7684\u7a0b\u5e8f\u5b9e\u4f53\u5728\u540c\u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u5185\uff0c 2. \u5728\u5176\u4ed6\u6e90\u7801\u6587\u4ef6\u5185\uff0c 3. \u5728\u5176\u4ed6\u4ee3\u7801\u5305\u4e2d\u3002 \u5728Go\u8bed\u8a00\u4e2d\uff0c\u7a0b\u5e8f\u5b9e\u4f53\u662f\u53d8\u91cf\u3001\u5e38\u91cf\u3001\u51fd\u6570\u3001\u7ed3\u6784\u4f53\u548c\u63a5\u53e3\u7684\u7edf\u79f0\u3002\u6211\u4eec\u603b\u662f\u5148\u58f0\u660e\uff08\u6216\u5b9a\u4e49\uff09\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u7136\u540e\u518d\u53bb\u4f7f\u7528\u3002\u7a0b\u5e8f\u5b9e\u4f53\u7684\u540d\u5b57\u88ab\u7edf\u79f0\u4e3a\u6807\u8bc6\u7b26\uff08\u53ef\u4ee5\u662f\u4efb\u4f55Unicode\u7f16\u7801\u53ef\u4ee5\u8868\u793a\u7684\u5b57\u6bcd\u5b57\u7b26\u3001\u6570\u5b57\u4ee5\u53ca\u4e0b\u5212\u7ebf\uff0c\u4f46\u662f\u9996\u5b57\u6bcd\u4e0d\u80fd\u4e3a\u6570\u5b57\uff09\u3002 \u4ece\u89c4\u5219\u4e0a\u6765\u770b\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e2d\u6587\u4f5c\u4e3a\u53d8\u91cf\u7684\u540d\u5b57 \u3002 \u5982\u4f55\u628a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u62c6\u5206\u5230\u5176\u4ed6\u5e93\u6e90\u7801\u6587\u4ef6\uff1f \u4e0b\u9762\u6709\u6837\u4f8b\u4ee3\u7801demo4.go: package main import ( flag ) var name string func init() { flag.StringVar( name, name , everyone , The greeting object. ) } func main() { flag.Parse() hello(name) } \u51fd\u6570hello()\u88ab\u58f0\u660e\u5728\u53e6\u5916\u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u4e2d\uff1a // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] import fmt func hello(name string) { fmt.Printf( Hello, %s!\\n , name) } \u6ce8\u91ca\u5904\u9700\u8981\u586b\u5165package main\u7684\u540d\u5b57\u3002\u56e0\u4e3a\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u9700\u8981\u88ab\u58f0\u660e\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u3002\u5982\u679c\u8be5\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u4e3a\u4e86\u8ba9\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u901a\u8fc7\u7f16\u8bd1\uff0c\u5176\u4ed6\u6e90\u7801\u6587\u4ef6\u5e94\u8be5\u88ab\u58f0\u660e\u4e3a\u5c5e\u4e8emain\u5305\u3002 \u4ee3\u7801\u5305\u58f0\u660e\u7684\u57fa\u672c\u539f\u5219 \u540c\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u7684\u4ee3\u7801\u5305\u58f0\u660e\u8bed\u53e5\u5fc5\u987b\u8981\u4e00\u81f4\u3002\u5373\u5b83\u4eec\u8981\u540c\u5c5e\u4e8e\u4e00\u4e2a\u4ee3\u7801\u5305\u3002\u8fd9\u5bf9\u6240\u6709\u6e90\u7801\u6587\u4ef6\u90fd\u9002\u7528\u3002 \u5982\u679c\u76ee\u5f55\u4e2d\u6709\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u5176\u4ed6\u79cd\u7c7b\u7684\u6e90\u7801\u6587\u4ef6\u4e5f\u5e94\u8be5\u58f0\u660e\u5c5e\u4e8emain\u5305 \uff0c\u8fd9\u662f\u53ef\u4ee5\u6210\u529f\u6784\u5efa\u5e76\u5141\u8bb8\u7684\u524d\u63d0\u3002 \u6e90\u7801\u6587\u4ef6\u58f0\u660e\u7684\u4ee3\u7801\u5305\u7684\u540d\u79f0\u53ef\u4ee5\u4e0e\u5176\u6240\u5728\u7684\u76ee\u5f55\u7684\u540d\u79f0\u4e0d\u540c\u3002 \u5728\u9488\u5bf9\u4ee3\u7801\u5305\u8fdb\u884c\u6784\u5efa\u65f6\uff0c\u751f\u6210\u7684\u7ed3\u679c\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u4e0e\u5176\u7236\u6bcd\u7684\u540d\u79f0\u4e00\u81f4 \u3002 \u5bfc\u5165\u8def\u5f84 \uff1a\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u76f8\u5bf9\u4e0esrc\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\u5c31\u662f\u5b83\u7684\u4ee3\u7801\u5305\u5bfc\u5165\u8def\u5f84\uff0c \u9650\u5b9a\u7b26 \uff1a\u5b9e\u9645\u4f7f\u7528\u5176\u7a0b\u5e8f\u5b9e\u4f53\u65f6\u7ed9\u5b9a\u7684\u9650\u5b9a\u7b26\u8981\u4e0e\u5b83\u58f0\u660e\u6240\u5c5e\u7684\u4ee3\u7801\u5305\u540d\u79f0\u5bf9\u5e94 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u603b\u662f\u8ba9\u58f0\u660e\u7684\u5305\u540d\u4e0e\u5176\u7236\u76ee\u5f55\u7684\u540d\u79f0\u4e00\u81f4\u3002 \u7a0b\u5e8f\u5b9e\u4f53\u7684\u8bbf\u95ee\u6743\u9650 \u540d\u79f0\u7684\u9996\u5b57\u6bcd\u5927\u5199\u7684\u7a0b\u5e8f\u5b9e\u4f53\u624d\u53ef\u4ee5\u88ab\u5f53\u524d\u5305\u5916\u7684\u4ee3\u7801\u5f15\u7528\uff0c\u5426\u5219\u5b83\u5c31\u53ea\u80fd\u88ab\u5f53\u524d\u5305\u5185\u7684\u4ee3\u7801\u5f15\u7528\u3002 \u5176\u4ed6\u8bbf\u95ee\u6743\u9650\u89c4\u5219 Go1.5\u4e4b\u540e\u7684\u7248\u672c\uff0c\u901a\u8fc7\u521b\u5efainternal\u4ee3\u7801\u5305\u8ba9\u4e00\u4e9b\u7a0b\u5e8f\u5b9e\u4f53\u4ec5\u4ec5\u80fd\u88ab\u5f53\u524d\u6a21\u5757\u4e2d\u7684\u5176\u4ed6\u4ee3\u7801\u5f15\u7528\u3002\u8fd9\u662fGo\u8bed\u8a00\u7684\u7b2c\u4e09\u79cd\u8bbf\u95ee\u6743\u9650\uff1a\u6a21\u5757\u7ea7\u79c1\u6709\u3002 internal\u4ee3\u7801\u5305\u4e2d\u58f0\u660e\u7684\u516c\u5f00\u7a0b\u5e8f\u5b9e\u4f53\u4ec5\u80fd\u88ab\u8be5\u4ee3\u7801\u7684\u76f4\u63a5\u7236\u5305\u53ca\u5176\u5b50\u5305\u4e2d\u7684\u4ee3\u7801\u5f15\u7528\u3002\u5f15\u7528\u4e4b\u524d\u5148\u8981\u5bfc\u5165\u8fd9\u4e2ainternal\u5305\uff0c\u5bf9\u4e8e\u5176\u4ed6\u4ee3\u7801\u5305\uff0c\u5bfc\u5165\u884c\u4e3a\u662f\u975e\u6cd5\u7684\uff0c\u4e0d\u80fd\u901a\u8fc7\u7f16\u8bd1\u3002","title":"03 \u5e93\u6e90\u7801\u6587\u4ef6"},{"location":"Language/Basic/03-\u5e93\u6e90\u7801\u6587\u4ef6/#_1","text":"\u4e0b\u9762\u6709\u6837\u4f8b\u4ee3\u7801demo4.go: package main import ( flag ) var name string func init() { flag.StringVar( name, name , everyone , The greeting object. ) } func main() { flag.Parse() hello(name) } \u51fd\u6570hello()\u88ab\u58f0\u660e\u5728\u53e6\u5916\u4e00\u4e2a\u6e90\u7801\u6587\u4ef6\u4e2d\uff1a // \u9700\u5728\u6b64\u5904\u6dfb\u52a0\u4ee3\u7801\u3002[1] import fmt func hello(name string) { fmt.Printf( Hello, %s!\\n , name) } \u6ce8\u91ca\u5904\u9700\u8981\u586b\u5165package main\u7684\u540d\u5b57\u3002\u56e0\u4e3a\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u9700\u8981\u88ab\u58f0\u660e\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4ee3\u7801\u5305\u3002\u5982\u679c\u8be5\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u4e3a\u4e86\u8ba9\u540c\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u90fd\u901a\u8fc7\u7f16\u8bd1\uff0c\u5176\u4ed6\u6e90\u7801\u6587\u4ef6\u5e94\u8be5\u88ab\u58f0\u660e\u4e3a\u5c5e\u4e8emain\u5305\u3002","title":"\u5982\u4f55\u628a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u4ee3\u7801\u62c6\u5206\u5230\u5176\u4ed6\u5e93\u6e90\u7801\u6587\u4ef6\uff1f"},{"location":"Language/Basic/03-\u5e93\u6e90\u7801\u6587\u4ef6/#_2","text":"\u540c\u76ee\u5f55\u4e0b\u7684\u6e90\u7801\u6587\u4ef6\u7684\u4ee3\u7801\u5305\u58f0\u660e\u8bed\u53e5\u5fc5\u987b\u8981\u4e00\u81f4\u3002\u5373\u5b83\u4eec\u8981\u540c\u5c5e\u4e8e\u4e00\u4e2a\u4ee3\u7801\u5305\u3002\u8fd9\u5bf9\u6240\u6709\u6e90\u7801\u6587\u4ef6\u90fd\u9002\u7528\u3002 \u5982\u679c\u76ee\u5f55\u4e2d\u6709\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\uff0c\u90a3\u4e48\u5176\u4ed6\u79cd\u7c7b\u7684\u6e90\u7801\u6587\u4ef6\u4e5f\u5e94\u8be5\u58f0\u660e\u5c5e\u4e8emain\u5305 \uff0c\u8fd9\u662f\u53ef\u4ee5\u6210\u529f\u6784\u5efa\u5e76\u5141\u8bb8\u7684\u524d\u63d0\u3002 \u6e90\u7801\u6587\u4ef6\u58f0\u660e\u7684\u4ee3\u7801\u5305\u7684\u540d\u79f0\u53ef\u4ee5\u4e0e\u5176\u6240\u5728\u7684\u76ee\u5f55\u7684\u540d\u79f0\u4e0d\u540c\u3002 \u5728\u9488\u5bf9\u4ee3\u7801\u5305\u8fdb\u884c\u6784\u5efa\u65f6\uff0c\u751f\u6210\u7684\u7ed3\u679c\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u4e0e\u5176\u7236\u6bcd\u7684\u540d\u79f0\u4e00\u81f4 \u3002 \u5bfc\u5165\u8def\u5f84 \uff1a\u6e90\u7801\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u76f8\u5bf9\u4e0esrc\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84\u5c31\u662f\u5b83\u7684\u4ee3\u7801\u5305\u5bfc\u5165\u8def\u5f84\uff0c \u9650\u5b9a\u7b26 \uff1a\u5b9e\u9645\u4f7f\u7528\u5176\u7a0b\u5e8f\u5b9e\u4f53\u65f6\u7ed9\u5b9a\u7684\u9650\u5b9a\u7b26\u8981\u4e0e\u5b83\u58f0\u660e\u6240\u5c5e\u7684\u4ee3\u7801\u5305\u540d\u79f0\u5bf9\u5e94 \u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u603b\u662f\u8ba9\u58f0\u660e\u7684\u5305\u540d\u4e0e\u5176\u7236\u76ee\u5f55\u7684\u540d\u79f0\u4e00\u81f4\u3002","title":"\u4ee3\u7801\u5305\u58f0\u660e\u7684\u57fa\u672c\u539f\u5219"},{"location":"Language/Basic/03-\u5e93\u6e90\u7801\u6587\u4ef6/#_3","text":"\u540d\u79f0\u7684\u9996\u5b57\u6bcd\u5927\u5199\u7684\u7a0b\u5e8f\u5b9e\u4f53\u624d\u53ef\u4ee5\u88ab\u5f53\u524d\u5305\u5916\u7684\u4ee3\u7801\u5f15\u7528\uff0c\u5426\u5219\u5b83\u5c31\u53ea\u80fd\u88ab\u5f53\u524d\u5305\u5185\u7684\u4ee3\u7801\u5f15\u7528\u3002","title":"\u7a0b\u5e8f\u5b9e\u4f53\u7684\u8bbf\u95ee\u6743\u9650"},{"location":"Language/Basic/03-\u5e93\u6e90\u7801\u6587\u4ef6/#_4","text":"Go1.5\u4e4b\u540e\u7684\u7248\u672c\uff0c\u901a\u8fc7\u521b\u5efainternal\u4ee3\u7801\u5305\u8ba9\u4e00\u4e9b\u7a0b\u5e8f\u5b9e\u4f53\u4ec5\u4ec5\u80fd\u88ab\u5f53\u524d\u6a21\u5757\u4e2d\u7684\u5176\u4ed6\u4ee3\u7801\u5f15\u7528\u3002\u8fd9\u662fGo\u8bed\u8a00\u7684\u7b2c\u4e09\u79cd\u8bbf\u95ee\u6743\u9650\uff1a\u6a21\u5757\u7ea7\u79c1\u6709\u3002 internal\u4ee3\u7801\u5305\u4e2d\u58f0\u660e\u7684\u516c\u5f00\u7a0b\u5e8f\u5b9e\u4f53\u4ec5\u80fd\u88ab\u8be5\u4ee3\u7801\u7684\u76f4\u63a5\u7236\u5305\u53ca\u5176\u5b50\u5305\u4e2d\u7684\u4ee3\u7801\u5f15\u7528\u3002\u5f15\u7528\u4e4b\u524d\u5148\u8981\u5bfc\u5165\u8fd9\u4e2ainternal\u5305\uff0c\u5bf9\u4e8e\u5176\u4ed6\u4ee3\u7801\u5305\uff0c\u5bfc\u5165\u884c\u4e3a\u662f\u975e\u6cd5\u7684\uff0c\u4e0d\u80fd\u901a\u8fc7\u7f16\u8bd1\u3002","title":"\u5176\u4ed6\u8bbf\u95ee\u6743\u9650\u89c4\u5219"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/","text":"\u7a0b\u5e8f\u5b9e\u4f53 Go\u8bed\u8a00\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u5305\u62ec\uff1a \u53d8\u91cf \u5e38\u91cf \u51fd\u6570 \u7ed3\u6784\u4f53 \u63a5\u53e3 Go\u8bed\u8a00\u662f \u9759\u6001\u7c7b\u578b \u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u9700\u8981\u5728\u58f0\u660e \u53d8\u91cf \u548c \u5e38\u91cf \u7684\u65f6\u5019\uff0c\u6307\u5b9a\u5b83\u4eec\u7684\u7c7b\u578b\u6216\u7ed9\u4e88\u8db3\u591f\u7684\u4fe1\u606f\uff0c\u8ba9Go\u8bed\u8a00\u80fd\u591f\u63a8\u5bfc\u51fa\u5b83\u4eec\u7684\u7c7b\u578b\u3002 \u53d8\u91cf\u7684\u5408\u6cd5\u7c7b\u578b\uff1a Go\u8bed\u8a00\u9884\u5b9a\u4e49\u7684\u7c7b\u578b \u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3001\u7ed3\u6784\u4f53\u3001\u63a5\u53e3 \u5e38\u91cf\u7684\u5408\u6cd5\u7c7b\u578b\uff1a Go\u8bed\u8a00\u9884\u5b9a\u4e49\u7684\u57fa\u672c\u7c7b\u578b \u53d8\u91cf // \u53d8\u91cf\u58f0\u660e\u65b9\u5f0f\u7684\u4e0d\u540c\u65b9\u5f0f var name string var name= string // \u7c7b\u578b\u63a8\u65ad \u3010\u7f16\u7a0b\u8bed\u8a00\u5728\u7f16\u8bd1\u671f\u81ea\u52a8\u89e3\u91ca\u8868\u8fbe\u5f0f\u7c7b\u578b\u7684\u80fd\u529b\u3011 // \u8868\u8fbe\u5f0f\u7c7b\u578b\u662f\u5bf9\u8868\u8fbe\u5f0f\u6c42\u503c\u540e\u5f97\u5230\u7ed3\u679c\u7684\u7c7b\u578b // \u7c7b\u578b\u63a8\u65ad\u53ea\u80fd\u7528\u4e8e\u53d8\u91cf\u6216\u5e38\u91cf\u7684\u521d\u59cb\u5316 name := string // \u77ed\u53d8\u91cf\u58f0\u660e \u3010\u53ea\u80fd\u5728\u51fd\u6570\u4f53\u5185\u90e8\u4f7f\u7528\u3011\uff0c\u4e5f\u5c5e\u4e8e\u7c7b\u578b\u63a8\u65ad \u7c7b\u578b\u63a8\u65ad\u7684\u597d\u5904 \u7c7b\u578b\u63a8\u65ad\u5728\u7f16\u8bd1\u671f\u6267\u884c\uff0c\u5bf9\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387\u6ca1\u6709\u5f71\u54cd\u3002 \u4ee3\u7801\u91cd\u6784\uff1a\u901a\u5e38\u628a\u4e0d\u6539\u53d8\u67d0\u4e2a\u7a0b\u5e8f\u4e0e\u5916\u754c\u7684\u4efb\u4f55\u4ea4\u4e92\u65b9\u5f0f\u548c\u89c4\u5219\uff0c\u800c\u53ea\u6539\u53d8\u5185\u90e8\u5b9e\u73b0\u7684\u4ee3\u7801\u4fee\u6539\u65b9\u5f0f\uff0c\u91cd\u6784\u5bf9\u8c61\uff08\u4ee3\u7801\u3001\u51fd\u6570\u3001\u6a21\u5757\u3001\u7cfb\u7edf\uff09\uff0c\u53ef\u4ee5\u968f\u610f\u4fee\u6539\u88ab\u91cd\u6784\u90e8\u5206\u7684\u4ee3\u7801\uff0c\u800c\u4e0d\u5f71\u54cd\u8c03\u7528\u5b83\u7684\u90e8\u5206\u3002 \u4e0d\u663e\u5f0f\u5730\u6307\u5b9a\u53d8\u91cf\u6216\u5e38\u91cf\u7684\u7c7b\u578b\uff0c\u4f7f\u5f97\u5b83\u53ef\u4ee5\u88ab\u8d4b\u4e88\u4efb\u4f55\u7c7b\u578b\u7684\u503c\uff0c\u53d8\u91cf\u7684\u7c7b\u578b\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u7531\u7a0b\u5e8f\u52a8\u6001\u786e\u5b9a\u3002 Go\u662f\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u6240\u4ee5\u4e00\u70b9\u521d\u59cb\u5316\u53d8\u91cf\u662f\u786e\u5b9a\u4e86\u7c7b\u578b\uff0c\u4e4b\u540e\u5c31\u4e0d\u80fd\u518d\u6539\u53d8 \u3002 \u53d8\u91cf\u7684\u91cd\u58f0\u660e \u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\uff0c\u53ef\u4ee5\u5bf9\u7edf\u4e00\u4ee3\u7801\u5757\u4e2d\u7684\u53d8\u91cf\u8fdb\u884c\u91cd\u58f0\u660e\u3002 \u4ee3\u7801\u5757\u7684\u542b\u4e49\uff1a \u5168\u57df\u4ee3\u7801\u5757 \u4ee3\u7801\u5305 \u6e90\u6587\u4ef6 \u51fd\u6570 if\u3001for\u3001switch\u3001select\u3001case\u8bed\u53e5 \u7a7a\u4ee3\u7801\u5757 \u53d8\u91cf\u91cd\u58f0\u660e\u7684\u524d\u63d0\uff1a \u53d8\u91cf\u7684\u7c7b\u578b\u5728\u521d\u59cb\u5316\u65f6\u5df2\u7ecf\u786e\u5b9a\uff0c\u91cd\u58f0\u660e\u7684\u7c7b\u578b\u5fc5\u987b\u4e0e\u5143\u7c7b\u578b\u76f8\u540c\uff0c\u5426\u5219\u4ea7\u751f\u7f16\u8bd1\u9519\u8bef \u53d8\u91cf\u7684\u91cd\u58f0\u660e\u53ea\u80fd\u53d1\u751f\u5728\u67d0\u4e00\u4e2a\u4ee3\u7801\u5757 \u53d8\u91cf\u7684\u91cd\u58f0\u660e\u53ea\u6709\u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\u662f\u624d\u4f1a\u53d1\u751f\uff0c\u5426\u5219\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 \u58f0\u660e\u5e76\u8d4b\u503c\u7684\u53d8\u91cf\u5fc5\u987b\u662f\u591a\u4e2a\uff0c\u5e76\u4e14\u5176\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u65b0\u7684\u53d8\u91cf \u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\u65f6\u53ef\u4e0d\u7528\u5224\u65ad\u5728\u610f\u88ab\u8d4b\u503c\u7684\u591a\u4e2a\u53d8\u91cf\u4e2d\u662f\u5426\u5305\u542b\u65e7\u53d8\u91cf \u3002 \u4ee3\u7801\u5757 \u4f5c\u7528\u57df\uff1a \u5305\u7ea7\u79c1\u6709\uff1a\u4ee3\u7801\u5305\uff0c\u4ee3\u7801\u5757 \u6a21\u5757\u7ea7\u79c1\u6709\uff1a\u4ee3\u7801\u5305\uff0c\u4ee3\u7801\u5757 \u516c\u5f00\uff1a\u5168\u57df\u4ee3\u7801\u5757 \u4e00\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u7684\u4f5c\u7528\u57df\u603b\u662f\u4f1a\u88ab\u9650\u5236\u5728\u67d0\u4e2a\u4ee3\u7801\u5757\u4e2d\uff0c\u800c\u8fd9\u4e2a\u4f5c\u7528\u57df\u6700\u5927\u7684\u7528\u5904\uff0c\u5c31\u662f\u5bf9\u7a0b\u5e8f\u5b9e\u4f53\u7684\u8bbf\u95ee\u6743\u9650\u7684\u63a7\u5236 \u3002 \u4ee3\u7801\u5f15\u7528\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u603b\u662f\u4f1a\u4f18\u5148\u67e5\u627e\u5f53\u524d\u4ee3\u7801\u5757\u4e2d\u7684\u53d8\u91cf\uff0c\u4e0d\u5305\u542b\u5b50\u4ee3\u7801\u5757\u3002 \u5982\u679c\u5f53\u524d\u4ee3\u7801\u5757\u4e2d\u6ca1\u6709\u58f0\u660e\u4ee5\u6b64\u4e3a\u540d\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u7a0b\u5e8f\u6cbf\u7740\u4ee3\u7801\u5757\u7684\u5d4c\u5957\u5173\u7cfb\uff0c\u4ece\u76f4\u63a5\u5305\u542b\u7684\u5f53\u524d\u5757\u5f00\u59cb\uff0c\u4e00\u5c42\u4e00\u5c42\u5730\u67e5\u627e\u3002 \u4e0d\u4f1a\u67e5\u627e\u4ee3\u7801\u5bfc\u5165\u7684\u5176\u4ed6\u5305\uff0c\u9664\u975e\u4ee3\u7801\u5305\u5bfc\u5165\u8bed\u53e5\u5982\u4e0b import . XXX ,\u8fd9\u8868\u793a\u8ba9XXX\u5305\u4e2d\u516c\u5f00\u7684\u7a0b\u5e8f\u5b9e\u4f53\u88ab\u89c6\u4e3a\u5f53\u524d\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u5b9e\u4f53\u3002 \u4e0d\u540c\u4ee3\u7801\u5757\u4e2d\u7684\u53ef\u91cd\u540d\u53d8\u91cf\u4e0e\u53d8\u91cf\u91cd\u58f0\u660e\u4e2d\u7684\u53d8\u91cf\u7684\u533a\u522b\uff1a | \u5dee\u5f02 | \u53d8\u91cf\u91cd\u58f0\u660e | \u53ef\u91cd\u540d\u53d8\u91cf | | -------- | -------------------------- | -------------------------- | | \u4ee3\u7801\u5757 | \u7edf\u4e00\u4ee3\u7801\u5757 | \u4e0d\u540c\u4ee3\u7801\u5757 | | \u6570\u91cf | \u53ea\u6709\u4e00\u4e2a\u53d8\u91cf | \u591a\u4e2a\u53d8\u91cf | | \u53d8\u91cf\u7c7b\u578b | \u7c7b\u578b\u4e0d\u53ef\u53d8\uff0c\u4e0e\u521d\u59cb\u5316\u65f6\u76f8\u540c | \u7c7b\u578b\u4efb\u610f | | \u53d8\u91cf\u5c4f\u853d | \u65e0 | \u4ee3\u7801\u5757\u5d4c\u5957\uff0c\u5219\u51fa\u73b0\u53d8\u91cf\u5c4f\u853d | \u5224\u65ad\u53d8\u91cf\u7c7b\u578b \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\uff1a x.(T) ,x\u4ee3\u8868\u8981\u5224\u65ad\u7c7b\u578b\u7684\u503c \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u4e66\uff1a T(x) ,x\u6e90\u503c\uff0cx\u7684\u7c7b\u578b\u662f\u6e90\u7c7b\u578b\uff0cT\u76ee\u6807\u7c7b\u578b \u5728Go\u8bed\u8a00\u4e2d Interface{} \u4ee3\u8868\u7a7a\u63a5\u53e3\uff0c\u4efb\u4f55\u7c7b\u578b\u90fd\u662f\u5b83\u7684\u5b9e\u73b0\u7c7b\u578b\u3002Interface{}(x),\u5c06x\u8f6c\u6362\u4e3a\u7a7a\u63a5\u53e3\u7684\u503c\u3002 {}\u7684\u542b\u4e49\uff0c\u7a7a\u4ee3\u7801\u5757\u6216\u8005\u7a7a\u6570\u636e\u7c7b\u578b\u3002 value,ok := interface{}(container).([]string) //value\uff1a\u7c7b\u578b\u8f6c\u6362\u540e\u7684\u503c\uff0cok\uff1a\u65ad\u8a00\u662f\u5426\u6210\u529f // value,ok := interface{}( \u53d8\u91cf ).( \u53d8\u91cf\u7c7b\u578b ) // interface{}\uff08 \u53d8\u91cf \uff09\uff0c\u5c06\u53d8\u91cf\u7684\u503c\u8f6c\u6362\u4e3a\u7a7a\u63a5\u53e3\u7684\u503c // .( \u53d8\u91cf\u7c7b\u578b )\uff0c\u5224\u65ad\u524d\u8005\u7c7b\u578b\u662f\u5426\u4e3a\u53d8\u91cf\u7c7b\u578b \u7c7b\u578b\u8f6c\u6362\u89c4\u5219\u6ce8\u610f\u4e8b\u9879\uff1a \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f T(x) \u4e2d\uff0cx\u53ef\u4ee5\u4f7f\u53d8\u91cf\uff0c\u4ee3\u8868\u503c\u7684\u5b57\u9762\u91cf\uff0c\u7ed3\u679c\u53ea\u6709\u4e00\u4e2a\u503c\u7684\u8868\u8fbe\u5f0f \u7c7b\u578b\u8f6c\u6362\u7684\u5408\u6cd5\u6027\uff0c\u5927\u8303\u56f4\u8f6c\u4e3a\u5c0f\u8303\u56f4\u4f1a\u88ab\u622a\u53d6 \u6574\u6570\u8f6cstring\uff0c\u5982\u679c\u5bf9\u5e94\u7684\u6574\u6570\u65e0\u6709\u6548\u7684unicode\u4ee3\u7801\u70b9\uff0c\u8f6c\u6362\u540e\u53d8\u6210\ufffd\uff0c\u5728Unicode\u4e2d\u4e13\u95e8\u66ff\u6362\u672a\u77e5\u7684\uff0c\u4e0d\u88ab\u8ba4\u53ef\u7684\uff0c\u65e0\u6cd5\u5c55\u793a\u7684\u5b57\u7b26 string\u7c7b\u578b\u4e0e\u5207\u7247\u7c7b\u578b\u4e4b\u95f4\u7684\u4e92\u8f6c\uff1a string- []byte:UTF-8\u5b57\u7b26\u4e32\u88ab\u62c6\u5206\u4e3aASCII\u5b57\u8282 string- []rune:UTF-8\u5b57\u7b26\u4e32\u88ab\u62c6\u5206\u4e3aUnicode\u5b57\u7b26 \u522b\u540d\u7c7b\u578b \u6f5c\u5728\u7c7b\u578b \u5173\u952e\u5b57type\u58f0\u660e\u81ea\u5b9a\u4e49\u7684\u5404\u79cd\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u5fc5\u987b\u5728Go\u8bed\u8a00\u57fa\u672c\u7c7b\u578b\u548c\u9ad8\u7ea7\u7c7b\u578b\u4e4b\u5185\u3002 \u522b\u540d\u7c7b\u578b type MyString = string // MyString\u662fstring\u7684\u522b\u540d\u7c7b\u578b\uff0c\u53ea\u662f\u540d\u79f0\u6709\u5dee\u522b\uff0c\u53ea\u8981\u7528\u4e8e\u4ee3\u7801\u91cd\u6784 byte\u662fuint8\u7684\u522b\u540d\u7c7b\u578b rune\u662fint32\u7684\u522b\u540d\u7c7b\u578b \u6f5c\u5728\u7c7b\u578b type Mystring2 string // \u5bf9\u7c7b\u578b\u5728\u5b9a\u4e49 // Mystring2\u662f\u4e00\u4e2a\u65b0\u7684\u7c7b\u578b // \u6b64\u5904string\u6210\u4e3a\u6f5c\u5728\u7c7b\u578b \u6f5c\u5728\u7c7b\u578b\u76f8\u540c\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u53ef\u4ee5\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362 \u6f5c\u5728\u7c7b\u578b\u76f8\u540c\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u4e0d\u80fd\u5224\u7b49","title":"\u7a0b\u5e8f\u5b9e\u4f53"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_1","text":"Go\u8bed\u8a00\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u5305\u62ec\uff1a \u53d8\u91cf \u5e38\u91cf \u51fd\u6570 \u7ed3\u6784\u4f53 \u63a5\u53e3 Go\u8bed\u8a00\u662f \u9759\u6001\u7c7b\u578b \u7684\u7f16\u7a0b\u8bed\u8a00\uff0c\u9700\u8981\u5728\u58f0\u660e \u53d8\u91cf \u548c \u5e38\u91cf \u7684\u65f6\u5019\uff0c\u6307\u5b9a\u5b83\u4eec\u7684\u7c7b\u578b\u6216\u7ed9\u4e88\u8db3\u591f\u7684\u4fe1\u606f\uff0c\u8ba9Go\u8bed\u8a00\u80fd\u591f\u63a8\u5bfc\u51fa\u5b83\u4eec\u7684\u7c7b\u578b\u3002 \u53d8\u91cf\u7684\u5408\u6cd5\u7c7b\u578b\uff1a Go\u8bed\u8a00\u9884\u5b9a\u4e49\u7684\u7c7b\u578b \u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u3001\u7ed3\u6784\u4f53\u3001\u63a5\u53e3 \u5e38\u91cf\u7684\u5408\u6cd5\u7c7b\u578b\uff1a Go\u8bed\u8a00\u9884\u5b9a\u4e49\u7684\u57fa\u672c\u7c7b\u578b","title":"\u7a0b\u5e8f\u5b9e\u4f53"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_2","text":"// \u53d8\u91cf\u58f0\u660e\u65b9\u5f0f\u7684\u4e0d\u540c\u65b9\u5f0f var name string var name= string // \u7c7b\u578b\u63a8\u65ad \u3010\u7f16\u7a0b\u8bed\u8a00\u5728\u7f16\u8bd1\u671f\u81ea\u52a8\u89e3\u91ca\u8868\u8fbe\u5f0f\u7c7b\u578b\u7684\u80fd\u529b\u3011 // \u8868\u8fbe\u5f0f\u7c7b\u578b\u662f\u5bf9\u8868\u8fbe\u5f0f\u6c42\u503c\u540e\u5f97\u5230\u7ed3\u679c\u7684\u7c7b\u578b // \u7c7b\u578b\u63a8\u65ad\u53ea\u80fd\u7528\u4e8e\u53d8\u91cf\u6216\u5e38\u91cf\u7684\u521d\u59cb\u5316 name := string // \u77ed\u53d8\u91cf\u58f0\u660e \u3010\u53ea\u80fd\u5728\u51fd\u6570\u4f53\u5185\u90e8\u4f7f\u7528\u3011\uff0c\u4e5f\u5c5e\u4e8e\u7c7b\u578b\u63a8\u65ad","title":"\u53d8\u91cf"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_3","text":"\u7c7b\u578b\u63a8\u65ad\u5728\u7f16\u8bd1\u671f\u6267\u884c\uff0c\u5bf9\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387\u6ca1\u6709\u5f71\u54cd\u3002 \u4ee3\u7801\u91cd\u6784\uff1a\u901a\u5e38\u628a\u4e0d\u6539\u53d8\u67d0\u4e2a\u7a0b\u5e8f\u4e0e\u5916\u754c\u7684\u4efb\u4f55\u4ea4\u4e92\u65b9\u5f0f\u548c\u89c4\u5219\uff0c\u800c\u53ea\u6539\u53d8\u5185\u90e8\u5b9e\u73b0\u7684\u4ee3\u7801\u4fee\u6539\u65b9\u5f0f\uff0c\u91cd\u6784\u5bf9\u8c61\uff08\u4ee3\u7801\u3001\u51fd\u6570\u3001\u6a21\u5757\u3001\u7cfb\u7edf\uff09\uff0c\u53ef\u4ee5\u968f\u610f\u4fee\u6539\u88ab\u91cd\u6784\u90e8\u5206\u7684\u4ee3\u7801\uff0c\u800c\u4e0d\u5f71\u54cd\u8c03\u7528\u5b83\u7684\u90e8\u5206\u3002 \u4e0d\u663e\u5f0f\u5730\u6307\u5b9a\u53d8\u91cf\u6216\u5e38\u91cf\u7684\u7c7b\u578b\uff0c\u4f7f\u5f97\u5b83\u53ef\u4ee5\u88ab\u8d4b\u4e88\u4efb\u4f55\u7c7b\u578b\u7684\u503c\uff0c\u53d8\u91cf\u7684\u7c7b\u578b\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u7531\u7a0b\u5e8f\u52a8\u6001\u786e\u5b9a\u3002 Go\u662f\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u6240\u4ee5\u4e00\u70b9\u521d\u59cb\u5316\u53d8\u91cf\u662f\u786e\u5b9a\u4e86\u7c7b\u578b\uff0c\u4e4b\u540e\u5c31\u4e0d\u80fd\u518d\u6539\u53d8 \u3002","title":"\u7c7b\u578b\u63a8\u65ad\u7684\u597d\u5904"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_4","text":"\u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\uff0c\u53ef\u4ee5\u5bf9\u7edf\u4e00\u4ee3\u7801\u5757\u4e2d\u7684\u53d8\u91cf\u8fdb\u884c\u91cd\u58f0\u660e\u3002 \u4ee3\u7801\u5757\u7684\u542b\u4e49\uff1a \u5168\u57df\u4ee3\u7801\u5757 \u4ee3\u7801\u5305 \u6e90\u6587\u4ef6 \u51fd\u6570 if\u3001for\u3001switch\u3001select\u3001case\u8bed\u53e5 \u7a7a\u4ee3\u7801\u5757 \u53d8\u91cf\u91cd\u58f0\u660e\u7684\u524d\u63d0\uff1a \u53d8\u91cf\u7684\u7c7b\u578b\u5728\u521d\u59cb\u5316\u65f6\u5df2\u7ecf\u786e\u5b9a\uff0c\u91cd\u58f0\u660e\u7684\u7c7b\u578b\u5fc5\u987b\u4e0e\u5143\u7c7b\u578b\u76f8\u540c\uff0c\u5426\u5219\u4ea7\u751f\u7f16\u8bd1\u9519\u8bef \u53d8\u91cf\u7684\u91cd\u58f0\u660e\u53ea\u80fd\u53d1\u751f\u5728\u67d0\u4e00\u4e2a\u4ee3\u7801\u5757 \u53d8\u91cf\u7684\u91cd\u58f0\u660e\u53ea\u6709\u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\u662f\u624d\u4f1a\u53d1\u751f\uff0c\u5426\u5219\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 \u58f0\u660e\u5e76\u8d4b\u503c\u7684\u53d8\u91cf\u5fc5\u987b\u662f\u591a\u4e2a\uff0c\u5e76\u4e14\u5176\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u662f\u65b0\u7684\u53d8\u91cf \u4f7f\u7528\u77ed\u53d8\u91cf\u58f0\u660e\u65f6\u53ef\u4e0d\u7528\u5224\u65ad\u5728\u610f\u88ab\u8d4b\u503c\u7684\u591a\u4e2a\u53d8\u91cf\u4e2d\u662f\u5426\u5305\u542b\u65e7\u53d8\u91cf \u3002","title":"\u53d8\u91cf\u7684\u91cd\u58f0\u660e"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_5","text":"\u4f5c\u7528\u57df\uff1a \u5305\u7ea7\u79c1\u6709\uff1a\u4ee3\u7801\u5305\uff0c\u4ee3\u7801\u5757 \u6a21\u5757\u7ea7\u79c1\u6709\uff1a\u4ee3\u7801\u5305\uff0c\u4ee3\u7801\u5757 \u516c\u5f00\uff1a\u5168\u57df\u4ee3\u7801\u5757 \u4e00\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u7684\u4f5c\u7528\u57df\u603b\u662f\u4f1a\u88ab\u9650\u5236\u5728\u67d0\u4e2a\u4ee3\u7801\u5757\u4e2d\uff0c\u800c\u8fd9\u4e2a\u4f5c\u7528\u57df\u6700\u5927\u7684\u7528\u5904\uff0c\u5c31\u662f\u5bf9\u7a0b\u5e8f\u5b9e\u4f53\u7684\u8bbf\u95ee\u6743\u9650\u7684\u63a7\u5236 \u3002 \u4ee3\u7801\u5f15\u7528\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u603b\u662f\u4f1a\u4f18\u5148\u67e5\u627e\u5f53\u524d\u4ee3\u7801\u5757\u4e2d\u7684\u53d8\u91cf\uff0c\u4e0d\u5305\u542b\u5b50\u4ee3\u7801\u5757\u3002 \u5982\u679c\u5f53\u524d\u4ee3\u7801\u5757\u4e2d\u6ca1\u6709\u58f0\u660e\u4ee5\u6b64\u4e3a\u540d\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u7a0b\u5e8f\u6cbf\u7740\u4ee3\u7801\u5757\u7684\u5d4c\u5957\u5173\u7cfb\uff0c\u4ece\u76f4\u63a5\u5305\u542b\u7684\u5f53\u524d\u5757\u5f00\u59cb\uff0c\u4e00\u5c42\u4e00\u5c42\u5730\u67e5\u627e\u3002 \u4e0d\u4f1a\u67e5\u627e\u4ee3\u7801\u5bfc\u5165\u7684\u5176\u4ed6\u5305\uff0c\u9664\u975e\u4ee3\u7801\u5305\u5bfc\u5165\u8bed\u53e5\u5982\u4e0b import . XXX ,\u8fd9\u8868\u793a\u8ba9XXX\u5305\u4e2d\u516c\u5f00\u7684\u7a0b\u5e8f\u5b9e\u4f53\u88ab\u89c6\u4e3a\u5f53\u524d\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u5b9e\u4f53\u3002 \u4e0d\u540c\u4ee3\u7801\u5757\u4e2d\u7684\u53ef\u91cd\u540d\u53d8\u91cf\u4e0e\u53d8\u91cf\u91cd\u58f0\u660e\u4e2d\u7684\u53d8\u91cf\u7684\u533a\u522b\uff1a | \u5dee\u5f02 | \u53d8\u91cf\u91cd\u58f0\u660e | \u53ef\u91cd\u540d\u53d8\u91cf | | -------- | -------------------------- | -------------------------- | | \u4ee3\u7801\u5757 | \u7edf\u4e00\u4ee3\u7801\u5757 | \u4e0d\u540c\u4ee3\u7801\u5757 | | \u6570\u91cf | \u53ea\u6709\u4e00\u4e2a\u53d8\u91cf | \u591a\u4e2a\u53d8\u91cf | | \u53d8\u91cf\u7c7b\u578b | \u7c7b\u578b\u4e0d\u53ef\u53d8\uff0c\u4e0e\u521d\u59cb\u5316\u65f6\u76f8\u540c | \u7c7b\u578b\u4efb\u610f | | \u53d8\u91cf\u5c4f\u853d | \u65e0 | \u4ee3\u7801\u5757\u5d4c\u5957\uff0c\u5219\u51fa\u73b0\u53d8\u91cf\u5c4f\u853d |","title":"\u4ee3\u7801\u5757"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_6","text":"\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\uff1a x.(T) ,x\u4ee3\u8868\u8981\u5224\u65ad\u7c7b\u578b\u7684\u503c \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u4e66\uff1a T(x) ,x\u6e90\u503c\uff0cx\u7684\u7c7b\u578b\u662f\u6e90\u7c7b\u578b\uff0cT\u76ee\u6807\u7c7b\u578b \u5728Go\u8bed\u8a00\u4e2d Interface{} \u4ee3\u8868\u7a7a\u63a5\u53e3\uff0c\u4efb\u4f55\u7c7b\u578b\u90fd\u662f\u5b83\u7684\u5b9e\u73b0\u7c7b\u578b\u3002Interface{}(x),\u5c06x\u8f6c\u6362\u4e3a\u7a7a\u63a5\u53e3\u7684\u503c\u3002 {}\u7684\u542b\u4e49\uff0c\u7a7a\u4ee3\u7801\u5757\u6216\u8005\u7a7a\u6570\u636e\u7c7b\u578b\u3002 value,ok := interface{}(container).([]string) //value\uff1a\u7c7b\u578b\u8f6c\u6362\u540e\u7684\u503c\uff0cok\uff1a\u65ad\u8a00\u662f\u5426\u6210\u529f // value,ok := interface{}( \u53d8\u91cf ).( \u53d8\u91cf\u7c7b\u578b ) // interface{}\uff08 \u53d8\u91cf \uff09\uff0c\u5c06\u53d8\u91cf\u7684\u503c\u8f6c\u6362\u4e3a\u7a7a\u63a5\u53e3\u7684\u503c // .( \u53d8\u91cf\u7c7b\u578b )\uff0c\u5224\u65ad\u524d\u8005\u7c7b\u578b\u662f\u5426\u4e3a\u53d8\u91cf\u7c7b\u578b \u7c7b\u578b\u8f6c\u6362\u89c4\u5219\u6ce8\u610f\u4e8b\u9879\uff1a \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f T(x) \u4e2d\uff0cx\u53ef\u4ee5\u4f7f\u53d8\u91cf\uff0c\u4ee3\u8868\u503c\u7684\u5b57\u9762\u91cf\uff0c\u7ed3\u679c\u53ea\u6709\u4e00\u4e2a\u503c\u7684\u8868\u8fbe\u5f0f \u7c7b\u578b\u8f6c\u6362\u7684\u5408\u6cd5\u6027\uff0c\u5927\u8303\u56f4\u8f6c\u4e3a\u5c0f\u8303\u56f4\u4f1a\u88ab\u622a\u53d6 \u6574\u6570\u8f6cstring\uff0c\u5982\u679c\u5bf9\u5e94\u7684\u6574\u6570\u65e0\u6709\u6548\u7684unicode\u4ee3\u7801\u70b9\uff0c\u8f6c\u6362\u540e\u53d8\u6210\ufffd\uff0c\u5728Unicode\u4e2d\u4e13\u95e8\u66ff\u6362\u672a\u77e5\u7684\uff0c\u4e0d\u88ab\u8ba4\u53ef\u7684\uff0c\u65e0\u6cd5\u5c55\u793a\u7684\u5b57\u7b26 string\u7c7b\u578b\u4e0e\u5207\u7247\u7c7b\u578b\u4e4b\u95f4\u7684\u4e92\u8f6c\uff1a string- []byte:UTF-8\u5b57\u7b26\u4e32\u88ab\u62c6\u5206\u4e3aASCII\u5b57\u8282 string- []rune:UTF-8\u5b57\u7b26\u4e32\u88ab\u62c6\u5206\u4e3aUnicode\u5b57\u7b26","title":"\u5224\u65ad\u53d8\u91cf\u7c7b\u578b"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_7","text":"\u5173\u952e\u5b57type\u58f0\u660e\u81ea\u5b9a\u4e49\u7684\u5404\u79cd\u7c7b\u578b\uff0c\u8fd9\u4e9b\u7c7b\u578b\u5fc5\u987b\u5728Go\u8bed\u8a00\u57fa\u672c\u7c7b\u578b\u548c\u9ad8\u7ea7\u7c7b\u578b\u4e4b\u5185\u3002","title":"\u522b\u540d\u7c7b\u578b&amp;\u6f5c\u5728\u7c7b\u578b"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_8","text":"type MyString = string // MyString\u662fstring\u7684\u522b\u540d\u7c7b\u578b\uff0c\u53ea\u662f\u540d\u79f0\u6709\u5dee\u522b\uff0c\u53ea\u8981\u7528\u4e8e\u4ee3\u7801\u91cd\u6784 byte\u662fuint8\u7684\u522b\u540d\u7c7b\u578b rune\u662fint32\u7684\u522b\u540d\u7c7b\u578b","title":"\u522b\u540d\u7c7b\u578b"},{"location":"Language/Basic/04-\u7a0b\u5e8f\u5b9e\u4f53/#_9","text":"type Mystring2 string // \u5bf9\u7c7b\u578b\u5728\u5b9a\u4e49 // Mystring2\u662f\u4e00\u4e2a\u65b0\u7684\u7c7b\u578b // \u6b64\u5904string\u6210\u4e3a\u6f5c\u5728\u7c7b\u578b \u6f5c\u5728\u7c7b\u578b\u76f8\u540c\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u53ef\u4ee5\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362 \u6f5c\u5728\u7c7b\u578b\u76f8\u540c\u7684\u4e0d\u540c\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u4e0d\u80fd\u5224\u7b49","title":"\u6f5c\u5728\u7c7b\u578b"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/","text":"\u6570\u7ec4\u548c\u5207\u7247 \u5171\u540c\u70b9\uff1a\u90fd\u5c5e\u4e8e\u96c6\u5408\u7c7b\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u5b58\u50a8\u67d0\u4e00\u79cd\u7c7b\u578b\u7684\u503c\uff1b\u5e94\u7528\u7d22\u5f15\u8868\u8fbe\u5f0f\u5f97\u5230\u503c\uff0c\u5e94\u7528\u5207\u7247\u8868\u8fbe\u5f0f\u5f97\u5230\u65b0\u5207\u7247\u3002 \u4e0d\u540c\u70b9\uff1a\u6570\u7ec4\u7684\u503c\u957f\u5ea6\u56fa\u5b9a\uff0c\u5207\u7247\u7684\u503c\u53ef\u53d8\u957f \u6570\u7ec4\u7684\u957f\u5ea6\u5fc5\u987b\u5728\u58f0\u660e\u65f6\u7ed9\u5b9a\uff0c\u4e14\u4e0d\u53ef\u53d8\uff0c\u5b83\u662f\u6570\u7ec4\u7c7b\u578b\u7684\u4e00\u90e8\u5206 \u3002 \u5207\u7247\u7684\u7c7b\u578b\u5b57\u9762\u91cf\u4e2d\uff0c\u53ea\u6709\u5143\u7d20\u7c7b\u578b\uff0c\u957f\u5ea6\u968f\u7740\u5143\u7d20\u6570\u91cf\u589e\u957f\u800c\u589e\u957f\uff0c\u4f46\u4e0d\u4f1a\u51cf\u5c0f \u3002 \u5207\u7247\u53ef\u4ee5\u770b\u6210\u662f\u5bf9\u6570\u7ec4\u7684\u4e00\u5c42\u7b80\u5355\u5c01\u88c5\uff0c\u5728\u6bcf\u4e2a\u5207\u7247\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u4e00\u5b9a\u4f1a\u5305\u542b\u4e00\u4e2a\u6570\u7ec4\u3002 \u6570\u7ec4\uff1a\u662f\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4 \u5207\u7247\uff1a\u662f\u5bf9\u6570\u7ec4\u7684\u67d0\u4e2a\u8fde\u7eed\u7247\u6bb5\u7684\u5f15\u7528\uff0c\u5207\u7247\u7684\u5bb9\u91cf\u4ee3\u8868\u4e86\u5176\u53ef\u89c1\u5e95\u5c42\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\u4e0d\u53ef\u53d8 \u5f15\u7528\u7c7b\u578b\u4e0e\u503c\u7c7b\u578b \u5f15\u7528\u7c7b\u578b\uff1a \u5207\u7247\u7c7b\u578b\uff08\u5207\u7247\u662f\u5bf9\u6570\u7ec4\u67d0\u4e2a\u8fde\u7eed\u7247\u6bb5\u7684\u5f15\u7528\uff09 \u5b57\u5178\u7c7b\u578b \u901a\u9053\u7c7b\u578b \u51fd\u6570\u7c7b\u578b \u503c\u7c7b\u578b\uff1a \u57fa\u7840\u6570\u636e\u7c7b\u578b \u7ed3\u6784\u4f53\u7c7b\u578b \u6570\u7ec4\u7c7b\u578b Go\u8bed\u8a00\u4e2d\u4e0d\u5b58\u5728\u201c\u4f20\u503c\u6216\u4f20\u5f15\u7528\u201d\u7684\u95ee\u9898\uff0c\u5728Go\u8bed\u8a00\u4e2d\u53ea\u8981\u770b \u88ab\u4f20\u9012\u7684\u503c\u7684\u7c7b\u578b \uff0c\u5982\u679c\u88ab\u4f20\u9012\u7684\u503c\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u5c31\u662f\u201c\u4f20\u5f15\u7528\u201d\uff0c\u5982\u679c\u88ab\u4f20\u9012\u7684\u503c\u662f\u503c\u7c7b\u578b\uff0c\u90a3\u5c31\u662f\u201c\u4f20\u503c\u201d\u3002\u4ece\u4f20\u9012\u6210\u672c\u7684\u89d2\u5ea6\uff0c\u5f15\u7528\u7c7b\u578b\u7684\u503c\u6bd4\u503c\u7c7b\u578b\u7684\u503c\u6210\u672c\u4f4e\u5f88\u591a\u3002 \u5185\u5efa\u51fd\u6570 len()\uff1a\u5f97\u5230\u6570\u7ec4\u6216\u5207\u7247\u7684 \u957f\u5ea6 cap()\uff1a\u5f97\u5230\u6570\u7ec4\u6216\u5207\u7247\u7684 \u5bb9\u91cf make(): \u521b\u5efa\u5207\u7247\u7b49 \u6570\u7ec4\u5bb9\u91cf\u6c38\u8fdc\u548c\u957f\u5ea6\u76f8\u7b49\uff0c\u4e14\u4e0d\u53ef\u53d8 \u3002 // usage of make() make(types interface{},length int,capacity int) // types:\u8981\u521b\u5efa\u7684\u7c7b\u578b // length\uff1a\u8be5\u7c7b\u578b\u7684\u957f\u5ea6 // capacity\uff1a\u8be5\u7c7b\u578b\u7684\u5bb9\u91cf \u5207\u7247\u4e0e\u5e95\u5c42\u6570\u7ec4\u7684\u5bf9\u5e94\u5173\u7cfb // make\u51fd\u6570\u6216\u5207\u7247\u503c\u5b57\u9762\u91cf\u521d\u59cb\u5316\u65f6\uff0c\u5207\u7247\u6700\u5de6\u8fb9\u4e0e\u5e95\u5c42\u6570\u7ec4\u6700\u5de6\u8fb9\u5bf9\u5e94 slice1 := make([]int,3,5) sliec2 := []int{1,2,3,4,5,6,7,8} // \u5207\u7247\u8868\u8fbe\u4e66\u521b\u5efa\u5207\u7247\u65f6,\u5207\u7247\u6700\u5de6\u8fb9\u4e0e\u5e95\u5c42\u6570\u7ec4\u7d22\u5f15\u5bf9\u5e94\uff0cslice3\u7684\u6700\u5de6\u8fb9\u5bf9\u5e94slice2\u7684\u7d22\u5f153 slice3 := slice2[3:6] // slice3\u7684\u5bb9\u91cf\u4e3a\u53ef\u89c1\u5e95\u5c42\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5373\u5e95\u5c42\u6570\u7ec4\u51cf\u53bb\u5207\u7247\u8d77\u59cb\u7d22\u5f15\u503c // slice3\u5411\u53f3\u6269\u5c55\u81f3\u6700\u5927 slice3 = slice3[0:cap(slice3)] \u5207\u7247\u8868\u8fbe\u5f0f\u662f\u4e00\u4e2a\u5f00\u533a\u95f4\uff0c\u5f97\u5230\u7684\u65b0\u5207\u7247\u7684\u5bb9\u91cf\u548c\u957f\u5ea6\u4e3a\u533a\u95f4\u7684\u5dee\u503c\u3002\u65b0\u5207\u7247\u7684\u8d77\u59cb\u503c\u4e3a\u539f\u5207\u7247\u6216\u6570\u7ec4\u5bf9\u5e94\u7684\u7d22\u5f15\u503c\u3002 \u5207\u7247\u65e0\u6cd5\u5411\u5de6\u6269\u5c55\uff0c\u4f46\u662f\u53ef\u4ee5\u5411\u53f3\u6269\u5c55\u3002 \u5207\u7247\u6269\u5bb9 \u5f53\u5207\u7247\u65e0\u6cd5\u5bb9\u7eb3\u66f4\u591a\u5143\u7d20\u65f6\uff0cGo\u7528\u8bed\u8a00\u4f1a\u8fdb\u884c\u6269\u5bb9\uff0c\u4e0d\u4f1a\u6539\u53d8\u539f\u5207\u7247\uff0c\u800c\u662f\u521b\u5efa\u4e00\u4e2a\u5bb9\u91cf\u66f4\u5927\u7684\u65b0\u5207\u7247\uff0c\u5c06\u539f\u6765\u7684\u5143\u7d20\u548c\u65b0\u7684\u5143\u7d20\u4e00\u8d77\u62f7\u8d1d\u5230\u65b0\u7684\u5207\u7247\u4e2d\u3002 \u4e00\u822c\u60c5\u51b5\u6269\u5bb92\u500d\uff0c\u5f53\u539f\u5207\u7247\u7684\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e1024\u540e\uff0c\u4e00\u6b21\u589e\u957f1.25\u500d\u7684\u65b9\u5f0f\u9010\u6e10\u6269\u5bb9\u3002 \u5207\u7247\u5e95\u5c42\u6570\u7ec4\u88ab\u66ff\u6362\u7684\u60c5\u51b5 \u5207\u7247\u5728\u6269\u5bb9\u65f6\uff0c\u521b\u5efa\u4e86\u65b0\u7684\u5207\u7247\u548c\u65b0\u7684\u5e95\u5c42\u6570\u7ec4\uff0c\u539f\u6765\u7684\u5207\u7247\u548c\u5e95\u5c42\u6570\u7ec4\u6ca1\u6709\u4efb\u4f55\u6539\u52a8\u3002 \u5728\u5e95\u5c42\u6570\u7ec4\u5bb9\u91cf\uff08\u5373\u5207\u7247\u5bb9\u91cf\uff09\u8db3\u591f\u7684\u60c5\u51b5\u4e0b append() \u51fd\u6570\u8fd4\u56de\u7684\u662f\u6307\u5411 \u539f\u5e95\u5c42\u6570\u7ec4 \u7684\u5207\u7247 \u5728\u5e95\u5c42\u6570\u7ec4\u5bb9\u91cf\uff08\u5373\u5207\u7247\u5bb9\u91cf\uff09\u4e0d\u591f\u7684\u60c5\u51b5\u4e0b append() \u51fd\u6570\u8fd4\u56de\u7684\u662f\u6307\u5411 \u65b0\u5e95\u5c42\u6570\u7ec4 \u7684\u65b0\u5207\u7247","title":"\u6570\u7ec4\u548c\u5207\u7247"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_1","text":"\u5171\u540c\u70b9\uff1a\u90fd\u5c5e\u4e8e\u96c6\u5408\u7c7b\u7684\u7c7b\u578b\uff0c\u53ef\u4ee5\u5b58\u50a8\u67d0\u4e00\u79cd\u7c7b\u578b\u7684\u503c\uff1b\u5e94\u7528\u7d22\u5f15\u8868\u8fbe\u5f0f\u5f97\u5230\u503c\uff0c\u5e94\u7528\u5207\u7247\u8868\u8fbe\u5f0f\u5f97\u5230\u65b0\u5207\u7247\u3002 \u4e0d\u540c\u70b9\uff1a\u6570\u7ec4\u7684\u503c\u957f\u5ea6\u56fa\u5b9a\uff0c\u5207\u7247\u7684\u503c\u53ef\u53d8\u957f \u6570\u7ec4\u7684\u957f\u5ea6\u5fc5\u987b\u5728\u58f0\u660e\u65f6\u7ed9\u5b9a\uff0c\u4e14\u4e0d\u53ef\u53d8\uff0c\u5b83\u662f\u6570\u7ec4\u7c7b\u578b\u7684\u4e00\u90e8\u5206 \u3002 \u5207\u7247\u7684\u7c7b\u578b\u5b57\u9762\u91cf\u4e2d\uff0c\u53ea\u6709\u5143\u7d20\u7c7b\u578b\uff0c\u957f\u5ea6\u968f\u7740\u5143\u7d20\u6570\u91cf\u589e\u957f\u800c\u589e\u957f\uff0c\u4f46\u4e0d\u4f1a\u51cf\u5c0f \u3002 \u5207\u7247\u53ef\u4ee5\u770b\u6210\u662f\u5bf9\u6570\u7ec4\u7684\u4e00\u5c42\u7b80\u5355\u5c01\u88c5\uff0c\u5728\u6bcf\u4e2a\u5207\u7247\u7684\u5e95\u5c42\u6570\u636e\u7ed3\u6784\u4e2d\uff0c\u4e00\u5b9a\u4f1a\u5305\u542b\u4e00\u4e2a\u6570\u7ec4\u3002 \u6570\u7ec4\uff1a\u662f\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4 \u5207\u7247\uff1a\u662f\u5bf9\u6570\u7ec4\u7684\u67d0\u4e2a\u8fde\u7eed\u7247\u6bb5\u7684\u5f15\u7528\uff0c\u5207\u7247\u7684\u5bb9\u91cf\u4ee3\u8868\u4e86\u5176\u53ef\u89c1\u5e95\u5c42\u6570\u7ec4\u7684\u957f\u5ea6\uff0c\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4\u957f\u5ea6\u4e0d\u53ef\u53d8","title":"\u6570\u7ec4\u548c\u5207\u7247"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_2","text":"\u5f15\u7528\u7c7b\u578b\uff1a \u5207\u7247\u7c7b\u578b\uff08\u5207\u7247\u662f\u5bf9\u6570\u7ec4\u67d0\u4e2a\u8fde\u7eed\u7247\u6bb5\u7684\u5f15\u7528\uff09 \u5b57\u5178\u7c7b\u578b \u901a\u9053\u7c7b\u578b \u51fd\u6570\u7c7b\u578b \u503c\u7c7b\u578b\uff1a \u57fa\u7840\u6570\u636e\u7c7b\u578b \u7ed3\u6784\u4f53\u7c7b\u578b \u6570\u7ec4\u7c7b\u578b Go\u8bed\u8a00\u4e2d\u4e0d\u5b58\u5728\u201c\u4f20\u503c\u6216\u4f20\u5f15\u7528\u201d\u7684\u95ee\u9898\uff0c\u5728Go\u8bed\u8a00\u4e2d\u53ea\u8981\u770b \u88ab\u4f20\u9012\u7684\u503c\u7684\u7c7b\u578b \uff0c\u5982\u679c\u88ab\u4f20\u9012\u7684\u503c\u662f\u5f15\u7528\u7c7b\u578b\uff0c\u90a3\u5c31\u662f\u201c\u4f20\u5f15\u7528\u201d\uff0c\u5982\u679c\u88ab\u4f20\u9012\u7684\u503c\u662f\u503c\u7c7b\u578b\uff0c\u90a3\u5c31\u662f\u201c\u4f20\u503c\u201d\u3002\u4ece\u4f20\u9012\u6210\u672c\u7684\u89d2\u5ea6\uff0c\u5f15\u7528\u7c7b\u578b\u7684\u503c\u6bd4\u503c\u7c7b\u578b\u7684\u503c\u6210\u672c\u4f4e\u5f88\u591a\u3002","title":"\u5f15\u7528\u7c7b\u578b\u4e0e\u503c\u7c7b\u578b"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_3","text":"len()\uff1a\u5f97\u5230\u6570\u7ec4\u6216\u5207\u7247\u7684 \u957f\u5ea6 cap()\uff1a\u5f97\u5230\u6570\u7ec4\u6216\u5207\u7247\u7684 \u5bb9\u91cf make(): \u521b\u5efa\u5207\u7247\u7b49 \u6570\u7ec4\u5bb9\u91cf\u6c38\u8fdc\u548c\u957f\u5ea6\u76f8\u7b49\uff0c\u4e14\u4e0d\u53ef\u53d8 \u3002 // usage of make() make(types interface{},length int,capacity int) // types:\u8981\u521b\u5efa\u7684\u7c7b\u578b // length\uff1a\u8be5\u7c7b\u578b\u7684\u957f\u5ea6 // capacity\uff1a\u8be5\u7c7b\u578b\u7684\u5bb9\u91cf","title":"\u5185\u5efa\u51fd\u6570"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_4","text":"// make\u51fd\u6570\u6216\u5207\u7247\u503c\u5b57\u9762\u91cf\u521d\u59cb\u5316\u65f6\uff0c\u5207\u7247\u6700\u5de6\u8fb9\u4e0e\u5e95\u5c42\u6570\u7ec4\u6700\u5de6\u8fb9\u5bf9\u5e94 slice1 := make([]int,3,5) sliec2 := []int{1,2,3,4,5,6,7,8} // \u5207\u7247\u8868\u8fbe\u4e66\u521b\u5efa\u5207\u7247\u65f6,\u5207\u7247\u6700\u5de6\u8fb9\u4e0e\u5e95\u5c42\u6570\u7ec4\u7d22\u5f15\u5bf9\u5e94\uff0cslice3\u7684\u6700\u5de6\u8fb9\u5bf9\u5e94slice2\u7684\u7d22\u5f153 slice3 := slice2[3:6] // slice3\u7684\u5bb9\u91cf\u4e3a\u53ef\u89c1\u5e95\u5c42\u6570\u7ec4\u7684\u5bb9\u91cf\uff0c\u5373\u5e95\u5c42\u6570\u7ec4\u51cf\u53bb\u5207\u7247\u8d77\u59cb\u7d22\u5f15\u503c // slice3\u5411\u53f3\u6269\u5c55\u81f3\u6700\u5927 slice3 = slice3[0:cap(slice3)] \u5207\u7247\u8868\u8fbe\u5f0f\u662f\u4e00\u4e2a\u5f00\u533a\u95f4\uff0c\u5f97\u5230\u7684\u65b0\u5207\u7247\u7684\u5bb9\u91cf\u548c\u957f\u5ea6\u4e3a\u533a\u95f4\u7684\u5dee\u503c\u3002\u65b0\u5207\u7247\u7684\u8d77\u59cb\u503c\u4e3a\u539f\u5207\u7247\u6216\u6570\u7ec4\u5bf9\u5e94\u7684\u7d22\u5f15\u503c\u3002 \u5207\u7247\u65e0\u6cd5\u5411\u5de6\u6269\u5c55\uff0c\u4f46\u662f\u53ef\u4ee5\u5411\u53f3\u6269\u5c55\u3002","title":"\u5207\u7247\u4e0e\u5e95\u5c42\u6570\u7ec4\u7684\u5bf9\u5e94\u5173\u7cfb"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_5","text":"\u5f53\u5207\u7247\u65e0\u6cd5\u5bb9\u7eb3\u66f4\u591a\u5143\u7d20\u65f6\uff0cGo\u7528\u8bed\u8a00\u4f1a\u8fdb\u884c\u6269\u5bb9\uff0c\u4e0d\u4f1a\u6539\u53d8\u539f\u5207\u7247\uff0c\u800c\u662f\u521b\u5efa\u4e00\u4e2a\u5bb9\u91cf\u66f4\u5927\u7684\u65b0\u5207\u7247\uff0c\u5c06\u539f\u6765\u7684\u5143\u7d20\u548c\u65b0\u7684\u5143\u7d20\u4e00\u8d77\u62f7\u8d1d\u5230\u65b0\u7684\u5207\u7247\u4e2d\u3002 \u4e00\u822c\u60c5\u51b5\u6269\u5bb92\u500d\uff0c\u5f53\u539f\u5207\u7247\u7684\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e1024\u540e\uff0c\u4e00\u6b21\u589e\u957f1.25\u500d\u7684\u65b9\u5f0f\u9010\u6e10\u6269\u5bb9\u3002","title":"\u5207\u7247\u6269\u5bb9"},{"location":"Language/Basic/05-\u6570\u7ec4\u548c\u5207\u7247/#_6","text":"\u5207\u7247\u5728\u6269\u5bb9\u65f6\uff0c\u521b\u5efa\u4e86\u65b0\u7684\u5207\u7247\u548c\u65b0\u7684\u5e95\u5c42\u6570\u7ec4\uff0c\u539f\u6765\u7684\u5207\u7247\u548c\u5e95\u5c42\u6570\u7ec4\u6ca1\u6709\u4efb\u4f55\u6539\u52a8\u3002 \u5728\u5e95\u5c42\u6570\u7ec4\u5bb9\u91cf\uff08\u5373\u5207\u7247\u5bb9\u91cf\uff09\u8db3\u591f\u7684\u60c5\u51b5\u4e0b append() \u51fd\u6570\u8fd4\u56de\u7684\u662f\u6307\u5411 \u539f\u5e95\u5c42\u6570\u7ec4 \u7684\u5207\u7247 \u5728\u5e95\u5c42\u6570\u7ec4\u5bb9\u91cf\uff08\u5373\u5207\u7247\u5bb9\u91cf\uff09\u4e0d\u591f\u7684\u60c5\u51b5\u4e0b append() \u51fd\u6570\u8fd4\u56de\u7684\u662f\u6307\u5411 \u65b0\u5e95\u5c42\u6570\u7ec4 \u7684\u65b0\u5207\u7247","title":"\u5207\u7247\u5e95\u5c42\u6570\u7ec4\u88ab\u66ff\u6362\u7684\u60c5\u51b5"},{"location":"Language/Basic/06-\u94fe\u8868/","text":"\u94fe\u8868 Go\u8bed\u8a00\u7684\u94fe\u8868\u5b9e\u73b0\u5728\u6807\u51c6\u5e93\u7684 container/list \u4ee3\u7801\u5305\u4e2d\u3002\u4ee3\u7801\u5305\u4e2d\u6709\u4e24\u4e2a\u516c\u5f00\u7684\u7a0b\u5e8f\u5b9e\u4f53\uff1a List\uff1a\u53cc\u5411\u94fe\u8868 Element\uff1a\u94fe\u8868\u4e2d\u5143\u7d20\u7684\u7ed3\u6784 List\u7684\u65b9\u6cd5\uff1a MoveBefore MoveAfter\uff1a\u628a \u7ed9\u5b9a\u5143\u7d20 \u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u5143\u7d20\u7684\u524d\u9762\u6216\u540e\u9762 MoveToFront MoveToBack\uff1a\u628a \u7ed9\u5b9a\u5143\u7d20 \u79fb\u52a8\u5230\u94fe\u8868\u7684\u6700\u524d\u7aef\u548c\u6700\u540e\u7aef \u8fd9\u4e9b\u7ed9\u5b9a\u5143\u7d20\u90fd\u662f *Element \u7c7b\u578b\uff0c *Element \u7684\u503c\u5c31\u662f\u5143\u7d20\u7684\u6307\u9488\u3002 func (l *List) MoveBefore(e, mark *Element) func (l *List) MoveAfter(e, mark *Element) func (l *List) MoveToFront(e *Element) func (l *List) MoveToBack(e *Element) \u5728List\u5305\u542b\u7684\u65b9\u6cd5\u4e2d\uff0c\u7528\u4e8e\u63d2\u5165\u65b0\u5143\u7d20\u7684\u90a3\u4e9b\u65b9\u6cd5\u90fd\u53ea\u63a5\u53d7Interface{}\u7c7b\u578b\u7684\u503c\u3002\u8fd9\u4e9b\u65b9\u6cd5\u5728\u5185\u90e8\u4f1a\u4f7f\u7528Element\u503c\uff0c\u5305\u88c5\u63a5\u6536\u5230\u7684\u65b0\u5143\u7d20\u3002 \u8fd9\u6837\u5b50\u4e3a\u4e86\u907f\u514d\u94fe\u8868\u7684\u5185\u90e8\u5173\u8054\u906d\u5230\u5916\u754c\u7834\u574f \u3002 func (l *List) Front() *Element //\u8fd4\u56de\u94fe\u8868\u6700\u524d\u7aef\u5143\u7d20\u7684\u6307\u9488 func (l *List) Back() *Element //\u8fd4\u56de\u94fe\u8868\u6700\u540e\u6bb5\u5143\u7d20\u7684\u6307\u9488 func (l *List) InsertBefore(v interface{}, mark *Element) *Element //\u5728\u94fe\u8868\u6307\u5b9a\u5143\u7d20\u524d\u63d2\u5165\u5143\u7d20\u5e76\u8fd4\u56de\u63d2\u5165\u5143\u7d20\u7684\u6307\u9488 func (l *List) InsertAfter(v interface{}, mark *Element) *Element //\u5728\u94fe\u8868\u6307\u5b9a\u5143\u7d20\u540e\u63d2\u5165\u5143\u7d20\u5e76\u8fd4\u56de\u63d2\u5165\u5143\u7d20\u7684\u6307\u9488 func (l *List) PushFront(v interface{}) *Element //\u5c06\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u5230\u94fe\u8868\u5934 func (l *List) PushBack(v interface{}) *Element //\u5c06\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u5230\u94fe\u8868\u5c3e \u94fe\u8868\u5f00\u7bb1\u5373\u7528 List\u548cElement\u90fd\u662f\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c \u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u7279\u70b9\u662f\u5b83\u4eec\u7684\u96f6\u503c\u90fd\u62e5\u6709\u7279\u5b9a\u7ed3\u6784\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u5b9a\u5236\u5316\u5185\u5bb9\u7684\u503c\uff0c\u503c\u4e2d\u7684\u5b57\u6bb5\u90fd\u88ab\u8d4b\u4e88\u5404\u81ea\u7c7b\u578b\u7684\u96f6\u503c \u3002 \u53ea\u505a\u58f0\u660e\u5374\u6ca1\u6709\u521d\u59cb\u5316\u7684\u53d8\u91cf\u88ab\u8d4b\u4e88\u7684\u7f3a\u7701\u503c\u5c31\u662f\u96f6\u503c\uff0c\u6bcf\u4e2a\u7c7b\u578b\u7684\u96f6\u503c\u90fd\u4f1a\u4f9d\u636e\u8be5\u7c7b\u578b\u7684\u7279\u6027\u800c\u88ab\u8bbe\u5b9a\u3002 var l list.List \u58f0\u660e\u7684\u53d8\u91cfl\u7684\u503c\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a0\u7684\u94fe\u8868\uff0c\u94fe\u8868\u6301\u6709\u7684\u6839\u5143\u7d20\u4e5f\u662f\u4e00\u4e2a\u7a7a\u58f3\uff0c\u5176\u4e2d\u5305\u542b\u7f3a\u7701\u7684\u5185\u5bb9\u3002\u8fd9\u6837\u7684\u94fe\u8868\u53ef\u4ee5\u5f00\u7bb1\u5373\u7528\u7684\u539f\u56e0\u5728\u4e8e\u201c\u5ef6\u8fdf\u521d\u59cb\u5316\u201d\u673a\u5236\u3002 \u5ef6\u8fdf\u521d\u59cb\u5316 \u4f18\u70b9\uff1a \u628a\u521d\u59cb\u5316\u64cd\u4f5c\u5ef6\u540e\uff0c\u4ec5\u5728\u5b9e\u9645\u9700\u8981\u7684\u65f6\u5019\u624d\u8fdb\u884c\uff0c\u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u4f18\u70b9\u5728\u4e8e\u201c\u5ef6\u540e\u201d\uff0c \u5b83\u53ef\u4ee5\u5206\u6563\u521d\u59cb\u5316\u64cd\u4f5c\u5e26\u6765\u7684\u8ba1\u7b97\u91cf\u548c\u5b58\u50a8\u7a7a\u95f4\u6d88\u8017 \u3002 \u5982\u679c\u9700\u8981\u96c6\u4e2d\u58f0\u660e\u975e\u5e38\u591a\u7684\u5927\u5bb9\u91cf\u5207\u7247\uff0c\u90a3\u4e48CPU\u548c\u5185\u5b58\u7684\u4f7f\u7528\u91cf\u80af\u5b9a\u4f1a\u6fc0\u589e\uff0c\u5e76\u4e14\u53ea\u8981\u8bbe\u6cd5\u8ba9\u5176\u4e2d\u7684\u5207\u7247\u548c\u5e95\u5c42\u6570\u7ec4\u88ab\u56de\u6536\uff0c\u5185\u5b58\u4f7f\u7528\u91cf\u624d\u4f1a\u6709\u6240\u4e0b\u964d\u3002\u5982\u679c\u6570\u7ec4\u53ef\u4ee5\u88ab\u5ef6\u8fdf\u521d\u59cb\u5316\uff0c\u90a3\u4e48CPU\u548c\u5185\u5b58\u7684\u538b\u529b\u5c31\u88ab\u5206\u6563\u5230\u5b9e\u9645\u4f7f\u7528\u5b83\u4eec\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u6570\u7ec4\u88ab\u5b9e\u9645\u4f7f\u7528\u7684\u65f6\u95f4\u8d8a\u5206\u6563\uff0c\u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u4f18\u52bf\u5c31\u8d8a\u660e\u663e\u3002 \u7f3a\u70b9\uff1a \u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u7f3a\u70b9\u4e5f\u5728\u4e8e\u201c\u5ef6\u540e\u201d\uff0c\u5982\u679c\u5728\u8c03\u7528\u94fe\u8868\u7684\u6bcf\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u5148\u53bb\u5224\u65ad\u94fe\u8868\u662f\u5426\u5df2\u7ecf\u88ab\u521d\u59cb\u5316\uff0c\u8fd9\u4e5f\u662f\u8ba1\u7b97\u91cf\u4e0a\u7684\u6d6a\u8d39\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u88ab\u975e\u5e38\u9891\u7e41\u5730\u8c03\u7528\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u79cd\u6d6a\u8d39\u7684\u5f71\u54cd\u5c31\u5f00\u59cb\u660e\u663e\uff0c\u7a0b\u5e8f\u7684\u6027\u80fd\u4f1a\u964d\u4f4e\u3002 \u89e3\u51b3\u65b9\u6848\uff1a \u5728\u94fe\u8868\u7684\u89c6\u7ebf\u4e2d\uff0c\u4e00\u4e9b\u65b9\u6cd5\u65e0\u9700\u5bf9\u662f\u5426\u521d\u59cb\u5316\u505a\u5224\u65ad\uff0c\u5982 Front() \u548c Back() \u65b9\u6cd5\uff0c\u4e00\u65e6\u53d1\u73b0\u94fe\u8868\u7684\u957f\u5ea6\u4e3a0\uff0c\u76f4\u63a5\u8fd4\u56denil \u5728\u63d2\u5165\u3001\u5220\u9664\u6216\u79fb\u52a8\u5143\u7d20\u7684\u65b9\u6cd5\u4e2d\uff0c\u53ea\u8981\u5224\u65ad\u4f20\u5165\u7684\u5143\u7d20\u4e2d\u6307\u5411\u6240\u5c5e\u94fe\u8868\u7684\u6307\u9488\uff0c\u662f\u5426\u4e0e\u5f53\u524d\u94fe\u8868\u7684\u6307\u9488\u76f8\u7b49\u5c31\u53ef\u4ee5 PushFront() \u3001 PushBack() \u3001 PushBackList() \u3001 PushFrontList() \u65b9\u6cd5\u603b\u662f\u4f1a\u5148\u5224\u65ad\u94fe\u8868\u7684\u72b6\u6001\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u8fdb\u884c\u5ef6\u8fdf\u521d\u59cb\u5316\u3002\u5728\u5411\u65b0\u94fe\u8868\u4e2d\u6dfb\u52a0\u65b0\u5143\u7d20\u65f6\uff0c\u80af\u5b9a\u4f1a\u8c03\u7528\u8fd9\u56db\u4e2a\u65b9\u6cd5\u4e4b\u4e00\u3002 Ring\u4e0eList\u7684\u533a\u522b container/ring \u5305\u4e2d\u7684Ring\u7c7b\u578b\u5b9e\u73b0\u7684\u662f\u4e00\u4e2a\u5faa\u73af\u94fe\u8868\uff08\u73af\uff09\u3002 List\u5728\u5185\u90e8\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\u94fe\u8868\uff0c\u5b83\u7684\u6839\u5143\u7d20\u6c38\u8fdc\u4e0d\u4f1a\u6301\u6709\u4efb\u4f55\u5b9e\u9645\u7684\u5143\u7d20\u503c\uff0c\u800c\u8be5\u5143\u7d20\u7684\u5b58\u5728\u662f\u4e3a\u4e86\u8fde\u63a5\u8fd9\u4e2a\u5faa\u73af\u94fe\u8868\u7684\u6536\u5c3e\u4e24\u7aef\u3002List\u7684\u96f6\u503c\u662f\u5df2\u7ed9\u53ea\u5305\u542b\u6839\u5143\u7d20\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u5b9e\u9645\u5143\u7d20\u503c\u7684\u7a7a\u94fe\u8868\u3002 \u5dee\u5f02 Ring List \u8868\u793a\u65b9\u5f0f\u3001\u7ed3\u6784\u590d\u6742\u5ea6 Ring\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\u4ec5\u7531\u5b83\u81ea\u8eab\u5373\u53ef\u4ee3\u8868 List\u7c7b\u578b\u9700\u8981\u5b83\u53caElement\u7c7b\u578b\u8054\u5408\u8868\u793a \u8868\u8ff0\u7ef4\u5ea6 Ring\u7c7b\u578b\u7684\u503c\uff0c\u4e25\u683c\u6765\u8bf4\u53ea\u4ee3\u8868\u8d77\u6240\u5c5e\u7684\u5faa\u73af\u94fe\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20 \u800cList\u7c7b\u578b\u7684\u503c\u5219\u4ee3\u8868\u4e00\u4e2a\u5b8c\u6574\u7684\u94fe\u8868 New\u51fd\u6570\u529f\u80fd \u521b\u5efa\u5e76\u521d\u59cb\u5316Ring\uff0c\u53ef\u4ee5\u6307\u5b9a\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff0c\u521b\u5efa\u540e\u957f\u5ea6\u4e0d\u53ef\u53d8 \u521b\u5efa\u5e76\u521d\u59cb\u5316List\u4e0d\u80fd\u6307\u5b9a\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf \u521d\u59cb\u5316 var r ring.Ring\u58f0\u660e\u7684r\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a1\u7684\u5faa\u73af\u94fe\u8868 var l list.List\u58f0\u660e\u7684l\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a0\u7684\u94fe\u8868 \u65f6\u95f4\u590d\u6742\u5ea6 Ring\u7684len\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6o(N) List\u7684len\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6o(1) List\u4e2d\u7684\u6839\u5143\u7d20\u4e0d\u4f1a\u6301\u6709\u5b9e\u9645\u5143\u7d20\u503c\uff0c\u8ba1\u7b97\u957f\u5ea6\u65f6\u4e0d\u4f1a\u5305\u542b\u5b83\u3002","title":"\u94fe\u8868"},{"location":"Language/Basic/06-\u94fe\u8868/#_1","text":"Go\u8bed\u8a00\u7684\u94fe\u8868\u5b9e\u73b0\u5728\u6807\u51c6\u5e93\u7684 container/list \u4ee3\u7801\u5305\u4e2d\u3002\u4ee3\u7801\u5305\u4e2d\u6709\u4e24\u4e2a\u516c\u5f00\u7684\u7a0b\u5e8f\u5b9e\u4f53\uff1a List\uff1a\u53cc\u5411\u94fe\u8868 Element\uff1a\u94fe\u8868\u4e2d\u5143\u7d20\u7684\u7ed3\u6784 List\u7684\u65b9\u6cd5\uff1a MoveBefore MoveAfter\uff1a\u628a \u7ed9\u5b9a\u5143\u7d20 \u79fb\u52a8\u5230\u53e6\u4e00\u4e2a\u5143\u7d20\u7684\u524d\u9762\u6216\u540e\u9762 MoveToFront MoveToBack\uff1a\u628a \u7ed9\u5b9a\u5143\u7d20 \u79fb\u52a8\u5230\u94fe\u8868\u7684\u6700\u524d\u7aef\u548c\u6700\u540e\u7aef \u8fd9\u4e9b\u7ed9\u5b9a\u5143\u7d20\u90fd\u662f *Element \u7c7b\u578b\uff0c *Element \u7684\u503c\u5c31\u662f\u5143\u7d20\u7684\u6307\u9488\u3002 func (l *List) MoveBefore(e, mark *Element) func (l *List) MoveAfter(e, mark *Element) func (l *List) MoveToFront(e *Element) func (l *List) MoveToBack(e *Element) \u5728List\u5305\u542b\u7684\u65b9\u6cd5\u4e2d\uff0c\u7528\u4e8e\u63d2\u5165\u65b0\u5143\u7d20\u7684\u90a3\u4e9b\u65b9\u6cd5\u90fd\u53ea\u63a5\u53d7Interface{}\u7c7b\u578b\u7684\u503c\u3002\u8fd9\u4e9b\u65b9\u6cd5\u5728\u5185\u90e8\u4f1a\u4f7f\u7528Element\u503c\uff0c\u5305\u88c5\u63a5\u6536\u5230\u7684\u65b0\u5143\u7d20\u3002 \u8fd9\u6837\u5b50\u4e3a\u4e86\u907f\u514d\u94fe\u8868\u7684\u5185\u90e8\u5173\u8054\u906d\u5230\u5916\u754c\u7834\u574f \u3002 func (l *List) Front() *Element //\u8fd4\u56de\u94fe\u8868\u6700\u524d\u7aef\u5143\u7d20\u7684\u6307\u9488 func (l *List) Back() *Element //\u8fd4\u56de\u94fe\u8868\u6700\u540e\u6bb5\u5143\u7d20\u7684\u6307\u9488 func (l *List) InsertBefore(v interface{}, mark *Element) *Element //\u5728\u94fe\u8868\u6307\u5b9a\u5143\u7d20\u524d\u63d2\u5165\u5143\u7d20\u5e76\u8fd4\u56de\u63d2\u5165\u5143\u7d20\u7684\u6307\u9488 func (l *List) InsertAfter(v interface{}, mark *Element) *Element //\u5728\u94fe\u8868\u6307\u5b9a\u5143\u7d20\u540e\u63d2\u5165\u5143\u7d20\u5e76\u8fd4\u56de\u63d2\u5165\u5143\u7d20\u7684\u6307\u9488 func (l *List) PushFront(v interface{}) *Element //\u5c06\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u5230\u94fe\u8868\u5934 func (l *List) PushBack(v interface{}) *Element //\u5c06\u6307\u5b9a\u5143\u7d20\u63d2\u5165\u5230\u94fe\u8868\u5c3e","title":"\u94fe\u8868"},{"location":"Language/Basic/06-\u94fe\u8868/#_2","text":"List\u548cElement\u90fd\u662f\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c \u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u7279\u70b9\u662f\u5b83\u4eec\u7684\u96f6\u503c\u90fd\u62e5\u6709\u7279\u5b9a\u7ed3\u6784\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u5b9a\u5236\u5316\u5185\u5bb9\u7684\u503c\uff0c\u503c\u4e2d\u7684\u5b57\u6bb5\u90fd\u88ab\u8d4b\u4e88\u5404\u81ea\u7c7b\u578b\u7684\u96f6\u503c \u3002 \u53ea\u505a\u58f0\u660e\u5374\u6ca1\u6709\u521d\u59cb\u5316\u7684\u53d8\u91cf\u88ab\u8d4b\u4e88\u7684\u7f3a\u7701\u503c\u5c31\u662f\u96f6\u503c\uff0c\u6bcf\u4e2a\u7c7b\u578b\u7684\u96f6\u503c\u90fd\u4f1a\u4f9d\u636e\u8be5\u7c7b\u578b\u7684\u7279\u6027\u800c\u88ab\u8bbe\u5b9a\u3002 var l list.List \u58f0\u660e\u7684\u53d8\u91cfl\u7684\u503c\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a0\u7684\u94fe\u8868\uff0c\u94fe\u8868\u6301\u6709\u7684\u6839\u5143\u7d20\u4e5f\u662f\u4e00\u4e2a\u7a7a\u58f3\uff0c\u5176\u4e2d\u5305\u542b\u7f3a\u7701\u7684\u5185\u5bb9\u3002\u8fd9\u6837\u7684\u94fe\u8868\u53ef\u4ee5\u5f00\u7bb1\u5373\u7528\u7684\u539f\u56e0\u5728\u4e8e\u201c\u5ef6\u8fdf\u521d\u59cb\u5316\u201d\u673a\u5236\u3002","title":"\u94fe\u8868\u5f00\u7bb1\u5373\u7528"},{"location":"Language/Basic/06-\u94fe\u8868/#_3","text":"\u4f18\u70b9\uff1a \u628a\u521d\u59cb\u5316\u64cd\u4f5c\u5ef6\u540e\uff0c\u4ec5\u5728\u5b9e\u9645\u9700\u8981\u7684\u65f6\u5019\u624d\u8fdb\u884c\uff0c\u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u4f18\u70b9\u5728\u4e8e\u201c\u5ef6\u540e\u201d\uff0c \u5b83\u53ef\u4ee5\u5206\u6563\u521d\u59cb\u5316\u64cd\u4f5c\u5e26\u6765\u7684\u8ba1\u7b97\u91cf\u548c\u5b58\u50a8\u7a7a\u95f4\u6d88\u8017 \u3002 \u5982\u679c\u9700\u8981\u96c6\u4e2d\u58f0\u660e\u975e\u5e38\u591a\u7684\u5927\u5bb9\u91cf\u5207\u7247\uff0c\u90a3\u4e48CPU\u548c\u5185\u5b58\u7684\u4f7f\u7528\u91cf\u80af\u5b9a\u4f1a\u6fc0\u589e\uff0c\u5e76\u4e14\u53ea\u8981\u8bbe\u6cd5\u8ba9\u5176\u4e2d\u7684\u5207\u7247\u548c\u5e95\u5c42\u6570\u7ec4\u88ab\u56de\u6536\uff0c\u5185\u5b58\u4f7f\u7528\u91cf\u624d\u4f1a\u6709\u6240\u4e0b\u964d\u3002\u5982\u679c\u6570\u7ec4\u53ef\u4ee5\u88ab\u5ef6\u8fdf\u521d\u59cb\u5316\uff0c\u90a3\u4e48CPU\u548c\u5185\u5b58\u7684\u538b\u529b\u5c31\u88ab\u5206\u6563\u5230\u5b9e\u9645\u4f7f\u7528\u5b83\u4eec\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u6570\u7ec4\u88ab\u5b9e\u9645\u4f7f\u7528\u7684\u65f6\u95f4\u8d8a\u5206\u6563\uff0c\u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u4f18\u52bf\u5c31\u8d8a\u660e\u663e\u3002 \u7f3a\u70b9\uff1a \u5ef6\u8fdf\u521d\u59cb\u5316\u7684\u7f3a\u70b9\u4e5f\u5728\u4e8e\u201c\u5ef6\u540e\u201d\uff0c\u5982\u679c\u5728\u8c03\u7528\u94fe\u8868\u7684\u6bcf\u4e2a\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u5148\u53bb\u5224\u65ad\u94fe\u8868\u662f\u5426\u5df2\u7ecf\u88ab\u521d\u59cb\u5316\uff0c\u8fd9\u4e5f\u662f\u8ba1\u7b97\u91cf\u4e0a\u7684\u6d6a\u8d39\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u88ab\u975e\u5e38\u9891\u7e41\u5730\u8c03\u7528\u7684\u60c5\u51b5\u4e0b\uff0c\u8fd9\u79cd\u6d6a\u8d39\u7684\u5f71\u54cd\u5c31\u5f00\u59cb\u660e\u663e\uff0c\u7a0b\u5e8f\u7684\u6027\u80fd\u4f1a\u964d\u4f4e\u3002 \u89e3\u51b3\u65b9\u6848\uff1a \u5728\u94fe\u8868\u7684\u89c6\u7ebf\u4e2d\uff0c\u4e00\u4e9b\u65b9\u6cd5\u65e0\u9700\u5bf9\u662f\u5426\u521d\u59cb\u5316\u505a\u5224\u65ad\uff0c\u5982 Front() \u548c Back() \u65b9\u6cd5\uff0c\u4e00\u65e6\u53d1\u73b0\u94fe\u8868\u7684\u957f\u5ea6\u4e3a0\uff0c\u76f4\u63a5\u8fd4\u56denil \u5728\u63d2\u5165\u3001\u5220\u9664\u6216\u79fb\u52a8\u5143\u7d20\u7684\u65b9\u6cd5\u4e2d\uff0c\u53ea\u8981\u5224\u65ad\u4f20\u5165\u7684\u5143\u7d20\u4e2d\u6307\u5411\u6240\u5c5e\u94fe\u8868\u7684\u6307\u9488\uff0c\u662f\u5426\u4e0e\u5f53\u524d\u94fe\u8868\u7684\u6307\u9488\u76f8\u7b49\u5c31\u53ef\u4ee5 PushFront() \u3001 PushBack() \u3001 PushBackList() \u3001 PushFrontList() \u65b9\u6cd5\u603b\u662f\u4f1a\u5148\u5224\u65ad\u94fe\u8868\u7684\u72b6\u6001\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u8fdb\u884c\u5ef6\u8fdf\u521d\u59cb\u5316\u3002\u5728\u5411\u65b0\u94fe\u8868\u4e2d\u6dfb\u52a0\u65b0\u5143\u7d20\u65f6\uff0c\u80af\u5b9a\u4f1a\u8c03\u7528\u8fd9\u56db\u4e2a\u65b9\u6cd5\u4e4b\u4e00\u3002","title":"\u5ef6\u8fdf\u521d\u59cb\u5316"},{"location":"Language/Basic/06-\u94fe\u8868/#ringlist","text":"container/ring \u5305\u4e2d\u7684Ring\u7c7b\u578b\u5b9e\u73b0\u7684\u662f\u4e00\u4e2a\u5faa\u73af\u94fe\u8868\uff08\u73af\uff09\u3002 List\u5728\u5185\u90e8\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\u94fe\u8868\uff0c\u5b83\u7684\u6839\u5143\u7d20\u6c38\u8fdc\u4e0d\u4f1a\u6301\u6709\u4efb\u4f55\u5b9e\u9645\u7684\u5143\u7d20\u503c\uff0c\u800c\u8be5\u5143\u7d20\u7684\u5b58\u5728\u662f\u4e3a\u4e86\u8fde\u63a5\u8fd9\u4e2a\u5faa\u73af\u94fe\u8868\u7684\u6536\u5c3e\u4e24\u7aef\u3002List\u7684\u96f6\u503c\u662f\u5df2\u7ed9\u53ea\u5305\u542b\u6839\u5143\u7d20\uff0c\u4e0d\u5305\u542b\u4efb\u4f55\u5b9e\u9645\u5143\u7d20\u503c\u7684\u7a7a\u94fe\u8868\u3002 \u5dee\u5f02 Ring List \u8868\u793a\u65b9\u5f0f\u3001\u7ed3\u6784\u590d\u6742\u5ea6 Ring\u7c7b\u578b\u7684\u6570\u636e\u7ed3\u6784\u4ec5\u7531\u5b83\u81ea\u8eab\u5373\u53ef\u4ee3\u8868 List\u7c7b\u578b\u9700\u8981\u5b83\u53caElement\u7c7b\u578b\u8054\u5408\u8868\u793a \u8868\u8ff0\u7ef4\u5ea6 Ring\u7c7b\u578b\u7684\u503c\uff0c\u4e25\u683c\u6765\u8bf4\u53ea\u4ee3\u8868\u8d77\u6240\u5c5e\u7684\u5faa\u73af\u94fe\u8868\u4e2d\u7684\u4e00\u4e2a\u5143\u7d20 \u800cList\u7c7b\u578b\u7684\u503c\u5219\u4ee3\u8868\u4e00\u4e2a\u5b8c\u6574\u7684\u94fe\u8868 New\u51fd\u6570\u529f\u80fd \u521b\u5efa\u5e76\u521d\u59cb\u5316Ring\uff0c\u53ef\u4ee5\u6307\u5b9a\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf\uff0c\u521b\u5efa\u540e\u957f\u5ea6\u4e0d\u53ef\u53d8 \u521b\u5efa\u5e76\u521d\u59cb\u5316List\u4e0d\u80fd\u6307\u5b9a\u5305\u542b\u7684\u5143\u7d20\u6570\u91cf \u521d\u59cb\u5316 var r ring.Ring\u58f0\u660e\u7684r\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a1\u7684\u5faa\u73af\u94fe\u8868 var l list.List\u58f0\u660e\u7684l\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a0\u7684\u94fe\u8868 \u65f6\u95f4\u590d\u6742\u5ea6 Ring\u7684len\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6o(N) List\u7684len\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6o(1) List\u4e2d\u7684\u6839\u5143\u7d20\u4e0d\u4f1a\u6301\u6709\u5b9e\u9645\u5143\u7d20\u503c\uff0c\u8ba1\u7b97\u957f\u5ea6\u65f6\u4e0d\u4f1a\u5305\u542b\u5b83\u3002","title":"Ring\u4e0eList\u7684\u533a\u522b"},{"location":"Language/Basic/07-\u5b57\u5178/","text":"\u5b57\u5178 map\u4e2d\u5b58\u50a8\u7684\u4e0d\u662f\u5355\u4e00\u503c\u7684\u96c6\u5408\uff0c\u800c\u662f\u952e\u503c\u5bf9\u7684\u96c6\u5408\u3002 \u4e00\u4e2a\u952e\u548c\u4e00\u4e2a\u503c\uff0c\u5206\u522b\u4ee3\u8868\u4e86\u4e00\u4e2a\u4ece\u5c5e\u4e8e\u67d0\u4e00\u7c7b\u578b\u7684\u72ec\u7acb\u503c\uff0c\u628a\u5b83\u4eec\u4e24\u4e2a\u6346\u7ed1\u5728\u4e00\u8d77\u5c31\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\u3002 \u952e\u7c7b\u578b\u7ea6\u675f Go\u8bed\u8a00\u7684\u5b57\u5178\u7c7b\u578b\u5176\u5b9e\u662f\u4e00\u4e2a\u54c8\u5e0c\u8868\u7684\u7279\u5b9a\u5b9e\u73b0\uff0c\u5728\u8fd9\u4e2a\u5b9e\u73b0\u4e2d\uff0c\u952e\u7684\u7c7b\u578b\u662f\u53d7\u9650\u7684\uff0c\u503c\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\u3002 \u628a\u952e\u7406\u89e3\u4e3a\u5143\u7d20\u7684\u4e00\u4e2a\u7d22\u5f15\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\u901a\u8fc7\u952e\u67e5\u627e\u4e0e\u5b83\u6210\u5bf9\u7684\u90a3\u4e2a\u5143\u7d20\u3002\u952e\u4e0e\u503c\u7684\u5bf9\u5e94\u5173\u7cfb\u79f0\u4e3a\u6620\u5c04\uff0c\u54c8\u5e0c\u8868\u7684\u6620\u5c04\u8fc7\u7a0b\u5c31\u5b58\u5728\u4e8e\u5bf9\u952e\u503c\u5bf9\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u4e2d\u3002 \u6620\u5c04\u8fc7\u7a0b\u7684\u7b2c\u4e00\u6b65\u5c31\u662f\u952e\u503c\u8f6c\u6362\u4e3a\u54c8\u5e0c\u503c\uff1aGo\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u6709\u5b83\u7684\u54c8\u5e0c\u503c\u4ee3\u8868\uff0c\u5b57\u5178\u4e0d\u4f1a\u72ec\u7acb\u5b58\u50a8\u4efb\u4f55\u952e\u503c\uff0c\u4f46\u4f1a\u72ec\u7acb\u5b58\u50a8\u5b83\u4eec\u7684\u54c8\u5e0c\u503c\u3002 Go\u8bed\u8a00\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e0d\u652f\u6301\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b \u3002 Go\u8bed\u8a00\u89c4\u8303\u89c4\u5b9a\uff0c\u5728\u952e\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\uff0c\u5fc5\u987b\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7b26 == \u548c \uff01= \uff0c\u4e5f\u5c31\u662f\u5fc5\u987b\u652f\u6301\u5224\u7b49\u64cd\u4f5c\uff0c\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\u7684\u503c\u4e0d\u652f\u6301\u5224\u7b49\u64cd\u4f5c\uff0c\u6240\u4ee5\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e0d\u80fd\u662f\u8fd9\u4e9b\u7c7b\u578b\u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u63a5\u53e3\u7c7b\u578b\uff0c\u90a3\u4e48\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u4e5f\u4e0d\u80fd\u662f\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\uff0c\u5426\u5219\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4f1a\u5f15\u53d1panic \u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u6570\u7ec4\u7c7b\u578b\uff0c\u90a3\u4e48\u786e\u4fdd\u8be5\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b\u4e0d\u662f\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b \u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u90a3\u4e48\u4fdd\u8bc1\u5176\u4e2d\u5b57\u6bb5\u7c7b\u578b\u7684\u5408\u6cd5\u6027 \u3002 \u56e0\u4e3a\u201d\u54c8\u5e0c\u78b0\u649e\u201c\u7684\u5b58\u5728\uff0cGo\u8bed\u8a00\u9996\u5148\u7528\u952e\u7684\u54c8\u5e0c\u503c\u53bb\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5982\u679c\u952e\u7684\u54c8\u5e0c\u503c\u76f8\u540c\uff0c\u5728\u7528\u952e\u672c\u8eab\u53bb\u6bd4\u5bf9\uff0c\u5982\u679c\u952e\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u65e0\u6cd5\u5224\u7b49\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u5c31\u65e0\u6cd5\u7ee7\u7eed\u8fdb\u884c\u3002 \u952e\u7c7b\u578b\u7684\u4f18\u5148\u9009\u62e9 \u5728\u6620\u5c04\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4e24\u4e2a\u91cd\u8981\u4e14\u8017\u65f6\u7684\u64cd\u4f5c\uff1a \u628a\u952e\u503c\u8f6c\u6362\u4e3a\u54c8\u5e0c\u503c \u628a\u8981\u67e5\u627e\u7684\u952e\u503c\u4e0e\u54c8\u5e0c\u6876\u4e2d\u7684\u952e\u503c\u505a\u5bf9\u6bd4 \u4f46\u4ece\u6027\u80fd\u7684\u89d2\u5ea6\uff0c\u6c42\u54c8\u5e0c\u548c\u5224\u7b49\u64cd\u4f5c\u7684\u901f\u5ea6\u8d8a\u5feb\uff0c\u5bf9\u5e94\u7684\u7c7b\u578b\u5c31\u8d8a\u9002\u5408\u4f5c\u4e3a\u952e\u7c7b\u578b\u3002 Go\u8bed\u8a00\u4e2d\u6240\u6709\u7684\u57fa\u672c\u7c7b\u578b\u3001\u6307\u9488\u7c7b\u578b\u3001\u6570\u7ec4\u7c7b\u578b\u3001\u7ed3\u6784\u4f53\u7c7b\u578b\u548c\u63a5\u53e3\u7c7b\u578b\u90fd\u8981\u4e00\u5957\u5404\u81ea\u7684\u7b97\u6cd5\uff0c\u5176\u4e2d\u5305\u542b\u54c8\u5e0c\u548c\u5224\u7b49\u3002 \u54c8\u5e0c\u7b97\u6cd5 \u57fa\u672c\u7c7b\u578b\uff1a \u7c7b\u578b\u7684\u5bbd\u5ea6\u8d8a\u5c0f\u7684\u7c7b\u578b\u6c42\u54c8\u5e0c\u7684\u901f\u5ea6\u8d8a\u5feb\u3002 \u7c7b\u578b\u7684\u5bbd\u5ea6\u662f\u6307\u5b83\u7684\u5355\u4e2a\u503c\u9700\u8981\u5360\u7528\u7684\u5b57\u8282\u6570\u3002 \u5728\u57fa\u672c\u7c7b\u578b\u4e2d\uff0c\u6709\u9650\u9009\u62e9\u6570\u503c\u7c7b\u578b\u548c\u6307\u9488\u7c7b\u578b\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u7c7b\u578b\u7684\u5bbd\u5ea6\u8d8a\u5c0f\u8d8a\u597d\u3002 \u9ad8\u7ea7\u7c7b\u578b\uff1a \u5bf9\u6570\u7ec4\u7c7b\u578b\u503c\u7684\u6c42\u54c8\u5e0c\u5b9e\u9645\u4e0a\u662f\u4f9d\u6b21\u6c42\u5f97\u5b83\u7684\u6bcf\u4e2a\u5143\u7d20\u7684\u54c8\u5e0c\u503c\u5e76\u8fdb\u884c\u5408\u5e76\uff0c\u6240\u4ee5\u901f\u5ea6\u53d6\u51b3\u4e8e\u5b83\u7684\u5143\u7d20\u7c7b\u578b\u4ee5\u53ca\u5b83\u7684\u957f\u5ea6\u3002 \u5bf9\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u503c\u6c42\u54c8\u5e0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5b83\u7684\u6240\u6709\u5b57\u6bb5\u6c42\u54c8\u5e0c\u5e76\u8fdb\u884c\u5408\u5e76\uff0c\u5173\u952e\u5728\u4e8e\u5404\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4ee5\u53ca\u5b57\u6bb5\u7684\u6570\u91cf\u3002 \u5bf9\u4e8e\u63a5\u53e3\u7c7b\u578b\uff0c\u5177\u4f53\u7684\u54c8\u5e0c\u7b97\u6cd5\u7531\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u51b3\u5b9a\u3002 \u4e0d\u5efa\u8bae\u4f7f\u7528\u9ad8\u7ea7\u7c7b\u578b\u4f5c\u4e3a\u5b57\u5178\u7684\u952e\uff0c\u4e0d\u4ec5\u56e0\u4e3a\u6c42\u54c8\u5e0c\u548c\u5224\u7b49\u901f\u5ea6\u6162\uff0c\u800c\u4e14\u5b83\u4eec\u4e2d\u7684\u503c\u5b58\u5728\u53d8\u6570\u3002 \u9664\u4e86\u6dfb\u52a0\u952e\u503c\u5bf9\uff0c\u5728\u4e00\u4e2a\u503c\u4e3anil\u7684\u5b57\u5178\u4e0a\u505a\u4efb\u4f55\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u5f15\u8d77\u9519\u8bef \u3002","title":"\u5b57\u5178"},{"location":"Language/Basic/07-\u5b57\u5178/#_1","text":"map\u4e2d\u5b58\u50a8\u7684\u4e0d\u662f\u5355\u4e00\u503c\u7684\u96c6\u5408\uff0c\u800c\u662f\u952e\u503c\u5bf9\u7684\u96c6\u5408\u3002 \u4e00\u4e2a\u952e\u548c\u4e00\u4e2a\u503c\uff0c\u5206\u522b\u4ee3\u8868\u4e86\u4e00\u4e2a\u4ece\u5c5e\u4e8e\u67d0\u4e00\u7c7b\u578b\u7684\u72ec\u7acb\u503c\uff0c\u628a\u5b83\u4eec\u4e24\u4e2a\u6346\u7ed1\u5728\u4e00\u8d77\u5c31\u662f\u4e00\u4e2a\u952e\u503c\u5bf9\u3002","title":"\u5b57\u5178"},{"location":"Language/Basic/07-\u5b57\u5178/#_2","text":"Go\u8bed\u8a00\u7684\u5b57\u5178\u7c7b\u578b\u5176\u5b9e\u662f\u4e00\u4e2a\u54c8\u5e0c\u8868\u7684\u7279\u5b9a\u5b9e\u73b0\uff0c\u5728\u8fd9\u4e2a\u5b9e\u73b0\u4e2d\uff0c\u952e\u7684\u7c7b\u578b\u662f\u53d7\u9650\u7684\uff0c\u503c\u53ef\u4ee5\u662f\u4efb\u610f\u7c7b\u578b\u3002 \u628a\u952e\u7406\u89e3\u4e3a\u5143\u7d20\u7684\u4e00\u4e2a\u7d22\u5f15\uff0c\u5728\u54c8\u5e0c\u8868\u4e2d\u901a\u8fc7\u952e\u67e5\u627e\u4e0e\u5b83\u6210\u5bf9\u7684\u90a3\u4e2a\u5143\u7d20\u3002\u952e\u4e0e\u503c\u7684\u5bf9\u5e94\u5173\u7cfb\u79f0\u4e3a\u6620\u5c04\uff0c\u54c8\u5e0c\u8868\u7684\u6620\u5c04\u8fc7\u7a0b\u5c31\u5b58\u5728\u4e8e\u5bf9\u952e\u503c\u5bf9\u7684\u589e\u5220\u6539\u67e5\u64cd\u4f5c\u4e2d\u3002 \u6620\u5c04\u8fc7\u7a0b\u7684\u7b2c\u4e00\u6b65\u5c31\u662f\u952e\u503c\u8f6c\u6362\u4e3a\u54c8\u5e0c\u503c\uff1aGo\u4e2d\u7684\u6bcf\u4e2a\u952e\u90fd\u662f\u6709\u5b83\u7684\u54c8\u5e0c\u503c\u4ee3\u8868\uff0c\u5b57\u5178\u4e0d\u4f1a\u72ec\u7acb\u5b58\u50a8\u4efb\u4f55\u952e\u503c\uff0c\u4f46\u4f1a\u72ec\u7acb\u5b58\u50a8\u5b83\u4eec\u7684\u54c8\u5e0c\u503c\u3002 Go\u8bed\u8a00\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e0d\u652f\u6301\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b \u3002 Go\u8bed\u8a00\u89c4\u8303\u89c4\u5b9a\uff0c\u5728\u952e\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\uff0c\u5fc5\u987b\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7b26 == \u548c \uff01= \uff0c\u4e5f\u5c31\u662f\u5fc5\u987b\u652f\u6301\u5224\u7b49\u64cd\u4f5c\uff0c\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\u7684\u503c\u4e0d\u652f\u6301\u5224\u7b49\u64cd\u4f5c\uff0c\u6240\u4ee5\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e0d\u80fd\u662f\u8fd9\u4e9b\u7c7b\u578b\u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u63a5\u53e3\u7c7b\u578b\uff0c\u90a3\u4e48\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u4e5f\u4e0d\u80fd\u662f\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b\uff0c\u5426\u5219\u7a0b\u5e8f\u8fd0\u884c\u4e2d\u4f1a\u5f15\u53d1panic \u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u6570\u7ec4\u7c7b\u578b\uff0c\u90a3\u4e48\u786e\u4fdd\u8be5\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b\u4e0d\u662f\u4e0a\u8ff0\u4e09\u79cd\u7c7b\u578b \u3002 \u5982\u679c\u952e\u7684\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u90a3\u4e48\u4fdd\u8bc1\u5176\u4e2d\u5b57\u6bb5\u7c7b\u578b\u7684\u5408\u6cd5\u6027 \u3002 \u56e0\u4e3a\u201d\u54c8\u5e0c\u78b0\u649e\u201c\u7684\u5b58\u5728\uff0cGo\u8bed\u8a00\u9996\u5148\u7528\u952e\u7684\u54c8\u5e0c\u503c\u53bb\u8fdb\u884c\u6bd4\u5bf9\uff0c\u5982\u679c\u952e\u7684\u54c8\u5e0c\u503c\u76f8\u540c\uff0c\u5728\u7528\u952e\u672c\u8eab\u53bb\u6bd4\u5bf9\uff0c\u5982\u679c\u952e\u7c7b\u578b\u7684\u503c\u4e4b\u95f4\u65e0\u6cd5\u5224\u7b49\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6620\u5c04\u8fc7\u7a0b\u5c31\u65e0\u6cd5\u7ee7\u7eed\u8fdb\u884c\u3002","title":"\u952e\u7c7b\u578b\u7ea6\u675f"},{"location":"Language/Basic/07-\u5b57\u5178/#_3","text":"\u5728\u6620\u5c04\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4e24\u4e2a\u91cd\u8981\u4e14\u8017\u65f6\u7684\u64cd\u4f5c\uff1a \u628a\u952e\u503c\u8f6c\u6362\u4e3a\u54c8\u5e0c\u503c \u628a\u8981\u67e5\u627e\u7684\u952e\u503c\u4e0e\u54c8\u5e0c\u6876\u4e2d\u7684\u952e\u503c\u505a\u5bf9\u6bd4 \u4f46\u4ece\u6027\u80fd\u7684\u89d2\u5ea6\uff0c\u6c42\u54c8\u5e0c\u548c\u5224\u7b49\u64cd\u4f5c\u7684\u901f\u5ea6\u8d8a\u5feb\uff0c\u5bf9\u5e94\u7684\u7c7b\u578b\u5c31\u8d8a\u9002\u5408\u4f5c\u4e3a\u952e\u7c7b\u578b\u3002 Go\u8bed\u8a00\u4e2d\u6240\u6709\u7684\u57fa\u672c\u7c7b\u578b\u3001\u6307\u9488\u7c7b\u578b\u3001\u6570\u7ec4\u7c7b\u578b\u3001\u7ed3\u6784\u4f53\u7c7b\u578b\u548c\u63a5\u53e3\u7c7b\u578b\u90fd\u8981\u4e00\u5957\u5404\u81ea\u7684\u7b97\u6cd5\uff0c\u5176\u4e2d\u5305\u542b\u54c8\u5e0c\u548c\u5224\u7b49\u3002","title":"\u952e\u7c7b\u578b\u7684\u4f18\u5148\u9009\u62e9"},{"location":"Language/Basic/07-\u5b57\u5178/#_4","text":"\u57fa\u672c\u7c7b\u578b\uff1a \u7c7b\u578b\u7684\u5bbd\u5ea6\u8d8a\u5c0f\u7684\u7c7b\u578b\u6c42\u54c8\u5e0c\u7684\u901f\u5ea6\u8d8a\u5feb\u3002 \u7c7b\u578b\u7684\u5bbd\u5ea6\u662f\u6307\u5b83\u7684\u5355\u4e2a\u503c\u9700\u8981\u5360\u7528\u7684\u5b57\u8282\u6570\u3002 \u5728\u57fa\u672c\u7c7b\u578b\u4e2d\uff0c\u6709\u9650\u9009\u62e9\u6570\u503c\u7c7b\u578b\u548c\u6307\u9488\u7c7b\u578b\uff0c\u901a\u5e38\u60c5\u51b5\u4e0b\u7c7b\u578b\u7684\u5bbd\u5ea6\u8d8a\u5c0f\u8d8a\u597d\u3002 \u9ad8\u7ea7\u7c7b\u578b\uff1a \u5bf9\u6570\u7ec4\u7c7b\u578b\u503c\u7684\u6c42\u54c8\u5e0c\u5b9e\u9645\u4e0a\u662f\u4f9d\u6b21\u6c42\u5f97\u5b83\u7684\u6bcf\u4e2a\u5143\u7d20\u7684\u54c8\u5e0c\u503c\u5e76\u8fdb\u884c\u5408\u5e76\uff0c\u6240\u4ee5\u901f\u5ea6\u53d6\u51b3\u4e8e\u5b83\u7684\u5143\u7d20\u7c7b\u578b\u4ee5\u53ca\u5b83\u7684\u957f\u5ea6\u3002 \u5bf9\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u503c\u6c42\u54c8\u5e0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5b83\u7684\u6240\u6709\u5b57\u6bb5\u6c42\u54c8\u5e0c\u5e76\u8fdb\u884c\u5408\u5e76\uff0c\u5173\u952e\u5728\u4e8e\u5404\u4e2a\u5b57\u6bb5\u7684\u7c7b\u578b\u4ee5\u53ca\u5b57\u6bb5\u7684\u6570\u91cf\u3002 \u5bf9\u4e8e\u63a5\u53e3\u7c7b\u578b\uff0c\u5177\u4f53\u7684\u54c8\u5e0c\u7b97\u6cd5\u7531\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u51b3\u5b9a\u3002 \u4e0d\u5efa\u8bae\u4f7f\u7528\u9ad8\u7ea7\u7c7b\u578b\u4f5c\u4e3a\u5b57\u5178\u7684\u952e\uff0c\u4e0d\u4ec5\u56e0\u4e3a\u6c42\u54c8\u5e0c\u548c\u5224\u7b49\u901f\u5ea6\u6162\uff0c\u800c\u4e14\u5b83\u4eec\u4e2d\u7684\u503c\u5b58\u5728\u53d8\u6570\u3002 \u9664\u4e86\u6dfb\u52a0\u952e\u503c\u5bf9\uff0c\u5728\u4e00\u4e2a\u503c\u4e3anil\u7684\u5b57\u5178\u4e0a\u505a\u4efb\u4f55\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u5f15\u8d77\u9519\u8bef \u3002","title":"\u54c8\u5e0c\u7b97\u6cd5"},{"location":"Language/Basic/08-\u901a\u9053/","text":"\u901a\u9053 Don't communicate by sharing memory;share memory bu communicating. \u4e0d\u8981\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u6765\u901a\u4fe1\uff0c\u800c\u5e94\u8be5\u901a\u8fc7\u901a\u4fe1\u6765\u5171\u4eab\u5185\u5b58\u3002 \u901a\u9053\u4e0egoroutine\u5171\u540c\u4ee3\u8868Go\u8bed\u8a00\u72ec\u6709\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u5f0f\u548c\u7f16\u7a0b\u54f2\u5b66\uff0c\u5229\u7528\u901a\u9053\u5728\u591a\u4e2agoroutine\u4e4b\u95f4\u4f20\u9012\u6570\u636e\u3002 \u901a\u9053\u7c7b\u578b\u7684\u503c\uff0c\u672c\u8eab\u5c31\u662f\u5e76\u53d1\u5b89\u5168\u7684 \u3002\u8fd9\u662fGo\u8bed\u8a00\u81ea\u5e26\u7684\u552f\u4e00\u4e00\u4e2a\u53ef\u4ee5\u6ee1\u8db3\u5e76\u53d1\u5b89\u5168\u6027\u7684\u7c7b\u578b\u3002 \u5728\u58f0\u660e\u5e76\u521d\u59cb\u5316\u4e00\u4e2a\u901a\u9053\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528Go\u5185\u5efa\u51fd\u6570 make() ,\u4f20\u7ed9\u8fd9\u4e2a\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5e94\u8be5\u662f\u4ee3\u8868\u4e86\u901a\u9053\u7684\u5177\u4f53\u7c7b\u578b\u7684\u7c7b\u578b\u5b57\u9762\u91cf\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2aint\u7c7b\u578b\u7684\u503c\uff0c\u4e0d\u80fd\u5c0f\u4e8e0\uff0c\u8868\u793a\u901a\u9053\u7684\u5bb9\u91cf\uff08\u8be5\u53c2\u6570\u53ef\u9009\uff09\u3002 \u5f53\u5bb9\u91cf\u4e3a0\u65f6\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u975e\u7f13\u51b2\u901a\u9053 \u5f53\u5bb9\u91cf\u5927\u4e8e0\u65f6\uff0c\u8868\u793a\u7f13\u51b2\u901a\u9053 \u975e\u7f13\u51b2\u901a\u9053\u548c\u7f13\u51b2\u901a\u9053\u6709\u4e0d\u540c\u7684\u6570\u636e\u4f20\u9012\u65b9\u5f0f\u3002 \u58f0\u660e\u4e00\u4e2a\u901a\u9053\u7c7b\u578b\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u9996\u5148\u8981\u786e\u5b9a\u8be5\u901a\u9053\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b\uff0c\u8fd9\u51b3\u5b9a\u4e86\u901a\u8fc7\u8fd9\u4e2a\u901a\u9053\u4f20\u9012\u58f0\u660e\u7c7b\u578b\u7684\u6570\u636e\u3002 chan int // chan \u8868\u793a\u901a\u9053\u7c7b\u578b\u7684\u5173\u952e\u5b57 // int \u8bf4\u660e\u8be5\u901a\u9053\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b ch1 := make(chan int,3) \u4e00\u4e2a\u901a\u9053\u76f8\u5f53\u4e00\u4e2aFIFO\u961f\u5217\uff0c\u901a\u9053\u4e2d\u5404\u4e2a\u5143\u7d20\u4e25\u683c\u6309\u7167\u53d1\u9001\u987a\u5e8f\u6392\u5217\uff0c\u5143\u7d20\u503c\u7684\u53d1\u9001\u548c\u63a5\u6536\u90fd\u7528\u5230\u64cd\u4f5c\u7b26 - ,\u79f0\u4e3a\u63a5\u9001\u64cd\u4f5c\u7b26\uff0c\u8be5\u7b26\u53f7\u5f62\u8c61\u7684\u8868\u793a\u4e86\u5143\u7d20\u503c\u7684\u4f20\u8f93\u65b9\u5411 \u3002 \u5bf9\u53d1\u9001\u4e0e\u63a5\u6536\u64cd\u4f5c\u7684\u57fa\u672c\u7279\u6027\uff1a \u5bf9\u540c\u4e00\u4e2a\u901a\u9053\uff0c\u53d1\u9001\u64cd\u4f5c\u4e4b\u95f4\u662f \u4e92\u65a5 \u7684\uff0c\u63a5\u6536\u64cd\u4f5c\u4e4b\u95f4\u4e5f\u662f \u4e92\u65a5 \u7684\uff1a \u5728\u540c\u4e00\u65f6\u523b\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u53ea\u4f1a\u6267\u884c\u5bf9\u540c\u4e00\u4e2a\u901a\u9053\u7684\u4efb\u610f\u4e2a\u53d1\u9001\u64cd\u4f5c\u4e2d\u7684\u67d0\u4e00\u4e2a\u3002 \u76f4\u5230\u8fd9\u4e2a\u5143\u7d20\u503c\u88ab\u5b8c\u5168\u590d\u5236\u8fdb\u8be5\u901a\u9053\u4e4b\u540e\uff0c\u5176\u4ed6\u9488\u5bf9\u8be5\u901a\u9053\u7684\u53d1\u9001\u64cd\u4f5c\u624d\u53ef\u80fd\u88ab\u6267\u884c \u3002\u63a5\u6536\u64cd\u4f5c\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5373\u4f7f\u64cd\u4f5c\u662f\u5e76\u53d1\u6267\u884c\u7684\u4e5f\u662f\u5982\u6b64\u3002 \u5bf9\u4e8e\u901a\u9053\u5185\u7684\u540c\u4e00\u4e2a\u5143\u7d20\u503c\uff0c\u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u4e4b\u95f4\u4e5f\u662f\u4e92\u65a5\u7684\u3002\u5373\u4f7f\u4e00\u4e2a\u6b63\u5728\u88ab\u590d\u5236\u8fdb\u901a\u9053\u4f46\u8fd8\u672a\u590d\u5236\u5b8c\u6210\u7684\u5143\u7d20\u503c\uff0c\u4e5f\u7edd\u4e0d\u4f1a\u88ab\u60f3\u63a5\u6536\u5b83\u7684\u4e00\u65b9\u770b\u5230\u548c\u53d6\u8d70\u3002 \u5143\u7d20\u503c\u4ece\u5916\u754c\u8fdb\u5165\u901a\u9053\u65f6\u662f\u88ab\u590d\u5236\uff0c\u5373\u8fdb\u5165\u901a\u9053\u7684\u5e76\u4e0d\u662f\u63a5\u6536\u64cd\u4f5c\u7b26\u53f3\u8fb9\u7684\u90a3\u4e2a\u5143\u7d20\u503c\uff0c\u800c\u662f\u5b83\u7684\u526f\u672c \u3002 \u5143\u7d20\u4ece\u901a\u9053\u8fdb\u5165\u5916\u754c\u65f6\u4f1a\u88ab\u79fb\u52a8\uff1a \u751f\u6210\u6b63\u5728\u901a\u9053\u4e2d\u7684\u8fd9\u4e2a\u5143\u7d20\u503c\u7684\u526f\u672c\uff0c\u5e76\u51c6\u5907\u7ed9\u5230\u63a5\u6536\u65b9 \u5220\u9664\u5728\u901a\u9053\u4e2d\u7684\u8fd9\u4e2a\u5143\u7d20\u503c \u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u4e2d\u5bf9\u5143\u7d20\u503c\u7684\u5904\u7406\u90fd\u662f \u4e0d\u53ef\u5206\u5272 \u7684\uff1a \u4e0d\u53ef\u5206\u5272 \u8868\u793a\u5904\u7406\u901a\u9053\u4e2d\u5143\u7d20\u7684\u64cd\u4f5c\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff1a \u53d1\u9001\u64cd\u4f5c\u8981\u4e48\u6ca1\u590d\u5236\u503c\uff0c\u8981\u4e48\u5df2\u7ecf\u590d\u5236\u5b8c\u6bd5 \u63a5\u6536\u64cd\u4f5c\u5728\u51c6\u5907\u597d\u5143\u7d20\u503c\u526f\u672c\u4e4b\u540e\uff0c\u4e00\u5b9a\u4f1a\u5220\u9664\u6389\u901a\u9053\u4e2d\u7684\u539f\u503c\uff0c\u7edd\u4e0d\u4f1a\u51fa\u73b0\u6709\u6b8b\u7559\u7684\u60c5\u51b5 \u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u5728\u5b8c\u5168\u5b8c\u6210\u4e4b\u524d\u4f1a\u88ab\u963b\u585e \u53d1\u9001\u64cd\u4f5c\uff1a \u590d\u5236\u5143\u7d20\u503c \u653e\u7f6e\u526f\u672c\u5230\u901a\u9053\u5185\u90e8 \u63a5\u6536\u64cd\u4f5c\uff1a \u590d\u5236\u901a\u9053\u5185\u7684\u5143\u7d20\u503c \u653e\u7f6e\u526f\u672c\u5230\u63a5\u6536\u65b9 \u5220\u9664\u539f\u503c \u5728\u6240\u6709\u6b65\u9aa4\u5b8c\u5168\u5b8c\u6210\u524d\uff0c\u53d1\u8d77\u8be5\u64cd\u4f5c\u7684\u4ee3\u7801\u4f1a\u4e00\u76f4\u963b\u585e\uff0c\u76f4\u5230\u8be5\u4ee3\u7801\u6240\u5728goroutine\u6536\u5230\u4e86\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u901a\u77e5\u5e76\u91cd\u65b0\u83b7\u5f97\u8fd0\u884c\u673a\u4f1a\u4e3a\u6b62\u3002 \u5982\u6b64\u963b\u585e\u4ee3\u7801\u5c31\u662f\u4e3a\u4e86\u5b9e\u73b0\u64cd\u4f5c\u7684\u4e92\u65a5\u548c\u5143\u7d20\u503c\u7684\u5b8c\u6574 \u3002 \u957f\u65f6\u95f4\u963b\u585e\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c \u7f13\u51b2\u901a\u9053 \u5982\u679c\u901a\u9053\u5df2\u6ee1\uff0c\u5bf9\u5b83\u7684\u6240\u6709\u53d1\u9001\u64cd\u4f5c\u90fd\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u901a\u9053\u4e2d\u6709\u5143\u7d20\u503c\u88ab\u63a5\u6536\u8d70\uff0c\u6b64\u65f6\u901a\u9053\u4f1a\u4f18\u5148\u901a\u77e5\u6700\u65e9\u56e0\u6b64\u800c\u7b49\u5f85\u7684\u90a3\u4e2a\u53d1\u9001\u64cd\u4f5c\u6240\u5728\u7684goroutine\uff0c\u7136\u540e\u518d\u6b21\u6267\u884c\u53d1\u9001\u64cd\u4f5c\u3002 \u7531\u4e8e\u53d1\u9001\u64cd\u4f5c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u88ab\u963b\u585e\u540e\uff0c\u5b83\u4eec\u6240\u5728\u7684goroutine\u4f1a\u987a\u5e8f\u5730\u8fdb\u5165\u901a\u9053\u5185\u90e8\u7684\u53d1\u9001\u7b49\u5f85\u961f\u5217\uff0c\u6240\u4ee5\u901a\u77e5\u7684\u987a\u5e8f\u662f\u516c\u5e73\u7684\u3002 \u5982\u679c\u901a\u9053\u5df2\u7a7a\uff0c\u5bf9\u5b83\u7684\u6240\u6709\u63a5\u6536\u64cd\u4f5c\u90fd\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u901a\u9053\u4e2d\u6709\u65b0\u7684\u5143\u7d20\u51fa\u73b0\uff0c\u6b64\u65f6\u901a\u9053\u4f1a\u4f18\u5148\u901a\u77e5\u6700\u65e9\u7b49\u5f85\u7684\u90a3\u4e2a\u63a5\u6536\u64cd\u4f5c\u6240\u5728\u7684goroutine\uff0c\u5e76\u4f7f\u5b83\u518d\u6b21\u6267\u884c\u63a5\u6536\u64cd\u4f5c\u3002 \u56e0\u6b64\u800c\u7b49\u5f85\u7684\u6240\u6709\u63a5\u6536\u64cd\u4f5c\u6240\u5728\u7684goroutine\u90fd\u4f1a\u6309\u7167\u5148\u540e\u987a\u5e8f\u88ab\u653e\u5165\u901a\u9053\u5185\u90e8\u7684\u63a5\u6536\u7b49\u5f85\u961f\u5217\u3002 \u7f13\u51b2\u901a\u9053\u4f5c\u4e3a\u6536\u53d1\u53cc\u65b9\u7684\u4e2d\u95f4\u4ef6\uff0c\u5143\u7d20\u503c\u5148\u4ece\u53d1\u9001\u65b9\u590d\u5236\u5230\u7f13\u51b2\u901a\u9053\uff0c\u4e4b\u540e\u518d\u7531\u7f13\u51b2\u901a\u9053\u590d\u5236\u7ed9\u63a5\u6536\u65b9\u3002 \u5f53\u53d1\u9001\u64cd\u4f5c\u5728\u6267\u884c\u7684\u65f6\u5019\u53d1\u73b0\u7a7a\u7684\u901a\u9053\u4e2d\uff0c\u6b63\u597d\u6709\u7b49\u5f85\u7684\u63a5\u6536\u64cd\u4f5c\uff0c\u90a3\u4e48\u5b83\u4f1a\u76f4\u63a5\u628a\u5143\u7d20\u503c\u590d\u5236\u7ed9\u63a5\u6536\u65b9 \u3002 \u975e\u7f13\u51b2\u901a\u9053 \u65e0\u8bba\u662f\u53d1\u9001\u64cd\u4f5c\u8fd8\u662f\u63a5\u6536\u64cd\u4f5c\uff0c\u4e00\u5f00\u59cb\u6267\u884c\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u914d\u5bf9\u7684\u64cd\u4f5c\u4e5f\u5f00\u59cb\u6267\u884c\uff0c\u624d\u4f1a\u7ee7\u7eed\u4f20\u9012\u3002 \u975e\u7f13\u51b2\u901a\u9053\u662f\u5728\u7528\u540c\u6b65\u7684\u65b9\u5f0f\u4f20\u9012\u6570\u636e\uff0c\u53ea\u6709\u6536\u53d1\u53cc\u65b9\u5bf9\u63a5\u4e0a\u4e86\uff0c\u6570\u636e\u624d\u4f1a\u88ab\u4f20\u9012\u3002 \u6570\u636e\u76f4\u63a5\u4ece\u53d1\u9001\u65b9\u590d\u5236\u5230\u63a5\u6536\u65b9\uff0c\u4e2d\u95f4\u5e76\u6ca1\u6709\u975e\u7f13\u51b2\u901a\u9053\u505a\u4e2d\u8f6c\uff0c\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u7f13\u51b2\u901a\u9053\u5219\u5728\u7528\u5f02\u6b65\u7684\u65b9\u5f0f\u4f20\u9012\u6570\u636e\u3002 \u9519\u8bef\u4f7f\u7528\u901a\u9053 \u5bf9\u503c\u4e3anil\u7684\u901a\u9053\uff0c\u4e0d\u8bba\u5b83\u7684\u5177\u4f53\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u5bf9\u5b83\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c\u90fd\u4f1a\u6c38\u4e45\u5730\u5904\u4e8e\u963b\u585e\u72b6\u6001\u3002\u5b83\u4eec\u6240\u5c5e\u7684goroutine\u4e2d\u7684\u4efb\u4f55\u4ee3\u7801\u90fd\u4e0d\u518d\u4f1a\u88ab\u6267\u884c\u3002 \u901a\u9053\u7c7b\u578b\u662f\u5f15\u7528\uff0c\u6240\u4ee5\u5b83\u7684\u96f6\u503c\u5c31\u662fnil\uff0c\u53ea\u58f0\u660e\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\u4f46\u6ca1\u6709\u7528 make() \u51fd\u6570\u5bf9\u5b83\u521d\u59cb\u5316\u65f6\uff0c\u8be5\u53d8\u91cf\u7684\u503c\u5c31\u662fnil\u3002 \u5f15\u8d77panic\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c \u5bf9\u5df2\u5173\u95ed\u7684\u901a\u9053\u8fdb\u884c \u53d1\u9001\u64cd\u4f5c \uff08\u63a5\u6536\u64cd\u4f5c\u53ef\u4ee5\u611f\u77e5\u5230\u901a\u9053\u5df2\u7ecf\u5173\u95ed\uff0c\u5e76\u5b89\u5168\u9000\u51fa\uff09 \u5173\u95ed\u5df2\u7ecf\u5173\u95ed\u7684\u901a\u9053 \u63a5\u6536\u64cd\u4f5c\u8fd4\u56de\u4e24\u4e2a\u503c\uff1a \u5143\u7d20\u503c \u63a5\u6536\u64cd\u4f5c\u6210\u529f\u4e0e\u5426 \u5982\u679c\u901a\u9053\u5173\u95ed\u65f6\uff0c\u91cc\u9762\u6709\u5143\u7d20\u503c\u672a\u53d6\u51fa\uff0c\u63a5\u6536\u64cd\u4f5c\u4f1a\u628a\u901a\u9053\u4e2d\u7684\u503c\u6309\u987a\u5e8f\u53d6\u503c\u4e4b\u540e\uff0c\u5728\u8fd4\u56de\u901a\u9053\u5df2\u5173\u95ed\u7684false\u5224\u65ad \u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u63a5\u6536\u64cd\u4f5c\u7684\u8fd4\u56de\u503c\u7684\u7b2c\u4e8c\u4e2a\u503c\u6765\u5224\u65ad\u901a\u9053\u662f\u5426\u5173\u95ed\u6709\u5ef6\u8fdf\u3002 \u9664\u975e\u6709\u7279\u6b8a\u4fdd\u8bc1\uff0c\u5426\u5219\u8ba9\u53d1\u9001\u65b9\u5173\u95ed\u901a\u9053\uff0c\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u3002 \u5355\u5411\u901a\u9053 \u901a\u5e38\u8bf4\u7684\u901a\u9053\u90fd\u662f\u53cc\u5411\u901a\u9053\uff0c\u53ef\u4ee5\u53d1\u4e5f\u53ef\u4ee5\u6536\u3002 \u5355\u5411\u901a\u9053\uff1a\u53ea\u80fd\u53d1\u6216\u8005\u4e4b\u53ea\u80fd\u6536\u3002 \u4e00\u4e2a\u901a\u9053\u662f\u53cc\u5411\u8fd8\u662f\u5355\u5411\uff0c\u7531\u7c7b\u578b\u5b57\u9762\u91cf\u4f53\u73b0\u3002 var uselessChan = make(chan - int,1) // \u53d1\u9001\u901a\u9053\uff0c\u53ea\u80fd\u53d1\uff08\u5f80\u901a\u9053\u4e2d\u53d1\u9001\uff09 uselessChan = make( -chan int,1) // \u63a5\u6536\u901a\u9053\uff0c\u53ea\u80fd\u6536\uff08\u4ece\u901a\u9053\u4e2d\u63a5\u6536\uff09 \u7ad9\u5728\u64cd\u4f5c\u901a\u9053\u7684\u4ee3\u7801\u7684\u89d2\u5ea6\uff0c\u770b\u5355\u5411\u901a\u9053\u662f\u53d1\u9001\u901a\u9053\u8fd8\u662f\u63a5\u6536\u901a\u9053 \u3002 \u5355\u5411\u901a\u9053\u7684\u4ef7\u503c \u5355\u5411\u901a\u9053\u6700\u4e3b\u8981\u7684\u7528\u9014\u662f\u7ea6\u675f\u5176\u4ed6\u4ee3\u7801\u7684\u884c\u4e3a \u3002 \u4f8b\u5b50\uff1a func SendInt(ch chan - int) { ch - rand.Intn(1000) } // SendInt\u51fd\u6570\uff0c\u53ea\u80fd\u63a5\u53d7\u4e00\u4e2a\u53d1\u9001\u901a\u9053\uff0c\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u53ea\u80fd\u5411\u901a\u9053\u4e2d\u53d1\u9001\u5143\u7d20\u503c\uff0c\u800c\u4e0d\u80fd\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5143\u7d20\u503c \u5728\u5b9e\u9645\u573a\u666f\u4e2d\uff0c\u7ea6\u675f\u4e00\u822c\u51fa\u73b0\u5728\u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\uff0c\u6216\u8005\uff0c\u58f0\u660e\u51fd\u6570\u7c7b\u578b\u65f6\uff0c\u5982\u679c\u4f7f\u7528\u5355\u5411\u901a\u9053\uff0c\u76f8\u5f53\u4e8e\u7ea6\u675f\u6240\u6709\u5b9e\u73b0\u8fd9\u4e2a\u51fd\u6570\u7c7b\u578b\u7684\u51fd\u6570\u3002 \u5728\u7f16\u5199\u6a21\u677f\u4ee3\u7801\u6216\u53ef\u6269\u5c55\u7684\u7a0b\u5e8f\u5e93\u662f\u5f88\u6709\u7528 \u3002 type Notifier interface { SendInt(ch chan - int) } // \u5b9a\u4e49SendInt\u65b9\u6cd5\uff0c\u53c2\u6570\u662f\u4e00\u4e2a\u53d1\u9001\u901a\u9053 // \u8be5\u63a5\u53e3\u7684\u6240\u5b9e\u73b0\u7c7b\u578b\u4e2d\u7684SendInt\u65b9\u6cd5\u90fd\u53d7\u5230\u9650\u5236 // \u5728\u8c03\u7528SendInt\u51fd\u6570\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u4e00\u4e2a\u53cc\u5411\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5b83\uff0cGo\u8bed\u8a00\u4f1a\u81ea\u5b9a\u628a\u5b83\u8f6c\u6362\u4e3a\u6240\u9700\u7684\u5355\u5411\u901a\u9053 \u5728\u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u7684\u82b1\u62ec\u53f7\u4e2d\uff0c\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u65b9\u6cd5\u7684\u5b9a\u4e49\u3002 \u63a5\u53e3\u4e2d\u65b9\u6cd5\u5b9a\u4e49\u4e0e\u51fd\u6570\u58f0\u660e\u5f88\u7c7b\u4f3c\uff0c\u53ea\u5305\u542b\u65b9\u6cd5\u540d\uff0c\u53c2\u6570\u5217\u8868\u548c\u7ed3\u679c\u5217\u8868\u3002\u4e00\u4e2a\u7c7b\u578b\u5982\u679c\u60f3\u8981\u6210\u4e3a\u4e00\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u5fc5\u987b\u5b9e\u73b0\u63a5\u53e3\u4e2d\u5b9a\u4e49\u7684\u6240\u6709\u65b9\u6cd5\u3002 \u56e0\u6b64\u67d0\u4e2a\u65b9\u6cd5\u4e2d\u5b9a\u4e49\u4e86\u5355\u5411\u901a\u9053\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u5bf9\u5b83\u7684\u6240\u6709\u5b9e\u73b0\u505a\u51fa\u7ea6\u675f \u3002 func getIntChan() -chan int { num := 5 ch := make(chan int, num) for i := 0; i num; i++ { ch - i } close(ch) return ch } // \u5728\u51fd\u6570\u7684\u7ed3\u679c\u7c7b\u522b\u4e2d\u4f7f\u7528\u5355\u5411\u901a\u9053 // \u5f97\u5230\u8be5\u901a\u9053\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5143\u7d20\u503c\uff0c\u8fd9\u662f\u5bf9\u51fd\u6570\u8c03\u7528\u65b9\u6cd5\u7684\u4e00\u79cd\u7ea6\u675f intChan2 := getIntChan() for elem := range intChan2 { fmt.Printf( The element in intChan2: %v\\n , elem) } // for\u8bed\u53e5\u5faa\u73af\u7684\u4ece\u5355\u5411\u901a\u9053\u4e2d\u53d6\u51fa\u5143\u7d20\u503c \u5bf9\u4e0a\u8ff0for\u8bed\u53e5\u7684\u89e3\u91ca\uff1a for\u8bed\u53e5\u4f1a\u4e0d\u65ad\u5c1d\u8bd5\u4eceinitChan2\u53d6\u51fa\u5143\u7d20\u503c\uff0c\u5373\u4f7f\u901a\u9053\u88ab\u5173\u95ed\uff0c\u4e5f\u4f1a\u53d6\u51fa\u6240\u6709\u5269\u4f59\u7684\u5143\u7d20\u503c\u4e4b\u540e\u518d\u7ed3\u675f\u6267\u884c \u5355\u5411\u901a\u9053\u4e2d\u6ca1\u6709\u5143\u7d20\u503c\u65f6\uff0c\u4ee3\u7801\u4f1a\u88ab\u963b\u585e\u5728for\u5173\u952e\u5b57\u90a3\u4e00\u884c initChan2\u7684\u503c\u4e3anil\uff0c\u4ee3\u7801\u4f1a\u88ab\u6c38\u8fdc\u963b\u585e\u5728for\u5173\u952e\u5b57\u90a3\u4e00\u884c \u4e0a\u8ff0\u4e09\u70b9\u662f\u5e26range\u5b50\u53e5\u7684for\u5faa\u73af\u4e0e\u901a\u9053\u7684\u8054\u7cfb\uff0cGo\u8fd8\u6709\u4e13\u95e8\u64cd\u4f5c\u901a\u9053\u7684select\u8bed\u53e5\u3002 select\u8bed\u53e5 select\u8bed\u53e5\u53ea\u80fd\u4e0e\u901a\u9053\u8054\u7528\uff0c\u4e00\u822c\u7531\u82e5\u5e72\u4e2a\u5206\u652f\u7ec4\u6210\uff0c\u6bcf\u6b21\u6267\u884cselect\u8bed\u53e5\u7684\u65f6\u5019\uff0c\u53ea\u6709\u4e00\u4e2a\u5206\u652f\u4e2d\u7684\u4ee3\u7801\u4f1a\u88ab\u6267\u884c\u3002 select\u8bed\u53e5\u7684\u5206\u652f\uff1a \u5019\u9009\u5206\u652f\uff1a\u4ee5\u5173\u952e\u5b57 case \u5f00\u5934\uff0c\u540e\u9762\u662f\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u548c\u4e00\u4e2a\u5192\u53f7\uff0c\u4ece\u4e0b\u4e00\u884c\u5f00\u59cb\u5199\u5165\uff0c\u5206\u652f\u88ab\u9009\u4e2d\u65f6\u9700\u8981\u6267\u884c\u7684\u8bed\u53e5 \u9ed8\u8ba4\u5206\u652f\uff1a default case \uff0c \u5f53\u4e14\u4ec5\u5f53 \u6ca1\u6709\u5019\u9009\u5206\u652f\u88ab\u9009\u4e2d\u65f6\uff0c\u5b83\u624d\u4f1a\u88ab\u6267\u884c\uff0cdefault\u5f00\u5934\u540e\u9762\u76f4\u63a5\u662f\u5192\u53f7\uff0c\u4ece\u4e0b\u4e00\u884c\u5f00\u59cb\u5199\u5165\u8981\u6267\u884c\u7684\u8bed\u53e5 select\u8bed\u53e5\u662f\u4e13\u95e8\u4e3a\u901a\u9053\u800c\u8bbe\u8ba1\u7684\uff0c\u6bcf\u4e2acase\u8868\u8fbe\u5f0f\u4e2d\u53ea\u80fd\u5305\u542b\u64cd\u4f5c\u901a\u9053\u7684\u8868\u8fbe\u5f0f\uff0c\u5982\u63a5\u6536\u8868\u8fbe\u5f0f\u3002 \u4f8b\u5b50\uff1a // \u51c6\u5907\u597d\u51e0\u4e2a\u901a\u9053\u3002 intChannels := [3]chan int{ make(chan int, 1), make(chan int, 1), make(chan int, 1), } // \u968f\u673a\u9009\u62e9\u4e00\u4e2a\u901a\u9053\uff0c\u5e76\u5411\u5b83\u53d1\u9001\u5143\u7d20\u503c\u3002 index := rand.Intn(3) fmt.Printf( The index: %d\\n , index) intChannels[index] - index // \u54ea\u4e00\u4e2a\u901a\u9053\u4e2d\u6709\u53ef\u53d6\u7684\u5143\u7d20\u503c\uff0c\u54ea\u4e2a\u5bf9\u5e94\u7684\u5206\u652f\u5c31\u4f1a\u88ab\u6267\u884c\u3002 select { case -intChannels[0]: fmt.Println( The first candidate case is selected. ) case -intChannels[1]: fmt.Println( The second candidate case is selected. ) case elem := -intChannels[2]: fmt.Printf( The third candidate case is selected, the element is %d.\\n , elem) default: fmt.Println( No candidate case is selected! ) } select\u8bed\u53e5\u7684\u6ce8\u610f\u70b9\uff1a \u8bbe\u7f6e\u9ed8\u8ba4\u5206\u652f\u540e\uff0c\u65e0\u8bba\u6d89\u53ca\u901a\u9053\u64cd\u4f5c\u7684\u8868\u8fbe\u5f0f\u662f\u5426\u6709\u963b\u585e\uff0cselect\u8bed\u53e5\u90fd\u4e0d\u4f1a\u88ab\u963b\u585e\u3002 \u5982\u679c\u6ca1\u6709\u9ed8\u8ba4\u5206\u652f\uff0c\u4e00\u65e6\u6240\u6709case\u8868\u8fbe\u5f0f\u90fd\u6ca1\u6709\u6ee1\u8db3\u6c42\u503c\u6761\u4ef6\uff0c\u90a3\u4e48select\u8bed\u53e5\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u81f3\u5c11\u6709\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u6ee1\u8db3\u6761\u4ef6\u4e3a\u6b62\u3002 \u5f53\u901a\u9053\u5173\u95ed\u540e\uff0c\u4f1a\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5230\u5176\u5143\u7d20\u7c7b\u578b\u7684\u96f6\u503c\uff0c\u6240\u4ee5\u9700\u8981\u63a5\u6536\u8868\u8fbe\u5f0f\u7684\u7b2c\u4e8c\u4e2a\u7ed3\u679c\u503c\u6765\u5224\u65ad\u901a\u9053\u662f\u5426\u5173\u95ed\u3002\u4e00\u65e6\u53d1\u73b0\u67d0\u4e2a\u901a\u9053\u5173\u95ed\u4e86\uff0c\u5e94\u8be5\u53ca\u65f6\u5c4f\u853d\u5bf9\u5e94\u7684\u5206\u652f\u6216\u91c7\u53d6\u5176\u4ed6\u63aa\u65bd\u3002 select\u8bed\u53e5\u53ea\u80fd\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u5404\u6c42\u503c\u4e00\u6b21\u3002\u5982\u679c\u8fde\u7eed\u6216\u5b9a\u65f6\u5730\u64cd\u4f5c\u5176\u4e2d\u7684\u901a\u9053\uff0c\u5c31\u9700\u8981\u901a\u8fc7for\u8bed\u53e5\u4e2d\u5d4c\u5165select\u8bed\u53e5\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002\u7b80\u5355\u5730\u5728select\u8bed\u53e5\u7684\u5206\u652f\u4e2d\u4f7f\u7528break\u8bed\u53e5\uff0c\u53ea\u80fd\u7ed3\u675f\u5f53\u524d\u7684select\u8bed\u53e5\u7684\u6267\u884c\uff0c\u800c\u5e76\u4e0d\u4f1a\u5bf9\u5916\u5c42\u7684for\u8bed\u53e5\u4ea7\u751f\u4f5c\u7528\u3002\u8fd9\u79cd\u9519\u8bef\u7684\u7528\u6cd5\u53ef\u80fd\u4f1a\u8ba9\u8fd9\u4e2afor\u8bed\u53e5\u65e0\u4f11\u6b62\u7684\u8fd0\u884c\u4e0b\u53bb\u3002\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u3002 intChan := make(chan int, 1) // \u4e00\u79d2\u540e\u5173\u95ed\u901a\u9053\u3002 time.AfterFunc(time.Second, func() { close(intChan) }) select { case _, ok := -intChan: if !ok { fmt.Println( The candidate case is closed. ) break } fmt.Println( The candidate case is selected. ) } \u5206\u652f\u9009\u62e9\u89c4\u5219 \u6bcf\u4e00\u4e2acase\u8868\u8fbe\u5f0f\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u53d1\u9001\u6216\u63a5\u6536\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8868\u8fbe\u5f0f\u3002\u591a\u4e2a\u8868\u8fbe\u5f0f\u4ece\u5de6\u5230\u53f3\u987a\u5e8f\u88ab\u6c42\u503c\u3002 select\u8bed\u53e5\u5305\u542b\u7684\u5019\u9009\u5206\u652f\u4e2d\u7684case\u8868\u8fbe\u5f0f\u4f1a\u5728\u8be5\u8bed\u53e5\u6267\u884c\u65f6\u5148\u88ab\u6c42\u503c\uff0c\u6c42\u503c\u987a\u5e8f\u4ece\u4ee3\u7801\u7f16\u5199\u7684\u987a\u5e8f\u4ece\u4e0a\u5f80\u4e0b\uff0c\u6240\u6709\u5206\u652f\u90fd\u4f1a\u88ab\u6c42\u503c\uff0c\u4ece\u4e0a\u5230\u4e0b\uff0c\u4ece\u5de6\u5f80\u53f3\u3002 case\u8868\u8fbe\u5f0f\u4e2d\u7684\u53d1\u9001\u6216\u63a5\u6536\u64cd\u4f5c\u5904\u4e8e\u963b\u585e\u72b6\u6001\u65f6\uff0c\u8be5case\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u5c31\u4e0d\u6210\u529f\uff0c\u5373\u5019\u9009\u5206\u652f\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002 \u53ea\u6709\u5f53\u6240\u6709case\u8868\u8fbe\u5f0f\u90fd\u88ab\u6c42\u503c\u5b8c\u6210\u540e\uff0c\u624d\u5f00\u59cb\u9009\u62e9\u5019\u9009\u5206\u652f\u3002\u53ea\u4f1a\u6311\u9009\u6ee1\u8db3\u6761\u4ef6\u7684\u5019\u9009\u5206\u652f\u6267\u884c\u3002 \u6240\u6709\u5019\u9009\u5206\u652f\u90fd\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u9009\u62e9\u9ed8\u8ba4\u5206\u652f \u6ca1\u6709\u9ed8\u8ba4\u5206\u652f\uff0cselect\u8bed\u53e5\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u81f3\u5c11\u6709\u4e00\u4e2a\u5019\u9009\u5206\u652f\u6ee1\u8db3\u6761\u4ef6\u4e3a\u6b62 \u5982\u679c\u540c\u65f6\u6709\u591a\u4e2a\u5019\u9009\u5206\u652f\u6ee1\u8db3\u6761\u4ef6\uff0c\u7528\u4f2a\u968f\u673a\u7b97\u6cd5\u5728\u5019\u9009\u5206\u652f\u4e2d\u9009\u62e9\u4e00\u4e2a\uff0c\u7136\u540e\u6267\u884c\u3002 \u4e00\u4e2aselect\u8bed\u53e5\u53ea\u6709\u4e00\u4e2a\u9ed8\u8ba4\u5206\u652f\uff0c\u5e76\u4e14\u9ed8\u8ba4\u5206\u652f\u53ea\u5728\u65e0\u5019\u9009\u5206\u652f\u53ef\u9009\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\uff0c\u4e0e\u7f16\u5199\u4f4d\u7f6e\u65e0\u5173\u3002 select\u8bed\u53e5\u7684\u6bcf\u6b21\u6267\u884c\uff0c\u5305\u62eccase\u8868\u8fbe\u5f0f\u6c42\u503c\u548c\u5206\u652f\u9009\u62e9\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u5b83\u7684\u6267\u884c\u662f\u5426\u5e76\u53d1\u5b89\u5168\uff0c\u8981\u770b\u5176\u4e2d\u7684case\u8868\u8fbe\u5f0f\u4ee5\u53ca\u5206\u652f\u4e2d\u662f\u5426\u5305\u542b\u5e76\u53d1\u4e0d\u5b89\u5168\u7684\u4ee3\u7801\u3002","title":"\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#_1","text":"Don't communicate by sharing memory;share memory bu communicating. \u4e0d\u8981\u901a\u8fc7\u5171\u4eab\u5185\u5b58\u6765\u901a\u4fe1\uff0c\u800c\u5e94\u8be5\u901a\u8fc7\u901a\u4fe1\u6765\u5171\u4eab\u5185\u5b58\u3002 \u901a\u9053\u4e0egoroutine\u5171\u540c\u4ee3\u8868Go\u8bed\u8a00\u72ec\u6709\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u5f0f\u548c\u7f16\u7a0b\u54f2\u5b66\uff0c\u5229\u7528\u901a\u9053\u5728\u591a\u4e2agoroutine\u4e4b\u95f4\u4f20\u9012\u6570\u636e\u3002 \u901a\u9053\u7c7b\u578b\u7684\u503c\uff0c\u672c\u8eab\u5c31\u662f\u5e76\u53d1\u5b89\u5168\u7684 \u3002\u8fd9\u662fGo\u8bed\u8a00\u81ea\u5e26\u7684\u552f\u4e00\u4e00\u4e2a\u53ef\u4ee5\u6ee1\u8db3\u5e76\u53d1\u5b89\u5168\u6027\u7684\u7c7b\u578b\u3002 \u5728\u58f0\u660e\u5e76\u521d\u59cb\u5316\u4e00\u4e2a\u901a\u9053\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528Go\u5185\u5efa\u51fd\u6570 make() ,\u4f20\u7ed9\u8fd9\u4e2a\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5e94\u8be5\u662f\u4ee3\u8868\u4e86\u901a\u9053\u7684\u5177\u4f53\u7c7b\u578b\u7684\u7c7b\u578b\u5b57\u9762\u91cf\uff0c\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2aint\u7c7b\u578b\u7684\u503c\uff0c\u4e0d\u80fd\u5c0f\u4e8e0\uff0c\u8868\u793a\u901a\u9053\u7684\u5bb9\u91cf\uff08\u8be5\u53c2\u6570\u53ef\u9009\uff09\u3002 \u5f53\u5bb9\u91cf\u4e3a0\u65f6\uff0c\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u975e\u7f13\u51b2\u901a\u9053 \u5f53\u5bb9\u91cf\u5927\u4e8e0\u65f6\uff0c\u8868\u793a\u7f13\u51b2\u901a\u9053 \u975e\u7f13\u51b2\u901a\u9053\u548c\u7f13\u51b2\u901a\u9053\u6709\u4e0d\u540c\u7684\u6570\u636e\u4f20\u9012\u65b9\u5f0f\u3002 \u58f0\u660e\u4e00\u4e2a\u901a\u9053\u7c7b\u578b\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u9996\u5148\u8981\u786e\u5b9a\u8be5\u901a\u9053\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b\uff0c\u8fd9\u51b3\u5b9a\u4e86\u901a\u8fc7\u8fd9\u4e2a\u901a\u9053\u4f20\u9012\u58f0\u660e\u7c7b\u578b\u7684\u6570\u636e\u3002 chan int // chan \u8868\u793a\u901a\u9053\u7c7b\u578b\u7684\u5173\u952e\u5b57 // int \u8bf4\u660e\u8be5\u901a\u9053\u7c7b\u578b\u7684\u5143\u7d20\u7c7b\u578b ch1 := make(chan int,3) \u4e00\u4e2a\u901a\u9053\u76f8\u5f53\u4e00\u4e2aFIFO\u961f\u5217\uff0c\u901a\u9053\u4e2d\u5404\u4e2a\u5143\u7d20\u4e25\u683c\u6309\u7167\u53d1\u9001\u987a\u5e8f\u6392\u5217\uff0c\u5143\u7d20\u503c\u7684\u53d1\u9001\u548c\u63a5\u6536\u90fd\u7528\u5230\u64cd\u4f5c\u7b26 - ,\u79f0\u4e3a\u63a5\u9001\u64cd\u4f5c\u7b26\uff0c\u8be5\u7b26\u53f7\u5f62\u8c61\u7684\u8868\u793a\u4e86\u5143\u7d20\u503c\u7684\u4f20\u8f93\u65b9\u5411 \u3002 \u5bf9\u53d1\u9001\u4e0e\u63a5\u6536\u64cd\u4f5c\u7684\u57fa\u672c\u7279\u6027\uff1a \u5bf9\u540c\u4e00\u4e2a\u901a\u9053\uff0c\u53d1\u9001\u64cd\u4f5c\u4e4b\u95f4\u662f \u4e92\u65a5 \u7684\uff0c\u63a5\u6536\u64cd\u4f5c\u4e4b\u95f4\u4e5f\u662f \u4e92\u65a5 \u7684\uff1a \u5728\u540c\u4e00\u65f6\u523b\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u53ea\u4f1a\u6267\u884c\u5bf9\u540c\u4e00\u4e2a\u901a\u9053\u7684\u4efb\u610f\u4e2a\u53d1\u9001\u64cd\u4f5c\u4e2d\u7684\u67d0\u4e00\u4e2a\u3002 \u76f4\u5230\u8fd9\u4e2a\u5143\u7d20\u503c\u88ab\u5b8c\u5168\u590d\u5236\u8fdb\u8be5\u901a\u9053\u4e4b\u540e\uff0c\u5176\u4ed6\u9488\u5bf9\u8be5\u901a\u9053\u7684\u53d1\u9001\u64cd\u4f5c\u624d\u53ef\u80fd\u88ab\u6267\u884c \u3002\u63a5\u6536\u64cd\u4f5c\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5373\u4f7f\u64cd\u4f5c\u662f\u5e76\u53d1\u6267\u884c\u7684\u4e5f\u662f\u5982\u6b64\u3002 \u5bf9\u4e8e\u901a\u9053\u5185\u7684\u540c\u4e00\u4e2a\u5143\u7d20\u503c\uff0c\u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u4e4b\u95f4\u4e5f\u662f\u4e92\u65a5\u7684\u3002\u5373\u4f7f\u4e00\u4e2a\u6b63\u5728\u88ab\u590d\u5236\u8fdb\u901a\u9053\u4f46\u8fd8\u672a\u590d\u5236\u5b8c\u6210\u7684\u5143\u7d20\u503c\uff0c\u4e5f\u7edd\u4e0d\u4f1a\u88ab\u60f3\u63a5\u6536\u5b83\u7684\u4e00\u65b9\u770b\u5230\u548c\u53d6\u8d70\u3002 \u5143\u7d20\u503c\u4ece\u5916\u754c\u8fdb\u5165\u901a\u9053\u65f6\u662f\u88ab\u590d\u5236\uff0c\u5373\u8fdb\u5165\u901a\u9053\u7684\u5e76\u4e0d\u662f\u63a5\u6536\u64cd\u4f5c\u7b26\u53f3\u8fb9\u7684\u90a3\u4e2a\u5143\u7d20\u503c\uff0c\u800c\u662f\u5b83\u7684\u526f\u672c \u3002 \u5143\u7d20\u4ece\u901a\u9053\u8fdb\u5165\u5916\u754c\u65f6\u4f1a\u88ab\u79fb\u52a8\uff1a \u751f\u6210\u6b63\u5728\u901a\u9053\u4e2d\u7684\u8fd9\u4e2a\u5143\u7d20\u503c\u7684\u526f\u672c\uff0c\u5e76\u51c6\u5907\u7ed9\u5230\u63a5\u6536\u65b9 \u5220\u9664\u5728\u901a\u9053\u4e2d\u7684\u8fd9\u4e2a\u5143\u7d20\u503c \u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u4e2d\u5bf9\u5143\u7d20\u503c\u7684\u5904\u7406\u90fd\u662f \u4e0d\u53ef\u5206\u5272 \u7684\uff1a \u4e0d\u53ef\u5206\u5272 \u8868\u793a\u5904\u7406\u901a\u9053\u4e2d\u5143\u7d20\u7684\u64cd\u4f5c\u662f\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\uff1a \u53d1\u9001\u64cd\u4f5c\u8981\u4e48\u6ca1\u590d\u5236\u503c\uff0c\u8981\u4e48\u5df2\u7ecf\u590d\u5236\u5b8c\u6bd5 \u63a5\u6536\u64cd\u4f5c\u5728\u51c6\u5907\u597d\u5143\u7d20\u503c\u526f\u672c\u4e4b\u540e\uff0c\u4e00\u5b9a\u4f1a\u5220\u9664\u6389\u901a\u9053\u4e2d\u7684\u539f\u503c\uff0c\u7edd\u4e0d\u4f1a\u51fa\u73b0\u6709\u6b8b\u7559\u7684\u60c5\u51b5 \u53d1\u9001\u64cd\u4f5c\u548c\u63a5\u6536\u64cd\u4f5c\u5728\u5b8c\u5168\u5b8c\u6210\u4e4b\u524d\u4f1a\u88ab\u963b\u585e \u53d1\u9001\u64cd\u4f5c\uff1a \u590d\u5236\u5143\u7d20\u503c \u653e\u7f6e\u526f\u672c\u5230\u901a\u9053\u5185\u90e8 \u63a5\u6536\u64cd\u4f5c\uff1a \u590d\u5236\u901a\u9053\u5185\u7684\u5143\u7d20\u503c \u653e\u7f6e\u526f\u672c\u5230\u63a5\u6536\u65b9 \u5220\u9664\u539f\u503c \u5728\u6240\u6709\u6b65\u9aa4\u5b8c\u5168\u5b8c\u6210\u524d\uff0c\u53d1\u8d77\u8be5\u64cd\u4f5c\u7684\u4ee3\u7801\u4f1a\u4e00\u76f4\u963b\u585e\uff0c\u76f4\u5230\u8be5\u4ee3\u7801\u6240\u5728goroutine\u6536\u5230\u4e86\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u901a\u77e5\u5e76\u91cd\u65b0\u83b7\u5f97\u8fd0\u884c\u673a\u4f1a\u4e3a\u6b62\u3002 \u5982\u6b64\u963b\u585e\u4ee3\u7801\u5c31\u662f\u4e3a\u4e86\u5b9e\u73b0\u64cd\u4f5c\u7684\u4e92\u65a5\u548c\u5143\u7d20\u503c\u7684\u5b8c\u6574 \u3002","title":"\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#_2","text":"","title":"\u957f\u65f6\u95f4\u963b\u585e\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c"},{"location":"Language/Basic/08-\u901a\u9053/#_3","text":"\u5982\u679c\u901a\u9053\u5df2\u6ee1\uff0c\u5bf9\u5b83\u7684\u6240\u6709\u53d1\u9001\u64cd\u4f5c\u90fd\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u901a\u9053\u4e2d\u6709\u5143\u7d20\u503c\u88ab\u63a5\u6536\u8d70\uff0c\u6b64\u65f6\u901a\u9053\u4f1a\u4f18\u5148\u901a\u77e5\u6700\u65e9\u56e0\u6b64\u800c\u7b49\u5f85\u7684\u90a3\u4e2a\u53d1\u9001\u64cd\u4f5c\u6240\u5728\u7684goroutine\uff0c\u7136\u540e\u518d\u6b21\u6267\u884c\u53d1\u9001\u64cd\u4f5c\u3002 \u7531\u4e8e\u53d1\u9001\u64cd\u4f5c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u88ab\u963b\u585e\u540e\uff0c\u5b83\u4eec\u6240\u5728\u7684goroutine\u4f1a\u987a\u5e8f\u5730\u8fdb\u5165\u901a\u9053\u5185\u90e8\u7684\u53d1\u9001\u7b49\u5f85\u961f\u5217\uff0c\u6240\u4ee5\u901a\u77e5\u7684\u987a\u5e8f\u662f\u516c\u5e73\u7684\u3002 \u5982\u679c\u901a\u9053\u5df2\u7a7a\uff0c\u5bf9\u5b83\u7684\u6240\u6709\u63a5\u6536\u64cd\u4f5c\u90fd\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u901a\u9053\u4e2d\u6709\u65b0\u7684\u5143\u7d20\u51fa\u73b0\uff0c\u6b64\u65f6\u901a\u9053\u4f1a\u4f18\u5148\u901a\u77e5\u6700\u65e9\u7b49\u5f85\u7684\u90a3\u4e2a\u63a5\u6536\u64cd\u4f5c\u6240\u5728\u7684goroutine\uff0c\u5e76\u4f7f\u5b83\u518d\u6b21\u6267\u884c\u63a5\u6536\u64cd\u4f5c\u3002 \u56e0\u6b64\u800c\u7b49\u5f85\u7684\u6240\u6709\u63a5\u6536\u64cd\u4f5c\u6240\u5728\u7684goroutine\u90fd\u4f1a\u6309\u7167\u5148\u540e\u987a\u5e8f\u88ab\u653e\u5165\u901a\u9053\u5185\u90e8\u7684\u63a5\u6536\u7b49\u5f85\u961f\u5217\u3002 \u7f13\u51b2\u901a\u9053\u4f5c\u4e3a\u6536\u53d1\u53cc\u65b9\u7684\u4e2d\u95f4\u4ef6\uff0c\u5143\u7d20\u503c\u5148\u4ece\u53d1\u9001\u65b9\u590d\u5236\u5230\u7f13\u51b2\u901a\u9053\uff0c\u4e4b\u540e\u518d\u7531\u7f13\u51b2\u901a\u9053\u590d\u5236\u7ed9\u63a5\u6536\u65b9\u3002 \u5f53\u53d1\u9001\u64cd\u4f5c\u5728\u6267\u884c\u7684\u65f6\u5019\u53d1\u73b0\u7a7a\u7684\u901a\u9053\u4e2d\uff0c\u6b63\u597d\u6709\u7b49\u5f85\u7684\u63a5\u6536\u64cd\u4f5c\uff0c\u90a3\u4e48\u5b83\u4f1a\u76f4\u63a5\u628a\u5143\u7d20\u503c\u590d\u5236\u7ed9\u63a5\u6536\u65b9 \u3002","title":"\u7f13\u51b2\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#_4","text":"\u65e0\u8bba\u662f\u53d1\u9001\u64cd\u4f5c\u8fd8\u662f\u63a5\u6536\u64cd\u4f5c\uff0c\u4e00\u5f00\u59cb\u6267\u884c\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u914d\u5bf9\u7684\u64cd\u4f5c\u4e5f\u5f00\u59cb\u6267\u884c\uff0c\u624d\u4f1a\u7ee7\u7eed\u4f20\u9012\u3002 \u975e\u7f13\u51b2\u901a\u9053\u662f\u5728\u7528\u540c\u6b65\u7684\u65b9\u5f0f\u4f20\u9012\u6570\u636e\uff0c\u53ea\u6709\u6536\u53d1\u53cc\u65b9\u5bf9\u63a5\u4e0a\u4e86\uff0c\u6570\u636e\u624d\u4f1a\u88ab\u4f20\u9012\u3002 \u6570\u636e\u76f4\u63a5\u4ece\u53d1\u9001\u65b9\u590d\u5236\u5230\u63a5\u6536\u65b9\uff0c\u4e2d\u95f4\u5e76\u6ca1\u6709\u975e\u7f13\u51b2\u901a\u9053\u505a\u4e2d\u8f6c\uff0c\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u7f13\u51b2\u901a\u9053\u5219\u5728\u7528\u5f02\u6b65\u7684\u65b9\u5f0f\u4f20\u9012\u6570\u636e\u3002","title":"\u975e\u7f13\u51b2\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#_5","text":"\u5bf9\u503c\u4e3anil\u7684\u901a\u9053\uff0c\u4e0d\u8bba\u5b83\u7684\u5177\u4f53\u7c7b\u578b\u662f\u4ec0\u4e48\uff0c\u5bf9\u5b83\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c\u90fd\u4f1a\u6c38\u4e45\u5730\u5904\u4e8e\u963b\u585e\u72b6\u6001\u3002\u5b83\u4eec\u6240\u5c5e\u7684goroutine\u4e2d\u7684\u4efb\u4f55\u4ee3\u7801\u90fd\u4e0d\u518d\u4f1a\u88ab\u6267\u884c\u3002 \u901a\u9053\u7c7b\u578b\u662f\u5f15\u7528\uff0c\u6240\u4ee5\u5b83\u7684\u96f6\u503c\u5c31\u662fnil\uff0c\u53ea\u58f0\u660e\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\u4f46\u6ca1\u6709\u7528 make() \u51fd\u6570\u5bf9\u5b83\u521d\u59cb\u5316\u65f6\uff0c\u8be5\u53d8\u91cf\u7684\u503c\u5c31\u662fnil\u3002","title":"\u9519\u8bef\u4f7f\u7528\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#panic","text":"\u5bf9\u5df2\u5173\u95ed\u7684\u901a\u9053\u8fdb\u884c \u53d1\u9001\u64cd\u4f5c \uff08\u63a5\u6536\u64cd\u4f5c\u53ef\u4ee5\u611f\u77e5\u5230\u901a\u9053\u5df2\u7ecf\u5173\u95ed\uff0c\u5e76\u5b89\u5168\u9000\u51fa\uff09 \u5173\u95ed\u5df2\u7ecf\u5173\u95ed\u7684\u901a\u9053 \u63a5\u6536\u64cd\u4f5c\u8fd4\u56de\u4e24\u4e2a\u503c\uff1a \u5143\u7d20\u503c \u63a5\u6536\u64cd\u4f5c\u6210\u529f\u4e0e\u5426 \u5982\u679c\u901a\u9053\u5173\u95ed\u65f6\uff0c\u91cc\u9762\u6709\u5143\u7d20\u503c\u672a\u53d6\u51fa\uff0c\u63a5\u6536\u64cd\u4f5c\u4f1a\u628a\u901a\u9053\u4e2d\u7684\u503c\u6309\u987a\u5e8f\u53d6\u503c\u4e4b\u540e\uff0c\u5728\u8fd4\u56de\u901a\u9053\u5df2\u5173\u95ed\u7684false\u5224\u65ad \u3002\u56e0\u6b64\uff0c\u901a\u8fc7\u63a5\u6536\u64cd\u4f5c\u7684\u8fd4\u56de\u503c\u7684\u7b2c\u4e8c\u4e2a\u503c\u6765\u5224\u65ad\u901a\u9053\u662f\u5426\u5173\u95ed\u6709\u5ef6\u8fdf\u3002 \u9664\u975e\u6709\u7279\u6b8a\u4fdd\u8bc1\uff0c\u5426\u5219\u8ba9\u53d1\u9001\u65b9\u5173\u95ed\u901a\u9053\uff0c\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u3002","title":"\u5f15\u8d77panic\u7684\u53d1\u9001\u548c\u63a5\u6536\u64cd\u4f5c"},{"location":"Language/Basic/08-\u901a\u9053/#_6","text":"\u901a\u5e38\u8bf4\u7684\u901a\u9053\u90fd\u662f\u53cc\u5411\u901a\u9053\uff0c\u53ef\u4ee5\u53d1\u4e5f\u53ef\u4ee5\u6536\u3002 \u5355\u5411\u901a\u9053\uff1a\u53ea\u80fd\u53d1\u6216\u8005\u4e4b\u53ea\u80fd\u6536\u3002 \u4e00\u4e2a\u901a\u9053\u662f\u53cc\u5411\u8fd8\u662f\u5355\u5411\uff0c\u7531\u7c7b\u578b\u5b57\u9762\u91cf\u4f53\u73b0\u3002 var uselessChan = make(chan - int,1) // \u53d1\u9001\u901a\u9053\uff0c\u53ea\u80fd\u53d1\uff08\u5f80\u901a\u9053\u4e2d\u53d1\u9001\uff09 uselessChan = make( -chan int,1) // \u63a5\u6536\u901a\u9053\uff0c\u53ea\u80fd\u6536\uff08\u4ece\u901a\u9053\u4e2d\u63a5\u6536\uff09 \u7ad9\u5728\u64cd\u4f5c\u901a\u9053\u7684\u4ee3\u7801\u7684\u89d2\u5ea6\uff0c\u770b\u5355\u5411\u901a\u9053\u662f\u53d1\u9001\u901a\u9053\u8fd8\u662f\u63a5\u6536\u901a\u9053 \u3002","title":"\u5355\u5411\u901a\u9053"},{"location":"Language/Basic/08-\u901a\u9053/#_7","text":"\u5355\u5411\u901a\u9053\u6700\u4e3b\u8981\u7684\u7528\u9014\u662f\u7ea6\u675f\u5176\u4ed6\u4ee3\u7801\u7684\u884c\u4e3a \u3002 \u4f8b\u5b50\uff1a func SendInt(ch chan - int) { ch - rand.Intn(1000) } // SendInt\u51fd\u6570\uff0c\u53ea\u80fd\u63a5\u53d7\u4e00\u4e2a\u53d1\u9001\u901a\u9053\uff0c\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u53ea\u80fd\u5411\u901a\u9053\u4e2d\u53d1\u9001\u5143\u7d20\u503c\uff0c\u800c\u4e0d\u80fd\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5143\u7d20\u503c \u5728\u5b9e\u9645\u573a\u666f\u4e2d\uff0c\u7ea6\u675f\u4e00\u822c\u51fa\u73b0\u5728\u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u4e2d\u7684\u67d0\u4e2a\u65b9\u6cd5\u5b9a\u4e49\u4e0a\uff0c\u6216\u8005\uff0c\u58f0\u660e\u51fd\u6570\u7c7b\u578b\u65f6\uff0c\u5982\u679c\u4f7f\u7528\u5355\u5411\u901a\u9053\uff0c\u76f8\u5f53\u4e8e\u7ea6\u675f\u6240\u6709\u5b9e\u73b0\u8fd9\u4e2a\u51fd\u6570\u7c7b\u578b\u7684\u51fd\u6570\u3002 \u5728\u7f16\u5199\u6a21\u677f\u4ee3\u7801\u6216\u53ef\u6269\u5c55\u7684\u7a0b\u5e8f\u5e93\u662f\u5f88\u6709\u7528 \u3002 type Notifier interface { SendInt(ch chan - int) } // \u5b9a\u4e49SendInt\u65b9\u6cd5\uff0c\u53c2\u6570\u662f\u4e00\u4e2a\u53d1\u9001\u901a\u9053 // \u8be5\u63a5\u53e3\u7684\u6240\u5b9e\u73b0\u7c7b\u578b\u4e2d\u7684SendInt\u65b9\u6cd5\u90fd\u53d7\u5230\u9650\u5236 // \u5728\u8c03\u7528SendInt\u51fd\u6570\u65f6\uff0c\u53ea\u9700\u8981\u5c06\u4e00\u4e2a\u53cc\u5411\u901a\u9053\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u5b83\uff0cGo\u8bed\u8a00\u4f1a\u81ea\u5b9a\u628a\u5b83\u8f6c\u6362\u4e3a\u6240\u9700\u7684\u5355\u5411\u901a\u9053 \u5728\u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u7684\u82b1\u62ec\u53f7\u4e2d\uff0c\u6bcf\u4e00\u884c\u4ee3\u8868\u4e00\u4e2a\u65b9\u6cd5\u7684\u5b9a\u4e49\u3002 \u63a5\u53e3\u4e2d\u65b9\u6cd5\u5b9a\u4e49\u4e0e\u51fd\u6570\u58f0\u660e\u5f88\u7c7b\u4f3c\uff0c\u53ea\u5305\u542b\u65b9\u6cd5\u540d\uff0c\u53c2\u6570\u5217\u8868\u548c\u7ed3\u679c\u5217\u8868\u3002\u4e00\u4e2a\u7c7b\u578b\u5982\u679c\u60f3\u8981\u6210\u4e3a\u4e00\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u5fc5\u987b\u5b9e\u73b0\u63a5\u53e3\u4e2d\u5b9a\u4e49\u7684\u6240\u6709\u65b9\u6cd5\u3002 \u56e0\u6b64\u67d0\u4e2a\u65b9\u6cd5\u4e2d\u5b9a\u4e49\u4e86\u5355\u5411\u901a\u9053\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u5bf9\u5b83\u7684\u6240\u6709\u5b9e\u73b0\u505a\u51fa\u7ea6\u675f \u3002 func getIntChan() -chan int { num := 5 ch := make(chan int, num) for i := 0; i num; i++ { ch - i } close(ch) return ch } // \u5728\u51fd\u6570\u7684\u7ed3\u679c\u7c7b\u522b\u4e2d\u4f7f\u7528\u5355\u5411\u901a\u9053 // \u5f97\u5230\u8be5\u901a\u9053\u7684\u7a0b\u5e8f\uff0c\u53ea\u80fd\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5143\u7d20\u503c\uff0c\u8fd9\u662f\u5bf9\u51fd\u6570\u8c03\u7528\u65b9\u6cd5\u7684\u4e00\u79cd\u7ea6\u675f intChan2 := getIntChan() for elem := range intChan2 { fmt.Printf( The element in intChan2: %v\\n , elem) } // for\u8bed\u53e5\u5faa\u73af\u7684\u4ece\u5355\u5411\u901a\u9053\u4e2d\u53d6\u51fa\u5143\u7d20\u503c \u5bf9\u4e0a\u8ff0for\u8bed\u53e5\u7684\u89e3\u91ca\uff1a for\u8bed\u53e5\u4f1a\u4e0d\u65ad\u5c1d\u8bd5\u4eceinitChan2\u53d6\u51fa\u5143\u7d20\u503c\uff0c\u5373\u4f7f\u901a\u9053\u88ab\u5173\u95ed\uff0c\u4e5f\u4f1a\u53d6\u51fa\u6240\u6709\u5269\u4f59\u7684\u5143\u7d20\u503c\u4e4b\u540e\u518d\u7ed3\u675f\u6267\u884c \u5355\u5411\u901a\u9053\u4e2d\u6ca1\u6709\u5143\u7d20\u503c\u65f6\uff0c\u4ee3\u7801\u4f1a\u88ab\u963b\u585e\u5728for\u5173\u952e\u5b57\u90a3\u4e00\u884c initChan2\u7684\u503c\u4e3anil\uff0c\u4ee3\u7801\u4f1a\u88ab\u6c38\u8fdc\u963b\u585e\u5728for\u5173\u952e\u5b57\u90a3\u4e00\u884c \u4e0a\u8ff0\u4e09\u70b9\u662f\u5e26range\u5b50\u53e5\u7684for\u5faa\u73af\u4e0e\u901a\u9053\u7684\u8054\u7cfb\uff0cGo\u8fd8\u6709\u4e13\u95e8\u64cd\u4f5c\u901a\u9053\u7684select\u8bed\u53e5\u3002","title":"\u5355\u5411\u901a\u9053\u7684\u4ef7\u503c"},{"location":"Language/Basic/08-\u901a\u9053/#select","text":"select\u8bed\u53e5\u53ea\u80fd\u4e0e\u901a\u9053\u8054\u7528\uff0c\u4e00\u822c\u7531\u82e5\u5e72\u4e2a\u5206\u652f\u7ec4\u6210\uff0c\u6bcf\u6b21\u6267\u884cselect\u8bed\u53e5\u7684\u65f6\u5019\uff0c\u53ea\u6709\u4e00\u4e2a\u5206\u652f\u4e2d\u7684\u4ee3\u7801\u4f1a\u88ab\u6267\u884c\u3002 select\u8bed\u53e5\u7684\u5206\u652f\uff1a \u5019\u9009\u5206\u652f\uff1a\u4ee5\u5173\u952e\u5b57 case \u5f00\u5934\uff0c\u540e\u9762\u662f\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u548c\u4e00\u4e2a\u5192\u53f7\uff0c\u4ece\u4e0b\u4e00\u884c\u5f00\u59cb\u5199\u5165\uff0c\u5206\u652f\u88ab\u9009\u4e2d\u65f6\u9700\u8981\u6267\u884c\u7684\u8bed\u53e5 \u9ed8\u8ba4\u5206\u652f\uff1a default case \uff0c \u5f53\u4e14\u4ec5\u5f53 \u6ca1\u6709\u5019\u9009\u5206\u652f\u88ab\u9009\u4e2d\u65f6\uff0c\u5b83\u624d\u4f1a\u88ab\u6267\u884c\uff0cdefault\u5f00\u5934\u540e\u9762\u76f4\u63a5\u662f\u5192\u53f7\uff0c\u4ece\u4e0b\u4e00\u884c\u5f00\u59cb\u5199\u5165\u8981\u6267\u884c\u7684\u8bed\u53e5 select\u8bed\u53e5\u662f\u4e13\u95e8\u4e3a\u901a\u9053\u800c\u8bbe\u8ba1\u7684\uff0c\u6bcf\u4e2acase\u8868\u8fbe\u5f0f\u4e2d\u53ea\u80fd\u5305\u542b\u64cd\u4f5c\u901a\u9053\u7684\u8868\u8fbe\u5f0f\uff0c\u5982\u63a5\u6536\u8868\u8fbe\u5f0f\u3002 \u4f8b\u5b50\uff1a // \u51c6\u5907\u597d\u51e0\u4e2a\u901a\u9053\u3002 intChannels := [3]chan int{ make(chan int, 1), make(chan int, 1), make(chan int, 1), } // \u968f\u673a\u9009\u62e9\u4e00\u4e2a\u901a\u9053\uff0c\u5e76\u5411\u5b83\u53d1\u9001\u5143\u7d20\u503c\u3002 index := rand.Intn(3) fmt.Printf( The index: %d\\n , index) intChannels[index] - index // \u54ea\u4e00\u4e2a\u901a\u9053\u4e2d\u6709\u53ef\u53d6\u7684\u5143\u7d20\u503c\uff0c\u54ea\u4e2a\u5bf9\u5e94\u7684\u5206\u652f\u5c31\u4f1a\u88ab\u6267\u884c\u3002 select { case -intChannels[0]: fmt.Println( The first candidate case is selected. ) case -intChannels[1]: fmt.Println( The second candidate case is selected. ) case elem := -intChannels[2]: fmt.Printf( The third candidate case is selected, the element is %d.\\n , elem) default: fmt.Println( No candidate case is selected! ) } select\u8bed\u53e5\u7684\u6ce8\u610f\u70b9\uff1a \u8bbe\u7f6e\u9ed8\u8ba4\u5206\u652f\u540e\uff0c\u65e0\u8bba\u6d89\u53ca\u901a\u9053\u64cd\u4f5c\u7684\u8868\u8fbe\u5f0f\u662f\u5426\u6709\u963b\u585e\uff0cselect\u8bed\u53e5\u90fd\u4e0d\u4f1a\u88ab\u963b\u585e\u3002 \u5982\u679c\u6ca1\u6709\u9ed8\u8ba4\u5206\u652f\uff0c\u4e00\u65e6\u6240\u6709case\u8868\u8fbe\u5f0f\u90fd\u6ca1\u6709\u6ee1\u8db3\u6c42\u503c\u6761\u4ef6\uff0c\u90a3\u4e48select\u8bed\u53e5\u5c31\u4f1a\u88ab\u963b\u585e\uff0c\u76f4\u5230\u81f3\u5c11\u6709\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u6ee1\u8db3\u6761\u4ef6\u4e3a\u6b62\u3002 \u5f53\u901a\u9053\u5173\u95ed\u540e\uff0c\u4f1a\u4ece\u901a\u9053\u4e2d\u63a5\u6536\u5230\u5176\u5143\u7d20\u7c7b\u578b\u7684\u96f6\u503c\uff0c\u6240\u4ee5\u9700\u8981\u63a5\u6536\u8868\u8fbe\u5f0f\u7684\u7b2c\u4e8c\u4e2a\u7ed3\u679c\u503c\u6765\u5224\u65ad\u901a\u9053\u662f\u5426\u5173\u95ed\u3002\u4e00\u65e6\u53d1\u73b0\u67d0\u4e2a\u901a\u9053\u5173\u95ed\u4e86\uff0c\u5e94\u8be5\u53ca\u65f6\u5c4f\u853d\u5bf9\u5e94\u7684\u5206\u652f\u6216\u91c7\u53d6\u5176\u4ed6\u63aa\u65bd\u3002 select\u8bed\u53e5\u53ea\u80fd\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2acase\u8868\u8fbe\u5f0f\u5404\u6c42\u503c\u4e00\u6b21\u3002\u5982\u679c\u8fde\u7eed\u6216\u5b9a\u65f6\u5730\u64cd\u4f5c\u5176\u4e2d\u7684\u901a\u9053\uff0c\u5c31\u9700\u8981\u901a\u8fc7for\u8bed\u53e5\u4e2d\u5d4c\u5165select\u8bed\u53e5\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002\u7b80\u5355\u5730\u5728select\u8bed\u53e5\u7684\u5206\u652f\u4e2d\u4f7f\u7528break\u8bed\u53e5\uff0c\u53ea\u80fd\u7ed3\u675f\u5f53\u524d\u7684select\u8bed\u53e5\u7684\u6267\u884c\uff0c\u800c\u5e76\u4e0d\u4f1a\u5bf9\u5916\u5c42\u7684for\u8bed\u53e5\u4ea7\u751f\u4f5c\u7528\u3002\u8fd9\u79cd\u9519\u8bef\u7684\u7528\u6cd5\u53ef\u80fd\u4f1a\u8ba9\u8fd9\u4e2afor\u8bed\u53e5\u65e0\u4f11\u6b62\u7684\u8fd0\u884c\u4e0b\u53bb\u3002\u5982\u4e0b\u9762\u7684\u4f8b\u5b50\u3002 intChan := make(chan int, 1) // \u4e00\u79d2\u540e\u5173\u95ed\u901a\u9053\u3002 time.AfterFunc(time.Second, func() { close(intChan) }) select { case _, ok := -intChan: if !ok { fmt.Println( The candidate case is closed. ) break } fmt.Println( The candidate case is selected. ) }","title":"select\u8bed\u53e5"},{"location":"Language/Basic/08-\u901a\u9053/#_8","text":"\u6bcf\u4e00\u4e2acase\u8868\u8fbe\u5f0f\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u53d1\u9001\u6216\u63a5\u6536\u64cd\u4f5c\uff0c\u4e5f\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7684\u8868\u8fbe\u5f0f\u3002\u591a\u4e2a\u8868\u8fbe\u5f0f\u4ece\u5de6\u5230\u53f3\u987a\u5e8f\u88ab\u6c42\u503c\u3002 select\u8bed\u53e5\u5305\u542b\u7684\u5019\u9009\u5206\u652f\u4e2d\u7684case\u8868\u8fbe\u5f0f\u4f1a\u5728\u8be5\u8bed\u53e5\u6267\u884c\u65f6\u5148\u88ab\u6c42\u503c\uff0c\u6c42\u503c\u987a\u5e8f\u4ece\u4ee3\u7801\u7f16\u5199\u7684\u987a\u5e8f\u4ece\u4e0a\u5f80\u4e0b\uff0c\u6240\u6709\u5206\u652f\u90fd\u4f1a\u88ab\u6c42\u503c\uff0c\u4ece\u4e0a\u5230\u4e0b\uff0c\u4ece\u5de6\u5f80\u53f3\u3002 case\u8868\u8fbe\u5f0f\u4e2d\u7684\u53d1\u9001\u6216\u63a5\u6536\u64cd\u4f5c\u5904\u4e8e\u963b\u585e\u72b6\u6001\u65f6\uff0c\u8be5case\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u5c31\u4e0d\u6210\u529f\uff0c\u5373\u5019\u9009\u5206\u652f\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002 \u53ea\u6709\u5f53\u6240\u6709case\u8868\u8fbe\u5f0f\u90fd\u88ab\u6c42\u503c\u5b8c\u6210\u540e\uff0c\u624d\u5f00\u59cb\u9009\u62e9\u5019\u9009\u5206\u652f\u3002\u53ea\u4f1a\u6311\u9009\u6ee1\u8db3\u6761\u4ef6\u7684\u5019\u9009\u5206\u652f\u6267\u884c\u3002 \u6240\u6709\u5019\u9009\u5206\u652f\u90fd\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u9009\u62e9\u9ed8\u8ba4\u5206\u652f \u6ca1\u6709\u9ed8\u8ba4\u5206\u652f\uff0cselect\u8bed\u53e5\u5904\u4e8e\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u81f3\u5c11\u6709\u4e00\u4e2a\u5019\u9009\u5206\u652f\u6ee1\u8db3\u6761\u4ef6\u4e3a\u6b62 \u5982\u679c\u540c\u65f6\u6709\u591a\u4e2a\u5019\u9009\u5206\u652f\u6ee1\u8db3\u6761\u4ef6\uff0c\u7528\u4f2a\u968f\u673a\u7b97\u6cd5\u5728\u5019\u9009\u5206\u652f\u4e2d\u9009\u62e9\u4e00\u4e2a\uff0c\u7136\u540e\u6267\u884c\u3002 \u4e00\u4e2aselect\u8bed\u53e5\u53ea\u6709\u4e00\u4e2a\u9ed8\u8ba4\u5206\u652f\uff0c\u5e76\u4e14\u9ed8\u8ba4\u5206\u652f\u53ea\u5728\u65e0\u5019\u9009\u5206\u652f\u53ef\u9009\u7684\u65f6\u5019\u624d\u4f1a\u6267\u884c\uff0c\u4e0e\u7f16\u5199\u4f4d\u7f6e\u65e0\u5173\u3002 select\u8bed\u53e5\u7684\u6bcf\u6b21\u6267\u884c\uff0c\u5305\u62eccase\u8868\u8fbe\u5f0f\u6c42\u503c\u548c\u5206\u652f\u9009\u62e9\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u5b83\u7684\u6267\u884c\u662f\u5426\u5e76\u53d1\u5b89\u5168\uff0c\u8981\u770b\u5176\u4e2d\u7684case\u8868\u8fbe\u5f0f\u4ee5\u53ca\u5206\u652f\u4e2d\u662f\u5426\u5305\u542b\u5e76\u53d1\u4e0d\u5b89\u5168\u7684\u4ee3\u7801\u3002","title":"\u5206\u652f\u9009\u62e9\u89c4\u5219"},{"location":"Language/Basic/09-\u51fd\u6570/","text":"\u51fd\u6570 \u4f7f\u7528Go\u8bed\u8a00\u8fdb\u884c\u6a21\u5757\u5316\u7f16\u7a0b\uff0c\u5fc5\u987b\u4e86\u89e3\u7684\u77e5\u8bc6\u4e3b\u8981\u5305\u62ec\u51e0\u4e2a\u91cd\u8981\u7684\u6570\u636e\u7c7b\u578b\u4ee5\u4e00\u4e9b\u6a21\u5757\u5316\u7f16\u7a0b\u7684\u6280\u5de7\u3002 \u5728Go\u8bed\u8a00\u4e2d\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11\uff0c\u51fd\u6570\u7c7b\u578b\u4e5f\u662f\u4e00\u7b49\u7684\u6570\u636e\u7c7b\u578b\u3002\u8fd9\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u91cd\u8981\u7279\u5f81\uff0cGo\u8bed\u8a00\u5728\u8bed\u8a00\u5c42\u9762\u652f\u6301\u51fd\u6570\u5f0f\u7f16\u7a0b\u3002 \u51fd\u6570\u7684\u7528\u9014\uff1a \u5c01\u88c5\u4ee3\u7801\u3001\u5206\u5272\u529f\u80fd\u3001\u89e3\u8026\u903b\u8f91 \u4f5c\u4e3a\u666e\u901a\u51fd\u6570\u503c\uff0c\u5728\u5176\u4ed6\u51fd\u6570\u4e4b\u95f4\u4f20\u9012\u3001\u8d4b\u503c\u53d8\u91cf\u3001\u505a\u7c7b\u578b\u5224\u65ad\u548c\u8f6c\u6362\uff08\u5c31\u50cf\u5207\u7247\u6216\u5b57\u5178\uff09 \u51fd\u6570\u503c\u53ef\u4ee5\u6210\u4e3a\u88ab\u968f\u610f\u4f20\u64ad\u7684\u72ec\u7acb\u903b\u8f91\u7ec4\u4ef6\uff08\u529f\u80fd\u6a21\u5757\uff09 \u3002 \u5bf9\u4e8e\u51fd\u6570\u7c7b\u578b\u6765\u8bf4\uff0c\u5b83\u662f\u4e00\u79cd\u5bf9\u4e00\u7ec4\u8f93\u5165\u3001\u8f93\u51fa\u8fdb\u884c\u6a21\u677f\u5316\u7684\u91cd\u8981\u5de5\u5177\uff0c\u5b83\u6bd4\u63a5\u53e3\u7c7b\u578b\u66f4\u52a0\u8f7b\u5de7\u3001\u7075\u6d3b\uff0c\u5b83\u7684\u503c\u4e5f\u501f\u6b64\u53d8\u6210\u4e86\u53ef\u88ab\u70ed\u66ff\u6362\u7684\u903b\u8f91\u7ec4\u4ef6\u3002 package main import fmt type Printer func(contents string) (n int, err error) // \u58f0\u660e\u51fd\u6570\u7c7b\u578b func printToStd(contents string) (bytesNum int, err error) { // \u5b9e\u73b0\u4e86\u51fd\u6570\u7c7b\u578bPrinter return fmt.Println(contents) } func main() { var p Printer p = printToStd p( something ) } \u51fd\u6570\u7684\u7b7e\u540d\u5305\u62ec\uff1a\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u548c\u51fd\u6570\u7684\u7ed3\u679c\u5217\u8868\uff0c\u5b83\u5b9a\u4e49\u4e86\u7528\u6765\u9274\u522b\u4e0d\u540c\u51fd\u6570\u7684\u7279\u5f81\uff0c\u4e5f\u5b9a\u4e49\u4e86\u4e0e\u51fd\u6570\u7684\u4ea4\u4e92\u65b9\u5f0f\u3002 \u51fd\u6570\u7b7e\u540d\u4e2d\u5143\u7d20\u987a\u5e8f\u53ca\u7c7b\u578b\u4e00\u81f4\uff0c\u90a3\u4e48\u5c31\u662f\u540c\u4e00\u4e2a\u51fd\u6570\uff0c\u6216\u662f\u5b9e\u73b0\u4e86\u540c\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\u7684\u51fd\u6570 \u3002 \u7f16\u5199\u9ad8\u9636\u51fd\u6570 \u9ad8\u9636\u51fd\u6570\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a \u63a5\u6536\u5176\u4ed6\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 \u628a\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de \u53ea\u8981\u6ee1\u8db3\u5176\u4e2d\u4e00\u4e2a\u6761\u4ef6\u5c31\u662f\u9ad8\u9636\u51fd\u6570\uff0c\u9ad8\u9636\u51fd\u6570\u4e5f\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u4e2d\u91cd\u8981\u7684\u6982\u5ff5\u548c\u7279\u5f81 \u3002 \u9ad8\u9636\u51fd\u6570\u53ef\u7528\u4e8e\u5b9e\u73b0\u95ed\u5305\u3002 \u9700\u6c42\uff1a\u7f16\u5199calculate\u51fd\u6570\u6765\u5b9e\u73b0\u4e24\u4e2a\u6574\u6570\u95f4\u7684\u52a0\u51cf\u4e58\u9664\u8fd0\u7b97\uff0c\u5e0c\u671b\u4e24\u4e2a\u6574\u6570\u548c\u5177\u4f53\u7684\u64cd\u4f5c\u90fd\u7531\u8be5\u51fd\u6570\u7684\u8c03\u7528\u65b9\u7ed9\u51fa\u3002 \u4f8b\u5b50\uff1a \u63a5\u6536\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u3002 // \u7b2c\u4e00\u6b65\uff1a\u58f0\u660e\u53eboperator\u7684\u51fd\u6570\u7c7b\u578b type operator func(x,y int) int // \u7b2c\u4e8c\u6b65:\u7f16\u5199calculate\u51fd\u6570 func calculate(x int,y int, op operator)(int, error){ if op == nil { // \u536b\u8ff0\u8bed\u53e5\uff0c\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5408\u6cd5 return 0 errors.New( invalid operation! ) } return op(x,y),nil } // \u5b9e\u73b0operator\uff0c\u53ea\u8981\u51fd\u6570\u7684\u7b7e\u540d\u4e0eoperator\u7c7b\u578b\u4e00\u81f4\u5c31\u662f\u5b83\u7684\u5b9e\u73b0 op := func(x, y int) int { return x + y } func main(){ x,y = 12,23 result,err := calculate(x,y,op)) } \u536b\u8ff0\u8bed\u53e5\uff1a\u88ab\u7528\u6765\u68c0\u67e5\u5173\u952e\u7684\u5148\u51b3\u6761\u4ef6\u7684\u5408\u6cd5\u6027\uff0c\u5e76\u5728\u68c0\u67e5\u672a\u901a\u8fc7\u7684\u60c5\u51b5\u4e0b\u7acb\u5373\u7ec8\u6b62\u5f53\u524d\u4ee3\u7801\u5757\u7684\u6267\u884c\u7684\u8bed\u53e5\u3002Go\u8bed\u8a00\u4e2dif\u8bed\u53e5\u5e38\u88ab\u4f5c\u4e3a\u536b\u8ff0\u8bed\u53e5\u3002 \u4f8b\u5b50\uff1a \u628a\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 // \u7b2c\u4e00\u6b65\uff1a\u58f0\u660e\u53eboperator\u548ccalculateFunc\u7684\u51fd\u6570\u7c7b\u578b type operator func(x,y int) int type calculateFunc func(x int,y int)(int,err) // \u7b2c\u4e8c\u6b65\uff1a\u7f16\u5199genCalculator\u51fd\u6570 func genCalculator(op operate) calculateFunc{ return func(x int,y int)(int, error){ if op == nil{ // \u536b\u8ff0\u8bed\u53e5 return 0, errors.New( invalid operation! ) } return op(x,y),nil } } // \u5b9e\u73b0operator op := func(x, y int) int { return x + y } func main(){ x,y = 56,78 add := genCalculator(op) result,err = add(x,y) } \u95ed\u5305 \u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u5b58\u5728\u5bf9\u5916\u6765\u6807\u8bc6\u7b26\uff08\u65e2\u4e0d\u4ee3\u8868\u5f53\u524d\u51fd\u6570\u7684\u4efb\u4f55\u53c2\u6570\u6216\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f\u51fd\u6570\u5185\u90e8\u58f0\u660e\u7684\uff0c\u800c\u662f\u76f4\u63a5\u4ece\u5916\u8fb9\u62ff\u6765\u7684\uff09\u7684\u5f15\u7528\uff0c\u4e5f\u79f0\u4e3a \u81ea\u7531\u53d8\u91cf \u3002\u8fd9\u91cc\u7684\u51fd\u6570\u79f0\u4e3a\u95ed\u5305\u51fd\u6570\uff0c\u5c31\u662f\u56e0\u4e3a\u5f15\u7528\u4e86\u81ea\u7531\u53d8\u91cf\uff0c\u800c\u5448\u73b0\u51fa\u4e86\u4e00\u79cd\u201d\u4e0d\u786e\u5b9a\u201c\u7684\u72b6\u6001\uff08\u5f00\u653e\u72b6\u6001\uff09\u3002 \u95ed\u5305\u4f53\u73b0\u7684\u662f\u7531\u201d\u4e0d\u786e\u5b9a\u201c\u53d8\u4e3a\u201d\u786e\u5b9a\u201c\u7684\u4e00\u4e2a\u8fc7\u7a0b\u3002\u5bf9\u4e8eGo\u8fd9\u6837\u7684\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u5728\u5b9a\u4e49\u7684\u95ed\u5305\u51fd\u6570\u7684\u65f6\u5019\uff0c\u6700\u591a\u53ea\u80fd\u77e5\u9053\u81ea\u7531\u53d8\u91cf\u7684\u7c7b\u578b\u3002 \u4f8b\u5b50\uff1a func genCalculator(op operate) calculateFunc { return func(x int, y int) (int, error) { if op == nil { return 0, errors.New( invalid operation ) } return op(x, y), nil } } genCalculator\u53ea\u505a\u4e86\u4e00\u4ef6\u4e8b\uff0c\u5b9a\u4e49\u4e00\u4e2a\u533f\u540d\u7684calculateFunc\u7c7b\u578b\u7684\u51fd\u6570\uff0c\u5e76\u628a\u5b83\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002\u8fd9\u4e2a\u533f\u540d\u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u95ed\u5305\u51fd\u6570\u3002\u5b83\u4f7f\u7528\u7684\u53d8\u91cfop\u65e2\u4e0d\u4ee3\u8868\u5b83\u7684\u4efb\u4f55\u53c2\u6570\u6216\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f\u5b83\u81ea\u5df1\u58f0\u660e\u7684\uff0c\u800c\u662f\u5b9a\u4e49\u5b83\u7684genCalculator\u51fd\u6570\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u81ea\u7531\u53d8\u91cf\uff08\u8fd9\u4e2a\u81ea\u7531\u53d8\u91cf\u4e0d\u662f\u5728\u5b9a\u4e49\u95ed\u5305\u51fd\u6570\u7684\u65f6\u5019\u786e\u5b9a\u7684\uff0c\u800c\u662f\u5728genCalculator\u51fd\u6570\u88ab\u8c03\u7528\u7684\u65f6\u5019\u786e\u5b9a\u7684\uff09\u3002 \u53ea\u6709\u7ed9\u5b9a\u4e86\u8be5\u51fd\u6570\u7684\u53c2\u6570op\uff0c\u624d\u77e5\u9053\u95ed\u5305\u51fd\u6570\u53ef\u7528\u4e8e\u58f0\u660e\u8fd0\u7b97 \u3002 \u7f16\u8bd1\u5230 if op == nill \u8bed\u53e5\u65f6\uff0cGo\u7f16\u8bd1\u5668\u4e0a\u5929\u5bfb\u627eop\u6240\u4ee3\u8868\u7684\u4e1c\u897f\uff0c\u53d1\u73b0op\u4ee3\u8868\u7684\u662fgenCalculator\u51fd\u6570\u7684\u53c2\u6570\uff0c\u7136\u540e\u628a\u8fd9\u4e24\u8005\u8054\u7cfb\u8d77\u6765\uff0c\u6b64\u65f6\u81ea\u7531\u53d8\u91cfop\u88ab\u6355\u83b7\uff0c\u8fd9\u4e2a\u95ed\u5305\u51fd\u6570\u7684\u72b6\u6001\u7531\u201d\u4e0d\u786e\u5b9a\u201c\u53d8\u4e3a\u201d\u786e\u5b9a\u201c\u3002 \u95ed\u5305\u7684\u7528\u9014\uff1a\u8868\u9762\u4e0a\u662f\u5ef6\u8fdf\u5b9e\u73b0\u4e86\u4e00\u90e8\u5206\u7a0b\u5e8f\u903b\u8f91\u6216\u529f\u80fd\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u52a8\u6001\u5730\u751f\u6210\u90a3\u90e8\u5206\u7a0b\u5e8f\u903b\u8f91 \u3002 \u4f20\u5165\u51fd\u6570\u7684\u53c2\u6570\u503c package main import fmt func main() { array1 := [3]string{ a , b , c } fmt.Printf( The array: %v\\n , array1) array2 := modifyArray(array1) fmt.Printf( The modified array: %v\\n , array2) // The modified array: [a x c] fmt.Printf( The original array: %v\\n , array1) // The original array: [a b c] } func modifyArray(a [3]string) [3]string { a[1] = x return a } \u539f\u6570\u7ec4\u6ca1\u6709\u56e0\u4e3a modifyArray() \u51fd\u6570\u800c\u6539\u53d8\uff0c\u56e0\u4e3a \u6240\u6709\u4f20\u7ed9\u51fd\u6570\u7684\u53c2\u6570\u503c\u90fd\u4f1a\u88ab\u590d\u5236 \uff0c\u51fd\u6570\u5728\u5176\u5185\u90e8\u4f7f\u7528\u7684\u5e76\u4e0d\u662f\u53c2\u6570\u503c\u7684\u539f\u503c\uff0c\u800c\u662f\u5b83\u7684\u526f\u672c\u3002 \u6570\u7ec4\u662f\u503c\u7c7b\u578b\uff0c\u6240\u4ee5\u6bcf\u6b21\u590d\u5236\u90fd\u4f1a\u62f7\u8d1d\u5b83\uff0c\u4ee5\u53ca\u5b83\u7684\u6240\u6709\u5143\u7d20\u503c\u3002 \u5bf9\u4e8e\u5f15\u7528\u7c7b\u578b\uff08\u5207\u7247\u3001\u5b57\u5178\u3001\u901a\u9053\uff09\uff0c\u590d\u5236\u503c\u7684\u65f6\u5019\uff0c\u53ea\u4f1a\u62f7\u8d1d\u5b83\u672c\u8eab\uff0c\u5e76\u4e0d\u4f1a\u62f7\u8d1d\u5b83\u5f15\u7528\u7684\u5e95\u5c42\u6570\u636e \u3002\u4ee5\u5207\u7247\u4e3a\u4f8b\uff0c\u53ea\u662f\u62f7\u8d1d\u4e86\u5b83\u6307\u5411\u5e95\u5c42\u6570\u7ec4\u4e2d\u67d0\u4e00\u4e2a\u5143\u7d20\u7684\u6307\u9488\uff0c\u4ee5\u53ca\u5b83\u7684\u957f\u5ea6\u503c\u548c\u5bb9\u91cf\u503c\uff0c\u5e95\u5c42\u6570\u7ec4\u5e76\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u3002","title":"\u51fd\u6570"},{"location":"Language/Basic/09-\u51fd\u6570/#_1","text":"\u4f7f\u7528Go\u8bed\u8a00\u8fdb\u884c\u6a21\u5757\u5316\u7f16\u7a0b\uff0c\u5fc5\u987b\u4e86\u89e3\u7684\u77e5\u8bc6\u4e3b\u8981\u5305\u62ec\u51e0\u4e2a\u91cd\u8981\u7684\u6570\u636e\u7c7b\u578b\u4ee5\u4e00\u4e9b\u6a21\u5757\u5316\u7f16\u7a0b\u7684\u6280\u5de7\u3002 \u5728Go\u8bed\u8a00\u4e2d\u51fd\u6570\u662f\u4e00\u7b49\u516c\u6c11\uff0c\u51fd\u6570\u7c7b\u578b\u4e5f\u662f\u4e00\u7b49\u7684\u6570\u636e\u7c7b\u578b\u3002\u8fd9\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u7684\u91cd\u8981\u7279\u5f81\uff0cGo\u8bed\u8a00\u5728\u8bed\u8a00\u5c42\u9762\u652f\u6301\u51fd\u6570\u5f0f\u7f16\u7a0b\u3002 \u51fd\u6570\u7684\u7528\u9014\uff1a \u5c01\u88c5\u4ee3\u7801\u3001\u5206\u5272\u529f\u80fd\u3001\u89e3\u8026\u903b\u8f91 \u4f5c\u4e3a\u666e\u901a\u51fd\u6570\u503c\uff0c\u5728\u5176\u4ed6\u51fd\u6570\u4e4b\u95f4\u4f20\u9012\u3001\u8d4b\u503c\u53d8\u91cf\u3001\u505a\u7c7b\u578b\u5224\u65ad\u548c\u8f6c\u6362\uff08\u5c31\u50cf\u5207\u7247\u6216\u5b57\u5178\uff09 \u51fd\u6570\u503c\u53ef\u4ee5\u6210\u4e3a\u88ab\u968f\u610f\u4f20\u64ad\u7684\u72ec\u7acb\u903b\u8f91\u7ec4\u4ef6\uff08\u529f\u80fd\u6a21\u5757\uff09 \u3002 \u5bf9\u4e8e\u51fd\u6570\u7c7b\u578b\u6765\u8bf4\uff0c\u5b83\u662f\u4e00\u79cd\u5bf9\u4e00\u7ec4\u8f93\u5165\u3001\u8f93\u51fa\u8fdb\u884c\u6a21\u677f\u5316\u7684\u91cd\u8981\u5de5\u5177\uff0c\u5b83\u6bd4\u63a5\u53e3\u7c7b\u578b\u66f4\u52a0\u8f7b\u5de7\u3001\u7075\u6d3b\uff0c\u5b83\u7684\u503c\u4e5f\u501f\u6b64\u53d8\u6210\u4e86\u53ef\u88ab\u70ed\u66ff\u6362\u7684\u903b\u8f91\u7ec4\u4ef6\u3002 package main import fmt type Printer func(contents string) (n int, err error) // \u58f0\u660e\u51fd\u6570\u7c7b\u578b func printToStd(contents string) (bytesNum int, err error) { // \u5b9e\u73b0\u4e86\u51fd\u6570\u7c7b\u578bPrinter return fmt.Println(contents) } func main() { var p Printer p = printToStd p( something ) } \u51fd\u6570\u7684\u7b7e\u540d\u5305\u62ec\uff1a\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u548c\u51fd\u6570\u7684\u7ed3\u679c\u5217\u8868\uff0c\u5b83\u5b9a\u4e49\u4e86\u7528\u6765\u9274\u522b\u4e0d\u540c\u51fd\u6570\u7684\u7279\u5f81\uff0c\u4e5f\u5b9a\u4e49\u4e86\u4e0e\u51fd\u6570\u7684\u4ea4\u4e92\u65b9\u5f0f\u3002 \u51fd\u6570\u7b7e\u540d\u4e2d\u5143\u7d20\u987a\u5e8f\u53ca\u7c7b\u578b\u4e00\u81f4\uff0c\u90a3\u4e48\u5c31\u662f\u540c\u4e00\u4e2a\u51fd\u6570\uff0c\u6216\u662f\u5b9e\u73b0\u4e86\u540c\u4e00\u4e2a\u51fd\u6570\u7c7b\u578b\u7684\u51fd\u6570 \u3002","title":"\u51fd\u6570"},{"location":"Language/Basic/09-\u51fd\u6570/#_2","text":"\u9ad8\u9636\u51fd\u6570\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a \u63a5\u6536\u5176\u4ed6\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165 \u628a\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de \u53ea\u8981\u6ee1\u8db3\u5176\u4e2d\u4e00\u4e2a\u6761\u4ef6\u5c31\u662f\u9ad8\u9636\u51fd\u6570\uff0c\u9ad8\u9636\u51fd\u6570\u4e5f\u662f\u51fd\u6570\u5f0f\u7f16\u7a0b\u4e2d\u91cd\u8981\u7684\u6982\u5ff5\u548c\u7279\u5f81 \u3002 \u9ad8\u9636\u51fd\u6570\u53ef\u7528\u4e8e\u5b9e\u73b0\u95ed\u5305\u3002 \u9700\u6c42\uff1a\u7f16\u5199calculate\u51fd\u6570\u6765\u5b9e\u73b0\u4e24\u4e2a\u6574\u6570\u95f4\u7684\u52a0\u51cf\u4e58\u9664\u8fd0\u7b97\uff0c\u5e0c\u671b\u4e24\u4e2a\u6574\u6570\u548c\u5177\u4f53\u7684\u64cd\u4f5c\u90fd\u7531\u8be5\u51fd\u6570\u7684\u8c03\u7528\u65b9\u7ed9\u51fa\u3002 \u4f8b\u5b50\uff1a \u63a5\u6536\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u53c2\u6570\u4f20\u5165\u3002 // \u7b2c\u4e00\u6b65\uff1a\u58f0\u660e\u53eboperator\u7684\u51fd\u6570\u7c7b\u578b type operator func(x,y int) int // \u7b2c\u4e8c\u6b65:\u7f16\u5199calculate\u51fd\u6570 func calculate(x int,y int, op operator)(int, error){ if op == nil { // \u536b\u8ff0\u8bed\u53e5\uff0c\u5224\u65ad\u64cd\u4f5c\u662f\u5426\u5408\u6cd5 return 0 errors.New( invalid operation! ) } return op(x,y),nil } // \u5b9e\u73b0operator\uff0c\u53ea\u8981\u51fd\u6570\u7684\u7b7e\u540d\u4e0eoperator\u7c7b\u578b\u4e00\u81f4\u5c31\u662f\u5b83\u7684\u5b9e\u73b0 op := func(x, y int) int { return x + y } func main(){ x,y = 12,23 result,err := calculate(x,y,op)) } \u536b\u8ff0\u8bed\u53e5\uff1a\u88ab\u7528\u6765\u68c0\u67e5\u5173\u952e\u7684\u5148\u51b3\u6761\u4ef6\u7684\u5408\u6cd5\u6027\uff0c\u5e76\u5728\u68c0\u67e5\u672a\u901a\u8fc7\u7684\u60c5\u51b5\u4e0b\u7acb\u5373\u7ec8\u6b62\u5f53\u524d\u4ee3\u7801\u5757\u7684\u6267\u884c\u7684\u8bed\u53e5\u3002Go\u8bed\u8a00\u4e2dif\u8bed\u53e5\u5e38\u88ab\u4f5c\u4e3a\u536b\u8ff0\u8bed\u53e5\u3002 \u4f8b\u5b50\uff1a \u628a\u5176\u4ed6\u7684\u51fd\u6570\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 // \u7b2c\u4e00\u6b65\uff1a\u58f0\u660e\u53eboperator\u548ccalculateFunc\u7684\u51fd\u6570\u7c7b\u578b type operator func(x,y int) int type calculateFunc func(x int,y int)(int,err) // \u7b2c\u4e8c\u6b65\uff1a\u7f16\u5199genCalculator\u51fd\u6570 func genCalculator(op operate) calculateFunc{ return func(x int,y int)(int, error){ if op == nil{ // \u536b\u8ff0\u8bed\u53e5 return 0, errors.New( invalid operation! ) } return op(x,y),nil } } // \u5b9e\u73b0operator op := func(x, y int) int { return x + y } func main(){ x,y = 56,78 add := genCalculator(op) result,err = add(x,y) }","title":"\u7f16\u5199\u9ad8\u9636\u51fd\u6570"},{"location":"Language/Basic/09-\u51fd\u6570/#_3","text":"\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\u5b58\u5728\u5bf9\u5916\u6765\u6807\u8bc6\u7b26\uff08\u65e2\u4e0d\u4ee3\u8868\u5f53\u524d\u51fd\u6570\u7684\u4efb\u4f55\u53c2\u6570\u6216\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f\u51fd\u6570\u5185\u90e8\u58f0\u660e\u7684\uff0c\u800c\u662f\u76f4\u63a5\u4ece\u5916\u8fb9\u62ff\u6765\u7684\uff09\u7684\u5f15\u7528\uff0c\u4e5f\u79f0\u4e3a \u81ea\u7531\u53d8\u91cf \u3002\u8fd9\u91cc\u7684\u51fd\u6570\u79f0\u4e3a\u95ed\u5305\u51fd\u6570\uff0c\u5c31\u662f\u56e0\u4e3a\u5f15\u7528\u4e86\u81ea\u7531\u53d8\u91cf\uff0c\u800c\u5448\u73b0\u51fa\u4e86\u4e00\u79cd\u201d\u4e0d\u786e\u5b9a\u201c\u7684\u72b6\u6001\uff08\u5f00\u653e\u72b6\u6001\uff09\u3002 \u95ed\u5305\u4f53\u73b0\u7684\u662f\u7531\u201d\u4e0d\u786e\u5b9a\u201c\u53d8\u4e3a\u201d\u786e\u5b9a\u201c\u7684\u4e00\u4e2a\u8fc7\u7a0b\u3002\u5bf9\u4e8eGo\u8fd9\u6837\u7684\u9759\u6001\u7c7b\u578b\u8bed\u8a00\uff0c\u5728\u5b9a\u4e49\u7684\u95ed\u5305\u51fd\u6570\u7684\u65f6\u5019\uff0c\u6700\u591a\u53ea\u80fd\u77e5\u9053\u81ea\u7531\u53d8\u91cf\u7684\u7c7b\u578b\u3002 \u4f8b\u5b50\uff1a func genCalculator(op operate) calculateFunc { return func(x int, y int) (int, error) { if op == nil { return 0, errors.New( invalid operation ) } return op(x, y), nil } } genCalculator\u53ea\u505a\u4e86\u4e00\u4ef6\u4e8b\uff0c\u5b9a\u4e49\u4e00\u4e2a\u533f\u540d\u7684calculateFunc\u7c7b\u578b\u7684\u51fd\u6570\uff0c\u5e76\u628a\u5b83\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002\u8fd9\u4e2a\u533f\u540d\u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u95ed\u5305\u51fd\u6570\u3002\u5b83\u4f7f\u7528\u7684\u53d8\u91cfop\u65e2\u4e0d\u4ee3\u8868\u5b83\u7684\u4efb\u4f55\u53c2\u6570\u6216\u7ed3\u679c\uff0c\u4e5f\u4e0d\u662f\u5b83\u81ea\u5df1\u58f0\u660e\u7684\uff0c\u800c\u662f\u5b9a\u4e49\u5b83\u7684genCalculator\u51fd\u6570\u7684\u53c2\u6570\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u81ea\u7531\u53d8\u91cf\uff08\u8fd9\u4e2a\u81ea\u7531\u53d8\u91cf\u4e0d\u662f\u5728\u5b9a\u4e49\u95ed\u5305\u51fd\u6570\u7684\u65f6\u5019\u786e\u5b9a\u7684\uff0c\u800c\u662f\u5728genCalculator\u51fd\u6570\u88ab\u8c03\u7528\u7684\u65f6\u5019\u786e\u5b9a\u7684\uff09\u3002 \u53ea\u6709\u7ed9\u5b9a\u4e86\u8be5\u51fd\u6570\u7684\u53c2\u6570op\uff0c\u624d\u77e5\u9053\u95ed\u5305\u51fd\u6570\u53ef\u7528\u4e8e\u58f0\u660e\u8fd0\u7b97 \u3002 \u7f16\u8bd1\u5230 if op == nill \u8bed\u53e5\u65f6\uff0cGo\u7f16\u8bd1\u5668\u4e0a\u5929\u5bfb\u627eop\u6240\u4ee3\u8868\u7684\u4e1c\u897f\uff0c\u53d1\u73b0op\u4ee3\u8868\u7684\u662fgenCalculator\u51fd\u6570\u7684\u53c2\u6570\uff0c\u7136\u540e\u628a\u8fd9\u4e24\u8005\u8054\u7cfb\u8d77\u6765\uff0c\u6b64\u65f6\u81ea\u7531\u53d8\u91cfop\u88ab\u6355\u83b7\uff0c\u8fd9\u4e2a\u95ed\u5305\u51fd\u6570\u7684\u72b6\u6001\u7531\u201d\u4e0d\u786e\u5b9a\u201c\u53d8\u4e3a\u201d\u786e\u5b9a\u201c\u3002 \u95ed\u5305\u7684\u7528\u9014\uff1a\u8868\u9762\u4e0a\u662f\u5ef6\u8fdf\u5b9e\u73b0\u4e86\u4e00\u90e8\u5206\u7a0b\u5e8f\u903b\u8f91\u6216\u529f\u80fd\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u52a8\u6001\u5730\u751f\u6210\u90a3\u90e8\u5206\u7a0b\u5e8f\u903b\u8f91 \u3002","title":"\u95ed\u5305"},{"location":"Language/Basic/09-\u51fd\u6570/#_4","text":"package main import fmt func main() { array1 := [3]string{ a , b , c } fmt.Printf( The array: %v\\n , array1) array2 := modifyArray(array1) fmt.Printf( The modified array: %v\\n , array2) // The modified array: [a x c] fmt.Printf( The original array: %v\\n , array1) // The original array: [a b c] } func modifyArray(a [3]string) [3]string { a[1] = x return a } \u539f\u6570\u7ec4\u6ca1\u6709\u56e0\u4e3a modifyArray() \u51fd\u6570\u800c\u6539\u53d8\uff0c\u56e0\u4e3a \u6240\u6709\u4f20\u7ed9\u51fd\u6570\u7684\u53c2\u6570\u503c\u90fd\u4f1a\u88ab\u590d\u5236 \uff0c\u51fd\u6570\u5728\u5176\u5185\u90e8\u4f7f\u7528\u7684\u5e76\u4e0d\u662f\u53c2\u6570\u503c\u7684\u539f\u503c\uff0c\u800c\u662f\u5b83\u7684\u526f\u672c\u3002 \u6570\u7ec4\u662f\u503c\u7c7b\u578b\uff0c\u6240\u4ee5\u6bcf\u6b21\u590d\u5236\u90fd\u4f1a\u62f7\u8d1d\u5b83\uff0c\u4ee5\u53ca\u5b83\u7684\u6240\u6709\u5143\u7d20\u503c\u3002 \u5bf9\u4e8e\u5f15\u7528\u7c7b\u578b\uff08\u5207\u7247\u3001\u5b57\u5178\u3001\u901a\u9053\uff09\uff0c\u590d\u5236\u503c\u7684\u65f6\u5019\uff0c\u53ea\u4f1a\u62f7\u8d1d\u5b83\u672c\u8eab\uff0c\u5e76\u4e0d\u4f1a\u62f7\u8d1d\u5b83\u5f15\u7528\u7684\u5e95\u5c42\u6570\u636e \u3002\u4ee5\u5207\u7247\u4e3a\u4f8b\uff0c\u53ea\u662f\u62f7\u8d1d\u4e86\u5b83\u6307\u5411\u5e95\u5c42\u6570\u7ec4\u4e2d\u67d0\u4e00\u4e2a\u5143\u7d20\u7684\u6307\u9488\uff0c\u4ee5\u53ca\u5b83\u7684\u957f\u5ea6\u503c\u548c\u5bb9\u91cf\u503c\uff0c\u5e95\u5c42\u6570\u7ec4\u5e76\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u3002","title":"\u4f20\u5165\u51fd\u6570\u7684\u53c2\u6570\u503c"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/","text":"\u7ed3\u6784\u4f53\u7c7b\u578b \u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\u5305\u542b\u82e5\u5e72\u4e2a\u5b57\u6bb5\u3001\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u9700\u8981\u6709\u786e\u5207\u7684\u540d\u5b57\u548c\u7c7b\u578b\u3002\u7ed3\u6784\u4f53\u7c7b\u578b\u4e5f\u53ef\u4ee5\u4e0d\u5305\u542b\u4efb\u4f55\u5b57\u6bb5\uff0c\u8fd9\u5e76\u4e0d\u662f\u6ca1\u6709\u610f\u4e49\uff0c\u53ef\u4ee5\u7ed9\u7ed3\u6784\u4f53\u7c7b\u578b\u5173\u8054\u4e0a\u4e00\u4e9b\u65b9\u6cd5\uff0c\u628a\u65b9\u6cd5\u770b\u505a\u662f\u51fd\u6570\u7684\u7279\u6b8a\u7248\u672c\u3002 \u51fd\u6570\u662f\u72ec\u7acb\u7684\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u53ef\u4ee5\u58f0\u660e\u6709\u540d\u5b57\u7684\u51fd\u6570\u6216\u8005\u533f\u540d\u51fd\u6570\uff0c\u8fd8\u53ef\u4ee5\u628a\u51fd\u6570\u5f53\u505a\u503c\u4f20\u9012\u3002 \u53ef\u4ee5\u628a\u5177\u6709\u76f8\u540c\u7b7e\u540d\u7684\u51fd\u6570\u62bd\u8c61\u6210\u72ec\u7acb\u7684\u51fd\u6570\u7c7b\u578b\uff0c\u4f5c\u4e3a\u4e00\u7ec4\u8f93\u5165\u3001\u8f93\u51fa\u7684\u4ee3\u8868 \u3002 \u65b9\u6cd5\u4e0e\u51fd\u6570\u4e0d\u540c\uff0c\u5b83\u9700\u8981\u6709\u540d\u5b57\uff0c\u4e0d\u80fd\u88ab\u5f53\u505a\u503c\u6765\u770b\u5f85\uff0c \u6700\u91cd\u8981\u7684\u662f\uff0c\u5b83\u5fc5\u987b\u96b6\u5c5e\u4e8e\u67d0\u4e00\u4e2a\u7c7b\u578b \u3002\u65b9\u6cd5\u6240\u5c5e\u7684\u7c7b\u578b\u4f1a\u901a\u8fc7\u5176\u58f0\u660e\u4e2d\u7684 \u63a5\u6536\u8005\u58f0\u660e \u4f53\u73b0\u51fa\u6765\u3002 \u63a5\u6536\u8005\u58f0\u660e \u5c31\u662f\u5728\u5173\u952e\u5b57func\u548c\u65b9\u6cd5\u540d\u4e4b\u95f4\u7684\u5706\u62ec\u53f7\u5305\u88f9\u8d77\u6765\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u786e\u5207\u7684\u540d\u79f0\u548c\u7c7b\u578b\u5b57\u9762\u91cf\u3002 \u4f8b\u5b50\uff1a // AnimalCategory \u4ee3\u8868\u52a8\u7269\u5206\u7c7b\u5b66\u4e2d\u7684\u57fa\u672c\u5206\u7c7b\u6cd5 type AnimalCategory struct { kingdom string // \u754c phylum string // \u95e8 class string // \u7eb2 order string // \u76ee family string // \u79d1 genus string // \u5c5e species string // \u79cd } // \u96b6\u5c5e\u4e8eAnimalCategory\u7c7b\u578b\u7684\u65b9\u6cd5 String()\uff0c\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u662fac func (ac AnimalCategory) String() string { return fmt.Sprintf( %s%s%s%s%s%s%s , ac.kingdom, ac.phylum, ac.class, ac.order, ac.family, ac.genus, ac.species) } // \u901a\u8fc7\u65b9\u6cd5\u7684\u63a5\u6536\u8005ac\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u5f15\u7528\u5230\u5f53\u524d\u503c\u7684\u4efb\u4f55\u4e00\u4e2a\u5b57\u6bb5\uff0c // \u6216\u8005\u8c03\u7528\u5f53\u524d\u503c\u7684\u4efb\u4f55\u4e00\u4e2a\u65b9\u6cd5\uff08\u5305\u62ecstring\u65b9\u6cd5\u81ea\u5df1\uff09 func main(){ category := AnimalCategory{species: cat } fmt.Printf( The animal category: %s\\n ,category) // \u65e0\u9700\u663e\u793a\u8c03\u7528String\u65b9\u6cd5\uff0c\u5373\u53ef\u6253\u5370\u51fa\u8be5\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f } \u5728Go\u8bed\u8a00\u4e2d\uff0c\u901a\u8fc7\u4e3a\u4e00\u4e2a\u7c7b\u578b\u7f16\u5199\u540d\u4e3aString\u7684\u65b9\u6cd5\uff0c\u6765\u81ea\u5b9a\u4e49\u8be5\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f \u3002\u8fd9\u4e2aString\u65b9\u6cd5\u4e0d\u9700\u8981\u4efb\u4f55\u53c2\u6570\u58f0\u660e\uff0c\u4f46\u662f\u9700\u8981\u6709\u4e00\u4e2astring\u7c7b\u578b\u7684\u7ed3\u679c\u8f93\u51fa\u3002 \u65b9\u6cd5\u96b6\u5c5e\u7684\u7c7b\u578b\u4e0d\u5c40\u9650\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u4f46\u5fc5\u987b\u662f\u67d0\u4e2a \u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7c7b\u578b \uff0c\u5e76\u4e14\u4e0d\u80fd\u662f\u4efb\u4f55\u63a5\u53e3\u7c7b\u578b\u3002 \u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u5173\u8054\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u5171\u540c\u7ec4\u6210\u4e86\u8be5\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408 \u540c\u4e00\u4e2a\u65b9\u6cd5\u96c6\u5408\u4e2d\u7684\u65b9\u6cd5\u4e0d\u80fd\u51fa\u73b0\u91cd\u540d\uff0c\u4e14\u4e0d\u80fd\u4e0e\u8be5\u7c7b\u578b\u4e2d\u4efb\u4f55\u5b57\u6bb5\u7684\u540d\u79f0\u91cd\u590d \u5d4c\u5165\u5b57\u6bb5 \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u4e3b\u8981\u539f\u5219\uff1a\u5c06\u6570\u636e\u53ca\u5176\u64cd\u4f5c\u5c01\u88c5\u5728\u4e00\u8d77\u3002\u5728Go\u8bed\u8a00\u4e2d\uff0c\u628a\u7ed3\u6784\u4f53\u7c7b\u578b\u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\u770b\u4f5c\u662f\u4e00\u9879\u6570\u636e\uff0c\u628a\u96b6\u5c5e\u5b83\u7684\u65b9\u6cd5\u770b\u4f5c\u662f\u9644\u52a0\u5728\u5176\u4e2d\u6570\u636e\u4e4b\u4e0a\u7684\u64cd\u4f5c\u3002 \u4f8b\u5b50\uff1a type Animal struct { scientificName string // \u5b66\u540d\u3002 AnimalCategory // \u52a8\u7269\u57fa\u672c\u5206\u7c7b\u3002 } // \u5728\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u67d0\u4e2a\u5b57\u6bb5\u58f0\u660e\u4e2d\u53ea\u6709\u4e00\u4e2a\u7c7b\u578b\u540d\uff0c\u5219\u5c06\u539f\u7c7b\u578b\u5d4c\u5165\u5230\u65b0\u7684\u7c7b\u578b\u4e2d Go\u8bed\u8a00\u89c4\u8303\u89c4\u5b9a\uff0c\u5982\u679c\u4e00\u4e2a\u5b57\u6bb5\u7684\u58f0\u660e\u4e2d\u53ea\u6709\u5b57\u6bb5\u7684\u7c7b\u578b\u540d\uff0c\u6ca1\u6709\u5b57\u6bb5\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u4e2a\u5d4c\u5165\u5b57\u6bb5\uff08\u4e5f\u79f0\u4e3a\u533f\u540d\u5b57\u6bb5\uff09\u3002\u901a\u8fc7\u6b64\u7c7b\u578b\u53d8\u91cf\u7684\u540d\u79f0\u540e\u8ddf\u7740\u201c.\u201d\uff0c\u5728\u8ddf\u7740\u5d4c\u5165\u5b57\u6bb5\u7c7b\u578b\u7684\u65b9\u5f0f\u5f15\u7528\u5230\u8be5\u5b57\u6bb5\uff0c\u5373\u5d4c\u5165\u5b57\u6bb5\u7684\u7c7b\u578b\u65e2\u662f\u7c7b\u578b\u4e5f\u4f1a\u540d\u79f0\u3002\u4f8b\u5982\u4e0b\u9762\u7684 a.AnimalCategory \u3002 func (a Animal) Category() string { return a.AnimalCategory.String() } // Category\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u662fAnimal\uff0c\u63a5\u6536\u8005\u540d\u79f0a\uff0c // \u901a\u8fc7a.AnimalCategory\u9009\u62e9\u5230a\u7684\u5d4c\u5165\u5b57\u6bb5 \u9009\u62e9\u8868\u8fbe\u5f0f\uff1a\u5728\u67d0\u4e2a\u4ee3\u8868\u53d8\u91cf\u7684\u6807\u8bc6\u7b26\u7684\u53f3\u8fb9\u52a0\u4e0a\u201c.\u201d\uff0c\u5728\u52a0\u4e0a\u5b57\u6bb5\u540d\u6216\u65b9\u6cd5\u540d\uff0c\u8868\u793a\u9009\u62e9\u4e86\u67d0\u4e2a\u5b57\u6bb5\u6216\u65b9\u6cd5 \u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u6cd5\u96c6\u5408\u4f1a\u88ab\u65e0\u6761\u4ef6\u5730\u5408\u5e76\u8fdb\u88ab\u5d4c\u5165\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d \u3002 animal := Animal{ scientificName: American Shorthair , AnimalCategory: category, } fmt.Printf( The animal: %s\\n , animal) // \u6b64\u65f6\u4f1a\u76f4\u63a5\u8c03\u7528AnimalCategory\u7684String\u65b9\u6cd5 \u5982\u679cAnimal\u4e5f\u7f16\u5199\u81ea\u5df1\u7684String\u65b9\u6cd5\uff0c\u90a3\u4e48\u5d4c\u5165\u5b57\u6bb5\u7684String\u4f1a\u88ab\u5c4f\u853d\u3002 \u53ea\u8981\u540d\u79f0\u76f8\u540c\uff0c\u65e0\u8bba\u65b9\u6cd5\u7684\u7b7e\u540d\u662f\u5426\u4e00\u81f4\uff0c\u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u6cd5\u90fd\u4f1a\u88ab\u5c4f\u853d \u3002 \u56e0\u4e3a\u5d4c\u5165\u5b57\u6bb5\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5\u90fd\u53ef\u4ee5\u201c\u5ac1\u63a5\u201d\u5230\u88ab\u5d4c\u5165\u7c7b\u578b\u4e0a\uff0c\u6240\u4ee5\u5373\u4f7f\u5728\u4e24\u4e2a\u540c\u540d\u7684\u6210\u5458\u4e00\u4e2a\u662f\u5b57\u6bb5\uff0c\u53e6\u4e00\u4e2a\u662f\u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c\u5c4f\u853d\u73b0\u8c61\u4f9d\u7136\u5b58\u5728\u3002\u901a\u8fc7\u94fe\u5f0f\u9009\u62e9\u8868\u8fbe\u5f0f\u9009\u62e9\u88ab\u5c4f\u853d\u7684\u5d4c\u5165\u5b57\u6bb5\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\u3002 \u591a\u5c42\u5d4c\u5165 \u4f8b\u5b50\uff1a type Cat struct { name string Animal // \u5d4c\u5165\u5b57\u6bb5\u672c\u8eab\u4e5f\u662f\u5d4c\u5165\u5b57\u6bb5 } func (cat Cat) String() string { return fmt.Sprintf( %s (category: %s, name: %q) , cat.scientificName, cat.Animal.AnimalCategory, cat.name) } \u5c4f\u853d\u73b0\u8c61\u4f1a\u4ee5\u5d4c\u5165\u7684\u5c42\u7ea7\u4e3a\u4f9d\u636e\uff0c\u5d4c\u5165\u7684\u5c42\u7ea7\u8d8a\u6df1\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\u8d8a\u53ef\u80fd\u88ab\u5c4f\u853d\u3002\u5982\uff0c\u8c03\u7528Cat\u7684String\u65b9\u6cd5\uff1a \u72b6\u6001 Cat Animal AnimalCategory 1 \u5b58\u5728\uff0c\u8c03\u7528 \u5c4f\u853d \u5c4f\u853d 2 \u4e0d\u5b58\u5728 \u8c03\u7528 \u5c4f\u853d 3 \u4e0d\u5b58\u5728 \u4e0d\u5b58\u5728 \u8c03\u7528 \u6839\u636e\u662f\u5426\u5b58\u5728String\u65b9\u6cd5\uff0c\u6765\u5224\u65ad\u5d4c\u5165\u5b57\u6bb5\u7684String\u65b9\u6cd5\u662f\u5426\u4f1a\u88ab\u8c03\u7528\u4f1a\u5c4f\u853d\u3002 \u5982\u679c\u5904\u4e8e\u540c\u4e00\u5c42\u7ea7\u7684\u591a\u4e2a\u5d4c\u5165\u5b57\u6bb5\u6709\u7528\u540c\u540d\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\uff0c\u90a3\u4e48\u4ece\u88ab\u5d4c\u5165\u7c7b\u578b\u7684\u503c\u90a3\u91cc\u9009\u62e9\u6b64\u540d\u79f0\u65f6\uff0c\u4f1a\u5f15\u53d1\u7f16\u8bd1\u9519\uff0c\u7f16\u8bd1\u5668\u65e0\u6cd5\u786e\u5b9a\u88ab\u9009\u62e9\u7684\u6210\u5458\u5230\u5e95\u662f\u54ea\u4e00\u4e2a \u3002 \u7c7b\u578b\u7ec4\u5408 Go\u8bed\u8a00\u4e2d\u4e0d\u5b58\u5728\u7ee7\u627f\u7684\u6982\u5ff5\uff0c\u5b83\u901a\u8fc7\u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u7c7b\u578b\u4e4b\u95f4\u7684\u7ec4\u5408\u3002 \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u7684\u96c6\u6210\uff0c\u901a\u8fc7\u727a\u7272\u4e00\u5b9a\u7684\u4ee3\u7801\u7b80\u6d01\u6027\u6765\u6362\u53d6\u53ef\u6269\u5c55\u6027\uff0c\u8fd9\u79cd\u53ef\u6269\u5c55\u6027\u662f\u901a\u8fc7\u4fb5\u5165\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684 \u3002 \u7c7b\u578b\u4e4b\u95f4\u7684\u7ec4\u5408\u91c7\u7528\u7684\u662f\u975e\u58f0\u660e\u7684\u65b9\u5f0f\uff0c\u662f\u975e\u4fb5\u5165\u5f0f\u7684\uff0c\u5b83\u4e0d\u4f1a\u7834\u574f\u7c7b\u578b\u7684\u5c01\u88c5\u6216\u52a0\u91cd\u7c7b\u578b\u4e4b\u95f4\u7684\u8026\u5408\u3002\u6211\u4eec\u53ea\u662f\u628a\u7c7b\u578b\u5f53\u505a\u5b57\u6bb5\u5d4c\u5165\u8fdb\u6765\uff0c\u7136\u540e\u5750\u4eab\u5176\u6210\u5730\u4f7f\u7528\u5d4c\u5165\u5b57\u6bb5\u6240\u62e5\u6709\u7684\u4e00\u5207\u3002\u540c\u65f6\u53ef\u4ee5\u901a\u8fc7\u201c\u5305\u88c5\u201d\u6216\u201c\u5c4f\u853d\u201d\u7684\u65b9\u5f0f\u6765\u8c03\u6574\u6216\u4f18\u5316\u5d4c\u5165\u5b57\u6bb5\u3002 \u7c7b\u578b\u7ec4\u5408\u975e\u5e38\u7075\u6d3b\u7684\u901a\u8fc7\u5d4c\u5165\u5b57\u6bb5\u628a\u4e00\u4e2a\u7c7b\u578b\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u201c\u5ac1\u63a5\u201d\u7ed9\u53e6\u4e00\u4e2a\u7c7b\u578b\uff0c\u88ab\u5d4c\u5165\u7c7b\u578b\u81ea\u7136\u7684\u5b9e\u73b0\u4e86\u5d4c\u5165\u5b57\u6bb5\u6240\u5b9e\u73b0\u7684\u63a5\u53e3\u3002 \u7ec4\u5408\u6bd4\u7ee7\u627f\u66f4\u52a0\u7b80\u6d01\u548c\u6e05\u6670\uff0c\u4e0d\u4f1a\u6709\u591a\u91cd\u7ee7\u627f\u90a3\u6837\u8d1f\u8d23\u7684\u5c42\u6b21\u7ed3\u6784\u548c\u53ef\u89c2\u7684\u7ba1\u7406\u6210\u672c \u3002 \u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u4e5f\u53ef\u4ee5\u7ec4\u5408\uff0c\u4ee5\u6b64\u6765\u6269\u5c55\u63a5\u53e3\u5b9a\u4e49\u7684\u578b\u53f7\u6216\u8005\u6807\u8bb0\u63a5\u53e3\u7684\u7279\u5f81\u3002 \u503c\u65b9\u6cd5\u4e0e\u6307\u9488\u65b9\u6cd5 \u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u5fc5\u987b\u662f\u67d0\u4e2a\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u80fd\u662f\u63a5\u53e3\u7c7b\u578b\u6216\u8005\u63a5\u53e3\u7684\u6307\u9488\u7c7b\u578b\u3002 \u503c\u65b9\u6cd5\uff1a\u63a5\u6536\u8005\u7c7b\u578b\u662f \u975e\u6307\u9488\u7684 \u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5 \u6307\u9488\u65b9\u6cd5\uff1a\u63a5\u6536\u8005\u7c7b\u578b\u662f\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5 \u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684\u65b9\u6cd5\u90fd\u662f\u503c\u65b9\u6cd5\u3002 \u6307\u9488\u65b9\u6cd5\uff0c\u5982\u4e0b\u4f8b\u5b50\uff1a func (cat *Cat) SetName(name string) { cat.name = name } // SetName\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u662f*Cat\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5 \u53d6\u503c\u8868\u8fbe\u5f0f\uff1a*\u653e\u5728\u4e00\u4e2a\u6307\u9488\u503c\u7684\u5de6\u8fb9\uff0c\u6765\u83b7\u53d6\u8be5\u6307\u9488\u6307\u5411\u7684\u57fa\u672c\u7c7b\u578b\u503c \u53d6\u5730\u5740\u8868\u8fbe\u5f0f\uff1a \u653e\u5728\u4e00\u4e2a\u53ef\u5bfb\u5740\u7684\u57fa\u672c\u7c7b\u578b\u503c\u7684\u5de6\u8fb9\uff0c\u6765\u83b7\u53d6\u8be5\u57fa\u672c\u7c7b\u578b\u7684\u6307\u9488\u503c \u503c\u65b9\u6cd5\u4e0e\u6307\u9488\u65b9\u6cd5\u7684\u533a\u522b\uff1a \u5dee\u522b \u503c\u65b9\u6cd5 \u6307\u9488\u65b9\u6cd5 \u65b9\u6cd5\u63a5\u6536\u8005 \u8be5\u65b9\u6cd5\u6240\u5c5e\u7684\u90a3\u4e2a\u7c7b\u578b\u503c\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u503c\u65b9\u6cd5\u5185\u5bf9\u8be5\u526f\u672c\u7684\u4fee\u6539\u4e0d\u4f1a\u4f53\u73b0\u5728\u539f\u503c\u4e0a\uff0c \u9664\u975e\u8fd9\u4e2a\u7c7b\u578b\u672c\u8eab\u662f\u67d0\u4e2a\u5f15\u7528\u7c7b\u578b\u7684\u522b\u540d\u7c7b\u578b \u8be5\u65b9\u6cd5\u6240\u5c5e\u7684\u90a3\u4e2a\u57fa\u672c\u7c7b\u578b\u503c\u7684\u6307\u9488\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u6307\u9488\u65b9\u6cd5\u5185\u5bf9\u8be5\u526f\u672c\u7684\u4fee\u6539\u4f1a\u76f4\u63a5\u4f53\u73b0\u5728\u539f\u503c\u4e0a \u65b9\u6cd5\u96c6\u5408 \u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u4ec5\u5305\u542b\u6240\u6709\u503c\u65b9\u6cd5 \u8be5\u7c7b\u578b\u7684\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u5305\u62ec\u6240\u6709\u7684\u503c\u65b9\u6cd5\u548c\u6307\u9488\u65b9\u6cd5 \u65b9\u6cd5\u96c6\u5408\u7684\u89e3\u91ca\uff1a\u4e25\u683c\u6765\u8bf4\uff0c\u57fa\u672c\u7c7b\u578b\u7684\u503c\u4e0a\u4e4b\u53ea\u80fd\u8c03\u7528\u5b83\u7684\u503c\u65b9\u6cd5\uff0c\u4f46\uff0cGo\u8bed\u8a00\u4f1a\u9002\u65f6\u5730\u4e3a\u6211\u4eec\u8fdb\u884c\u81ea\u52a8\u5730\u8f6c\u8bd1\uff0c\u4f7f\u5f97\u6211\u4eec\u5728\u8fd9\u6837\u7684\u503c\u4e0a\u4e5f\u80fd\u8c03\u7528\u5b83\u7684\u6307\u9488\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c cat.SetName(\"monster\") \u4f1a\u81ea\u52a8\u8f6c\u8bd1\u4e3a ( cat).SetName(\"monster\") \uff0c\u5373\u5148\u53d6cat\u7684\u6307\u9488\u503c\uff0c\u7136\u540e\u5728\u6307\u9488\u503c\u4e0a\u8c03\u7528\u6307\u9488\u65b9\u6cd5SetName\u3002 \u4e00\u4e2a\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u6709\u54ea\u4e9b\u65b9\u6cd5\u4e0e\u5b83\u80fd\u5b9e\u73b0\u54ea\u4e9b\u63a5\u53e3\u7c7b\u578b\u662f\u606f\u606f\u76f8\u5173\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u57fa\u672c\u7c7b\u578b\u548c\u5b83\u7684\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u662f\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5b83\u4eec\u5177\u4f53\u5b9e\u73b0\u7684\u63a5\u53e3\u7c7b\u578b\u7684\u6570\u91cf\u4e5f\u4f1a\u6709\u5dee\u5f02\uff0c\u9664\u975e\u4e24\u4e2a\u6570\u91cf\u90fd\u662f\u96f6\u3002","title":"\u7ed3\u6784\u4f53\u7c7b\u578b"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/#_1","text":"\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\u5305\u542b\u82e5\u5e72\u4e2a\u5b57\u6bb5\u3001\u6bcf\u4e2a\u5b57\u6bb5\u90fd\u9700\u8981\u6709\u786e\u5207\u7684\u540d\u5b57\u548c\u7c7b\u578b\u3002\u7ed3\u6784\u4f53\u7c7b\u578b\u4e5f\u53ef\u4ee5\u4e0d\u5305\u542b\u4efb\u4f55\u5b57\u6bb5\uff0c\u8fd9\u5e76\u4e0d\u662f\u6ca1\u6709\u610f\u4e49\uff0c\u53ef\u4ee5\u7ed9\u7ed3\u6784\u4f53\u7c7b\u578b\u5173\u8054\u4e0a\u4e00\u4e9b\u65b9\u6cd5\uff0c\u628a\u65b9\u6cd5\u770b\u505a\u662f\u51fd\u6570\u7684\u7279\u6b8a\u7248\u672c\u3002 \u51fd\u6570\u662f\u72ec\u7acb\u7684\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u53ef\u4ee5\u58f0\u660e\u6709\u540d\u5b57\u7684\u51fd\u6570\u6216\u8005\u533f\u540d\u51fd\u6570\uff0c\u8fd8\u53ef\u4ee5\u628a\u51fd\u6570\u5f53\u505a\u503c\u4f20\u9012\u3002 \u53ef\u4ee5\u628a\u5177\u6709\u76f8\u540c\u7b7e\u540d\u7684\u51fd\u6570\u62bd\u8c61\u6210\u72ec\u7acb\u7684\u51fd\u6570\u7c7b\u578b\uff0c\u4f5c\u4e3a\u4e00\u7ec4\u8f93\u5165\u3001\u8f93\u51fa\u7684\u4ee3\u8868 \u3002 \u65b9\u6cd5\u4e0e\u51fd\u6570\u4e0d\u540c\uff0c\u5b83\u9700\u8981\u6709\u540d\u5b57\uff0c\u4e0d\u80fd\u88ab\u5f53\u505a\u503c\u6765\u770b\u5f85\uff0c \u6700\u91cd\u8981\u7684\u662f\uff0c\u5b83\u5fc5\u987b\u96b6\u5c5e\u4e8e\u67d0\u4e00\u4e2a\u7c7b\u578b \u3002\u65b9\u6cd5\u6240\u5c5e\u7684\u7c7b\u578b\u4f1a\u901a\u8fc7\u5176\u58f0\u660e\u4e2d\u7684 \u63a5\u6536\u8005\u58f0\u660e \u4f53\u73b0\u51fa\u6765\u3002 \u63a5\u6536\u8005\u58f0\u660e \u5c31\u662f\u5728\u5173\u952e\u5b57func\u548c\u65b9\u6cd5\u540d\u4e4b\u95f4\u7684\u5706\u62ec\u53f7\u5305\u88f9\u8d77\u6765\u7684\u5185\u5bb9\uff0c\u5176\u4e2d\u5fc5\u987b\u5305\u542b\u786e\u5207\u7684\u540d\u79f0\u548c\u7c7b\u578b\u5b57\u9762\u91cf\u3002 \u4f8b\u5b50\uff1a // AnimalCategory \u4ee3\u8868\u52a8\u7269\u5206\u7c7b\u5b66\u4e2d\u7684\u57fa\u672c\u5206\u7c7b\u6cd5 type AnimalCategory struct { kingdom string // \u754c phylum string // \u95e8 class string // \u7eb2 order string // \u76ee family string // \u79d1 genus string // \u5c5e species string // \u79cd } // \u96b6\u5c5e\u4e8eAnimalCategory\u7c7b\u578b\u7684\u65b9\u6cd5 String()\uff0c\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u662fac func (ac AnimalCategory) String() string { return fmt.Sprintf( %s%s%s%s%s%s%s , ac.kingdom, ac.phylum, ac.class, ac.order, ac.family, ac.genus, ac.species) } // \u901a\u8fc7\u65b9\u6cd5\u7684\u63a5\u6536\u8005ac\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u5f15\u7528\u5230\u5f53\u524d\u503c\u7684\u4efb\u4f55\u4e00\u4e2a\u5b57\u6bb5\uff0c // \u6216\u8005\u8c03\u7528\u5f53\u524d\u503c\u7684\u4efb\u4f55\u4e00\u4e2a\u65b9\u6cd5\uff08\u5305\u62ecstring\u65b9\u6cd5\u81ea\u5df1\uff09 func main(){ category := AnimalCategory{species: cat } fmt.Printf( The animal category: %s\\n ,category) // \u65e0\u9700\u663e\u793a\u8c03\u7528String\u65b9\u6cd5\uff0c\u5373\u53ef\u6253\u5370\u51fa\u8be5\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f } \u5728Go\u8bed\u8a00\u4e2d\uff0c\u901a\u8fc7\u4e3a\u4e00\u4e2a\u7c7b\u578b\u7f16\u5199\u540d\u4e3aString\u7684\u65b9\u6cd5\uff0c\u6765\u81ea\u5b9a\u4e49\u8be5\u7c7b\u578b\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f \u3002\u8fd9\u4e2aString\u65b9\u6cd5\u4e0d\u9700\u8981\u4efb\u4f55\u53c2\u6570\u58f0\u660e\uff0c\u4f46\u662f\u9700\u8981\u6709\u4e00\u4e2astring\u7c7b\u578b\u7684\u7ed3\u679c\u8f93\u51fa\u3002 \u65b9\u6cd5\u96b6\u5c5e\u7684\u7c7b\u578b\u4e0d\u5c40\u9650\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u4f46\u5fc5\u987b\u662f\u67d0\u4e2a \u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7c7b\u578b \uff0c\u5e76\u4e14\u4e0d\u80fd\u662f\u4efb\u4f55\u63a5\u53e3\u7c7b\u578b\u3002 \u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u5173\u8054\u7684\u6240\u6709\u65b9\u6cd5\uff0c\u5171\u540c\u7ec4\u6210\u4e86\u8be5\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408 \u540c\u4e00\u4e2a\u65b9\u6cd5\u96c6\u5408\u4e2d\u7684\u65b9\u6cd5\u4e0d\u80fd\u51fa\u73b0\u91cd\u540d\uff0c\u4e14\u4e0d\u80fd\u4e0e\u8be5\u7c7b\u578b\u4e2d\u4efb\u4f55\u5b57\u6bb5\u7684\u540d\u79f0\u91cd\u590d","title":"\u7ed3\u6784\u4f53\u7c7b\u578b"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/#_2","text":"\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u4e3b\u8981\u539f\u5219\uff1a\u5c06\u6570\u636e\u53ca\u5176\u64cd\u4f5c\u5c01\u88c5\u5728\u4e00\u8d77\u3002\u5728Go\u8bed\u8a00\u4e2d\uff0c\u628a\u7ed3\u6784\u4f53\u7c7b\u578b\u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\u770b\u4f5c\u662f\u4e00\u9879\u6570\u636e\uff0c\u628a\u96b6\u5c5e\u5b83\u7684\u65b9\u6cd5\u770b\u4f5c\u662f\u9644\u52a0\u5728\u5176\u4e2d\u6570\u636e\u4e4b\u4e0a\u7684\u64cd\u4f5c\u3002 \u4f8b\u5b50\uff1a type Animal struct { scientificName string // \u5b66\u540d\u3002 AnimalCategory // \u52a8\u7269\u57fa\u672c\u5206\u7c7b\u3002 } // \u5728\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u67d0\u4e2a\u5b57\u6bb5\u58f0\u660e\u4e2d\u53ea\u6709\u4e00\u4e2a\u7c7b\u578b\u540d\uff0c\u5219\u5c06\u539f\u7c7b\u578b\u5d4c\u5165\u5230\u65b0\u7684\u7c7b\u578b\u4e2d Go\u8bed\u8a00\u89c4\u8303\u89c4\u5b9a\uff0c\u5982\u679c\u4e00\u4e2a\u5b57\u6bb5\u7684\u58f0\u660e\u4e2d\u53ea\u6709\u5b57\u6bb5\u7684\u7c7b\u578b\u540d\uff0c\u6ca1\u6709\u5b57\u6bb5\u7684\u540d\u79f0\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u4e2a\u5d4c\u5165\u5b57\u6bb5\uff08\u4e5f\u79f0\u4e3a\u533f\u540d\u5b57\u6bb5\uff09\u3002\u901a\u8fc7\u6b64\u7c7b\u578b\u53d8\u91cf\u7684\u540d\u79f0\u540e\u8ddf\u7740\u201c.\u201d\uff0c\u5728\u8ddf\u7740\u5d4c\u5165\u5b57\u6bb5\u7c7b\u578b\u7684\u65b9\u5f0f\u5f15\u7528\u5230\u8be5\u5b57\u6bb5\uff0c\u5373\u5d4c\u5165\u5b57\u6bb5\u7684\u7c7b\u578b\u65e2\u662f\u7c7b\u578b\u4e5f\u4f1a\u540d\u79f0\u3002\u4f8b\u5982\u4e0b\u9762\u7684 a.AnimalCategory \u3002 func (a Animal) Category() string { return a.AnimalCategory.String() } // Category\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u662fAnimal\uff0c\u63a5\u6536\u8005\u540d\u79f0a\uff0c // \u901a\u8fc7a.AnimalCategory\u9009\u62e9\u5230a\u7684\u5d4c\u5165\u5b57\u6bb5 \u9009\u62e9\u8868\u8fbe\u5f0f\uff1a\u5728\u67d0\u4e2a\u4ee3\u8868\u53d8\u91cf\u7684\u6807\u8bc6\u7b26\u7684\u53f3\u8fb9\u52a0\u4e0a\u201c.\u201d\uff0c\u5728\u52a0\u4e0a\u5b57\u6bb5\u540d\u6216\u65b9\u6cd5\u540d\uff0c\u8868\u793a\u9009\u62e9\u4e86\u67d0\u4e2a\u5b57\u6bb5\u6216\u65b9\u6cd5 \u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u6cd5\u96c6\u5408\u4f1a\u88ab\u65e0\u6761\u4ef6\u5730\u5408\u5e76\u8fdb\u88ab\u5d4c\u5165\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d \u3002 animal := Animal{ scientificName: American Shorthair , AnimalCategory: category, } fmt.Printf( The animal: %s\\n , animal) // \u6b64\u65f6\u4f1a\u76f4\u63a5\u8c03\u7528AnimalCategory\u7684String\u65b9\u6cd5 \u5982\u679cAnimal\u4e5f\u7f16\u5199\u81ea\u5df1\u7684String\u65b9\u6cd5\uff0c\u90a3\u4e48\u5d4c\u5165\u5b57\u6bb5\u7684String\u4f1a\u88ab\u5c4f\u853d\u3002 \u53ea\u8981\u540d\u79f0\u76f8\u540c\uff0c\u65e0\u8bba\u65b9\u6cd5\u7684\u7b7e\u540d\u662f\u5426\u4e00\u81f4\uff0c\u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u6cd5\u90fd\u4f1a\u88ab\u5c4f\u853d \u3002 \u56e0\u4e3a\u5d4c\u5165\u5b57\u6bb5\u7684\u5b57\u6bb5\u548c\u65b9\u6cd5\u90fd\u53ef\u4ee5\u201c\u5ac1\u63a5\u201d\u5230\u88ab\u5d4c\u5165\u7c7b\u578b\u4e0a\uff0c\u6240\u4ee5\u5373\u4f7f\u5728\u4e24\u4e2a\u540c\u540d\u7684\u6210\u5458\u4e00\u4e2a\u662f\u5b57\u6bb5\uff0c\u53e6\u4e00\u4e2a\u662f\u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c\u5c4f\u853d\u73b0\u8c61\u4f9d\u7136\u5b58\u5728\u3002\u901a\u8fc7\u94fe\u5f0f\u9009\u62e9\u8868\u8fbe\u5f0f\u9009\u62e9\u88ab\u5c4f\u853d\u7684\u5d4c\u5165\u5b57\u6bb5\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\u3002","title":"\u5d4c\u5165\u5b57\u6bb5"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/#_3","text":"\u4f8b\u5b50\uff1a type Cat struct { name string Animal // \u5d4c\u5165\u5b57\u6bb5\u672c\u8eab\u4e5f\u662f\u5d4c\u5165\u5b57\u6bb5 } func (cat Cat) String() string { return fmt.Sprintf( %s (category: %s, name: %q) , cat.scientificName, cat.Animal.AnimalCategory, cat.name) } \u5c4f\u853d\u73b0\u8c61\u4f1a\u4ee5\u5d4c\u5165\u7684\u5c42\u7ea7\u4e3a\u4f9d\u636e\uff0c\u5d4c\u5165\u7684\u5c42\u7ea7\u8d8a\u6df1\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\u8d8a\u53ef\u80fd\u88ab\u5c4f\u853d\u3002\u5982\uff0c\u8c03\u7528Cat\u7684String\u65b9\u6cd5\uff1a \u72b6\u6001 Cat Animal AnimalCategory 1 \u5b58\u5728\uff0c\u8c03\u7528 \u5c4f\u853d \u5c4f\u853d 2 \u4e0d\u5b58\u5728 \u8c03\u7528 \u5c4f\u853d 3 \u4e0d\u5b58\u5728 \u4e0d\u5b58\u5728 \u8c03\u7528 \u6839\u636e\u662f\u5426\u5b58\u5728String\u65b9\u6cd5\uff0c\u6765\u5224\u65ad\u5d4c\u5165\u5b57\u6bb5\u7684String\u65b9\u6cd5\u662f\u5426\u4f1a\u88ab\u8c03\u7528\u4f1a\u5c4f\u853d\u3002 \u5982\u679c\u5904\u4e8e\u540c\u4e00\u5c42\u7ea7\u7684\u591a\u4e2a\u5d4c\u5165\u5b57\u6bb5\u6709\u7528\u540c\u540d\u7684\u5b57\u6bb5\u6216\u65b9\u6cd5\uff0c\u90a3\u4e48\u4ece\u88ab\u5d4c\u5165\u7c7b\u578b\u7684\u503c\u90a3\u91cc\u9009\u62e9\u6b64\u540d\u79f0\u65f6\uff0c\u4f1a\u5f15\u53d1\u7f16\u8bd1\u9519\uff0c\u7f16\u8bd1\u5668\u65e0\u6cd5\u786e\u5b9a\u88ab\u9009\u62e9\u7684\u6210\u5458\u5230\u5e95\u662f\u54ea\u4e00\u4e2a \u3002","title":"\u591a\u5c42\u5d4c\u5165"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/#_4","text":"Go\u8bed\u8a00\u4e2d\u4e0d\u5b58\u5728\u7ee7\u627f\u7684\u6982\u5ff5\uff0c\u5b83\u901a\u8fc7\u5d4c\u5165\u5b57\u6bb5\u7684\u65b9\u5f0f\u5b9e\u73b0\u4e86\u7c7b\u578b\u4e4b\u95f4\u7684\u7ec4\u5408\u3002 \u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u7684\u96c6\u6210\uff0c\u901a\u8fc7\u727a\u7272\u4e00\u5b9a\u7684\u4ee3\u7801\u7b80\u6d01\u6027\u6765\u6362\u53d6\u53ef\u6269\u5c55\u6027\uff0c\u8fd9\u79cd\u53ef\u6269\u5c55\u6027\u662f\u901a\u8fc7\u4fb5\u5165\u7684\u65b9\u5f0f\u6765\u5b9e\u73b0\u7684 \u3002 \u7c7b\u578b\u4e4b\u95f4\u7684\u7ec4\u5408\u91c7\u7528\u7684\u662f\u975e\u58f0\u660e\u7684\u65b9\u5f0f\uff0c\u662f\u975e\u4fb5\u5165\u5f0f\u7684\uff0c\u5b83\u4e0d\u4f1a\u7834\u574f\u7c7b\u578b\u7684\u5c01\u88c5\u6216\u52a0\u91cd\u7c7b\u578b\u4e4b\u95f4\u7684\u8026\u5408\u3002\u6211\u4eec\u53ea\u662f\u628a\u7c7b\u578b\u5f53\u505a\u5b57\u6bb5\u5d4c\u5165\u8fdb\u6765\uff0c\u7136\u540e\u5750\u4eab\u5176\u6210\u5730\u4f7f\u7528\u5d4c\u5165\u5b57\u6bb5\u6240\u62e5\u6709\u7684\u4e00\u5207\u3002\u540c\u65f6\u53ef\u4ee5\u901a\u8fc7\u201c\u5305\u88c5\u201d\u6216\u201c\u5c4f\u853d\u201d\u7684\u65b9\u5f0f\u6765\u8c03\u6574\u6216\u4f18\u5316\u5d4c\u5165\u5b57\u6bb5\u3002 \u7c7b\u578b\u7ec4\u5408\u975e\u5e38\u7075\u6d3b\u7684\u901a\u8fc7\u5d4c\u5165\u5b57\u6bb5\u628a\u4e00\u4e2a\u7c7b\u578b\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u201c\u5ac1\u63a5\u201d\u7ed9\u53e6\u4e00\u4e2a\u7c7b\u578b\uff0c\u88ab\u5d4c\u5165\u7c7b\u578b\u81ea\u7136\u7684\u5b9e\u73b0\u4e86\u5d4c\u5165\u5b57\u6bb5\u6240\u5b9e\u73b0\u7684\u63a5\u53e3\u3002 \u7ec4\u5408\u6bd4\u7ee7\u627f\u66f4\u52a0\u7b80\u6d01\u548c\u6e05\u6670\uff0c\u4e0d\u4f1a\u6709\u591a\u91cd\u7ee7\u627f\u90a3\u6837\u8d1f\u8d23\u7684\u5c42\u6b21\u7ed3\u6784\u548c\u53ef\u89c2\u7684\u7ba1\u7406\u6210\u672c \u3002 \u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u4e5f\u53ef\u4ee5\u7ec4\u5408\uff0c\u4ee5\u6b64\u6765\u6269\u5c55\u63a5\u53e3\u5b9a\u4e49\u7684\u578b\u53f7\u6216\u8005\u6807\u8bb0\u63a5\u53e3\u7684\u7279\u5f81\u3002","title":"\u7c7b\u578b\u7ec4\u5408"},{"location":"Language/Basic/10-\u7ed3\u6784\u4f53\u7c7b\u578b/#_5","text":"\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u5fc5\u987b\u662f\u67d0\u4e2a\u81ea\u5b9a\u4e49\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u80fd\u662f\u63a5\u53e3\u7c7b\u578b\u6216\u8005\u63a5\u53e3\u7684\u6307\u9488\u7c7b\u578b\u3002 \u503c\u65b9\u6cd5\uff1a\u63a5\u6536\u8005\u7c7b\u578b\u662f \u975e\u6307\u9488\u7684 \u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5 \u6307\u9488\u65b9\u6cd5\uff1a\u63a5\u6536\u8005\u7c7b\u578b\u662f\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5 \u4e0a\u9762\u4f8b\u5b50\u4e2d\u7684\u65b9\u6cd5\u90fd\u662f\u503c\u65b9\u6cd5\u3002 \u6307\u9488\u65b9\u6cd5\uff0c\u5982\u4e0b\u4f8b\u5b50\uff1a func (cat *Cat) SetName(name string) { cat.name = name } // SetName\u65b9\u6cd5\u7684\u63a5\u6536\u8005\u7c7b\u578b\u662f*Cat\uff0c\u6240\u4ee5\u662f\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5 \u53d6\u503c\u8868\u8fbe\u5f0f\uff1a*\u653e\u5728\u4e00\u4e2a\u6307\u9488\u503c\u7684\u5de6\u8fb9\uff0c\u6765\u83b7\u53d6\u8be5\u6307\u9488\u6307\u5411\u7684\u57fa\u672c\u7c7b\u578b\u503c \u53d6\u5730\u5740\u8868\u8fbe\u5f0f\uff1a \u653e\u5728\u4e00\u4e2a\u53ef\u5bfb\u5740\u7684\u57fa\u672c\u7c7b\u578b\u503c\u7684\u5de6\u8fb9\uff0c\u6765\u83b7\u53d6\u8be5\u57fa\u672c\u7c7b\u578b\u7684\u6307\u9488\u503c \u503c\u65b9\u6cd5\u4e0e\u6307\u9488\u65b9\u6cd5\u7684\u533a\u522b\uff1a \u5dee\u522b \u503c\u65b9\u6cd5 \u6307\u9488\u65b9\u6cd5 \u65b9\u6cd5\u63a5\u6536\u8005 \u8be5\u65b9\u6cd5\u6240\u5c5e\u7684\u90a3\u4e2a\u7c7b\u578b\u503c\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u503c\u65b9\u6cd5\u5185\u5bf9\u8be5\u526f\u672c\u7684\u4fee\u6539\u4e0d\u4f1a\u4f53\u73b0\u5728\u539f\u503c\u4e0a\uff0c \u9664\u975e\u8fd9\u4e2a\u7c7b\u578b\u672c\u8eab\u662f\u67d0\u4e2a\u5f15\u7528\u7c7b\u578b\u7684\u522b\u540d\u7c7b\u578b \u8be5\u65b9\u6cd5\u6240\u5c5e\u7684\u90a3\u4e2a\u57fa\u672c\u7c7b\u578b\u503c\u7684\u6307\u9488\u7684\u4e00\u4e2a\u526f\u672c\uff0c\u6307\u9488\u65b9\u6cd5\u5185\u5bf9\u8be5\u526f\u672c\u7684\u4fee\u6539\u4f1a\u76f4\u63a5\u4f53\u73b0\u5728\u539f\u503c\u4e0a \u65b9\u6cd5\u96c6\u5408 \u81ea\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u4ec5\u5305\u542b\u6240\u6709\u503c\u65b9\u6cd5 \u8be5\u7c7b\u578b\u7684\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u5305\u62ec\u6240\u6709\u7684\u503c\u65b9\u6cd5\u548c\u6307\u9488\u65b9\u6cd5 \u65b9\u6cd5\u96c6\u5408\u7684\u89e3\u91ca\uff1a\u4e25\u683c\u6765\u8bf4\uff0c\u57fa\u672c\u7c7b\u578b\u7684\u503c\u4e0a\u4e4b\u53ea\u80fd\u8c03\u7528\u5b83\u7684\u503c\u65b9\u6cd5\uff0c\u4f46\uff0cGo\u8bed\u8a00\u4f1a\u9002\u65f6\u5730\u4e3a\u6211\u4eec\u8fdb\u884c\u81ea\u52a8\u5730\u8f6c\u8bd1\uff0c\u4f7f\u5f97\u6211\u4eec\u5728\u8fd9\u6837\u7684\u503c\u4e0a\u4e5f\u80fd\u8c03\u7528\u5b83\u7684\u6307\u9488\u65b9\u6cd5\u3002\u4f8b\u5982\uff0c cat.SetName(\"monster\") \u4f1a\u81ea\u52a8\u8f6c\u8bd1\u4e3a ( cat).SetName(\"monster\") \uff0c\u5373\u5148\u53d6cat\u7684\u6307\u9488\u503c\uff0c\u7136\u540e\u5728\u6307\u9488\u503c\u4e0a\u8c03\u7528\u6307\u9488\u65b9\u6cd5SetName\u3002 \u4e00\u4e2a\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u6709\u54ea\u4e9b\u65b9\u6cd5\u4e0e\u5b83\u80fd\u5b9e\u73b0\u54ea\u4e9b\u63a5\u53e3\u7c7b\u578b\u662f\u606f\u606f\u76f8\u5173\u7684\uff0c\u5982\u679c\u4e00\u4e2a\u57fa\u672c\u7c7b\u578b\u548c\u5b83\u7684\u6307\u9488\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u662f\u4e0d\u540c\u7684\uff0c\u90a3\u4e48\u5b83\u4eec\u5177\u4f53\u5b9e\u73b0\u7684\u63a5\u53e3\u7c7b\u578b\u7684\u6570\u91cf\u4e5f\u4f1a\u6709\u5dee\u5f02\uff0c\u9664\u975e\u4e24\u4e2a\u6570\u91cf\u90fd\u662f\u96f6\u3002","title":"\u503c\u65b9\u6cd5\u4e0e\u6307\u9488\u65b9\u6cd5"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/","text":"\u63a5\u53e3\u7c7b\u578b \u63a5\u53e3\u7c7b\u578b\u4e0e\u5176\u4ed6\u6570\u636e\u7c7b\u578b\u4e0d\u540c\uff0c\u5b83\u6ca1\u6cd5\u88ab\u5b9e\u4f8b\u5316\u3002\u65e2\u4e0d\u80fd\u901a\u8fc7\u8c03\u7528 new() \u6216 make() \u51fd\u6570\u521b\u5efa\u51fa\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\uff0c\u4e5f\u65e0\u6cd5\u7528\u5b57\u9762\u91cf\u6765\u8868\u793a\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002 \u5bf9\u4e8e\u67d0\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u4f5c\u4e3a\u5b83\u7684\u5b9e\u73b0\uff0c\u90a3\u4e48\u8be5\u63a5\u53e3\u7684\u503c\u5c31\u4e0d\u53ef\u80fd\u5b58\u5728 \u3002 \u63a5\u53e3\u7c7b\u578b\u7684\u7c7b\u578b\u5b57\u9762\u91cf\u4e0e\u7ed3\u6784\u4f53\u7c7b\u578b\u770b\u8d77\u6765\u76f8\u4f3c\uff0c\u7528\u82b1\u62ec\u53f7\u5305\u88f9\u4e00\u4e9b\u6838\u5fc3\u4fe1\u606f\uff1a \u7ed3\u6784\u4f53\u7c7b\u578b\uff1a\u5305\u88f9 \u5b57\u6bb5\u58f0\u660e \u63a5\u53e3\u7c7b\u578b\uff1a\u5305\u88f9 \u65b9\u6cd5\u5b9a\u4e49 \u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u4e2d\u7684\u65b9\u6cd5\u4ee3\u8868\u7684\u5c31\u662f\u8be5\u63a5\u53e3\u7684\u65b9\u6cd5\u96c6\u5408\uff0c\u4e00\u4e2a\u63a5\u53e3\u7684\u65b9\u6cd5\u96c6\u5408\u5c31\u662f\u5b83\u7684\u5168\u90e8\u7279\u5f81\u3002 \u5bf9\u4e8e\u4efb\u4f55\u6570\u636e\u7c7b\u578b\uff0c\u53ea\u8981\u5b83\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u5b8c\u5168\u5305\u542b\u4e86\u4e00\u4e2a\u63a5\u53e3\u7684\u5168\u90e8\u7279\u5f81\uff0c\u90a3\u4e48\u5b83\u5c31\u4e00\u5b9a\u662f\u8fd9\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b \uff0c\u5982\u4e0b\u6240\u793a\uff1a type Pet interface { SetName(name string) Name() string Category() string } // \u53ea\u8981\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u6709\u4e0a\u8ff03\u4e2a\u65b9\u6cd5\uff0c\u90a3\u5b83\u5c31\u662fPet\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b // \u8fd9\u662f\u4e00\u79cd\u65e0\u4fb5\u5165\u5f0f\u7684\u63a5\u53e3\u5b9e\u73b0\u65b9\u5f0f \u5224\u65ad\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u67d0\u4e2a\u65b9\u6cd5\u5b9e\u73b0\u7684\u662f\u67d0\u4e2a\u63a5\u53e3\u7c7b\u578b\u4e2d\u7684\u65b9\u6cd5\uff1a \u4e24\u4e2a\u65b9\u6cd5\u7684 \u7b7e\u540d \u8981\u5b8c\u5168\u4e00\u81f4 \u4e24\u4e2a\u65b9\u6cd5\u7684 \u540d\u79f0 \u8981\u5b8c\u5168\u4e00\u81f4 \u4e13\u6709\u540d\u8bcd \u52a8\u6001\u503c\uff1a\u8d4b\u7ed9\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u503c\u53eb\u505a\u5b9e\u9645\u503c\uff08\u52a8\u6001\u503c\uff09 \u52a8\u6001\u7c7b\u578b\uff1a\u88ab\u8d4b\u4e88\u7ed9\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u503c\u7684\u7c7b\u578b\u79f0\u4e3a\u63a5\u53e3\u7c7b\u578b\u53d8\u91cf\u7684\u5b9e\u9645\u7c7b\u578b\uff08\u52a8\u6001\u7c7b\u578b\uff09 dog := Dog{ little pig } var pet Pet = dog // dog\u662f\u52a8\u6001\u503c\uff0c*dog\u662f\u52a8\u6001\u7c7b\u578b // pet\u7684\u7c7b\u578b\u662f\u9759\u6001\u7c7b\u578b pet\u7684\u9759\u6001\u7c7b\u578b\u6c38\u8fdc\u4e0d\u53d8\uff0c\u800c\u52a8\u6001\u7c7b\u578b\u4f1a\u968f\u7740\u8d4b\u503c\u7684\u53d8\u5316\u800c\u53d8\u5316\u3002\u5728\u7ed9\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u8d4b\u4e88\u5b9e\u9645\u503c\u4e4b\u524d\uff0c\u5b83\u7684\u52a8\u6001\u7c7b\u578b\u662f\u4e0d\u5b58\u5728\u7684\u3002 \u7ed9\u63a5\u53e3\u53d8\u91cf\u8d4b\u503c \u5982\u679c\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u7ed9\u53e6\u5916\u4e00\u4e2a\u53d8\u91cf\u8d4b\u503c\uff0c\u90a3\u4e48\u771f\u6b63\u8d4b\u503c\u7ed9\u540e\u8005\u7684\uff0c\u5e76\u4e0d\u662f\u524d\u8005\u6301\u6709\u7684\u90a3\u4e2a\u503c\uff0c\u800c\u662f\u8be5\u503c\u7684\u4e00\u4e2a\u526f\u672c \u3002 \u63a5\u53e3\u7c7b\u578b\u503c\u7684\u5b58\u50a8\u65b9\u5f0f\u548c\u7ed3\u6784 \u63a5\u53e3\u7c7b\u578b\u672c\u8eab\u662f\u65e0\u6cd5\u88ab\u503c\u5316\u7684\uff0c\u5728\u8d4b\u4e88\u63a5\u53e3\u53d8\u91cf\u52a8\u6001\u503c\u4e4b\u524d\uff0c\u5b83\u7684\u503c\u4e00\u5b9a\u662f nil \uff08\u5b83\u7684\u96f6\u503c\uff09\u3002\u5f53\u7ed9\u63a5\u53e3\u53d8\u91cf\u8d4b\u503c\u65f6\uff0c\u8be5\u53d8\u91cf\u7684\u52a8\u6001\u7c7b\u578b\u548c\u52a8\u6001\u503c\u4e00\u8d77\u88ab\u5b58\u50a8\u5728\u4e00\u4e2a \u4e13\u7528\u7684\u6570\u636e\u7ed3\u6784(iface)\u4e2d \u3002\u8fd9\u4e2a\u63a5\u53e3\u53d8\u91cf\u7684\u503c\u5176\u5b9e\u662f\u8fd9\u4e2a\u4e13\u7528\u6570\u636e\u63a5\u53e3\u7684\u5b9e\u4f8b\uff0c\u800c\u4e0d\u662f\u8d4b\u4e88\u7ed9\u63a5\u53e3\u53d8\u91cf\u7684\u90a3\u4e2a\u52a8\u6001\u503c\u3002 \u6240\u4ee5\u63a5\u53e3\u53d8\u91cf\u4e0e\u52a8\u6001\u503c\u80af\u5b9a\u662f\u4e0d\u540c\u7684 \uff0c\u65e0\u8bba\u662f\u5b58\u50a8\u7684\u5185\u5bb9\u8fd8\u662f\u5b58\u50a8\u7684\u7ed3\u6784\u90fd\u4e0d\u540c\u3002 \u4e13\u7528\u6570\u636e\u7ed3\u6784\uff08iface\uff09\u5b9e\u4f8b\u4f1a\u5305\u542b\u4e24\u4e2a\u6307\u9488\uff0c\u4e00\u4e2a\u662f\u6307\u5411\u7c7b\u578b\u4fe1\u606f\uff08\u8fd9\u91cc\u7684\u7c7b\u578b\u4fe1\u606f\u6709\u53e6\u4e00\u4e2a\u4e13\u7528\u6570\u636e\u7ed3\u6784\u7684\u5b9e\u4f8b\u627f\u8f7d\uff0c\u5305\u542b\u52a8\u6001\u7c7b\u578b\u4ee5\u53ca\u4f7f\u4ed6\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u65b9\u6cd5\u548c\u8c03\u7528\u5b83\u4eec\u7684\u9014\u5f84\uff09\u7684\u6307\u9488\uff0c\u53e6\u4e00\u4e2a\u662f\u6307\u5411\u52a8\u6001\u503c\u7684\u6307\u9488\u3002 \u63a5\u53e3\u53d8\u91cf\u7684\u503c\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u771f\u6b63\u4e3anil var dog1 *Dog // \u58f0\u660e*Dog\u7c7b\u578b\u7684\u53d8dog1\uff0c\u6ca1\u6709\u521d\u59cb\u5316\uff0cdog1\u7684\u503c\u4e3anil fmt.Println( The first dog is nil. ) dog2 := dog1 // dog2\u7684\u503c\u4e5f\u4e3anil fmt.Println( The second dog is nil. ) var pet Pet = dog2 // pet\u7684\u52a8\u6001\u503c\u4e0d\u4e3anil\uff0cpet\u7684\u52a8\u6001\u7c7b\u578b\u4e3a*Dog if pet == nil { fmt.Println( The pet is nil. ) } else { fmt.Println( The pet is not nil. ) } // dog2\u7684\u503c\u662f\u771f\u6b63\u7684nil\uff0c\u628adog2\u8d4b\u503c\u7ed9pet\u65f6\uff0cGo\u8bed\u8a00\u628a\u503c\u548c\u7c7b\u578b\u653e\u5728\u4e00\u8d77\u8003\u8651 // \u56e0\u6b64pet\u7684\u52a8\u6001\u503c\u4e0d\u662fnil // GO\u8bed\u8a00\u662f\u88ab\u51fa\u8d4b\u4e88pet\u7684\u503c\u662f\u4e00\u4e2a*Dog\u7c7b\u578b\u7684nil\u503c\uff0c // Go\u8bed\u8a00\u7528iface\u7684\u5b9e\u4f8b\u5305\u88c5\u5b83\uff0c\u5305\u88c5\u540epet\u7684\u503c\u80af\u5b9a\u4e0d\u662fnil \u5728Go\u8bed\u8a00\u4e2d\uff0c\u628a\u5b57\u9762\u91cf\u4e3anil\u8868\u793a\u7684\u503c\u53eb\u505a\u65e0\u7c7b\u578b\u7684nil\uff0c\u8fd9\u662f\u771f\u6b63\u7684nil\uff0c\u5b83\u7684\u7c7b\u578b\u4e5f\u662fnil\u3002 \u628a\u4e00\u4e2a\u6709\u7c7b\u578b\u7684nil\u503c\u8d4b\u7ed9\u63a5\u53e3\u53d8\u91cf\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u4e00\u5b9a\u4e0d\u4f1a\u662f\u90a3\u4e2a\u771f\u6b63\u7684nil \u3002 \u8ba9\u63a5\u53e3\u53d8\u91cf\u7684\u503c\u4e3a\u771f\u6b63\u7684nil\u7684\u65b9\u6cd5\uff1a \u53ea\u58f0\u660e\u63a5\u53e3\u53d8\u91cf\u4f46\u4e0d\u521d\u59cb\u5316 \u76f4\u63a5\u628a\u5b57\u9762\u91cfnil\u8d4b\u4e88\u7ed9\u63a5\u53e3\u53d8\u91cf \u63a5\u53e3\u4e4b\u95f4\u7684\u7ec4\u5408 \u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u7684\u5d4c\u5165\u79f0\u4e3a\u63a5\u53e3\u7684\u7ec4\u5408\uff0c\u4e0e\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u7ec4\u5408\u76f8\u6bd4\uff0c\u63a5\u53e3\u7c7b\u578b\u7ec4\u5408\u4e0d\u4f1a\u51fa\u73b0\u65b9\u6cd5\u4e4b\u95f4\u7684\u5c4f\u853d\u3002 \u53ea\u8981\u7ec4\u5408\u7684\u63a5\u53e3\u4e4b\u95f4\u6709\u540c\u540d\u7684\u65b9\u6cd5\u5c31\u4f1a\u4ea7\u751f\u51b2\u7a81\uff0c\u4ece\u800c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\uff0c\u5373\u4f7f\u540c\u540d\u65b9\u6cd5\u7684\u7b7e\u540d\u4e0d\u540c\u4e5f\u4e0d\u884c \u3002 \u4e0e\u7ed3\u6784\u4f53\u7ec4\u5408\u76f8\u4f3c\uff0c\u628a\u63a5\u53e3\u7c7b\u578b\u7684\u540d\u79f0\u76f4\u63a5\u5199\u5230\u53e6\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u6210\u5458\u7c7b\u522b\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a type Animal interface { ScientificName() string Category() string } type Pet interface { Animal // \u5d4c\u5165 Name() string } // Animal\u63a5\u53e3\u5305\u542b\u7684\u6240\u4ee5\u65b9\u6cd5\u6210\u4e3a\u4e86Pet\u63a5\u53e3\u7684\u65b9\u6cd5 Go\u8bed\u8a00\u56e2\u961f\u9f13\u52b1\u58f0\u660e\u4f53\u91cf\u8f83\u5c0f\u7684\u63a5\u53e3\uff0c\u5e76\u5efa\u8bae\u901a\u8fc7\u63a5\u53e3\u7ec4\u5408\u6765\u6269\u5c55\u7a0b\u5e8f\u3001\u589e\u52a0\u7a0b\u5e8f\u7684\u7075\u6d3b\u6027\u3002\u76f8\u6bd4\u4e8e\u5305\u542b\u5f88\u591a\u65b9\u6cd5\u7684\u5927\u63a5\u53e3\uff0c\u5c0f\u63a5\u53e3\u53ef\u4ee5\u4e13\u7528\u5730\u8868\u8fbe\u67d0\u4e00\u79cd\u80fd\u529b\u6216\u67d0\u4e00\u7c7b\u7279\u5f81\uff0c\u4e5f\u66f4\u5bb9\u6613\u88ab\u7ec4\u5408\u5728\u4e00\u8d77\u3002","title":"\u63a5\u53e3\u7c7b\u578b"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#_1","text":"\u63a5\u53e3\u7c7b\u578b\u4e0e\u5176\u4ed6\u6570\u636e\u7c7b\u578b\u4e0d\u540c\uff0c\u5b83\u6ca1\u6cd5\u88ab\u5b9e\u4f8b\u5316\u3002\u65e2\u4e0d\u80fd\u901a\u8fc7\u8c03\u7528 new() \u6216 make() \u51fd\u6570\u521b\u5efa\u51fa\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\uff0c\u4e5f\u65e0\u6cd5\u7528\u5b57\u9762\u91cf\u6765\u8868\u793a\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002 \u5bf9\u4e8e\u67d0\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u5982\u679c\u6ca1\u6709\u4efb\u4f55\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u4f5c\u4e3a\u5b83\u7684\u5b9e\u73b0\uff0c\u90a3\u4e48\u8be5\u63a5\u53e3\u7684\u503c\u5c31\u4e0d\u53ef\u80fd\u5b58\u5728 \u3002 \u63a5\u53e3\u7c7b\u578b\u7684\u7c7b\u578b\u5b57\u9762\u91cf\u4e0e\u7ed3\u6784\u4f53\u7c7b\u578b\u770b\u8d77\u6765\u76f8\u4f3c\uff0c\u7528\u82b1\u62ec\u53f7\u5305\u88f9\u4e00\u4e9b\u6838\u5fc3\u4fe1\u606f\uff1a \u7ed3\u6784\u4f53\u7c7b\u578b\uff1a\u5305\u88f9 \u5b57\u6bb5\u58f0\u660e \u63a5\u53e3\u7c7b\u578b\uff1a\u5305\u88f9 \u65b9\u6cd5\u5b9a\u4e49 \u63a5\u53e3\u7c7b\u578b\u58f0\u660e\u4e2d\u7684\u65b9\u6cd5\u4ee3\u8868\u7684\u5c31\u662f\u8be5\u63a5\u53e3\u7684\u65b9\u6cd5\u96c6\u5408\uff0c\u4e00\u4e2a\u63a5\u53e3\u7684\u65b9\u6cd5\u96c6\u5408\u5c31\u662f\u5b83\u7684\u5168\u90e8\u7279\u5f81\u3002 \u5bf9\u4e8e\u4efb\u4f55\u6570\u636e\u7c7b\u578b\uff0c\u53ea\u8981\u5b83\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u5b8c\u5168\u5305\u542b\u4e86\u4e00\u4e2a\u63a5\u53e3\u7684\u5168\u90e8\u7279\u5f81\uff0c\u90a3\u4e48\u5b83\u5c31\u4e00\u5b9a\u662f\u8fd9\u4e2a\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b \uff0c\u5982\u4e0b\u6240\u793a\uff1a type Pet interface { SetName(name string) Name() string Category() string } // \u53ea\u8981\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u65b9\u6cd5\u96c6\u5408\u4e2d\u6709\u4e0a\u8ff03\u4e2a\u65b9\u6cd5\uff0c\u90a3\u5b83\u5c31\u662fPet\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b // \u8fd9\u662f\u4e00\u79cd\u65e0\u4fb5\u5165\u5f0f\u7684\u63a5\u53e3\u5b9e\u73b0\u65b9\u5f0f \u5224\u65ad\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u67d0\u4e2a\u65b9\u6cd5\u5b9e\u73b0\u7684\u662f\u67d0\u4e2a\u63a5\u53e3\u7c7b\u578b\u4e2d\u7684\u65b9\u6cd5\uff1a \u4e24\u4e2a\u65b9\u6cd5\u7684 \u7b7e\u540d \u8981\u5b8c\u5168\u4e00\u81f4 \u4e24\u4e2a\u65b9\u6cd5\u7684 \u540d\u79f0 \u8981\u5b8c\u5168\u4e00\u81f4","title":"\u63a5\u53e3\u7c7b\u578b"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#_2","text":"\u52a8\u6001\u503c\uff1a\u8d4b\u7ed9\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u503c\u53eb\u505a\u5b9e\u9645\u503c\uff08\u52a8\u6001\u503c\uff09 \u52a8\u6001\u7c7b\u578b\uff1a\u88ab\u8d4b\u4e88\u7ed9\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u503c\u7684\u7c7b\u578b\u79f0\u4e3a\u63a5\u53e3\u7c7b\u578b\u53d8\u91cf\u7684\u5b9e\u9645\u7c7b\u578b\uff08\u52a8\u6001\u7c7b\u578b\uff09 dog := Dog{ little pig } var pet Pet = dog // dog\u662f\u52a8\u6001\u503c\uff0c*dog\u662f\u52a8\u6001\u7c7b\u578b // pet\u7684\u7c7b\u578b\u662f\u9759\u6001\u7c7b\u578b pet\u7684\u9759\u6001\u7c7b\u578b\u6c38\u8fdc\u4e0d\u53d8\uff0c\u800c\u52a8\u6001\u7c7b\u578b\u4f1a\u968f\u7740\u8d4b\u503c\u7684\u53d8\u5316\u800c\u53d8\u5316\u3002\u5728\u7ed9\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\u8d4b\u4e88\u5b9e\u9645\u503c\u4e4b\u524d\uff0c\u5b83\u7684\u52a8\u6001\u7c7b\u578b\u662f\u4e0d\u5b58\u5728\u7684\u3002","title":"\u4e13\u6709\u540d\u8bcd"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#_3","text":"\u5982\u679c\u4f7f\u7528\u4e00\u4e2a\u53d8\u91cf\u7ed9\u53e6\u5916\u4e00\u4e2a\u53d8\u91cf\u8d4b\u503c\uff0c\u90a3\u4e48\u771f\u6b63\u8d4b\u503c\u7ed9\u540e\u8005\u7684\uff0c\u5e76\u4e0d\u662f\u524d\u8005\u6301\u6709\u7684\u90a3\u4e2a\u503c\uff0c\u800c\u662f\u8be5\u503c\u7684\u4e00\u4e2a\u526f\u672c \u3002","title":"\u7ed9\u63a5\u53e3\u53d8\u91cf\u8d4b\u503c"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#_4","text":"\u63a5\u53e3\u7c7b\u578b\u672c\u8eab\u662f\u65e0\u6cd5\u88ab\u503c\u5316\u7684\uff0c\u5728\u8d4b\u4e88\u63a5\u53e3\u53d8\u91cf\u52a8\u6001\u503c\u4e4b\u524d\uff0c\u5b83\u7684\u503c\u4e00\u5b9a\u662f nil \uff08\u5b83\u7684\u96f6\u503c\uff09\u3002\u5f53\u7ed9\u63a5\u53e3\u53d8\u91cf\u8d4b\u503c\u65f6\uff0c\u8be5\u53d8\u91cf\u7684\u52a8\u6001\u7c7b\u578b\u548c\u52a8\u6001\u503c\u4e00\u8d77\u88ab\u5b58\u50a8\u5728\u4e00\u4e2a \u4e13\u7528\u7684\u6570\u636e\u7ed3\u6784(iface)\u4e2d \u3002\u8fd9\u4e2a\u63a5\u53e3\u53d8\u91cf\u7684\u503c\u5176\u5b9e\u662f\u8fd9\u4e2a\u4e13\u7528\u6570\u636e\u63a5\u53e3\u7684\u5b9e\u4f8b\uff0c\u800c\u4e0d\u662f\u8d4b\u4e88\u7ed9\u63a5\u53e3\u53d8\u91cf\u7684\u90a3\u4e2a\u52a8\u6001\u503c\u3002 \u6240\u4ee5\u63a5\u53e3\u53d8\u91cf\u4e0e\u52a8\u6001\u503c\u80af\u5b9a\u662f\u4e0d\u540c\u7684 \uff0c\u65e0\u8bba\u662f\u5b58\u50a8\u7684\u5185\u5bb9\u8fd8\u662f\u5b58\u50a8\u7684\u7ed3\u6784\u90fd\u4e0d\u540c\u3002 \u4e13\u7528\u6570\u636e\u7ed3\u6784\uff08iface\uff09\u5b9e\u4f8b\u4f1a\u5305\u542b\u4e24\u4e2a\u6307\u9488\uff0c\u4e00\u4e2a\u662f\u6307\u5411\u7c7b\u578b\u4fe1\u606f\uff08\u8fd9\u91cc\u7684\u7c7b\u578b\u4fe1\u606f\u6709\u53e6\u4e00\u4e2a\u4e13\u7528\u6570\u636e\u7ed3\u6784\u7684\u5b9e\u4f8b\u627f\u8f7d\uff0c\u5305\u542b\u52a8\u6001\u7c7b\u578b\u4ee5\u53ca\u4f7f\u4ed6\u5b9e\u73b0\u4e86\u63a5\u53e3\u7684\u65b9\u6cd5\u548c\u8c03\u7528\u5b83\u4eec\u7684\u9014\u5f84\uff09\u7684\u6307\u9488\uff0c\u53e6\u4e00\u4e2a\u662f\u6307\u5411\u52a8\u6001\u503c\u7684\u6307\u9488\u3002","title":"\u63a5\u53e3\u7c7b\u578b\u503c\u7684\u5b58\u50a8\u65b9\u5f0f\u548c\u7ed3\u6784"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#nil","text":"var dog1 *Dog // \u58f0\u660e*Dog\u7c7b\u578b\u7684\u53d8dog1\uff0c\u6ca1\u6709\u521d\u59cb\u5316\uff0cdog1\u7684\u503c\u4e3anil fmt.Println( The first dog is nil. ) dog2 := dog1 // dog2\u7684\u503c\u4e5f\u4e3anil fmt.Println( The second dog is nil. ) var pet Pet = dog2 // pet\u7684\u52a8\u6001\u503c\u4e0d\u4e3anil\uff0cpet\u7684\u52a8\u6001\u7c7b\u578b\u4e3a*Dog if pet == nil { fmt.Println( The pet is nil. ) } else { fmt.Println( The pet is not nil. ) } // dog2\u7684\u503c\u662f\u771f\u6b63\u7684nil\uff0c\u628adog2\u8d4b\u503c\u7ed9pet\u65f6\uff0cGo\u8bed\u8a00\u628a\u503c\u548c\u7c7b\u578b\u653e\u5728\u4e00\u8d77\u8003\u8651 // \u56e0\u6b64pet\u7684\u52a8\u6001\u503c\u4e0d\u662fnil // GO\u8bed\u8a00\u662f\u88ab\u51fa\u8d4b\u4e88pet\u7684\u503c\u662f\u4e00\u4e2a*Dog\u7c7b\u578b\u7684nil\u503c\uff0c // Go\u8bed\u8a00\u7528iface\u7684\u5b9e\u4f8b\u5305\u88c5\u5b83\uff0c\u5305\u88c5\u540epet\u7684\u503c\u80af\u5b9a\u4e0d\u662fnil \u5728Go\u8bed\u8a00\u4e2d\uff0c\u628a\u5b57\u9762\u91cf\u4e3anil\u8868\u793a\u7684\u503c\u53eb\u505a\u65e0\u7c7b\u578b\u7684nil\uff0c\u8fd9\u662f\u771f\u6b63\u7684nil\uff0c\u5b83\u7684\u7c7b\u578b\u4e5f\u662fnil\u3002 \u628a\u4e00\u4e2a\u6709\u7c7b\u578b\u7684nil\u503c\u8d4b\u7ed9\u63a5\u53e3\u53d8\u91cf\uff0c\u90a3\u4e48\u8fd9\u4e2a\u53d8\u91cf\u7684\u503c\u4e00\u5b9a\u4e0d\u4f1a\u662f\u90a3\u4e2a\u771f\u6b63\u7684nil \u3002 \u8ba9\u63a5\u53e3\u53d8\u91cf\u7684\u503c\u4e3a\u771f\u6b63\u7684nil\u7684\u65b9\u6cd5\uff1a \u53ea\u58f0\u660e\u63a5\u53e3\u53d8\u91cf\u4f46\u4e0d\u521d\u59cb\u5316 \u76f4\u63a5\u628a\u5b57\u9762\u91cfnil\u8d4b\u4e88\u7ed9\u63a5\u53e3\u53d8\u91cf","title":"\u63a5\u53e3\u53d8\u91cf\u7684\u503c\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u771f\u6b63\u4e3anil"},{"location":"Language/Basic/11-\u63a5\u53e3\u7c7b\u578b/#_5","text":"\u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u7684\u5d4c\u5165\u79f0\u4e3a\u63a5\u53e3\u7684\u7ec4\u5408\uff0c\u4e0e\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u7ec4\u5408\u76f8\u6bd4\uff0c\u63a5\u53e3\u7c7b\u578b\u7ec4\u5408\u4e0d\u4f1a\u51fa\u73b0\u65b9\u6cd5\u4e4b\u95f4\u7684\u5c4f\u853d\u3002 \u53ea\u8981\u7ec4\u5408\u7684\u63a5\u53e3\u4e4b\u95f4\u6709\u540c\u540d\u7684\u65b9\u6cd5\u5c31\u4f1a\u4ea7\u751f\u51b2\u7a81\uff0c\u4ece\u800c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1\uff0c\u5373\u4f7f\u540c\u540d\u65b9\u6cd5\u7684\u7b7e\u540d\u4e0d\u540c\u4e5f\u4e0d\u884c \u3002 \u4e0e\u7ed3\u6784\u4f53\u7ec4\u5408\u76f8\u4f3c\uff0c\u628a\u63a5\u53e3\u7c7b\u578b\u7684\u540d\u79f0\u76f4\u63a5\u5199\u5230\u53e6\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u6210\u5458\u7c7b\u522b\u4e2d\uff0c\u5982\u4e0b\u6240\u793a\uff1a type Animal interface { ScientificName() string Category() string } type Pet interface { Animal // \u5d4c\u5165 Name() string } // Animal\u63a5\u53e3\u5305\u542b\u7684\u6240\u4ee5\u65b9\u6cd5\u6210\u4e3a\u4e86Pet\u63a5\u53e3\u7684\u65b9\u6cd5 Go\u8bed\u8a00\u56e2\u961f\u9f13\u52b1\u58f0\u660e\u4f53\u91cf\u8f83\u5c0f\u7684\u63a5\u53e3\uff0c\u5e76\u5efa\u8bae\u901a\u8fc7\u63a5\u53e3\u7ec4\u5408\u6765\u6269\u5c55\u7a0b\u5e8f\u3001\u589e\u52a0\u7a0b\u5e8f\u7684\u7075\u6d3b\u6027\u3002\u76f8\u6bd4\u4e8e\u5305\u542b\u5f88\u591a\u65b9\u6cd5\u7684\u5927\u63a5\u53e3\uff0c\u5c0f\u63a5\u53e3\u53ef\u4ee5\u4e13\u7528\u5730\u8868\u8fbe\u67d0\u4e00\u79cd\u80fd\u529b\u6216\u67d0\u4e00\u7c7b\u7279\u5f81\uff0c\u4e5f\u66f4\u5bb9\u6613\u88ab\u7ec4\u5408\u5728\u4e00\u8d77\u3002","title":"\u63a5\u53e3\u4e4b\u95f4\u7684\u7ec4\u5408"},{"location":"Language/Basic/12-\u6307\u9488/","text":"\u6307\u9488 type Dog struct { // \u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u57fa\u672c\u7c7b\u578b name string } func (dog *Dog) SetName(name string) { // *Dog \u6307\u9488\u7c7b\u578b dog.name = name } SetName\u65b9\u6cd5\u7684\u63a5\u6536\u503c\u5c31\u662fDog\u7c7b\u578b\u7684\u6307\u9488\u503c\uff0c\u901a\u8fc7\u6307\u9488\u503c\u65e0\u7f1d\u8bbf\u95ee\u57fa\u672c\u503c\u5305\u542b\u7684\u4efb\u4f55\u5b57\u6bb5\u3001\u4ee5\u53ca\u8c03\u7528\u4e0e\u4e4b\u5173\u8054\u7684\u4efb\u4f55\u65b9\u6cd5\u3002 \u6307\u9488\u662f\u4e00\u4e2a \u6307\u5411\u67d0\u4e2a\u786e\u5207\u7684\u5185\u5b58\u5730\u5740\u7684\u503c \uff0c\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u6216\u4ee3\u7801\u7684\u8d77\u59cb\u5730\u5740\uff0c\u5982\uff0c\u67d0\u4e2a\u53d8\u91cf\u3001\u5b57\u6bb5\u3001\u51fd\u6570\u3002 Go\u8bed\u8a00\u4e2d\u7684\u6307\u9488 Go\u8bed\u8a00\u5185\u5efa\u7684\u6570\u636e\u7c7b\u578b\uff1auinptr\u7c7b\u578b\u662f\u4e00\u4e2a\u6570\u503c\u7c7b\u578b\uff0c\u6700\u8d34\u8fd1\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u6307\u9488\u3002\u6839\u636e\u8ba1\u7b97\u673a\u67b6\u6784\u7684\u4e0d\u540c\uff0c\u5b83\u53ef\u4ee5\u5b58\u50a832\u621664\u4e3a\u7684 \u65e0\u7b26\u53f7\u6574\u6570 \uff0c\u53ef\u4ee5\u4ee3\u8868\u4efb\u4f55\u6307\u9488\u7684\u4f4d\uff08bit\uff09\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u539f\u59cb\u7684\u5185\u5b58\u5730\u5740\u3002 \u6807\u51c6\u5e93unsafe\u5305\u4e2d\u7684Pointer\u7c7b\u578b\uff0c\u4ee3\u8868\u4e86\u6307\u9488\u3002 unsafe.Pointer \u53ef\u4ee5\u8868\u793a\u4efb\u4f55\u6307\u5411\u53ef\u5bfb\u5740\u7684\u503c\u7684\u6307\u9488\uff0c\u5b83\u4e5f\u662f\u6307\u9488\u503c\u548cuintptr\u503c\u4e4b\u95f4\u7684\u6865\u6881\u3002\u901a\u8fc7\u5b83\u53ef\u4ee5\u5728\u8fd9\u4e24\u8005\u4e4b\u95f4\u8f6c\u6362\u3002 \u53ef\u5bfb\u5740\u7684 \u4e0d\u53ef\u5bfb\u5740\u7684\u503c\uff1a package main type Named interface { // Name \u7528\u4e8e\u83b7\u53d6\u540d\u5b57\u3002 Name() string } type Dog struct { name string } func (dog *Dog) SetName(name string) { dog.name = name } func (dog Dog) Name() string { return dog.name } func main() { // \u793a\u4f8b1\u3002 const num = 123 //_ = num // \u5e38\u91cf\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (123) // \u57fa\u672c\u7c7b\u578b\u503c\u7684\u5b57\u9762\u91cf\u4e0d\u53ef\u5bfb\u5740\u3002 var str = abc _ = str //_ = (str[0]) // \u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (str[0:2]) // \u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 str2 := str[0] _ = str2 // \u4f46\u8fd9\u6837\u7684\u5bfb\u5740\u5c31\u662f\u5408\u6cd5\u7684\u3002\uff08 //_ = (123 + 456) // \u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 num2 := 456 _ = num2 //_ = (num + num2) // \u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = ([3]int{1, 2, 3}[0]) // \u5bf9\u6570\u7ec4\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = ([3]int{1, 2, 3}[0:2]) // \u5bf9\u6570\u7ec4\u5b57\u9762\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 _ = ([]int{1, 2, 3}[0]) // \u5bf9\u5207\u7247\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u5374\u662f\u53ef\u5bfb\u5740\u7684\u3002 //_ = ([]int{1, 2, 3}[0:2]) // \u5bf9\u5207\u7247\u5b57\u9762\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (map[int]string{1: a }[0]) // \u5bf9\u5b57\u5178\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 var map1 = map[int]string{1: a , 2: b , 3: c } _ = map1 //_ = (map1[2]) // \u5bf9\u5b57\u5178\u53d8\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (func(x, y int) int { // return x + y //}) // \u5b57\u9762\u91cf\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (fmt.Sprintf) // \u6807\u8bc6\u7b26\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (fmt.Sprintln( abc )) // \u5bf9\u51fd\u6570\u7684\u8c03\u7528\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 dog := Dog{ little pig } _ = dog //_ = (dog.Name) // \u6807\u8bc6\u7b26\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (dog.Name()) // \u5bf9\u65b9\u6cd5\u7684\u8c03\u7528\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (Dog{ little pig }.name) // \u7ed3\u6784\u4f53\u5b57\u9762\u91cf\u7684\u5b57\u6bb5\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (interface{}(dog)) // \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 dogI := interface{}(dog) _ = dogI //_ = (dogI.(Named)) // \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 named := dogI.(Named) _ = named //_ = (named.(Dog)) // \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 var chan1 = make(chan int, 1) chan1 - 1 //_ = ( -chan1) // \u63a5\u6536\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 } \u4e0d\u53ef\u5bfb\u5740\u7684\u603b\u7ed3\uff1a \u4e0d\u53ef\u53d8\u7684\uff1a\u5e38\u91cf\u3001\u57fa\u672c\u7c7b\u578b\u5b57\u9762\u91cf\u3001\u5b57\u7b26\u4e32\u3001\u51fd\u6570\u4ee5\u53ca\u65b9\u6cd5\u7684\u5b57\u9762\u91cf \u4e34\u65f6\u7ed3\u679c\uff1a\u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\uff0c\u5bf9\u6570\u7ec4\u503c\u3001\u5207\u7247\u503c\u3001\u5b57\u5178\u503c\u5b57\u9762\u91cf\u65bd\u52a0\u7684 \u8868\u8fbe\u5f0f \u7684\u6c42\u503c\u7ed3\u679c\uff1b \u5982\u679c\u628a\u4e00\u4e2a\u4e34\u65f6\u7ed3\u679c\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\uff0c\u90a3\u5b83\u5c31\u662f\u53ef\u5bfb\u5740\u7684 \u4e0d\u5b89\u5168: \u5b57\u5178\u7c7b\u578b\u7684\u53d8\u91cf\u65bd\u52a0\u7d22\u5f15\u503c\u5f97\u5230\u7684\u7ed3\u679c\u4e0d\u5c5e\u4e8e\u4e34\u65f6\u7ed3\u679c\uff0c\u4f46\u662f\u5b57\u5178\u4e2d\u952e\u503c\u5bf9\u7684\u5730\u5740\u662f\u4f1a\u53d8\u5316\u7684,\u83b7\u53d6\u6307\u9488\u4e0d\u5b89\u5168 \u5bf9\u51fd\u6570\u6216\u65b9\u6cd5\u7684\u8c03\u7528\u5c5e\u4e8e\u4e34\u65f6\u7ed3\u679c\u3001\u62ff\u5230\u4e00\u6bb5\u4ee3\u7801\u7684\u6307\u9488\u662f\u4e0d\u5b89\u5168\u7684 \u8868\u8fbe\u5f0f\u6574\u7406\uff1a \u7d22\u5f15\u8868\u8fbe\u5f0f \u5207\u7247\u8868\u793a\u5f0f \u9009\u62e9\u8868\u8fbe\u5f0f \u8c03\u7528\u8868\u8fbe\u5f0f \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f \u5411\u901a\u9053\u53d1\u9001\u6216\u8005\u4ece\u901a\u9053\u63a5\u6536\u7684\u63a5\u6536\u8868\u8fbe\u5f0f \u5bf9\u6570\u7ec4\u6216\u5207\u7247\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u7d22\u5f15\u6216\u5207\u7247\u7684\u7ed3\u679c\u503c\u4e0d\u662f\u4e34\u65f6\u7ed3\u679c \u3002 \u4e0d\u53ef\u5bfb\u5740\u7684\u503c\u7684\u4f7f\u7528\u9650\u5236 \u65e0\u6cd5\u4f7f\u7528\u53d6\u5730\u5740\u64cd\u4f5c\u7b26\uff08 \uff09\u83b7\u53d6\u6307\u9488\uff1b \u5bf9\u4e0d\u53ef\u5bfb\u5740\u503c\u53d6\u5730\u5740\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519 \u5728\u4e0a\u8ff0\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u7f16\u5199\u65b0\u51fd\u6570\uff1a func New(name string) Dog { return Dog{name} } func main() { New( little pig ).SetName( monster ) // \u7f16\u8bd1\u62a5\u9519\uff0c\u4e0d\u80fd\u53d6\u5f97New( little pig )\u7684\u5730\u5740 } \u4f8b\u5916\u60c5\u51b5\uff1a ++ \u6216 -- \u7684\u5de6\u8fb9\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff08\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff09\uff0c\u5c31\u53ef\u4ee5\u7ec4\u6210\u4e00\u4e2a\u81ea\u589e\u6216\u81ea\u51cf\u8bed\u53e5\uff0c\u6240\u4ee5\u9488\u5bf9\u503c\u5b57\u9762\u91cf\u7684\u8868\u8fbe\u5f0f\u51e0\u4e4e\u90fd\u65e0\u6cd5\u5728\u8fd9\u91cc\u4f7f\u7528\u3002 \u5b57\u5178\u5b57\u9762\u91cf\u548c\u7d22\u5f15\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7528 \u3002 \u8d4b\u503c\u8bed\u53e5\u4e2d\uff0c\u8d4b\u503c\u64cd\u4f5c\u5de6\u8fb9\u7684\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff0c \u5b57\u5178\u7684\u7d22\u5f15\u7ed3\u679c\u53ef\u7528 \u5e26range\u5b50\u53e5\u7684for\u5faa\u73af\u4e2d\uff0crange\u5173\u952e\u5b57\u5de6\u8fb9\u7684\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff0c \u5b57\u5178\u7684\u7d22\u5f15\u7ed3\u679c\u53ef\u7528","title":"\u6307\u9488"},{"location":"Language/Basic/12-\u6307\u9488/#_1","text":"type Dog struct { // \u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u57fa\u672c\u7c7b\u578b name string } func (dog *Dog) SetName(name string) { // *Dog \u6307\u9488\u7c7b\u578b dog.name = name } SetName\u65b9\u6cd5\u7684\u63a5\u6536\u503c\u5c31\u662fDog\u7c7b\u578b\u7684\u6307\u9488\u503c\uff0c\u901a\u8fc7\u6307\u9488\u503c\u65e0\u7f1d\u8bbf\u95ee\u57fa\u672c\u503c\u5305\u542b\u7684\u4efb\u4f55\u5b57\u6bb5\u3001\u4ee5\u53ca\u8c03\u7528\u4e0e\u4e4b\u5173\u8054\u7684\u4efb\u4f55\u65b9\u6cd5\u3002 \u6307\u9488\u662f\u4e00\u4e2a \u6307\u5411\u67d0\u4e2a\u786e\u5207\u7684\u5185\u5b58\u5730\u5740\u7684\u503c \uff0c\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u53ef\u4ee5\u662f\u4efb\u4f55\u6570\u636e\u6216\u4ee3\u7801\u7684\u8d77\u59cb\u5730\u5740\uff0c\u5982\uff0c\u67d0\u4e2a\u53d8\u91cf\u3001\u5b57\u6bb5\u3001\u51fd\u6570\u3002","title":"\u6307\u9488"},{"location":"Language/Basic/12-\u6307\u9488/#go","text":"Go\u8bed\u8a00\u5185\u5efa\u7684\u6570\u636e\u7c7b\u578b\uff1auinptr\u7c7b\u578b\u662f\u4e00\u4e2a\u6570\u503c\u7c7b\u578b\uff0c\u6700\u8d34\u8fd1\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u6307\u9488\u3002\u6839\u636e\u8ba1\u7b97\u673a\u67b6\u6784\u7684\u4e0d\u540c\uff0c\u5b83\u53ef\u4ee5\u5b58\u50a832\u621664\u4e3a\u7684 \u65e0\u7b26\u53f7\u6574\u6570 \uff0c\u53ef\u4ee5\u4ee3\u8868\u4efb\u4f55\u6307\u9488\u7684\u4f4d\uff08bit\uff09\u6a21\u5f0f\uff0c\u4e5f\u5c31\u662f\u539f\u59cb\u7684\u5185\u5b58\u5730\u5740\u3002 \u6807\u51c6\u5e93unsafe\u5305\u4e2d\u7684Pointer\u7c7b\u578b\uff0c\u4ee3\u8868\u4e86\u6307\u9488\u3002 unsafe.Pointer \u53ef\u4ee5\u8868\u793a\u4efb\u4f55\u6307\u5411\u53ef\u5bfb\u5740\u7684\u503c\u7684\u6307\u9488\uff0c\u5b83\u4e5f\u662f\u6307\u9488\u503c\u548cuintptr\u503c\u4e4b\u95f4\u7684\u6865\u6881\u3002\u901a\u8fc7\u5b83\u53ef\u4ee5\u5728\u8fd9\u4e24\u8005\u4e4b\u95f4\u8f6c\u6362\u3002","title":"Go\u8bed\u8a00\u4e2d\u7684\u6307\u9488"},{"location":"Language/Basic/12-\u6307\u9488/#_2","text":"\u4e0d\u53ef\u5bfb\u5740\u7684\u503c\uff1a package main type Named interface { // Name \u7528\u4e8e\u83b7\u53d6\u540d\u5b57\u3002 Name() string } type Dog struct { name string } func (dog *Dog) SetName(name string) { dog.name = name } func (dog Dog) Name() string { return dog.name } func main() { // \u793a\u4f8b1\u3002 const num = 123 //_ = num // \u5e38\u91cf\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (123) // \u57fa\u672c\u7c7b\u578b\u503c\u7684\u5b57\u9762\u91cf\u4e0d\u53ef\u5bfb\u5740\u3002 var str = abc _ = str //_ = (str[0]) // \u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (str[0:2]) // \u5bf9\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 str2 := str[0] _ = str2 // \u4f46\u8fd9\u6837\u7684\u5bfb\u5740\u5c31\u662f\u5408\u6cd5\u7684\u3002\uff08 //_ = (123 + 456) // \u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 num2 := 456 _ = num2 //_ = (num + num2) // \u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = ([3]int{1, 2, 3}[0]) // \u5bf9\u6570\u7ec4\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = ([3]int{1, 2, 3}[0:2]) // \u5bf9\u6570\u7ec4\u5b57\u9762\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 _ = ([]int{1, 2, 3}[0]) // \u5bf9\u5207\u7247\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u5374\u662f\u53ef\u5bfb\u5740\u7684\u3002 //_ = ([]int{1, 2, 3}[0:2]) // \u5bf9\u5207\u7247\u5b57\u9762\u91cf\u7684\u5207\u7247\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (map[int]string{1: a }[0]) // \u5bf9\u5b57\u5178\u5b57\u9762\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 var map1 = map[int]string{1: a , 2: b , 3: c } _ = map1 //_ = (map1[2]) // \u5bf9\u5b57\u5178\u53d8\u91cf\u7684\u7d22\u5f15\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (func(x, y int) int { // return x + y //}) // \u5b57\u9762\u91cf\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (fmt.Sprintf) // \u6807\u8bc6\u7b26\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (fmt.Sprintln( abc )) // \u5bf9\u51fd\u6570\u7684\u8c03\u7528\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 dog := Dog{ little pig } _ = dog //_ = (dog.Name) // \u6807\u8bc6\u7b26\u4ee3\u8868\u7684\u51fd\u6570\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (dog.Name()) // \u5bf9\u65b9\u6cd5\u7684\u8c03\u7528\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (Dog{ little pig }.name) // \u7ed3\u6784\u4f53\u5b57\u9762\u91cf\u7684\u5b57\u6bb5\u4e0d\u53ef\u5bfb\u5740\u3002 //_ = (interface{}(dog)) // \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 dogI := interface{}(dog) _ = dogI //_ = (dogI.(Named)) // \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 named := dogI.(Named) _ = named //_ = (named.(Dog)) // \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 var chan1 = make(chan int, 1) chan1 - 1 //_ = ( -chan1) // \u63a5\u6536\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0d\u53ef\u5bfb\u5740\u3002 } \u4e0d\u53ef\u5bfb\u5740\u7684\u603b\u7ed3\uff1a \u4e0d\u53ef\u53d8\u7684\uff1a\u5e38\u91cf\u3001\u57fa\u672c\u7c7b\u578b\u5b57\u9762\u91cf\u3001\u5b57\u7b26\u4e32\u3001\u51fd\u6570\u4ee5\u53ca\u65b9\u6cd5\u7684\u5b57\u9762\u91cf \u4e34\u65f6\u7ed3\u679c\uff1a\u7b97\u672f\u64cd\u4f5c\u7684\u7ed3\u679c\uff0c\u5bf9\u6570\u7ec4\u503c\u3001\u5207\u7247\u503c\u3001\u5b57\u5178\u503c\u5b57\u9762\u91cf\u65bd\u52a0\u7684 \u8868\u8fbe\u5f0f \u7684\u6c42\u503c\u7ed3\u679c\uff1b \u5982\u679c\u628a\u4e00\u4e2a\u4e34\u65f6\u7ed3\u679c\u8d4b\u7ed9\u4e00\u4e2a\u53d8\u91cf\uff0c\u90a3\u5b83\u5c31\u662f\u53ef\u5bfb\u5740\u7684 \u4e0d\u5b89\u5168: \u5b57\u5178\u7c7b\u578b\u7684\u53d8\u91cf\u65bd\u52a0\u7d22\u5f15\u503c\u5f97\u5230\u7684\u7ed3\u679c\u4e0d\u5c5e\u4e8e\u4e34\u65f6\u7ed3\u679c\uff0c\u4f46\u662f\u5b57\u5178\u4e2d\u952e\u503c\u5bf9\u7684\u5730\u5740\u662f\u4f1a\u53d8\u5316\u7684,\u83b7\u53d6\u6307\u9488\u4e0d\u5b89\u5168 \u5bf9\u51fd\u6570\u6216\u65b9\u6cd5\u7684\u8c03\u7528\u5c5e\u4e8e\u4e34\u65f6\u7ed3\u679c\u3001\u62ff\u5230\u4e00\u6bb5\u4ee3\u7801\u7684\u6307\u9488\u662f\u4e0d\u5b89\u5168\u7684 \u8868\u8fbe\u5f0f\u6574\u7406\uff1a \u7d22\u5f15\u8868\u8fbe\u5f0f \u5207\u7247\u8868\u793a\u5f0f \u9009\u62e9\u8868\u8fbe\u5f0f \u8c03\u7528\u8868\u8fbe\u5f0f \u7c7b\u578b\u8f6c\u6362\u8868\u8fbe\u5f0f \u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f \u5411\u901a\u9053\u53d1\u9001\u6216\u8005\u4ece\u901a\u9053\u63a5\u6536\u7684\u63a5\u6536\u8868\u8fbe\u5f0f \u5bf9\u6570\u7ec4\u6216\u5207\u7247\u7c7b\u578b\u7684\u53d8\u91cf\u7684\u7d22\u5f15\u6216\u5207\u7247\u7684\u7ed3\u679c\u503c\u4e0d\u662f\u4e34\u65f6\u7ed3\u679c \u3002","title":"\u53ef\u5bfb\u5740\u7684"},{"location":"Language/Basic/12-\u6307\u9488/#_3","text":"\u65e0\u6cd5\u4f7f\u7528\u53d6\u5730\u5740\u64cd\u4f5c\u7b26\uff08 \uff09\u83b7\u53d6\u6307\u9488\uff1b \u5bf9\u4e0d\u53ef\u5bfb\u5740\u503c\u53d6\u5730\u5740\uff0c\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519 \u5728\u4e0a\u8ff0\u4f8b\u5b50\u7684\u57fa\u7840\u4e0a\u7f16\u5199\u65b0\u51fd\u6570\uff1a func New(name string) Dog { return Dog{name} } func main() { New( little pig ).SetName( monster ) // \u7f16\u8bd1\u62a5\u9519\uff0c\u4e0d\u80fd\u53d6\u5f97New( little pig )\u7684\u5730\u5740 } \u4f8b\u5916\u60c5\u51b5\uff1a ++ \u6216 -- \u7684\u5de6\u8fb9\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff08\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff09\uff0c\u5c31\u53ef\u4ee5\u7ec4\u6210\u4e00\u4e2a\u81ea\u589e\u6216\u81ea\u51cf\u8bed\u53e5\uff0c\u6240\u4ee5\u9488\u5bf9\u503c\u5b57\u9762\u91cf\u7684\u8868\u8fbe\u5f0f\u51e0\u4e4e\u90fd\u65e0\u6cd5\u5728\u8fd9\u91cc\u4f7f\u7528\u3002 \u5b57\u5178\u5b57\u9762\u91cf\u548c\u7d22\u5f15\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7528 \u3002 \u8d4b\u503c\u8bed\u53e5\u4e2d\uff0c\u8d4b\u503c\u64cd\u4f5c\u5de6\u8fb9\u7684\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff0c \u5b57\u5178\u7684\u7d22\u5f15\u7ed3\u679c\u53ef\u7528 \u5e26range\u5b50\u53e5\u7684for\u5faa\u73af\u4e2d\uff0crange\u5173\u952e\u5b57\u5de6\u8fb9\u7684\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u5fc5\u987b\u662f\u53ef\u5bfb\u5740\u7684\uff0c \u5b57\u5178\u7684\u7d22\u5f15\u7ed3\u679c\u53ef\u7528","title":"\u4e0d\u53ef\u5bfb\u5740\u7684\u503c\u7684\u4f7f\u7528\u9650\u5236"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/","text":"Go\u8bed\u53e5\u53ca\u5176\u6267\u884c\u89c4\u5219 Don't communicate by sharing memory; share memory by communicating. \u4e0d\u8981\u901a\u8fc7\u5171\u4eab\u6570\u636e\u6765\u901a\u8baf\uff0c\u4ee5\u901a\u8baf\u7684\u65b9\u5f0f\u6765\u5171\u4eab\u6570\u636e\u3002 channel\u7c7b\u578b\u7684\u503c\uff0c\u88ab\u7528\u6765\u4ee5\u901a\u8baf\u7684\u65b9\u5f0f\u5171\u4eab\u6570\u636e\u3002\u4e00\u822c\u88ab\u7528\u6765\u5728\u4e0d\u540c\u7684goroutine\uff08\u4ee3\u8868\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u4e2d\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\uff09\u4e4b\u95f4\u4f20\u9012\u6570\u636e\u3002 \u8fdb\u7a0b\u4e0e\u7ebf\u7a0b \u8fdb\u7a0b\uff1a\u63cf\u8ff0\u7684\u5c31\u662f\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u662f\u8fd0\u884c\u7740\u7684\u7a0b\u5e8f\u7684\u4ee3\u8868\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u5176\u5b9e\u5c31\u662f\u67d0\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u7684\u4e00\u4e2a\u4ea7\u7269\u3002\uff08\u9759\u9759\u8eba\u5728\u90a3\u91cc\u7684\u4ee3\u7801\u662f\u7a0b\u5e8f\u3001\u5954\u8dd1\u7740\u3001\u6b63\u5728\u53d1\u6325\u529f\u80fd\u7684\u4ee3\u7801\u5c31\u662f\u8fdb\u7a0b\uff09\u3002 \u7ebf\u7a0b\uff1a\u603b\u662f\u5728\u8fdb\u7a0b\u4e4b\u5185\uff0c\u88ab\u89c6\u4e3a\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u7740\u7684\u63a7\u5236\u6d41\uff08\u4ee3\u7801\u6267\u884c\u6d41\u7a0b\uff09\u3002 \u4e00\u4e2a\u8fdb\u7a0b\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u53ea\u5305\u542b\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u6240\u4ee5\u4ee3\u7801\u4f1a\u88ab\u4e32\u884c\u6267\u884c\u3002 \u6bcf\u4e2a\u8fdb\u7a0b\u7684\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u90fd\u4f1a\u968f\u7740\u8be5\u8fdb\u7a0b\u7684\u542f\u52a8\u800c\u88ab\u521b\u5efa\uff0c\u79f0\u5b83\u4e3a\u6240\u5c5e\u8fdb\u7a0b\u7684\u4e3b\u7ebf\u7a0b \u3002\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u5305\u542b\u591a\u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u4ee3\u7801\u53ef\u4ee5\u88ab\u5e76\u53d1\u5730\u6267\u884c\uff0c \u9664\u4e86\u4e3b\u7ebf\u7a0b\uff0c\u5176\u4ed6\u7ebf\u7a0b\u90fd\u662f\u8fdb\u7a0b\u4e2d\u5df2\u5b58\u5728\u7684\u7ebf\u7a0b\u521b\u5efa\u51fa\u6765\u7684 \u3002 \u4e3b\u7ebf\u7a0b\u4e4b\u5916\u7684\u5176\u4ed6\u7ebf\u7a0b\uff0c\u53ea\u80fd\u7531\u4ee3\u7801\u663e\u5f0f\u5730\u521b\u5efa\u548c\u9500\u6bc1 \u3002 \u7ebf\u7a0b\u7c7b\u522b \u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff1a\u5728Go\u8bed\u8a00\u7684\u8fd0\u884c\u65f6\u4e2d\uff0c\u7cfb\u7edf\u4f1a\u5e2e\u52a9\u6211\u4eec\u81ea\u52a8\u5730\u521b\u5efa\u548c\u9500\u6bc1 \u7cfb\u7edf\u7ea7\u7684\u7ebf\u7a0b \uff08\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u7ebf\u7a0b\uff09\u3002 \u7528\u6237\u7ea7\u7ebf\u7a0b\uff1a\u67b6\u8bbe\u5728\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u4e4b\u4e0a\uff0c\u7531\u7528\u6237\uff08\u6211\u4eec\u7f16\u5199\u7684\u7a0b\u5e8f\uff09\u5b8c\u5168\u63a7\u5236\u7684\u4ee3\u7801\u6267\u884c\u6d41\u7a0b\uff0c\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u3001\u9500\u6bc1\u3001\u8c03\u5ea6\u3001\u72b6\u6001\u53d8\u66f4\u4ee5\u53ca\u5176\u4e2d\u7684\u4ee3\u7801\u548c\u6570\u636e\u90fd\u5b8c\u5168\u9700\u8981\u7a0b\u5e8f\u81ea\u5df1\u53bb\u5b9e\u73b0\u548c\u5904\u7406\u3002 \u7528\u6237\u7ea7\u7ebf\u7a0b \u4f18\u52bf\uff1a\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u9500\u6bc1\u4e0d\u540c\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\uff0c\u901f\u5ea6\u5feb\uff0c\u4e0d\u7528\u7b49\u5f85\u64cd\u4f5c\u7cfb\u7edf\u53bb\u8c03\u5ea6\u5b83\u4eec\u8fd0\u884c\uff0c\u6240\u4ee5\u5bb9\u6613\u63a7\u5236\u4e14\u7075\u6d3b\u3002 \u52a3\u52bf\uff1a\u590d\u6742\uff0c\u5982\u679c\u53ea\u662f\u7528\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff0c\u90a3\u4e48\u53ea\u8981\u6307\u660e\u9700\u8981\u65b0\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u5e76\u4e14\u4e0b\u8fbe\u521b\u5efa\u6216\u9500\u6bc1\u7ebf\u7a0b\u7684\u6307\u4ee4\u5c31\u597d\uff0c\u5176\u4ed6\u7684\u5177\u4f53\u5b9e\u73b0\u7531\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u52b3\u3002\u6211\u4eec\u5fc5\u987b\u5168\u6743\u8d1f\u8d23\u4e0e\u7528\u6237\u7ea7\u7ebf\u7a0b\u76f8\u5173\u7684\u6240\u4ee5\u5177\u4f53\u7684\u5b9e\u73b0\uff0c\u5e76\u4e14\u9700\u8981\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e89\u53d6\u5bf9\u63a5\uff0c\u5426\u5219\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u8fd0\u884c\u3002 \u8c03\u5ea6\u5668 Go\u8bed\u8a00\u62e5\u6709\uff1a \u72ec\u7279\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b \u7528\u6237\u7ea7\u7ebf\u7a0bgoroutine \u5f3a\u5927\u7684\u7528\u4e8e\u8c03\u5ea6goroutine\u3001\u5bf9\u63a5\u64cd\u4f5c\u7cfb\u7edf\u7684\u8c03\u5ea6\u5668 \u8fd9\u4e2a\u8c03\u5ea6\u5668\u662fGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0c\u4e3b\u8981\u8d1f\u8d23\u7edf\u7b79\u8c03\u914dGo\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u4e2d\u7684\u4e09\u4e2a\u4e3b\u8981\u5143\u7d20\uff1a G\uff08goroutine\uff09:\u7528\u6237\u7ea7\u7ebf\u7a0b P\uff08processor\uff09\uff1a\u53ef\u4ee5\u627f\u8f7d\u82e5\u5e72\u4e2agoroutine\uff0c\u4e14\u80fd\u591f\u4f7f\u8fd9\u4e9bgoroutine\u9002\u65f6\u5730\u4e0e\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5bf9\u63a5\uff0c\u5e76\u5f97\u5230\u771f\u6b63\u8fd0\u884c\u7684\u4e2d\u4ecb M\uff08machine\uff09\uff1a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b \u5b8f\u89c2\u4e0a\u8bb2\uff0c\u7531\u4e8eP\u7684\u5b58\u5728\uff0c\u7528\u6237\u7ea7\u7ebf\u7a0b\u548c\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u53ef\u4ee5\u5448\u73b0\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u3002 \u4f8b\u5982\uff1a \u5f53\u4e00\u4e2a\u6b63\u5728\u4e0e\u67d0\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5bf9\u63a5\u5e76\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u9700\u8981\u56e0\u67d0\u4e2a\u4e8b\u4ef6\uff08\u7b49\u5f85IO\u6216\u9501\u7684\u89e3\u9664\uff09\u800c\u6682\u505c\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u603b\u4f1a\u53ca\u65f6\u53d1\u73b0\uff0c\u5e76\u628a\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u548c\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5206\u79bb\uff0c\u4ee5\u91ca\u653e\u8ba1\u7b97\u8d44\u6e90\u4f9b\u5176\u4ed6\u7b49\u5f85\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f7f\u7528\u3002 \u5f53\u4e00\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u9700\u8981\u6062\u590d\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u53c8\u4f1a\u5c3d\u5feb\u4e3a\u4ed6\u5bfb\u627e\u7a7a\u95f2\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5305\u62ec\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff09\u5e76\u5b89\u6392\u8fd0\u884c\u3002 \u5f53\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u4e0d\u591f\u7528\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u4f1a\u5e2e\u6211\u4eec\u60f3\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u65b0\u7684\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u3002 \u5f53\u67d0\u4e00\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5df2\u7ecf\u65e0\u7528\u65f6\uff0c\u8c03\u5ea6\u5668\u4f1a\u8d1f\u8d23\u628a\u5b83\u53ca\u65f6\u9500\u6bc1\u6389\u3002 \u56e0\u4e3a\u8c03\u5ea6\u5668\u5e2e\u6211\u4eec\u505a\u4e86\u5f88\u591a\u4e8b\uff0c\u6240\u4ee5Go\u7a0b\u5e8f\u624d\u80fd\u9ad8\u6548\u5730\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u548c\u8ba1\u7b97\u673a\u8d44\u6e90 \u3002\u7a0b\u5e8f\u4e2d\u6240\u4ee5\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u90fd\u4f1a\u88ab\u5145\u5206\u5730\u8c03\u5ea6\uff0c\u5176\u4e2d\u7684\u4ee3\u7801\u4e5f\u90fd\u4f1a\u5e76\u53d1\u5730\u8fd0\u884c\uff0c\u5373\u4f7f\u7528\u6237\u7ea7\u7ebf\u7a0b\u6709\u6570\u5341\u4e07\u8ba1\u3002 goroutine\u6700\u4f73\u5b9e\u8df5 package main import fmt func main() { for i := 0; i 10; i++ { go func() { fmt.Println(i) }() } } \u4ee3\u7801\u6267\u884c\u540e\uff0c\u4e0d\u4f1a\u6709\u4efb\u4f55\u5185\u5bb9\u8f93\u51fa\u3002 \u4e0e\u4e00\u4e2a\u8fdb\u7a0b\u603b\u4f1a\u6709\u4e00\u4e2a\u4e3b\u7ebf\u7a0b\u7c7b\u4f3c\uff0c\u6bcf\u4e00\u4e2a\u72ec\u7acb\u7684Go\u7a0b\u5e8f\u8fd0\u884c\u8d77\u6765\u603b\u4f1a\u6709\u4e00\u4e2a\u4e3b\u7528\u6237\u7ebf\u7a0b\uff08goroutine\uff09\u3002 \u8fd9\u4e2a\u4e3bgoroutine\u4f1a\u5728Go\u7a0b\u5e8f\u7684\u8fd0\u884c\u51c6\u5907\u5de5\u4f5c\u5b8c\u6210\u540e\u88ab\u81ea\u52a8\u5730\u542f\u7528 \uff0c\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u624b\u52a8\u64cd\u4f5c\u3002 \u6bcf\u6761go\u8bed\u53e5\u4e00\u822c\u90fd\u4f1a\u643a\u5e26\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u8fd9\u4e2a\u88ab\u8c03\u7528\u7684\u51fd\u6570\u88ab\u79f0\u4e3ago\u51fd\u6570\uff0c\u4e3b\u7528\u6237\u7ebf\u7a0b\uff08goroutine\uff09\u7684go\u51fd\u6570\uff0c\u5c31\u662f\u90a3\u4e2a\u7a0b\u5e8f\u5165\u53e3\u7684main\u51fd\u6570\u3002 \u5df2\u7ecf\u5b58\u5728\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u88ab\u4f18\u5148\u590d\u7528\uff1a go\u51fd\u6570\u88ab\u771f\u6b63\u6267\u884c\u7684\u65f6\u95f4\uff0c\u603b\u4f1a\u4e0e\u5176\u6240\u5c5e\u7684go\u8bed\u53e5\u88ab\u6267\u884c\u7684\u65f6\u95f4\u4e0d\u540c \u3002\u5f53\u7a0b\u5e8f\u6267\u884c\u5230\u4e00\u6761go\u8bed\u53e5\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u4f1a\u5148\u8bd5\u56fe\u4ece\u67d0\u4e2a\u5b58\u653e\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u961f\u5217\u4e2d\u83b7\u53d6\u67d0\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u5b83\u53ea\u6709\u627e\u4e0d\u5230\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u60c5\u51b5\u4eec\u624d\u4f1a\u53bb\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u3002 \u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u6210\u672c\u5f88\u4f4e\uff1a \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u5e76\u4e0d\u4f1a\u50cf\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\u6216\u8005\u4e00\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u90a3\u6837\uff0c\u5fc5\u987b\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u7684\u7cfb\u7edf\u8c03\u7528\u6765\u5b8c\u6210\uff0c\u5728Go\u8bed\u8a00\u7684\u8fd0\u884c\u65f6\u7cfb\u7edf\u5185\u90e8\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e86\uff0c\u4e00\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u5c31\u76f8\u5f53\u4e8e\u9700\u8981\u5e76\u53d1\u6267\u884c\u4ee3\u7801\u7247\u6bb5\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u3002 \u5728\u62ff\u5230\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e4b\u540e\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4f1a\u7528\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u53bb\u5305\u88c5\u90a3\u4e2ago\u51fd\u6570\uff08\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\uff09\uff0c\u7136\u540e\u518d\u628a\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u8ffd\u52a0\u5230\u67d0\u4e2a\u53ef\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u961f\u5217\uff08\u5148\u8fdb\u5148\u51fa\uff09\u4e2d\u3002\u867d\u7136\u5728\u961f\u5217\u4e2d\u88ab\u5b89\u6392\u8fd0\u884c\u7684\u65f6\u95f4\u5f88\u5feb\uff0c\u4e0a\u8ff0\u7684\u51c6\u5907\u5de5\u4f5c\u4e5f\u4e0d\u53ef\u907f\u514d\uff0c\u56e0\u6b64\u5b58\u5728\u4e00\u5b9a\u65f6\u95f4\u6d88\u8017\u3002 \u6240\u4ee5go\u51fd\u6570\u7684\u6267\u884c\u65f6\u95f4\uff0c\u603b\u662f\u4f1a\u660e\u663e\u6ede\u540e\uff08\u76f8\u5bf9\u4e8eCPU\u548cGo\u7a0b\u5e8f\uff09\u4e0ego\u8bed\u53e5\u7684\u6267\u884c\u65f6\u95f4 \u3002 \u53ea\u8981go\u8bed\u53e5\u672c\u8eab\u6267\u884c\u5b8c\u6bd5\uff0cGo\u7a0b\u5e8f\u5b8c\u5168\u4e0d\u7528\u7b49\u5f85go\u51fd\u6570\u7684\u6267\u884c\uff0c\u5b83\u4f1a\u7acb\u523b\u53bb\u6267\u884c\u540e\u9762\u7684\u8bed\u53e5\uff0c\u8fd9\u5c31\u662f\u5f02\u6b65\u5e76\u53d1\u6267\u884c \u3002 \u6ce8\u610f\uff1a\u4e00\u70b9\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\uff08main\u51fd\u6570\u4e2d\u7684\u90a3\u4e9b\u4ee3\u7801\uff09\u6267\u884c\u5b8c\u6bd5\uff0c\u5f53\u524d\u7684Go\u7a0b\u5e8f\u5c31\u4f1a\u7ed3\u675f\u8fd0\u884c\u3002\u5982\u679c\u5728Go\u7a0b\u5e8f\u7ed3\u675f\u7684\u90a3\u4e00\u523b\uff0c\u8fd8\u6709\u7528\u6237\u7ea7\u7ebf\u7a0b\u6ca1\u6709\u8fd0\u9500\uff0c\u90a3\u5c31\u6ca1\u6709\u673a\u4f1a\u8fd0\u884c\u4e86\u3002 \u4e25\u683c\u7684\u8bf4\uff0cGo\u8bed\u8a00\u5e76\u4e0d\u4f1a\u4fdd\u8bc1\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u4ee5\u600e\u6837\u7684\u987a\u5e8f\u8fd0\u884c\uff0c\u56e0\u4e3a\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e00\u8d77\u63a5\u53d7\u8c03\u5ea6\uff0c\u53c8\u56e0\u4e3a\u8c03\u5ea6\u5668\u5f88\u53ef\u80fd\u4f1a\u5728\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e2d\u7684\u4ee3\u7801\u53ea\u6267\u884c\u4e86\u4e00\u90e8\u5206\u7684\u65f6\u5019\u6682\u505c\uff0c\u4ee5\u671f\u6240\u6709\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u6709\u66f4\u516c\u5e73\u7684\u8fd0\u884c\u673a\u4f1a\u3002\u6240\u4ee5\u54ea\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u5148\u6267\u884c\u5b8c\uff0c\u662f\u4e0d\u53ef\u9884\u77e5\u7684\uff0c\u9664\u975e\u4f7f\u7528\u4e86\u67d0\u79cdGo\u8bed\u8a00\u63d0\u4f9b\u7684\u65b9\u5f0f\u8fdb\u884c\u4eba\u4e3a\u5e72\u9884\u3002 \u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\u7b49\u5f85\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b \u8ba9\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b Sleep() \u4e00\u4f1a\uff1a\u4f46\u662f\u65f6\u95f4\u96be\u4ee5\u628a\u63e1 \u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\u8fd0\u884c\u5b8c\u6bd5\u4e4b\u540e\u53d1\u51fa\u901a\u77e5\uff1a\u521b\u5efa\u4e00\u4e2a\u901a\u9053\uff0c\u957f\u5ea6\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e00\u81f4\uff0c\u6bcf\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u8fd0\u884c\u5b8c\u6bd5\u7684\u65f6\u5019\u5411\u901a\u9053\u4e2d\u53d1\u9001\u4e00\u4e2a\u503c\uff08\u5728go\u51fd\u6570\u7684\u6700\u540e\u53d1\u9001\uff09\uff0c\u5728main\u51fd\u6570\u7684\u6700\u540e\u63a5\u6536\u901a\u9053\u4e2d\u7684\u503c\uff0c\u63a5\u6536\u6b21\u6570\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u6570\u91cf\u4e00\u76f4 sync\u5305\u4e2d\u7684 sync.WaitGroup \u7c7b\u578b sign := make(chan struct{}, num) // \u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u901a\u9053 sign - struct{}{} - sign struct{} \u7c7b\u4f3c\u4e8e\u7a7a\u63a5\u53e3 interface{} \uff0c\u4ee3\u8868\u65e2\u4e0d\u5305\u542b\u4efb\u4f55\u5b57\u6bb5\u4e5f\u4e0d\u62e5\u6709\u4efb\u4f55\u65b9\u6cd5\u7684\u7a7a\u7ed3\u6784\u4f53\u7c7b\u578b\u3002 struct{} \u7c7b\u578b\u7684\u503c\u8868\u793a\u6cd5\u53ea\u8981\u4e00\u4e2a\uff0c struct{}{} \uff0c\u5b83\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u662f0\u5b57\u8282\u3002\u8fd9\u4e2a\u503c\u5728\u6574\u4e2aGo\u7a0b\u5e8f\u4e2d\u6c38\u8fdc\u90fd\u53ea\u4f1a\u5b58\u5728\u4e00\u4efd \u3002\u65e0\u6570\u6b21\u7684\u8bd5\u7528\u8fd9\u4e2a\u503c\u7684\u5b57\u9762\u91cf\uff0c\u4f46\u662f\u7528\u5230\u7684\u5374\u662f\u540c\u4e00\u4e2a\u503c\u3002 \u7528\u6237\u7ea7\u7ebf\u7a0b\u6309\u987a\u5e8f\u6267\u884c package main import \uff08 fmt sync/atomic time ) func main() { // \u7528\u6237\u7ea7\u7ebf\u7a0b\u968f\u673a\u6267\u884c for i := 0; i 10; i++ { go func() { fmt.Println(i) }() } // \u7528\u6237\u7ea7\u7ebf\u7a0b\u6309\u987a\u5e8f\u6267\u884c for i := 0; i 10; i++ { go func(i int) { // \u8ba9go\u51fd\u6570\u63a5\u6536\u4e00\u4e2aint\u578b\u53c2\u6570\uff0c\u5728\u8c03\u7528\u5b83\u7684\u65f6\u5019\uff0c\u628a\u53d8\u91cf\u4f20\u8fdb\u53bb fmt.Println(i) // \u8fd9\u6837Go\u8bed\u8a00\u5305\u88c5\u6bcf\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u62ff\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u6574\u6570 }(i) } // \u5728go\u8bed\u53e5\u88ab\u6267\u884c\u65f6\uff0c\u4f20\u7ed9go\u51fd\u6570\u7684\u53c2\u6570`i`\u4f1a\u88ab\u5148\u6c42\u503c\uff0c\u5982\u6b64\u5c31\u5f97\u5230\u4e86\u6863\u6b21\u8fed\u4ee3\u7684\u5e8f\u53f7\uff0c // \u4e4b\u540e\uff0c\u65e0\u8bbago\u51fd\u6570\u4f1a\u5728\u4ec0\u4e48\u65f6\u5019\u6267\u884c\uff0c\u8fd9\u4e2a\u53c2\u6570\u503c\u90fd\u4e0d\u4f1a\u53d8\uff0c // \u4e5f\u5c31\u662fgo\u51fd\u6570\u4e2d\u8c03\u7528`fmt.Prinrln`\u51fd\u6570\u6253\u5370\u7684\u4e00\u5b9a\u662f\u90a3\u4e2a\u5f53\u6b21\u8fed\u4ee3\u7684\u5e8f\u53f7\u3002 var count uint32 for i := uint32(0); i 10; i++ { go func(i uint32) { fn := func() { fmt.Println(i) } trigger(i, fn) }(i) } trigger := func(i uint32, fn func()) { for { if n := atomic.LoadUint32( count); n == i { // \u539f\u5b50\u64cd\u4f5c fn() atomic.AddUint32( count, 1) // \u539f\u5b50\u64cd\u4f5c break } time.Sleep(time.Nanosecond) } } trigger(10, func(){}) }","title":"Go\u8bed\u53e5\u53ca\u5176\u6267\u884c\u89c4\u5219"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#go","text":"Don't communicate by sharing memory; share memory by communicating. \u4e0d\u8981\u901a\u8fc7\u5171\u4eab\u6570\u636e\u6765\u901a\u8baf\uff0c\u4ee5\u901a\u8baf\u7684\u65b9\u5f0f\u6765\u5171\u4eab\u6570\u636e\u3002 channel\u7c7b\u578b\u7684\u503c\uff0c\u88ab\u7528\u6765\u4ee5\u901a\u8baf\u7684\u65b9\u5f0f\u5171\u4eab\u6570\u636e\u3002\u4e00\u822c\u88ab\u7528\u6765\u5728\u4e0d\u540c\u7684goroutine\uff08\u4ee3\u8868\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u4e2d\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\uff09\u4e4b\u95f4\u4f20\u9012\u6570\u636e\u3002","title":"Go\u8bed\u53e5\u53ca\u5176\u6267\u884c\u89c4\u5219"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_1","text":"\u8fdb\u7a0b\uff1a\u63cf\u8ff0\u7684\u5c31\u662f\u7a0b\u5e8f\u7684\u6267\u884c\u8fc7\u7a0b\uff0c\u662f\u8fd0\u884c\u7740\u7684\u7a0b\u5e8f\u7684\u4ee3\u8868\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u5176\u5b9e\u5c31\u662f\u67d0\u4e2a\u7a0b\u5e8f\u8fd0\u884c\u7684\u4e00\u4e2a\u4ea7\u7269\u3002\uff08\u9759\u9759\u8eba\u5728\u90a3\u91cc\u7684\u4ee3\u7801\u662f\u7a0b\u5e8f\u3001\u5954\u8dd1\u7740\u3001\u6b63\u5728\u53d1\u6325\u529f\u80fd\u7684\u4ee3\u7801\u5c31\u662f\u8fdb\u7a0b\uff09\u3002 \u7ebf\u7a0b\uff1a\u603b\u662f\u5728\u8fdb\u7a0b\u4e4b\u5185\uff0c\u88ab\u89c6\u4e3a\u8fdb\u7a0b\u4e2d\u8fd0\u884c\u7740\u7684\u63a7\u5236\u6d41\uff08\u4ee3\u7801\u6267\u884c\u6d41\u7a0b\uff09\u3002 \u4e00\u4e2a\u8fdb\u7a0b\u81f3\u5c11\u5305\u542b\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u5982\u679c\u53ea\u5305\u542b\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u6240\u4ee5\u4ee3\u7801\u4f1a\u88ab\u4e32\u884c\u6267\u884c\u3002 \u6bcf\u4e2a\u8fdb\u7a0b\u7684\u7b2c\u4e00\u4e2a\u7ebf\u7a0b\u90fd\u4f1a\u968f\u7740\u8be5\u8fdb\u7a0b\u7684\u542f\u52a8\u800c\u88ab\u521b\u5efa\uff0c\u79f0\u5b83\u4e3a\u6240\u5c5e\u8fdb\u7a0b\u7684\u4e3b\u7ebf\u7a0b \u3002\u5982\u679c\u4e00\u4e2a\u8fdb\u7a0b\u5305\u542b\u591a\u4e2a\u7ebf\u7a0b\uff0c\u90a3\u4e48\u4ee3\u7801\u53ef\u4ee5\u88ab\u5e76\u53d1\u5730\u6267\u884c\uff0c \u9664\u4e86\u4e3b\u7ebf\u7a0b\uff0c\u5176\u4ed6\u7ebf\u7a0b\u90fd\u662f\u8fdb\u7a0b\u4e2d\u5df2\u5b58\u5728\u7684\u7ebf\u7a0b\u521b\u5efa\u51fa\u6765\u7684 \u3002 \u4e3b\u7ebf\u7a0b\u4e4b\u5916\u7684\u5176\u4ed6\u7ebf\u7a0b\uff0c\u53ea\u80fd\u7531\u4ee3\u7801\u663e\u5f0f\u5730\u521b\u5efa\u548c\u9500\u6bc1 \u3002","title":"\u8fdb\u7a0b\u4e0e\u7ebf\u7a0b"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_2","text":"\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff1a\u5728Go\u8bed\u8a00\u7684\u8fd0\u884c\u65f6\u4e2d\uff0c\u7cfb\u7edf\u4f1a\u5e2e\u52a9\u6211\u4eec\u81ea\u52a8\u5730\u521b\u5efa\u548c\u9500\u6bc1 \u7cfb\u7edf\u7ea7\u7684\u7ebf\u7a0b \uff08\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u7684\u7ebf\u7a0b\uff09\u3002 \u7528\u6237\u7ea7\u7ebf\u7a0b\uff1a\u67b6\u8bbe\u5728\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u4e4b\u4e0a\uff0c\u7531\u7528\u6237\uff08\u6211\u4eec\u7f16\u5199\u7684\u7a0b\u5e8f\uff09\u5b8c\u5168\u63a7\u5236\u7684\u4ee3\u7801\u6267\u884c\u6d41\u7a0b\uff0c\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u3001\u9500\u6bc1\u3001\u8c03\u5ea6\u3001\u72b6\u6001\u53d8\u66f4\u4ee5\u53ca\u5176\u4e2d\u7684\u4ee3\u7801\u548c\u6570\u636e\u90fd\u5b8c\u5168\u9700\u8981\u7a0b\u5e8f\u81ea\u5df1\u53bb\u5b9e\u73b0\u548c\u5904\u7406\u3002","title":"\u7ebf\u7a0b\u7c7b\u522b"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_3","text":"\u4f18\u52bf\uff1a\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u9500\u6bc1\u4e0d\u540c\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\uff0c\u901f\u5ea6\u5feb\uff0c\u4e0d\u7528\u7b49\u5f85\u64cd\u4f5c\u7cfb\u7edf\u53bb\u8c03\u5ea6\u5b83\u4eec\u8fd0\u884c\uff0c\u6240\u4ee5\u5bb9\u6613\u63a7\u5236\u4e14\u7075\u6d3b\u3002 \u52a3\u52bf\uff1a\u590d\u6742\uff0c\u5982\u679c\u53ea\u662f\u7528\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff0c\u90a3\u4e48\u53ea\u8981\u6307\u660e\u9700\u8981\u65b0\u7ebf\u7a0b\u6267\u884c\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u5e76\u4e14\u4e0b\u8fbe\u521b\u5efa\u6216\u9500\u6bc1\u7ebf\u7a0b\u7684\u6307\u4ee4\u5c31\u597d\uff0c\u5176\u4ed6\u7684\u5177\u4f53\u5b9e\u73b0\u7531\u64cd\u4f5c\u7cfb\u7edf\u4ee3\u52b3\u3002\u6211\u4eec\u5fc5\u987b\u5168\u6743\u8d1f\u8d23\u4e0e\u7528\u6237\u7ea7\u7ebf\u7a0b\u76f8\u5173\u7684\u6240\u4ee5\u5177\u4f53\u7684\u5b9e\u73b0\uff0c\u5e76\u4e14\u9700\u8981\u548c\u64cd\u4f5c\u7cfb\u7edf\u4e89\u53d6\u5bf9\u63a5\uff0c\u5426\u5219\u53ef\u80fd\u65e0\u6cd5\u6b63\u786e\u8fd0\u884c\u3002","title":"\u7528\u6237\u7ea7\u7ebf\u7a0b"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_4","text":"Go\u8bed\u8a00\u62e5\u6709\uff1a \u72ec\u7279\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b \u7528\u6237\u7ea7\u7ebf\u7a0bgoroutine \u5f3a\u5927\u7684\u7528\u4e8e\u8c03\u5ea6goroutine\u3001\u5bf9\u63a5\u64cd\u4f5c\u7cfb\u7edf\u7684\u8c03\u5ea6\u5668 \u8fd9\u4e2a\u8c03\u5ea6\u5668\u662fGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u7684\u91cd\u8981\u7ec4\u6210\u90e8\u5206\uff0c\u4e3b\u8981\u8d1f\u8d23\u7edf\u7b79\u8c03\u914dGo\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u4e2d\u7684\u4e09\u4e2a\u4e3b\u8981\u5143\u7d20\uff1a G\uff08goroutine\uff09:\u7528\u6237\u7ea7\u7ebf\u7a0b P\uff08processor\uff09\uff1a\u53ef\u4ee5\u627f\u8f7d\u82e5\u5e72\u4e2agoroutine\uff0c\u4e14\u80fd\u591f\u4f7f\u8fd9\u4e9bgoroutine\u9002\u65f6\u5730\u4e0e\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5bf9\u63a5\uff0c\u5e76\u5f97\u5230\u771f\u6b63\u8fd0\u884c\u7684\u4e2d\u4ecb M\uff08machine\uff09\uff1a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b \u5b8f\u89c2\u4e0a\u8bb2\uff0c\u7531\u4e8eP\u7684\u5b58\u5728\uff0c\u7528\u6237\u7ea7\u7ebf\u7a0b\u548c\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u53ef\u4ee5\u5448\u73b0\u591a\u5bf9\u591a\u7684\u5173\u7cfb\u3002 \u4f8b\u5982\uff1a \u5f53\u4e00\u4e2a\u6b63\u5728\u4e0e\u67d0\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5bf9\u63a5\u5e76\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u9700\u8981\u56e0\u67d0\u4e2a\u4e8b\u4ef6\uff08\u7b49\u5f85IO\u6216\u9501\u7684\u89e3\u9664\uff09\u800c\u6682\u505c\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u603b\u4f1a\u53ca\u65f6\u53d1\u73b0\uff0c\u5e76\u628a\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u548c\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5206\u79bb\uff0c\u4ee5\u91ca\u653e\u8ba1\u7b97\u8d44\u6e90\u4f9b\u5176\u4ed6\u7b49\u5f85\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f7f\u7528\u3002 \u5f53\u4e00\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u9700\u8981\u6062\u590d\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u53c8\u4f1a\u5c3d\u5feb\u4e3a\u4ed6\u5bfb\u627e\u7a7a\u95f2\u7684\u8ba1\u7b97\u8d44\u6e90\uff08\u5305\u62ec\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff09\u5e76\u5b89\u6392\u8fd0\u884c\u3002 \u5f53\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u4e0d\u591f\u7528\u7684\u65f6\u5019\uff0c\u8c03\u5ea6\u5668\u4f1a\u5e2e\u6211\u4eec\u60f3\u64cd\u4f5c\u7cfb\u7edf\u7533\u8bf7\u65b0\u7684\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u3002 \u5f53\u67d0\u4e00\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u5df2\u7ecf\u65e0\u7528\u65f6\uff0c\u8c03\u5ea6\u5668\u4f1a\u8d1f\u8d23\u628a\u5b83\u53ca\u65f6\u9500\u6bc1\u6389\u3002 \u56e0\u4e3a\u8c03\u5ea6\u5668\u5e2e\u6211\u4eec\u505a\u4e86\u5f88\u591a\u4e8b\uff0c\u6240\u4ee5Go\u7a0b\u5e8f\u624d\u80fd\u9ad8\u6548\u5730\u5229\u7528\u64cd\u4f5c\u7cfb\u7edf\u548c\u8ba1\u7b97\u673a\u8d44\u6e90 \u3002\u7a0b\u5e8f\u4e2d\u6240\u4ee5\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u90fd\u4f1a\u88ab\u5145\u5206\u5730\u8c03\u5ea6\uff0c\u5176\u4e2d\u7684\u4ee3\u7801\u4e5f\u90fd\u4f1a\u5e76\u53d1\u5730\u8fd0\u884c\uff0c\u5373\u4f7f\u7528\u6237\u7ea7\u7ebf\u7a0b\u6709\u6570\u5341\u4e07\u8ba1\u3002","title":"\u8c03\u5ea6\u5668"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#goroutine","text":"package main import fmt func main() { for i := 0; i 10; i++ { go func() { fmt.Println(i) }() } } \u4ee3\u7801\u6267\u884c\u540e\uff0c\u4e0d\u4f1a\u6709\u4efb\u4f55\u5185\u5bb9\u8f93\u51fa\u3002 \u4e0e\u4e00\u4e2a\u8fdb\u7a0b\u603b\u4f1a\u6709\u4e00\u4e2a\u4e3b\u7ebf\u7a0b\u7c7b\u4f3c\uff0c\u6bcf\u4e00\u4e2a\u72ec\u7acb\u7684Go\u7a0b\u5e8f\u8fd0\u884c\u8d77\u6765\u603b\u4f1a\u6709\u4e00\u4e2a\u4e3b\u7528\u6237\u7ebf\u7a0b\uff08goroutine\uff09\u3002 \u8fd9\u4e2a\u4e3bgoroutine\u4f1a\u5728Go\u7a0b\u5e8f\u7684\u8fd0\u884c\u51c6\u5907\u5de5\u4f5c\u5b8c\u6210\u540e\u88ab\u81ea\u52a8\u5730\u542f\u7528 \uff0c\u5e76\u4e0d\u9700\u8981\u4efb\u4f55\u624b\u52a8\u64cd\u4f5c\u3002 \u6bcf\u6761go\u8bed\u53e5\u4e00\u822c\u90fd\u4f1a\u643a\u5e26\u4e00\u4e2a\u51fd\u6570\u8c03\u7528\uff0c\u8fd9\u4e2a\u88ab\u8c03\u7528\u7684\u51fd\u6570\u88ab\u79f0\u4e3ago\u51fd\u6570\uff0c\u4e3b\u7528\u6237\u7ebf\u7a0b\uff08goroutine\uff09\u7684go\u51fd\u6570\uff0c\u5c31\u662f\u90a3\u4e2a\u7a0b\u5e8f\u5165\u53e3\u7684main\u51fd\u6570\u3002","title":"goroutine\u6700\u4f73\u5b9e\u8df5"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_5","text":"go\u51fd\u6570\u88ab\u771f\u6b63\u6267\u884c\u7684\u65f6\u95f4\uff0c\u603b\u4f1a\u4e0e\u5176\u6240\u5c5e\u7684go\u8bed\u53e5\u88ab\u6267\u884c\u7684\u65f6\u95f4\u4e0d\u540c \u3002\u5f53\u7a0b\u5e8f\u6267\u884c\u5230\u4e00\u6761go\u8bed\u53e5\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u4f1a\u5148\u8bd5\u56fe\u4ece\u67d0\u4e2a\u5b58\u653e\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u961f\u5217\u4e2d\u83b7\u53d6\u67d0\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u5b83\u53ea\u6709\u627e\u4e0d\u5230\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u60c5\u51b5\u4eec\u624d\u4f1a\u53bb\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u3002","title":"\u5df2\u7ecf\u5b58\u5728\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u88ab\u4f18\u5148\u590d\u7528\uff1a"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_6","text":"\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u5e76\u4e0d\u4f1a\u50cf\u521b\u5efa\u4e00\u4e2a\u8fdb\u7a0b\u6216\u8005\u4e00\u4e2a\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\u90a3\u6837\uff0c\u5fc5\u987b\u901a\u8fc7\u64cd\u4f5c\u7cfb\u7edf\u7684\u7cfb\u7edf\u8c03\u7528\u6765\u5b8c\u6210\uff0c\u5728Go\u8bed\u8a00\u7684\u8fd0\u884c\u65f6\u7cfb\u7edf\u5185\u90e8\u5c31\u53ef\u4ee5\u5b8c\u6210\u4e86\uff0c\u4e00\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u5c31\u76f8\u5f53\u4e8e\u9700\u8981\u5e76\u53d1\u6267\u884c\u4ee3\u7801\u7247\u6bb5\u7684\u4e0a\u4e0b\u6587\u73af\u5883\u3002 \u5728\u62ff\u5230\u7a7a\u95f2\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e4b\u540e\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4f1a\u7528\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u53bb\u5305\u88c5\u90a3\u4e2ago\u51fd\u6570\uff08\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\uff09\uff0c\u7136\u540e\u518d\u628a\u8fd9\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u8ffd\u52a0\u5230\u67d0\u4e2a\u53ef\u8fd0\u884c\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u961f\u5217\uff08\u5148\u8fdb\u5148\u51fa\uff09\u4e2d\u3002\u867d\u7136\u5728\u961f\u5217\u4e2d\u88ab\u5b89\u6392\u8fd0\u884c\u7684\u65f6\u95f4\u5f88\u5feb\uff0c\u4e0a\u8ff0\u7684\u51c6\u5907\u5de5\u4f5c\u4e5f\u4e0d\u53ef\u907f\u514d\uff0c\u56e0\u6b64\u5b58\u5728\u4e00\u5b9a\u65f6\u95f4\u6d88\u8017\u3002 \u6240\u4ee5go\u51fd\u6570\u7684\u6267\u884c\u65f6\u95f4\uff0c\u603b\u662f\u4f1a\u660e\u663e\u6ede\u540e\uff08\u76f8\u5bf9\u4e8eCPU\u548cGo\u7a0b\u5e8f\uff09\u4e0ego\u8bed\u53e5\u7684\u6267\u884c\u65f6\u95f4 \u3002 \u53ea\u8981go\u8bed\u53e5\u672c\u8eab\u6267\u884c\u5b8c\u6bd5\uff0cGo\u7a0b\u5e8f\u5b8c\u5168\u4e0d\u7528\u7b49\u5f85go\u51fd\u6570\u7684\u6267\u884c\uff0c\u5b83\u4f1a\u7acb\u523b\u53bb\u6267\u884c\u540e\u9762\u7684\u8bed\u53e5\uff0c\u8fd9\u5c31\u662f\u5f02\u6b65\u5e76\u53d1\u6267\u884c \u3002 \u6ce8\u610f\uff1a\u4e00\u70b9\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\uff08main\u51fd\u6570\u4e2d\u7684\u90a3\u4e9b\u4ee3\u7801\uff09\u6267\u884c\u5b8c\u6bd5\uff0c\u5f53\u524d\u7684Go\u7a0b\u5e8f\u5c31\u4f1a\u7ed3\u675f\u8fd0\u884c\u3002\u5982\u679c\u5728Go\u7a0b\u5e8f\u7ed3\u675f\u7684\u90a3\u4e00\u523b\uff0c\u8fd8\u6709\u7528\u6237\u7ea7\u7ebf\u7a0b\u6ca1\u6709\u8fd0\u9500\uff0c\u90a3\u5c31\u6ca1\u6709\u673a\u4f1a\u8fd0\u884c\u4e86\u3002 \u4e25\u683c\u7684\u8bf4\uff0cGo\u8bed\u8a00\u5e76\u4e0d\u4f1a\u4fdd\u8bc1\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u4ee5\u600e\u6837\u7684\u987a\u5e8f\u8fd0\u884c\uff0c\u56e0\u4e3a\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\u4f1a\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e00\u8d77\u63a5\u53d7\u8c03\u5ea6\uff0c\u53c8\u56e0\u4e3a\u8c03\u5ea6\u5668\u5f88\u53ef\u80fd\u4f1a\u5728\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e2d\u7684\u4ee3\u7801\u53ea\u6267\u884c\u4e86\u4e00\u90e8\u5206\u7684\u65f6\u5019\u6682\u505c\uff0c\u4ee5\u671f\u6240\u6709\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u6709\u66f4\u516c\u5e73\u7684\u8fd0\u884c\u673a\u4f1a\u3002\u6240\u4ee5\u54ea\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u5148\u6267\u884c\u5b8c\uff0c\u662f\u4e0d\u53ef\u9884\u77e5\u7684\uff0c\u9664\u975e\u4f7f\u7528\u4e86\u67d0\u79cdGo\u8bed\u8a00\u63d0\u4f9b\u7684\u65b9\u5f0f\u8fdb\u884c\u4eba\u4e3a\u5e72\u9884\u3002","title":"\u7528\u6237\u7ea7\u7ebf\u7a0b\u7684\u521b\u5efa\u6210\u672c\u5f88\u4f4e\uff1a"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_7","text":"\u8ba9\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b Sleep() \u4e00\u4f1a\uff1a\u4f46\u662f\u65f6\u95f4\u96be\u4ee5\u628a\u63e1 \u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\u8fd0\u884c\u5b8c\u6bd5\u4e4b\u540e\u53d1\u51fa\u901a\u77e5\uff1a\u521b\u5efa\u4e00\u4e2a\u901a\u9053\uff0c\u957f\u5ea6\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u4e00\u81f4\uff0c\u6bcf\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u8fd0\u884c\u5b8c\u6bd5\u7684\u65f6\u5019\u5411\u901a\u9053\u4e2d\u53d1\u9001\u4e00\u4e2a\u503c\uff08\u5728go\u51fd\u6570\u7684\u6700\u540e\u53d1\u9001\uff09\uff0c\u5728main\u51fd\u6570\u7684\u6700\u540e\u63a5\u6536\u901a\u9053\u4e2d\u7684\u503c\uff0c\u63a5\u6536\u6b21\u6570\u4e0e\u624b\u52a8\u542f\u52a8\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u6570\u91cf\u4e00\u76f4 sync\u5305\u4e2d\u7684 sync.WaitGroup \u7c7b\u578b sign := make(chan struct{}, num) // \u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u901a\u9053 sign - struct{}{} - sign struct{} \u7c7b\u4f3c\u4e8e\u7a7a\u63a5\u53e3 interface{} \uff0c\u4ee3\u8868\u65e2\u4e0d\u5305\u542b\u4efb\u4f55\u5b57\u6bb5\u4e5f\u4e0d\u62e5\u6709\u4efb\u4f55\u65b9\u6cd5\u7684\u7a7a\u7ed3\u6784\u4f53\u7c7b\u578b\u3002 struct{} \u7c7b\u578b\u7684\u503c\u8868\u793a\u6cd5\u53ea\u8981\u4e00\u4e2a\uff0c struct{}{} \uff0c\u5b83\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u662f0\u5b57\u8282\u3002\u8fd9\u4e2a\u503c\u5728\u6574\u4e2aGo\u7a0b\u5e8f\u4e2d\u6c38\u8fdc\u90fd\u53ea\u4f1a\u5b58\u5728\u4e00\u4efd \u3002\u65e0\u6570\u6b21\u7684\u8bd5\u7528\u8fd9\u4e2a\u503c\u7684\u5b57\u9762\u91cf\uff0c\u4f46\u662f\u7528\u5230\u7684\u5374\u662f\u540c\u4e00\u4e2a\u503c\u3002","title":"\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\u7b49\u5f85\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b"},{"location":"Language/Basic/13-\u8bed\u53e5\u6267\u884c\u89c4\u5219/#_8","text":"package main import \uff08 fmt sync/atomic time ) func main() { // \u7528\u6237\u7ea7\u7ebf\u7a0b\u968f\u673a\u6267\u884c for i := 0; i 10; i++ { go func() { fmt.Println(i) }() } // \u7528\u6237\u7ea7\u7ebf\u7a0b\u6309\u987a\u5e8f\u6267\u884c for i := 0; i 10; i++ { go func(i int) { // \u8ba9go\u51fd\u6570\u63a5\u6536\u4e00\u4e2aint\u578b\u53c2\u6570\uff0c\u5728\u8c03\u7528\u5b83\u7684\u65f6\u5019\uff0c\u628a\u53d8\u91cf\u4f20\u8fdb\u53bb fmt.Println(i) // \u8fd9\u6837Go\u8bed\u8a00\u5305\u88c5\u6bcf\u4e2a\u7528\u6237\u7ea7\u7ebf\u7a0b\u90fd\u53ef\u4ee5\u62ff\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u6574\u6570 }(i) } // \u5728go\u8bed\u53e5\u88ab\u6267\u884c\u65f6\uff0c\u4f20\u7ed9go\u51fd\u6570\u7684\u53c2\u6570`i`\u4f1a\u88ab\u5148\u6c42\u503c\uff0c\u5982\u6b64\u5c31\u5f97\u5230\u4e86\u6863\u6b21\u8fed\u4ee3\u7684\u5e8f\u53f7\uff0c // \u4e4b\u540e\uff0c\u65e0\u8bbago\u51fd\u6570\u4f1a\u5728\u4ec0\u4e48\u65f6\u5019\u6267\u884c\uff0c\u8fd9\u4e2a\u53c2\u6570\u503c\u90fd\u4e0d\u4f1a\u53d8\uff0c // \u4e5f\u5c31\u662fgo\u51fd\u6570\u4e2d\u8c03\u7528`fmt.Prinrln`\u51fd\u6570\u6253\u5370\u7684\u4e00\u5b9a\u662f\u90a3\u4e2a\u5f53\u6b21\u8fed\u4ee3\u7684\u5e8f\u53f7\u3002 var count uint32 for i := uint32(0); i 10; i++ { go func(i uint32) { fn := func() { fmt.Println(i) } trigger(i, fn) }(i) } trigger := func(i uint32, fn func()) { for { if n := atomic.LoadUint32( count); n == i { // \u539f\u5b50\u64cd\u4f5c fn() atomic.AddUint32( count, 1) // \u539f\u5b50\u64cd\u4f5c break } time.Sleep(time.Nanosecond) } } trigger(10, func(){}) }","title":"\u7528\u6237\u7ea7\u7ebf\u7a0b\u6309\u987a\u5e8f\u6267\u884c"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/","text":"\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5 \u5e26range\u5b50\u53e5\u7684for\u8bed\u53e5 numbers1 := []int{1, 2, 3, 4, 5, 6} // \u58f0\u660e\u5e76\u521d\u59cb\u5316int\u7c7b\u578b\u7684\u5207\u7247 for i := range numbers1 { // range\u5b50\u53e5\u8fed\u4ee3\u5207\u7247\u6c47\u603b\u7684\u6240\u4ee5\u5143\u7d20\u503c if i == 3 { numbers1[i] |= i } } fmt.Println(numbers1) for\u8bed\u53e5\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0crange\u5173\u952e\u5b57\u53f3\u8fb9\uff08range\u8868\u8fbe\u5f0f\uff09\u7684numbers1\u4f1a\u88ab\u5148\u6c42\u503c\uff0crange\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u53ef\u4ee5\u662f\u6570\u7ec4\u3001\u6570\u7ec4\u7684\u6307\u9488\u3001\u5207\u7247\u3001\u5b57\u7b26\u4e32\u3001\u5b57\u5178\u6216\u5141\u8bb8\u63a5\u6536\u64cd\u4f5c\u7684\u901a\u9053\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u5e76\u4e14\u7ed3\u679c\u53ea\u80fd\u6709\u4e00\u4e2a\u3002 \u5bf9\u4e8e\u4e0d\u540c\u79cd\u7c7b\u7684range\u8868\u8fbe\u5f0f\u7ed3\u679c\u503c\uff0cfor\u8bed\u53e5\u7684\u8fed\u4ee3\u53d8\u91cf\u7684\u6570\u91cf\u53ef\u4ee5\u6709\u6240\u4e0d\u540c \u3002\u4e0a\u8ff0\u5207\u7247\u7684\u7684\u8fed\u4ee3\u53d8\u91cf\u53ef\u4ee5\u6709\u4e24\u4e2a\uff0c\u5207\u7247\u4e2d\u7684\u7d22\u5f15\u503c\u548c\u8fed\u4ee3\u5bf9\u5e94\u7684\u67d0\u4e00\u4e2a\u503c\u3002 \u5f53range\u8868\u8fbe\u5f0f\u53ea\u6709\u4e00\u4e2a\u8fed\u4ee3\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u6570\u7ec4\u3001\u6570\u7ec4\u7684\u6307\u9488\u3001\u5207\u7247\u3001\u5b57\u7b26\u4e32\u7684\u5143\u7d20\u503c\u90fd\u662f\u65e0\u5904\u5b89\u653e\u7684\uff0c\u53ea\u80fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u7ed9\u51fa\u4e00\u4e2a\u4e2a\u7d22\u5f15\u503c\u3002 \u6ce8\u610f numbers2 := [...]int{1, 2, 3, 4, 5, 6} // munbers2\u662f\u6570\u7ec4\uff0c\u4e3a\u503c\u7c7b\u578b maxIndex2 := len(numbers2) - 1 for i, e := range numbers2 { if i == maxIndex2 { numbers2[0] += e } else { numbers2[i+1] += e } } fmt.Println(numbers2) range\u8868\u8fbe\u5f0f\u53ea\u4f1a\u5728for\u8bed\u53e5\u5f00\u59cb\u6267\u884c\u65f6\u88ab\u6c42\u503c\u4e00\u6b21\uff0c\u65e0\u8bba\u540e\u9762\u6709\u591a\u5c11\u5176\u4ed6\u64cd\u4f5c range\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u7ed3\u679c\u4f1a\u88ab\u590d\u5236\uff0c\u88ab\u64cd\u4f5c\u7684\u5bf9\u8c61\u662frange\u8868\u8fbe\u5f0f\u7ed3\u679c\u7684\u526f\u672c\u800c\u4e0d\u662f\u539f\u503c numbers3 := []int{1, 2, 3, 4, 5, 6} // mumber3\u662f\u5207\u7247\uff0c\u4e3a\u5f15\u7528\u7c7b\u578b maxIndex3 := len(numbers3) - 1 for i, e := range numbers3 { if i == maxIndex2 { numbers3[0] += e } else { numbers3[i+1] += e } } fmt.Println(numbers3) range\u8868\u8fbe\u5f0f\u53ea\u4f1a\u5728for\u8bed\u53e5\u5f00\u59cb\u6267\u884c\u65f6\u88ab\u6c42\u503c\u4e00\u6b21\uff0c\u65e0\u8bba\u540e\u9762\u6709\u591a\u5c11\u5176\u4ed6\u64cd\u4f5c range\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u7ed3\u679c\u7684\u5f15\u7528\u4f1a\u88ab\u590d\u5236\uff0c\u88ab\u64cd\u4f5c\u7684\u5bf9\u8c61\u662frange\u8868\u8fbe\u5f0f\u7ed3\u679c\u7684\u539f\u503c switch\u8868\u8fbe\u5f0f\u548ccase\u8868\u8fbe\u5f0f\u7684\u8054\u7cfb \u53ea\u6709switch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0e\u67d0\u4e2acase\u8868\u8fbe\u5f0f\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u76f8\u7b49,\u8be5case\u8868\u8fbe\u5f0f\u6240\u5c5e\u7684case\u5b50\u53e5\u5c31\u4f1a\u88ab\u9009\u4e2d,case\u5b50\u53e5\u88ab\u9009\u4e2d\u540e\uff0c\u9644\u5e26\u5728case\u8868\u8fbe\u5f0f\u540e\u8fb9\u7684\u8bed\u53e5\u4f1a\u88ab\u6267\u884c,\u5176\u4ed6case\u5b50\u53e5\u4f1a\u88ab\u5ffd\u7565\u3002 value1 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch 1 + 3 { // switch\u8868\u8fbe\u5f0f\uff0c\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\u65f6\uff0c\u81ea\u52a8\u8f6c\u6362\u4e3a\u6b64\u5e38\u91cf\u503c\u9ed8\u8ba4\u7684\u7c7b\u578b case value1[0], value1[1]: // case\u8868\u8fbe\u5f0f\uff0ccase\u8868\u8fbe\u5f0f\u4e2d\u7684\u7ed3\u679c\u503c\u4e0eswitch\u8868\u8fbe\u5f0f\u4e2d\u7684\u7ed3\u679c\u503c\u7c7b\u578b\u4e0d\u540c fmt.Println( 0 or 1 ) case value1[2], value1[3]: fmt.Println( 2 or 3 ) case value1[4], value1[5], value1[6]: fmt.Println( 4 or 5 or 6 ) } \u5728case\u5b50\u53e5\u9644\u5e26\u7684\u8bed\u53e5\u5217\u8868\u4e2d\u5305\u542b fallthrough \u8bed\u53e5\uff0c\u90a3\u4e48\u7d27\u6328\u5728\u5b83\u4e0b\u8fb9\u7684\u90a3\u4e2acase\u81ea\u5df1\u9644\u5e26\u7684\u8bed\u53e5\u4e5f\u4f1a\u88ab\u6267\u884c \u3002 \u56e0\u4e3a\u5b58\u5728\u4e0a\u8ff0\u5224\u7b49\u64cd\u4f5c\uff0c\u5bf9switch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u548ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u6709\u8981\u6c42\u3002 \u5982\u679cswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\uff0ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u5176\u4ed6\u7c7b\u578b\uff0c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 \u5982\u679ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\uff0c\u4e14\u4e0eswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u7c7b\u578b\u4e0d\u540c\uff0c\u90a3\u4e48\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3aswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u7684\u7c7b\u578b \u5982\u679c\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u6709\u67d0\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u90a3\u4e48\u4e00\u5b9a\u8981\u68c0\u67e5\u4ed6\u4eec\u7684\u52a8\u6001\u503c\u662f\u5426\u5177\u6709\u53ef\u6bd4\u6027 \u3002 switch\u8bed\u53e5\u5bf9case\u8868\u8fbe\u5f0f\u7684\u7ea6\u675f \u7ed3\u679c\u503c\u4e3a\u5e38\u91cf\u7684\u60c5\u51b5\u4e0b switch\u8bed\u53e5\u5728case\u5b50\u53e5\u7684\u9009\u62e9\u4e0a\u5177\u6709\u552f\u4e00\u6027\uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8case\u8868\u8fbe\u5f0f\u7ed3\u679c\u503c\u5b58\u5728\u76f8\u7b49\u7684\u60c5\u51b5\uff08\u4e0d\u8bba\u8fd9\u4e9b\u7ed3\u679c\u503c\u76f8\u7b49\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u662f\u5426\u5b58\u5728\u4e8e\u4e0d\u540c\u7684case\u8868\u8fbe\u5f0f\u4e2d\uff09\u3002 // \u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 value5 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch value5[4] { case value5[0], value5[1], value5[2]: fmt.Println( 0 or 1 or 2 ) case value5[2], value5[3], value5[4]: fmt.Println( 2 or 3 or 4 ) case value5[4], value5[5], value5[6]: fmt.Println( 4 or 5 or 6 ) } // \u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1 value5 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch value5[4] { case value5[0], value5[1], value5[2]: fmt.Println( 0 or 1 or 2 ) case value5[2], value5[3], value5[4]: fmt.Println( 2 or 3 or 4 ) case value5[4], value5[5], value5[6]: fmt.Println( 4 or 5 or 6 ) } \u4e0a\u8ff0\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5bf9\u7c7b\u578b\u5224\u65adswitch\u8bed\u53e5\u65e0\u6548\u3002 \u7c7b\u578bswitch\u8bed\u53e5 \u7c7b\u578bswitch\u8bed\u53e5\u4e2d\u7684case\u8868\u8fbe\u5f0f\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u90fd\u5fc5\u987b\u76f4\u63a5\u7531\u7c7b\u578b\u5b57\u9762\u91cf\u8868\u793a\uff0c\u800c\u65e0\u6cd5\u901a\u8fc7\u95f4\u63a5\u7684\u65b9\u5f0f\u8868\u793a\u3002 value6 := interface{}(byte(127)) switch t := value6.(type) { // \u7c7b\u578bswitch\u8bed\u53e5 case uint8, uint16: fmt.Println( uint8 or uint16 ) case byte: // byte\u4e3aunit8\u7684\u522b\u540d\u7c7b\u578b\uff0c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 fmt.Printf( byte ) default: fmt.Printf( unsupported type: %T , t) } case\u5b50\u53e5\u7684\u7f16\u5199\u987a\u5e8f\u5f88\u91cd\u8981\uff0c\u6700\u4e0a\u8fb9\u7684case\u5b50\u53e5\u4e2d\u7684\u5b50\u8868\u8fbe\u5f0f\u603b\u662f\u4f1a\u88ab\u6700\u5148\u6c42\u503c\uff0c\u5728\u5224\u7b49\u7684\u65f6\u5019\u987a\u5e8f\u4e5f\u662f\u8fd9\u6837 \u3002\u56e0\u6b64\uff0c\u5982\u679c\u67d0\u4e9bcase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u6709\u91cd\u590d\uff0c\u90a3\u4e48\u4f4d\u7f6e\u9760\u4e0a\u7684case\u5b50\u53e5\u603b\u4f1a\u88ab\u9009\u4e2d\u3002","title":"\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#_1","text":"","title":"\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#rangefor","text":"numbers1 := []int{1, 2, 3, 4, 5, 6} // \u58f0\u660e\u5e76\u521d\u59cb\u5316int\u7c7b\u578b\u7684\u5207\u7247 for i := range numbers1 { // range\u5b50\u53e5\u8fed\u4ee3\u5207\u7247\u6c47\u603b\u7684\u6240\u4ee5\u5143\u7d20\u503c if i == 3 { numbers1[i] |= i } } fmt.Println(numbers1) for\u8bed\u53e5\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0crange\u5173\u952e\u5b57\u53f3\u8fb9\uff08range\u8868\u8fbe\u5f0f\uff09\u7684numbers1\u4f1a\u88ab\u5148\u6c42\u503c\uff0crange\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u53ef\u4ee5\u662f\u6570\u7ec4\u3001\u6570\u7ec4\u7684\u6307\u9488\u3001\u5207\u7247\u3001\u5b57\u7b26\u4e32\u3001\u5b57\u5178\u6216\u5141\u8bb8\u63a5\u6536\u64cd\u4f5c\u7684\u901a\u9053\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u5e76\u4e14\u7ed3\u679c\u53ea\u80fd\u6709\u4e00\u4e2a\u3002 \u5bf9\u4e8e\u4e0d\u540c\u79cd\u7c7b\u7684range\u8868\u8fbe\u5f0f\u7ed3\u679c\u503c\uff0cfor\u8bed\u53e5\u7684\u8fed\u4ee3\u53d8\u91cf\u7684\u6570\u91cf\u53ef\u4ee5\u6709\u6240\u4e0d\u540c \u3002\u4e0a\u8ff0\u5207\u7247\u7684\u7684\u8fed\u4ee3\u53d8\u91cf\u53ef\u4ee5\u6709\u4e24\u4e2a\uff0c\u5207\u7247\u4e2d\u7684\u7d22\u5f15\u503c\u548c\u8fed\u4ee3\u5bf9\u5e94\u7684\u67d0\u4e00\u4e2a\u503c\u3002 \u5f53range\u8868\u8fbe\u5f0f\u53ea\u6709\u4e00\u4e2a\u8fed\u4ee3\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u6570\u7ec4\u3001\u6570\u7ec4\u7684\u6307\u9488\u3001\u5207\u7247\u3001\u5b57\u7b26\u4e32\u7684\u5143\u7d20\u503c\u90fd\u662f\u65e0\u5904\u5b89\u653e\u7684\uff0c\u53ea\u80fd\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u7ed9\u51fa\u4e00\u4e2a\u4e2a\u7d22\u5f15\u503c\u3002","title":"\u5e26range\u5b50\u53e5\u7684for\u8bed\u53e5"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#_2","text":"numbers2 := [...]int{1, 2, 3, 4, 5, 6} // munbers2\u662f\u6570\u7ec4\uff0c\u4e3a\u503c\u7c7b\u578b maxIndex2 := len(numbers2) - 1 for i, e := range numbers2 { if i == maxIndex2 { numbers2[0] += e } else { numbers2[i+1] += e } } fmt.Println(numbers2) range\u8868\u8fbe\u5f0f\u53ea\u4f1a\u5728for\u8bed\u53e5\u5f00\u59cb\u6267\u884c\u65f6\u88ab\u6c42\u503c\u4e00\u6b21\uff0c\u65e0\u8bba\u540e\u9762\u6709\u591a\u5c11\u5176\u4ed6\u64cd\u4f5c range\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u7ed3\u679c\u4f1a\u88ab\u590d\u5236\uff0c\u88ab\u64cd\u4f5c\u7684\u5bf9\u8c61\u662frange\u8868\u8fbe\u5f0f\u7ed3\u679c\u7684\u526f\u672c\u800c\u4e0d\u662f\u539f\u503c numbers3 := []int{1, 2, 3, 4, 5, 6} // mumber3\u662f\u5207\u7247\uff0c\u4e3a\u5f15\u7528\u7c7b\u578b maxIndex3 := len(numbers3) - 1 for i, e := range numbers3 { if i == maxIndex2 { numbers3[0] += e } else { numbers3[i+1] += e } } fmt.Println(numbers3) range\u8868\u8fbe\u5f0f\u53ea\u4f1a\u5728for\u8bed\u53e5\u5f00\u59cb\u6267\u884c\u65f6\u88ab\u6c42\u503c\u4e00\u6b21\uff0c\u65e0\u8bba\u540e\u9762\u6709\u591a\u5c11\u5176\u4ed6\u64cd\u4f5c range\u8868\u8fbe\u5f0f\u7684\u6c42\u503c\u7ed3\u679c\u7684\u5f15\u7528\u4f1a\u88ab\u590d\u5236\uff0c\u88ab\u64cd\u4f5c\u7684\u5bf9\u8c61\u662frange\u8868\u8fbe\u5f0f\u7ed3\u679c\u7684\u539f\u503c","title":"\u6ce8\u610f"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#switchcase","text":"\u53ea\u6709switch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e0e\u67d0\u4e2acase\u8868\u8fbe\u5f0f\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b50\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u76f8\u7b49,\u8be5case\u8868\u8fbe\u5f0f\u6240\u5c5e\u7684case\u5b50\u53e5\u5c31\u4f1a\u88ab\u9009\u4e2d,case\u5b50\u53e5\u88ab\u9009\u4e2d\u540e\uff0c\u9644\u5e26\u5728case\u8868\u8fbe\u5f0f\u540e\u8fb9\u7684\u8bed\u53e5\u4f1a\u88ab\u6267\u884c,\u5176\u4ed6case\u5b50\u53e5\u4f1a\u88ab\u5ffd\u7565\u3002 value1 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch 1 + 3 { // switch\u8868\u8fbe\u5f0f\uff0c\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\u65f6\uff0c\u81ea\u52a8\u8f6c\u6362\u4e3a\u6b64\u5e38\u91cf\u503c\u9ed8\u8ba4\u7684\u7c7b\u578b case value1[0], value1[1]: // case\u8868\u8fbe\u5f0f\uff0ccase\u8868\u8fbe\u5f0f\u4e2d\u7684\u7ed3\u679c\u503c\u4e0eswitch\u8868\u8fbe\u5f0f\u4e2d\u7684\u7ed3\u679c\u503c\u7c7b\u578b\u4e0d\u540c fmt.Println( 0 or 1 ) case value1[2], value1[3]: fmt.Println( 2 or 3 ) case value1[4], value1[5], value1[6]: fmt.Println( 4 or 5 or 6 ) } \u5728case\u5b50\u53e5\u9644\u5e26\u7684\u8bed\u53e5\u5217\u8868\u4e2d\u5305\u542b fallthrough \u8bed\u53e5\uff0c\u90a3\u4e48\u7d27\u6328\u5728\u5b83\u4e0b\u8fb9\u7684\u90a3\u4e2acase\u81ea\u5df1\u9644\u5e26\u7684\u8bed\u53e5\u4e5f\u4f1a\u88ab\u6267\u884c \u3002 \u56e0\u4e3a\u5b58\u5728\u4e0a\u8ff0\u5224\u7b49\u64cd\u4f5c\uff0c\u5bf9switch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u548ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u6709\u8981\u6c42\u3002 \u5982\u679cswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\uff0ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u5176\u4ed6\u7c7b\u578b\uff0c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 \u5982\u679ccase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u4e3a\u65e0\u7c7b\u578b\u5e38\u91cf\uff0c\u4e14\u4e0eswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u7c7b\u578b\u4e0d\u540c\uff0c\u90a3\u4e48\u4f1a\u81ea\u52a8\u8f6c\u6362\u4e3aswitch\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u7684\u7c7b\u578b \u5982\u679c\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u7c7b\u578b\u6709\u67d0\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u90a3\u4e48\u4e00\u5b9a\u8981\u68c0\u67e5\u4ed6\u4eec\u7684\u52a8\u6001\u503c\u662f\u5426\u5177\u6709\u53ef\u6bd4\u6027 \u3002","title":"switch\u8868\u8fbe\u5f0f\u548ccase\u8868\u8fbe\u5f0f\u7684\u8054\u7cfb"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#switchcase_1","text":"","title":"switch\u8bed\u53e5\u5bf9case\u8868\u8fbe\u5f0f\u7684\u7ea6\u675f"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#_3","text":"switch\u8bed\u53e5\u5728case\u5b50\u53e5\u7684\u9009\u62e9\u4e0a\u5177\u6709\u552f\u4e00\u6027\uff0c\u56e0\u6b64\u4e0d\u5141\u8bb8case\u8868\u8fbe\u5f0f\u7ed3\u679c\u503c\u5b58\u5728\u76f8\u7b49\u7684\u60c5\u51b5\uff08\u4e0d\u8bba\u8fd9\u4e9b\u7ed3\u679c\u503c\u76f8\u7b49\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u662f\u5426\u5b58\u5728\u4e8e\u4e0d\u540c\u7684case\u8868\u8fbe\u5f0f\u4e2d\uff09\u3002 // \u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 value5 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch value5[4] { case value5[0], value5[1], value5[2]: fmt.Println( 0 or 1 or 2 ) case value5[2], value5[3], value5[4]: fmt.Println( 2 or 3 or 4 ) case value5[4], value5[5], value5[6]: fmt.Println( 4 or 5 or 6 ) } // \u53ef\u4ee5\u901a\u8fc7\u7f16\u8bd1 value5 := [...]int8{0, 1, 2, 3, 4, 5, 6} switch value5[4] { case value5[0], value5[1], value5[2]: fmt.Println( 0 or 1 or 2 ) case value5[2], value5[3], value5[4]: fmt.Println( 2 or 3 or 4 ) case value5[4], value5[5], value5[6]: fmt.Println( 4 or 5 or 6 ) } \u4e0a\u8ff0\u7b2c\u4e8c\u79cd\u65b9\u5f0f\u5bf9\u7c7b\u578b\u5224\u65adswitch\u8bed\u53e5\u65e0\u6548\u3002","title":"\u7ed3\u679c\u503c\u4e3a\u5e38\u91cf\u7684\u60c5\u51b5\u4e0b"},{"location":"Language/Basic/14-\u6d41\u7a0b\u63a7\u5236\u8bed\u53e5/#switch","text":"\u7c7b\u578bswitch\u8bed\u53e5\u4e2d\u7684case\u8868\u8fbe\u5f0f\u7684\u5b50\u8868\u8fbe\u5f0f\uff0c\u90fd\u5fc5\u987b\u76f4\u63a5\u7531\u7c7b\u578b\u5b57\u9762\u91cf\u8868\u793a\uff0c\u800c\u65e0\u6cd5\u901a\u8fc7\u95f4\u63a5\u7684\u65b9\u5f0f\u8868\u793a\u3002 value6 := interface{}(byte(127)) switch t := value6.(type) { // \u7c7b\u578bswitch\u8bed\u53e5 case uint8, uint16: fmt.Println( uint8 or uint16 ) case byte: // byte\u4e3aunit8\u7684\u522b\u540d\u7c7b\u578b\uff0c\u65e0\u6cd5\u901a\u8fc7\u7f16\u8bd1 fmt.Printf( byte ) default: fmt.Printf( unsupported type: %T , t) } case\u5b50\u53e5\u7684\u7f16\u5199\u987a\u5e8f\u5f88\u91cd\u8981\uff0c\u6700\u4e0a\u8fb9\u7684case\u5b50\u53e5\u4e2d\u7684\u5b50\u8868\u8fbe\u5f0f\u603b\u662f\u4f1a\u88ab\u6700\u5148\u6c42\u503c\uff0c\u5728\u5224\u7b49\u7684\u65f6\u5019\u987a\u5e8f\u4e5f\u662f\u8fd9\u6837 \u3002\u56e0\u6b64\uff0c\u5982\u679c\u67d0\u4e9bcase\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u6709\u91cd\u590d\uff0c\u90a3\u4e48\u4f4d\u7f6e\u9760\u4e0a\u7684case\u5b50\u53e5\u603b\u4f1a\u88ab\u9009\u4e2d\u3002","title":"\u7c7b\u578bswitch\u8bed\u53e5"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/","text":"\u9519\u8bef\u5904\u7406 error\u7c7b\u578b\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u662fGo\u8bed\u8a00\u5167\u5efa\u7c7b\u578b\uff0c\u5728\u8fd9\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u58f0\u660e\u4e2d\u53ea\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5 Error \uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u63a5\u53d7\u4efb\u4f55\u53c2\u6570\uff0c\u4f46\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2astring\u7c7b\u578b\u7684\u7ed3\u679c\u3002 type error interface { Error() string //\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u5f62\u5f0f } \u4f7f\u7528error\u7c7b\u578b\u7684\u65b9\u5f0f\uff0c\u901a\u5e38\u662f\u5728\u51fd\u6570\u58f0\u660e\u7684\u7ed3\u679c\u5217\u8868\u7684\u6700\u540e\uff0c\u58f0\u660e\u4e00\u4e2aerror\u7c7b\u578b\u7684\u7ed3\u679c\uff0c\u540c\u65f6\u5728\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u5148\u5224\u65ad\u5b83\u8d76\u56de\u7684\u6700\u540e\u4e00\u4e2a\u7ed3\u679c\u503c\u662f\u5426\u201c\u4e0d\u4e3anil\u201d\u3002 package main import ( errors fmt ) func echo(request string) (response string, err error) { if request == { // \u536b\u8ff0\u8bed\u53e5 err = errors.New( empty request ) return } response = fmt.Sprintf( echo: %s , request) return } func main() { for _, req := range []string{ , hello! } { fmt.Printf( request: %s\\n , req) resp, err := echo(req) if err != nil { // \u536b\u8ff0\u8bed\u53e5 fmt.Printf( error: %s\\n , err) continue } fmt.Printf( response: %s\\n , resp) } } \u6ce8\u610f\u70b9\uff1a \u5728\u8fdb\u884c\u9519\u8bef\u5904\u7406\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u4f1a\u7528\u5230\u536b\u8ff0\u8bed\u53e5 \u5728\u751f\u6210error\u7c7b\u578b\u503c\u7684\u65f6\u5019\u7528\u5230 errors.New \u51fd\u6570\uff0c\u8fd9\u662f\u4e00\u79cd\u6700\u57fa\u672c\u7684\u751f\u6210\u9519\u8bef\u503c\u7684\u65b9\u5f0f\u3002\u8c03\u7528\u5b83\u65f6\u4f20\u5165\u4e00\u4e2a\u6709\u5b57\u7b26\u4e32\u4ee3\u8868\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u8fd9\u4e2a\u9519\u8bef\u4fe1\u606f\u7684error\u7c7b\u578b\u503c\u3002\u8be5\u503c\u7684\u9759\u6001\u7c7b\u578b\u662ferror\uff0c\u52a8\u6001\u7c7b\u578b\u662f\u4e00\u4e2aerrors\u5305\u4e2d\uff0c\u5305\u7ea7\u79c1\u6709\u7684\u7c7b\u578b *errorString \u3002 errorString \u7c7b\u578b\u62e5\u6709\u7684\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5\u5b9e\u73b0\u4e86errors\u63a5\u53e3\u4e2d\u7684Error\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u88ab\u8c03\u7528\u540e\uff0c\u4f1a\u539f\u5c01\u4e0d\u52a8\u5730\u8fd4\u56de\u4e4b\u524d\u4f20\u5165\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5b9e\u9645\u4e0a\uff0cerror\u7c7b\u578b\u503c\u7684Error\u65b9\u6cd5\u5c31\u76f8\u5f53\u4e8e\u5176\u4ed6\u7c7b\u578b\u503c\u7684String\u65b9\u6cd5\u3002 \u5728\u4e0a\u8ff0\u4f8b\u5b50\u4e2d\uff0c fmt.Printf \u51fd\u6570\u53d1\u73b0\u88ab\u6253\u5370\u7684\u662f\u4e00\u4e2aerror\u7c7b\u578b\uff0c\u5c31\u4f1a\u8c03\u7528\u5b83\u7684Error\u65b9\u6cd5\u3002\u5728fmt\u5305\u4e2d\uff0c\u8fd9\u7c7b\u6253\u5370\u51fd\u6570\u5176\u5b9e\u90fd\u662f\u8fd9\u4e48\u505a\u7684\u3002 \u5f53\u6211\u4eec\u901a\u8fc7\u6a21\u677f\u5316\u7684\u65b9\u5f0f\u751f\u6210\u9519\u8bef\u4fe1\u606f\uff0c\u5e76\u5f97\u5230\u9519\u8bef\u503c\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 fmt.Errorf \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5176\u5b9e\u662f\u5148\u8c03\u7528 fmt.Sprintf \u51fd\u6570\uff0c\u5f97\u5230\u786e\u5207\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5728\u8c03\u7528 errors.New \u51fd\u6570\uff0c\u5f97\u5230\u8be5\u9519\u8bef\u4fe1\u606f\u7684error\u7c7b\u578b\u503c\uff0c\u6700\u540e\u8fd4\u56de\u8be5\u503c\u3002 \u5982\u4f55\u5224\u65ad\u9519\u8bef\u503c\u5177\u4f53\u4ee3\u8868\u54ea\u4e00\u7c7b\u9519\u8bef \u56e0\u4e3aerror\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u6240\u4ee5\u5373\u4f7f\u540c\u4e3aerror\u7c7b\u578b\u7684\u9519\u8bef\u503c\uff0c\u4ed6\u4eec\u7684\u5b9e\u9645\u7c7b\u578b\u4e5f\u53ef\u80fd\u4e0d\u540c\u3002 \u5bf9\u4e8e \u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185 \u7684\u4e00\u7cfb\u5217\u9519\u8bef\u503c\u5728\uff1a\u4e00\u822c\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u6216\u8005switch\u8bed\u53e5\u6765\u5224\u65ad \u5bf9\u4e8e \u5df2\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u76f8\u540c \u7684\u4e00\u4e9b\u9519\u8bef\u503c\uff0c\u4e00\u822c\u76f4\u63a5\u4f7f\u7528\u5224\u7b49\u64cd\u4f5c\u6765\u5224\u65ad \u5bf9\u4e8e \u6ca1\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u672a\u77e5 \u7684\u4e00\u7cfb\u5217\u9519\u8bef\u503c\uff1a\u53ea\u80fd\u4f7f\u7528\u9519\u8bef\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u6765\u5224\u65ad\u3002 \u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185 \u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185\u7684\u9519\u8bef\u503c\u662f\u6700\u5bb9\u6613\u5206\u8fa8\u7684\u3002\u5982os\u5305\u4e2d\u7684\u51e0\u4e2a\u4ee3\u8868\u9519\u8bef\u7c7b\u578b\uff1a os.PathError os.LinkError os.SyccallError os/exec.Error \u5b83\u4eec\u7684\u6307\u9488\u7c7b\u578b\u90fd\u662ferror\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u540c\u65f6\u5b83\u4eec\u4e5f\u90fd\u5305\u542b\u4e86\u4e00\u4e2a\u540d\u53eb Err \uff0c\u7c7b\u578b\u4e3aerror\u63a5\u53e3\u7c7b\u578b\u7684\u4ee3\u8868\u6f5c\u5728\u9519\u8bef\u7684\u5b57\u6bb5\u3002\u5982\u679c\u5f97\u5230\u4e00\u4e2aerror\u7c7b\u578b\u503c\uff0c\u5e76\u4e14\u77e5\u9053\u8be5\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u80af\u5b9a\u662f\u5b83\u4eec\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u90a3\u4e48\u5c31\u7528switch\u8bed\u53e5\u53bb\u5224\u65ad\uff1a func underlyingError(err error) error { switch err := err.(type) { case *os.PathError: return err.Err case *os.LinkError: return err.Err case *os.SyscallError: return err.Err case *exec.Error: return err.Err } return err } // \u53ea\u8981\u7c7b\u578b\u4e0d\u540c\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u5224\u65ad\uff0c\u4f46\u662f\u5982\u679c\u9519\u8bef\u503c\u7c7b\u578b\u76f8\u540c\uff0c\u90a3\u4e48\u8fd9\u79cd\u65b9\u5f0f\u5c31\u65e0\u6548\u4e86 \u5df2\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u76f8\u540c \u5982os\u5305\u4e2d\u4e0d\u5c11\u9519\u8bef\u7c7b\u578b\u90fd\u662f\u901a\u8fc7\u8c03\u7528 errors.New \u51fd\u6570\u6765\u521d\u59cb\u5316\uff1a os.ErrClosed os.ErrInvalid os.ErrPermission \u8fd9\u51e0\u4e2a\u90fd\u662f\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\uff0c\u786e\u5207\u7684\u9519\u8bef\u503c\u3002 os\u5305\u4e2d\u7684\u4ee3\u7801\u6709\u65f6\u5019\u4f1a\u628a\u4ed6\u4eec\u5f53\u505a\u6f5c\u5728\u7684\u9519\u8bef\u503c\uff0c\u5c01\u88c5\u8fdb\u524d\u9762\u90a3\u4e9b\u9519\u8bef\u7c7b\u578b\u7684\u503c\u4e2d \u3002 \u5982\u679c\u5728\u64cd\u4f5c\u6587\u4ef6\u7cfb\u7edf\u7684\u65f6\u5019\u5f97\u5230\u4e00\u4e2a\u9519\u8bef\u503c\uff0c\u5e76\u4e14\u77e5\u9053\u8be5\u503c\u7684\u6f5c\u5728\u9519\u8bef\u503c\u80af\u5b9a\u662f\u4e0a\u8ff0\u503c\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u90a3\u5c31\u53ef\u4ee5\u7528\u666e\u901a\u7684switch\u6216\u8005if\u548c\u5224\u7b49\u8bed\u53e5\u53bb\u505a\u5224\u65ad\uff1a printError := func(i int, err error) { // \u63a5\u53d7error\u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u8be5\u503c\u4ee3\u8868\u67d0\u4e2a\u6587\u4ef6\u64cd\u4f5c\u76f8\u5173\u7684\u9519\u8bef if err == nil { fmt.Println( nil error ) return } err = underlyingError(err) switch err { case os.ErrClosed: fmt.Printf( error(closed)[%d]: %s\\n , i, err) case os.ErrInvalid: fmt.Printf( error(invalid)[%d]: %s\\n , i, err) case os.ErrPermission: fmt.Printf( error(permission)[%d]: %s\\n , i, err) } } // \u867d\u7136\u4e0d\u77e5\u9053\u8fd9\u4e9b\u9519\u8bef\u503c\u7684\u7c7b\u578b\u8303\u56f4\uff0c\u4f46\u5374\u77e5\u9053\u5b83\u4eec\u6216\u5b83\u4eec\u6f5c\u5728\u7684\u9519\u8bef\u503c\u4e00\u70b9\u5728\u67d0\u4e2a\u5df2\u77e5\u7684os\u5305\u4e2d\u5b9a\u4e49\u7684\u503c \u6ca1\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u672a\u77e5 \u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u9519\u8bef\u503c\u53ef\u80fd\u4ee3\u8868\u7684\u542b\u4e49\u77e5\u4e4b\u751a\u5c11\uff0c \u90a3\u4e48\u53ea\u80fd\u901a\u8fc7\u5b83\u62e5\u6709\u7684\u9519\u8bef\u4fe1\u606f\u53bb\u5224\u65ad\u4e86 \u3002 \u6211\u4eec\u603b\u662f\u80fd\u901a\u8fc7\u9519\u8bef\u503c\u7684Error\u65b9\u6cd5\u62ff\u5230\u5b83\u7684\u9519\u8bef\u4fe1\u606f\u3002\u5728os\u5305\u4e2d\u6709 os.IsExit \u3001 os.IsNotExit \u548c os.IsPermission \u51fd\u6570\u6765\u5224\u65ad\u3002 \u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u7ed9\u4e88\u6070\u5f53\u7684\u9519\u8bef\u503c \u6784\u5efa\u9519\u8bef\u503c\u4f53\u7cfb\u7684\u57fa\u672c\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a \u521b\u5efa\u7acb\u4f53\u7684\u9519\u8bef\u7c7b\u578b\u4f53\u7cfb \u521b\u5efa\u6241\u5e73\u7684\u9519\u8bef\u503c\u5217\u8868 \u9519\u8bef\u7c7b\u578b\u4f53\u7cfb \u5728Go\u8bed\u8a00\u4e2d\u5b9e\u73b0\u63a5\u53e3\u90fd\u662f\u975e\u4fb5\u5165\u5f0f\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u7684\u975e\u5e38\u7075\u6d3b\u3002 \u6bd4\u5982\u5728net\u5305\u4e2d\uff0c\u6709\u4e00\u4e2a\u540d\u4e3aError\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u5b83\u7b97\u662f\u5167\u5efa\u63a5\u53e3\u7c7b\u578berror\u7684\u4e00\u4e2a\u6269\u5c55\u63a5\u53e3\uff0c\u56e0\u4e3aerror\u662f net.Error \u7684\u5d4c\u5165\u63a5\u53e3\u3002 type Error interface { error Timeout() bool // Is the error a timeout? Temporary() bool // Is the error temporary? } net\u5305\u4e2d\u6709\u5f88\u591a\u9519\u8bef\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86 net.Error \u63a5\u53e3\uff0c\u5982\uff1a *net.OpError *net.AddrError net.UnknownNetworkError \u7b49 \u628a\u9519\u8bef\u7c7b\u578b\u60f3\u8c61\u6210\u4e00\u68f5\u6811\uff0c\u5185\u5efa\u63a5\u53e3error\u5c31\u662f\u6811\u6839\uff0c net.Error \u63a5\u53e3\u5c31\u662f\u4e00\u4e2a\u5728\u6839\u4e0a\u5ef6\u4f38\u7684\u7b2c\u4e00\u7ea7\u975e\u53f6\u5b50\u8282\u70b9\u3002 \u7528\u7c7b\u578b\u5efa\u7acb\u8d77\u6811\u5f62\u7ed3\u6784\u7684\u9519\u8bef\u4f53\u7cfb\uff0c\u7528\u7edf\u4e00\u5b57\u6bb5\u5efa\u7acb\u8d77\u53ef\u8ffd\u6839\u6eaf\u6e90\u7684\u94fe\u5f0f\u9519\u8bef\u5173\u8054\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u5305\u5916\u4ee3\u7801\u6539\u52a8\u8fd4\u56de\u9519\u8bef\u503c\u7684\u8bdd\uff0c\u4e00\u5b9a\u8981\u5c0f\u5199\u5176\u4e2d\u5b57\u6bb5\u7684\u540d\u79f0\u9996\u5b57\u6bcd \u3002\u901a\u8fc7\u66b4\u9732\u67d0\u4e9b\u65b9\u6cd5\u8ba9\u5305\u5916\u4ee3\u7801\u6709\u8fdb\u4e00\u6b65\u83b7\u53d6\u9519\u8bef\u4fe1\u606f\u7684\u6743\u9650\uff0c\u6bd4\u5982\u7f16\u5199\u4e00\u4e2a\u53ef\u4ee5\u8fd4\u56de\u5305\u7ea7\u79c1\u6709\u7684err\u5b57\u6bb5\u503c\u7684\u516c\u5f00\u65b9\u6cd5Err\u3002 \u9519\u8bef\u5217\u8868\u503c \u76f8\u5bf9\u4e8e\u7acb\u4f53\u7684\u9519\u8bef\u7c7b\u578b\u4f53\u7cfb\uff0c\u6241\u5e73\u7684\u9519\u8bef\u5217\u8868\u503c\u7b80\u5355\u5f88\u591a\u3002\u53ea\u662f\u60f3\u8981\u5148\u521b\u5efa\u4e00\u4e9b\u4ee3\u8868\u5df2\u77e5\u9519\u8bef\u7684\u9519\u8bef\u503c\u7684\u65f6\u5019\uff0c\u7528\u6241\u5e73\u5316\u7684\u65b9\u5f0f\u5f88\u6070\u5f53\u3002","title":"\u9519\u8bef\u5904\u7406"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_1","text":"error\u7c7b\u578b\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u662fGo\u8bed\u8a00\u5167\u5efa\u7c7b\u578b\uff0c\u5728\u8fd9\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u58f0\u660e\u4e2d\u53ea\u5305\u542b\u4e00\u4e2a\u65b9\u6cd5 Error \uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u63a5\u53d7\u4efb\u4f55\u53c2\u6570\uff0c\u4f46\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2astring\u7c7b\u578b\u7684\u7ed3\u679c\u3002 type error interface { Error() string //\u8fd4\u56de\u9519\u8bef\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u5f62\u5f0f } \u4f7f\u7528error\u7c7b\u578b\u7684\u65b9\u5f0f\uff0c\u901a\u5e38\u662f\u5728\u51fd\u6570\u58f0\u660e\u7684\u7ed3\u679c\u5217\u8868\u7684\u6700\u540e\uff0c\u58f0\u660e\u4e00\u4e2aerror\u7c7b\u578b\u7684\u7ed3\u679c\uff0c\u540c\u65f6\u5728\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u5148\u5224\u65ad\u5b83\u8d76\u56de\u7684\u6700\u540e\u4e00\u4e2a\u7ed3\u679c\u503c\u662f\u5426\u201c\u4e0d\u4e3anil\u201d\u3002 package main import ( errors fmt ) func echo(request string) (response string, err error) { if request == { // \u536b\u8ff0\u8bed\u53e5 err = errors.New( empty request ) return } response = fmt.Sprintf( echo: %s , request) return } func main() { for _, req := range []string{ , hello! } { fmt.Printf( request: %s\\n , req) resp, err := echo(req) if err != nil { // \u536b\u8ff0\u8bed\u53e5 fmt.Printf( error: %s\\n , err) continue } fmt.Printf( response: %s\\n , resp) } } \u6ce8\u610f\u70b9\uff1a \u5728\u8fdb\u884c\u9519\u8bef\u5904\u7406\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u4f1a\u7528\u5230\u536b\u8ff0\u8bed\u53e5 \u5728\u751f\u6210error\u7c7b\u578b\u503c\u7684\u65f6\u5019\u7528\u5230 errors.New \u51fd\u6570\uff0c\u8fd9\u662f\u4e00\u79cd\u6700\u57fa\u672c\u7684\u751f\u6210\u9519\u8bef\u503c\u7684\u65b9\u5f0f\u3002\u8c03\u7528\u5b83\u65f6\u4f20\u5165\u4e00\u4e2a\u6709\u5b57\u7b26\u4e32\u4ee3\u8868\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u8fd9\u4e2a\u9519\u8bef\u4fe1\u606f\u7684error\u7c7b\u578b\u503c\u3002\u8be5\u503c\u7684\u9759\u6001\u7c7b\u578b\u662ferror\uff0c\u52a8\u6001\u7c7b\u578b\u662f\u4e00\u4e2aerrors\u5305\u4e2d\uff0c\u5305\u7ea7\u79c1\u6709\u7684\u7c7b\u578b *errorString \u3002 errorString \u7c7b\u578b\u62e5\u6709\u7684\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5\u5b9e\u73b0\u4e86errors\u63a5\u53e3\u4e2d\u7684Error\u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u88ab\u8c03\u7528\u540e\uff0c\u4f1a\u539f\u5c01\u4e0d\u52a8\u5730\u8fd4\u56de\u4e4b\u524d\u4f20\u5165\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5b9e\u9645\u4e0a\uff0cerror\u7c7b\u578b\u503c\u7684Error\u65b9\u6cd5\u5c31\u76f8\u5f53\u4e8e\u5176\u4ed6\u7c7b\u578b\u503c\u7684String\u65b9\u6cd5\u3002 \u5728\u4e0a\u8ff0\u4f8b\u5b50\u4e2d\uff0c fmt.Printf \u51fd\u6570\u53d1\u73b0\u88ab\u6253\u5370\u7684\u662f\u4e00\u4e2aerror\u7c7b\u578b\uff0c\u5c31\u4f1a\u8c03\u7528\u5b83\u7684Error\u65b9\u6cd5\u3002\u5728fmt\u5305\u4e2d\uff0c\u8fd9\u7c7b\u6253\u5370\u51fd\u6570\u5176\u5b9e\u90fd\u662f\u8fd9\u4e48\u505a\u7684\u3002 \u5f53\u6211\u4eec\u901a\u8fc7\u6a21\u677f\u5316\u7684\u65b9\u5f0f\u751f\u6210\u9519\u8bef\u4fe1\u606f\uff0c\u5e76\u5f97\u5230\u9519\u8bef\u503c\u65f6\uff0c\u53ef\u4ee5\u4f7f\u7528 fmt.Errorf \u51fd\u6570\uff0c\u8be5\u51fd\u6570\u5176\u5b9e\u662f\u5148\u8c03\u7528 fmt.Sprintf \u51fd\u6570\uff0c\u5f97\u5230\u786e\u5207\u7684\u9519\u8bef\u4fe1\u606f\uff0c\u5728\u8c03\u7528 errors.New \u51fd\u6570\uff0c\u5f97\u5230\u8be5\u9519\u8bef\u4fe1\u606f\u7684error\u7c7b\u578b\u503c\uff0c\u6700\u540e\u8fd4\u56de\u8be5\u503c\u3002","title":"\u9519\u8bef\u5904\u7406"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_2","text":"\u56e0\u4e3aerror\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0c\u6240\u4ee5\u5373\u4f7f\u540c\u4e3aerror\u7c7b\u578b\u7684\u9519\u8bef\u503c\uff0c\u4ed6\u4eec\u7684\u5b9e\u9645\u7c7b\u578b\u4e5f\u53ef\u80fd\u4e0d\u540c\u3002 \u5bf9\u4e8e \u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185 \u7684\u4e00\u7cfb\u5217\u9519\u8bef\u503c\u5728\uff1a\u4e00\u822c\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u6216\u8005switch\u8bed\u53e5\u6765\u5224\u65ad \u5bf9\u4e8e \u5df2\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u76f8\u540c \u7684\u4e00\u4e9b\u9519\u8bef\u503c\uff0c\u4e00\u822c\u76f4\u63a5\u4f7f\u7528\u5224\u7b49\u64cd\u4f5c\u6765\u5224\u65ad \u5bf9\u4e8e \u6ca1\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u672a\u77e5 \u7684\u4e00\u7cfb\u5217\u9519\u8bef\u503c\uff1a\u53ea\u80fd\u4f7f\u7528\u9519\u8bef\u4fe1\u606f\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u6765\u5224\u65ad\u3002","title":"\u5982\u4f55\u5224\u65ad\u9519\u8bef\u503c\u5177\u4f53\u4ee3\u8868\u54ea\u4e00\u7c7b\u9519\u8bef"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_3","text":"\u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185\u7684\u9519\u8bef\u503c\u662f\u6700\u5bb9\u6613\u5206\u8fa8\u7684\u3002\u5982os\u5305\u4e2d\u7684\u51e0\u4e2a\u4ee3\u8868\u9519\u8bef\u7c7b\u578b\uff1a os.PathError os.LinkError os.SyccallError os/exec.Error \u5b83\u4eec\u7684\u6307\u9488\u7c7b\u578b\u90fd\u662ferror\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u540c\u65f6\u5b83\u4eec\u4e5f\u90fd\u5305\u542b\u4e86\u4e00\u4e2a\u540d\u53eb Err \uff0c\u7c7b\u578b\u4e3aerror\u63a5\u53e3\u7c7b\u578b\u7684\u4ee3\u8868\u6f5c\u5728\u9519\u8bef\u7684\u5b57\u6bb5\u3002\u5982\u679c\u5f97\u5230\u4e00\u4e2aerror\u7c7b\u578b\u503c\uff0c\u5e76\u4e14\u77e5\u9053\u8be5\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u80af\u5b9a\u662f\u5b83\u4eec\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u90a3\u4e48\u5c31\u7528switch\u8bed\u53e5\u53bb\u5224\u65ad\uff1a func underlyingError(err error) error { switch err := err.(type) { case *os.PathError: return err.Err case *os.LinkError: return err.Err case *os.SyscallError: return err.Err case *exec.Error: return err.Err } return err } // \u53ea\u8981\u7c7b\u578b\u4e0d\u540c\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f\u6765\u5224\u65ad\uff0c\u4f46\u662f\u5982\u679c\u9519\u8bef\u503c\u7c7b\u578b\u76f8\u540c\uff0c\u90a3\u4e48\u8fd9\u79cd\u65b9\u5f0f\u5c31\u65e0\u6548\u4e86","title":"\u7c7b\u578b\u5728\u5df2\u77e5\u8303\u56f4\u5185"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_4","text":"\u5982os\u5305\u4e2d\u4e0d\u5c11\u9519\u8bef\u7c7b\u578b\u90fd\u662f\u901a\u8fc7\u8c03\u7528 errors.New \u51fd\u6570\u6765\u521d\u59cb\u5316\uff1a os.ErrClosed os.ErrInvalid os.ErrPermission \u8fd9\u51e0\u4e2a\u90fd\u662f\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\uff0c\u786e\u5207\u7684\u9519\u8bef\u503c\u3002 os\u5305\u4e2d\u7684\u4ee3\u7801\u6709\u65f6\u5019\u4f1a\u628a\u4ed6\u4eec\u5f53\u505a\u6f5c\u5728\u7684\u9519\u8bef\u503c\uff0c\u5c01\u88c5\u8fdb\u524d\u9762\u90a3\u4e9b\u9519\u8bef\u7c7b\u578b\u7684\u503c\u4e2d \u3002 \u5982\u679c\u5728\u64cd\u4f5c\u6587\u4ef6\u7cfb\u7edf\u7684\u65f6\u5019\u5f97\u5230\u4e00\u4e2a\u9519\u8bef\u503c\uff0c\u5e76\u4e14\u77e5\u9053\u8be5\u503c\u7684\u6f5c\u5728\u9519\u8bef\u503c\u80af\u5b9a\u662f\u4e0a\u8ff0\u503c\u4e2d\u7684\u67d0\u4e00\u4e2a\uff0c\u90a3\u5c31\u53ef\u4ee5\u7528\u666e\u901a\u7684switch\u6216\u8005if\u548c\u5224\u7b49\u8bed\u53e5\u53bb\u505a\u5224\u65ad\uff1a printError := func(i int, err error) { // \u63a5\u53d7error\u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u8be5\u503c\u4ee3\u8868\u67d0\u4e2a\u6587\u4ef6\u64cd\u4f5c\u76f8\u5173\u7684\u9519\u8bef if err == nil { fmt.Println( nil error ) return } err = underlyingError(err) switch err { case os.ErrClosed: fmt.Printf( error(closed)[%d]: %s\\n , i, err) case os.ErrInvalid: fmt.Printf( error(invalid)[%d]: %s\\n , i, err) case os.ErrPermission: fmt.Printf( error(permission)[%d]: %s\\n , i, err) } } // \u867d\u7136\u4e0d\u77e5\u9053\u8fd9\u4e9b\u9519\u8bef\u503c\u7684\u7c7b\u578b\u8303\u56f4\uff0c\u4f46\u5374\u77e5\u9053\u5b83\u4eec\u6216\u5b83\u4eec\u6f5c\u5728\u7684\u9519\u8bef\u503c\u4e00\u70b9\u5728\u67d0\u4e2a\u5df2\u77e5\u7684os\u5305\u4e2d\u5b9a\u4e49\u7684\u503c","title":"\u5df2\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u76f8\u540c"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_5","text":"\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u9519\u8bef\u503c\u53ef\u80fd\u4ee3\u8868\u7684\u542b\u4e49\u77e5\u4e4b\u751a\u5c11\uff0c \u90a3\u4e48\u53ea\u80fd\u901a\u8fc7\u5b83\u62e5\u6709\u7684\u9519\u8bef\u4fe1\u606f\u53bb\u5224\u65ad\u4e86 \u3002 \u6211\u4eec\u603b\u662f\u80fd\u901a\u8fc7\u9519\u8bef\u503c\u7684Error\u65b9\u6cd5\u62ff\u5230\u5b83\u7684\u9519\u8bef\u4fe1\u606f\u3002\u5728os\u5305\u4e2d\u6709 os.IsExit \u3001 os.IsNotExit \u548c os.IsPermission \u51fd\u6570\u6765\u5224\u65ad\u3002","title":"\u6ca1\u6709\u76f8\u5e94\u53d8\u91cf\u4e14\u7c7b\u578b\u672a\u77e5"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_6","text":"\u6784\u5efa\u9519\u8bef\u503c\u4f53\u7cfb\u7684\u57fa\u672c\u65b9\u5f0f\u6709\u4e24\u79cd\uff1a \u521b\u5efa\u7acb\u4f53\u7684\u9519\u8bef\u7c7b\u578b\u4f53\u7cfb \u521b\u5efa\u6241\u5e73\u7684\u9519\u8bef\u503c\u5217\u8868","title":"\u5982\u4f55\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u7ed9\u4e88\u6070\u5f53\u7684\u9519\u8bef\u503c"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_7","text":"\u5728Go\u8bed\u8a00\u4e2d\u5b9e\u73b0\u63a5\u53e3\u90fd\u662f\u975e\u4fb5\u5165\u5f0f\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u7684\u975e\u5e38\u7075\u6d3b\u3002 \u6bd4\u5982\u5728net\u5305\u4e2d\uff0c\u6709\u4e00\u4e2a\u540d\u4e3aError\u7684\u63a5\u53e3\u7c7b\u578b\uff0c\u5b83\u7b97\u662f\u5167\u5efa\u63a5\u53e3\u7c7b\u578berror\u7684\u4e00\u4e2a\u6269\u5c55\u63a5\u53e3\uff0c\u56e0\u4e3aerror\u662f net.Error \u7684\u5d4c\u5165\u63a5\u53e3\u3002 type Error interface { error Timeout() bool // Is the error a timeout? Temporary() bool // Is the error temporary? } net\u5305\u4e2d\u6709\u5f88\u591a\u9519\u8bef\u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86 net.Error \u63a5\u53e3\uff0c\u5982\uff1a *net.OpError *net.AddrError net.UnknownNetworkError \u7b49 \u628a\u9519\u8bef\u7c7b\u578b\u60f3\u8c61\u6210\u4e00\u68f5\u6811\uff0c\u5185\u5efa\u63a5\u53e3error\u5c31\u662f\u6811\u6839\uff0c net.Error \u63a5\u53e3\u5c31\u662f\u4e00\u4e2a\u5728\u6839\u4e0a\u5ef6\u4f38\u7684\u7b2c\u4e00\u7ea7\u975e\u53f6\u5b50\u8282\u70b9\u3002 \u7528\u7c7b\u578b\u5efa\u7acb\u8d77\u6811\u5f62\u7ed3\u6784\u7684\u9519\u8bef\u4f53\u7cfb\uff0c\u7528\u7edf\u4e00\u5b57\u6bb5\u5efa\u7acb\u8d77\u53ef\u8ffd\u6839\u6eaf\u6e90\u7684\u94fe\u5f0f\u9519\u8bef\u5173\u8054\u3002 \u5982\u679c\u4e0d\u5e0c\u671b\u5305\u5916\u4ee3\u7801\u6539\u52a8\u8fd4\u56de\u9519\u8bef\u503c\u7684\u8bdd\uff0c\u4e00\u5b9a\u8981\u5c0f\u5199\u5176\u4e2d\u5b57\u6bb5\u7684\u540d\u79f0\u9996\u5b57\u6bcd \u3002\u901a\u8fc7\u66b4\u9732\u67d0\u4e9b\u65b9\u6cd5\u8ba9\u5305\u5916\u4ee3\u7801\u6709\u8fdb\u4e00\u6b65\u83b7\u53d6\u9519\u8bef\u4fe1\u606f\u7684\u6743\u9650\uff0c\u6bd4\u5982\u7f16\u5199\u4e00\u4e2a\u53ef\u4ee5\u8fd4\u56de\u5305\u7ea7\u79c1\u6709\u7684err\u5b57\u6bb5\u503c\u7684\u516c\u5f00\u65b9\u6cd5Err\u3002","title":"\u9519\u8bef\u7c7b\u578b\u4f53\u7cfb"},{"location":"Language/Basic/15-\u9519\u8bef\u5904\u7406/#_8","text":"\u76f8\u5bf9\u4e8e\u7acb\u4f53\u7684\u9519\u8bef\u7c7b\u578b\u4f53\u7cfb\uff0c\u6241\u5e73\u7684\u9519\u8bef\u5217\u8868\u503c\u7b80\u5355\u5f88\u591a\u3002\u53ea\u662f\u60f3\u8981\u5148\u521b\u5efa\u4e00\u4e9b\u4ee3\u8868\u5df2\u77e5\u9519\u8bef\u7684\u9519\u8bef\u503c\u7684\u65f6\u5019\uff0c\u7528\u6241\u5e73\u5316\u7684\u65b9\u5f0f\u5f88\u6070\u5f53\u3002","title":"\u9519\u8bef\u5217\u8868\u503c"},{"location":"Language/Basic/16-panic&recover&defer/","text":"\u5f02\u5e38 \u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09 \u8fd9\u79cd\u5f02\u5e38\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u624d\u4f1a\u629b\u51fa\u3002 slice := []int{1,2,3} print(slice[3]) // panic: runtime error: index out of range // goroutine 1 [running]: ID\u4e3a1\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u5728\u6b64panic\u88ab\u5f15\u53d1\u65f6\u6b63\u5728\u8fd0\u884c // main.main() \u7528\u6237\u7ea7\u7ebf\u7a0b\u5305\u88c5\u7684go\u51fd\u6570\uff0c\u5728\u8fd9\u91cc\u662fmain\u51fd\u6570\uff0c\u6240\u4ee5\u8fd9\u4e2a\u662f\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b // /Users/haolin/GeekTime/Golang_Puzzlers/src/puzzlers/article19/q0/demo47.go:5 +0x3d painc\u88ab\u5f15\u8d77\u65f6\u6b63\u5728\u6267\u884c\u7684\u4ee3\u7801 +0x3d \u8868\u793a\u6b64\u884c\u4ee3\u7801\u5bf9\u4e8e\u5176\u6240\u5c5e\u7684\u5165\u53e3\u7a0b\u5e8f\u8ba1\u6570\u504f\u79fb\u91cf // exit status 2 Go\u8bed\u8a00\u4e2d\u56e0panic\u800c\u9000\u51fa\u7684\u7a0b\u5e8f\u4e00\u822c\u9000\u51fa\u7801\u90fd\u662f2 Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u4f1a\u5728\u6267\u884c\u5230\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u5019\u629b\u51fa\u4e00\u4e2a\u7d22\u5f15\u8d8a\u754c\u7684\u5f02\u5e38\uff0c\u5f53panic\u88ab\u629b\u51fa\u540e\uff0c\u6ca1\u6709\u5728\u7a0b\u5e8f\u91cc\u6dfb\u52a0\u4efb\u4f55\u4fdd\u62a4\u63aa\u65bd\u7684\u8bdd\uff0c\u7a0b\u5e8f\uff08\u6216\u8005\u4ee3\u8868\u5b83\u7684\u8fdb\u7a0b\uff09\u5c31\u4f1a\u5728\u6253\u5370\u51fapanic\u7684\u8be6\u7ec6\u4fe1\u4e4b\u540e\u7ec8\u6b62\u8fd0\u884c\u3002 \u4e0a\u8ff0\u4f8b\u5b50\u629b\u51fa\u7684\u5f02\u5e38\u662fruntime\u5305\u4e2d\u629b\u51fa\u7684panic\uff0c\u5728\u8fd9\u4e2apanic\u4e2d\uff0c\u5305\u542b\u4e00\u4e2a runtime.Error \u63a5\u53e3\u7c7b\u578b\u7684\u503c\uff0c runtime.Error \u63a5\u53e3\u5185\u5d4c\u4e86error\u63a5\u53e3\uff0c\u5e76\u505a\u4e86\u4e00\u70b9\u6269\u5c55\u3002\u5728panic\u53f3\u8fb9\u7684\u5185\u5bb9\uff0c\u5c31\u662f\u8fd9\u4e2apanic\u5305\u542b\u7684 runtime.Error \u7c7b\u578b\u503c\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002 \u4ecepanic\u88ab\u5f15\u53d1\u5230\u7a0b\u5e8f\u7ec8\u6b62\u8fd0\u884c\u7684\u5927\u81f4\u8fc7\u7a0b \u51fd\u6570\u4e2d\u7684\u67d0\u884c\u4ee3\u7801\u6709\u610f\u6216\u65e0\u610f\u5730\u5f15\u53d1\u4e86\u4e00\u4e2apanic \u521d\u59cb\u7684panic\u8be6\u60c5\u4f1a\u88ab\u5efa\u7acb\u8d77\u6765 \u8be5\u7a0b\u5e8f\u7684\u63a7\u5236\u6743\u4f1a\u7acb\u5373\u4ece\u6b64\u4ee3\u7801\u8f6c\u79fb\u81f3\u8c03\u7528\u8d77\u6240\u5c5e\u51fd\u6570\u7684\u90a3\u4e2a\u4ee3\u7801\u884c\u4e0a\uff08\u4e5f\u5c31\u662f\u8c03\u7528\u6808\u4e2d\u7684\u4e0a\u4e00\u7ea7\uff09 \u6b64\u884c\u4ee3\u7801\u6240\u5c5e\u51fd\u6570\u7684\u6267\u884c\u968f\u5373\u88ab\u7ec8\u6b62 \u63a7\u5236\u6743\u7acb\u5373\u8f6c\u79fb\u81f3\u518d\u4e0a\u4e00\u7ea7\u7684\u8c03\u7528\u4ee3\u7801\u5904\uff08\u63a7\u5236\u6743\u4e00\u7ea7\u4e00\u7ea7\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\u81f3\u9876\u7aef\uff0c\u6211\u4eec\u7f16\u5199\u7684\u6700\u5916\u5c42\u51fd\u6570\uff09 \u5bf9\u4e8e\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u6700\u5916\u5c42\u51fd\u6570\u662fgo\u51fd\u6570\uff0c\u5bf9\u4e8e\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u6700\u5916\u5c42\u51fd\u6570\u662fmain\u51fd\u6570 \u63a7\u5236\u6743\u6700\u7ec8\u88abGo\u8fd0\u884c\u65f6\u7cfb\u7edf\u6536\u56de \u968f\u540e\u7a0b\u5e8f\u5d29\u6e83\u5e76\u7ec8\u6b62\u8fd0\u884c\uff0c\u627f\u8f7d\u7a0b\u5e8f\u8fd9\u6b21\u8fd0\u884c\u7684\u8fdb\u7a0b\u4f1a\u968f\u4e4b\u6b7b\u4ea1\u5e76\u6d88\u5931 \u5728\u8fd9\u4e2a\u63a7\u5236\u6743\u4f20\u64ad\u7684\u8fc7\u7a0b\u4e2d\uff0cpanic\u8be6\u60c5\u4f1a\u4e4b\u95f4\u88ab\u79ef\u7d2f\u548c\u5b8c\u5584\uff0c\u5e76\u4f1a\u5728\u7a0b\u5e8f\u7ec8\u6b62\u4e4b\u524d\u6253\u5370\u51fa\u6765\u3002 Go\u8bed\u8a00\u7684\u5185\u5efa\u51fd\u6570panic\u662f\u4e13\u95e8\u7528\u4e8e\u5f15\u53d1panic\u7684\uff0cpanic\u51fd\u6570\u4f7f\u7a0b\u5e8f\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u62a5\u544a\u5f02\u5e38\u3002\u8fd9\u4e0e\u4ece\u51fd\u6570\u8fd4\u56de\u9519\u8bef\u503c\u7684\u610f\u4e49\u662f\u5b8c\u5168\u4e0d\u540c\u7684\uff0c\u5f53\u6211\u4eec\u7684\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u975enil\u7684\u9519\u8bef\u503c\u65f6\uff0c\u51fd\u6570\u7684\u8c03\u7528\u65b9\u6709\u6743\u9009\u62e9\u4e0d\u5904\u7406\uff0c\u5e76\u4e14\u4e0d\u5904\u7406\u7684\u540e\u679c\u5f80\u5f80\u662f\u4e0d\u81f4\u547d\u7684\uff08\u5373\u4e0d\u81f3\u4e8e\u7a0b\u5e8f\u50f5\u6b7b\u6216\u5d29\u6e83\uff09\u3002 \u5f53\u4e00\u4e2apanic\u53d1\u751f\u65f6\uff0c\u5982\u679c\u4e0d\u65bd\u52a0\u4efb\u4f55\u4fdd\u62a4\u63aa\u65bd\uff0c\u90a3\u4e48\u5bfc\u81f4\u7684\u76f4\u63a5\u540e\u679c\u5c31\u662f\u7a0b\u5e8f\u5d29\u6e83\uff0c\u8fd9\u662f\u81f4\u547d\u7684\u3002 panic\u53ea\u80fd\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u629b\u51fa\u7684\u7a0b\u5e8f\u5f02\u5e38\uff0c\u5b83\u7684\u8be6\u60c5\u4f1a\u5728\u63a7\u5236\u6743\u4f20\u64ad\u7684\u8fc7\u7a0b\u4e2d\uff0c\u88ab\u9010\u6e10\u5730\u79ef\u7d2f\u548c\u5b8c\u5584\uff0c\u5e76\u4e14\uff0c\u63a7\u5236\u6743\u4f1a\u4e00\u7ea7\u4e00\u7ea7\u5730\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\u81f3\u9876\u7aef \u3002 \u8ba9panic\u5305\u542b\u4e00\u4e2a\u503c \u5982\u679c\u4e00\u4e2apanic\u662f\u65e0\u610f\u95f4\u5f15\u53d1\u7684\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u503c\u53ea\u80fd\u7531Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u7ed9\u5b9a \u5982\u679c\u4f7f\u7528panic\u51fd\u6570\u6709\u610f\u5730\u5f15\u53d1\u4e00\u4e2apanic\uff0c\u90a3\u4e48\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u5176\u5305\u542b\u7684\u503c \u5728\u8c03\u7528panic\u51fd\u6570\u65f6\uff0c\u628a\u67d0\u4e2a\u503c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u8be5\u51fd\u6570\uff0c\u5373\u53ef\u81ea\u884c\u6307\u5b9a\u5176\u5305\u542b\u7684\u503c\u3002\u7531\u4e8epanic\u51fd\u6570\u7684\u552f\u4e00\u4e00\u4e2a\u53c2\u6570\u662f\u7a7a\u63a5\u53e3\uff08interface{}\uff09\u7c7b\u578b\uff0c\u4ece\u8bed\u6cd5\u4e0a\uff0c\u53ef\u4ee5\u63a5\u6536\u4efb\u4f55\u7c7b\u578b\u7684\u503c\u3002 \u4f46\u662f\uff0c\u6700\u597d\u4f20\u5165error\u7c7b\u578b\u7684\u9519\u8bef\u503c\uff0c\u6216\u8005\u5176\u4ed6\u53ef\u88ab\u6709\u6548\u5e8f\u5217\u5316\uff08\u6709\u6548\u5e8f\u5217\u5316\u6307\u7684\u662f\u53ef\u4ee5\u66f4\u6613\u8bfb\u5730\u53bb\u8868\u793a\u5f62\u5f0f\u8f6c\u6362\uff09\u7684\u503c \u3002 \u5728fmt\u5305\u4e2d\u7684\u5404\u79cd\u6253\u5370\u51fd\u6570\u6765\u8bf4\uff0cerror\u7c7b\u578b\u7684\u503cError\u65b9\u6cd5\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684String\u65b9\u6cd5\u662f\u7b49\u5bb6\u7535\uff0c\u5b83\u4eec\u7684\u552f\u4e00\u7ed3\u679c\u90fd\u662fString\u7c7b\u578b\u3002\u901a\u8fc7\u5360\u4f4d\u7b26 %s \u8f93\u51fa\u5b83\u4eec\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002\u4e00\u65e6\u7a0b\u5e8f\u5f02\u5e38\uff0c\u5c31\u5e94\u8be5\u628a\u5f02\u5e38\u4fe1\u606f\u8bb0\u5f55\u5230\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u3002 \u6240\u4ee5\u5982\u679c\u67d0\u4e2a\u503c\u53ef\u80fd\u4f1a\u88ab\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\uff0c\u5c31\u5e94\u8be5\u7ed9\u5b83\u5173\u8054String\u53cd\u590d\uff0c\u5982\u679c\u662ferror\u7c7b\u578b\uff0c\u5c31\u5e94\u8be5\u5173\u8054Error\u65b9\u6cd5\u3002 \u5bf9panic\u65bd\u52a0\u4fdd\u62a4\u907f\u514d\u7a0b\u5e8f\u5d29\u6e83 Go\u8bed\u8a00\u5185\u5efa\u7684recover\u4e13\u7528\u4e8e\u6062\u590dpanic\uff0c\u5e73\u606f\u8fd0\u884c\u65f6\u6050\u614c\u3002recover\u51fd\u6570\u65e0\u9700\u4efb\u4f55\u53c2\u6570\uff0c\u5e76\u4e14\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002 \u5982\u679c\u7528\u6cd5\u6b63\u786e \uff0c\u8fd9\u4e2a\u503c\u5b9e\u9645\u4e0a\u5c31\u662f\u5373\u5c06\u6062\u590d\u7684panic\u5305\u542b\u7684\u503c\u3002\u5982\u679c\u8fd9\u4e2apanic\u662f\u6211\u4eec\u8c03\u7528panic\u51fd\u6570\u800c\u5f15\u53d1\u7684\uff0c\u90a3\u4e48\u8be5\u503c\u540c\u4e8b\u4f1a\u662f\u6211\u4eec\u6b64\u6b21\u8c03\u7528panic\u51fd\u6570\u65f6\u4f20\u5165\u7684\u53c2\u6570\u503c\u526f\u672c\u3002 package main import ( fmt errors ) func main() { fmt.Println( Enter function main. ) // \u5f15\u53d1 panic\u3002 panic(errors.New( something wrong )) // \u624b\u52a8\u8c03\u7528panic\u5f15\u53d1\u8fd0\u884c\u65f6\u6050\u614c p := recover() fmt.Printf( panic: %s\\n , p) // \u624b\u52a8\u8c03\u7528recover\u6062\u590dpanic fmt.Println( Exit function main. ) } recover\u51fd\u6570\u7684\u8c03\u7528\u6ca1\u6709\u4efb\u4f55\u4f5c\u7528\uff0c\u751a\u81f3\u90fd\u6ca1\u6709\u673a\u4f1a\u6267\u884c\uff0c\u56e0\u4e3apanic\u4e00\u65e6\u53d1\u751f\uff0c\u63a7\u5236\u6743\u5c31\u4f1a\u8fc5\u901f\u5730\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\uff0c\u6240\u4ee5\u5728panic\u51fd\u6570\u8c03\u7528\u4e4b\u540e\u7684\u4ee3\u7801\uff0c\u6839\u672c\u5c31\u6ca1\u6709\u6267\u884c\u7684\u673a\u4f1a\u3002 \u5982\u679c\u6211\u4eec\u5728\u8c03\u7528recover\u51fd\u6570\u65f6\u6ca1\u6709\u53d1\u751fpanic\uff0c\u90a3\u4e48\u8be5\u51fd\u6570\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u5e76\u4e14\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2anil \u3002\u6b63\u786e\u8c03\u7528recover\u51fd\u6570\u9700\u8981\u914d\u5408defer\u8bed\u53e5\u4e00\u8d77\u4f7f\u7528\u3002 defer\u8bed\u53e5 defer\u8bed\u53e5\u662f\u88ab\u7528\u6765\u5ef6\u8fdf\u6267\u884c\u4ee3\u7801\u7684\uff0c\u5ef6\u8fdf\u5230\u8be5\u8bed\u53e5\u6240\u5728\u7684\u51fd\u6570\u5373\u5c06\u6267\u884c\u7ed3\u675f\u7684\u90a3\u4e00\u523b\uff0c\u65e0\u8bba\u7ed3\u675f\u6267\u884c\u7684\u539f\u56e0\u662f\u4ec0\u4e48\u3002\u6709\u4e00\u4e9b\u8c03\u7528\u8868\u8fbe\u5f0f\u4e0d\u80fd\u51fa\u73b0\u5728defer\u8bed\u53e5\u4e2d\uff1a \u9488\u5bf9Go\u8bed\u8a00\u5185\u5efa\u51fd\u6570\u7684\u8c03\u7528\u8868\u8fbe\u5f0f \u9488\u5bf9unsafe\u5305\u4e2d\u7684\u51fd\u6570\u7684\u8c03\u7528\u8868\u8fbe\u5f0f \u5728defer\u8bed\u53e5\u4e2d\uff0c\u88ab\u8c03\u7528\u7684\u51fd\u6570\u53ef\u4ee5\u662f\u6709\u540d\u79f0\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u533f\u540d\u7684\uff0c\u628a\u8fd9\u91cc\u7684\u51fd\u6570\u53eb\u505adefer\u51fd\u6570\u6216\u8005\u5ef6\u8fdf\u51fd\u6570\uff0c \u6ce8\u610f\uff0c\u88ab\u5ef6\u8fdf\u6267\u884c\u7684\u662fdefer\u51fd\u6570\uff0c\u800c\u4e0d\u662fdefer\u8bed\u53e5 \u3002 \u65e0\u8bba\u51fd\u6570\u7ed3\u675f\u6267\u884c\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff0c\u5176\u4e2ddefer\u51fd\u6570\u8c03\u7528\u90fd\u4f1a\u5728\u5b83\u5373\u5c06\u7ed3\u675f\u6267\u884c\u7684\u90a3\u4e00\u523b\u6267\u884c\uff0c\u5373\u4f7f\u6267\u884c\u7ed3\u675f\u7684\u539f\u56e0\u662f\u4e00\u4e2apanic\u4e5f\u4f1a\u662f\u8fd9\u6837\u3002\u56e0\u6b64\uff0c\u9700\u8981\u8fde\u7528defer\u8bed\u53e5\u548crecover\u51fd\u6570\uff0c\u624d\u80fd\u6062\u590d\u4e00\u4e2a\u5df2\u7ecf\u53d1\u751f\u7684panic\u3002 package main import ( fmt errors ) func main() { fmt.Println( Enter function main. ) defer func(){ fmt.Println( Enter defer function. ) if p := recover(); p != nil { // p!=nil \u5224\u65ad\u786e\u5b9e\u53d1\u751f\u4e86panic fmt.Printf( panic: %s\\n , p) } fmt.Println( Exit defer function. ) }() // \u5f15\u53d1 panic\u3002 panic(errors.New( something wrong )) fmt.Println( Exit function main. ) } \u6ce8\u610fdefer\u8bed\u53e5\u7684\u4f4d\u7f6e\uff0c\u5c3d\u91cf\u5199\u5728\u51fd\u6570\u4f53\u7684\u5f00\u59cb\u5904\uff0c\u56e0\u4e3a\u5728\u5f15\u53d1panic\u7684\u8bed\u53e5\u4e4b\u540e\u7684\u6240\u6709\u8bed\u53e5\uff0c\u90fd\u6ca1\u6709\u4efb\u4f55\u6267\u884c\u7684\u673a\u4f1a \u3002 \u4e00\u4e2a\u51fd\u6570\u4e2d\u6709\u591a\u4e2adefer\u8bed\u53e5\uff0cdefer\u51fd\u6570\u7684\u6267\u884c\u987a\u5e8f \u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0cdefer\u51fd\u6570\u8c03\u7528\u7684\u6267\u884c\u987a\u5e8f\u4e0e\u5b83\u4eec\u5206\u522b\u6240\u5c5e\u7684defer\u8bed\u53e5\u7684\u51fa\u73b0\u987a\u5e8f\uff08\u6267\u884c\u987a\u5e8f\uff09\u5b8c\u5168\u76f8\u53cd\u3002\u5f53\u4e00\u4e2a\u51fd\u6570\u5373\u5c06\u7ed3\u675f\u6267\u884c\u65f6\uff0c\u5176\u4e2d\u5378\u8f7d\u6700\u4e0b\u9762\u7684defer\u51fd\u6570\u8c03\u7528\u4f1a\u6700\u5148\u6267\u884c\uff0c\u5176\u6b21\u662f\u5199\u5728\u5b83\u4e0a\u8fb9\u3001\u4e0e\u5b83\u8ddd\u79bb\u6700\u8fd1\u7684defer\u51fd\u6570\u8c03\u7528\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6700\u4e0a\u8fb9\u7684defer\u51fd\u6570\u8c03\u7528\u6700\u540e\u4e00\u4e2a\u6267\u884c\u3002 \u5982\u679c\u4e00\u4e2afor\u8bed\u53e5\u4e2d\u5305\u542b\u4e00\u4e2adefer\u8bed\u53e5\uff0c\u90a3\u4e48defer\u8bed\u53e5\u7684\u6267\u884c\u6b21\u6570\uff0c\u53d6\u51b3\u4e8e\u5faa\u73af\u7684\u8fed\u4ee3\u6b21\u6570\uff0c\u5e76\u4e14\u540c\u4e00\u4e2adefer\u8bed\u53e5\u88ab\u6267\u884c\u4e00\u6b21\uff0c\u5176\u4e2d\u7684defer\u51fd\u6570\u8c03\u7528\u5c31\u4f1a\u4ea7\u751f\u4e00\u6b21\uff0c\u800c\u4e14\u8fd9\u4e9b\u51fd\u6570\u8c03\u7528\u540c\u6837\u4e0d\u4f1a\u88ab\u7acb\u5373\u6267\u884c\u3002 defer\u8bed\u53e5\u6267\u884c\u65f6\u53d1\u751f\u7684\u4e8b\u60c5 \u5728defer\u8bed\u53e5\u6bcf\u6b21\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0cGo\u8bed\u8a00\u4f1a\u628a\u5b83\u643a\u5e26\u7684defer\u51fd\u6570\u4ee5\u53ca\u5176\u53c2\u6570\u503c\u53e6\u884c\u5b58\u50a8\u5230\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\u961f\u5217\u4e2d\u3002\u8fd9\u4e2a\u961f\u5217\u4e0edefer\u8bed\u53e5\u6240\u5c5e\u7684\u51fd\u6570\u662f\u5bf9\u5e94\u7684\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6808\u3002 \u9700\u8981\u6267\u884c\u67d0\u4e2a\u51fd\u6570\u4e2d\u7684defer\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cGo\u8bed\u8a00\u4f1a\u5148\u62ff\u5230\u5bf9\u5e94\u7684\u961f\u5217\uff0c\u7136\u540e\u4ece\u8be5\u961f\u5217\u4e2d\u4e00\u4e2a\u4e00\u4e2a\u5730\u53d6\u51fadefer\u51fd\u6570\u53ca\u5176\u53c2\u6570\u503c\uff0c\u5e76\u9010\u4e2a\u6267\u884c\u8c03\u7528\u3002","title":"\u5f02\u5e38"},{"location":"Language/Basic/16-panic&recover&defer/#_1","text":"","title":"\u5f02\u5e38"},{"location":"Language/Basic/16-panic&recover&defer/#panic","text":"\u8fd9\u79cd\u5f02\u5e38\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u65f6\u624d\u4f1a\u629b\u51fa\u3002 slice := []int{1,2,3} print(slice[3]) // panic: runtime error: index out of range // goroutine 1 [running]: ID\u4e3a1\u7684\u7528\u6237\u7ea7\u7ebf\u7a0b\u5728\u6b64panic\u88ab\u5f15\u53d1\u65f6\u6b63\u5728\u8fd0\u884c // main.main() \u7528\u6237\u7ea7\u7ebf\u7a0b\u5305\u88c5\u7684go\u51fd\u6570\uff0c\u5728\u8fd9\u91cc\u662fmain\u51fd\u6570\uff0c\u6240\u4ee5\u8fd9\u4e2a\u662f\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b // /Users/haolin/GeekTime/Golang_Puzzlers/src/puzzlers/article19/q0/demo47.go:5 +0x3d painc\u88ab\u5f15\u8d77\u65f6\u6b63\u5728\u6267\u884c\u7684\u4ee3\u7801 +0x3d \u8868\u793a\u6b64\u884c\u4ee3\u7801\u5bf9\u4e8e\u5176\u6240\u5c5e\u7684\u5165\u53e3\u7a0b\u5e8f\u8ba1\u6570\u504f\u79fb\u91cf // exit status 2 Go\u8bed\u8a00\u4e2d\u56e0panic\u800c\u9000\u51fa\u7684\u7a0b\u5e8f\u4e00\u822c\u9000\u51fa\u7801\u90fd\u662f2 Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\uff0c\u4f1a\u5728\u6267\u884c\u5230\u8fd9\u4e2a\u4ee3\u7801\u7684\u65f6\u5019\u629b\u51fa\u4e00\u4e2a\u7d22\u5f15\u8d8a\u754c\u7684\u5f02\u5e38\uff0c\u5f53panic\u88ab\u629b\u51fa\u540e\uff0c\u6ca1\u6709\u5728\u7a0b\u5e8f\u91cc\u6dfb\u52a0\u4efb\u4f55\u4fdd\u62a4\u63aa\u65bd\u7684\u8bdd\uff0c\u7a0b\u5e8f\uff08\u6216\u8005\u4ee3\u8868\u5b83\u7684\u8fdb\u7a0b\uff09\u5c31\u4f1a\u5728\u6253\u5370\u51fapanic\u7684\u8be6\u7ec6\u4fe1\u4e4b\u540e\u7ec8\u6b62\u8fd0\u884c\u3002 \u4e0a\u8ff0\u4f8b\u5b50\u629b\u51fa\u7684\u5f02\u5e38\u662fruntime\u5305\u4e2d\u629b\u51fa\u7684panic\uff0c\u5728\u8fd9\u4e2apanic\u4e2d\uff0c\u5305\u542b\u4e00\u4e2a runtime.Error \u63a5\u53e3\u7c7b\u578b\u7684\u503c\uff0c runtime.Error \u63a5\u53e3\u5185\u5d4c\u4e86error\u63a5\u53e3\uff0c\u5e76\u505a\u4e86\u4e00\u70b9\u6269\u5c55\u3002\u5728panic\u53f3\u8fb9\u7684\u5185\u5bb9\uff0c\u5c31\u662f\u8fd9\u4e2apanic\u5305\u542b\u7684 runtime.Error \u7c7b\u578b\u503c\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002","title":"\u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09"},{"location":"Language/Basic/16-panic&recover&defer/#panic_1","text":"\u51fd\u6570\u4e2d\u7684\u67d0\u884c\u4ee3\u7801\u6709\u610f\u6216\u65e0\u610f\u5730\u5f15\u53d1\u4e86\u4e00\u4e2apanic \u521d\u59cb\u7684panic\u8be6\u60c5\u4f1a\u88ab\u5efa\u7acb\u8d77\u6765 \u8be5\u7a0b\u5e8f\u7684\u63a7\u5236\u6743\u4f1a\u7acb\u5373\u4ece\u6b64\u4ee3\u7801\u8f6c\u79fb\u81f3\u8c03\u7528\u8d77\u6240\u5c5e\u51fd\u6570\u7684\u90a3\u4e2a\u4ee3\u7801\u884c\u4e0a\uff08\u4e5f\u5c31\u662f\u8c03\u7528\u6808\u4e2d\u7684\u4e0a\u4e00\u7ea7\uff09 \u6b64\u884c\u4ee3\u7801\u6240\u5c5e\u51fd\u6570\u7684\u6267\u884c\u968f\u5373\u88ab\u7ec8\u6b62 \u63a7\u5236\u6743\u7acb\u5373\u8f6c\u79fb\u81f3\u518d\u4e0a\u4e00\u7ea7\u7684\u8c03\u7528\u4ee3\u7801\u5904\uff08\u63a7\u5236\u6743\u4e00\u7ea7\u4e00\u7ea7\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\u81f3\u9876\u7aef\uff0c\u6211\u4eec\u7f16\u5199\u7684\u6700\u5916\u5c42\u51fd\u6570\uff09 \u5bf9\u4e8e\u5176\u4ed6\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u6700\u5916\u5c42\u51fd\u6570\u662fgo\u51fd\u6570\uff0c\u5bf9\u4e8e\u4e3b\u7528\u6237\u7ea7\u7ebf\u7a0b\uff0c\u6700\u5916\u5c42\u51fd\u6570\u662fmain\u51fd\u6570 \u63a7\u5236\u6743\u6700\u7ec8\u88abGo\u8fd0\u884c\u65f6\u7cfb\u7edf\u6536\u56de \u968f\u540e\u7a0b\u5e8f\u5d29\u6e83\u5e76\u7ec8\u6b62\u8fd0\u884c\uff0c\u627f\u8f7d\u7a0b\u5e8f\u8fd9\u6b21\u8fd0\u884c\u7684\u8fdb\u7a0b\u4f1a\u968f\u4e4b\u6b7b\u4ea1\u5e76\u6d88\u5931 \u5728\u8fd9\u4e2a\u63a7\u5236\u6743\u4f20\u64ad\u7684\u8fc7\u7a0b\u4e2d\uff0cpanic\u8be6\u60c5\u4f1a\u4e4b\u95f4\u88ab\u79ef\u7d2f\u548c\u5b8c\u5584\uff0c\u5e76\u4f1a\u5728\u7a0b\u5e8f\u7ec8\u6b62\u4e4b\u524d\u6253\u5370\u51fa\u6765\u3002 Go\u8bed\u8a00\u7684\u5185\u5efa\u51fd\u6570panic\u662f\u4e13\u95e8\u7528\u4e8e\u5f15\u53d1panic\u7684\uff0cpanic\u51fd\u6570\u4f7f\u7a0b\u5e8f\u5f00\u53d1\u8005\u53ef\u4ee5\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u62a5\u544a\u5f02\u5e38\u3002\u8fd9\u4e0e\u4ece\u51fd\u6570\u8fd4\u56de\u9519\u8bef\u503c\u7684\u610f\u4e49\u662f\u5b8c\u5168\u4e0d\u540c\u7684\uff0c\u5f53\u6211\u4eec\u7684\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u975enil\u7684\u9519\u8bef\u503c\u65f6\uff0c\u51fd\u6570\u7684\u8c03\u7528\u65b9\u6709\u6743\u9009\u62e9\u4e0d\u5904\u7406\uff0c\u5e76\u4e14\u4e0d\u5904\u7406\u7684\u540e\u679c\u5f80\u5f80\u662f\u4e0d\u81f4\u547d\u7684\uff08\u5373\u4e0d\u81f3\u4e8e\u7a0b\u5e8f\u50f5\u6b7b\u6216\u5d29\u6e83\uff09\u3002 \u5f53\u4e00\u4e2apanic\u53d1\u751f\u65f6\uff0c\u5982\u679c\u4e0d\u65bd\u52a0\u4efb\u4f55\u4fdd\u62a4\u63aa\u65bd\uff0c\u90a3\u4e48\u5bfc\u81f4\u7684\u76f4\u63a5\u540e\u679c\u5c31\u662f\u7a0b\u5e8f\u5d29\u6e83\uff0c\u8fd9\u662f\u81f4\u547d\u7684\u3002 panic\u53ea\u80fd\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u629b\u51fa\u7684\u7a0b\u5e8f\u5f02\u5e38\uff0c\u5b83\u7684\u8be6\u60c5\u4f1a\u5728\u63a7\u5236\u6743\u4f20\u64ad\u7684\u8fc7\u7a0b\u4e2d\uff0c\u88ab\u9010\u6e10\u5730\u79ef\u7d2f\u548c\u5b8c\u5584\uff0c\u5e76\u4e14\uff0c\u63a7\u5236\u6743\u4f1a\u4e00\u7ea7\u4e00\u7ea7\u5730\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\u81f3\u9876\u7aef \u3002","title":"\u4ecepanic\u88ab\u5f15\u53d1\u5230\u7a0b\u5e8f\u7ec8\u6b62\u8fd0\u884c\u7684\u5927\u81f4\u8fc7\u7a0b"},{"location":"Language/Basic/16-panic&recover&defer/#panic_2","text":"\u5982\u679c\u4e00\u4e2apanic\u662f\u65e0\u610f\u95f4\u5f15\u53d1\u7684\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u503c\u53ea\u80fd\u7531Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u7ed9\u5b9a \u5982\u679c\u4f7f\u7528panic\u51fd\u6570\u6709\u610f\u5730\u5f15\u53d1\u4e00\u4e2apanic\uff0c\u90a3\u4e48\u53ef\u4ee5\u81ea\u884c\u6307\u5b9a\u5176\u5305\u542b\u7684\u503c \u5728\u8c03\u7528panic\u51fd\u6570\u65f6\uff0c\u628a\u67d0\u4e2a\u503c\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9\u8be5\u51fd\u6570\uff0c\u5373\u53ef\u81ea\u884c\u6307\u5b9a\u5176\u5305\u542b\u7684\u503c\u3002\u7531\u4e8epanic\u51fd\u6570\u7684\u552f\u4e00\u4e00\u4e2a\u53c2\u6570\u662f\u7a7a\u63a5\u53e3\uff08interface{}\uff09\u7c7b\u578b\uff0c\u4ece\u8bed\u6cd5\u4e0a\uff0c\u53ef\u4ee5\u63a5\u6536\u4efb\u4f55\u7c7b\u578b\u7684\u503c\u3002 \u4f46\u662f\uff0c\u6700\u597d\u4f20\u5165error\u7c7b\u578b\u7684\u9519\u8bef\u503c\uff0c\u6216\u8005\u5176\u4ed6\u53ef\u88ab\u6709\u6548\u5e8f\u5217\u5316\uff08\u6709\u6548\u5e8f\u5217\u5316\u6307\u7684\u662f\u53ef\u4ee5\u66f4\u6613\u8bfb\u5730\u53bb\u8868\u793a\u5f62\u5f0f\u8f6c\u6362\uff09\u7684\u503c \u3002 \u5728fmt\u5305\u4e2d\u7684\u5404\u79cd\u6253\u5370\u51fd\u6570\u6765\u8bf4\uff0cerror\u7c7b\u578b\u7684\u503cError\u65b9\u6cd5\u4e0e\u5176\u4ed6\u7c7b\u578b\u7684String\u65b9\u6cd5\u662f\u7b49\u5bb6\u7535\uff0c\u5b83\u4eec\u7684\u552f\u4e00\u7ed3\u679c\u90fd\u662fString\u7c7b\u578b\u3002\u901a\u8fc7\u5360\u4f4d\u7b26 %s \u8f93\u51fa\u5b83\u4eec\u7684\u5b57\u7b26\u4e32\u8868\u793a\u5f62\u5f0f\u3002\u4e00\u65e6\u7a0b\u5e8f\u5f02\u5e38\uff0c\u5c31\u5e94\u8be5\u628a\u5f02\u5e38\u4fe1\u606f\u8bb0\u5f55\u5230\u7a0b\u5e8f\u65e5\u5fd7\u4e2d\u3002 \u6240\u4ee5\u5982\u679c\u67d0\u4e2a\u503c\u53ef\u80fd\u4f1a\u88ab\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\uff0c\u5c31\u5e94\u8be5\u7ed9\u5b83\u5173\u8054String\u53cd\u590d\uff0c\u5982\u679c\u662ferror\u7c7b\u578b\uff0c\u5c31\u5e94\u8be5\u5173\u8054Error\u65b9\u6cd5\u3002","title":"\u8ba9panic\u5305\u542b\u4e00\u4e2a\u503c"},{"location":"Language/Basic/16-panic&recover&defer/#panic_3","text":"Go\u8bed\u8a00\u5185\u5efa\u7684recover\u4e13\u7528\u4e8e\u6062\u590dpanic\uff0c\u5e73\u606f\u8fd0\u884c\u65f6\u6050\u614c\u3002recover\u51fd\u6570\u65e0\u9700\u4efb\u4f55\u53c2\u6570\uff0c\u5e76\u4e14\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7a7a\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002 \u5982\u679c\u7528\u6cd5\u6b63\u786e \uff0c\u8fd9\u4e2a\u503c\u5b9e\u9645\u4e0a\u5c31\u662f\u5373\u5c06\u6062\u590d\u7684panic\u5305\u542b\u7684\u503c\u3002\u5982\u679c\u8fd9\u4e2apanic\u662f\u6211\u4eec\u8c03\u7528panic\u51fd\u6570\u800c\u5f15\u53d1\u7684\uff0c\u90a3\u4e48\u8be5\u503c\u540c\u4e8b\u4f1a\u662f\u6211\u4eec\u6b64\u6b21\u8c03\u7528panic\u51fd\u6570\u65f6\u4f20\u5165\u7684\u53c2\u6570\u503c\u526f\u672c\u3002 package main import ( fmt errors ) func main() { fmt.Println( Enter function main. ) // \u5f15\u53d1 panic\u3002 panic(errors.New( something wrong )) // \u624b\u52a8\u8c03\u7528panic\u5f15\u53d1\u8fd0\u884c\u65f6\u6050\u614c p := recover() fmt.Printf( panic: %s\\n , p) // \u624b\u52a8\u8c03\u7528recover\u6062\u590dpanic fmt.Println( Exit function main. ) } recover\u51fd\u6570\u7684\u8c03\u7528\u6ca1\u6709\u4efb\u4f55\u4f5c\u7528\uff0c\u751a\u81f3\u90fd\u6ca1\u6709\u673a\u4f1a\u6267\u884c\uff0c\u56e0\u4e3apanic\u4e00\u65e6\u53d1\u751f\uff0c\u63a7\u5236\u6743\u5c31\u4f1a\u8fc5\u901f\u5730\u6cbf\u7740\u8c03\u7528\u6808\u7684\u53cd\u65b9\u5411\u4f20\u64ad\uff0c\u6240\u4ee5\u5728panic\u51fd\u6570\u8c03\u7528\u4e4b\u540e\u7684\u4ee3\u7801\uff0c\u6839\u672c\u5c31\u6ca1\u6709\u6267\u884c\u7684\u673a\u4f1a\u3002 \u5982\u679c\u6211\u4eec\u5728\u8c03\u7528recover\u51fd\u6570\u65f6\u6ca1\u6709\u53d1\u751fpanic\uff0c\u90a3\u4e48\u8be5\u51fd\u6570\u4e0d\u4f1a\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u5e76\u4e14\u53ea\u4f1a\u8fd4\u56de\u4e00\u4e2anil \u3002\u6b63\u786e\u8c03\u7528recover\u51fd\u6570\u9700\u8981\u914d\u5408defer\u8bed\u53e5\u4e00\u8d77\u4f7f\u7528\u3002","title":"\u5bf9panic\u65bd\u52a0\u4fdd\u62a4\u907f\u514d\u7a0b\u5e8f\u5d29\u6e83"},{"location":"Language/Basic/16-panic&recover&defer/#defer","text":"defer\u8bed\u53e5\u662f\u88ab\u7528\u6765\u5ef6\u8fdf\u6267\u884c\u4ee3\u7801\u7684\uff0c\u5ef6\u8fdf\u5230\u8be5\u8bed\u53e5\u6240\u5728\u7684\u51fd\u6570\u5373\u5c06\u6267\u884c\u7ed3\u675f\u7684\u90a3\u4e00\u523b\uff0c\u65e0\u8bba\u7ed3\u675f\u6267\u884c\u7684\u539f\u56e0\u662f\u4ec0\u4e48\u3002\u6709\u4e00\u4e9b\u8c03\u7528\u8868\u8fbe\u5f0f\u4e0d\u80fd\u51fa\u73b0\u5728defer\u8bed\u53e5\u4e2d\uff1a \u9488\u5bf9Go\u8bed\u8a00\u5185\u5efa\u51fd\u6570\u7684\u8c03\u7528\u8868\u8fbe\u5f0f \u9488\u5bf9unsafe\u5305\u4e2d\u7684\u51fd\u6570\u7684\u8c03\u7528\u8868\u8fbe\u5f0f \u5728defer\u8bed\u53e5\u4e2d\uff0c\u88ab\u8c03\u7528\u7684\u51fd\u6570\u53ef\u4ee5\u662f\u6709\u540d\u79f0\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u533f\u540d\u7684\uff0c\u628a\u8fd9\u91cc\u7684\u51fd\u6570\u53eb\u505adefer\u51fd\u6570\u6216\u8005\u5ef6\u8fdf\u51fd\u6570\uff0c \u6ce8\u610f\uff0c\u88ab\u5ef6\u8fdf\u6267\u884c\u7684\u662fdefer\u51fd\u6570\uff0c\u800c\u4e0d\u662fdefer\u8bed\u53e5 \u3002 \u65e0\u8bba\u51fd\u6570\u7ed3\u675f\u6267\u884c\u7684\u539f\u56e0\u662f\u4ec0\u4e48\uff0c\u5176\u4e2ddefer\u51fd\u6570\u8c03\u7528\u90fd\u4f1a\u5728\u5b83\u5373\u5c06\u7ed3\u675f\u6267\u884c\u7684\u90a3\u4e00\u523b\u6267\u884c\uff0c\u5373\u4f7f\u6267\u884c\u7ed3\u675f\u7684\u539f\u56e0\u662f\u4e00\u4e2apanic\u4e5f\u4f1a\u662f\u8fd9\u6837\u3002\u56e0\u6b64\uff0c\u9700\u8981\u8fde\u7528defer\u8bed\u53e5\u548crecover\u51fd\u6570\uff0c\u624d\u80fd\u6062\u590d\u4e00\u4e2a\u5df2\u7ecf\u53d1\u751f\u7684panic\u3002 package main import ( fmt errors ) func main() { fmt.Println( Enter function main. ) defer func(){ fmt.Println( Enter defer function. ) if p := recover(); p != nil { // p!=nil \u5224\u65ad\u786e\u5b9e\u53d1\u751f\u4e86panic fmt.Printf( panic: %s\\n , p) } fmt.Println( Exit defer function. ) }() // \u5f15\u53d1 panic\u3002 panic(errors.New( something wrong )) fmt.Println( Exit function main. ) } \u6ce8\u610fdefer\u8bed\u53e5\u7684\u4f4d\u7f6e\uff0c\u5c3d\u91cf\u5199\u5728\u51fd\u6570\u4f53\u7684\u5f00\u59cb\u5904\uff0c\u56e0\u4e3a\u5728\u5f15\u53d1panic\u7684\u8bed\u53e5\u4e4b\u540e\u7684\u6240\u6709\u8bed\u53e5\uff0c\u90fd\u6ca1\u6709\u4efb\u4f55\u6267\u884c\u7684\u673a\u4f1a \u3002","title":"defer\u8bed\u53e5"},{"location":"Language/Basic/16-panic&recover&defer/#deferdefer","text":"\u5728\u4e00\u4e2a\u51fd\u6570\u4e2d\uff0cdefer\u51fd\u6570\u8c03\u7528\u7684\u6267\u884c\u987a\u5e8f\u4e0e\u5b83\u4eec\u5206\u522b\u6240\u5c5e\u7684defer\u8bed\u53e5\u7684\u51fa\u73b0\u987a\u5e8f\uff08\u6267\u884c\u987a\u5e8f\uff09\u5b8c\u5168\u76f8\u53cd\u3002\u5f53\u4e00\u4e2a\u51fd\u6570\u5373\u5c06\u7ed3\u675f\u6267\u884c\u65f6\uff0c\u5176\u4e2d\u5378\u8f7d\u6700\u4e0b\u9762\u7684defer\u51fd\u6570\u8c03\u7528\u4f1a\u6700\u5148\u6267\u884c\uff0c\u5176\u6b21\u662f\u5199\u5728\u5b83\u4e0a\u8fb9\u3001\u4e0e\u5b83\u8ddd\u79bb\u6700\u8fd1\u7684defer\u51fd\u6570\u8c03\u7528\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6700\u4e0a\u8fb9\u7684defer\u51fd\u6570\u8c03\u7528\u6700\u540e\u4e00\u4e2a\u6267\u884c\u3002 \u5982\u679c\u4e00\u4e2afor\u8bed\u53e5\u4e2d\u5305\u542b\u4e00\u4e2adefer\u8bed\u53e5\uff0c\u90a3\u4e48defer\u8bed\u53e5\u7684\u6267\u884c\u6b21\u6570\uff0c\u53d6\u51b3\u4e8e\u5faa\u73af\u7684\u8fed\u4ee3\u6b21\u6570\uff0c\u5e76\u4e14\u540c\u4e00\u4e2adefer\u8bed\u53e5\u88ab\u6267\u884c\u4e00\u6b21\uff0c\u5176\u4e2d\u7684defer\u51fd\u6570\u8c03\u7528\u5c31\u4f1a\u4ea7\u751f\u4e00\u6b21\uff0c\u800c\u4e14\u8fd9\u4e9b\u51fd\u6570\u8c03\u7528\u540c\u6837\u4e0d\u4f1a\u88ab\u7acb\u5373\u6267\u884c\u3002","title":"\u4e00\u4e2a\u51fd\u6570\u4e2d\u6709\u591a\u4e2adefer\u8bed\u53e5\uff0cdefer\u51fd\u6570\u7684\u6267\u884c\u987a\u5e8f"},{"location":"Language/Basic/16-panic&recover&defer/#defer_1","text":"\u5728defer\u8bed\u53e5\u6bcf\u6b21\u88ab\u6267\u884c\u7684\u65f6\u5019\uff0cGo\u8bed\u8a00\u4f1a\u628a\u5b83\u643a\u5e26\u7684defer\u51fd\u6570\u4ee5\u53ca\u5176\u53c2\u6570\u503c\u53e6\u884c\u5b58\u50a8\u5230\u4e00\u4e2a\u5148\u8fdb\u5148\u51fa\u961f\u5217\u4e2d\u3002\u8fd9\u4e2a\u961f\u5217\u4e0edefer\u8bed\u53e5\u6240\u5c5e\u7684\u51fd\u6570\u662f\u5bf9\u5e94\u7684\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6808\u3002 \u9700\u8981\u6267\u884c\u67d0\u4e2a\u51fd\u6570\u4e2d\u7684defer\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cGo\u8bed\u8a00\u4f1a\u5148\u62ff\u5230\u5bf9\u5e94\u7684\u961f\u5217\uff0c\u7136\u540e\u4ece\u8be5\u961f\u5217\u4e2d\u4e00\u4e2a\u4e00\u4e2a\u5730\u53d6\u51fadefer\u51fd\u6570\u53ca\u5176\u53c2\u6570\u503c\uff0c\u5e76\u9010\u4e2a\u6267\u884c\u8c03\u7528\u3002","title":"defer\u8bed\u53e5\u6267\u884c\u65f6\u53d1\u751f\u7684\u4e8b\u60c5"},{"location":"Language/Basic/17-sync/","text":"sync `sync.Mutex \u548c sync.RWMutex \u7ade\u6001\u6761\u4ef6\u3001\u4e34\u754c\u533a\u548c\u540c\u6b65\u5de5\u5177 Go\u8bed\u8a00\u5ba3\u626c\u201c \u7528\u901a\u4fe1\u7684\u65b9\u5f0f\u5171\u4eab\u6570\u636e \u201d\uff0c\u4f46\u662f\uff0c \u901a\u8fc7\u5171\u4eab\u6570\u636e\u7684\u65b9\u5f0f\u6765\u4f20\u9012\u4fe1\u606f\u548c\u534f\u8c03\u7ebf\u7a0b\u8fd0\u884c \u7684\u505a\u6cd5\u5176\u5b9e\u66f4\u52a0\u4e3b\u6d41\uff0c\u5927\u90e8\u5206\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00\u90fd\u4f7f\u7528\u540e\u4e00\u79cd\u65b9\u5f0f\u4f5c\u4e3a\u5e76\u53d1\u7f16\u7a0b\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u4e00\u65e6\u6570\u636e\u88ab\u591a\u4e2a\u7ebf\u7a0b\u5171\u4eab\uff0c\u5f88\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e89\u7528\u548c\u51b2\u7a81\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a \u7ade\u6001\u6761\u4ef6\uff08race condition\uff09 \uff0c\u8fd9\u5f80\u5f80\u4f1a\u7834\u574f\u5171\u4eab\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002 \u5171\u4eab\u6570\u636e\u7684\u4e00\u81f4\u6027\u4ee3\u8868\u7740\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u6570\u636e\u7684\u64cd\u4f5c\u603b\u662f\u53ef\u4ee5\u8fbe\u5230\u5b83\u4eec\u5404\u81ea\u9884\u671f\u7684\u6548\u679c \u3002 \u540c\u6b65\u7684\u7528\u9014\u6709\u4e24\u4e2a\uff1a \u907f\u514d\u591a\u4e2a\u7ebf\u7a0b\uff0c\u5728\u540c\u4e00\u65f6\u523b\u64cd\u4f5c\u540c\u4e00\u4e2a \u6570\u636e\u5757 \u534f\u8c03\u591a\u4e2a\u7ebf\u7a0b\uff0c\u907f\u514d\u5b83\u4eec\u5728\u540c\u4e00\u65f6\u523b\u6267\u884c\u540c\u4e00\u4e2a \u4ee3\u7801\u5757 \u8fd9\u4e9b\u6570\u636e\u5757\u548c\u4ee3\u7801\u5757\u7684\u80cc\u540e\u90fd\u9690\u542b\u7740\u4e00\u79cd\u6216\u591a\u79cd\u8d44\u6e90\uff08\u5982\u5b58\u50a8\u8d44\u6e90\uff0c\u8ba1\u7b97\u8d44\u6e90\u3001I/O\u8d44\u6e90\u3001\u7f51\u7edc\u8d44\u6e90\u7b49\uff09\uff0c\u628a\u5b83\u4eec\u770b\u6210\u662f\u5171\u4eab\u8d44\u6e90\uff0c \u540c\u6b65\u5176\u5b9e\u5c31\u662f\u5728\u63a7\u5236\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee \u3002 \u5982\u679c\u67d0\u4e2a\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\uff0c\u5728\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\uff0c\u90a3\u4e48\u591a\u4e2a\u5e76\u53d1\u7ebf\u7a0b\u5bf9\u8be5\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u662f\u5b8c\u5168\u4e32\u884c\u7684\u3002\u53ea\u8981\u4e00\u4e2a\u4ee3\u7801\u5757\u9700\u8981\u5b9e\u73b0\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u4e32\u884c\u5316\u8bbf\u95ee\uff0c\u5c31\u53ef\u4ee5\u88ab\u89c6\u4e3a\u4e00\u4e2a\u4e34\u754c\u533a\uff08critical section\uff09\uff0c\u7531\u4e8e\u8981\u8bbf\u95ee\u5230\u8d44\u6e90\u800c\u5fc5\u987b\u8fdb\u5165\u7684\u90a3\u4e2a\u533a\u57df\u3002 \u5982\u679c\u9488\u5bf9\u540c\u4e00\u4e2a\u5171\u4eab\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u5757\u6709\u591a\u4e2a\uff0c\u90a3\u4e48\u5b83\u4eec\u6210\u4e3a\u76f8\u5173\u4e34\u754c\u533a\u3002 \u5b83\u4eec\u53ef\u4ee5\u662f\u4e00\u4e2a\u5185\u542b\u4e86\u5171\u4eab\u6570\u636e\u7684\u7ed3\u6784\u4f53\u53ca\u5176\u65b9\u6cd5\uff0c \u4e5f\u53ef\u4ee5\u662f\u64cd\u4f5c\u540c\u4e00\u5757\u5171\u4eab\u6570\u636e\u7684\u591a\u4e2a\u51fd\u6570\u3002 \u4e34\u754c\u533a\u603b\u662f\u9700\u8981\u6536\u5230\u4fdd\u62a4\uff0c\u5426\u5219\u5c31\u4f1a\u4ea7\u751f\u7ade\u6001\u6761\u4ef6\uff0c\u65bd\u52a0\u4fdd\u62a4\u7684\u91cd\u8981\u624b\u6bb5\u4e4b\u4e00\uff0c\u5c31\u662f \u4f7f\u7528\u5b9e\u73b0\u4e86\u67d0\u79cd\u540c\u6b65\u673a\u5236\u7684\u5de5\u5177 \uff0c\u79f0\u4e3a\u540c\u6b65\u5de5\u5177\u3002 \u5728Go\u8bed\u8a00\u4e2d\uff0c\u53ef\u4f9b\u9009\u62e9\u7684\u540c\u6b65\u5de5\u5177\u4e0d\u5c11\uff0c\u6700\u91cd\u8981\u6700\u5e38\u7528\u7684\u540c\u6b65\u5de5\u5177\u662f \u4e92\u65a5\u91cf\uff08mutual exclusion\uff0c\u7b80\u79f0mutex\uff09 \u3002sync\u5305\u4e2d\u7684Mutex\u5c31\u662f\u4e0e\u5176\u5bf9\u5e94\u7684\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u7684\u503c\u53ef\u4ee5\u88ab\u79f0\u4e3a\u4e92\u65a5\u91cf\u6216\u8005\u4e92\u65a5\u9501\u3002 \u4e00\u4e2a\u4e92\u65a5\u9501\u53ef\u4ee5\u88ab\u7528\u6765\u5305\u542b\u4e00\u4e2a\u4e34\u754c\u533a\u6216\u8005\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a\uff0c\u901a\u8fc7\u5b83\u6765\u4fdd\u8bc1\u5728\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2agoroutine\u5904\u4e8e\u8be5\u4e34\u754c\u533a\u5185\u3002\u6bcf\u5f53\u6709goroutine\u60f3\u8fdb\u5165\u4e34\u754c\u533a\u65f6\uff0c\u90fd\u9700\u8981\u5148\u5bf9\u5b83\u8fdb\u884c\u9501\u5b9a\uff0c\u79bb\u5f00\u65f6\u8981\u53ca\u65f6\u8fdb\u884c\u89e3\u9501\u3002 \u9501\u5b9a\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u4e92\u65a5\u9501\u7684Lock\u65b9\u6cd5\u5b9e\u73b0 \u89e3\u9501\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u4e92\u65a5\u9501\u7684Unlock\u65b9\u6cd5\u5b9e\u73b0 mu.Lock() _, err := writer.Write([]byte(data)) if err != nil { log.Printf( error:%s[%d] ,err,id) } mu.UnLock() \u4f7f\u7528\u4e92\u65a5\u9501\u6ce8\u610f\u4e8b\u9879 \u4e0d\u8981\u91cd\u590d\u9501\u5b9a\u4e92\u65a5\u9501\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u9501\u5b9a\u7684\u4e92\u65a5\u9501\u8fdb\u884c\u9501\u5b9a\uff0c\u4f1a\u7acb\u5373\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u8fd9\u4e2agoroutine\u6267\u884c\u7684\u6d41\u7a0b\u4f1a\u4e00\u76f4\u505c\u6ede\u5728\u8c03\u7528\u8be5\u4e92\u65a5\u9501\u7684Lock\u65b9\u6cd5\u7684\u90a3\u884c\u4ee3\u7801\u4e0a\u3002\u76f4\u5230\u4e92\u65a5\u9501\u7684Unlock\u65b9\u6cd5\u88ab\u8c03\u7528\uff0c\u5e76\u4e14\u8fd9\u91cc\u7684\u9501\u5b9a\u64cd\u4f5c\u6210\u529f\u4e4b\u540e\uff0c\u4e34\u754c\u533a\u7684\u4ee3\u7801\u624d\u4f1a\u6267\u884c\u3002 \u4e0d\u8981\u5fd8\u8bb0\u89e3\u9501\u4e92\u65a5\u9501\uff0c\u5fc5\u8981\u65f6\u4f7f\u7528defer\u8bed\u53e5 \u53ef\u4ee5\u907f\u514d\u51fa\u73b0\u91cd\u590d\u9501\u5b9a\u3002\u56e0\u4e3a\u5fd8\u8bb0\u63a5\u6536\u4f1a\u4f7f\u5f97\u5176\u4ed6goroutine\u65e0\u6cd5\u8fdb\u5165\u5230\u4e92\u65a5\u9501\u4fdd\u62a4\u7684\u4e34\u754c\u533a\u4e2d\uff0c\u8f7b\u5219\u529f\u80fd\u5931\u6548\uff0c\u91cd\u5219\u6b7b\u9501\u5d29\u6e83\u3002 \u7a0b\u5e8f\u7684\u6d41\u7a0b\u53ef\u4ee5\u5206\u53c9\u4e5f\u53ef\u4ee5\u88ab\u4e2d\u65ad\uff0c\u6240\u4ee5\u4e00\u4e2a\u6d41\u7a0b\u5728\u9501\u5b9a\u67d0\u4e2a\u4e92\u65a5\u9501\u4e4b\u540e\uff0c\u7d27\u8ddf\u7740defer\u8bed\u53e5\u8fdb\u884c\u63a5\u6536\u662f\u6bd4\u8f83\u7a33\u59a5\u7684\u3002 3. \u4e0d\u8981\u5bf9\u5c1a\u672a\u9501\u5b9a\u6216\u8005\u5df2\u89e3\u9501\u7684\u4e92\u65a5\u9501\u89e3\u9501 \u89e3\u9501\u672a\u9501\u5b9a\u7684\u4e92\u65a5\u9501\u4f1a\u7acb\u5373\u5f15\u8d77panic\u3002\u4e0e\u6b7b\u9501\u7684panic\u4e00\u6837\uff0c\u65e0\u6cd5\u88ab\u6062\u590d\u3002 \u56e0\u6b64\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9501\u5b9a\u64cd\u4f5c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u89e3\u9501\u64cd\u4f5c \u3002 4. \u4e0d\u8981\u5728\u591a\u4e2a\u51fd\u6570\u4e4b\u95f4\u76f4\u63a5\u4f20\u9012\u4e92\u65a5\u9501 \u6b7b\u9501\uff0c\u5f53\u524d\u7a0b\u5e8f\u4e2d\u7684\u4e3bgoroutine\uff0c\u4ee5\u53ca\u542f\u7528\u7684\u90a3\u4e9bgoroutine\u90fd\u5df2\u7ecf\u88ab\u963b\u585e\uff0c\u8fd9\u4e9bgoroutine\u53ef\u4ee5\u88ab\u7edf\u79f0\u4e3a\u7528\u6237\u7ea7\u7684goroutine\uff0c\u8fd9\u5c31\u76f8\u5f53\u4e8e\u6574\u4e2a\u7a0b\u5e8f\u90fd\u5df2\u7ecf\u505c\u6ede\u4e0d\u524d\u4e86\u3002 Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4e0d\u5141\u8bb8\u8fd9\u79cd\u60c5\u51b5\u51fa\u73b0\uff0c\u5f53\u53d1\u73b0\u6240\u4ee5\u7528\u6237\u7ea7goroutine\u90fd\u5904\u4e8e\u7b49\u5f85\u4f1a\u629b\u51fa\u5982\u4e0bpanic\uff1a fatal error: all goroutines are asleep - deadlock! Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u81ea\u884c\u629b\u51fa\u7684panic\u90fd\u5c5e\u4e8e\u81f4\u547d\u9519\u8bef\uff0c\u65e0\u6cd5\u88ab\u6062\u590d\uff0c\u8c03\u7528recover\u51fd\u6570\u5bf9\u5b83\u4eec\u8d77\u4e0d\u5230\u4efb\u4f55\u4f5c\u7528\uff0c\u7a0b\u5e8f\u6b7b\u9501\uff0c\u5fc5\u7136\u5d29\u6e83 \u3002 \u5f53\u6bcf\u4e2a\u4e92\u65a5\u9501\u90fd\u53ea\u4fdd\u62a4\u4e00\u4e2a\u4e34\u754c\u533a\u6216\u8005\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a\u53ef\u4ee5\u6709\u6548\u907f\u514d\u6b7b\u9501\u3002 \u4f20\u9012\u4e92\u65a5\u9501 Go\u8bed\u8a00\u4e2d\u7684\u4e92\u65a5\u9501\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u58f0\u660e\u4e00\u4e2a sync.Mutex \u7c7b\u578b\uff08\u8be5\u7c7b\u578b\u662f\u4e00\u4e2a \u7ed3\u6784\u4f53 \u7c7b\u578b\uff0c\u5c5e\u4e8e \u503c\u7c7b\u578b \uff09\u7684\u53d8\u91cf\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\u3002 \u5bf9\u4e8e\u503c\u7c7b\u578b\u7684\u64cd\u4f5c\uff0c\u628a\u5b83\u4f20\u7ed9\u4e00\u4e2a\u51fd\u6570\uff0c\u5c06\u5b83\u4ece\u51fd\u6570\u4e2d\u8fd4\u56de\uff0c\u628a\u5b83\u8d4b\u7ed9\u5176\u4ed6\u53d8\u91cf\uff0c\u8ba9\u5b83\u8fdb\u5165\u67d0\u4e2a\u901a\u9053\u90fd\u4f1a\u5bfc\u81f4\u5b83\u7684\u526f\u672c\u7684\u4ea7\u751f\u3002 \u539f\u503c\u4e0e\u526f\u672c\u3001\u526f\u672c\u4e0e\u526f\u672c\u4e4b\u95f4\u90fd\u662f\u5b8c\u5168\u72ec\u7acb\u7684\uff0c\u5b83\u4eec\u90fd\u662f\u4e0d\u540c\u7684\u4e92\u65a5\u9501 \u3002 \u5982\u679c\u628a\u4e00\u4e2a\u4e92\u65a5\u9501\u4f5c\u4e3a\u53c2\u6570\u4ea7\u7ed9\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\u5bf9\u4f20\u5165\u7684\u9501\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u90fd\u4e0d\u4f1a\u5bf9\u5b58\u5728\u4e8e\u8be5\u51fd\u6570\u4e4b\u5916\u7684\u90a3\u4e2a\u539f\u9501\u4ea7\u751f\u4efb\u4f55\u7684\u5f71\u54cd\u3002 \u8bfb\u5199\u9501\u4e0e\u4e92\u65a5\u9501\u7684\u533a\u522b \u8bfb\u5199\u9501\u662f\u8bfb/\u5199\u4e92\u65a5\u9501\u7684\u7b80\u79f0\uff0c\u5728Go\u8bed\u8a00\u4e2d\uff0c\u8bfb\u5199\u9501\u7531 sync.RWMutex \u7c7b\u578b\u7684\u503c\u4ee3\u8868\uff0c\u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u3002 \u8bfb\u5199\u9501\u628a\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u533a\u522b\u5bf9\u5f85\uff0c\u53ef\u4ee5\u5bf9\u8fd9\u4e24\u79cd\u64cd\u4f5c\u65bd\u52a0\u4e0d\u540c\u7684\u4fdd\u62a4\u3002\u76f8\u6bd4\u4e8e\u4e92\u65a5\u9501\uff0c\u8bfb\u5199\u9501\u5b9e\u73b0\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u8bbf\u95ee\u63a7\u5236\u3002\u4e00\u4e2a\u8bfb\u5199\u9501\u4e2d\u5305\u542b\u4e24\u4e2a\u9501\uff1a \u5199\u9501\uff1a sync.RWMutex \u7c7b\u578b\u4e2d\u7684Lock\u65b9\u6cd5\u548cUnlock\u65b9\u6cd5\u5206\u522b\u7528\u4e8e\u5bf9\u5199\u9501\u8fdb\u884c\u9501\u5b9a\u548c\u89e3\u9501 \u8bfb\u9501\uff1a sync.RWMutex \u7c7b\u578b\u4e2d\u7684RLock\u65b9\u6cd5\u548cRUnlock\u65b9\u6cd5\u5206\u522b\u7528\u4e8e\u5bf9\u4e8e\u8bfb\u9501\u8fdb\u884c\u9501\u5b9a\u548c\u89e3\u9501 \u5bf9\u4e8e\u540c\u4e00\u4e2a\u8bfb\u5199\u9501\u6765\u8bf4\uff0c\u6709\u5982\u4e0b\u89c4\u5219\uff1a \u5728 \u5199\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u5199\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u5728 \u5199\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u8bfb\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u5728 \u8bfb\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u5199\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524d\u7684goroutine \u5728 \u8bfb\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u8bfb\u9501 \uff0c\u4e0d\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u6536\u5230\u8bfb\u5199\u9501\u5305\u542b\u7684\u5171\u4eab\u8d44\u6e90\uff1a \u591a\u4e2a\u5199\u64cd\u4f5c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c \u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c \u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c \u901a\u5e38\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\u7684\u64cd\u4f5c\u79f0\u4e3a\u4e92\u65a5\u64cd\u4f5c \u3002 \u5bf9\u4e8e \u5199\u9501 \u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\uff0c\u4f1a\u5524\u9192 \u6240\u6709\u56e0\u8bd5\u56fe\u9501\u5b9a\u8bfb\u9501\u800c\u88ab\u963b\u585e\u7684goroutine \uff0c\u901a\u5e38\u4f1a\u4f7f\u5b83\u4eec\u90fd\u6210\u529f\u5b8c\u6210\u5bf9\u8bfb\u9501\u7684\u9501\u5b9a\u3002 \u5bf9\u4e8e \u8bfb\u9501 \u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\uff0c\u53ea\u4f1a\u5728\u6ca1\u6709\u5176\u4ed6 \u8bfb\u9501 \u9501\u5b9a\u7684\u524d\u63d0\u4e0b\uff0c\u5524\u9192 \u56e0\u8bd5\u56fe\u9501\u5b9a\u5199\u9501\u800c\u88ab\u963b\u585e\u7684goroutine \uff0c\u5e76\u4e14\u6700\u7ec8\u53ea\u4f1a\u6709\u4e00\u4e2a\u88ab\u5524\u9192\u7684goroutine\uff08\u7b49\u5f85\u65f6\u95f4\u6700\u957f\u7684\u90a3\u4e2a\uff09\u6210\u529f\u5b8c\u6210\u5bf9 \u5199\u9501 \u7684\u9501\u5b9a\uff0c\u5176\u4ed6goroutine\u7ee7\u7eed\u7b49\u5f85\u3002 \u8bfb\u5199\u9501\u4e2d\u5bf9\u5199\u64cd\u4f5c\u4e4b\u95f4\u7684\u4e92\u65a5\u662f\u901a\u8fc7\u5185\u6db5\u7684\u4e00\u4e2a\u4e92\u65a5\u9501\u5b9e\u73b0\u7684 \uff0c\u5728Go\u8bed\u8a00\u4e2d\uff0c\u8bfb\u5199\u9501\u662f\u4e92\u65a5\u9501\u7684\u4e00\u79cd\u6269\u5c55\u3002 \u603b\u7ed3 \u4e92\u65a5\u9501\u5e38\u5e38\u88ab\u7528\u6765\u4fdd\u8bc1\u591a\u4e2agoroutine\u5e76\u53d1\u8bbf\u95ee\u540c\u4e00\u4e2a\u5171\u4eab\u8d44\u6e90\u65f6\u7684\u5b8c\u5168\u4e32\u884c\u3002 \u4e0d\u8981\u5fd8\u8bb0\u9501\u5b9a\u6216\u5fd8\u8bb0\u89e3\u9501\uff0c\u8fd9\u4f1a\u5bfc\u81f4goroutine\u7684\u963b\u585e\u751a\u81f3\u6b7b\u9501 \u4e0d\u8981\u4f20\u9012\u4e92\u65a5\u9501\uff0c\u8fd9\u4f1a\u4ea7\u751f\u5b83\u7684\u526f\u672c\uff0c\u4ece\u800c\u4ea7\u751f\u5947\u5f02\u6216\u8005\u5bfc\u81f4\u4e92\u65a5\u5931\u6548 \u8ba9\u6bcf\u4e00\u4e2a\u4e92\u65a5\u9501\u90fd\u53ea\u5305\u542b\u4e00\u4e2a\u4e34\u754c\u533a\uff0c\u6216\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a \u4e0d\u8981\u89e3\u9501\u672a\u9501\u5b9a\u7684\u9501\uff0c\u4f1a\u5f15\u53d1\u4e0d\u53ef\u6062\u590d\u7684panic sync.Cond \u6761\u4ef6\u53d8\u91cf\u4e0e\u4e92\u65a5\u9501 \u6761\u4ef6\u53d8\u91cf\u662f\u53e6\u4e00\u4e2a\u540c\u6b65\u5de5\u5177\uff0c\u5b83\u662f\u57fa\u4e8e\u4e92\u65a5\u9501\u7684\uff0c\u5b83\u4e0d\u662f\u7528\u6765\u5305\u542b\u4e34\u754c\u533a\u548c\u5171\u4eab\u8d44\u6e90 \u7684\uff0c\u800c\u662f\u7528\u4e8e \u534f\u8c03\u60f3\u8981\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u7684\u90a3\u4e9b\u7ebf\u7a0b \u3002\u5f53\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b83\u53ef\u4ee5\u88ab\u7528\u6765\u901a\u77e5\u4e92\u65a5\u9501\u963b\u585e\u7684\u7ebf\u7a0b\u3002 \u6761\u4ef6\u53d8\u91cf\u7684\u521d\u59cb\u5316\u79bb\u4e0d\u5f00\u4e92\u65a5\u9501\uff0c\u5e76\u4e14\u5b83\u7684\u65b9\u6cd5\u6709\u7684\u4e5f\u662f\u57fa\u4e8e\u4e92\u65a5\u9501\u7684 \u3002 \u6761\u4ef6\u53d8\u91cf\u6709\u4e09\u4e2a\u65b9\u6cd5\uff1a \u7b49\u5f85\u901a\u77e5\uff08Wait\uff09\uff1a\u5728\u4e92\u65a5\u9501\u4fdd\u62a4\u4e0b\u8fdb\u884c \u5355\u53d1\u901a\u77e5\uff08signal\uff09\uff1a\u5728\u4e92\u65a5\u9501\u89e3\u9501\u540e\u8fdb\u884c \u5e7f\u64ad\u901a\u77e5\uff08broadcast\uff09\uff1a\u5728\u4e92\u65a5\u9501\u89e3\u9501\u540e\u8fdb\u884c var mailbox uint8 var lock sync.RWMutex // \u8bfb\u5199\u9501 sendCond := sync.NewCond( lock) // \u6761\u4ef6\u53d8\u91cf recvCond := sync.NewCond(lock.RLocker()) // \u6761\u4ef6\u53d8\u91cf // func NewCond(l Locker) *Cond \u8fd4\u56de\u5e26\u6709\u9501\u7684\u6761\u4ef6\u53d8\u91cf\u7684\u6307\u9488\u503c // goroutine 1 lock.Lock() // \u9501\u5b9a\u5199\u9501 for mailbox == 1 { // \u5982\u679c\u6709\u60c5\u62a5\u5c31\u7b49\u5f85 sendCond.Wait() // \u89e3\u9501\u5199\u9501\uff0c\u52a0\u5165\u901a\u77e5\u961f\u5217\uff0c\u963b\u585e\u5f53\u524d\u4ee3\u7801\u884c } mailbox = 1 // \u5982\u679c\u6ca1\u6709\u60c5\u62a5\u5c31\u653e\u5165\u60c5\u62a5\u30021\u8868\u793a\u653e\u5165\u60c5\u62a5 lock.Unlock() // \u89e3\u9501\u5199\u9501 recvCond.Signal() // \u53d1\u8d77\u901a\u77e5\u60c5\u62a5\u5df2\u7ecf\u653e\u597d // goroutine 2 lock.RLock() // \u9501\u5b9a\u8bfb\u9501 for mailbox == 0 { // \u5982\u679c\u6ca1\u6709\u60c5\u62a5\u5c31\u7b49\u5f85 recvCond.Wait() // \u89e3\u9501\u8bfb\u9501\uff0c\u52a0\u5165\u901a\u77e5\u961f\u5217\uff0c\u963b\u585e\u5f53\u524d\u4ee3\u7801\u884c } mailbox = 0 // \u5982\u679c\u6709\u60c5\u62a5\u5c31\u53d6\u51fa\u60c5\u62a5\u30020\u8868\u793a\u53d6\u51fa\u60c5\u62a5 lock.RUnlock() // \u89e3\u9501\u8bfb\u9501 sendCond.Signal() // \u53d1\u8d77\u901a\u77e5\u60c5\u62a5\u5df2\u7ecf\u53d6\u8d70 \u53ea\u8981\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u5c31\u4f1a\u8c03\u7528wait\u65b9\u6cd5\uff0c\u9700\u8981\u53d1\u8d77\u901a\u77e5\u5c31\u8c03\u7528signal\u65b9\u6cd5\u3002\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u5b9e\u73b0\u5355\u5411\u901a\u77e5\uff0c\u53cc\u5411\u901a\u77e5\u9700\u8981\u4e24\u4e2a\u6761\u4ef6\u53d8\u91cf\uff0c\u8fd9\u662f\u6761\u4ef6\u53d8\u91cf\u7684\u57fa\u672c\u4f7f\u7528\u89c4\u5219\u3002 Wait\u65b9\u6cd5 \u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u56db\u4ef6\u4e8b\u60c5\uff1a \u628a\u8c03\u7528\u5b83\u7684goroutine\uff08\u5373\u5f53\u524dgoroutine\uff09\u52a0\u5165\u5230\u5f53\u524d\u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\u961f\u5217\u4e2d \u89e3\u9501\u5f53\u524d\u7684\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u90a3\u4e2a\u4e92\u65a5\u9501\uff08 \u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u5728\u963b\u585e\u5f53\u524dgoroutine\u524d\uff0c\u4f1a\u89e3\u9501\u5b83\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\uff0c\u6240\u4ee5\u5728\u8c03\u7528Wait\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u9501\u5b9a\u4e92\u65a5\u9501\uff0c\u5426\u5219\u8c03\u7528Wait\u65b9\u6cd5\u4f1a\u5f15\u53d1\u4e0d\u53ef\u6062\u590d\u7684painc \u3002\uff09 \u5982\u679cWait\u65b9\u6cd5\u4e0d\u5148\u89e3\u9501\u4e92\u65a5\u9501\uff0c\u90a3\u4e48\u53ea\u4f1a\u6709\u4e24\u79cd\u540e\u679c\uff0c\u4e0d\u662f\u5f53\u524d\u7a0b\u5e8f\u56e0panic\u800c\u5d29\u6e83\uff0c\u5c31\u662f\u76f8\u5173\u7684goroutine\u5168\u9762\u963b\u585e\u3002 \u8ba9\u5f53\u524d\u7684goroutine\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff0c\u7b49\u5230\u901a\u77e5\u5230\u6765\u65f6\u518d\u51b3\u5b9a\u662f\u5426\u5524\u9192\u5b83\uff0c\u6b64\u65f6\uff0c\u8fd9\u4e2agoroutine\u5c31\u4f1a\u963b\u585e\u5728\u8c03\u7528\u8fd9\u4e2aWait\u65b9\u6cd5\u7684\u90a3\u884c\u4ee3\u7801\u4e0a \u5982\u679c\u901a\u77e5\u5230\u6765\u5e76\u4e14\u51b3\u5b9a\u5524\u9192\u8fd9\u4e2agoroutine\uff0c\u90a3\u4e48\u5c31\u5728\u5524\u9192\u5b83\u4e4b\u540e\u91cd\u65b0\u9501\u5b9a\u5f53\u524d\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\uff0c\u81ea\u6b64\u4e4b\u540e\uff0c\u5f53\u524d\u7684goroutine\u5c31\u4f1a\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u4ee3\u7801\u4e86 \u9700\u8981\u4f7f\u7528for\u5faa\u73af\u5305\u88f9Wait\u65b9\u6cd5\u6765\u591a\u6b21\u68c0\u67e5\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\uff0c\u56e0\u4e3a\u5f53\u4e00\u4e2agoroutine\u6536\u5230\u901a\u77e5\u88ab\u5524\u9192\uff0c\u4f46\u5374\u53d1\u73b0\u5171\u4eab\u7ec4\u5458\u7684\u72b6\u6001\u4f9d\u7136\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u90a3\u4e48\u5e94\u8be5\u518d\u6b21\u8c03\u7528\u6761\u4ef6\u53d8\u91cfWait\u65b9\u6cd5\uff0c\u5e76\u7ee7\u7eed\u7b49\u5f85\u4e0b\u4e00\u6b21\u901a\u77e5\u7684\u5230\u6765\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u60c5\u51b5\uff1a \u591a\u4e2agoroutine\u7b49\u5f85\u5171\u4eab\u8d44\u6e90\u7684\u540c\u4e00\u79cd\u72b6\u6001\u3002 \u5171\u4eab\u8d44\u6e90\u6709\u591a\u79cd\u72b6\u6001\uff0c\u5355\u4e00\u7684\u7ed3\u679c\u4e0d\u53ef\u80fd\u6ee1\u8db3\u6240\u4ee5goroutine\u7684\u6761\u4ef6\u3002 \u67d0\u4e9b\u591aCPU\u6838\u5fc3\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u6d2a\uff0c\u6ca1\u6709\u6536\u5230\u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\uff0c\u8c03\u7528\u5176Wair\u65b9\u6cd5\u7684goroutine\u4e5f\u53ef\u80fd\u4f1a\u88ab\u5524\u9192\uff0c\u8fd9\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\u5c42\u9762\u51b3\u5b9a\u7684\uff0c\u5373\u4f7f\u662f\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u63d0\u4f9b\u7684\u6761\u4ef6\u53d8\u91cf\u4e5f\u4f1a\u5982\u6b64\u3002 \u7efc\u4e0a\uff0c\u5728\u5305\u88f9\u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u65f6\uff0c\u603b\u662f\u5e94\u8be5\u4f7f\u7528for\u8bed\u53e5 \uff0c\u56e0\u4e3a\u7b49\u5f85\u901a\u77e5\u800c\u88ab\u963b\u585e\u7684goroutine\u53ef\u80fd\u4f1a\u5728\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u4e0d\u6ee1\u8db3\u5176\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\u88ab\u5524\u9192\u3002 Signal\u65b9\u6cd5\u4e0eBroadcast\u65b9\u6cd5\u7684\u533a\u522b \u5171\u540c\u70b9\uff1a\u90fd\u662f\u88ab\u7528\u6765\u53d1\u9001\u901a\u77e5\u7684 \u4e0d\u540c\u70b9\uff1a \u524d\u8005\u7684\u901a\u77e5\u53ea\u4f1a\u5524\u9192\u4e00\u4e2a\u56e0\u6b64\u800c\u7b49\u5f85\u7684goroutine \u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u603b\u662f\u4f1a\u628a\u5f53\u524dgoroutine\u6dfb\u52a0\u5230\u901a\u77e5\u961f\u5217\u7684\u961f\u5c3e\uff0c\u800csignal\u65b9\u6cd5\u603b\u4f1a\u4ece\u901a\u77e5\u961f\u5217\u7684\u961f\u9996\u5f00\u59cb\uff0c\u67e5\u627e\u53ef\u88ab\u5524\u9192\u7684goroutine\u3002\u56e0\u6b64\u4f1a\u5524\u9192\u6700\u65e9\u7b49\u5f85\u7684\u90a3\u4e00\u4e2a\u3002 \u540e\u8005\u7684\u901a\u77e5\u4f1a\u5524\u9192\u6240\u6709\u4e3a\u6b64\u7b49\u5f85\u7684goroutine \u8fd9\u4e24\u4e2a\u65b9\u6cd5\u7684\u884c\u4e3a\u51b3\u5b9a\u4e86\u5b83\u4eec\u7684\u4f7f\u7528\u573a\u666f\u3002 \u5982\u679c\u786e\u5b9a\u53ea\u6709\u4e00\u4e2agoroutine\u5728\u7b49\u5f85\uff0c\u6216\u8005\u53ea\u8bb8\u5524\u9192\u4efb\u610f\u4e00\u4e2agoroutine\u5c31\u53ef\u4ee5\u6ee1\u8db3\u8981\u6c42\uff0c\u90a3\u4e48\u4f7f\u7528Signal\u65b9\u6cd5\u3002 \u5426\u5219\uff0c\u4f7f\u7528Broadcast\u65b9\u6cd5\u603b\u6bcf\u6b21\uff0c\u53ea\u8981\u8bbe\u7f6e\u597d\u5404\u4e2agoroutine\u6240\u671f\u671b\u7684\u5171\u4eab\u8d44\u6e90\u72b6\u6001\u5373\u53ef\u3002 \u4e0eWait\u65b9\u6cd5\u4e0d\u540c\uff0cSignal\u65b9\u6cd5\u548cBroadcast\u65b9\u6cd5\u5e76\u4e0d\u9700\u8981\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\u8fdb\u884c \u3002\u6700\u597d\u5728\u89e3\u9501\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\u4e4b\u540e\u5728\u8c03\u7528\u5b83\u4eec\u3002 \u8fd9\u66f4\u6709\u5229\u4e8e\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387 \u3002 \u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\u5177\u6709\u5373\u65f6\u6027\uff0c\u5373\u5728\u53d1\u9001\u901a\u77e5\u7684\u65f6\u5019\u6ca1\u6709goroutine\u4e3a\u6b64\u7b49\u5f85\uff0c\u90a3\u4e48\u8be5\u901a\u77e5\u5c31\u4f1a\u88ab\u76f4\u63a5\u4e22\u5f03\u3002\u5728\u8fd9\u4e4b\u540e\u624d\u5f00\u59cb\u7b49\u5f85\u7684goroutine\u53ea\u53ef\u80fd\u88ab\u540e\u9762\u7684\u901a\u77e5\u5524\u9192\u3002 \u901a\u8fc7\u5bf9\u4e92\u65a5\u9501\u7684\u5408\u7406\u4f7f\u7528\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2agoroutine\u5728\u6267\u884c\u4e34\u754c\u533a\u4e2d\u7684\u4ee3\u7801\u65f6\uff0c\u4e0d\u88ab\u5176\u4ed6\u7684goroutine\u6253\u6270\u3002\u4e0d\u8fc7\uff0c\u867d\u7136\u4e0d\u4f1a\u88ab\u6253\u6270\uff0c\u4f46\u662f\u5b83\u4ecd\u7136\u53ef\u80fd\u4f1a\u88ab\u7ec8\u7aef\uff08interruption\uff09 \u3002 sync.WaitGroup \u548c sync.Once \u4f7f\u7528\u901a\u9053\u8fdb\u884c\u591agoroutine\u534f\u4f5c\uff1a\u58f0\u660e\u4e00\u4e2a\u901a\u9053\uff0c\u4f7f\u5b83\u7684\u5bb9\u91cf\u4e0e\u624b\u52a8\u542f\u52a8\u7684goroutine\u7684\u6570\u91cf\u76f8\u540c\uff0c\u4e4b\u540e\u518d\u5229\u7528\u8fd9\u4e2a\u901a\u9053\uff0c\u8ba9\u4e3bgoroutine\u7b49\u5f85\u5176\u4ed6goroutine\u7684\u8fd0\u884c\u7ed3\u675f\u3002 func coordinateWithChan() { sign := make(chan struct{}, 2) num := int32(0) fmt.Printf( The number: %d [with chan struct{}]\\n , num) max := int32(10) go addNum( num, 1, max, func() { sign - struct{}{} }) go addNum( num, 2, max, func() { sign - struct{}{} }) -sign -sign } \u4ee5\u4e0a\u64cd\u4f5c\uff0c\u7565\u663e\u4e11\u964b\u3002 \u4f7f\u7528sync\u5305\u7684WaitGroup\u7c7b\u578b\uff0c\u5b83\u6bd4\u901a\u9053\u66f4\u52a0\u9002\u5408\u8fd9\u79cd\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\u3002 sync.WaitGroup \u5f00\u7bb1\u5373\u7528\uff0c\u5e76\u53d1\u5b89\u5168\uff0c\u540c\u6837\u7684\u5b83\u4e00\u65e6\u771f\u6b63\u88ab\u4f7f\u7528\uff0c\u5c31\u4e0d\u80fd\u518d\u88ab\u590d\u5236\u3002 WaitGroup\u6709\u4e09\u4e2a\u6307\u9488\u65b9\u6cd5\uff1a Add\uff1a\u53ef\u4ee5\u60f3\u8c61\u5728\u8be5\u7c7b\u578b\u4e2d\u6709\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u53ef\u4ee5\u8c03\u7528\u8be5\u503c\u7c7b\u578b\u7684Add\u65b9\u6cd5\u6765\u589e\u52a0\u6216\u8005\u51cf\u5c11\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u3002\u4e00\u822c\u7528\u6765\u8bb0\u5f55\u7b49\u5f85\u7684goroutine\u7684\u6570\u91cf\u3002 Done\uff1a\u5bf9\u8ba1\u6570\u5668\u4e2d\u7684\u503c\u8fdb\u884c\u51cf\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5728\u9700\u8981\u7b49\u5f85\u7684goroutine\u4e2d\uff0c\u901a\u8fc7defer\u8bed\u53e5\u8c03\u7528\u5b83\u3002 Wait\uff1a\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u76f4\u5230\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u8ba1\u6570\u5668\u5f52\u96f6\u3002\u5982\u679c\u5728\u8be5\u65b9\u6cd5\u8c03\u7528\u7684\u65f6\u5019\uff0c\u8ba1\u6570\u5668\u7684\u503c\u5df2\u7ecf\u662f0\uff0c\u90a3\u4e48\u5c31\u4e0d\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u5c06\u4e0a\u9762\u4ee3\u7801\u4fee\u6539\u4e3aWaitGroup\u7248\u672c\uff1a func coordinateWithWaitGroup() { var wg sync.WaitGroup wg.Add(2) num := int32(0) fmt.Printf( The number: %d [with sync.WaitGroup]\\n , num) max := int32(10) go addNum( num, 3, max, wg.Done) go addNum( num, 4, max, wg.Done) wg.Wait() } \u6ce8\u610f\u70b9 sync.WaitGroup \u7c7b\u578b\u503c\u4e2d\u8ba1\u6570\u5668\u7684\u503c \u4e0d\u80fd\u5c0f\u4e8e 0\u3002\u5982\u679c\u5c0f\u4e8e0\uff0c\u4f1a\u5f15\u53d1\u4e00\u4e2apanic\u3002\u4e0d\u9002\u5f53\u7684\u8c03\u7528Done\u65b9\u6cd5\u548cAdd\u65b9\u6cd5\u90fd\u4f1a\u5f15\u8d77\u8fd9\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u5728Add\u65b9\u6cd5\u4e2d\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a\u8d1f\u6570\u3002 \u5982\u679c\u540c\u65f6\u8c03\u7528Add\u65b9\u6cd5\u548cWait\u65b9\u6cd5\uff0c\u5047\u8bbe\u5728\u4e24\u4e2agoroutine\u4e2d\uff0c\u5206\u522b\u8c03\u7528\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c \u90a3\u4e48\u5c31\u53ef\u80fd\u4f1a\u8ba9\u8fd9\u4e2aAdd\u65b9\u6cd5\u629b\u51fapanic \u3002\u8fd9\u79cd\u60c5\u51b5\u4e0d\u5bb9\u6613\u590d\u73b0\uff0c\u867d\u7136WaitGroup\u503c\u672c\u8eab\u5e76\u4e0d\u9700\u8981\u521d\u59cb\u5316\uff0c\u4f46\u662f\u5c3d\u65e9\u589e\u52a0\u5176\u8ba1\u6570\u5668\u7684\u503c\uff0c\u662f\u975e\u5e38\u6709\u5fc5\u8981\u7684\u3002 WaitGroup\u503c\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u4f46\u662f\u9700\u8981\u4fdd\u8bc1\u5176\u8ba1\u6570\u5468\u671f\u7684\u5b8c\u6574\u6027\u3002\u5728WaitGroup\u503c\u7684\u751f\u547d\u5468\u671f\u4e2d\uff0c\u5b83\u53ef\u4ee5\u7ecf\u5386\u4efb\u610f\u591a\u4e2a\u8ba1\u6570\u5468\u671f\u3002 \u4f46\u662f\u53ea\u6709\u5728\u5b83\u8d70\u5b8c\u5f53\u524d\u7684\u8ba1\u6570\u5468\u671f\u4e4b\u540e\uff0c\u624d\u80fd\u591f\u5f00\u59cb\u4e0b\u4e00\u4e2a\u8ba1\u6570\u5468\u671f \u3002 \u8ba1\u6570\u5468\u671f\uff1aWaitGroup\u503c\u4e2d\u7684\u8ba1\u6570\u5668\u503c\u67090\u53d8\u4e3a\u67d0\u4e2a\u6b63\u6574\u6570\uff0c\u7136\u540e\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u53d8\u5316\uff0c\u6700\u7ec8\u7531\u67d0\u4e2a\u6b63\u6574\u6570\u53c8\u53d8\u56de0\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u67d0\u4e2aWaitGroup\u503c\u7684Wait\u65b9\u6cd5\u5728\u67d0\u4e2a\u8ba1\u6570\u5468\u671f\u4e2d\u88ab\u8c03\u7528\uff0c\u4f1a\u7acb\u5373\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u76f4\u5230\u8fd9\u4e2a\u8ba1\u6570\u5468\u671f\u5b8c\u6210\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8be5\u503c\u7684\u4e0b\u4e00\u4e2a\u8ba1\u6570\u5468\u671f\u5fc5\u987b\u7b49\u5230Wait\u65b9\u6cd5\u6267\u884c\u7ed3\u675f\u4e4b\u540e\uff0c\u624d\u80fd\u591f\u5f00\u59cb \u3002 \u5982\u679c\u5728\u4e00\u4e2a\u6b64\u7c7b\u503c\u7684Wait\u65b9\u6cd5\u88ab\u6267\u884c\u671f\u95f4\uff0c\u8de8\u8d8a\u4e86\u4e24\u4e2a\u8ba1\u6570\u5468\u671f\uff0c \u4f1a\u5f15\u53d1\u4e00\u4e2apanic \u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5728\u5f53\u524dgoroutine\u56e0\u8c03\u7528WaitGroup\u503c\u7684Wait\u65b9\u6cd5\uff0c\u800c\u88ab\u963b\u585e\u7684\u65f6\u5019 \u53e6\u4e00\u4e2agoroutine\u8c03\u7528\u8be5\u503c\u7684Done\u65b9\u6cd5\uff0c\u5e76\u4f7f\u8ba1\u6570\u5668\u7684\u503c\u53d8\u4e3a0 \u8fd9\u4f1a\u5524\u9192\u5f53\u524d\u7684goroutine\uff0c\u5e76\u4f7f\u5b83\u8bd5\u56fe\u7ee7\u7eed\u6267\u884cWait\u65b9\u6cd5\u4e2d\u5176\u4f59\u7684\u4ee3\u7801 \u8fd9\u65f6\u53c8\u6709\u4e00\u4e2agoroutine\u8c03\u7528\u4e86\u5b83\u7684Add\u65b9\u6cd5\uff0c\u5e76\u8ba9\u8ba1\u6570\u5668\u7684\u503c\u53c8\u4ece0\u53d8\u6210\u4e86\u67d0\u4e2a\u6b63\u6574\u6570 \u6b64\u65f6\uff0c\u8fd9\u91cc\u7684Wait\u65b9\u6cd5\u5c31\u4f1a\u7acb\u5373\u629b\u51fa\u4e00\u4e2apanic WaitGroup\u4f7f\u7528\u7981\u5fcc \uff1a\u4e0d\u8981\u628a\u589e\u52a0\u8ba1\u6570\u5668\u503c\u7684\u64cd\u4f5c\u548c\u8c03\u7528Wait\u65b9\u6cd5\u7684\u4ee3\u7801\uff0c\u653e\u5728\u4e0d\u540c\u7684goroutine\u4e2d\u6267\u884c\u3002 \u675c\u7edd\u540c\u4e00\u4e2aWaitGroup\u503c\u7684\u4e24\u79cd\u64cd\u4f5c\u7684\u5e76\u53d1\u6267\u884c \u3002 sync.Once \u7c7b\u578b\u503c\u7684Do\u65b9\u6cd5\u5982\u4f55\u4fdd\u8bc1\u53ea\u6267\u884c\u53c2\u6570\u51fd\u6570\u4e00\u6b21 \u4e0e sync.WaitGroup \u7c7b\u578b\u4e00\u6837\uff0c sync.Once \u7c7b\u578b\u4e5f\u5c5e\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u540c\u6837\u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u548c\u5e76\u53d1\u5b89\u5168\u7684\u3002\u7531\u4e8e\u8fd9\u4e2a\u7c7b\u578b\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u6240\u4ee5\u590d\u5236\u8be5\u7c7b\u578b\u7684\u503c\u4e5f\u4f1a\u5bfc\u81f4\u529f\u80fd\u7684\u5931\u6548\u3002 Once\u7c7b\u578b\u7684Do\u65b9\u6cd5\u53ea\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662ffunc()\uff0c\u5373\uff1a\u65e0\u53c2\u6570\u58f0\u660e\u548c\u7ed3\u679c\u58f0\u660e\u7684\u51fd\u6570\u3002\u8be5\u65b9\u6cd5\u7684\u529f\u80fd\u5e76\u4e0d\u662f\u5bf9\u6bcf\u4e00\u79cd\u53c2\u6570\u51fd\u6570\u90fd\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u800c\u662f\u53ea\u6267\u884c\u9996\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u90a3\u4e2a\u51fd\u6570\uff0c\u5e76\u4e14\u4e4b\u540e\u4e0d\u4f1a\u518d\u6267\u884c\u4efb\u4f55\u53c2\u6570\u51fd\u6570\u3002\u5982\u679c\u6709\u591a\u4e2a\u53ea\u9700\u6267\u884c\u4e00\u6b21\u7684\u51fd\u6570\uff0c\u4e3a\u5b83\u4eec\u6bcf\u4e2a\u90fd\u5206\u914d\u4e00\u4e2a sync.Once \u7c7b\u578b\u7684\u503c\u3002 Once\u7c7b\u578b\u4e2d\u8fd8\u6709\u4e00\u4e2a\u53ebdone\u7684unit32\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u8bb0\u5f55\u5176\u6240\u5c5e\u503c\u7684Do\u65b9\u6cd5\u88ab\u8c03\u7528\u7684\u6b21\u6570\uff0c\u8be5\u503c\u53ea\u80fd\u662f0\u6216\u80051\u3002\u4e00\u65e6Do\u65b9\u6cd5\u7684\u9996\u6b21\u8c03\u7528\u5b8c\u6210\uff0c\u5b83\u7684\u503c\u5c31\u4f1a\u4ece0\u53d8\u62101\u3002 done\u5b57\u6bb5\u867d\u7136\u53ea\u67090\u6216\u80051\uff0c\u4f46\u662f\u4f7f\u7528\u4e86\u56db\u5b57\u8282\u7684uint32\u7c7b\u578b\uff1a \u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u7684\u64cd\u4f5c\u5fc5\u987b\u662f\u539f\u5b50\u7684\uff0cDo\u65b9\u6cd5\u5728\u4e00\u5f00\u59cb\u5c31\u4f1a\u901a\u8fc7\u8c03\u7528 atomic.LoadUint32 \u51fd\u6570\u6765\u83b7\u53d6\u8be5\u5b57\u6bb5\u7684\u503c\uff0c\u5e76\u4e14\u4e00\u70b9\u53d1\u73b0\u8be5\u503c\u4e3a1\uff0c\u5c31\u76f4\u63a5\u8fd4\u56de\u3002 \u521d\u6b65\u4fdd\u8bc1\u4e86Do\u65b9\u6cd5\uff0c\u53ea\u4f1a\u6267\u884c\u9996\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u51fd\u6570 \u3002 \u5982\u679c\u4e24\u4e2agoroutine\u90fd\u8c03\u7528\u4e86\u540c\u4e00\u4e2a\u65b0\u7684Once\u7684Do\u65b9\u6cd5\uff0c\u51e0\u4e4e\u540c\u65f6\u6267\u884c\u6761\u4ef6\u5224\u65ad\u4ee3\u7801\uff0c\u90a3\u4e48\u4f1a\u56e0\u4e3a\u5224\u65ad\u7ed3\u679c\u4e3afalse\u800c\u7ee7\u7eed\u6267\u884cDo\u65b9\u6cd5\u4e2d\u5269\u4f59\u7684\u4ee3\u7801\u3002 \u6240\u4ee5\u5728\u6761\u4ef6\u5224\u65ad\u4e4b\u540e\uff0cDo\u65b9\u6cd5\u4f1a\u7acb\u5373\u6240\u52a8\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u90a3\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5m\uff0c\u7136\u540e\uff0c\u5b83\u4f1a\u5728\u4e34\u754c\u533a\u4e2d\u518d\u6b21\u68c0\u67e5done\u5b57\u6bb5\u7684\u503c\uff0c\u5e76\u4e14\u4ec5\u5728\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u624d\u4f1a\u53bb\u8c03\u7528\u53c2\u6570\u51fd\u6570\uff0c\u4ee5\u53ca\u7528\u539f\u5b50\u64cd\u4f5c\u628adone\u7684\u503c\u53d8\u4e3a1\u3002 Do\u65b9\u6cd5\u5728\u529f\u80fd\u65b9\u9762\u7684\u7279\u70b9 Do\u65b9\u6cd5\u53ea\u4f1a\u5728\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u4e4b\u540e\u628adone\u5b57\u6bb5\u7684\u503c\u53d8\u4e3a1\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u9700\u8981\u5f88\u957f\u65f6\u95f4\u6216\u8005\u6839\u672c\u5c31\u4e0d\u4f1a\u7ed3\u675f\uff08\u6bd4\u5982\u6267\u884c\u4e00\u4e9b\u5b88\u62a4\u4efb\u52a1\uff09\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u76f8\u5173goroutine\u7684\u540c\u65f6\u963b\u585e\u3002 Do\u65b9\u6cd5\u5728\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u540e\uff0c\u5bf9done\u5b57\u6bb5\u7684\u590d\u5236\u7528\u7684\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u5e76\u4e14\uff0c\u8fd9\u4e00\u64cd\u4f5c\u662f\u88ab\u6302\u5728defer\u8bed\u53e5\u4e2d\u7684\uff0c\u56e0\u6b64\uff0c\u4e0d\u8bba\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u4f1a\u4ee5\u600e\u6837\u7684\u65b9\u5f0f\u7ed3\u675f\uff0cdone\u5b57\u6bb5\u7684\u503c\u90fd\u4f1a\u53d8\u4e3a1\u3002\u5373\u4f7f\u8fd9\u4e2a\u53c2\u6570\u51fd\u6570\u6ca1\u6709\u6267\u884c\u6210\u529f\uff08\u5f15\u53d1\u4e86\u4e00\u4e2apanic\uff09\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u4f7f\u7528\u540c\u4e00\u4e2aonce\u503c\u91cd\u65b0\u6267\u884c\u5b83\u3002\u5982\u679c\u9700\u8981\u4e3a\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u8bbe\u5b9a\u91cd\u8bd5\u673a\u5236\uff0c\u8981\u8003\u8651Once\u503c\u7684\u9002\u65f6\u66ff\u6362\u95ee\u9898\u3002 \u5c0f\u7ed3 sync\u5305\u4e2d\u7684WaitGroup\u7c7b\u578b\u548cOnce\u7c7b\u578b\u90fd\u662f\u975e\u5e38\u6613\u7528\u7684\u540c\u6b65\u5de5\u5177\u3002\u5b83\u4eec\u90fd\u662f\u5f00\u7bb1\u5373\u7528\u548c\u5e76\u53d1\u5b89\u5168\u7684\u3002 \u5229\u7528WaitGroup\u503c\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u5b9e\u73b0\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\uff0c\u5373\uff1a\u4e00\u4e2a\u5206\u53d1\u5b50\u4efb\u52a1\u7684goroutine\u548c\u591a\u4e2a\u6267\u884c\u5b50\u4efb\u52a1\u7684goroutine\uff0c\u5171\u540c\u6765\u5b8c\u6210\u4e00\u4e2a\u8f83\u5927\u7684\u4efb\u52a1\u3002 \u4f7f\u7528WaitGroup\u503c\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u5343\u4e07\u4e0d\u80fd\u8ba9\u5176\u4e2d\u7684\u8ba1\u6570\u5668\u7684\u503c\u5c0f\u4e8e0\uff0c\u5426\u5219\u5c31\u4f1a\u5f15\u53d1panic \u3002\u6211\u4eec\u6700\u597d\u7528\u201c \u5148\u7edf\u4e00Add\uff0c\u518d\u5e76\u53d1Done\uff0c\u6700\u540eWait \u201d\u8fd9\u79cd\u6807\u51c6\u65b9\u5f0f\uff0c\u6765\u4f7f\u7528WaitGroup\u503c\u3002\u5c24\u5176\u4e0d\u8981\u5728\u8c03\u7528Wait\u65b9\u6cd5\u540c\u65f6\uff0c\u5e76\u53d1\u5730\u901a\u8fc7\u8c03\u7528Add\u65b9\u6cd5\u53bb\u589e\u52a0\u5176\u8ba1\u6570\u5668\u7684\u503c\uff0c\u56e0\u4e3a\u8fd9\u4e5f\u6709\u53ef\u80fd\u5f15\u53d1panic\u3002 Once\u503c\u7684\u4f7f\u7528\u6bd4WaitGroup\u503c\u66f4\u7b80\u5355\uff0c\u53ea\u6709\u4e00\u4e2aDo\u65b9\u6cd5\uff0c\u540c\u4e00\u4e2aOnce\u503c\u7684Do\u65b9\u6cd5\u6c38\u8fdc\u53ea\u4f1a\u6267\u884c\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u53c2\u6570\u51fd\u6570\uff0c\u4e0d\u8bba\u8fd9\u4e2a\u51fd\u6570\u7684\u6267\u884c\u4f1a\u4ee5\u600e\u4e48\u6837\u7684\u65b9\u5f0f\u7ed3\u675f\u3002 \u53ea\u8981\u4f20\u5165\u67d0\u4e2aDo\u65b9\u6cd5\u7684\u53c2\u6570\u51fd\u6570\u6ca1\u6709\u7ed3\u675f\u6267\u884c\uff0c\u4efb\u4f55\u53ea\u4f1a\u8c03\u7528\u8be5\u65b9\u6cd5\u7684goroutine\u5c31\u4f1a\u88ab\u963b\u585e\u3002\u53ea\u6709\u5728\u8fd9\u4e2a\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u4e00\u4f1a\uff0c\u90a3\u4e9bgoroutine\u624d\u4f1a\u9010\u4e00\u88ab\u5524\u9192\u3002 Once\u7c7b\u578b\u4f7f\u7528\u4e92\u65a5\u9501\u548c\u539f\u5b50\u64cd\u4f5c\u5b9e\u73b0\u4e86\u529f\u80fd\uff0c\u800cWaitGroup\u7c7b\u578b\u4e2d\u53ea\u7528\u5230\u4e86\u539f\u5b50\u64cd\u4f5c\u3002\u5b83\u4eec\u90fd\u662f\u66f4\u9ad8\u7ea7\u7684\u540c\u6b65\u5de5\u5177\uff0c\u57fa\u4e8e\u57fa\u672c\u7684\u901a\u7528\u5de5\u5177\uff0c\u5b9e\u73b0\u4e86\u67d0\u4e00\u79cd\u7279\u5b9a\u7684\u529f\u80fd\u3002 sync\u5305\u4e2d\u7684\u5176\u4ed6\u9ad8\u7ea7\u540c\u6b65\u5de5\u5177\uff0c\u90fd\u662f\u8fd9\u6837\u5b9e\u73b0\u7684 \u3002 sync.Pool sync.Pool \u7c7b\u578b\uff08\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u5b83\u7684\u503c\u88ab\u771f\u6b63\u4f7f\u7528\u4e4b\u540e\uff0c\u5c31\u4e0d\u5e94\u518d\u88ab\u590d\u5236\u4e86\uff09\u88ab\u6210\u4e3a\u4e34\u65f6\u5bf9\u8c61\u5b58\u50a8\u6c60\uff0c\u5b83\u7684\u503c\u53ef\u4ee5\u88ab\u7528\u6765\u5b58\u50a8\u4e34\u65f6\u7684\u5bf9\u8c61\u3002 \u4e34\u65f6\u5bf9\u8c61\u7684\u610f\u601d\u662f\uff1a \u4e0d\u9700\u8981\u6301\u4e45\u4f7f\u7528\u7684\u67d0\u4e00\u7c7b\u503c\uff0c\u8fd9\u7c7b\u503c\u5bf9\u4e8e\u7a0b\u5e8f\u6765\u8bf4\u53ef\u6709\u53ef\u65e0\uff0c\u5982\u679c\u6709\u7684\u8bdd\u4f1a\u660e\u663e\u66f4\u597d \u5b83\u7684\u521b\u5efa\u548c\u9500\u6bc1\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u53d1\u751f\uff0c\u5e76\u4e14\u5b8c\u5168\u4e0d\u4f1a\u5f71\u54cd\u5230\u7a0b\u5e8f\u7684\u529f\u80fd \u5b83\u4eec\u65e0\u9700\u88ab\u533a\u5206\uff0c\u5176\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u503c\u90fd\u53ef\u4ee5\u66ff\u4ee3\u53e6\u4e00\u4e2a \u5982\u679c\u67d0\u7c7b\u4e4b\u5b8c\u5168\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u5c31\u53ef\u4ee5\u628a\u5b83\u4eec\u5b58\u50a8\u5230\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u3002 \u53ef\u4ee5\u628a\u4e34\u65f6\u5bf9\u8c61\u6c60\u5f53\u4f5c\u9488\u5bf9\u67d0\u79cd\u6570\u636e\u7684\u7f13\u5b58\u6765\u7528 \uff0c\u8fd9\u662f\u4e34\u65f6\u5bf9\u8c61\u6c60\u6700\u4e3b\u8981\u7684\u7528\u9014\u3002 sync.Pool \u7c7b\u578b\u53ea\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a func (p *Pool) Put(x interface{}) func (p *Pool) Get() interface{} Put\uff1a\u7528\u4e8e\u5728\u5f53\u524d\u7684\u6c60\u4e2d\u5b58\u653e\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b83\u63a5\u6536\u4e00\u4e2ainterface{}\u7c7b\u578b\u7684\u53c2\u6570 Get\uff1a\u7528\u4e8e\u4ece\u5f53\u524d\u7684\u6c60\u4e2d\u83b7\u53d6\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2ainterface{}\u7c7b\u578b\u7684\u503c\uff1b Get\u53ef\u80fd\u4f1a\u4ece\u5f53\u524d\u6c60\u4e2d\u5220\u9664\u6389\u4efb\u4f55\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u628a\u8fd9\u4e2a\u503c\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002\u5982\u679c\u6b64\u65f6\u6c60\u4e2d\u6ca1\u6709\u4efb\u4f55\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u4f1a\u4f7f\u7528\u5f53\u524d\u6c60\u7684New\u5b57\u6bb5\u521b\u5efa\u4e00\u4e2a\u503c\uff0c\u5e76\u76f4\u63a5\u5c06\u5176\u8fd4\u56de\u3002 sync.Pool \u7c7b\u578b\u7684New\u5b57\u6bb5\u4ee3\u8868\u8fd9\u521b\u5efa\u4e34\u65f6\u5bf9\u8c61\u7684\u51fd\u6570\uff0c\u5b83\u7684\u7c7b\u578b\u662f\u6ca1\u6709\u53c2\u6570\u4f46\u6709\u552f\u4e00\u7ed3\u679c\u7684\u51fd\u6570\u7c7b\u578b\uff1a type Pool struct { // \u8fd9\u4e2a\u51fd\u6570\u662fGet\u65b9\u6cd5\u6700\u540e\u7684\u4e34\u65f6\u5bf9\u8c61\u83b7\u53d6\u624b\u6bb5 // \u8be5\u51fd\u6570\u7684\u7ed3\u679c\u503c\u5e76\u4e0d\u4f1a\u5b58\u5165\u5f53\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\u4e2d // \u800c\u662f\u76f4\u63a5\u8fd4\u56de\u7ed9Get\u65b9\u6cd5\u7684\u8c03\u7528\u65b9 New func() interface{} // contains filtered or unexported fields } \u8fd9\u91ccNew\u5b57\u6bb5\u7684\u5b9e\u9645\u503c\u9700\u8981\u6211\u4eec\u5728\u521d\u59cb\u5316\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u65f6\u5019\u7ed9\u5b9a\u3002\u5426\u5219\uff0c\u5728\u8c03\u7528\u5b83\u7684Get\u65b9\u6cd5\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u5f97\u5230nil\u3002 sync.Pool \u7c7b\u578b\u5e76\u975e\u5f00\u7bb1\u5373\u7528\uff0c\u8fd9\u4e2a\u7c7b\u578b\u53ea\u6709\u8fd9\u4e00\u4e2a\u516c\u5f00\u5b57\u6bb5\u3002 \u4f8b\u5b50 \u6807\u51c6\u5e93fmt\u4e2d\u4f7f\u7528 sync.Pool \u7c7b\u578b\uff0c\u8fd9\u4e2a\u5305\u4f1a\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u7f13\u5b58\u67d0\u7c7b\u4e34\u65f6\u5bf9\u8c61\u7684 sync.Pool \u7c7b\u578b\u503c\uff0c\u5e76\u5c06\u8fd9\u4e2a\u503c\u8d4b\u7ed9ppFree\u53d8\u91cf\uff0c\u8fd9\u4e2a\u4e34\u65f6\u5bf9\u8c61\u53ef\u4ee5\u7528\u4e8e\u8bc6\u522b\u3001\u683c\u5f0f\u5316\u548c\u6682\u5b58\u9700\u8981\u6253\u5370\u7684\u5185\u5bb9\uff1a var ppFree = sync.Pool{ New: func() interface{} { return new(pp) }, } // ppFree\u7684New\u5b57\u6bb5\u5728\u88ab\u8c03\u7528\u7684\u65f6\u5019\uff0c\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7684pp\u7c7b\u578b\u503c\u7684\u6307\u9488\uff08\u5373\u4e34\u65f6\u5bf9\u8c61\uff09 // \u8fd9\u4fdd\u8bc1\u4e86ppFree\u7684Get\u65b9\u6cd5\u603b\u80fd\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u9700\u8981\u6253\u5370\u5185\u5bb9\u7684\u503c // pp\u7c7b\u578b\u662ffmt\u5305\u4e2d\u7684\u79c1\u6709\u7c7b\u578b\uff0c\u5b83\u7684\u6bcf\u4e00\u4e2a\u503c\u5728\u8fd9\u91cc\u90fd\u662f\u72ec\u7acb\u3001\u5e73\u7b49\u3001\u53ef\u91cd\u7528\u7684 \u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u65e2\u4e92\u4e0d\u5e72\u6270\uff0c\u53c8\u4e0d\u4f1a\u53d7\u5230\u5916\u90e8\u72b6\u6001\u7684\u5f71\u54cd\u3002\u5b83\u4eec\u51e0\u4e4e\u53ea\u9488\u5bf9\u67d0\u4e2a\u9700\u8981\u6253\u5370\u5185\u5bb9\u7684\u7f13\u51b2\u533a\u3002\u7531\u4e8efmt\u5305\u4e2d\u7684\u4ee3\u7801\u5728\u771f\u6b63\u4f7f\u7528\u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u4e4b\u524d\uff0c\u603b\u662f\u4f1a\u5bf9\u5176\u8fdb\u884c\u91cd\u7f6e\uff0c\u6240\u4ee5\u5b83\u4eec\u5e76\u4e0d\u5728\u610f\u53d6\u5230\u54ea\u4e2a\u4e34\u65f6\u5bf9\u8c61\u3002 \u8fd9\u5c31\u662f\u4e34\u65f6\u5bf9\u8c61\u7684\u5e73\u7b49\u6027\u7684\u5177\u4f53\u4f53\u73b0 \u3002 \u8fd9\u4e9b\u4ee3\u7801\u5728\u4f7f\u7528\u5b8c\u4e34\u65f6\u5bf9\u8c61\u540e\uff0c\u90fd\u4f1a\u5148\u62b9\u6389\u5176\u4e2d\u5df2\u7f13\u51b2\u7684\u5185\u5bb9\uff0c\u7136\u540e\u518d\u628a\u5b83\u5b58\u653e\u5230ppFree\u4e2d\u3002\u8fd9\u6837\u5c31\u4e3a\u91cd\u7528\u8fd9\u7c7b\u4e34\u65f6\u5bf9\u8c61\u505a\u597d\u4e86\u51c6\u5907\u3002 fmt.Println \u3001 fmt.Printf \u7b49\u6253\u5370\u51fd\u6570\u90fd\u662f\u8fd9\u6837\u4f7f\u7528ppFree\uff0c\u4ee5\u53ca\u5176\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61\u3002\u56e0\u6b64\u7a0b\u5e8f\u540c\u65f6\u6267\u884c\u5f88\u591a\u6253\u5370\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cppFree\u53ef\u4ee5\u53ca\u65f6\u5730\u628a\u5b83\u7f13\u5b58\u7684\u4e34\u65f6\u5bf9\u8c61\u63d0\u4f9b\u7ed9\u5b83\u4eec\uff0c\u4ee5\u52a0\u5feb\u6267\u884c\u7684\u901f\u5ea6\u3002\u5f53\u7a0b\u5e8f\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u4e0d\u518d\u6267\u884c\u6253\u5370\u51fd\u6570\uff0cppFree\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61\u6709\u80fd\u591f\u88ab\u53ca\u65f6\u5730\u6e05\u7406\uff08\u5783\u573e\u56de\u6536\u671f\uff0c\u5728\u6bcf\u6b21\u5f00\u59cb\u6267\u884c\u94b1\uff0c\u5bf9\u6240\u6709\u521b\u5efa\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u503c\u8fdb\u884c\u5168\u9762\u5730\u6e05\u9664\uff09\uff0c\u4ee5\u8282\u7701\u5185\u5b58\u7a7a\u95f4\u3002\u5728\u8fd9\u4e2a\u7ef4\u5ea6\u4e0a\uff0c\u4e34\u65f6\u5bf9\u8c61\u6c60\u53ef\u4ee5\u5e2e\u52a9\u7a0b\u5e8f\u5b9e\u73b0\u53ef\u4f38\u7f29\u6027\u3002 \u4e34\u65f6\u5bf9\u8c61\u7684\u9500\u6bc1 sync\u5305\u5728\u88ab\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u4f1a\u5411Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u6ce8\u518c\u4e00\u4e2a\u51fd\u6570\uff08 \u6c60\u6e05\u7406\u51fd\u6570 \uff09\uff0c\u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u5c31\u662f\u6e05\u9664\u6240\u6709\u5df2\u521b\u5efa\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u503c\uff0c\u8fd9\u6837Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u5728\u6267\u884c\u5783\u573e\u56de\u6536\u4e4b\u524d\u4f1a\u5148\u6267\u884c\u6c60\u6e05\u7406\u51fd\u6570\u3002 sync\u5305\u4e2d\u6709\u4e00\u4e2a\u5305\u7ea7\u79c1\u6709\u7684\u5168\u5c40\u53d8\u91cf\uff08 \u6c60\u6c47\u603b\u5217\u8868 \uff09\uff0c\u8fd9\u4e2a\u53d8\u91cf\u4ee3\u8868\u4e86\u5f53\u524d\u7684\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7684\u6240\u6709\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u6c47\u603b\uff0c\u5b83\u662f\u5143\u7d20\u7c7b\u578b\u4e3a *sync.Pool \u7684\u5207\u7247\u3002 \u5728\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u65b9\u6cd5\u548cGet\u65b9\u6cd5\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6c60\u5c31\u4f1a\u88ab\u6dfb\u52a0\u5230\u6c60\u6c47\u603b\u5217\u8868\u4e2d\u3002\u56e0\u6b64\uff0c\u6c60\u6e05\u7406\u51fd\u6570\u603b\u662f\u80fd\u8bbf\u95ee\u5230\u6240\u6709\u6b63\u5728\u88ab\u771f\u6b63\u4f7f\u7528\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u3002\u5373\uff1a \u6c60\u6e05\u7406\u51fd\u6570\u4f1a\u904d\u5386\u6c60\u6c47\u603b\u5217\u8868\uff0c\u5bf9\u4e8e\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\uff0c\u90fd\u4f1a\u5148\u5c06\u6c60\u4e2d\u6240\u6709\u7684\u79c1\u6709\u4e34\u65f6\u5bf9\u8c61\u548c\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u7f6e\u4e3anil \u7136\u540e\u518d\u628a\u8fd9\u4e2a\u6c60\u4e2d\u7684\u6240\u6709\u672c\u5730\u6c60\u5217\u8868\u90fd\u9500\u6bc1\u6389 \u6700\u540e\uff0c\u6c60\u6e05\u7406\u51fd\u6570\u4f1a\u628a\u6c60\u6c47\u603b\u5217\u8868\u91cd\u7f6e\u4e3a\u7a7a\u7684\u5207\u7247\uff0c\u8fd9\u6837\u6c60\u4e2d\u5b58\u50a8\u7684\u4e34\u65f6\u5bf9\u8c61\u5c31\u5168\u90e8\u88ab\u6e05\u9664\u5e72\u51c0\u4e86 \u5982\u679c\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e00\u5916\u5730\u7684\u4ee3\u7801\u518d\u65e0\u5bf9\u5b83\u4eec\u7684\u5f15\u7528\uff0c\u90a3\u4e48\u5728\u7a0d\u540e\u7684\u5783\u573e\u56de\u6536\u8fc7\u7a0b\u4e2d\uff0c\u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u5c31\u4f1a\u88ab\u5f53\u505a\u5783\u573e\u9500\u6bc1\u6389\u5b83\u4eec\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u5c31\u4f1a\u88ab\u56de\u6536\u5df2\u5907\u4ed6\u7528 \u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u6570\u636e\u7ed3\u6784 \u5728\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u6709\u4e00\u4e2a\u591a\u5c42\u7684\u6570\u636e\u7ed3\u6784\uff0c\u56e0\u4e3a\u5b83\u7684\u5b58\u5728\u4f7f\u5f97\u4e34\u65f6\u5bf9\u8c61\u6c60\u80fd\u591f\u975e\u5e38\u9ad8\u6548\u5730\u5b58\u50a8\u5927\u91cf\u7684\u503c\u3002\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u9876\u5c42\uff0c\u79f0\u4e3a \u672c\u5730\u6c60\u5217\u8868 \uff08\u5b83\u662f\u4e00\u4e2a\u6570\u7ec4\uff09\uff0c\u8fd9\u4e2a\u5217\u8868\u7684\u957f\u5ea6\u603b\u662f\u4e0eGo\u8bed\u8a00\u8c03\u5ea6\u5668\u4e2dP\u7684\u6570\u91cf\u76f8\u540c\u3002 Go\u8bed\u8a00\u8c03\u5ea6\u5668\u4e2d\u7684P\u662fprocessor\u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u4e00\u79cd\u53ef\u4ee5\u627f\u8f7d\u82e5\u5e72\u4e2aG\uff08goroutine\uff09\uff0c\u4e14\u80fd\u591f\u4f7f\u8fd9\u4e9bG\u9002\u65f6\u5730\u4e0eM\uff08machine\uff0c\u5373\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff09\u8fdb\u884c\u5bf9\u63a5\uff0c\u5e76\u5f97\u5230\u771f\u6b63\u8fd0\u884c\u7684\u4e2d\u4ecb\u3002\u56e0\u4e3aP \u7684\u5b58\u5728\uff0cG\u548cM\u624d\u80fd\u591f\u8fdb\u884c\u9ad8\u6821\u3001\u7075\u6d3b\u7684\u914d\u5bf9\uff0c\u4ece\u800c\u5b9e\u73b0\u5f3a\u5927\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u3002 P\u5b58\u5728\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u662f\u4e3a\u4e86 \u5206\u6563\u5e76\u53d1\u7a0b\u5e8f\u7684\u6267\u884c\u538b\u529b \uff0c \u8ba9\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u672c\u5730\u6c60\u5217\u8868\u7684\u957f\u5ea6\u4e0eP\u7684\u6570\u91cf\u76f8\u7b49\u7684\u4e3b\u8981\u539f\u56e0\u5c31\u662f \u5206\u6563\u538b\u529b \u3002 \u8fd9\u91cc\u7684\u538b\u529b\u5305\u62ec\u4e24\u65b9\u9762\uff1a\u5b58\u50a8\u548c\u6027\u80fd\u3002 \u672c\u5730\u6c60\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u672c\u5730\u6c60\u5305\u542b\u4e09\u4e2a\u5b57\u6bb5\uff1a private\uff1a\u5b58\u50a8\u79c1\u6709\u4e34\u65f6\u5bf9\u8c61 shared\uff1a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868 sync.Mutex\u7c7b\u578b\u7684\u5d4c\u5165\u5b57\u6bb5 \u6bcf\u4e2a\u672c\u5730\u6c60\u90fd\u5bf9\u5e94\u7740\u4e00\u4e2aP\uff0c\u4ee5\u4e3a\u4f60\u4e00\u4e2agoroutine\u8981\u771f\u6b63\u8fd0\u884c\u8d77\u6765\u5fc5\u987b\u5148\u4e0e\u67d0\u4e2aP\u4ea7\u751f\u5173\u8054\u3002\u5728\u7a0b\u5e8f\u8c03\u7528\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u6216Get\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u603b\u4f1a\u5148\u8bd5\u56fe\u4ece\u8be5\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u672c\u5730\u6c60\u5217\u8868\u4e2d\uff0c\u83b7\u53d6\u4e0e\u4e4b\u5bf9\u5e94\u7684\u672c\u5730\u6c60\uff0c\u4f9d\u636e\u7684\u5c31\u662f\u4e0e\u5f53\u524dgoroutine\u5173\u8054\u7684\u90a3\u4e2aP\u7684ID\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u65b9\u6cd5\u6216Get\u65b9\u6cd5\u6216\u83b7\u53d6\u5230\u54ea\u4e00\u4e2a\u672c\u5730\u6c60\uff0c\u5b8c\u5168\u53d6\u51b3\u4e8e\u8c03\u7528\u5b83\u7684\u4ee3\u7801\u6240\u5728\u7684goroutine\u5173\u8054\u7684\u90a3\u4e2aP \u3002 \u4e34\u65f6\u5bf9\u8c61\u6c60\u5982\u4f55\u5b58\u53d6\u503c Put\uff1a \u603b\u4f1a\u5148\u8bd5\u56fe\u628a\u65b0\u7684\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b58\u50a8\u5230\u5bf9\u5e94\u7684\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u4e2d\uff0c\u4ee5\u4fbf\u5728\u540e\u9762\u83b7\u53d6\u4e34\u65f6\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5feb\u901f\u5730\u62ff\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u503c\u3002 \u53ea\u6709\u5f53\u8fd9\u4e2aprivate\u5b57\u6bb5\u5df2\u7ecf\u5b58\u5728\u6709\u67d0\u4e2a\u503c\u65f6\uff0c\u8be5\u65b9\u6cd5\u624d\u4f1a\u53bb\u8bbf\u95ee\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5\u3002 Get\uff1a \u603b\u4f1a\u5148\u8bd5\u56fe\u4ece\u5bf9\u5e94\u7684\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u5904\u83b7\u53d6\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61 \u5f53private\u5b57\u6bb5\u7684\u503c\u4e3anil\u65f6\uff0c\u5b83\u624d\u4f1a\u53bb\u8bbf\u95ee\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5 \u4e00\u4e2a\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5\u539f\u5219\u4e0a\u53ef\u4ee5\u88ab\u4efb\u4f55goroutine\u4e2d\u7684\u4ee3\u7801\u8bbf\u95ee\uff0c\u4e0d\u8bba\u8fd9\u4e2agoroutine\u7ba1\u7406\u7684\u662f\u54ea\u4e00\u4e2aP\uff0c\u56e0\u6b64shard\u4e5f\u79f0\u4e3a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u3002\u56e0\u4e3a shared \u5b57\u6bb5\u662f\u5171\u4eab\u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u6536\u5230\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u3002 \u4e00\u4e2a\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u53ea\u80fd\u88ab\u4e0e\u4e4b\u5bf9\u5e94\u7684\u90a3\u4e2aP\u6240\u5173\u8054\u7684goroutine\u4e2d\u7684\u4ee3\u7801\u8bbf\u95ee\u5230\uff0c\u6240\u4ee5\u5b83\u662fP\u7ea7\u79c1\u6709\u7684\u3002 \u672c\u5730\u6c60\u672c\u8eab\u62e5\u6709\u4e92\u65a5\u9501\u529f\u80fd\uff0c\u5373\u5b83\u5d4c\u5165\u7684\u90a3\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5\u3002Put\u65b9\u6cd5\u4f1a\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\uff0c\u628a\u65b0\u7684\u4e34\u65f6\u5bf9\u8c61\u8ffd\u52a0\u5230\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u7684\u672b\u5c3e\u3002Get\u65b9\u6cd5\u4f1a\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\uff0c\u8bd5\u56fe\u628a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u503c\u53d6\u51fa\u5e76\u4f5c\u4e3a\u7ed3\u679c\u3002 \u8fd9\u91cc\u7684\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e5f\u53ef\u80fd\u662f\u7a7a\u7684\uff0c\u8fd9\u53ef\u80fd\u662f\u7531\u4e8e\u8fd9\u4e2a\u672c\u5730\u6c60\u4e2d\u7684\u6240\u6709\u4e34\u65f6\u5bf9\u8c61\u90fd\u5df2\u7ecf\u88ab\u53d6\u8d70\u4e86\uff0c\u4e5f\u53ef\u80fd\u662f\u5f53\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u521a\u88ab\u6e05\u7406\u8fc7\u3002 \u65e0\u8bba\u4ec0\u4e48\u539f\u56e0\uff0cGet\u65b9\u6cd5\u90fd\u4f1a\u53bb\u8bbf\u95ee\u5f53\u524d\u4e34\u65f6\u5bf9\u8c61\u4e2d\u7684\u6240\u6709\u672c\u5730\u6c60\uff0c\u5b83\u4f1a\u4e4b\u6b4c\u641c\u7d22\u5b83\u7684\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u3002\u53d1\u73b0\u67d0\u4e2a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e2d\u5305\u542b\u5143\u7d20\u503c\uff0c\u5b83\u5c31\u4f1a\u628a\u8be5\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u53d6\u51fa\u6765\u5e76\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 \u5373\u4f7f\u8fd9\u6837\u4e5f\u53ef\u80fd\u65e0\u6cd5\u62ff\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u4e34\u65f6\u5bf9\u8c61\uff0cGet\u4f1a\u8c03\u7528\u521b\u5efa\u4e34\u65f6\u5bf9\u8c61\u7684\u90a3\u4e2a\u51fd\u6570\u3002\u8fd9\u4e2a\u51fd\u6570\u7531\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684New\u5b57\u6bb5\u4ee3\u8868\uff0c\u5e76\u4e14\u9700\u8981\u5728\u521d\u59cb\u5316\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u65f6\u5019\u7ed9\u5b9a\u3002\u5982\u679c\u8fd9\u4e2a\u5b57\u6bb5\u4e3anil\uff0c\u90a3\u4e48Get\u65b9\u6cd5\u6b64\u65f6\u4e5f\u53ea\u80fd\u8fd4\u56denil\u3002 sync.Map Go\u8bed\u8a00\u81ea\u5e26\u7684\u5b57\u5178\u7c7b\u578b map \u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u540c\u4e00\u65f6\u95f4\u6bb5\u5185\uff0c\u8ba9\u4e0d\u540cgoroutine\u4e2d\u7684\u4ee3\u7801\uff0c\u5bf9\u540c\u4e00\u4e2a\u5b57\u5178\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u662f\u4e0d\u5b89\u5168\u7684\u3002\u5b57\u5178\u503c\u672c\u8eab\u53ef\u80fd\u4f1a\u56e0\u4e3a\u8fd9\u4e9b\u64cd\u4f5c\u800c\u4ea7\u751f\u6df7\u4e71\uff0c\u76f8\u5173\u7a0b\u5e8f\u4e5f\u53ef\u80fd\u4f1a\u56e0\u6b64\u53d1\u751f\u4e0d\u53ef\u9884\u77e5\u7684\u95ee\u9898\u3002 \u4f7f\u7528 sync.Mutex \u6216\u8005 sync.RWMutex ,\u5728\u52a0\u4e0a\u539f\u751f\u7684map\u5c31\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u5e76\u53d1\u5b89\u5168\u7684\u5b57\u5178\u3002 Go 1.9\u4e2d\u53d1\u5e03\u4e86\u5e76\u53d1\u5b89\u5168\u7684\u5b57\u5178\u7c7b\u578b sync.Map \u3002\u8fd9\u4e2a\u5b57\u5178\u7c7b\u578b\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u952e\u503c\u5b58\u53d6\u64cd\u4f5c\u65b9\u6cd5\uff0c\u5e76\u4fdd\u8bc1\u4e86\u8fd9\u4e9b\u64cd\u4f5c\u7684\u5e76\u53d1\u5b89\u5168\uff0c\u540c\u65f6\uff0c\u5b83\u7684\u5b58\u3001\u53d6\u3001\u5220\u7b49\u64cd\u4f5c\u90fd\u53ef\u4ee5\u57fa\u672c\u4fdd\u8bc1\u5e38\u6570\u65f6\u95f4\u5185\u6267\u884c\u5b8c\u6bd5\u3002\u5b83\u7684\u7b97\u6cd5\u590d\u6742\u7684\u4e0emap\u7c7b\u578b\u4e00\u6837\u90fd\u662f 0(1) \u3002 \u4e0e\u5355\u7eaf\u4f7f\u7528\u539f\u751fmap\u548c\u4e92\u65a5\u9501\u76f8\u6bd4\uff0c sync.Map \u53ef\u4ee5\u663e\u8457\u5730\u51cf\u5c11\u9501\u7684\u4e89\u7528\u3002 sync.Map \u672c\u8eab\u867d\u7136\u4e5f\u7528\u5230\u4e86\u9501\uff0c\u4f46\u662f\uff0c\u5b83\u5176\u5b9e\u5728\u5c3d\u53ef\u80fd\u5730\u907f\u514d\u4f7f\u7528\u9501\u3002\u56e0\u4e3a\u4f7f\u7528\u9501\u5c31\u610f\u5473\u7740\u628a\u4e00\u4e9b\u5e76\u53d1\u7684\u64cd\u4f5c\u5f3a\u5236\u4e32\u884c\u5316\uff0c\u8fd9\u4f1a\u964d\u4f4e\u7a0b\u5e8f\u7684\u6027\u80fd\uff0c\u5c24\u5176\u662f\u5728\u8ba1\u7b97\u673a\u62e5\u6709\u591a\u4e2aCPU\u6838\u5fc3\u7684\u60c5\u51b5\u4e0b\u3002\u56e0\u6b64\u80fd\u7528\u539f\u5b50\u64cd\u4f5c\uff08\u539f\u5b50\u64cd\u4f5c\u7684\u5c40\u9650\u6027\uff0c\u53ea\u80fd\u5bf9\u4e00\u4e9b\u57fa\u672c\u7684\u6570\u636e\u7c7b\u578b\u63d0\u4f9b\u652f\u6301\uff09\u7684\u60c5\u51b5\u4e0b\u5c31\u4e0d\u8981\u7528\u9501\u3002 \u65e0\u8bba\u5728\u4f55\u79cd\u573a\u666f\u4e0b\u4f7f\u7528 sync.Map ,\u90fd\u9700\u8981\u6ce8\u610f\u5b83\u4e0e\u539f\u751fmap\u660e\u663e\u4e0d\u540c\uff0c\u5b83\u53ea\u662f\u6807\u51c6\u5e93\u4e2d\u7684\u4e00\u5458\uff0c\u800c\u4e0d\u662f\u8bed\u8a00\u5c42\u9762\u7684\u4e1c\u897f\u3002\u7f16\u8bd1\u5668\u5e76\u4e0d\u4f1a\u5bf9\u5b83\u7684\u952e\u548c\u503c\u8fdb\u884c\u7279\u6b8a\u7684\u7c7b\u578b\u68c0\u67e5\u3002 sync.Map \u6240\u6709\u7684\u65b9\u6cd5\u6d89\u53ca\u7684\u952e\u548c\u503c\u7684\u7c7b\u578b\u90fd\u662f interface{} \uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u5305\u7f57\u4e07\u8c61\uff0c\u6240\u4ee5\u5fc5\u987b\u5728\u7a0b\u5e8f\u4e2d\u81ea\u884c\u4fdd\u8bc1\u5b83\u7684\u952e\u7c7b\u578b\u548c\u503c\u7c7b\u578b\u7684\u6b63\u786e\u6027\u3002 sync.Map \u5bf9\u952e\u7c7b\u578b\u7684\u8981\u6c42 \u952e\u7684\u5b9e\u9645\u7c7b\u578b\u4e0d\u80fd\u662f\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u6bb5\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b \u3002 Go\u8bed\u8a00\u539f\u751f\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e5f\u4e0d\u80fd\u662f\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b\u3002 sync.Map \u5185\u90e8\u7684\u5b58\u50a8\u4ecb\u8d28\u5c31\u662f\u539f\u751f\u5b57\u5178\uff0c\u53c8\u56e0\u4e3a\u539f\u751f\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e5f\u662f interface{} \uff0c\u6240\u4ee5\u7edd\u5bf9\u4e0d\u80fd\u5e26\u8fd9\u4efb\u4f55\u5b9e\u9645\u7c7b\u578b\u4e3a\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u6216\u5207\u7247\u7c7b\u578b\u7684\u952e\u503c\u53bb\u64cd\u4f5c sync.Map \u3002 \u56e0\u4e3a\u8fd9\u4e9b\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u624d\u80fd\u786e\u5b9a\uff0c\u6240\u4ee5Go\u8bed\u8a00\u7f16\u8bd1\u5668\u662f\u65e0\u6cd5\u5728\u7f16\u8bd1\u671f\u95f4\u5bf9\u5b83\u4eec\u8fdb\u884c\u68c0\u67e5\u7684\uff0c\u4e0d\u6b63\u786e\u7684\u952e\u503c\u5b9e\u9645\u7c7b\u578b\u4f1a\u5f15\u53d1panic \u3002 \u6240\u4ee5\u5728\u6bcf\u6b21\u64cd\u4f5c sync.Map \u7684\u65f6\u5019\uff0c\u663e\u5f0f\u5730\u68c0\u67e5\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b \u3002\u66f4\u597d\u7684\u64cd\u4f5c\u662f\u9488\u5bf9\u540c\u4e00\u4e2a sync.Map \u7684\u5b58\u3001\u53d6\u3001\u5220\u64cd\u4f5c\u90fd\u96c6\u4e2d\u8d77\u6765\uff0c\u7136\u540e\u7edf\u4e00\u7f16\u5199\u68c0\u67e5\u4ee3\u7801\u3002\u6216\u8005\u628a sync.Map \u5c01\u88c5\u5728\u4e00\u4e2a\u7ed3\u6784\u4f53\u4e2d\u4e5f\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u5fc5\u987b\u4fdd\u8bc1\u952e\u7684\u7c7b\u578b\u662f\u53ef\u6bd4\u8f83\u7684\uff08\u53ef\u5224\u7b49\u7684\uff09\uff0c\u5b9e\u5728\u62ff\u4e0d\u51c6\uff0c\u53ef\u4ee5\uff1a \u4f7f\u7528 reflect.Typeof() \u51fd\u6570\u5f97\u5230\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u7684\u53cd\u5c04\u7c7b\u578b\u503c\uff08\u5373\uff1a reflect.Type \u7c7b\u578b\u7684\u503c\uff09 \u8c03\u7528\u8fd9\u4e2a\u503c\u7684 Comparable \u65b9\u6cd5\u5f97\u5230\u786e\u5207\u7684\u5224\u65ad\u7ed3\u679c \u4fdd\u8bc1 sync.Map \u4e2d\u952e\u503c\u7684\u7c7b\u578b\u6b63\u786e\u6027 \u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u6216\u8005\u53cd\u5c04\u64cd\u4f5c\u6765\u4fdd\u8bc1\u5b83\u4eec\u7684\u7c7b\u578b\u6b63\u786e\u6027\u3002 \u65b9\u6848\u4e00 \u8ba9 sync.Map \u53ea\u80fd\u5b58\u50a8\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u7684\u952e\u3002\u4e00\u65e6\u786e\u5b9a\u597d\u4e86\u952e\u7684\u7c7b\u578b\uff0c\u5c31\u53ef\u4ee5\u5728\u5b58\u3001\u53d6\u3001\u5220\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u53bb\u5bf9\u952e\u7684\u7c7b\u578b\u505a\u68c0\u67e5\u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8fd9\u6837\u7684\u68c0\u67e5\u5e76\u4e0d\u7e41\u7410\uff0c\u5982\u679c\u628a sync.Map \u5c01\u88c5\u5728\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\u91cc\u5c31\u66f4\u65b9\u4fbf\u4e86\uff0c\u8fd9\u6837\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u5e2e\u52a9\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u5982\u4e0b\u6240\u793a\uff1a // \u952e\u7c7b\u578b\u4e3aint\uff0c\u503c\u7c7b\u578b\u4e3astring // \u5728\u8fd9\u4e2a\u7ed3\u6784\u4f53\u4e2d\uff0c\u53ea\u6709sync.Map\u7c7b\u578b\u7684\u5b57\u6bb5m type IntStrMap struct { m sync.Map } func (iMap *IntStrMap) Delete(key int) { iMap.m.Delete(key) } func (iMap *IntStrMap) Load(key int) (value string, ok bool) { v, ok := iMap.m.Load(key) if v != nil { value = v.(string) } return } func (iMap *IntStrMap) LoadOrStore(key int, value string) (actual string, loaded bool) { a, loaded := iMap.m.LoadOrStore(key, value) actual = a.(string) return } func (iMap *IntStrMap) Range(f func(key int, value string) bool) { f1 := func(key, value interface{}) bool { return f(key.(int), value.(string)) } iMap.m.Range(f1) } func (iMap *IntStrMap) Store(key int, value string) { iMap.m.Store(key, value) } \u8fd9\u6837\u5728\u8fd9\u4e9b\u65b9\u6cd5\u64cd\u4f5c\u952e\u503c\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u518d\u9700\u8981\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u4e5f\u4e0d\u7528\u62c5\u5fc3\u7c7b\u578b\u4f1a\u4e0d\u6b63\u786e\u3002 \u56e0\u6b64\uff0c\u5728\u786e\u5b9a\u952e\u548c\u503c\u7684\u5177\u4f53\u7c7b\u578b\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5229\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u53bb\u505a\u7c7b\u578b\u68c0\u67e5\uff0c\u5e76\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u8f85\u52a9\u3002 \u65b9\u6848\u4e8c \u5c01\u88c5\u7684\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u53ef\u4ee5\u4e0e sync.Map \u7c7b\u578b\u7684\u65b9\u6cd5\u5b8c\u5168\u4e00\u81f4\uff08\u5305\u62ec\u65b9\u6cd5\u540d\u79f0\u548c\u65b9\u6cd5\u7b7e\u540d\uff09\u3002\u4e0d\u8fc7\u5728\u8fd9\u4e9b\u65b9\u6cd5\u4e2d\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u7c7b\u578b\u68c0\u67e5\u7684\u4ee3\u7801\u3002\u8fd9\u6837 sync.Map \u7684\u952e\u548c\u503c\u7c7b\u578b\u5fc5\u987b\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c31\u5b8c\u5168\u786e\u5b9a\uff0c\u5e76\u4e14\u5fc5\u987b\u5148\u4fdd\u8bc1\u952e\u7684\u7c7b\u578b\u662f\u53ef\u6bd4\u8f83\u7684\u3002 \u6240\u4ee5\u5c01\u88c5\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a // \u53ef\u81ea\u5b9a\u4e49\u952e\u548c\u503c\u7c7b\u578b\u7684sync.Map type ConcurrentMap struct { m sync.Map // \u952e\u548c\u503c\u90fd\u662f\u53cd\u5c04\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u53ef\u4ee5\u4ee3\u8868Go\u8bed\u8a00\u7684\u4efb\u4f55\u6570\u636e\u7c7b\u578b // \u8fd9\u4e2a\u7c7b\u578b\u503c\u5bb9\u6613\u83b7\u5f97\uff0c\u901a\u8fc7\u8c03\u7528reflect.Typeof\u51fd\u6570\u5e76\u628a\u6837\u672c\u503c\u4f20\u5165\u5373\u53ef keyType reflect.Type valueType reflect.Type } func (cMap *ConcurrentMap) Load(key interface{}) (value interface{}, ok bool) { // \u5c06\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u503c\u4f20\u5165reflect.Typeof\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u5bf9\u5e94\u7684\u53cd\u5c04\u7c7b\u578b\u503c if reflect.TypeOf(key) != cMap.keyType { return } return cMap.m.Load(key) } func (cMap *ConcurrentMap) Store(key, value interface{}) { // \u5f53key\u548cvalue\u7684\u5b9e\u9645\u7c7b\u578b\u4e0d\u7b26\u5408\u8981\u6c42\u65f6\uff0cstore\u65b9\u6cd5\u4f1a\u7acb\u5373\u5f15\u53d1panic // \u56e0\u4e3astore\u65b9\u6cd5\u6ca1\u6709\u7ed3\u679c\u58f0\u660e\uff0c\u6240\u4ee5\u5728\u53c2\u6570\u503c\u6709\u95ee\u9898\u7684\u65f6\u5019\uff0c\u65e0\u6cd5\u901a\u8fc7\u6bd4\u8f83\u5e73\u548c\u7684\u65b9\u5f0f\u544a\u77e5\u8c03\u7528\u65b9 if reflect.TypeOf(key) != cMap.keyType { panic(fmt.Errorf( wrong key type: %v , reflect.TypeOf(key))) } if reflect.TypeOf(value) != cMap.valueType { panic(fmt.Errorf( wrong value type: %v , reflect.TypeOf(value))) } cMap.m.Store(key, value) } // \u4e5f\u53ef\u4ee5\u4e3astore\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2aerror\u7c7b\u578b\u7684\u7ed3\u679c\uff0c\u5728\u53d1\u73b0\u53c2\u6570\u503c\u7c7b\u578b\u4e0d\u6b63\u786e\u7684\u65f6\u5019\uff0c // \u8ba9\u5b83\u76f4\u63a5\u8fd4\u56de\u54cd\u5e94\u7684error\u7c7b\u578b\u503c\uff0c\u800c\u4e0d\u662f\u5f15\u53d1panic\uff0c\u5b9e\u9645\u4e2d\u53ef\u6839\u636e\u5e94\u7528\u573a\u666f\u8fdb\u884c\u6539\u8fdb\u548c\u4f18\u5316 \u65b9\u6848\u4e00\uff1a \u9002\u5408\u53ef\u4ee5\u5b8c\u5168\u786e\u5b9a\u952e\u548c\u503c\u7c7b\u578b\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u505a\u7c7b\u578b\u68c0\u67e5\uff0c\u5e76\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u505a\u8f85\u52a9\u3002 \u660e\u663e\u7684\u7f3a\u9677\u5c31\u662f\u65e0\u6cd5\u7075\u6d3b\u5730\u6539\u53d8\u5b57\u5178\u7684\u952e\u548c\u503c\u7684\u7c7b\u578b\uff0c\u9700\u6c42\u591a\u6837\u5316\u5219\u7f16\u7801\u5de5\u4f5c\u91cf\u589e\u52a0\u3002 \u65b9\u6848\u4e8c\uff1a \u65e0\u9700\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u524d\u660e\u786e\u952e\u548c\u503c\u7684\u7c7b\u578b\uff0c\u53ea\u8981\u5728\u521d\u59cb\u5316 sync.Map \u7684\u65f6\u5019\uff0c\u52a8\u6001\u5730\u7ed9\u5b83\u4eec\u5c31\u53ef\u4ee5\uff0c\u4e3b\u8981\u4f7f\u7528reflect\u5305\u4e2d\u7684\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\uff0c\u5916\u52a0\u4e00\u4e9b\u7b80\u5355\u7684\u5224\u7b49\u64cd\u4f5c\u3002 \u66f4\u7075\u6d3b\uff0c\u4f46\u662f\u53cd\u5c04\u64cd\u4f5c\u964d\u4f4e\u7a0b\u5e8f\u7684\u6027\u80fd\u3002 sync.Map \u5982\u4f55\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u9501 sync.Map \u7c7b\u578b\u5728\u5185\u90e8\u4f7f\u7528\u5927\u91cf\u7684\u539f\u5b50\u64cd\u4f5c\u6765\u5b58\u53d6\u952e\u548c\u503c\uff0c\u5e76\u4f7f\u7528\u4e24\u4e2a\u539f\u751f\u7684map\u4f5c\u4e3a\u5b58\u50a8\u4ecb\u8d28\uff1a \u4e00\u4e2a\u539f\u751fmap\u88ab\u5b58\u5728\u4e86 sync.Map \u7684read\u5b57\u6bb5\u4e2d\uff0c\u8be5\u5b57\u6bb5\u662f sycn/atomic.Value \u7c7b\u578b\u7684\u3002\u8fd9\u4e2a\u539f\u751f\u5b57\u5178\u53ef\u4ee5\u88ab\u770b\u505a\u4e00\u4e2a\u5feb\u7167\uff0c\u5b83\u603b\u4f1a\u5728\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u53bb\u91cd\u65b0\u4fdd\u5b58\u6240\u5c5e\u7684 sync.Map \u503c\u4e2d\u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u3002 read\u5b57\u6bb5\u867d\u7136\u4e0d\u4f1a\u589e\u51cf\u5176\u4e2d\u7684\u952e\uff0c\u4f46\u5374\u5141\u8bb8\u53d8\u66f4\u5176\u4e2d\u7684\u952e\u6240\u5bf9\u5e94\u7684\u503c\uff0c\u6240\u4ee5\u5b83\u4e0d\u662f\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u5feb\u7167\uff0c\u5b83\u7684\u53ea\u8bfb\u7279\u6027\u53ea\u662f\u5bf9\u5176\u4e2d\u952e\u7684\u96c6\u5408\u800c\u8a00\u7684\u3002 read\u5b57\u6bb5\u7684\u7c7b\u578b\u53ef\u77e5\uff0c sync.Map \u5728\u66ff\u6362read\u7684\u65f6\u5019\u6839\u672c\u7528\u4e0d\u7740\u9501\uff0c\u5e76\u4e14read\u5b57\u6bb5\u5728\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u8fd8\u5728\u503c\u4e4b\u4e0a\u5c01\u88c5\u4e86\u4e00\u5c42\uff1a \u5148\u628a\u503c\u8f6c\u6362\u4e3aunsafe.Pointer`\u7c7b\u578b\u7684\u503c \u518d\u628a\u540e\u8005\u5c01\u88c5\u540e\u5b58\u50a8\u5728\u5176\u4e2d\u7684\u539f\u751fmap\u4e2d \u8fd9\u6837\uff0c\u5728\u53d8\u66f4\u67d0\u4e2a\u952e\u6240\u5bf9\u5e94\u7684\u503c\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u4e86\u3002 \u53e6\u4e00\u4e2a\u539f\u751fmap\u5b58\u5728 sync.Map \u7684dirty\u5b57\u6bb5\u4e2d\uff0c\u5b83\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65b9\u5f0f\u4e0eread\u5b57\u6bb5\u4e00\u53ea\uff0c\u5b83\u7684\u952e\u7c7b\u578b\u662f interface{} \uff0c\u5e76\u4e14\u540c\u6837\u628a\u503c\u5148\u505a\u8f6c\u6362\u548c\u5c01\u88c5\uff0c\u7136\u540e\u518d\u8fdb\u884c\u5b58\u50a8\u3002 read\u548cdirty\u5b57\u6bb5\u5982\u679c\u90fd\u5b58\u6709\u540c\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684\u4e24\u4e2a\u952e\u6307\u7684\u80af\u5b9a\u662f\u540c\u4e00\u4e2a\u57fa\u672c\u503c\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u503c\u6765\u8bf4\u4e5f\u662f\u5982\u6b64 \u3002 \u8fd9\u4e24\u4e2a\u5b57\u5178\u5728\u5b58\u50a8\u952e\u548c\u503c\u7684\u65f6\u5019\uff0c\u53ea\u4f1a\u5b58\u5165\u5b83\u4eec\u7684\u67d0\u4e2a\u6307\u9488\uff0c\u800c\u4e0d\u662f\u57fa\u672c\u503c\u3002 \u8bfb\u53d6\uff1a sync.Map \u5728\u67e5\u627e\u6307\u5b9a\u7684\u952e\u9501\u5bf9\u5e94\u7684\u503c\u7684\u65f6\u5019\uff0c\u603b\u4f1a\u5148\u53bbread\u4e2d\u5bfb\u627e\uff0c\u5e76\u4e0d\u9700\u8981\u9501\u5b9a\u4e92\u65a5\u9501 \u53ea\u6709\u5728\u786e\u5b9aread\u4e2d\u6ca1\u6709\uff0c\u4f46dirty\u4e2d\u53ef\u80fd\u8fd8\u6709\u8fd9\u4e2a\u952e\u7684\u65f6\u5019\uff0c\u5b83\u624d\u4f1a\u5728\u9501\u7684\u5305\u542b\u4e0b\u53bb\u8bbf\u95eedirty \u5b58\u50a8\uff1a sync.Map \u5728\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u53ea\u8981read\u4e2d\u5df2\u5b58\u6709\u8fd9\u4e2a\u952e \u5e76\u4e14\u8be5\u952e\u503c\u5bf9\u672a\u88ab\u6807\u8bb0\u4e3a\u201c\u5df2\u5220\u9664\u201d\uff0c\u5c31\u4f1a\u628a\u65b0\u503c\u5b58\u5230\u91cc\u9762\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e5f\u4e0d\u9700\u8981\u7528\u5230\u9501 \u5426\u5219\uff0c\u5b83\u624d\u4f1a\u5728\u9501\u7684\u4fdd\u62a4\u4e0b\u628a\u952e\u503c\u5bf9\u5b58\u50a8\u5230dirty\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u8be5\u952e\u503c\u5bf9\u7684\u201c\u5df2\u5220\u9664\u201d\u6807\u8bb0\u4f1a\u88ab\u62b9\u53bb \u53ea\u6709\u5f53\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u8be5\u88ab\u5220\u9664\uff0c\u4f46\u5374\u4ecd\u7136\u5b58\u5728\u4e0eread\u4e2d\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u88ab\u7528\u6807\u8bb0\u4e3a\u201c\u5df2\u5220\u9664\u201d\u7684\u65b9\u5f0f\u8fdb\u884c\u903b\u8f91\u5220\u9664\uff0c\u800c\u4e0d\u4f1a\u76f4\u63a5\u88ab\u7269\u7406\u5220\u9664\u3002\u8fd9\u79cd\u60c5\u51b5\u4f1a\u5728\u91cd\u5efadirty\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u51fa\u73b0\uff0c\u8fc7\u4e0d\u4e86\u591a\u4e45\uff0c\u5c31\u4f1a\u88ab\u771f\u6b63\u5220\u9664\u3002 \u5728\u67e5\u627e\u548c\u904d\u5386\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u88ab\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u6c38\u8fdc\u4f1a\u88ab\u65e0\u89c6 \u3002 \u5bf9\u4e8e\u5220\u9664\u952e\u503c\u5bf9\uff0c sync.Map \u4f1a\u5148\u53bb\u68c0\u67e5read\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7684\u952e\uff0c\u5982\u679c\u6ca1\u6709\uff0cdirty\u4e2d\u53ef\u80fd\u6709\uff0c\u90a3\u4e48\u5b83\u4f1a\u5728\u9501\u4fdd\u62a4\u4e0b\uff0c\u8bd5\u56fe\u4ecedirty\u4e2d\u5220\u9664\u8be5\u952e\u503c\u5bf9\u3002\u6700\u540e\uff0c sync.Map \u4f1a\u628a\u8be5\u952e\u503c\u5bf9\u4e2d\u6307\u5411\u503c\u7684\u90a3\u4e2a\u6307\u9488\u7f6e\u4e3anil\uff0c\u8fd9\u662f\u53e6\u4e00\u79cd\u903b\u8f91\u5220\u9664\u65b9\u5f0f\u3002 \u9700\u8981\u6ce8\u610f\uff0cread\u548cdirty\u4e4b\u95f4\u662f\u4f1a\u76f8\u4e92\u8f6c\u6362\u7684\uff0c\u5728dirty\u4e2d\u67e5\u627e\u952e\u503c\u5bf9\u6b21\u6570\u8db3\u591f\u591a\u7684\u65f6\u5019\uff0c sync.Map \u4f1a\u628adirty\u76f4\u63a5\u4f5c\u4e3aread\uff0c\u4fdd\u5b58\u5728\u5b83\u7684read\u5b57\u6bb5\u4e2d\uff0c\u7136\u540e\u628a\u4ee3\u8868dirty\u7684dirty\u5b57\u6bb5\u7f6e\u4e3anil\u3002 \u5728\u8fd9\u4e4b\u540e\uff0c\u4e00\u65e6\u518d\u6709\u65b0\u7684\u952e\u503c\u5bf9\u5b58\u5165\uff0c\u5b83\u5c31\u4f1a\u4f9d\u636eread\u53bb\u91cd\u5efadirty\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f1a\u628aread\u4e2d\u5df2\u7ecf\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u8fc7\u6ee4\u6389\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u5728\u9501\u7684\u4fdd\u62a4\u4e0b\u8fdb\u884c\u3002 \u7efc\u4e0a\uff0c sync.Map \u7684read\u548cdirty\u4e2d\u7684\u952e\u503c\u5bf9\u96c6\u5408\u5e76\u4e0d\u662f\u5b9e\u65f6\u540c\u6b65\u7684\uff0c\u5b83\u4eec\u5728\u67d0\u4e9b\u65f6\u95f4\u6bb5\u5185\u53ef\u80fd\u4f1a\u4e0d\u540c\uff0c\u7531\u4e8eread\u4e2d\u7684\u952e\u503c\u5bf9\u7684\u96c6\u5408\u4e0d\u80fd\u88ab\u6539\u53d8\uff0c\u6240\u4ee5\u5176\u4e2d\u7684\u952e\u503c\u5bf9\u6709\u65f6\u5019\u53ef\u80fd\u662f\u4e0d\u5168\u7684\uff0c\u76f8\u53cd\uff0cdirty\u4e2d\u7684\u952e\u503c\u5bf9\u96c6\u5408\u603b\u662f\u5b8c\u5168\u7684\uff0c\u5e76\u4e14\u5176\u4e2d\u4e0d\u4f1a\u5305\u542b\u5df2\u88ab\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u3002 \u56e0\u6b64\u5728\u8bfb\u64cd\u4f5c\u5f88\u591a\uff0c\u5199\u64cd\u4f5c\u5f88\u5c11\u7684\u60c5\u51b5\u4e0b\uff0c sync.Map \u7684\u6027\u80fd\u4f1a\u66f4\u597d\uff0c\u5728\u51e0\u4e2a\u5199\u64cd\u4f5c\u5f53\u4e2d\uff0c\u65b0\u589e\u952e\u503c\u5bf9\u7684\u64cd\u4f5c\u5bf9 sync.Map \u7684\u6027\u80fd\u5f71\u54cd\u6700\u5927\uff0c\u5176\u6b21\u662f\u5220\u9664\u64cd\u4f5c\uff0c\u6700\u540e\u662f\u4fee\u6539\u64cd\u4f5c \u3002\u5982\u679c\u88ab\u64cd\u4f5c\u7684\u952e\u503c\u5bf9\u5df2\u7ecf\u5b58\u5728\u4e8e sync.Map \u7684read\u4e2d\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u903b\u8f91\u5220\u9664\uff0c\u90a3\u4e48\u4fee\u6539\u5b83\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5230\u9501\uff0c\u5bf9\u5176\u6027\u80fd\u7684\u5f71\u54cd\u4f1a\u5f88\u5c0f\u3002","title":"sync"},{"location":"Language/Basic/17-sync/#sync","text":"","title":"sync"},{"location":"Language/Basic/17-sync/#syncmutexsyncrwmutex","text":"","title":"`sync.Mutex\u548csync.RWMutex"},{"location":"Language/Basic/17-sync/#_1","text":"Go\u8bed\u8a00\u5ba3\u626c\u201c \u7528\u901a\u4fe1\u7684\u65b9\u5f0f\u5171\u4eab\u6570\u636e \u201d\uff0c\u4f46\u662f\uff0c \u901a\u8fc7\u5171\u4eab\u6570\u636e\u7684\u65b9\u5f0f\u6765\u4f20\u9012\u4fe1\u606f\u548c\u534f\u8c03\u7ebf\u7a0b\u8fd0\u884c \u7684\u505a\u6cd5\u5176\u5b9e\u66f4\u52a0\u4e3b\u6d41\uff0c\u5927\u90e8\u5206\u73b0\u4ee3\u7f16\u7a0b\u8bed\u8a00\u90fd\u4f7f\u7528\u540e\u4e00\u79cd\u65b9\u5f0f\u4f5c\u4e3a\u5e76\u53d1\u7f16\u7a0b\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u4e00\u65e6\u6570\u636e\u88ab\u591a\u4e2a\u7ebf\u7a0b\u5171\u4eab\uff0c\u5f88\u53ef\u80fd\u4f1a\u4ea7\u751f\u4e89\u7528\u548c\u51b2\u7a81\u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u79f0\u4e3a \u7ade\u6001\u6761\u4ef6\uff08race condition\uff09 \uff0c\u8fd9\u5f80\u5f80\u4f1a\u7834\u574f\u5171\u4eab\u6570\u636e\u7684\u4e00\u81f4\u6027\u3002 \u5171\u4eab\u6570\u636e\u7684\u4e00\u81f4\u6027\u4ee3\u8868\u7740\uff1a\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u6570\u636e\u7684\u64cd\u4f5c\u603b\u662f\u53ef\u4ee5\u8fbe\u5230\u5b83\u4eec\u5404\u81ea\u9884\u671f\u7684\u6548\u679c \u3002 \u540c\u6b65\u7684\u7528\u9014\u6709\u4e24\u4e2a\uff1a \u907f\u514d\u591a\u4e2a\u7ebf\u7a0b\uff0c\u5728\u540c\u4e00\u65f6\u523b\u64cd\u4f5c\u540c\u4e00\u4e2a \u6570\u636e\u5757 \u534f\u8c03\u591a\u4e2a\u7ebf\u7a0b\uff0c\u907f\u514d\u5b83\u4eec\u5728\u540c\u4e00\u65f6\u523b\u6267\u884c\u540c\u4e00\u4e2a \u4ee3\u7801\u5757 \u8fd9\u4e9b\u6570\u636e\u5757\u548c\u4ee3\u7801\u5757\u7684\u80cc\u540e\u90fd\u9690\u542b\u7740\u4e00\u79cd\u6216\u591a\u79cd\u8d44\u6e90\uff08\u5982\u5b58\u50a8\u8d44\u6e90\uff0c\u8ba1\u7b97\u8d44\u6e90\u3001I/O\u8d44\u6e90\u3001\u7f51\u7edc\u8d44\u6e90\u7b49\uff09\uff0c\u628a\u5b83\u4eec\u770b\u6210\u662f\u5171\u4eab\u8d44\u6e90\uff0c \u540c\u6b65\u5176\u5b9e\u5c31\u662f\u5728\u63a7\u5236\u591a\u4e2a\u7ebf\u7a0b\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee \u3002 \u5982\u679c\u67d0\u4e2a\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\uff0c\u5728\u540c\u4e00\u65f6\u523b\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8fdb\u884c\uff0c\u90a3\u4e48\u591a\u4e2a\u5e76\u53d1\u7ebf\u7a0b\u5bf9\u8be5\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u662f\u5b8c\u5168\u4e32\u884c\u7684\u3002\u53ea\u8981\u4e00\u4e2a\u4ee3\u7801\u5757\u9700\u8981\u5b9e\u73b0\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u4e32\u884c\u5316\u8bbf\u95ee\uff0c\u5c31\u53ef\u4ee5\u88ab\u89c6\u4e3a\u4e00\u4e2a\u4e34\u754c\u533a\uff08critical section\uff09\uff0c\u7531\u4e8e\u8981\u8bbf\u95ee\u5230\u8d44\u6e90\u800c\u5fc5\u987b\u8fdb\u5165\u7684\u90a3\u4e2a\u533a\u57df\u3002 \u5982\u679c\u9488\u5bf9\u540c\u4e00\u4e2a\u5171\u4eab\u8d44\u6e90\uff0c\u8fd9\u6837\u7684\u4ee3\u7801\u5757\u6709\u591a\u4e2a\uff0c\u90a3\u4e48\u5b83\u4eec\u6210\u4e3a\u76f8\u5173\u4e34\u754c\u533a\u3002 \u5b83\u4eec\u53ef\u4ee5\u662f\u4e00\u4e2a\u5185\u542b\u4e86\u5171\u4eab\u6570\u636e\u7684\u7ed3\u6784\u4f53\u53ca\u5176\u65b9\u6cd5\uff0c \u4e5f\u53ef\u4ee5\u662f\u64cd\u4f5c\u540c\u4e00\u5757\u5171\u4eab\u6570\u636e\u7684\u591a\u4e2a\u51fd\u6570\u3002 \u4e34\u754c\u533a\u603b\u662f\u9700\u8981\u6536\u5230\u4fdd\u62a4\uff0c\u5426\u5219\u5c31\u4f1a\u4ea7\u751f\u7ade\u6001\u6761\u4ef6\uff0c\u65bd\u52a0\u4fdd\u62a4\u7684\u91cd\u8981\u624b\u6bb5\u4e4b\u4e00\uff0c\u5c31\u662f \u4f7f\u7528\u5b9e\u73b0\u4e86\u67d0\u79cd\u540c\u6b65\u673a\u5236\u7684\u5de5\u5177 \uff0c\u79f0\u4e3a\u540c\u6b65\u5de5\u5177\u3002 \u5728Go\u8bed\u8a00\u4e2d\uff0c\u53ef\u4f9b\u9009\u62e9\u7684\u540c\u6b65\u5de5\u5177\u4e0d\u5c11\uff0c\u6700\u91cd\u8981\u6700\u5e38\u7528\u7684\u540c\u6b65\u5de5\u5177\u662f \u4e92\u65a5\u91cf\uff08mutual exclusion\uff0c\u7b80\u79f0mutex\uff09 \u3002sync\u5305\u4e2d\u7684Mutex\u5c31\u662f\u4e0e\u5176\u5bf9\u5e94\u7684\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u7684\u503c\u53ef\u4ee5\u88ab\u79f0\u4e3a\u4e92\u65a5\u91cf\u6216\u8005\u4e92\u65a5\u9501\u3002 \u4e00\u4e2a\u4e92\u65a5\u9501\u53ef\u4ee5\u88ab\u7528\u6765\u5305\u542b\u4e00\u4e2a\u4e34\u754c\u533a\u6216\u8005\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a\uff0c\u901a\u8fc7\u5b83\u6765\u4fdd\u8bc1\u5728\u540c\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2agoroutine\u5904\u4e8e\u8be5\u4e34\u754c\u533a\u5185\u3002\u6bcf\u5f53\u6709goroutine\u60f3\u8fdb\u5165\u4e34\u754c\u533a\u65f6\uff0c\u90fd\u9700\u8981\u5148\u5bf9\u5b83\u8fdb\u884c\u9501\u5b9a\uff0c\u79bb\u5f00\u65f6\u8981\u53ca\u65f6\u8fdb\u884c\u89e3\u9501\u3002 \u9501\u5b9a\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u4e92\u65a5\u9501\u7684Lock\u65b9\u6cd5\u5b9e\u73b0 \u89e3\u9501\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528\u4e92\u65a5\u9501\u7684Unlock\u65b9\u6cd5\u5b9e\u73b0 mu.Lock() _, err := writer.Write([]byte(data)) if err != nil { log.Printf( error:%s[%d] ,err,id) } mu.UnLock()","title":"\u7ade\u6001\u6761\u4ef6\u3001\u4e34\u754c\u533a\u548c\u540c\u6b65\u5de5\u5177"},{"location":"Language/Basic/17-sync/#_2","text":"\u4e0d\u8981\u91cd\u590d\u9501\u5b9a\u4e92\u65a5\u9501\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u5df2\u7ecf\u9501\u5b9a\u7684\u4e92\u65a5\u9501\u8fdb\u884c\u9501\u5b9a\uff0c\u4f1a\u7acb\u5373\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u8fd9\u4e2agoroutine\u6267\u884c\u7684\u6d41\u7a0b\u4f1a\u4e00\u76f4\u505c\u6ede\u5728\u8c03\u7528\u8be5\u4e92\u65a5\u9501\u7684Lock\u65b9\u6cd5\u7684\u90a3\u884c\u4ee3\u7801\u4e0a\u3002\u76f4\u5230\u4e92\u65a5\u9501\u7684Unlock\u65b9\u6cd5\u88ab\u8c03\u7528\uff0c\u5e76\u4e14\u8fd9\u91cc\u7684\u9501\u5b9a\u64cd\u4f5c\u6210\u529f\u4e4b\u540e\uff0c\u4e34\u754c\u533a\u7684\u4ee3\u7801\u624d\u4f1a\u6267\u884c\u3002 \u4e0d\u8981\u5fd8\u8bb0\u89e3\u9501\u4e92\u65a5\u9501\uff0c\u5fc5\u8981\u65f6\u4f7f\u7528defer\u8bed\u53e5 \u53ef\u4ee5\u907f\u514d\u51fa\u73b0\u91cd\u590d\u9501\u5b9a\u3002\u56e0\u4e3a\u5fd8\u8bb0\u63a5\u6536\u4f1a\u4f7f\u5f97\u5176\u4ed6goroutine\u65e0\u6cd5\u8fdb\u5165\u5230\u4e92\u65a5\u9501\u4fdd\u62a4\u7684\u4e34\u754c\u533a\u4e2d\uff0c\u8f7b\u5219\u529f\u80fd\u5931\u6548\uff0c\u91cd\u5219\u6b7b\u9501\u5d29\u6e83\u3002 \u7a0b\u5e8f\u7684\u6d41\u7a0b\u53ef\u4ee5\u5206\u53c9\u4e5f\u53ef\u4ee5\u88ab\u4e2d\u65ad\uff0c\u6240\u4ee5\u4e00\u4e2a\u6d41\u7a0b\u5728\u9501\u5b9a\u67d0\u4e2a\u4e92\u65a5\u9501\u4e4b\u540e\uff0c\u7d27\u8ddf\u7740defer\u8bed\u53e5\u8fdb\u884c\u63a5\u6536\u662f\u6bd4\u8f83\u7a33\u59a5\u7684\u3002 3. \u4e0d\u8981\u5bf9\u5c1a\u672a\u9501\u5b9a\u6216\u8005\u5df2\u89e3\u9501\u7684\u4e92\u65a5\u9501\u89e3\u9501 \u89e3\u9501\u672a\u9501\u5b9a\u7684\u4e92\u65a5\u9501\u4f1a\u7acb\u5373\u5f15\u8d77panic\u3002\u4e0e\u6b7b\u9501\u7684panic\u4e00\u6837\uff0c\u65e0\u6cd5\u88ab\u6062\u590d\u3002 \u56e0\u6b64\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9501\u5b9a\u64cd\u4f5c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u89e3\u9501\u64cd\u4f5c \u3002 4. \u4e0d\u8981\u5728\u591a\u4e2a\u51fd\u6570\u4e4b\u95f4\u76f4\u63a5\u4f20\u9012\u4e92\u65a5\u9501 \u6b7b\u9501\uff0c\u5f53\u524d\u7a0b\u5e8f\u4e2d\u7684\u4e3bgoroutine\uff0c\u4ee5\u53ca\u542f\u7528\u7684\u90a3\u4e9bgoroutine\u90fd\u5df2\u7ecf\u88ab\u963b\u585e\uff0c\u8fd9\u4e9bgoroutine\u53ef\u4ee5\u88ab\u7edf\u79f0\u4e3a\u7528\u6237\u7ea7\u7684goroutine\uff0c\u8fd9\u5c31\u76f8\u5f53\u4e8e\u6574\u4e2a\u7a0b\u5e8f\u90fd\u5df2\u7ecf\u505c\u6ede\u4e0d\u524d\u4e86\u3002 Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4e0d\u5141\u8bb8\u8fd9\u79cd\u60c5\u51b5\u51fa\u73b0\uff0c\u5f53\u53d1\u73b0\u6240\u4ee5\u7528\u6237\u7ea7goroutine\u90fd\u5904\u4e8e\u7b49\u5f85\u4f1a\u629b\u51fa\u5982\u4e0bpanic\uff1a fatal error: all goroutines are asleep - deadlock! Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u81ea\u884c\u629b\u51fa\u7684panic\u90fd\u5c5e\u4e8e\u81f4\u547d\u9519\u8bef\uff0c\u65e0\u6cd5\u88ab\u6062\u590d\uff0c\u8c03\u7528recover\u51fd\u6570\u5bf9\u5b83\u4eec\u8d77\u4e0d\u5230\u4efb\u4f55\u4f5c\u7528\uff0c\u7a0b\u5e8f\u6b7b\u9501\uff0c\u5fc5\u7136\u5d29\u6e83 \u3002 \u5f53\u6bcf\u4e2a\u4e92\u65a5\u9501\u90fd\u53ea\u4fdd\u62a4\u4e00\u4e2a\u4e34\u754c\u533a\u6216\u8005\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a\u53ef\u4ee5\u6709\u6548\u907f\u514d\u6b7b\u9501\u3002","title":"\u4f7f\u7528\u4e92\u65a5\u9501\u6ce8\u610f\u4e8b\u9879"},{"location":"Language/Basic/17-sync/#_3","text":"Go\u8bed\u8a00\u4e2d\u7684\u4e92\u65a5\u9501\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u58f0\u660e\u4e00\u4e2a sync.Mutex \u7c7b\u578b\uff08\u8be5\u7c7b\u578b\u662f\u4e00\u4e2a \u7ed3\u6784\u4f53 \u7c7b\u578b\uff0c\u5c5e\u4e8e \u503c\u7c7b\u578b \uff09\u7684\u53d8\u91cf\u5c31\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u4e86\u3002 \u5bf9\u4e8e\u503c\u7c7b\u578b\u7684\u64cd\u4f5c\uff0c\u628a\u5b83\u4f20\u7ed9\u4e00\u4e2a\u51fd\u6570\uff0c\u5c06\u5b83\u4ece\u51fd\u6570\u4e2d\u8fd4\u56de\uff0c\u628a\u5b83\u8d4b\u7ed9\u5176\u4ed6\u53d8\u91cf\uff0c\u8ba9\u5b83\u8fdb\u5165\u67d0\u4e2a\u901a\u9053\u90fd\u4f1a\u5bfc\u81f4\u5b83\u7684\u526f\u672c\u7684\u4ea7\u751f\u3002 \u539f\u503c\u4e0e\u526f\u672c\u3001\u526f\u672c\u4e0e\u526f\u672c\u4e4b\u95f4\u90fd\u662f\u5b8c\u5168\u72ec\u7acb\u7684\uff0c\u5b83\u4eec\u90fd\u662f\u4e0d\u540c\u7684\u4e92\u65a5\u9501 \u3002 \u5982\u679c\u628a\u4e00\u4e2a\u4e92\u65a5\u9501\u4f5c\u4e3a\u53c2\u6570\u4ea7\u7ed9\u4e86\u4e00\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\u5bf9\u4f20\u5165\u7684\u9501\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u90fd\u4e0d\u4f1a\u5bf9\u5b58\u5728\u4e8e\u8be5\u51fd\u6570\u4e4b\u5916\u7684\u90a3\u4e2a\u539f\u9501\u4ea7\u751f\u4efb\u4f55\u7684\u5f71\u54cd\u3002","title":"\u4f20\u9012\u4e92\u65a5\u9501"},{"location":"Language/Basic/17-sync/#_4","text":"\u8bfb\u5199\u9501\u662f\u8bfb/\u5199\u4e92\u65a5\u9501\u7684\u7b80\u79f0\uff0c\u5728Go\u8bed\u8a00\u4e2d\uff0c\u8bfb\u5199\u9501\u7531 sync.RWMutex \u7c7b\u578b\u7684\u503c\u4ee3\u8868\uff0c\u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u3002 \u8bfb\u5199\u9501\u628a\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u533a\u522b\u5bf9\u5f85\uff0c\u53ef\u4ee5\u5bf9\u8fd9\u4e24\u79cd\u64cd\u4f5c\u65bd\u52a0\u4e0d\u540c\u7684\u4fdd\u62a4\u3002\u76f8\u6bd4\u4e8e\u4e92\u65a5\u9501\uff0c\u8bfb\u5199\u9501\u5b9e\u73b0\u66f4\u52a0\u7ec6\u7c92\u5ea6\u7684\u8bbf\u95ee\u63a7\u5236\u3002\u4e00\u4e2a\u8bfb\u5199\u9501\u4e2d\u5305\u542b\u4e24\u4e2a\u9501\uff1a \u5199\u9501\uff1a sync.RWMutex \u7c7b\u578b\u4e2d\u7684Lock\u65b9\u6cd5\u548cUnlock\u65b9\u6cd5\u5206\u522b\u7528\u4e8e\u5bf9\u5199\u9501\u8fdb\u884c\u9501\u5b9a\u548c\u89e3\u9501 \u8bfb\u9501\uff1a sync.RWMutex \u7c7b\u578b\u4e2d\u7684RLock\u65b9\u6cd5\u548cRUnlock\u65b9\u6cd5\u5206\u522b\u7528\u4e8e\u5bf9\u4e8e\u8bfb\u9501\u8fdb\u884c\u9501\u5b9a\u548c\u89e3\u9501 \u5bf9\u4e8e\u540c\u4e00\u4e2a\u8bfb\u5199\u9501\u6765\u8bf4\uff0c\u6709\u5982\u4e0b\u89c4\u5219\uff1a \u5728 \u5199\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u5199\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u5728 \u5199\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u8bfb\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u5728 \u8bfb\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u5199\u9501 \uff0c\u4f1a\u963b\u585e\u5f53\u524d\u7684goroutine \u5728 \u8bfb\u9501 \u5df2\u88ab\u9501\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u518d\u8bd5\u56fe\u9501\u5b9a \u8bfb\u9501 \uff0c\u4e0d\u4f1a\u963b\u585e\u5f53\u524dgoroutine \u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u6536\u5230\u8bfb\u5199\u9501\u5305\u542b\u7684\u5171\u4eab\u8d44\u6e90\uff1a \u591a\u4e2a\u5199\u64cd\u4f5c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c \u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c \u591a\u4e2a\u8bfb\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c \u901a\u5e38\u4e0d\u80fd\u540c\u65f6\u8fdb\u884c\u7684\u64cd\u4f5c\u79f0\u4e3a\u4e92\u65a5\u64cd\u4f5c \u3002 \u5bf9\u4e8e \u5199\u9501 \u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\uff0c\u4f1a\u5524\u9192 \u6240\u6709\u56e0\u8bd5\u56fe\u9501\u5b9a\u8bfb\u9501\u800c\u88ab\u963b\u585e\u7684goroutine \uff0c\u901a\u5e38\u4f1a\u4f7f\u5b83\u4eec\u90fd\u6210\u529f\u5b8c\u6210\u5bf9\u8bfb\u9501\u7684\u9501\u5b9a\u3002 \u5bf9\u4e8e \u8bfb\u9501 \u8fdb\u884c\u89e3\u9501\u64cd\u4f5c\uff0c\u53ea\u4f1a\u5728\u6ca1\u6709\u5176\u4ed6 \u8bfb\u9501 \u9501\u5b9a\u7684\u524d\u63d0\u4e0b\uff0c\u5524\u9192 \u56e0\u8bd5\u56fe\u9501\u5b9a\u5199\u9501\u800c\u88ab\u963b\u585e\u7684goroutine \uff0c\u5e76\u4e14\u6700\u7ec8\u53ea\u4f1a\u6709\u4e00\u4e2a\u88ab\u5524\u9192\u7684goroutine\uff08\u7b49\u5f85\u65f6\u95f4\u6700\u957f\u7684\u90a3\u4e2a\uff09\u6210\u529f\u5b8c\u6210\u5bf9 \u5199\u9501 \u7684\u9501\u5b9a\uff0c\u5176\u4ed6goroutine\u7ee7\u7eed\u7b49\u5f85\u3002 \u8bfb\u5199\u9501\u4e2d\u5bf9\u5199\u64cd\u4f5c\u4e4b\u95f4\u7684\u4e92\u65a5\u662f\u901a\u8fc7\u5185\u6db5\u7684\u4e00\u4e2a\u4e92\u65a5\u9501\u5b9e\u73b0\u7684 \uff0c\u5728Go\u8bed\u8a00\u4e2d\uff0c\u8bfb\u5199\u9501\u662f\u4e92\u65a5\u9501\u7684\u4e00\u79cd\u6269\u5c55\u3002","title":"\u8bfb\u5199\u9501\u4e0e\u4e92\u65a5\u9501\u7684\u533a\u522b"},{"location":"Language/Basic/17-sync/#_5","text":"\u4e92\u65a5\u9501\u5e38\u5e38\u88ab\u7528\u6765\u4fdd\u8bc1\u591a\u4e2agoroutine\u5e76\u53d1\u8bbf\u95ee\u540c\u4e00\u4e2a\u5171\u4eab\u8d44\u6e90\u65f6\u7684\u5b8c\u5168\u4e32\u884c\u3002 \u4e0d\u8981\u5fd8\u8bb0\u9501\u5b9a\u6216\u5fd8\u8bb0\u89e3\u9501\uff0c\u8fd9\u4f1a\u5bfc\u81f4goroutine\u7684\u963b\u585e\u751a\u81f3\u6b7b\u9501 \u4e0d\u8981\u4f20\u9012\u4e92\u65a5\u9501\uff0c\u8fd9\u4f1a\u4ea7\u751f\u5b83\u7684\u526f\u672c\uff0c\u4ece\u800c\u4ea7\u751f\u5947\u5f02\u6216\u8005\u5bfc\u81f4\u4e92\u65a5\u5931\u6548 \u8ba9\u6bcf\u4e00\u4e2a\u4e92\u65a5\u9501\u90fd\u53ea\u5305\u542b\u4e00\u4e2a\u4e34\u754c\u533a\uff0c\u6216\u4e00\u7ec4\u76f8\u5173\u4e34\u754c\u533a \u4e0d\u8981\u89e3\u9501\u672a\u9501\u5b9a\u7684\u9501\uff0c\u4f1a\u5f15\u53d1\u4e0d\u53ef\u6062\u590d\u7684panic","title":"\u603b\u7ed3"},{"location":"Language/Basic/17-sync/#synccond","text":"","title":"sync.Cond"},{"location":"Language/Basic/17-sync/#_6","text":"\u6761\u4ef6\u53d8\u91cf\u662f\u53e6\u4e00\u4e2a\u540c\u6b65\u5de5\u5177\uff0c\u5b83\u662f\u57fa\u4e8e\u4e92\u65a5\u9501\u7684\uff0c\u5b83\u4e0d\u662f\u7528\u6765\u5305\u542b\u4e34\u754c\u533a\u548c\u5171\u4eab\u8d44\u6e90 \u7684\uff0c\u800c\u662f\u7528\u4e8e \u534f\u8c03\u60f3\u8981\u8bbf\u95ee\u5171\u4eab\u8d44\u6e90\u7684\u90a3\u4e9b\u7ebf\u7a0b \u3002\u5f53\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b83\u53ef\u4ee5\u88ab\u7528\u6765\u901a\u77e5\u4e92\u65a5\u9501\u963b\u585e\u7684\u7ebf\u7a0b\u3002 \u6761\u4ef6\u53d8\u91cf\u7684\u521d\u59cb\u5316\u79bb\u4e0d\u5f00\u4e92\u65a5\u9501\uff0c\u5e76\u4e14\u5b83\u7684\u65b9\u6cd5\u6709\u7684\u4e5f\u662f\u57fa\u4e8e\u4e92\u65a5\u9501\u7684 \u3002 \u6761\u4ef6\u53d8\u91cf\u6709\u4e09\u4e2a\u65b9\u6cd5\uff1a \u7b49\u5f85\u901a\u77e5\uff08Wait\uff09\uff1a\u5728\u4e92\u65a5\u9501\u4fdd\u62a4\u4e0b\u8fdb\u884c \u5355\u53d1\u901a\u77e5\uff08signal\uff09\uff1a\u5728\u4e92\u65a5\u9501\u89e3\u9501\u540e\u8fdb\u884c \u5e7f\u64ad\u901a\u77e5\uff08broadcast\uff09\uff1a\u5728\u4e92\u65a5\u9501\u89e3\u9501\u540e\u8fdb\u884c var mailbox uint8 var lock sync.RWMutex // \u8bfb\u5199\u9501 sendCond := sync.NewCond( lock) // \u6761\u4ef6\u53d8\u91cf recvCond := sync.NewCond(lock.RLocker()) // \u6761\u4ef6\u53d8\u91cf // func NewCond(l Locker) *Cond \u8fd4\u56de\u5e26\u6709\u9501\u7684\u6761\u4ef6\u53d8\u91cf\u7684\u6307\u9488\u503c // goroutine 1 lock.Lock() // \u9501\u5b9a\u5199\u9501 for mailbox == 1 { // \u5982\u679c\u6709\u60c5\u62a5\u5c31\u7b49\u5f85 sendCond.Wait() // \u89e3\u9501\u5199\u9501\uff0c\u52a0\u5165\u901a\u77e5\u961f\u5217\uff0c\u963b\u585e\u5f53\u524d\u4ee3\u7801\u884c } mailbox = 1 // \u5982\u679c\u6ca1\u6709\u60c5\u62a5\u5c31\u653e\u5165\u60c5\u62a5\u30021\u8868\u793a\u653e\u5165\u60c5\u62a5 lock.Unlock() // \u89e3\u9501\u5199\u9501 recvCond.Signal() // \u53d1\u8d77\u901a\u77e5\u60c5\u62a5\u5df2\u7ecf\u653e\u597d // goroutine 2 lock.RLock() // \u9501\u5b9a\u8bfb\u9501 for mailbox == 0 { // \u5982\u679c\u6ca1\u6709\u60c5\u62a5\u5c31\u7b49\u5f85 recvCond.Wait() // \u89e3\u9501\u8bfb\u9501\uff0c\u52a0\u5165\u901a\u77e5\u961f\u5217\uff0c\u963b\u585e\u5f53\u524d\u4ee3\u7801\u884c } mailbox = 0 // \u5982\u679c\u6709\u60c5\u62a5\u5c31\u53d6\u51fa\u60c5\u62a5\u30020\u8868\u793a\u53d6\u51fa\u60c5\u62a5 lock.RUnlock() // \u89e3\u9501\u8bfb\u9501 sendCond.Signal() // \u53d1\u8d77\u901a\u77e5\u60c5\u62a5\u5df2\u7ecf\u53d6\u8d70 \u53ea\u8981\u6761\u4ef6\u4e0d\u6ee1\u8db3\uff0c\u5c31\u4f1a\u8c03\u7528wait\u65b9\u6cd5\uff0c\u9700\u8981\u53d1\u8d77\u901a\u77e5\u5c31\u8c03\u7528signal\u65b9\u6cd5\u3002\u4f7f\u7528\u6761\u4ef6\u53d8\u91cf\u5b9e\u73b0\u5355\u5411\u901a\u77e5\uff0c\u53cc\u5411\u901a\u77e5\u9700\u8981\u4e24\u4e2a\u6761\u4ef6\u53d8\u91cf\uff0c\u8fd9\u662f\u6761\u4ef6\u53d8\u91cf\u7684\u57fa\u672c\u4f7f\u7528\u89c4\u5219\u3002","title":"\u6761\u4ef6\u53d8\u91cf\u4e0e\u4e92\u65a5\u9501"},{"location":"Language/Basic/17-sync/#wait","text":"\u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u56db\u4ef6\u4e8b\u60c5\uff1a \u628a\u8c03\u7528\u5b83\u7684goroutine\uff08\u5373\u5f53\u524dgoroutine\uff09\u52a0\u5165\u5230\u5f53\u524d\u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\u961f\u5217\u4e2d \u89e3\u9501\u5f53\u524d\u7684\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u90a3\u4e2a\u4e92\u65a5\u9501\uff08 \u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u5728\u963b\u585e\u5f53\u524dgoroutine\u524d\uff0c\u4f1a\u89e3\u9501\u5b83\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\uff0c\u6240\u4ee5\u5728\u8c03\u7528Wait\u4e4b\u524d\uff0c\u5fc5\u987b\u5148\u9501\u5b9a\u4e92\u65a5\u9501\uff0c\u5426\u5219\u8c03\u7528Wait\u65b9\u6cd5\u4f1a\u5f15\u53d1\u4e0d\u53ef\u6062\u590d\u7684painc \u3002\uff09 \u5982\u679cWait\u65b9\u6cd5\u4e0d\u5148\u89e3\u9501\u4e92\u65a5\u9501\uff0c\u90a3\u4e48\u53ea\u4f1a\u6709\u4e24\u79cd\u540e\u679c\uff0c\u4e0d\u662f\u5f53\u524d\u7a0b\u5e8f\u56e0panic\u800c\u5d29\u6e83\uff0c\u5c31\u662f\u76f8\u5173\u7684goroutine\u5168\u9762\u963b\u585e\u3002 \u8ba9\u5f53\u524d\u7684goroutine\u5904\u4e8e\u7b49\u5f85\u72b6\u6001\uff0c\u7b49\u5230\u901a\u77e5\u5230\u6765\u65f6\u518d\u51b3\u5b9a\u662f\u5426\u5524\u9192\u5b83\uff0c\u6b64\u65f6\uff0c\u8fd9\u4e2agoroutine\u5c31\u4f1a\u963b\u585e\u5728\u8c03\u7528\u8fd9\u4e2aWait\u65b9\u6cd5\u7684\u90a3\u884c\u4ee3\u7801\u4e0a \u5982\u679c\u901a\u77e5\u5230\u6765\u5e76\u4e14\u51b3\u5b9a\u5524\u9192\u8fd9\u4e2agoroutine\uff0c\u90a3\u4e48\u5c31\u5728\u5524\u9192\u5b83\u4e4b\u540e\u91cd\u65b0\u9501\u5b9a\u5f53\u524d\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\uff0c\u81ea\u6b64\u4e4b\u540e\uff0c\u5f53\u524d\u7684goroutine\u5c31\u4f1a\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u4ee3\u7801\u4e86 \u9700\u8981\u4f7f\u7528for\u5faa\u73af\u5305\u88f9Wait\u65b9\u6cd5\u6765\u591a\u6b21\u68c0\u67e5\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\uff0c\u56e0\u4e3a\u5f53\u4e00\u4e2agoroutine\u6536\u5230\u901a\u77e5\u88ab\u5524\u9192\uff0c\u4f46\u5374\u53d1\u73b0\u5171\u4eab\u7ec4\u5458\u7684\u72b6\u6001\u4f9d\u7136\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u90a3\u4e48\u5e94\u8be5\u518d\u6b21\u8c03\u7528\u6761\u4ef6\u53d8\u91cfWait\u65b9\u6cd5\uff0c\u5e76\u7ee7\u7eed\u7b49\u5f85\u4e0b\u4e00\u6b21\u901a\u77e5\u7684\u5230\u6765\u3002\u4f8b\u5982\u4e0b\u9762\u7684\u60c5\u51b5\uff1a \u591a\u4e2agoroutine\u7b49\u5f85\u5171\u4eab\u8d44\u6e90\u7684\u540c\u4e00\u79cd\u72b6\u6001\u3002 \u5171\u4eab\u8d44\u6e90\u6709\u591a\u79cd\u72b6\u6001\uff0c\u5355\u4e00\u7684\u7ed3\u679c\u4e0d\u53ef\u80fd\u6ee1\u8db3\u6240\u4ee5goroutine\u7684\u6761\u4ef6\u3002 \u67d0\u4e9b\u591aCPU\u6838\u5fc3\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\u6d2a\uff0c\u6ca1\u6709\u6536\u5230\u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\uff0c\u8c03\u7528\u5176Wair\u65b9\u6cd5\u7684goroutine\u4e5f\u53ef\u80fd\u4f1a\u88ab\u5524\u9192\uff0c\u8fd9\u662f\u8ba1\u7b97\u673a\u786c\u4ef6\u5c42\u9762\u51b3\u5b9a\u7684\uff0c\u5373\u4f7f\u662f\u64cd\u4f5c\u7cfb\u7edf\u672c\u8eab\u63d0\u4f9b\u7684\u6761\u4ef6\u53d8\u91cf\u4e5f\u4f1a\u5982\u6b64\u3002 \u7efc\u4e0a\uff0c\u5728\u5305\u88f9\u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u65f6\uff0c\u603b\u662f\u5e94\u8be5\u4f7f\u7528for\u8bed\u53e5 \uff0c\u56e0\u4e3a\u7b49\u5f85\u901a\u77e5\u800c\u88ab\u963b\u585e\u7684goroutine\u53ef\u80fd\u4f1a\u5728\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u4e0d\u6ee1\u8db3\u5176\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\u88ab\u5524\u9192\u3002","title":"Wait\u65b9\u6cd5"},{"location":"Language/Basic/17-sync/#signalbroadcast","text":"\u5171\u540c\u70b9\uff1a\u90fd\u662f\u88ab\u7528\u6765\u53d1\u9001\u901a\u77e5\u7684 \u4e0d\u540c\u70b9\uff1a \u524d\u8005\u7684\u901a\u77e5\u53ea\u4f1a\u5524\u9192\u4e00\u4e2a\u56e0\u6b64\u800c\u7b49\u5f85\u7684goroutine \u6761\u4ef6\u53d8\u91cf\u7684Wait\u65b9\u6cd5\u603b\u662f\u4f1a\u628a\u5f53\u524dgoroutine\u6dfb\u52a0\u5230\u901a\u77e5\u961f\u5217\u7684\u961f\u5c3e\uff0c\u800csignal\u65b9\u6cd5\u603b\u4f1a\u4ece\u901a\u77e5\u961f\u5217\u7684\u961f\u9996\u5f00\u59cb\uff0c\u67e5\u627e\u53ef\u88ab\u5524\u9192\u7684goroutine\u3002\u56e0\u6b64\u4f1a\u5524\u9192\u6700\u65e9\u7b49\u5f85\u7684\u90a3\u4e00\u4e2a\u3002 \u540e\u8005\u7684\u901a\u77e5\u4f1a\u5524\u9192\u6240\u6709\u4e3a\u6b64\u7b49\u5f85\u7684goroutine \u8fd9\u4e24\u4e2a\u65b9\u6cd5\u7684\u884c\u4e3a\u51b3\u5b9a\u4e86\u5b83\u4eec\u7684\u4f7f\u7528\u573a\u666f\u3002 \u5982\u679c\u786e\u5b9a\u53ea\u6709\u4e00\u4e2agoroutine\u5728\u7b49\u5f85\uff0c\u6216\u8005\u53ea\u8bb8\u5524\u9192\u4efb\u610f\u4e00\u4e2agoroutine\u5c31\u53ef\u4ee5\u6ee1\u8db3\u8981\u6c42\uff0c\u90a3\u4e48\u4f7f\u7528Signal\u65b9\u6cd5\u3002 \u5426\u5219\uff0c\u4f7f\u7528Broadcast\u65b9\u6cd5\u603b\u6bcf\u6b21\uff0c\u53ea\u8981\u8bbe\u7f6e\u597d\u5404\u4e2agoroutine\u6240\u671f\u671b\u7684\u5171\u4eab\u8d44\u6e90\u72b6\u6001\u5373\u53ef\u3002 \u4e0eWait\u65b9\u6cd5\u4e0d\u540c\uff0cSignal\u65b9\u6cd5\u548cBroadcast\u65b9\u6cd5\u5e76\u4e0d\u9700\u8981\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\u8fdb\u884c \u3002\u6700\u597d\u5728\u89e3\u9501\u6761\u4ef6\u53d8\u91cf\u57fa\u4e8e\u7684\u4e92\u65a5\u9501\u4e4b\u540e\u5728\u8c03\u7528\u5b83\u4eec\u3002 \u8fd9\u66f4\u6709\u5229\u4e8e\u7a0b\u5e8f\u7684\u8fd0\u884c\u6548\u7387 \u3002 \u6761\u4ef6\u53d8\u91cf\u7684\u901a\u77e5\u5177\u6709\u5373\u65f6\u6027\uff0c\u5373\u5728\u53d1\u9001\u901a\u77e5\u7684\u65f6\u5019\u6ca1\u6709goroutine\u4e3a\u6b64\u7b49\u5f85\uff0c\u90a3\u4e48\u8be5\u901a\u77e5\u5c31\u4f1a\u88ab\u76f4\u63a5\u4e22\u5f03\u3002\u5728\u8fd9\u4e4b\u540e\u624d\u5f00\u59cb\u7b49\u5f85\u7684goroutine\u53ea\u53ef\u80fd\u88ab\u540e\u9762\u7684\u901a\u77e5\u5524\u9192\u3002 \u901a\u8fc7\u5bf9\u4e92\u65a5\u9501\u7684\u5408\u7406\u4f7f\u7528\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2agoroutine\u5728\u6267\u884c\u4e34\u754c\u533a\u4e2d\u7684\u4ee3\u7801\u65f6\uff0c\u4e0d\u88ab\u5176\u4ed6\u7684goroutine\u6253\u6270\u3002\u4e0d\u8fc7\uff0c\u867d\u7136\u4e0d\u4f1a\u88ab\u6253\u6270\uff0c\u4f46\u662f\u5b83\u4ecd\u7136\u53ef\u80fd\u4f1a\u88ab\u7ec8\u7aef\uff08interruption\uff09 \u3002","title":"Signal\u65b9\u6cd5\u4e0eBroadcast\u65b9\u6cd5\u7684\u533a\u522b"},{"location":"Language/Basic/17-sync/#syncwaitgroup-synconce","text":"\u4f7f\u7528\u901a\u9053\u8fdb\u884c\u591agoroutine\u534f\u4f5c\uff1a\u58f0\u660e\u4e00\u4e2a\u901a\u9053\uff0c\u4f7f\u5b83\u7684\u5bb9\u91cf\u4e0e\u624b\u52a8\u542f\u52a8\u7684goroutine\u7684\u6570\u91cf\u76f8\u540c\uff0c\u4e4b\u540e\u518d\u5229\u7528\u8fd9\u4e2a\u901a\u9053\uff0c\u8ba9\u4e3bgoroutine\u7b49\u5f85\u5176\u4ed6goroutine\u7684\u8fd0\u884c\u7ed3\u675f\u3002 func coordinateWithChan() { sign := make(chan struct{}, 2) num := int32(0) fmt.Printf( The number: %d [with chan struct{}]\\n , num) max := int32(10) go addNum( num, 1, max, func() { sign - struct{}{} }) go addNum( num, 2, max, func() { sign - struct{}{} }) -sign -sign } \u4ee5\u4e0a\u64cd\u4f5c\uff0c\u7565\u663e\u4e11\u964b\u3002 \u4f7f\u7528sync\u5305\u7684WaitGroup\u7c7b\u578b\uff0c\u5b83\u6bd4\u901a\u9053\u66f4\u52a0\u9002\u5408\u8fd9\u79cd\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\u3002 sync.WaitGroup \u5f00\u7bb1\u5373\u7528\uff0c\u5e76\u53d1\u5b89\u5168\uff0c\u540c\u6837\u7684\u5b83\u4e00\u65e6\u771f\u6b63\u88ab\u4f7f\u7528\uff0c\u5c31\u4e0d\u80fd\u518d\u88ab\u590d\u5236\u3002 WaitGroup\u6709\u4e09\u4e2a\u6307\u9488\u65b9\u6cd5\uff1a Add\uff1a\u53ef\u4ee5\u60f3\u8c61\u5728\u8be5\u7c7b\u578b\u4e2d\u6709\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u9ed8\u8ba4\u503c\u4e3a0\uff0c\u53ef\u4ee5\u8c03\u7528\u8be5\u503c\u7c7b\u578b\u7684Add\u65b9\u6cd5\u6765\u589e\u52a0\u6216\u8005\u51cf\u5c11\u8fd9\u4e2a\u8ba1\u6570\u5668\u7684\u503c\u3002\u4e00\u822c\u7528\u6765\u8bb0\u5f55\u7b49\u5f85\u7684goroutine\u7684\u6570\u91cf\u3002 Done\uff1a\u5bf9\u8ba1\u6570\u5668\u4e2d\u7684\u503c\u8fdb\u884c\u51cf\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5728\u9700\u8981\u7b49\u5f85\u7684goroutine\u4e2d\uff0c\u901a\u8fc7defer\u8bed\u53e5\u8c03\u7528\u5b83\u3002 Wait\uff1a\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u76f4\u5230\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u8ba1\u6570\u5668\u5f52\u96f6\u3002\u5982\u679c\u5728\u8be5\u65b9\u6cd5\u8c03\u7528\u7684\u65f6\u5019\uff0c\u8ba1\u6570\u5668\u7684\u503c\u5df2\u7ecf\u662f0\uff0c\u90a3\u4e48\u5c31\u4e0d\u505a\u4efb\u4f55\u4e8b\u60c5\u3002 \u5c06\u4e0a\u9762\u4ee3\u7801\u4fee\u6539\u4e3aWaitGroup\u7248\u672c\uff1a func coordinateWithWaitGroup() { var wg sync.WaitGroup wg.Add(2) num := int32(0) fmt.Printf( The number: %d [with sync.WaitGroup]\\n , num) max := int32(10) go addNum( num, 3, max, wg.Done) go addNum( num, 4, max, wg.Done) wg.Wait() }","title":"sync.WaitGroup \u548c sync.Once"},{"location":"Language/Basic/17-sync/#_7","text":"sync.WaitGroup \u7c7b\u578b\u503c\u4e2d\u8ba1\u6570\u5668\u7684\u503c \u4e0d\u80fd\u5c0f\u4e8e 0\u3002\u5982\u679c\u5c0f\u4e8e0\uff0c\u4f1a\u5f15\u53d1\u4e00\u4e2apanic\u3002\u4e0d\u9002\u5f53\u7684\u8c03\u7528Done\u65b9\u6cd5\u548cAdd\u65b9\u6cd5\u90fd\u4f1a\u5f15\u8d77\u8fd9\u4e2a\u95ee\u9898\uff0c\u56e0\u4e3a\u5728Add\u65b9\u6cd5\u4e2d\u53ef\u4ee5\u4f20\u5165\u4e00\u4e2a\u8d1f\u6570\u3002 \u5982\u679c\u540c\u65f6\u8c03\u7528Add\u65b9\u6cd5\u548cWait\u65b9\u6cd5\uff0c\u5047\u8bbe\u5728\u4e24\u4e2agoroutine\u4e2d\uff0c\u5206\u522b\u8c03\u7528\u8fd9\u4e24\u4e2a\u65b9\u6cd5\uff0c \u90a3\u4e48\u5c31\u53ef\u80fd\u4f1a\u8ba9\u8fd9\u4e2aAdd\u65b9\u6cd5\u629b\u51fapanic \u3002\u8fd9\u79cd\u60c5\u51b5\u4e0d\u5bb9\u6613\u590d\u73b0\uff0c\u867d\u7136WaitGroup\u503c\u672c\u8eab\u5e76\u4e0d\u9700\u8981\u521d\u59cb\u5316\uff0c\u4f46\u662f\u5c3d\u65e9\u589e\u52a0\u5176\u8ba1\u6570\u5668\u7684\u503c\uff0c\u662f\u975e\u5e38\u6709\u5fc5\u8981\u7684\u3002 WaitGroup\u503c\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u4f46\u662f\u9700\u8981\u4fdd\u8bc1\u5176\u8ba1\u6570\u5468\u671f\u7684\u5b8c\u6574\u6027\u3002\u5728WaitGroup\u503c\u7684\u751f\u547d\u5468\u671f\u4e2d\uff0c\u5b83\u53ef\u4ee5\u7ecf\u5386\u4efb\u610f\u591a\u4e2a\u8ba1\u6570\u5468\u671f\u3002 \u4f46\u662f\u53ea\u6709\u5728\u5b83\u8d70\u5b8c\u5f53\u524d\u7684\u8ba1\u6570\u5468\u671f\u4e4b\u540e\uff0c\u624d\u80fd\u591f\u5f00\u59cb\u4e0b\u4e00\u4e2a\u8ba1\u6570\u5468\u671f \u3002 \u8ba1\u6570\u5468\u671f\uff1aWaitGroup\u503c\u4e2d\u7684\u8ba1\u6570\u5668\u503c\u67090\u53d8\u4e3a\u67d0\u4e2a\u6b63\u6574\u6570\uff0c\u7136\u540e\u7ecf\u8fc7\u4e00\u7cfb\u5217\u7684\u53d8\u5316\uff0c\u6700\u7ec8\u7531\u67d0\u4e2a\u6b63\u6574\u6570\u53c8\u53d8\u56de0\u3002 \u56e0\u6b64\uff0c\u5982\u679c\u67d0\u4e2aWaitGroup\u503c\u7684Wait\u65b9\u6cd5\u5728\u67d0\u4e2a\u8ba1\u6570\u5468\u671f\u4e2d\u88ab\u8c03\u7528\uff0c\u4f1a\u7acb\u5373\u963b\u585e\u5f53\u524d\u7684goroutine\uff0c\u76f4\u5230\u8fd9\u4e2a\u8ba1\u6570\u5468\u671f\u5b8c\u6210\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8be5\u503c\u7684\u4e0b\u4e00\u4e2a\u8ba1\u6570\u5468\u671f\u5fc5\u987b\u7b49\u5230Wait\u65b9\u6cd5\u6267\u884c\u7ed3\u675f\u4e4b\u540e\uff0c\u624d\u80fd\u591f\u5f00\u59cb \u3002 \u5982\u679c\u5728\u4e00\u4e2a\u6b64\u7c7b\u503c\u7684Wait\u65b9\u6cd5\u88ab\u6267\u884c\u671f\u95f4\uff0c\u8de8\u8d8a\u4e86\u4e24\u4e2a\u8ba1\u6570\u5468\u671f\uff0c \u4f1a\u5f15\u53d1\u4e00\u4e2apanic \u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a \u5728\u5f53\u524dgoroutine\u56e0\u8c03\u7528WaitGroup\u503c\u7684Wait\u65b9\u6cd5\uff0c\u800c\u88ab\u963b\u585e\u7684\u65f6\u5019 \u53e6\u4e00\u4e2agoroutine\u8c03\u7528\u8be5\u503c\u7684Done\u65b9\u6cd5\uff0c\u5e76\u4f7f\u8ba1\u6570\u5668\u7684\u503c\u53d8\u4e3a0 \u8fd9\u4f1a\u5524\u9192\u5f53\u524d\u7684goroutine\uff0c\u5e76\u4f7f\u5b83\u8bd5\u56fe\u7ee7\u7eed\u6267\u884cWait\u65b9\u6cd5\u4e2d\u5176\u4f59\u7684\u4ee3\u7801 \u8fd9\u65f6\u53c8\u6709\u4e00\u4e2agoroutine\u8c03\u7528\u4e86\u5b83\u7684Add\u65b9\u6cd5\uff0c\u5e76\u8ba9\u8ba1\u6570\u5668\u7684\u503c\u53c8\u4ece0\u53d8\u6210\u4e86\u67d0\u4e2a\u6b63\u6574\u6570 \u6b64\u65f6\uff0c\u8fd9\u91cc\u7684Wait\u65b9\u6cd5\u5c31\u4f1a\u7acb\u5373\u629b\u51fa\u4e00\u4e2apanic WaitGroup\u4f7f\u7528\u7981\u5fcc \uff1a\u4e0d\u8981\u628a\u589e\u52a0\u8ba1\u6570\u5668\u503c\u7684\u64cd\u4f5c\u548c\u8c03\u7528Wait\u65b9\u6cd5\u7684\u4ee3\u7801\uff0c\u653e\u5728\u4e0d\u540c\u7684goroutine\u4e2d\u6267\u884c\u3002 \u675c\u7edd\u540c\u4e00\u4e2aWaitGroup\u503c\u7684\u4e24\u79cd\u64cd\u4f5c\u7684\u5e76\u53d1\u6267\u884c \u3002","title":"\u6ce8\u610f\u70b9"},{"location":"Language/Basic/17-sync/#synconcedo","text":"\u4e0e sync.WaitGroup \u7c7b\u578b\u4e00\u6837\uff0c sync.Once \u7c7b\u578b\u4e5f\u5c5e\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u540c\u6837\u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u548c\u5e76\u53d1\u5b89\u5168\u7684\u3002\u7531\u4e8e\u8fd9\u4e2a\u7c7b\u578b\u4e2d\u5305\u542b\u4e86\u4e00\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u6240\u4ee5\u590d\u5236\u8be5\u7c7b\u578b\u7684\u503c\u4e5f\u4f1a\u5bfc\u81f4\u529f\u80fd\u7684\u5931\u6548\u3002 Once\u7c7b\u578b\u7684Do\u65b9\u6cd5\u53ea\u63a5\u53d7\u4e00\u4e2a\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662ffunc()\uff0c\u5373\uff1a\u65e0\u53c2\u6570\u58f0\u660e\u548c\u7ed3\u679c\u58f0\u660e\u7684\u51fd\u6570\u3002\u8be5\u65b9\u6cd5\u7684\u529f\u80fd\u5e76\u4e0d\u662f\u5bf9\u6bcf\u4e00\u79cd\u53c2\u6570\u51fd\u6570\u90fd\u53ea\u6267\u884c\u4e00\u6b21\uff0c\u800c\u662f\u53ea\u6267\u884c\u9996\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u90a3\u4e2a\u51fd\u6570\uff0c\u5e76\u4e14\u4e4b\u540e\u4e0d\u4f1a\u518d\u6267\u884c\u4efb\u4f55\u53c2\u6570\u51fd\u6570\u3002\u5982\u679c\u6709\u591a\u4e2a\u53ea\u9700\u6267\u884c\u4e00\u6b21\u7684\u51fd\u6570\uff0c\u4e3a\u5b83\u4eec\u6bcf\u4e2a\u90fd\u5206\u914d\u4e00\u4e2a sync.Once \u7c7b\u578b\u7684\u503c\u3002 Once\u7c7b\u578b\u4e2d\u8fd8\u6709\u4e00\u4e2a\u53ebdone\u7684unit32\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u5b83\u7684\u4f5c\u7528\u662f\u8bb0\u5f55\u5176\u6240\u5c5e\u503c\u7684Do\u65b9\u6cd5\u88ab\u8c03\u7528\u7684\u6b21\u6570\uff0c\u8be5\u503c\u53ea\u80fd\u662f0\u6216\u80051\u3002\u4e00\u65e6Do\u65b9\u6cd5\u7684\u9996\u6b21\u8c03\u7528\u5b8c\u6210\uff0c\u5b83\u7684\u503c\u5c31\u4f1a\u4ece0\u53d8\u62101\u3002 done\u5b57\u6bb5\u867d\u7136\u53ea\u67090\u6216\u80051\uff0c\u4f46\u662f\u4f7f\u7528\u4e86\u56db\u5b57\u8282\u7684uint32\u7c7b\u578b\uff1a \u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u7684\u64cd\u4f5c\u5fc5\u987b\u662f\u539f\u5b50\u7684\uff0cDo\u65b9\u6cd5\u5728\u4e00\u5f00\u59cb\u5c31\u4f1a\u901a\u8fc7\u8c03\u7528 atomic.LoadUint32 \u51fd\u6570\u6765\u83b7\u53d6\u8be5\u5b57\u6bb5\u7684\u503c\uff0c\u5e76\u4e14\u4e00\u70b9\u53d1\u73b0\u8be5\u503c\u4e3a1\uff0c\u5c31\u76f4\u63a5\u8fd4\u56de\u3002 \u521d\u6b65\u4fdd\u8bc1\u4e86Do\u65b9\u6cd5\uff0c\u53ea\u4f1a\u6267\u884c\u9996\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u51fd\u6570 \u3002 \u5982\u679c\u4e24\u4e2agoroutine\u90fd\u8c03\u7528\u4e86\u540c\u4e00\u4e2a\u65b0\u7684Once\u7684Do\u65b9\u6cd5\uff0c\u51e0\u4e4e\u540c\u65f6\u6267\u884c\u6761\u4ef6\u5224\u65ad\u4ee3\u7801\uff0c\u90a3\u4e48\u4f1a\u56e0\u4e3a\u5224\u65ad\u7ed3\u679c\u4e3afalse\u800c\u7ee7\u7eed\u6267\u884cDo\u65b9\u6cd5\u4e2d\u5269\u4f59\u7684\u4ee3\u7801\u3002 \u6240\u4ee5\u5728\u6761\u4ef6\u5224\u65ad\u4e4b\u540e\uff0cDo\u65b9\u6cd5\u4f1a\u7acb\u5373\u6240\u52a8\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u90a3\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5m\uff0c\u7136\u540e\uff0c\u5b83\u4f1a\u5728\u4e34\u754c\u533a\u4e2d\u518d\u6b21\u68c0\u67e5done\u5b57\u6bb5\u7684\u503c\uff0c\u5e76\u4e14\u4ec5\u5728\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u624d\u4f1a\u53bb\u8c03\u7528\u53c2\u6570\u51fd\u6570\uff0c\u4ee5\u53ca\u7528\u539f\u5b50\u64cd\u4f5c\u628adone\u7684\u503c\u53d8\u4e3a1\u3002","title":"sync.Once\u7c7b\u578b\u503c\u7684Do\u65b9\u6cd5\u5982\u4f55\u4fdd\u8bc1\u53ea\u6267\u884c\u53c2\u6570\u51fd\u6570\u4e00\u6b21"},{"location":"Language/Basic/17-sync/#do","text":"Do\u65b9\u6cd5\u53ea\u4f1a\u5728\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u4e4b\u540e\u628adone\u5b57\u6bb5\u7684\u503c\u53d8\u4e3a1\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u9700\u8981\u5f88\u957f\u65f6\u95f4\u6216\u8005\u6839\u672c\u5c31\u4e0d\u4f1a\u7ed3\u675f\uff08\u6bd4\u5982\u6267\u884c\u4e00\u4e9b\u5b88\u62a4\u4efb\u52a1\uff09\uff0c\u90a3\u4e48\u5c31\u6709\u53ef\u80fd\u4f1a\u5bfc\u81f4\u76f8\u5173goroutine\u7684\u540c\u65f6\u963b\u585e\u3002 Do\u65b9\u6cd5\u5728\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u540e\uff0c\u5bf9done\u5b57\u6bb5\u7684\u590d\u5236\u7528\u7684\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u5e76\u4e14\uff0c\u8fd9\u4e00\u64cd\u4f5c\u662f\u88ab\u6302\u5728defer\u8bed\u53e5\u4e2d\u7684\uff0c\u56e0\u6b64\uff0c\u4e0d\u8bba\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u4f1a\u4ee5\u600e\u6837\u7684\u65b9\u5f0f\u7ed3\u675f\uff0cdone\u5b57\u6bb5\u7684\u503c\u90fd\u4f1a\u53d8\u4e3a1\u3002\u5373\u4f7f\u8fd9\u4e2a\u53c2\u6570\u51fd\u6570\u6ca1\u6709\u6267\u884c\u6210\u529f\uff08\u5f15\u53d1\u4e86\u4e00\u4e2apanic\uff09\uff0c\u6211\u4eec\u4e5f\u65e0\u6cd5\u4f7f\u7528\u540c\u4e00\u4e2aonce\u503c\u91cd\u65b0\u6267\u884c\u5b83\u3002\u5982\u679c\u9700\u8981\u4e3a\u53c2\u6570\u51fd\u6570\u7684\u6267\u884c\u8bbe\u5b9a\u91cd\u8bd5\u673a\u5236\uff0c\u8981\u8003\u8651Once\u503c\u7684\u9002\u65f6\u66ff\u6362\u95ee\u9898\u3002","title":"Do\u65b9\u6cd5\u5728\u529f\u80fd\u65b9\u9762\u7684\u7279\u70b9"},{"location":"Language/Basic/17-sync/#_8","text":"sync\u5305\u4e2d\u7684WaitGroup\u7c7b\u578b\u548cOnce\u7c7b\u578b\u90fd\u662f\u975e\u5e38\u6613\u7528\u7684\u540c\u6b65\u5de5\u5177\u3002\u5b83\u4eec\u90fd\u662f\u5f00\u7bb1\u5373\u7528\u548c\u5e76\u53d1\u5b89\u5168\u7684\u3002 \u5229\u7528WaitGroup\u503c\uff0c\u53ef\u4ee5\u65b9\u4fbf\u5730\u5b9e\u73b0\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\uff0c\u5373\uff1a\u4e00\u4e2a\u5206\u53d1\u5b50\u4efb\u52a1\u7684goroutine\u548c\u591a\u4e2a\u6267\u884c\u5b50\u4efb\u52a1\u7684goroutine\uff0c\u5171\u540c\u6765\u5b8c\u6210\u4e00\u4e2a\u8f83\u5927\u7684\u4efb\u52a1\u3002 \u4f7f\u7528WaitGroup\u503c\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u5343\u4e07\u4e0d\u80fd\u8ba9\u5176\u4e2d\u7684\u8ba1\u6570\u5668\u7684\u503c\u5c0f\u4e8e0\uff0c\u5426\u5219\u5c31\u4f1a\u5f15\u53d1panic \u3002\u6211\u4eec\u6700\u597d\u7528\u201c \u5148\u7edf\u4e00Add\uff0c\u518d\u5e76\u53d1Done\uff0c\u6700\u540eWait \u201d\u8fd9\u79cd\u6807\u51c6\u65b9\u5f0f\uff0c\u6765\u4f7f\u7528WaitGroup\u503c\u3002\u5c24\u5176\u4e0d\u8981\u5728\u8c03\u7528Wait\u65b9\u6cd5\u540c\u65f6\uff0c\u5e76\u53d1\u5730\u901a\u8fc7\u8c03\u7528Add\u65b9\u6cd5\u53bb\u589e\u52a0\u5176\u8ba1\u6570\u5668\u7684\u503c\uff0c\u56e0\u4e3a\u8fd9\u4e5f\u6709\u53ef\u80fd\u5f15\u53d1panic\u3002 Once\u503c\u7684\u4f7f\u7528\u6bd4WaitGroup\u503c\u66f4\u7b80\u5355\uff0c\u53ea\u6709\u4e00\u4e2aDo\u65b9\u6cd5\uff0c\u540c\u4e00\u4e2aOnce\u503c\u7684Do\u65b9\u6cd5\u6c38\u8fdc\u53ea\u4f1a\u6267\u884c\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\u65f6\u4f20\u5165\u7684\u53c2\u6570\u51fd\u6570\uff0c\u4e0d\u8bba\u8fd9\u4e2a\u51fd\u6570\u7684\u6267\u884c\u4f1a\u4ee5\u600e\u4e48\u6837\u7684\u65b9\u5f0f\u7ed3\u675f\u3002 \u53ea\u8981\u4f20\u5165\u67d0\u4e2aDo\u65b9\u6cd5\u7684\u53c2\u6570\u51fd\u6570\u6ca1\u6709\u7ed3\u675f\u6267\u884c\uff0c\u4efb\u4f55\u53ea\u4f1a\u8c03\u7528\u8be5\u65b9\u6cd5\u7684goroutine\u5c31\u4f1a\u88ab\u963b\u585e\u3002\u53ea\u6709\u5728\u8fd9\u4e2a\u53c2\u6570\u51fd\u6570\u6267\u884c\u7ed3\u675f\u4e00\u4f1a\uff0c\u90a3\u4e9bgoroutine\u624d\u4f1a\u9010\u4e00\u88ab\u5524\u9192\u3002 Once\u7c7b\u578b\u4f7f\u7528\u4e92\u65a5\u9501\u548c\u539f\u5b50\u64cd\u4f5c\u5b9e\u73b0\u4e86\u529f\u80fd\uff0c\u800cWaitGroup\u7c7b\u578b\u4e2d\u53ea\u7528\u5230\u4e86\u539f\u5b50\u64cd\u4f5c\u3002\u5b83\u4eec\u90fd\u662f\u66f4\u9ad8\u7ea7\u7684\u540c\u6b65\u5de5\u5177\uff0c\u57fa\u4e8e\u57fa\u672c\u7684\u901a\u7528\u5de5\u5177\uff0c\u5b9e\u73b0\u4e86\u67d0\u4e00\u79cd\u7279\u5b9a\u7684\u529f\u80fd\u3002 sync\u5305\u4e2d\u7684\u5176\u4ed6\u9ad8\u7ea7\u540c\u6b65\u5de5\u5177\uff0c\u90fd\u662f\u8fd9\u6837\u5b9e\u73b0\u7684 \u3002","title":"\u5c0f\u7ed3"},{"location":"Language/Basic/17-sync/#syncpool","text":"sync.Pool \u7c7b\u578b\uff08\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u5b83\u7684\u503c\u88ab\u771f\u6b63\u4f7f\u7528\u4e4b\u540e\uff0c\u5c31\u4e0d\u5e94\u518d\u88ab\u590d\u5236\u4e86\uff09\u88ab\u6210\u4e3a\u4e34\u65f6\u5bf9\u8c61\u5b58\u50a8\u6c60\uff0c\u5b83\u7684\u503c\u53ef\u4ee5\u88ab\u7528\u6765\u5b58\u50a8\u4e34\u65f6\u7684\u5bf9\u8c61\u3002 \u4e34\u65f6\u5bf9\u8c61\u7684\u610f\u601d\u662f\uff1a \u4e0d\u9700\u8981\u6301\u4e45\u4f7f\u7528\u7684\u67d0\u4e00\u7c7b\u503c\uff0c\u8fd9\u7c7b\u503c\u5bf9\u4e8e\u7a0b\u5e8f\u6765\u8bf4\u53ef\u6709\u53ef\u65e0\uff0c\u5982\u679c\u6709\u7684\u8bdd\u4f1a\u660e\u663e\u66f4\u597d \u5b83\u7684\u521b\u5efa\u548c\u9500\u6bc1\u53ef\u4ee5\u5728\u4efb\u4f55\u65f6\u5019\u53d1\u751f\uff0c\u5e76\u4e14\u5b8c\u5168\u4e0d\u4f1a\u5f71\u54cd\u5230\u7a0b\u5e8f\u7684\u529f\u80fd \u5b83\u4eec\u65e0\u9700\u88ab\u533a\u5206\uff0c\u5176\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u503c\u90fd\u53ef\u4ee5\u66ff\u4ee3\u53e6\u4e00\u4e2a \u5982\u679c\u67d0\u7c7b\u4e4b\u5b8c\u5168\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u5c31\u53ef\u4ee5\u628a\u5b83\u4eec\u5b58\u50a8\u5230\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u3002 \u53ef\u4ee5\u628a\u4e34\u65f6\u5bf9\u8c61\u6c60\u5f53\u4f5c\u9488\u5bf9\u67d0\u79cd\u6570\u636e\u7684\u7f13\u5b58\u6765\u7528 \uff0c\u8fd9\u662f\u4e34\u65f6\u5bf9\u8c61\u6c60\u6700\u4e3b\u8981\u7684\u7528\u9014\u3002 sync.Pool \u7c7b\u578b\u53ea\u6709\u4e24\u4e2a\u65b9\u6cd5\uff1a func (p *Pool) Put(x interface{}) func (p *Pool) Get() interface{} Put\uff1a\u7528\u4e8e\u5728\u5f53\u524d\u7684\u6c60\u4e2d\u5b58\u653e\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b83\u63a5\u6536\u4e00\u4e2ainterface{}\u7c7b\u578b\u7684\u53c2\u6570 Get\uff1a\u7528\u4e8e\u4ece\u5f53\u524d\u7684\u6c60\u4e2d\u83b7\u53d6\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2ainterface{}\u7c7b\u578b\u7684\u503c\uff1b Get\u53ef\u80fd\u4f1a\u4ece\u5f53\u524d\u6c60\u4e2d\u5220\u9664\u6389\u4efb\u4f55\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u628a\u8fd9\u4e2a\u503c\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002\u5982\u679c\u6b64\u65f6\u6c60\u4e2d\u6ca1\u6709\u4efb\u4f55\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u4f1a\u4f7f\u7528\u5f53\u524d\u6c60\u7684New\u5b57\u6bb5\u521b\u5efa\u4e00\u4e2a\u503c\uff0c\u5e76\u76f4\u63a5\u5c06\u5176\u8fd4\u56de\u3002 sync.Pool \u7c7b\u578b\u7684New\u5b57\u6bb5\u4ee3\u8868\u8fd9\u521b\u5efa\u4e34\u65f6\u5bf9\u8c61\u7684\u51fd\u6570\uff0c\u5b83\u7684\u7c7b\u578b\u662f\u6ca1\u6709\u53c2\u6570\u4f46\u6709\u552f\u4e00\u7ed3\u679c\u7684\u51fd\u6570\u7c7b\u578b\uff1a type Pool struct { // \u8fd9\u4e2a\u51fd\u6570\u662fGet\u65b9\u6cd5\u6700\u540e\u7684\u4e34\u65f6\u5bf9\u8c61\u83b7\u53d6\u624b\u6bb5 // \u8be5\u51fd\u6570\u7684\u7ed3\u679c\u503c\u5e76\u4e0d\u4f1a\u5b58\u5165\u5f53\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\u4e2d // \u800c\u662f\u76f4\u63a5\u8fd4\u56de\u7ed9Get\u65b9\u6cd5\u7684\u8c03\u7528\u65b9 New func() interface{} // contains filtered or unexported fields } \u8fd9\u91ccNew\u5b57\u6bb5\u7684\u5b9e\u9645\u503c\u9700\u8981\u6211\u4eec\u5728\u521d\u59cb\u5316\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u65f6\u5019\u7ed9\u5b9a\u3002\u5426\u5219\uff0c\u5728\u8c03\u7528\u5b83\u7684Get\u65b9\u6cd5\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u5f97\u5230nil\u3002 sync.Pool \u7c7b\u578b\u5e76\u975e\u5f00\u7bb1\u5373\u7528\uff0c\u8fd9\u4e2a\u7c7b\u578b\u53ea\u6709\u8fd9\u4e00\u4e2a\u516c\u5f00\u5b57\u6bb5\u3002","title":"sync.Pool"},{"location":"Language/Basic/17-sync/#_9","text":"\u6807\u51c6\u5e93fmt\u4e2d\u4f7f\u7528 sync.Pool \u7c7b\u578b\uff0c\u8fd9\u4e2a\u5305\u4f1a\u521b\u5efa\u4e00\u4e2a\u7528\u4e8e\u7f13\u5b58\u67d0\u7c7b\u4e34\u65f6\u5bf9\u8c61\u7684 sync.Pool \u7c7b\u578b\u503c\uff0c\u5e76\u5c06\u8fd9\u4e2a\u503c\u8d4b\u7ed9ppFree\u53d8\u91cf\uff0c\u8fd9\u4e2a\u4e34\u65f6\u5bf9\u8c61\u53ef\u4ee5\u7528\u4e8e\u8bc6\u522b\u3001\u683c\u5f0f\u5316\u548c\u6682\u5b58\u9700\u8981\u6253\u5370\u7684\u5185\u5bb9\uff1a var ppFree = sync.Pool{ New: func() interface{} { return new(pp) }, } // ppFree\u7684New\u5b57\u6bb5\u5728\u88ab\u8c03\u7528\u7684\u65f6\u5019\uff0c\u603b\u662f\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7684pp\u7c7b\u578b\u503c\u7684\u6307\u9488\uff08\u5373\u4e34\u65f6\u5bf9\u8c61\uff09 // \u8fd9\u4fdd\u8bc1\u4e86ppFree\u7684Get\u65b9\u6cd5\u603b\u80fd\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u5305\u542b\u9700\u8981\u6253\u5370\u5185\u5bb9\u7684\u503c // pp\u7c7b\u578b\u662ffmt\u5305\u4e2d\u7684\u79c1\u6709\u7c7b\u578b\uff0c\u5b83\u7684\u6bcf\u4e00\u4e2a\u503c\u5728\u8fd9\u91cc\u90fd\u662f\u72ec\u7acb\u3001\u5e73\u7b49\u3001\u53ef\u91cd\u7528\u7684 \u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u65e2\u4e92\u4e0d\u5e72\u6270\uff0c\u53c8\u4e0d\u4f1a\u53d7\u5230\u5916\u90e8\u72b6\u6001\u7684\u5f71\u54cd\u3002\u5b83\u4eec\u51e0\u4e4e\u53ea\u9488\u5bf9\u67d0\u4e2a\u9700\u8981\u6253\u5370\u5185\u5bb9\u7684\u7f13\u51b2\u533a\u3002\u7531\u4e8efmt\u5305\u4e2d\u7684\u4ee3\u7801\u5728\u771f\u6b63\u4f7f\u7528\u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u4e4b\u524d\uff0c\u603b\u662f\u4f1a\u5bf9\u5176\u8fdb\u884c\u91cd\u7f6e\uff0c\u6240\u4ee5\u5b83\u4eec\u5e76\u4e0d\u5728\u610f\u53d6\u5230\u54ea\u4e2a\u4e34\u65f6\u5bf9\u8c61\u3002 \u8fd9\u5c31\u662f\u4e34\u65f6\u5bf9\u8c61\u7684\u5e73\u7b49\u6027\u7684\u5177\u4f53\u4f53\u73b0 \u3002 \u8fd9\u4e9b\u4ee3\u7801\u5728\u4f7f\u7528\u5b8c\u4e34\u65f6\u5bf9\u8c61\u540e\uff0c\u90fd\u4f1a\u5148\u62b9\u6389\u5176\u4e2d\u5df2\u7f13\u51b2\u7684\u5185\u5bb9\uff0c\u7136\u540e\u518d\u628a\u5b83\u5b58\u653e\u5230ppFree\u4e2d\u3002\u8fd9\u6837\u5c31\u4e3a\u91cd\u7528\u8fd9\u7c7b\u4e34\u65f6\u5bf9\u8c61\u505a\u597d\u4e86\u51c6\u5907\u3002 fmt.Println \u3001 fmt.Printf \u7b49\u6253\u5370\u51fd\u6570\u90fd\u662f\u8fd9\u6837\u4f7f\u7528ppFree\uff0c\u4ee5\u53ca\u5176\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61\u3002\u56e0\u6b64\u7a0b\u5e8f\u540c\u65f6\u6267\u884c\u5f88\u591a\u6253\u5370\u51fd\u6570\u8c03\u7528\u7684\u65f6\u5019\uff0cppFree\u53ef\u4ee5\u53ca\u65f6\u5730\u628a\u5b83\u7f13\u5b58\u7684\u4e34\u65f6\u5bf9\u8c61\u63d0\u4f9b\u7ed9\u5b83\u4eec\uff0c\u4ee5\u52a0\u5feb\u6267\u884c\u7684\u901f\u5ea6\u3002\u5f53\u7a0b\u5e8f\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u4e0d\u518d\u6267\u884c\u6253\u5370\u51fd\u6570\uff0cppFree\u4e2d\u7684\u4e34\u65f6\u5bf9\u8c61\u6709\u80fd\u591f\u88ab\u53ca\u65f6\u5730\u6e05\u7406\uff08\u5783\u573e\u56de\u6536\u671f\uff0c\u5728\u6bcf\u6b21\u5f00\u59cb\u6267\u884c\u94b1\uff0c\u5bf9\u6240\u6709\u521b\u5efa\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u503c\u8fdb\u884c\u5168\u9762\u5730\u6e05\u9664\uff09\uff0c\u4ee5\u8282\u7701\u5185\u5b58\u7a7a\u95f4\u3002\u5728\u8fd9\u4e2a\u7ef4\u5ea6\u4e0a\uff0c\u4e34\u65f6\u5bf9\u8c61\u6c60\u53ef\u4ee5\u5e2e\u52a9\u7a0b\u5e8f\u5b9e\u73b0\u53ef\u4f38\u7f29\u6027\u3002","title":"\u4f8b\u5b50"},{"location":"Language/Basic/17-sync/#_10","text":"sync\u5305\u5728\u88ab\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u4f1a\u5411Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u6ce8\u518c\u4e00\u4e2a\u51fd\u6570\uff08 \u6c60\u6e05\u7406\u51fd\u6570 \uff09\uff0c\u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u5c31\u662f\u6e05\u9664\u6240\u6709\u5df2\u521b\u5efa\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u503c\uff0c\u8fd9\u6837Go\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u5728\u6267\u884c\u5783\u573e\u56de\u6536\u4e4b\u524d\u4f1a\u5148\u6267\u884c\u6c60\u6e05\u7406\u51fd\u6570\u3002 sync\u5305\u4e2d\u6709\u4e00\u4e2a\u5305\u7ea7\u79c1\u6709\u7684\u5168\u5c40\u53d8\u91cf\uff08 \u6c60\u6c47\u603b\u5217\u8868 \uff09\uff0c\u8fd9\u4e2a\u53d8\u91cf\u4ee3\u8868\u4e86\u5f53\u524d\u7684\u7a0b\u5e8f\u4e2d\u4f7f\u7528\u7684\u6240\u6709\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u6c47\u603b\uff0c\u5b83\u662f\u5143\u7d20\u7c7b\u578b\u4e3a *sync.Pool \u7684\u5207\u7247\u3002 \u5728\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u65b9\u6cd5\u548cGet\u65b9\u6cd5\u7b2c\u4e00\u6b21\u88ab\u8c03\u7528\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u6c60\u5c31\u4f1a\u88ab\u6dfb\u52a0\u5230\u6c60\u6c47\u603b\u5217\u8868\u4e2d\u3002\u56e0\u6b64\uff0c\u6c60\u6e05\u7406\u51fd\u6570\u603b\u662f\u80fd\u8bbf\u95ee\u5230\u6240\u6709\u6b63\u5728\u88ab\u771f\u6b63\u4f7f\u7528\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u3002\u5373\uff1a \u6c60\u6e05\u7406\u51fd\u6570\u4f1a\u904d\u5386\u6c60\u6c47\u603b\u5217\u8868\uff0c\u5bf9\u4e8e\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\uff0c\u90fd\u4f1a\u5148\u5c06\u6c60\u4e2d\u6240\u6709\u7684\u79c1\u6709\u4e34\u65f6\u5bf9\u8c61\u548c\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u7f6e\u4e3anil \u7136\u540e\u518d\u628a\u8fd9\u4e2a\u6c60\u4e2d\u7684\u6240\u6709\u672c\u5730\u6c60\u5217\u8868\u90fd\u9500\u6bc1\u6389 \u6700\u540e\uff0c\u6c60\u6e05\u7406\u51fd\u6570\u4f1a\u628a\u6c60\u6c47\u603b\u5217\u8868\u91cd\u7f6e\u4e3a\u7a7a\u7684\u5207\u7247\uff0c\u8fd9\u6837\u6c60\u4e2d\u5b58\u50a8\u7684\u4e34\u65f6\u5bf9\u8c61\u5c31\u5168\u90e8\u88ab\u6e05\u9664\u5e72\u51c0\u4e86 \u5982\u679c\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e00\u5916\u5730\u7684\u4ee3\u7801\u518d\u65e0\u5bf9\u5b83\u4eec\u7684\u5f15\u7528\uff0c\u90a3\u4e48\u5728\u7a0d\u540e\u7684\u5783\u573e\u56de\u6536\u8fc7\u7a0b\u4e2d\uff0c\u8fd9\u4e9b\u4e34\u65f6\u5bf9\u8c61\u5c31\u4f1a\u88ab\u5f53\u505a\u5783\u573e\u9500\u6bc1\u6389\u5b83\u4eec\u5360\u7528\u7684\u5185\u5b58\u7a7a\u95f4\u5c31\u4f1a\u88ab\u56de\u6536\u5df2\u5907\u4ed6\u7528","title":"\u4e34\u65f6\u5bf9\u8c61\u7684\u9500\u6bc1"},{"location":"Language/Basic/17-sync/#_11","text":"\u5728\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u6709\u4e00\u4e2a\u591a\u5c42\u7684\u6570\u636e\u7ed3\u6784\uff0c\u56e0\u4e3a\u5b83\u7684\u5b58\u5728\u4f7f\u5f97\u4e34\u65f6\u5bf9\u8c61\u6c60\u80fd\u591f\u975e\u5e38\u9ad8\u6548\u5730\u5b58\u50a8\u5927\u91cf\u7684\u503c\u3002\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u7684\u9876\u5c42\uff0c\u79f0\u4e3a \u672c\u5730\u6c60\u5217\u8868 \uff08\u5b83\u662f\u4e00\u4e2a\u6570\u7ec4\uff09\uff0c\u8fd9\u4e2a\u5217\u8868\u7684\u957f\u5ea6\u603b\u662f\u4e0eGo\u8bed\u8a00\u8c03\u5ea6\u5668\u4e2dP\u7684\u6570\u91cf\u76f8\u540c\u3002 Go\u8bed\u8a00\u8c03\u5ea6\u5668\u4e2d\u7684P\u662fprocessor\u7684\u7f29\u5199\uff0c\u6307\u7684\u662f\u4e00\u79cd\u53ef\u4ee5\u627f\u8f7d\u82e5\u5e72\u4e2aG\uff08goroutine\uff09\uff0c\u4e14\u80fd\u591f\u4f7f\u8fd9\u4e9bG\u9002\u65f6\u5730\u4e0eM\uff08machine\uff0c\u5373\u7cfb\u7edf\u7ea7\u7ebf\u7a0b\uff09\u8fdb\u884c\u5bf9\u63a5\uff0c\u5e76\u5f97\u5230\u771f\u6b63\u8fd0\u884c\u7684\u4e2d\u4ecb\u3002\u56e0\u4e3aP \u7684\u5b58\u5728\uff0cG\u548cM\u624d\u80fd\u591f\u8fdb\u884c\u9ad8\u6821\u3001\u7075\u6d3b\u7684\u914d\u5bf9\uff0c\u4ece\u800c\u5b9e\u73b0\u5f3a\u5927\u7684\u5e76\u53d1\u7f16\u7a0b\u6a21\u578b\u3002 P\u5b58\u5728\u7684\u4e00\u4e2a\u91cd\u8981\u539f\u56e0\u662f\u4e3a\u4e86 \u5206\u6563\u5e76\u53d1\u7a0b\u5e8f\u7684\u6267\u884c\u538b\u529b \uff0c \u8ba9\u4e34\u65f6\u5bf9\u8c61\u6c60\u4e2d\u7684\u672c\u5730\u6c60\u5217\u8868\u7684\u957f\u5ea6\u4e0eP\u7684\u6570\u91cf\u76f8\u7b49\u7684\u4e3b\u8981\u539f\u56e0\u5c31\u662f \u5206\u6563\u538b\u529b \u3002 \u8fd9\u91cc\u7684\u538b\u529b\u5305\u62ec\u4e24\u65b9\u9762\uff1a\u5b58\u50a8\u548c\u6027\u80fd\u3002 \u672c\u5730\u6c60\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u672c\u5730\u6c60\u5305\u542b\u4e09\u4e2a\u5b57\u6bb5\uff1a private\uff1a\u5b58\u50a8\u79c1\u6709\u4e34\u65f6\u5bf9\u8c61 shared\uff1a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868 sync.Mutex\u7c7b\u578b\u7684\u5d4c\u5165\u5b57\u6bb5 \u6bcf\u4e2a\u672c\u5730\u6c60\u90fd\u5bf9\u5e94\u7740\u4e00\u4e2aP\uff0c\u4ee5\u4e3a\u4f60\u4e00\u4e2agoroutine\u8981\u771f\u6b63\u8fd0\u884c\u8d77\u6765\u5fc5\u987b\u5148\u4e0e\u67d0\u4e2aP\u4ea7\u751f\u5173\u8054\u3002\u5728\u7a0b\u5e8f\u8c03\u7528\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u6216Get\u65b9\u6cd5\u7684\u65f6\u5019\uff0c\u603b\u4f1a\u5148\u8bd5\u56fe\u4ece\u8be5\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u672c\u5730\u6c60\u5217\u8868\u4e2d\uff0c\u83b7\u53d6\u4e0e\u4e4b\u5bf9\u5e94\u7684\u672c\u5730\u6c60\uff0c\u4f9d\u636e\u7684\u5c31\u662f\u4e0e\u5f53\u524dgoroutine\u5173\u8054\u7684\u90a3\u4e2aP\u7684ID\u3002 \u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684Put\u65b9\u6cd5\u6216Get\u65b9\u6cd5\u6216\u83b7\u53d6\u5230\u54ea\u4e00\u4e2a\u672c\u5730\u6c60\uff0c\u5b8c\u5168\u53d6\u51b3\u4e8e\u8c03\u7528\u5b83\u7684\u4ee3\u7801\u6240\u5728\u7684goroutine\u5173\u8054\u7684\u90a3\u4e2aP \u3002","title":"\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u6570\u636e\u7ed3\u6784"},{"location":"Language/Basic/17-sync/#_12","text":"Put\uff1a \u603b\u4f1a\u5148\u8bd5\u56fe\u628a\u65b0\u7684\u4e34\u65f6\u5bf9\u8c61\uff0c\u5b58\u50a8\u5230\u5bf9\u5e94\u7684\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u4e2d\uff0c\u4ee5\u4fbf\u5728\u540e\u9762\u83b7\u53d6\u4e34\u65f6\u5bf9\u8c61\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u5feb\u901f\u5730\u62ff\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u503c\u3002 \u53ea\u6709\u5f53\u8fd9\u4e2aprivate\u5b57\u6bb5\u5df2\u7ecf\u5b58\u5728\u6709\u67d0\u4e2a\u503c\u65f6\uff0c\u8be5\u65b9\u6cd5\u624d\u4f1a\u53bb\u8bbf\u95ee\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5\u3002 Get\uff1a \u603b\u4f1a\u5148\u8bd5\u56fe\u4ece\u5bf9\u5e94\u7684\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u5904\u83b7\u53d6\u4e00\u4e2a\u4e34\u65f6\u5bf9\u8c61 \u5f53private\u5b57\u6bb5\u7684\u503c\u4e3anil\u65f6\uff0c\u5b83\u624d\u4f1a\u53bb\u8bbf\u95ee\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5 \u4e00\u4e2a\u672c\u5730\u6c60\u7684 shared \u5b57\u6bb5\u539f\u5219\u4e0a\u53ef\u4ee5\u88ab\u4efb\u4f55goroutine\u4e2d\u7684\u4ee3\u7801\u8bbf\u95ee\uff0c\u4e0d\u8bba\u8fd9\u4e2agoroutine\u7ba1\u7406\u7684\u662f\u54ea\u4e00\u4e2aP\uff0c\u56e0\u6b64shard\u4e5f\u79f0\u4e3a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u3002\u56e0\u4e3a shared \u5b57\u6bb5\u662f\u5171\u4eab\u7684\uff0c\u6240\u4ee5\u5fc5\u987b\u6536\u5230\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u3002 \u4e00\u4e2a\u672c\u5730\u6c60\u7684 private \u5b57\u6bb5\u53ea\u80fd\u88ab\u4e0e\u4e4b\u5bf9\u5e94\u7684\u90a3\u4e2aP\u6240\u5173\u8054\u7684goroutine\u4e2d\u7684\u4ee3\u7801\u8bbf\u95ee\u5230\uff0c\u6240\u4ee5\u5b83\u662fP\u7ea7\u79c1\u6709\u7684\u3002 \u672c\u5730\u6c60\u672c\u8eab\u62e5\u6709\u4e92\u65a5\u9501\u529f\u80fd\uff0c\u5373\u5b83\u5d4c\u5165\u7684\u90a3\u4e2a sync.Mutex \u7c7b\u578b\u7684\u5b57\u6bb5\u3002Put\u65b9\u6cd5\u4f1a\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\uff0c\u628a\u65b0\u7684\u4e34\u65f6\u5bf9\u8c61\u8ffd\u52a0\u5230\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u7684\u672b\u5c3e\u3002Get\u65b9\u6cd5\u4f1a\u5728\u4e92\u65a5\u9501\u7684\u4fdd\u62a4\u4e0b\uff0c\u8bd5\u56fe\u628a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u503c\u53d6\u51fa\u5e76\u4f5c\u4e3a\u7ed3\u679c\u3002 \u8fd9\u91cc\u7684\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e5f\u53ef\u80fd\u662f\u7a7a\u7684\uff0c\u8fd9\u53ef\u80fd\u662f\u7531\u4e8e\u8fd9\u4e2a\u672c\u5730\u6c60\u4e2d\u7684\u6240\u6709\u4e34\u65f6\u5bf9\u8c61\u90fd\u5df2\u7ecf\u88ab\u53d6\u8d70\u4e86\uff0c\u4e5f\u53ef\u80fd\u662f\u5f53\u524d\u7684\u4e34\u65f6\u5bf9\u8c61\u6c60\u521a\u88ab\u6e05\u7406\u8fc7\u3002 \u65e0\u8bba\u4ec0\u4e48\u539f\u56e0\uff0cGet\u65b9\u6cd5\u90fd\u4f1a\u53bb\u8bbf\u95ee\u5f53\u524d\u4e34\u65f6\u5bf9\u8c61\u4e2d\u7684\u6240\u6709\u672c\u5730\u6c60\uff0c\u5b83\u4f1a\u4e4b\u6b4c\u641c\u7d22\u5b83\u7684\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u3002\u53d1\u73b0\u67d0\u4e2a\u5171\u4eab\u4e34\u65f6\u5bf9\u8c61\u5217\u8868\u4e2d\u5305\u542b\u5143\u7d20\u503c\uff0c\u5b83\u5c31\u4f1a\u628a\u8be5\u5217\u8868\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u53d6\u51fa\u6765\u5e76\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 \u5373\u4f7f\u8fd9\u6837\u4e5f\u53ef\u80fd\u65e0\u6cd5\u62ff\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u4e34\u65f6\u5bf9\u8c61\uff0cGet\u4f1a\u8c03\u7528\u521b\u5efa\u4e34\u65f6\u5bf9\u8c61\u7684\u90a3\u4e2a\u51fd\u6570\u3002\u8fd9\u4e2a\u51fd\u6570\u7531\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684New\u5b57\u6bb5\u4ee3\u8868\uff0c\u5e76\u4e14\u9700\u8981\u5728\u521d\u59cb\u5316\u4e34\u65f6\u5bf9\u8c61\u6c60\u7684\u65f6\u5019\u7ed9\u5b9a\u3002\u5982\u679c\u8fd9\u4e2a\u5b57\u6bb5\u4e3anil\uff0c\u90a3\u4e48Get\u65b9\u6cd5\u6b64\u65f6\u4e5f\u53ea\u80fd\u8fd4\u56denil\u3002","title":"\u4e34\u65f6\u5bf9\u8c61\u6c60\u5982\u4f55\u5b58\u53d6\u503c"},{"location":"Language/Basic/17-sync/#syncmap","text":"Go\u8bed\u8a00\u81ea\u5e26\u7684\u5b57\u5178\u7c7b\u578b map \u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u540c\u4e00\u65f6\u95f4\u6bb5\u5185\uff0c\u8ba9\u4e0d\u540cgoroutine\u4e2d\u7684\u4ee3\u7801\uff0c\u5bf9\u540c\u4e00\u4e2a\u5b57\u5178\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u662f\u4e0d\u5b89\u5168\u7684\u3002\u5b57\u5178\u503c\u672c\u8eab\u53ef\u80fd\u4f1a\u56e0\u4e3a\u8fd9\u4e9b\u64cd\u4f5c\u800c\u4ea7\u751f\u6df7\u4e71\uff0c\u76f8\u5173\u7a0b\u5e8f\u4e5f\u53ef\u80fd\u4f1a\u56e0\u6b64\u53d1\u751f\u4e0d\u53ef\u9884\u77e5\u7684\u95ee\u9898\u3002 \u4f7f\u7528 sync.Mutex \u6216\u8005 sync.RWMutex ,\u5728\u52a0\u4e0a\u539f\u751f\u7684map\u5c31\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u5e76\u53d1\u5b89\u5168\u7684\u5b57\u5178\u3002 Go 1.9\u4e2d\u53d1\u5e03\u4e86\u5e76\u53d1\u5b89\u5168\u7684\u5b57\u5178\u7c7b\u578b sync.Map \u3002\u8fd9\u4e2a\u5b57\u5178\u7c7b\u578b\u63d0\u4f9b\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u952e\u503c\u5b58\u53d6\u64cd\u4f5c\u65b9\u6cd5\uff0c\u5e76\u4fdd\u8bc1\u4e86\u8fd9\u4e9b\u64cd\u4f5c\u7684\u5e76\u53d1\u5b89\u5168\uff0c\u540c\u65f6\uff0c\u5b83\u7684\u5b58\u3001\u53d6\u3001\u5220\u7b49\u64cd\u4f5c\u90fd\u53ef\u4ee5\u57fa\u672c\u4fdd\u8bc1\u5e38\u6570\u65f6\u95f4\u5185\u6267\u884c\u5b8c\u6bd5\u3002\u5b83\u7684\u7b97\u6cd5\u590d\u6742\u7684\u4e0emap\u7c7b\u578b\u4e00\u6837\u90fd\u662f 0(1) \u3002 \u4e0e\u5355\u7eaf\u4f7f\u7528\u539f\u751fmap\u548c\u4e92\u65a5\u9501\u76f8\u6bd4\uff0c sync.Map \u53ef\u4ee5\u663e\u8457\u5730\u51cf\u5c11\u9501\u7684\u4e89\u7528\u3002 sync.Map \u672c\u8eab\u867d\u7136\u4e5f\u7528\u5230\u4e86\u9501\uff0c\u4f46\u662f\uff0c\u5b83\u5176\u5b9e\u5728\u5c3d\u53ef\u80fd\u5730\u907f\u514d\u4f7f\u7528\u9501\u3002\u56e0\u4e3a\u4f7f\u7528\u9501\u5c31\u610f\u5473\u7740\u628a\u4e00\u4e9b\u5e76\u53d1\u7684\u64cd\u4f5c\u5f3a\u5236\u4e32\u884c\u5316\uff0c\u8fd9\u4f1a\u964d\u4f4e\u7a0b\u5e8f\u7684\u6027\u80fd\uff0c\u5c24\u5176\u662f\u5728\u8ba1\u7b97\u673a\u62e5\u6709\u591a\u4e2aCPU\u6838\u5fc3\u7684\u60c5\u51b5\u4e0b\u3002\u56e0\u6b64\u80fd\u7528\u539f\u5b50\u64cd\u4f5c\uff08\u539f\u5b50\u64cd\u4f5c\u7684\u5c40\u9650\u6027\uff0c\u53ea\u80fd\u5bf9\u4e00\u4e9b\u57fa\u672c\u7684\u6570\u636e\u7c7b\u578b\u63d0\u4f9b\u652f\u6301\uff09\u7684\u60c5\u51b5\u4e0b\u5c31\u4e0d\u8981\u7528\u9501\u3002 \u65e0\u8bba\u5728\u4f55\u79cd\u573a\u666f\u4e0b\u4f7f\u7528 sync.Map ,\u90fd\u9700\u8981\u6ce8\u610f\u5b83\u4e0e\u539f\u751fmap\u660e\u663e\u4e0d\u540c\uff0c\u5b83\u53ea\u662f\u6807\u51c6\u5e93\u4e2d\u7684\u4e00\u5458\uff0c\u800c\u4e0d\u662f\u8bed\u8a00\u5c42\u9762\u7684\u4e1c\u897f\u3002\u7f16\u8bd1\u5668\u5e76\u4e0d\u4f1a\u5bf9\u5b83\u7684\u952e\u548c\u503c\u8fdb\u884c\u7279\u6b8a\u7684\u7c7b\u578b\u68c0\u67e5\u3002 sync.Map \u6240\u6709\u7684\u65b9\u6cd5\u6d89\u53ca\u7684\u952e\u548c\u503c\u7684\u7c7b\u578b\u90fd\u662f interface{} \uff0c\u8fd9\u610f\u5473\u7740\u53ef\u4ee5\u5305\u7f57\u4e07\u8c61\uff0c\u6240\u4ee5\u5fc5\u987b\u5728\u7a0b\u5e8f\u4e2d\u81ea\u884c\u4fdd\u8bc1\u5b83\u7684\u952e\u7c7b\u578b\u548c\u503c\u7c7b\u578b\u7684\u6b63\u786e\u6027\u3002","title":"sync.Map"},{"location":"Language/Basic/17-sync/#syncmap_1","text":"\u952e\u7684\u5b9e\u9645\u7c7b\u578b\u4e0d\u80fd\u662f\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u6bb5\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b \u3002 Go\u8bed\u8a00\u539f\u751f\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e5f\u4e0d\u80fd\u662f\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u548c\u5207\u7247\u7c7b\u578b\u3002 sync.Map \u5185\u90e8\u7684\u5b58\u50a8\u4ecb\u8d28\u5c31\u662f\u539f\u751f\u5b57\u5178\uff0c\u53c8\u56e0\u4e3a\u539f\u751f\u5b57\u5178\u7684\u952e\u7c7b\u578b\u4e5f\u662f interface{} \uff0c\u6240\u4ee5\u7edd\u5bf9\u4e0d\u80fd\u5e26\u8fd9\u4efb\u4f55\u5b9e\u9645\u7c7b\u578b\u4e3a\u51fd\u6570\u7c7b\u578b\u3001\u5b57\u5178\u7c7b\u578b\u6216\u5207\u7247\u7c7b\u578b\u7684\u952e\u503c\u53bb\u64cd\u4f5c sync.Map \u3002 \u56e0\u4e3a\u8fd9\u4e9b\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u53ea\u6709\u5728\u7a0b\u5e8f\u8fd0\u884c\u671f\u95f4\u624d\u80fd\u786e\u5b9a\uff0c\u6240\u4ee5Go\u8bed\u8a00\u7f16\u8bd1\u5668\u662f\u65e0\u6cd5\u5728\u7f16\u8bd1\u671f\u95f4\u5bf9\u5b83\u4eec\u8fdb\u884c\u68c0\u67e5\u7684\uff0c\u4e0d\u6b63\u786e\u7684\u952e\u503c\u5b9e\u9645\u7c7b\u578b\u4f1a\u5f15\u53d1panic \u3002 \u6240\u4ee5\u5728\u6bcf\u6b21\u64cd\u4f5c sync.Map \u7684\u65f6\u5019\uff0c\u663e\u5f0f\u5730\u68c0\u67e5\u952e\u503c\u7684\u5b9e\u9645\u7c7b\u578b \u3002\u66f4\u597d\u7684\u64cd\u4f5c\u662f\u9488\u5bf9\u540c\u4e00\u4e2a sync.Map \u7684\u5b58\u3001\u53d6\u3001\u5220\u64cd\u4f5c\u90fd\u96c6\u4e2d\u8d77\u6765\uff0c\u7136\u540e\u7edf\u4e00\u7f16\u5199\u68c0\u67e5\u4ee3\u7801\u3002\u6216\u8005\u628a sync.Map \u5c01\u88c5\u5728\u4e00\u4e2a\u7ed3\u6784\u4f53\u4e2d\u4e5f\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u9009\u62e9\u3002 \u5fc5\u987b\u4fdd\u8bc1\u952e\u7684\u7c7b\u578b\u662f\u53ef\u6bd4\u8f83\u7684\uff08\u53ef\u5224\u7b49\u7684\uff09\uff0c\u5b9e\u5728\u62ff\u4e0d\u51c6\uff0c\u53ef\u4ee5\uff1a \u4f7f\u7528 reflect.Typeof() \u51fd\u6570\u5f97\u5230\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u7684\u53cd\u5c04\u7c7b\u578b\u503c\uff08\u5373\uff1a reflect.Type \u7c7b\u578b\u7684\u503c\uff09 \u8c03\u7528\u8fd9\u4e2a\u503c\u7684 Comparable \u65b9\u6cd5\u5f97\u5230\u786e\u5207\u7684\u5224\u65ad\u7ed3\u679c","title":"sync.Map\u5bf9\u952e\u7c7b\u578b\u7684\u8981\u6c42"},{"location":"Language/Basic/17-sync/#syncmap_2","text":"\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u6216\u8005\u53cd\u5c04\u64cd\u4f5c\u6765\u4fdd\u8bc1\u5b83\u4eec\u7684\u7c7b\u578b\u6b63\u786e\u6027\u3002","title":"\u4fdd\u8bc1sync.Map\u4e2d\u952e\u503c\u7684\u7c7b\u578b\u6b63\u786e\u6027"},{"location":"Language/Basic/17-sync/#_13","text":"\u8ba9 sync.Map \u53ea\u80fd\u5b58\u50a8\u67d0\u4e2a\u7279\u5b9a\u7c7b\u578b\u7684\u952e\u3002\u4e00\u65e6\u786e\u5b9a\u597d\u4e86\u952e\u7684\u7c7b\u578b\uff0c\u5c31\u53ef\u4ee5\u5728\u5b58\u3001\u53d6\u3001\u5220\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u53bb\u5bf9\u952e\u7684\u7c7b\u578b\u505a\u68c0\u67e5\u3002 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8fd9\u6837\u7684\u68c0\u67e5\u5e76\u4e0d\u7e41\u7410\uff0c\u5982\u679c\u628a sync.Map \u5c01\u88c5\u5728\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\u91cc\u5c31\u66f4\u65b9\u4fbf\u4e86\uff0c\u8fd9\u6837\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u5e2e\u52a9\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u5982\u4e0b\u6240\u793a\uff1a // \u952e\u7c7b\u578b\u4e3aint\uff0c\u503c\u7c7b\u578b\u4e3astring // \u5728\u8fd9\u4e2a\u7ed3\u6784\u4f53\u4e2d\uff0c\u53ea\u6709sync.Map\u7c7b\u578b\u7684\u5b57\u6bb5m type IntStrMap struct { m sync.Map } func (iMap *IntStrMap) Delete(key int) { iMap.m.Delete(key) } func (iMap *IntStrMap) Load(key int) (value string, ok bool) { v, ok := iMap.m.Load(key) if v != nil { value = v.(string) } return } func (iMap *IntStrMap) LoadOrStore(key int, value string) (actual string, loaded bool) { a, loaded := iMap.m.LoadOrStore(key, value) actual = a.(string) return } func (iMap *IntStrMap) Range(f func(key int, value string) bool) { f1 := func(key, value interface{}) bool { return f(key.(int), value.(string)) } iMap.m.Range(f1) } func (iMap *IntStrMap) Store(key int, value string) { iMap.m.Store(key, value) } \u8fd9\u6837\u5728\u8fd9\u4e9b\u65b9\u6cd5\u64cd\u4f5c\u952e\u503c\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u518d\u9700\u8981\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u4e5f\u4e0d\u7528\u62c5\u5fc3\u7c7b\u578b\u4f1a\u4e0d\u6b63\u786e\u3002 \u56e0\u6b64\uff0c\u5728\u786e\u5b9a\u952e\u548c\u503c\u7684\u5177\u4f53\u7c7b\u578b\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5229\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u53bb\u505a\u7c7b\u578b\u68c0\u67e5\uff0c\u5e76\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u4f5c\u4e3a\u8f85\u52a9\u3002","title":"\u65b9\u6848\u4e00"},{"location":"Language/Basic/17-sync/#_14","text":"\u5c01\u88c5\u7684\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u53ef\u4ee5\u4e0e sync.Map \u7c7b\u578b\u7684\u65b9\u6cd5\u5b8c\u5168\u4e00\u81f4\uff08\u5305\u62ec\u65b9\u6cd5\u540d\u79f0\u548c\u65b9\u6cd5\u7b7e\u540d\uff09\u3002\u4e0d\u8fc7\u5728\u8fd9\u4e9b\u65b9\u6cd5\u4e2d\u9700\u8981\u6dfb\u52a0\u4e00\u4e9b\u7c7b\u578b\u68c0\u67e5\u7684\u4ee3\u7801\u3002\u8fd9\u6837 sync.Map \u7684\u952e\u548c\u503c\u7c7b\u578b\u5fc5\u987b\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u5c31\u5b8c\u5168\u786e\u5b9a\uff0c\u5e76\u4e14\u5fc5\u987b\u5148\u4fdd\u8bc1\u952e\u7684\u7c7b\u578b\u662f\u53ef\u6bd4\u8f83\u7684\u3002 \u6240\u4ee5\u5c01\u88c5\u7684\u7ed3\u6784\u4f53\u5982\u4e0b\uff1a // \u53ef\u81ea\u5b9a\u4e49\u952e\u548c\u503c\u7c7b\u578b\u7684sync.Map type ConcurrentMap struct { m sync.Map // \u952e\u548c\u503c\u90fd\u662f\u53cd\u5c04\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u53ef\u4ee5\u4ee3\u8868Go\u8bed\u8a00\u7684\u4efb\u4f55\u6570\u636e\u7c7b\u578b // \u8fd9\u4e2a\u7c7b\u578b\u503c\u5bb9\u6613\u83b7\u5f97\uff0c\u901a\u8fc7\u8c03\u7528reflect.Typeof\u51fd\u6570\u5e76\u628a\u6837\u672c\u503c\u4f20\u5165\u5373\u53ef keyType reflect.Type valueType reflect.Type } func (cMap *ConcurrentMap) Load(key interface{}) (value interface{}, ok bool) { // \u5c06\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u503c\u4f20\u5165reflect.Typeof\u51fd\u6570\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u5bf9\u5e94\u7684\u53cd\u5c04\u7c7b\u578b\u503c if reflect.TypeOf(key) != cMap.keyType { return } return cMap.m.Load(key) } func (cMap *ConcurrentMap) Store(key, value interface{}) { // \u5f53key\u548cvalue\u7684\u5b9e\u9645\u7c7b\u578b\u4e0d\u7b26\u5408\u8981\u6c42\u65f6\uff0cstore\u65b9\u6cd5\u4f1a\u7acb\u5373\u5f15\u53d1panic // \u56e0\u4e3astore\u65b9\u6cd5\u6ca1\u6709\u7ed3\u679c\u58f0\u660e\uff0c\u6240\u4ee5\u5728\u53c2\u6570\u503c\u6709\u95ee\u9898\u7684\u65f6\u5019\uff0c\u65e0\u6cd5\u901a\u8fc7\u6bd4\u8f83\u5e73\u548c\u7684\u65b9\u5f0f\u544a\u77e5\u8c03\u7528\u65b9 if reflect.TypeOf(key) != cMap.keyType { panic(fmt.Errorf( wrong key type: %v , reflect.TypeOf(key))) } if reflect.TypeOf(value) != cMap.valueType { panic(fmt.Errorf( wrong value type: %v , reflect.TypeOf(value))) } cMap.m.Store(key, value) } // \u4e5f\u53ef\u4ee5\u4e3astore\u65b9\u6cd5\u6dfb\u52a0\u4e00\u4e2aerror\u7c7b\u578b\u7684\u7ed3\u679c\uff0c\u5728\u53d1\u73b0\u53c2\u6570\u503c\u7c7b\u578b\u4e0d\u6b63\u786e\u7684\u65f6\u5019\uff0c // \u8ba9\u5b83\u76f4\u63a5\u8fd4\u56de\u54cd\u5e94\u7684error\u7c7b\u578b\u503c\uff0c\u800c\u4e0d\u662f\u5f15\u53d1panic\uff0c\u5b9e\u9645\u4e2d\u53ef\u6839\u636e\u5e94\u7528\u573a\u666f\u8fdb\u884c\u6539\u8fdb\u548c\u4f18\u5316 \u65b9\u6848\u4e00\uff1a \u9002\u5408\u53ef\u4ee5\u5b8c\u5168\u786e\u5b9a\u952e\u548c\u503c\u7c7b\u578b\u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u4f7f\u7528Go\u8bed\u8a00\u7f16\u8bd1\u5668\u505a\u7c7b\u578b\u68c0\u67e5\uff0c\u5e76\u7528\u7c7b\u578b\u65ad\u8a00\u8868\u8fbe\u5f0f\u505a\u8f85\u52a9\u3002 \u660e\u663e\u7684\u7f3a\u9677\u5c31\u662f\u65e0\u6cd5\u7075\u6d3b\u5730\u6539\u53d8\u5b57\u5178\u7684\u952e\u548c\u503c\u7684\u7c7b\u578b\uff0c\u9700\u6c42\u591a\u6837\u5316\u5219\u7f16\u7801\u5de5\u4f5c\u91cf\u589e\u52a0\u3002 \u65b9\u6848\u4e8c\uff1a \u65e0\u9700\u5728\u7a0b\u5e8f\u8fd0\u884c\u4e4b\u524d\u660e\u786e\u952e\u548c\u503c\u7684\u7c7b\u578b\uff0c\u53ea\u8981\u5728\u521d\u59cb\u5316 sync.Map \u7684\u65f6\u5019\uff0c\u52a8\u6001\u5730\u7ed9\u5b83\u4eec\u5c31\u53ef\u4ee5\uff0c\u4e3b\u8981\u4f7f\u7528reflect\u5305\u4e2d\u7684\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\uff0c\u5916\u52a0\u4e00\u4e9b\u7b80\u5355\u7684\u5224\u7b49\u64cd\u4f5c\u3002 \u66f4\u7075\u6d3b\uff0c\u4f46\u662f\u53cd\u5c04\u64cd\u4f5c\u964d\u4f4e\u7a0b\u5e8f\u7684\u6027\u80fd\u3002","title":"\u65b9\u6848\u4e8c"},{"location":"Language/Basic/17-sync/#syncmap_3","text":"sync.Map \u7c7b\u578b\u5728\u5185\u90e8\u4f7f\u7528\u5927\u91cf\u7684\u539f\u5b50\u64cd\u4f5c\u6765\u5b58\u53d6\u952e\u548c\u503c\uff0c\u5e76\u4f7f\u7528\u4e24\u4e2a\u539f\u751f\u7684map\u4f5c\u4e3a\u5b58\u50a8\u4ecb\u8d28\uff1a \u4e00\u4e2a\u539f\u751fmap\u88ab\u5b58\u5728\u4e86 sync.Map \u7684read\u5b57\u6bb5\u4e2d\uff0c\u8be5\u5b57\u6bb5\u662f sycn/atomic.Value \u7c7b\u578b\u7684\u3002\u8fd9\u4e2a\u539f\u751f\u5b57\u5178\u53ef\u4ee5\u88ab\u770b\u505a\u4e00\u4e2a\u5feb\u7167\uff0c\u5b83\u603b\u4f1a\u5728\u6761\u4ef6\u6ee1\u8db3\u65f6\uff0c\u53bb\u91cd\u65b0\u4fdd\u5b58\u6240\u5c5e\u7684 sync.Map \u503c\u4e2d\u5305\u542b\u7684\u6240\u6709\u952e\u503c\u5bf9\u3002 read\u5b57\u6bb5\u867d\u7136\u4e0d\u4f1a\u589e\u51cf\u5176\u4e2d\u7684\u952e\uff0c\u4f46\u5374\u5141\u8bb8\u53d8\u66f4\u5176\u4e2d\u7684\u952e\u6240\u5bf9\u5e94\u7684\u503c\uff0c\u6240\u4ee5\u5b83\u4e0d\u662f\u4f20\u7edf\u610f\u4e49\u4e0a\u7684\u5feb\u7167\uff0c\u5b83\u7684\u53ea\u8bfb\u7279\u6027\u53ea\u662f\u5bf9\u5176\u4e2d\u952e\u7684\u96c6\u5408\u800c\u8a00\u7684\u3002 read\u5b57\u6bb5\u7684\u7c7b\u578b\u53ef\u77e5\uff0c sync.Map \u5728\u66ff\u6362read\u7684\u65f6\u5019\u6839\u672c\u7528\u4e0d\u7740\u9501\uff0c\u5e76\u4e14read\u5b57\u6bb5\u5728\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u8fd8\u5728\u503c\u4e4b\u4e0a\u5c01\u88c5\u4e86\u4e00\u5c42\uff1a \u5148\u628a\u503c\u8f6c\u6362\u4e3aunsafe.Pointer`\u7c7b\u578b\u7684\u503c \u518d\u628a\u540e\u8005\u5c01\u88c5\u540e\u5b58\u50a8\u5728\u5176\u4e2d\u7684\u539f\u751fmap\u4e2d \u8fd9\u6837\uff0c\u5728\u53d8\u66f4\u67d0\u4e2a\u952e\u6240\u5bf9\u5e94\u7684\u503c\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u539f\u5b50\u64cd\u4f5c\u4e86\u3002 \u53e6\u4e00\u4e2a\u539f\u751fmap\u5b58\u5728 sync.Map \u7684dirty\u5b57\u6bb5\u4e2d\uff0c\u5b83\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65b9\u5f0f\u4e0eread\u5b57\u6bb5\u4e00\u53ea\uff0c\u5b83\u7684\u952e\u7c7b\u578b\u662f interface{} \uff0c\u5e76\u4e14\u540c\u6837\u628a\u503c\u5148\u505a\u8f6c\u6362\u548c\u5c01\u88c5\uff0c\u7136\u540e\u518d\u8fdb\u884c\u5b58\u50a8\u3002 read\u548cdirty\u5b57\u6bb5\u5982\u679c\u90fd\u5b58\u6709\u540c\u4e00\u4e2a\u952e\u503c\u5bf9\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684\u4e24\u4e2a\u952e\u6307\u7684\u80af\u5b9a\u662f\u540c\u4e00\u4e2a\u57fa\u672c\u503c\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u503c\u6765\u8bf4\u4e5f\u662f\u5982\u6b64 \u3002 \u8fd9\u4e24\u4e2a\u5b57\u5178\u5728\u5b58\u50a8\u952e\u548c\u503c\u7684\u65f6\u5019\uff0c\u53ea\u4f1a\u5b58\u5165\u5b83\u4eec\u7684\u67d0\u4e2a\u6307\u9488\uff0c\u800c\u4e0d\u662f\u57fa\u672c\u503c\u3002 \u8bfb\u53d6\uff1a sync.Map \u5728\u67e5\u627e\u6307\u5b9a\u7684\u952e\u9501\u5bf9\u5e94\u7684\u503c\u7684\u65f6\u5019\uff0c\u603b\u4f1a\u5148\u53bbread\u4e2d\u5bfb\u627e\uff0c\u5e76\u4e0d\u9700\u8981\u9501\u5b9a\u4e92\u65a5\u9501 \u53ea\u6709\u5728\u786e\u5b9aread\u4e2d\u6ca1\u6709\uff0c\u4f46dirty\u4e2d\u53ef\u80fd\u8fd8\u6709\u8fd9\u4e2a\u952e\u7684\u65f6\u5019\uff0c\u5b83\u624d\u4f1a\u5728\u9501\u7684\u5305\u542b\u4e0b\u53bb\u8bbf\u95eedirty \u5b58\u50a8\uff1a sync.Map \u5728\u5b58\u50a8\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u53ea\u8981read\u4e2d\u5df2\u5b58\u6709\u8fd9\u4e2a\u952e \u5e76\u4e14\u8be5\u952e\u503c\u5bf9\u672a\u88ab\u6807\u8bb0\u4e3a\u201c\u5df2\u5220\u9664\u201d\uff0c\u5c31\u4f1a\u628a\u65b0\u503c\u5b58\u5230\u91cc\u9762\u76f4\u63a5\u8fd4\u56de\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e5f\u4e0d\u9700\u8981\u7528\u5230\u9501 \u5426\u5219\uff0c\u5b83\u624d\u4f1a\u5728\u9501\u7684\u4fdd\u62a4\u4e0b\u628a\u952e\u503c\u5bf9\u5b58\u50a8\u5230dirty\u4e2d\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c\u8be5\u952e\u503c\u5bf9\u7684\u201c\u5df2\u5220\u9664\u201d\u6807\u8bb0\u4f1a\u88ab\u62b9\u53bb \u53ea\u6709\u5f53\u4e00\u4e2a\u952e\u503c\u5bf9\u5e94\u8be5\u88ab\u5220\u9664\uff0c\u4f46\u5374\u4ecd\u7136\u5b58\u5728\u4e0eread\u4e2d\u7684\u65f6\u5019\uff0c\u624d\u4f1a\u88ab\u7528\u6807\u8bb0\u4e3a\u201c\u5df2\u5220\u9664\u201d\u7684\u65b9\u5f0f\u8fdb\u884c\u903b\u8f91\u5220\u9664\uff0c\u800c\u4e0d\u4f1a\u76f4\u63a5\u88ab\u7269\u7406\u5220\u9664\u3002\u8fd9\u79cd\u60c5\u51b5\u4f1a\u5728\u91cd\u5efadirty\u540e\u7684\u4e00\u6bb5\u65f6\u95f4\u5185\u51fa\u73b0\uff0c\u8fc7\u4e0d\u4e86\u591a\u4e45\uff0c\u5c31\u4f1a\u88ab\u771f\u6b63\u5220\u9664\u3002 \u5728\u67e5\u627e\u548c\u904d\u5386\u952e\u503c\u5bf9\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u88ab\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u6c38\u8fdc\u4f1a\u88ab\u65e0\u89c6 \u3002 \u5bf9\u4e8e\u5220\u9664\u952e\u503c\u5bf9\uff0c sync.Map \u4f1a\u5148\u53bb\u68c0\u67e5read\u4e2d\u662f\u5426\u6709\u5bf9\u5e94\u7684\u952e\uff0c\u5982\u679c\u6ca1\u6709\uff0cdirty\u4e2d\u53ef\u80fd\u6709\uff0c\u90a3\u4e48\u5b83\u4f1a\u5728\u9501\u4fdd\u62a4\u4e0b\uff0c\u8bd5\u56fe\u4ecedirty\u4e2d\u5220\u9664\u8be5\u952e\u503c\u5bf9\u3002\u6700\u540e\uff0c sync.Map \u4f1a\u628a\u8be5\u952e\u503c\u5bf9\u4e2d\u6307\u5411\u503c\u7684\u90a3\u4e2a\u6307\u9488\u7f6e\u4e3anil\uff0c\u8fd9\u662f\u53e6\u4e00\u79cd\u903b\u8f91\u5220\u9664\u65b9\u5f0f\u3002 \u9700\u8981\u6ce8\u610f\uff0cread\u548cdirty\u4e4b\u95f4\u662f\u4f1a\u76f8\u4e92\u8f6c\u6362\u7684\uff0c\u5728dirty\u4e2d\u67e5\u627e\u952e\u503c\u5bf9\u6b21\u6570\u8db3\u591f\u591a\u7684\u65f6\u5019\uff0c sync.Map \u4f1a\u628adirty\u76f4\u63a5\u4f5c\u4e3aread\uff0c\u4fdd\u5b58\u5728\u5b83\u7684read\u5b57\u6bb5\u4e2d\uff0c\u7136\u540e\u628a\u4ee3\u8868dirty\u7684dirty\u5b57\u6bb5\u7f6e\u4e3anil\u3002 \u5728\u8fd9\u4e4b\u540e\uff0c\u4e00\u65e6\u518d\u6709\u65b0\u7684\u952e\u503c\u5bf9\u5b58\u5165\uff0c\u5b83\u5c31\u4f1a\u4f9d\u636eread\u53bb\u91cd\u5efadirty\uff0c\u8fd9\u4e2a\u65f6\u5019\u4f1a\u628aread\u4e2d\u5df2\u7ecf\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u8fc7\u6ee4\u6389\uff0c\u8fd9\u4e9b\u64cd\u4f5c\u90fd\u5728\u9501\u7684\u4fdd\u62a4\u4e0b\u8fdb\u884c\u3002 \u7efc\u4e0a\uff0c sync.Map \u7684read\u548cdirty\u4e2d\u7684\u952e\u503c\u5bf9\u96c6\u5408\u5e76\u4e0d\u662f\u5b9e\u65f6\u540c\u6b65\u7684\uff0c\u5b83\u4eec\u5728\u67d0\u4e9b\u65f6\u95f4\u6bb5\u5185\u53ef\u80fd\u4f1a\u4e0d\u540c\uff0c\u7531\u4e8eread\u4e2d\u7684\u952e\u503c\u5bf9\u7684\u96c6\u5408\u4e0d\u80fd\u88ab\u6539\u53d8\uff0c\u6240\u4ee5\u5176\u4e2d\u7684\u952e\u503c\u5bf9\u6709\u65f6\u5019\u53ef\u80fd\u662f\u4e0d\u5168\u7684\uff0c\u76f8\u53cd\uff0cdirty\u4e2d\u7684\u952e\u503c\u5bf9\u96c6\u5408\u603b\u662f\u5b8c\u5168\u7684\uff0c\u5e76\u4e14\u5176\u4e2d\u4e0d\u4f1a\u5305\u542b\u5df2\u88ab\u903b\u8f91\u5220\u9664\u7684\u952e\u503c\u5bf9\u3002 \u56e0\u6b64\u5728\u8bfb\u64cd\u4f5c\u5f88\u591a\uff0c\u5199\u64cd\u4f5c\u5f88\u5c11\u7684\u60c5\u51b5\u4e0b\uff0c sync.Map \u7684\u6027\u80fd\u4f1a\u66f4\u597d\uff0c\u5728\u51e0\u4e2a\u5199\u64cd\u4f5c\u5f53\u4e2d\uff0c\u65b0\u589e\u952e\u503c\u5bf9\u7684\u64cd\u4f5c\u5bf9 sync.Map \u7684\u6027\u80fd\u5f71\u54cd\u6700\u5927\uff0c\u5176\u6b21\u662f\u5220\u9664\u64cd\u4f5c\uff0c\u6700\u540e\u662f\u4fee\u6539\u64cd\u4f5c \u3002\u5982\u679c\u88ab\u64cd\u4f5c\u7684\u952e\u503c\u5bf9\u5df2\u7ecf\u5b58\u5728\u4e8e sync.Map \u7684read\u4e2d\uff0c\u5e76\u4e14\u6ca1\u6709\u88ab\u903b\u8f91\u5220\u9664\uff0c\u90a3\u4e48\u4fee\u6539\u5b83\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5230\u9501\uff0c\u5bf9\u5176\u6027\u80fd\u7684\u5f71\u54cd\u4f1a\u5f88\u5c0f\u3002","title":"sync.Map\u5982\u4f55\u5c3d\u91cf\u907f\u514d\u4f7f\u7528\u9501"},{"location":"Language/Basic/18-atomic/","text":"\u539f\u5b50\u64cd\u4f5c \u5bf9\u4e8e\u4e00\u4e2aGo\u7a0b\u5e8f\u6765\u8bf4\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4e2d\u7684\u8c03\u5ea6\u5668\u4f1a\u6070\u5f53\u5730\u5b89\u6392\u5176\u4e2d\u6240\u4ee5\u7684goroutine\u8fd0\u884c\u3002 \u4e0d\u8fc7\uff0c \u5728\u540c\u4e00\u65f6\u523b\uff0c\u53ea\u53ef\u80fd\u6709\u5c11\u6570\u7684goroutine\u771f\u6b63\u5730\u5904\u4e8e\u8fd0\u884c\u72b6\u6001 \uff0c\u5e76\u4e14\u8fd9\u4e2a\u6570\u91cf\u53ea\u4f1a\u4e0eM\u7684\u6570\u91cf\u4e00\u76f4\uff0c\u800c\u4e0d\u4f1a\u968f\u7740G\u7684\u589e\u591a\u800c\u589e\u957f\u3002 \u4e3a\u4e86\u516c\u5e73\u671f\u95f4\uff0c\u8c03\u5ea6\u5668\u603b\u662f\u4f1a\u9891\u7e41\u5730\u6362\u4e0a\u6216\u8005\u6362\u4e0b\u8fd9\u4e9bgoroutine\u3002 \u6362\u4e0a\uff1a\u8ba9\u4e00\u4e2agoroutine\u7531\u8d39\u8fd0\u884c\u72b6\u6001\u8f6c\u4e3a\u8fd0\u884c\u72b6\u6001\uff0c\u5e76\u4fc3\u4f7f\u5176\u4e2d\u7684\u4ee3\u7801\u5728\u67d0\u4e00\u4e2aCPU\u6838\u5fc3\u4e0a\u6267\u884c \u6362\u4e0b\uff1a\u662f\u4e00\u4e2agoroutine\u4e2d\u7684\u4ee3\u7801\u4e2d\u65ad\u6267\u884c\uff0c\u5e76\u8ba9\u5b83\u7531\u8fd0\u884c\u72b6\u6001\u8f6c\u4e3a\u975e\u8fd0\u884c\u72b6\u6001 \u8fd9\u4e2a\u4e2d\u65ad\u7684\u65f6\u673a\u6709\u5f88\u591a\uff0c\u4efb\u4f55\u4e24\u6761\u8bed\u53e5\u6267\u884c\u7684\u95f4\u9699\uff0c\u751a\u81f3\u5728\u67d0\u6761\u8bed\u53e5\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u90fd\u53ef\u4ee5\uff0c\u5373\u4f7f\u8fd9\u6761\u8bed\u53e5\u5728\u4e34\u754c\u533a\u4e4b\u5185 \u3002 \u4e92\u65a5\u9501\u867d\u7136\u53ef\u4ee5\u4fdd\u8bc1\u4e34\u754c\u533a\u4e2d\u4ee3\u7801\u7684\u4e32\u884c\u6267\u884c\uff0c\u4f46\u5374\u4e0d\u80fd\u4fdd\u8bc1\u8fd9\u4e9b\u4ee3\u7801\u6267\u884c\u7684\u539f\u5b50\u6027(atomicity)\u3002 \u5728\u4f17\u591a\u540c\u6b65\u5de5\u5177\u4e2d\uff0c\u771f\u6b63\u80fd\u591f\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u53ea\u6709\u539f\u5b50\u64cd\u4f5c\u3002 \u539f\u5b50\u64cd\u4f5c\u5728\u8fdb\u884c\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u5141\u8bb8\u4e2d\u65ad \u3002\u5728\u5e95\u5c42\uff0c\u8fd9\u4f1a\u7531CPU\u63d0\u4f9b\u82af\u7247\u7ea7\u522b\u7684\u652f\u6301\uff0c\u6240\u4ee5\u7edd\u5bf9\u6709\u6548\u3002\u5373\u4f7f\u5728\u62e5\u6709\u591aCPU\u6838\u5fc3\u6216\u8005\u591a\u4e2aCPU\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\uff0c\u539f\u5b50\u64cd\u4f5c\u7684\u4fdd\u8bc1\u4e5f\u662f\u4e0d\u53ef\u64bc\u52a8\u7684\u3002 \u539f\u5b50\u64cd\u4f5c\u53ef\u4ee5\u5b8c\u5168\u5730\u6d88\u9664\u7ade\u6001\u6761\u4ef6\uff0c\u5e76\u80fd\u591f\u7edd\u5bf9\u5730\u4fdd\u8bc1\u5e76\u53d1\u5b89\u5168\u6027\u3002\u5728\u6267\u884c\u901f\u5ea6\u4e0a\u6bd4\u5176\u4ed6\u7684\u540c\u6b65\u5de5\u5177\u5feb\u5f88\u591a\uff0c\u901a\u5e38\u4f1a\u9ad8\u51fa\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002 \u6b63\u662f\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u4e0d\u80fd\u88ab\u7ec8\u7aef\uff0c\u6240\u4ee5\u9700\u8981\u8db3\u591f\u7b80\u5355\uff0c\u5e76\u4e14\u8981\u6c42\u5feb\u901f \u3002 \u5982\u679c\u539f\u5b50\u64cd\u4f5c\u8fdf\u8fdf\u4e0d\u80fd\u5b8c\u6210\uff0c\u800c\u5b83\u53c8\u4e0d\u4f1a\u88ab\u4e2d\u65ad\uff0c\u90a3\u4e48\u5c06\u4f1a\u7ed9\u8ba1\u7b97\u673a\u6267\u884c\u6307\u4ee4\u7684\u6548\u7387\u5e26\u6765\u591a\u4e48\u5927\u7684\u5f71\u54cd\u3002\u56e0\u6b64\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u53ea\u9488\u5bf9 \u4e8c\u8fdb\u5236 \u6216 \u6574\u6570 \u7684\u539f\u5b50\u64cd\u4f5c\u63d0\u4f9b\u652f\u6301\u3002 Go\u8bed\u8a00\u7684\u539f\u5b50\u64cd\u4f5c\u4e5f\u662f\u57fa\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u548cCPU\u7684\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u5c11\u6570\u6570\u636e\u7c7b\u578b\u7684\u503c\u63d0\u4f9b\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u3002\u8fd9\u4e9b\u51fd\u6570\u5728 sync/atomic \u5305\u4e2d\u3002 sync/atomic\u63d0\u4f9b\u7684\u539f\u5b50\u64cd\u4f5c\u4e0e\u53ef\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b sync/atomic\u5305\u4e2d\u7684\u51fd\u6570\u53ef\u4ee5\u505a\u7684\u539f\u5b50\u64cd\u4f5c\uff1a \u52a0\u6cd5\uff08add\uff09 \u6bd4\u8f83\u5e76\u4ea4\u6362\uff08compare and swap\uff0c\u7b80\u79f0CAS\uff09 \u52a0\u8f7d\uff08load\uff09 \u5b58\u50a8\uff08store\uff09 \u4ea4\u6362\uff08swap\uff09 \u8fd9\u4e9b\u51fd\u6570\u9488\u5bf9\u7684\u6570\u636e\u7c7b\u578b\u5e76\u4e0d\u591a\uff0c\u4f46\u662f\u5bf9\u8fd9\u4e9b\u7c7b\u578b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u6709\u4e00\u5957\u51fd\u6570\u7ed9\u4e88\u652f\u6301\u3002 \u53ef\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b\uff1a int32 int64 uint32 uint64 uintptr unsafe\u5305\u4e2d\u7684Pointer\uff1a\u5bf9unsate.Pointer\u7c7b\u578b\u6ca1\u6709\u63d0\u4f9b\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u7684\u51fd\u6570 sync/atomic\u5305\u4e2d\u8fd8\u63d0\u4f9b\u4e86\u540d\u4e3aValue\u7684\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u503c\u3002 \u6ce8\u610f\u70b91 \u4f20\u5165\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u503c\u5bf9\u5e94\u7684\u90fd\u5e94\u8be5\u662f\u90a3\u4e2a\u88ab\u64cd\u4f5c\u7684\u503c\uff0c\u5982\uff1a func AddInt32(addr *int32, delta int32) (new int32) // \u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06\u589e\u91cf\u6dfb\u52a0\u5230 *addr \u5e76\u8fd4\u56de\u65b0\u7684\u503c \u4e0a\u9762\u51fd\u6570\u7684\u4e00\u4e2a\u53c2\u6570\u5e94\u8be5\u662f\u90a3\u4e2a\u9700\u8981\u88ab\u589e\u5927\u7684\u6574\u6570\u3002\u8fd9\u4e2a\u53c2\u6570\u7c7b\u578b\u4e3a\u4ec0\u4e48\u662f *int32 \uff1f\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u9700\u8981\u7684\u662f\u88ab\u64cd\u4f5c\u503c\u7684\u6307\u9488\uff0c\u800c\u4e0d\u662f\u8fd9\u4e2a\u503c\u672c\u8eab\uff0c\u88ab\u4f20\u5165\u51fd\u6570\u7684\u53c2\u6570\u503c\u90fd\u4f1a\u88ab\u590d\u5236\uff0c\u50cf\u8fd9\u79cd\u57fa\u672c\u7c7b\u578b\u7684\u503c\u4e00\u65e6\u88ab\u4f20\u5165\u51fd\u6570\uff0c\u5c31\u5df2\u7ecf\u4e0e\u51fd\u6570\u5916\u7684\u90a3\u4e2a\u503c\u6beb\u65e0\u5173\u7cfb\u4e86\u3002 \u4f20\u5165\u503c\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u610f\u4e49 \u3002 unsafe.Pointer\u7c7b\u578b\u867d\u7136\u662f\u6307\u9488\u7c7b\u578b\uff0c\u4f46\u662f\u90a3\u4e9b\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u8981\u64cd\u4f5c\u7684\u662f\u8fd9\u4e2a\u6307\u9488\u503c\uff0c\u800c\u4e0d\u662f\u5b83\u6307\u5411\u7684\u90a3\u4e2a\u503c\uff0c\u6240\u4ee5\u9700\u8981\u7684\u4ecd\u7136\u662f\u8fd9\u6307\u5411\u8fd9\u4e2a\u6307\u9488\u503c\u7684\u6307\u9488\u3002 \u53ea\u8981\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u62ff\u5230\u4e86\u88ab\u64cd\u4f5c\u503c\u7684\u6307\u9488\uff0c\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u5230\u5b58\u50a8\u8be5\u503c\u7684\u5185\u5b58\u5730\u5740\uff0c\u5c31\u80fd\u901a\u8fc7\u5e95\u5c42\u7684\u6307\u4ee4\uff0c\u51c6\u786e\u5730\u64cd\u4f5c\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u4e0a\u7684\u6570\u636e \u3002 \u6ce8\u610f\u70b92 \u7528\u4e8e\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u7684\u51fd\u6570\u53ef\u4ee5\u505a\u539f\u5b50\u51cf\u6cd5\u5417\uff1f func AddInt32(addr *int32, delta int32) (new int32) // \u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06\u589e\u91cf\u6dfb\u52a0\u5230 *addr \u5e76\u8fd4\u56de\u65b0\u7684\u503c \u4e0a\u9762\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4ee3\u8868\u589e\u91cf\uff0c\u5b83\u7684\u7c7b\u578b\u662fint32\uff0c\u662f\u6709\u7b26\u53f7\u7684\uff0c\u5c06\u589e\u91cf\u503c\u8bbe\u7f6e\u4e3a\u8d1f\u6570\u5c31\u80fd\u5b9e\u73b0\u539f\u5b50\u51cf\u6cd5\u64cd\u4f5c\u3002 \u4f46\u662f\u4e0b\u9762\u4e24\u4e2a\u51fd\u6570\u5c31\u4e0d\u80fd\u76f4\u63a5\u5c06\u589e\u91cf\u503c\u8d4b\u4e88\u4e3a\u8d1f\u6570\u8fdb\u884c\u51cf\u6cd5\uff0c\u56e0\u4e3a\u7b2c\u4e8c\u4e2a\u8868\u793a\u589e\u91cf\u7684\u53c2\u6570\u662f\u65e0\u7b26\u53f7\u7684\uff1a func AddUint32(addr *uint32, delta uint32) (new uint32) func AddUint32(addr *uint32, delta uint32) (new uint32) \u5047\u8bbe\u8981\u5c06\u4e0a\u9762\u7684\u589e\u91cf\u8d4b\u4e88 -3 \uff0c\u53ef\u4ee5\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff1a uint32(int32(-3)) \uff0c\u8fd9\u6837\u8f6c\u6362\u540eGo\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\u201c\u5e38\u91cf-3\u4e0d\u5728unit32\u7c7b\u578b\u53ef\u8868\u793a\u8303\u56f4\u5185\u201d\uff0c\u5373\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u6ea2\u51fa\u3002 \u6362\u4e2a\u64cd\u4f5c\u65b9\u5f0f\uff0c\u5148\u5c06 int32(-3) \u8d4b\u4e88\u589e\u91cf\uff0c\u5728\u5c06\u589e\u91cf\u7684\u7c7b\u578b\u8f6c\u6362\u4e3aunit32\uff0c\u8fd9\u6837\u53ef\u4ee5\u7ed5\u8fc7\u7f16\u8bd1\u5668\u7684\u68c0\u67e5\u5e76\u5f97\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002\u5c06\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\u4f20\u9012\u7ed9\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u6765\u5b9e\u73b0\u539f\u5b50\u51cf\u6cd5\u76ee\u7684\u3002 \u5b98\u65b9\u6587\u65e6\u5c55\u793a\u4e86\u53e6\u4e00\u79cd\u64cd\u4f5c\u65b9\u5f0f\uff0c ^uint32(-N-1) \uff0c\u5176\u4e2dN\u8868\u793a\u589e\u91cf\u7684\u8d1f\u6574\u6570\uff0c\u5373\uff1a \u5148\u628a\u589e\u91cf\u7684\u7edd\u5bf9\u503c\u51cf\u53bb1 \u518d\u628a\u5f97\u5230\u7684\u65e0\u7c7b\u578b\u7684\u6574\u6570\u5e38\u91cf\u8f6c\u6362\u6211uint32\u7c7b\u578b\u7684\u503c \u5728\u8fd9\u4e2a\u503c\u4e0a\u505a\u6309\u4f4d\u5f02\u6216\u64cd\u4f5c\u5f97\u5230\u6700\u7ec8\u7684\u53c2\u6570\u503c \u6ce8\u610f\u70b93 CAS\u4e0eswap\u7684\u4e0d\u540c\u53ca\u4f18\u52bf\uff1a CAS\u662f\u6709\u6761\u4ef6\u7684\u4ea4\u6362\u64cd\u4f5c\uff0c\u53ea\u6709\u5728\u6761\u4ef6\u6ee1\u8db3\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u8fdb\u884c\u503c\u7684\u4ea4\u6362\u3002\uff08\u6240\u8c13\u7684\u4ea4\u6362\u5c31\u662f\u628a\u65b0\u7684\u503c\u8d4b\u4e88\u7ed9\u53d8\u91cf\uff0c\u5e76\u8fd4\u56de\u65e7\u7684\u503c\uff09 \u5728\u8fdb\u884cCAS\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u51fd\u6570\u4f1a\u5148\u5224\u65ad\u88ab\u64cd\u4f5c\u7684\u53d8\u91cf\u7684\u5f53\u524d\u503c\u662f\u5426\u4e0e\u9884\u671f\u7684\u65e7\u503c\u76f8\u7b49\u3002 \u5982\u679c\u76f8\u7b49\uff0c\u5c31\u628a\u65b0\u503c\u8d4b\u7ed9\u8be5\u53d8\u91cf\uff0c\u5e76\u8fd4\u56detrue\u4ee5\u8868\u660e\u4ea4\u6362\u64cd\u4f5c\u5df2\u8fdb\u884c \u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u5c31\u5ffd\u7565\u4ea4\u6362\u64cd\u4f5c\uff0c\u5e76\u8fd4\u56defalse CAS\u64cd\u4f5c\u5e76\u4e0d\u662f\u5355\u4e00\u7684\u64cd\u4f5c\uff0c\u800c\u662f\u4e00\u79cd\u64cd\u4f5c\u7ec4\u5408 \u3002\u8fd9\u4e00\u5176\u4ed6\u7684\u539f\u5b50\u64cd\u4f5c\u90fd\u4e0d\u540c\uff0c\u56e0\u6b64\u5b83\u7684\u7528\u9014\u66f4\u5e7f\u6cdb\u3002\u4f8b\u5982\uff0c\u5c06\u5b83\u4e0efor\u5faa\u73af\u8054\u7528\u5b9e\u73b0\u4e00\u79cd\u5efa\u8bae\u7684\u81ea\u65cb\u9501\uff08spinlock\uff09\uff1a for { if atomic.CompareAndSwapInt32( num2, 10, 0) { fmt.Println( The second number has gone to zero. ) break } time.Sleep(time.Millisecond * 500) } // \u5728for\u5faa\u73af\u4e2d\u7684CAS\u64cd\u4f5c\u53ef\u4ee5\u4e0d\u505c\u68c0\u67e5\u67d0\u4e2a\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff0c\u4e00\u65e6\u6761\u4ef6\u6ee1\u8db3\u5c31\u9000\u51fafor\u5faa\u73af // \u53ea\u8981\u6761\u4ef6\u672a\u6ee1\u8db3\uff0c\u5f53\u524d\u7684\u6d41\u7a0b\u5c31\u4f1a\u88ab\u4e00\u76f4\u963b\u585e\u5728\u8fd9\u91cc \u8fd9\u4e0e\u4e92\u65a5\u9501\u7c7b\u4f3c\uff0c\u4f46\u9002\u7528\u573a\u666f\u4e0d\u540c\uff1a \u4e92\u65a5\u9501 \uff1a\u603b\u662f\u5047\u8bbe\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u4f1a\u88ab\u5176\u4ed6\u7684goroutine\u9891\u7e41\u5730\u6539\u53d8 for\u5faa\u73af+CAS\u64cd\u4f5c\uff1a\u603b\u662f\u5047\u8bbe\u5171\u4eab\u8d44\u6e90\u72b6\u6001\u7684\u6539\u53d8\u4e0d\u662f\u5f88\u9891\u7e41\uff0c\u6216\u8005\uff0c\u5b83\u7684\u72b6\u6001\u603b\u4f1a\u53d8\u6210\u671f\u671b\u7684\u90a3\u6837\uff0c\u8fd9\u662f\u4e00\u79cd\u4e50\u89c2\u5047\u8bbe \u6ce8\u610f\u70b94 \u5bf9\u4e00\u4e2a\u53d8\u91cf\u7684\u5199\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u64cd\u4f5c\uff08\u5982\uff0c\u52a0\u51cf\u3001\u5b58\u50a8\u3001\u4ea4\u6362\u7b49\uff09\uff0c\u90a3\u4e48\u5bf9\u5b83\u7684\u8bfb\u64cd\u4f5c\u8fd8\u9700\u8981\u662f\u539f\u5b50\u64cd\u4f5c\u5417\uff1f \u6709\u5fc5\u8981 \u3002\u5c31\u50cf\u8bfb\u5199\u9501\u4e2d\u5199\u64cd\u4f5c\u4e0e\u8bfb\u64cd\u4f5c\u662f\u4e92\u65a5\u7684\u3002 \u8fd9\u662f\u4e3a\u4e86\u9632\u6b62\u8bfb\u64cd\u4f5c\u8bfb\u5230\u672a\u88ab\u4fee\u6539\u5b8c\u7684\u503c \u3002 \u6240\u4ee5\u8981\u5bf9\u5171\u4eab\u8d44\u6e90\u8fdb\u884c\u4fdd\u62a4\uff0c\u90a3\u5c31\u8981\u5b8c\u5168\u7684\u4fdd\u62a4\uff0c\u4e0d\u5b8c\u5168\u7684\u4fdd\u62a4\u57fa\u672c\u4e0a\u548c\u4e0d\u4fdd\u62a4\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\u3002 \u539f\u5b50\u64cd\u4f5c\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u5f88\u6709\u9650\uff0c\u6240\u4ee5\u5728\u5f88\u591a\u573a\u666f\u4e0b\uff0c\u4e92\u65a5\u9501\u66f4\u52a0\u9002\u7528 \u3002 \u4e00\u65e6\u786e\u5b9a\u67d0\u4e2a\u573a\u666f\u4e0b\u53ef\u4ee5\u9002\u7528\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\uff0c\u6bd4\u5982\u53ea\u6d89\u53ca\u5e76\u53d1\u5730\u8bfb\u5199\u5355\u4e00\u7684\u6574\u6570\u7c7b\u578b\u503c\uff0c\u6216\u8005\u591a\u4e2a\u4e92\u4e0d\u76f8\u5173\u7684\u6574\u6570\u7c7b\u578b\u503c\uff0c\u5c31\u4e0d\u8981\u8003\u8651\u4e92\u65a5\u9501\uff0c\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u7684\u6267\u884c\u901f\u5ea6\u8981\u6bd4\u4e92\u65a5\u9501\u5feb\u5f88\u591a\u3002\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u7b80\u5355\uff0c\u4e0d\u4f1a\u6d89\u53ca\u4e34\u754c\u533a\u7684\u9009\u62e9\uff0c\u6b7b\u9501\u7b49\u95ee\u9898\u3002 \u4f7f\u7528CAS\u64cd\u4f5c\u8981\u6ce8\u610f\u53ef\u80fd\u5f15\u8d77\u201c\u963b\u585e\u201d\u6d41\u7a0b \u3002 sync/atomic.Value \u4e3a\u4e86\u6269\u5927\u539f\u5b50\u64cd\u4f5c\u7684\u9002\u7528\u8303\u56f4\uff0cGo 1.4\u5728 sync/atomic \u5305\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u7c7b\u578bValue\uff0c\u6b64\u7c7b\u578b\u7684\u503c\u76f8\u5f53\u4e8e\u4e00\u4e2a \u5bb9\u5668 \uff0c\u53ef\u4ee5\u88ab\u7528\u6765 \u539f\u5b50\u5730\u5b58\u50a8\u548c\u52a0\u8f7d\u4efb\u610f\u7684\u503c \u3002 atomic.Value \u7c7b\u578b\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u58f0\u660e\u4e00\u4e2a\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff08\u7b80\u79f0\u539f\u5b50\u53d8\u91cf\uff09\u4e4b\u540e\u5c31\u76f4\u63a5\u4f7f\u7528\uff0c\u8be5\u7c7b\u578b\u53ea\u6709\u4e24\u4e2a\u6307\u9488\u65b9\u6cd5\uff1a Store \u548c Load \u3002 \u6ce8\u610f\u70b9 atomic.Value \u7c7b\u578b\u7684\u503c\uff08\u539f\u5b50\u503c\uff09\u88ab\u6b63\u771f\u4f7f\u7528\uff08\u7528\u539f\u5b50\u53d8\u91cf\u5b58\u50a8\u4e86\u503c\uff0c\u5c31\u76f8\u5f53\u4e8e\u771f\u6b63\u4f7f\u7528\uff09\uff0c\u5c31\u4e0d\u5e94\u8be5\u518d\u88ab\u590d\u5236\u4e86\u3002 atomic.Value \u7c7b\u578b\u5c5e\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u800c\u7ed3\u6784\u4f53\u7c7b\u578b\u5c5e\u4e8e\u503c\u7c7b\u578b\u3002\u6240\u4ee5\u590d\u5236\u8fd9\u4e2a\u503c\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5b8c\u5168\u5206\u79bb\u7684\u65b0\u503c\uff0c\u4e24\u8005\u600e\u4e48\u6539\u53d8\u90fd\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\u3002 \u7528\u539f\u5b50\u503c\u6765\u5b58\u50a8\u503c\uff0c\u6709\u4e24\u4e2a\u5f3a\u5236\u6027\u7684\u4f7f\u7528\u89c4\u5219\uff1a \u4e0d\u80fd\u7528\u539f\u5b50\u503c\u5b58\u50a8 nil \uff1a\u5373\u4e0d\u80fd\u628a nil \u4f5c\u4e3a\u53c2\u6570\u503c\u4f20\u5165\u539f\u5b50\u503c\u7684Store\u65b9\u6cd5\uff0c\u5426\u5219\u4f1a\u5f15\u53d1\u4e00\u4e2apanic \u6ce8\u610f\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5b83\u7684\u52a8\u6001\u503c\u7684nil\uff0c\u4f46\u52a8\u6001\u7c7b\u578b\u5374\u4e0d\u662fnil\uff0c\u90a3\u4e48\u5b83\u7684\u503c\u5c31\u4e0d\u7b49\u4e8enil\uff0c\u6240\u4ee5\u8fd9\u6837\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u53ef\u4ee5\u88ab\u5b58\u5165\u539f\u5b50\u503c\u4e2d\u3002 \u5411\u539f\u5b50\u503c\u5b58\u50a8\u7684\u7b2c\u4e00\u4e2a\u503c\uff0c\u51b3\u5b9a\u4e86\u5b83\u4eca\u540e\u80fd\u4e14\u53ea\u80fd\u5b58\u50a8\u54ea\u4e00\u4e2a\u7c7b\u578b\u7684\u503c \u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7b2c\u4e00\u6b21\u5b58\u50a8\u4e86string\u7c7b\u578b\u503c\u7684\u539f\u5b50\u503c\uff0c\u5728\u8c03\u7528Store\u53d1\u653e\u5b58\u50a8\u5176\u4ed6\u7c7b\u578b\u65f6\u4f1a\u5f15\u53d1\u4e00\u4e2apanic\uff0c\u63d0\u793a\u8fd9\u6b21\u5b58\u50a8\u7684\u503c\u7684\u7c7b\u578b\u4e0e\u4e4b\u524d\u7684\u4e0d\u4e00\u81f4\u3002 \u5728\u539f\u5b50\u503c\u5185\u90e8\u4f9d\u636e\u88ab\u5b58\u50a8\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u8fdb\u884c\u5224\u65ad\uff0c\u6240\u4ee5\u5373\u4f7f\u5b9e\u73b0\u4e86\u540c\u4e00\u4e2a\u63a5\u53e3\u7684\u4e0d\u540c\u7c7b\u578b\uff0c\u5b83\u4eec\u7684\u503c\u4e5f\u4e0d\u80fd\u88ab\u5148\u540e\u5b58\u50a8\u5728\u540c\u4e00\u4e2a\u539f\u5b50\u503c\u4e2d \u3002 \u9057\u61be\u7684\u662f\uff1a \u65e0\u6cd5\u901a\u8fc7\u67d0\u4e2a\u65b9\u6cd5\u77e5\u9053\u4e00\u4e2a\u539f\u5b50\u503c\u662f\u5426\u5df2\u7ecf\u88ab\u771f\u6b63\u4f7f\u7528 \u65e0\u6cd5\u901a\u8fc7\u5e38\u89c4\u56fe\u89e3\u5f97\u5230\u4e00\u4e2a\u539f\u5b50\u503c\u5b58\u50a8\u7684\u5b9e\u9645\u7c7b\u578b \u8fd9\u4f7f\u5f97\u8bef\u7528\u539f\u5b50\u503c\u7684\u53ef\u80fd\u6027\u5927\u5927\u589e\u52a0\uff0c\u5c24\u5176\u5728\u591a\u4e2a\u5730\u65b9\u4f7f\u7528\u540c\u4e00\u4e2a\u539f\u5b50\u503c\u3002 \u5efa\u8bae \u4e0d\u8981\u628a\u5185\u90e8\u4f7f\u7528\u7684\u539f\u5b50\u503c\u66b4\u9732\u7ed9\u5916\u754c\uff0c\u6bd4\u5982\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u7684\u539f\u5b50\u53d8\u91cf\u5e76\u4e0d\u662f\u4e00\u4e2a\u6b63\u786e\u7684\u505a\u6cd5\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bbf\u95ee\u6743\u9650\u81f3\u5c11\u5e94\u8be5\u662f\u5305\u7ea7\u79c1\u6709\u3002 \u5982\u679c\u4e0d\u5f97\u4e0d\u8ba9\u5305\u5916\uff0c\u6216\u8005\u6a21\u5757\u5916\u7684\u4ee3\u7801\u4f7f\u7528\u539f\u5b50\u503c\uff0c\u53ef\u4ee5\u58f0\u660e\u4e00\u4e2a\u5305\u7ea7\u79c1\u6709\u7684\u539f\u5b50\u53d8\u91cf\uff0c\u7136\u540e\u518d\u901a\u8fc7\u4e00\u4e2a\u6216\u591a\u4e2a\u516c\u5f00\u7684\u51fd\u6570\uff0c\u8ba9\u5916\u754c\u95f4\u63a5\u5730\u4f7f\u7528\u5230\u5b83\u3002 \u6ce8\u610f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u8981\u628a\u539f\u5b50\u503c\u4f20\u9012\u5230\u5916\u754c\uff0c\u4e0d\u8bba\u662f\u4f20\u9012\u539f\u5b50\u503c\u672c\u8eab\u8fd8\u662f\u5b83\u7684\u6307\u9488\u503c \u3002 \u5982\u679c\u901a\u8fc7\u67d0\u4e2a\u51fd\u6570\u53ef\u4ee5\u5411\u5185\u90e8\u7684\u539f\u5b50\u503c\u5b58\u50a8\u503c\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\u5148\u5224\u65ad\u88ab\u5b58\u50a8\u503c\u7c7b\u578b\u7684\u5408\u6cd5\u578b\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\uff0c\u76f4\u63a5\u8fd4\u56de\u5bf9\u5e94\u7684\u9519\u8bef\u7406\u6027\uff0c\u4ece\u800c\u907f\u514dpanic\u7684\u53d1\u751f\u3002 \u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u628a\u539f\u5b50\u503c\u5c01\u88c5\u5230\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u4e2d\uff0c\u6bd4\u5982\u7ed3\u6784\u4f53\uff0c\u8fd9\u6837\u65e2\u53ef\u4ee5\u901a\u8fc7\u8be5\u7c7b\u578b\u7684\u65b9\u6cd5\u66f4\u52a0\u5b89\u5168\u5730\u5b58\u50a8\u503c\uff0c\u6709\u53ef\u4ee5\u5728\u8be5\u7c7b\u578b\u4e2d\u5305\u542b\u53ef\u5b58\u50a8\u503c\u7684\u5408\u6cd5\u4fe1\u606f\u3002 \u5c3d\u91cf\u4e0d\u8981\u5728\u539f\u5b50\u503c\u4e2d\u5b58\u50a8\u5f15\u7528\u7c7b\u578b\u7684\u503c\uff0c\u56e0\u4e3a\u5bb9\u6613\u9020\u6210\u5b89\u5168\u6f0f\u6d1e \u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var box6 atomic.Value v6 := []int{1, 2, 3} // \u5207\u7247\uff0c\u5f15\u7528\u7c7b\u578b box6.Store(v6) v6[1] = 4 // \u6ce8\u610f\uff0c\u6b64\u5904\u7684\u64cd\u4f5c\u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff01 // \u4e0a\u8ff0\u64cd\u4f5c\u4fee\u6539\u4e86\u5207\u7247\u4e2d\u7684\u503c\uff0c\u4e5f\u5c31\u4fee\u6539\u4e86box6\u4e2d\u5b58\u50a8\u7684\u503c // \u8fd9\u6837\u7ed5\u8fc7\u4e86\u539f\u5b50\u503c\u800c\u8fdb\u884c\u4e86\u975e\u5e76\u53d1\u5b89\u5168\u7684\u64cd\u4f5c // \u4fee\u6539\u4e3a\u8fd9\u6837 store := func(v []int) { replica := make([]int, len(v)) // \u4e3a\u5207\u7247\u503c\u521b\u5efa\u4e00\u4e2a\u526f\u672c\uff0c\u526f\u672c\u6d89\u53ca\u7684\u6570\u636e\u4e0e\u539f\u503c\u6beb\u4e0d\u76f8\u5173 copy(replica, v) box6.Store(replica) // \u628a\u526f\u672c\u5b58\u50a8\u5230box6\u4e2d } store(v6) v6[2] = 5 // \u6b64\u5904\u7684\u64cd\u4f5c\u662f\u5b89\u5168\u7684\u3002 // \u4fee\u6539\u5207\u7247\u4e2d\u7684\u503c\uff0c\u4e0d\u4f1a\u4fee\u6539box6\u4e2d\u7684\u503c","title":"\u539f\u5b50\u64cd\u4f5c"},{"location":"Language/Basic/18-atomic/#_1","text":"\u5bf9\u4e8e\u4e00\u4e2aGo\u7a0b\u5e8f\u6765\u8bf4\uff0cGo\u8bed\u8a00\u8fd0\u884c\u65f6\u7cfb\u7edf\u4e2d\u7684\u8c03\u5ea6\u5668\u4f1a\u6070\u5f53\u5730\u5b89\u6392\u5176\u4e2d\u6240\u4ee5\u7684goroutine\u8fd0\u884c\u3002 \u4e0d\u8fc7\uff0c \u5728\u540c\u4e00\u65f6\u523b\uff0c\u53ea\u53ef\u80fd\u6709\u5c11\u6570\u7684goroutine\u771f\u6b63\u5730\u5904\u4e8e\u8fd0\u884c\u72b6\u6001 \uff0c\u5e76\u4e14\u8fd9\u4e2a\u6570\u91cf\u53ea\u4f1a\u4e0eM\u7684\u6570\u91cf\u4e00\u76f4\uff0c\u800c\u4e0d\u4f1a\u968f\u7740G\u7684\u589e\u591a\u800c\u589e\u957f\u3002 \u4e3a\u4e86\u516c\u5e73\u671f\u95f4\uff0c\u8c03\u5ea6\u5668\u603b\u662f\u4f1a\u9891\u7e41\u5730\u6362\u4e0a\u6216\u8005\u6362\u4e0b\u8fd9\u4e9bgoroutine\u3002 \u6362\u4e0a\uff1a\u8ba9\u4e00\u4e2agoroutine\u7531\u8d39\u8fd0\u884c\u72b6\u6001\u8f6c\u4e3a\u8fd0\u884c\u72b6\u6001\uff0c\u5e76\u4fc3\u4f7f\u5176\u4e2d\u7684\u4ee3\u7801\u5728\u67d0\u4e00\u4e2aCPU\u6838\u5fc3\u4e0a\u6267\u884c \u6362\u4e0b\uff1a\u662f\u4e00\u4e2agoroutine\u4e2d\u7684\u4ee3\u7801\u4e2d\u65ad\u6267\u884c\uff0c\u5e76\u8ba9\u5b83\u7531\u8fd0\u884c\u72b6\u6001\u8f6c\u4e3a\u975e\u8fd0\u884c\u72b6\u6001 \u8fd9\u4e2a\u4e2d\u65ad\u7684\u65f6\u673a\u6709\u5f88\u591a\uff0c\u4efb\u4f55\u4e24\u6761\u8bed\u53e5\u6267\u884c\u7684\u95f4\u9699\uff0c\u751a\u81f3\u5728\u67d0\u6761\u8bed\u53e5\u6267\u884c\u7684\u8fc7\u7a0b\u4e2d\u90fd\u53ef\u4ee5\uff0c\u5373\u4f7f\u8fd9\u6761\u8bed\u53e5\u5728\u4e34\u754c\u533a\u4e4b\u5185 \u3002 \u4e92\u65a5\u9501\u867d\u7136\u53ef\u4ee5\u4fdd\u8bc1\u4e34\u754c\u533a\u4e2d\u4ee3\u7801\u7684\u4e32\u884c\u6267\u884c\uff0c\u4f46\u5374\u4e0d\u80fd\u4fdd\u8bc1\u8fd9\u4e9b\u4ee3\u7801\u6267\u884c\u7684\u539f\u5b50\u6027(atomicity)\u3002 \u5728\u4f17\u591a\u540c\u6b65\u5de5\u5177\u4e2d\uff0c\u771f\u6b63\u80fd\u591f\u4fdd\u8bc1\u539f\u5b50\u6027\u7684\u53ea\u6709\u539f\u5b50\u64cd\u4f5c\u3002 \u539f\u5b50\u64cd\u4f5c\u5728\u8fdb\u884c\u7684\u8fc7\u7a0b\u4e2d\u4e0d\u5141\u8bb8\u4e2d\u65ad \u3002\u5728\u5e95\u5c42\uff0c\u8fd9\u4f1a\u7531CPU\u63d0\u4f9b\u82af\u7247\u7ea7\u522b\u7684\u652f\u6301\uff0c\u6240\u4ee5\u7edd\u5bf9\u6709\u6548\u3002\u5373\u4f7f\u5728\u62e5\u6709\u591aCPU\u6838\u5fc3\u6216\u8005\u591a\u4e2aCPU\u7684\u8ba1\u7b97\u673a\u7cfb\u7edf\u4e2d\uff0c\u539f\u5b50\u64cd\u4f5c\u7684\u4fdd\u8bc1\u4e5f\u662f\u4e0d\u53ef\u64bc\u52a8\u7684\u3002 \u539f\u5b50\u64cd\u4f5c\u53ef\u4ee5\u5b8c\u5168\u5730\u6d88\u9664\u7ade\u6001\u6761\u4ef6\uff0c\u5e76\u80fd\u591f\u7edd\u5bf9\u5730\u4fdd\u8bc1\u5e76\u53d1\u5b89\u5168\u6027\u3002\u5728\u6267\u884c\u901f\u5ea6\u4e0a\u6bd4\u5176\u4ed6\u7684\u540c\u6b65\u5de5\u5177\u5feb\u5f88\u591a\uff0c\u901a\u5e38\u4f1a\u9ad8\u51fa\u597d\u51e0\u4e2a\u6570\u91cf\u7ea7\u3002 \u6b63\u662f\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u4e0d\u80fd\u88ab\u7ec8\u7aef\uff0c\u6240\u4ee5\u9700\u8981\u8db3\u591f\u7b80\u5355\uff0c\u5e76\u4e14\u8981\u6c42\u5feb\u901f \u3002 \u5982\u679c\u539f\u5b50\u64cd\u4f5c\u8fdf\u8fdf\u4e0d\u80fd\u5b8c\u6210\uff0c\u800c\u5b83\u53c8\u4e0d\u4f1a\u88ab\u4e2d\u65ad\uff0c\u90a3\u4e48\u5c06\u4f1a\u7ed9\u8ba1\u7b97\u673a\u6267\u884c\u6307\u4ee4\u7684\u6548\u7387\u5e26\u6765\u591a\u4e48\u5927\u7684\u5f71\u54cd\u3002\u56e0\u6b64\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u53ea\u9488\u5bf9 \u4e8c\u8fdb\u5236 \u6216 \u6574\u6570 \u7684\u539f\u5b50\u64cd\u4f5c\u63d0\u4f9b\u652f\u6301\u3002 Go\u8bed\u8a00\u7684\u539f\u5b50\u64cd\u4f5c\u4e5f\u662f\u57fa\u4e8e\u64cd\u4f5c\u7cfb\u7edf\u548cCPU\u7684\uff0c\u6240\u4ee5\u53ea\u80fd\u5bf9\u5c11\u6570\u6570\u636e\u7c7b\u578b\u7684\u503c\u63d0\u4f9b\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u3002\u8fd9\u4e9b\u51fd\u6570\u5728 sync/atomic \u5305\u4e2d\u3002","title":"\u539f\u5b50\u64cd\u4f5c"},{"location":"Language/Basic/18-atomic/#syncatomic","text":"sync/atomic\u5305\u4e2d\u7684\u51fd\u6570\u53ef\u4ee5\u505a\u7684\u539f\u5b50\u64cd\u4f5c\uff1a \u52a0\u6cd5\uff08add\uff09 \u6bd4\u8f83\u5e76\u4ea4\u6362\uff08compare and swap\uff0c\u7b80\u79f0CAS\uff09 \u52a0\u8f7d\uff08load\uff09 \u5b58\u50a8\uff08store\uff09 \u4ea4\u6362\uff08swap\uff09 \u8fd9\u4e9b\u51fd\u6570\u9488\u5bf9\u7684\u6570\u636e\u7c7b\u578b\u5e76\u4e0d\u591a\uff0c\u4f46\u662f\u5bf9\u8fd9\u4e9b\u7c7b\u578b\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u6709\u4e00\u5957\u51fd\u6570\u7ed9\u4e88\u652f\u6301\u3002 \u53ef\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b\uff1a int32 int64 uint32 uint64 uintptr unsafe\u5305\u4e2d\u7684Pointer\uff1a\u5bf9unsate.Pointer\u7c7b\u578b\u6ca1\u6709\u63d0\u4f9b\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u7684\u51fd\u6570 sync/atomic\u5305\u4e2d\u8fd8\u63d0\u4f9b\u4e86\u540d\u4e3aValue\u7684\u7c7b\u578b\uff0c\u7528\u4e8e\u5b58\u50a8\u4efb\u610f\u7c7b\u578b\u7684\u503c\u3002","title":"sync/atomic\u63d0\u4f9b\u7684\u539f\u5b50\u64cd\u4f5c\u4e0e\u53ef\u64cd\u4f5c\u7684\u6570\u636e\u7c7b\u578b"},{"location":"Language/Basic/18-atomic/#1","text":"\u4f20\u5165\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u503c\u5bf9\u5e94\u7684\u90fd\u5e94\u8be5\u662f\u90a3\u4e2a\u88ab\u64cd\u4f5c\u7684\u503c\uff0c\u5982\uff1a func AddInt32(addr *int32, delta int32) (new int32) // \u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06\u589e\u91cf\u6dfb\u52a0\u5230 *addr \u5e76\u8fd4\u56de\u65b0\u7684\u503c \u4e0a\u9762\u51fd\u6570\u7684\u4e00\u4e2a\u53c2\u6570\u5e94\u8be5\u662f\u90a3\u4e2a\u9700\u8981\u88ab\u589e\u5927\u7684\u6574\u6570\u3002\u8fd9\u4e2a\u53c2\u6570\u7c7b\u578b\u4e3a\u4ec0\u4e48\u662f *int32 \uff1f\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u9700\u8981\u7684\u662f\u88ab\u64cd\u4f5c\u503c\u7684\u6307\u9488\uff0c\u800c\u4e0d\u662f\u8fd9\u4e2a\u503c\u672c\u8eab\uff0c\u88ab\u4f20\u5165\u51fd\u6570\u7684\u53c2\u6570\u503c\u90fd\u4f1a\u88ab\u590d\u5236\uff0c\u50cf\u8fd9\u79cd\u57fa\u672c\u7c7b\u578b\u7684\u503c\u4e00\u65e6\u88ab\u4f20\u5165\u51fd\u6570\uff0c\u5c31\u5df2\u7ecf\u4e0e\u51fd\u6570\u5916\u7684\u90a3\u4e2a\u503c\u6beb\u65e0\u5173\u7cfb\u4e86\u3002 \u4f20\u5165\u503c\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u610f\u4e49 \u3002 unsafe.Pointer\u7c7b\u578b\u867d\u7136\u662f\u6307\u9488\u7c7b\u578b\uff0c\u4f46\u662f\u90a3\u4e9b\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u8981\u64cd\u4f5c\u7684\u662f\u8fd9\u4e2a\u6307\u9488\u503c\uff0c\u800c\u4e0d\u662f\u5b83\u6307\u5411\u7684\u90a3\u4e2a\u503c\uff0c\u6240\u4ee5\u9700\u8981\u7684\u4ecd\u7136\u662f\u8fd9\u6307\u5411\u8fd9\u4e2a\u6307\u9488\u503c\u7684\u6307\u9488\u3002 \u53ea\u8981\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u62ff\u5230\u4e86\u88ab\u64cd\u4f5c\u503c\u7684\u6307\u9488\uff0c\u5c31\u53ef\u4ee5\u5b9a\u4f4d\u5230\u5b58\u50a8\u8be5\u503c\u7684\u5185\u5b58\u5730\u5740\uff0c\u5c31\u80fd\u901a\u8fc7\u5e95\u5c42\u7684\u6307\u4ee4\uff0c\u51c6\u786e\u5730\u64cd\u4f5c\u8fd9\u4e2a\u5185\u5b58\u5730\u5740\u4e0a\u7684\u6570\u636e \u3002","title":"\u6ce8\u610f\u70b91"},{"location":"Language/Basic/18-atomic/#2","text":"\u7528\u4e8e\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u7684\u51fd\u6570\u53ef\u4ee5\u505a\u539f\u5b50\u51cf\u6cd5\u5417\uff1f func AddInt32(addr *int32, delta int32) (new int32) // \u4ee5\u539f\u5b50\u65b9\u5f0f\u5c06\u589e\u91cf\u6dfb\u52a0\u5230 *addr \u5e76\u8fd4\u56de\u65b0\u7684\u503c \u4e0a\u9762\u51fd\u6570\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4ee3\u8868\u589e\u91cf\uff0c\u5b83\u7684\u7c7b\u578b\u662fint32\uff0c\u662f\u6709\u7b26\u53f7\u7684\uff0c\u5c06\u589e\u91cf\u503c\u8bbe\u7f6e\u4e3a\u8d1f\u6570\u5c31\u80fd\u5b9e\u73b0\u539f\u5b50\u51cf\u6cd5\u64cd\u4f5c\u3002 \u4f46\u662f\u4e0b\u9762\u4e24\u4e2a\u51fd\u6570\u5c31\u4e0d\u80fd\u76f4\u63a5\u5c06\u589e\u91cf\u503c\u8d4b\u4e88\u4e3a\u8d1f\u6570\u8fdb\u884c\u51cf\u6cd5\uff0c\u56e0\u4e3a\u7b2c\u4e8c\u4e2a\u8868\u793a\u589e\u91cf\u7684\u53c2\u6570\u662f\u65e0\u7b26\u53f7\u7684\uff1a func AddUint32(addr *uint32, delta uint32) (new uint32) func AddUint32(addr *uint32, delta uint32) (new uint32) \u5047\u8bbe\u8981\u5c06\u4e0a\u9762\u7684\u589e\u91cf\u8d4b\u4e88 -3 \uff0c\u53ef\u4ee5\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff1a uint32(int32(-3)) \uff0c\u8fd9\u6837\u8f6c\u6362\u540eGo\u7f16\u8bd1\u5668\u4f1a\u62a5\u9519\u201c\u5e38\u91cf-3\u4e0d\u5728unit32\u7c7b\u578b\u53ef\u8868\u793a\u8303\u56f4\u5185\u201d\uff0c\u5373\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u503c\u6ea2\u51fa\u3002 \u6362\u4e2a\u64cd\u4f5c\u65b9\u5f0f\uff0c\u5148\u5c06 int32(-3) \u8d4b\u4e88\u589e\u91cf\uff0c\u5728\u5c06\u589e\u91cf\u7684\u7c7b\u578b\u8f6c\u6362\u4e3aunit32\uff0c\u8fd9\u6837\u53ef\u4ee5\u7ed5\u8fc7\u7f16\u8bd1\u5668\u7684\u68c0\u67e5\u5e76\u5f97\u5230\u6b63\u786e\u7684\u7ed3\u679c\u3002\u5c06\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\u4f20\u9012\u7ed9\u539f\u5b50\u52a0\u6cd5\u64cd\u4f5c\u6765\u5b9e\u73b0\u539f\u5b50\u51cf\u6cd5\u76ee\u7684\u3002 \u5b98\u65b9\u6587\u65e6\u5c55\u793a\u4e86\u53e6\u4e00\u79cd\u64cd\u4f5c\u65b9\u5f0f\uff0c ^uint32(-N-1) \uff0c\u5176\u4e2dN\u8868\u793a\u589e\u91cf\u7684\u8d1f\u6574\u6570\uff0c\u5373\uff1a \u5148\u628a\u589e\u91cf\u7684\u7edd\u5bf9\u503c\u51cf\u53bb1 \u518d\u628a\u5f97\u5230\u7684\u65e0\u7c7b\u578b\u7684\u6574\u6570\u5e38\u91cf\u8f6c\u6362\u6211uint32\u7c7b\u578b\u7684\u503c \u5728\u8fd9\u4e2a\u503c\u4e0a\u505a\u6309\u4f4d\u5f02\u6216\u64cd\u4f5c\u5f97\u5230\u6700\u7ec8\u7684\u53c2\u6570\u503c","title":"\u6ce8\u610f\u70b92"},{"location":"Language/Basic/18-atomic/#3","text":"CAS\u4e0eswap\u7684\u4e0d\u540c\u53ca\u4f18\u52bf\uff1a CAS\u662f\u6709\u6761\u4ef6\u7684\u4ea4\u6362\u64cd\u4f5c\uff0c\u53ea\u6709\u5728\u6761\u4ef6\u6ee1\u8db3\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u8fdb\u884c\u503c\u7684\u4ea4\u6362\u3002\uff08\u6240\u8c13\u7684\u4ea4\u6362\u5c31\u662f\u628a\u65b0\u7684\u503c\u8d4b\u4e88\u7ed9\u53d8\u91cf\uff0c\u5e76\u8fd4\u56de\u65e7\u7684\u503c\uff09 \u5728\u8fdb\u884cCAS\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u51fd\u6570\u4f1a\u5148\u5224\u65ad\u88ab\u64cd\u4f5c\u7684\u53d8\u91cf\u7684\u5f53\u524d\u503c\u662f\u5426\u4e0e\u9884\u671f\u7684\u65e7\u503c\u76f8\u7b49\u3002 \u5982\u679c\u76f8\u7b49\uff0c\u5c31\u628a\u65b0\u503c\u8d4b\u7ed9\u8be5\u53d8\u91cf\uff0c\u5e76\u8fd4\u56detrue\u4ee5\u8868\u660e\u4ea4\u6362\u64cd\u4f5c\u5df2\u8fdb\u884c \u5982\u679c\u4e0d\u76f8\u7b49\uff0c\u5c31\u5ffd\u7565\u4ea4\u6362\u64cd\u4f5c\uff0c\u5e76\u8fd4\u56defalse CAS\u64cd\u4f5c\u5e76\u4e0d\u662f\u5355\u4e00\u7684\u64cd\u4f5c\uff0c\u800c\u662f\u4e00\u79cd\u64cd\u4f5c\u7ec4\u5408 \u3002\u8fd9\u4e00\u5176\u4ed6\u7684\u539f\u5b50\u64cd\u4f5c\u90fd\u4e0d\u540c\uff0c\u56e0\u6b64\u5b83\u7684\u7528\u9014\u66f4\u5e7f\u6cdb\u3002\u4f8b\u5982\uff0c\u5c06\u5b83\u4e0efor\u5faa\u73af\u8054\u7528\u5b9e\u73b0\u4e00\u79cd\u5efa\u8bae\u7684\u81ea\u65cb\u9501\uff08spinlock\uff09\uff1a for { if atomic.CompareAndSwapInt32( num2, 10, 0) { fmt.Println( The second number has gone to zero. ) break } time.Sleep(time.Millisecond * 500) } // \u5728for\u5faa\u73af\u4e2d\u7684CAS\u64cd\u4f5c\u53ef\u4ee5\u4e0d\u505c\u68c0\u67e5\u67d0\u4e2a\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff0c\u4e00\u65e6\u6761\u4ef6\u6ee1\u8db3\u5c31\u9000\u51fafor\u5faa\u73af // \u53ea\u8981\u6761\u4ef6\u672a\u6ee1\u8db3\uff0c\u5f53\u524d\u7684\u6d41\u7a0b\u5c31\u4f1a\u88ab\u4e00\u76f4\u963b\u585e\u5728\u8fd9\u91cc \u8fd9\u4e0e\u4e92\u65a5\u9501\u7c7b\u4f3c\uff0c\u4f46\u9002\u7528\u573a\u666f\u4e0d\u540c\uff1a \u4e92\u65a5\u9501 \uff1a\u603b\u662f\u5047\u8bbe\u5171\u4eab\u8d44\u6e90\u7684\u72b6\u6001\u4f1a\u88ab\u5176\u4ed6\u7684goroutine\u9891\u7e41\u5730\u6539\u53d8 for\u5faa\u73af+CAS\u64cd\u4f5c\uff1a\u603b\u662f\u5047\u8bbe\u5171\u4eab\u8d44\u6e90\u72b6\u6001\u7684\u6539\u53d8\u4e0d\u662f\u5f88\u9891\u7e41\uff0c\u6216\u8005\uff0c\u5b83\u7684\u72b6\u6001\u603b\u4f1a\u53d8\u6210\u671f\u671b\u7684\u90a3\u6837\uff0c\u8fd9\u662f\u4e00\u79cd\u4e50\u89c2\u5047\u8bbe","title":"\u6ce8\u610f\u70b93"},{"location":"Language/Basic/18-atomic/#4","text":"\u5bf9\u4e00\u4e2a\u53d8\u91cf\u7684\u5199\u64cd\u4f5c\u90fd\u662f\u539f\u5b50\u64cd\u4f5c\uff08\u5982\uff0c\u52a0\u51cf\u3001\u5b58\u50a8\u3001\u4ea4\u6362\u7b49\uff09\uff0c\u90a3\u4e48\u5bf9\u5b83\u7684\u8bfb\u64cd\u4f5c\u8fd8\u9700\u8981\u662f\u539f\u5b50\u64cd\u4f5c\u5417\uff1f \u6709\u5fc5\u8981 \u3002\u5c31\u50cf\u8bfb\u5199\u9501\u4e2d\u5199\u64cd\u4f5c\u4e0e\u8bfb\u64cd\u4f5c\u662f\u4e92\u65a5\u7684\u3002 \u8fd9\u662f\u4e3a\u4e86\u9632\u6b62\u8bfb\u64cd\u4f5c\u8bfb\u5230\u672a\u88ab\u4fee\u6539\u5b8c\u7684\u503c \u3002 \u6240\u4ee5\u8981\u5bf9\u5171\u4eab\u8d44\u6e90\u8fdb\u884c\u4fdd\u62a4\uff0c\u90a3\u5c31\u8981\u5b8c\u5168\u7684\u4fdd\u62a4\uff0c\u4e0d\u5b8c\u5168\u7684\u4fdd\u62a4\u57fa\u672c\u4e0a\u548c\u4e0d\u4fdd\u62a4\u6ca1\u6709\u4ec0\u4e48\u533a\u522b\u3002 \u539f\u5b50\u64cd\u4f5c\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u5f88\u6709\u9650\uff0c\u6240\u4ee5\u5728\u5f88\u591a\u573a\u666f\u4e0b\uff0c\u4e92\u65a5\u9501\u66f4\u52a0\u9002\u7528 \u3002 \u4e00\u65e6\u786e\u5b9a\u67d0\u4e2a\u573a\u666f\u4e0b\u53ef\u4ee5\u9002\u7528\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\uff0c\u6bd4\u5982\u53ea\u6d89\u53ca\u5e76\u53d1\u5730\u8bfb\u5199\u5355\u4e00\u7684\u6574\u6570\u7c7b\u578b\u503c\uff0c\u6216\u8005\u591a\u4e2a\u4e92\u4e0d\u76f8\u5173\u7684\u6574\u6570\u7c7b\u578b\u503c\uff0c\u5c31\u4e0d\u8981\u8003\u8651\u4e92\u65a5\u9501\uff0c\u56e0\u4e3a\u539f\u5b50\u64cd\u4f5c\u51fd\u6570\u7684\u6267\u884c\u901f\u5ea6\u8981\u6bd4\u4e92\u65a5\u9501\u5feb\u5f88\u591a\u3002\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u7b80\u5355\uff0c\u4e0d\u4f1a\u6d89\u53ca\u4e34\u754c\u533a\u7684\u9009\u62e9\uff0c\u6b7b\u9501\u7b49\u95ee\u9898\u3002 \u4f7f\u7528CAS\u64cd\u4f5c\u8981\u6ce8\u610f\u53ef\u80fd\u5f15\u8d77\u201c\u963b\u585e\u201d\u6d41\u7a0b \u3002","title":"\u6ce8\u610f\u70b94"},{"location":"Language/Basic/18-atomic/#syncatomicvalue","text":"\u4e3a\u4e86\u6269\u5927\u539f\u5b50\u64cd\u4f5c\u7684\u9002\u7528\u8303\u56f4\uff0cGo 1.4\u5728 sync/atomic \u5305\u4e2d\u6dfb\u52a0\u4e86\u4e00\u4e2a\u65b0\u7684\u7c7b\u578bValue\uff0c\u6b64\u7c7b\u578b\u7684\u503c\u76f8\u5f53\u4e8e\u4e00\u4e2a \u5bb9\u5668 \uff0c\u53ef\u4ee5\u88ab\u7528\u6765 \u539f\u5b50\u5730\u5b58\u50a8\u548c\u52a0\u8f7d\u4efb\u610f\u7684\u503c \u3002 atomic.Value \u7c7b\u578b\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u58f0\u660e\u4e00\u4e2a\u8be5\u7c7b\u578b\u7684\u53d8\u91cf\uff08\u7b80\u79f0\u539f\u5b50\u53d8\u91cf\uff09\u4e4b\u540e\u5c31\u76f4\u63a5\u4f7f\u7528\uff0c\u8be5\u7c7b\u578b\u53ea\u6709\u4e24\u4e2a\u6307\u9488\u65b9\u6cd5\uff1a Store \u548c Load \u3002","title":"sync/atomic.Value"},{"location":"Language/Basic/18-atomic/#_2","text":"atomic.Value \u7c7b\u578b\u7684\u503c\uff08\u539f\u5b50\u503c\uff09\u88ab\u6b63\u771f\u4f7f\u7528\uff08\u7528\u539f\u5b50\u53d8\u91cf\u5b58\u50a8\u4e86\u503c\uff0c\u5c31\u76f8\u5f53\u4e8e\u771f\u6b63\u4f7f\u7528\uff09\uff0c\u5c31\u4e0d\u5e94\u8be5\u518d\u88ab\u590d\u5236\u4e86\u3002 atomic.Value \u7c7b\u578b\u5c5e\u4e8e\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u800c\u7ed3\u6784\u4f53\u7c7b\u578b\u5c5e\u4e8e\u503c\u7c7b\u578b\u3002\u6240\u4ee5\u590d\u5236\u8fd9\u4e2a\u503c\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5b8c\u5168\u5206\u79bb\u7684\u65b0\u503c\uff0c\u4e24\u8005\u600e\u4e48\u6539\u53d8\u90fd\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\u3002 \u7528\u539f\u5b50\u503c\u6765\u5b58\u50a8\u503c\uff0c\u6709\u4e24\u4e2a\u5f3a\u5236\u6027\u7684\u4f7f\u7528\u89c4\u5219\uff1a \u4e0d\u80fd\u7528\u539f\u5b50\u503c\u5b58\u50a8 nil \uff1a\u5373\u4e0d\u80fd\u628a nil \u4f5c\u4e3a\u53c2\u6570\u503c\u4f20\u5165\u539f\u5b50\u503c\u7684Store\u65b9\u6cd5\uff0c\u5426\u5219\u4f1a\u5f15\u53d1\u4e00\u4e2apanic \u6ce8\u610f\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u5b83\u7684\u52a8\u6001\u503c\u7684nil\uff0c\u4f46\u52a8\u6001\u7c7b\u578b\u5374\u4e0d\u662fnil\uff0c\u90a3\u4e48\u5b83\u7684\u503c\u5c31\u4e0d\u7b49\u4e8enil\uff0c\u6240\u4ee5\u8fd9\u6837\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u53ef\u4ee5\u88ab\u5b58\u5165\u539f\u5b50\u503c\u4e2d\u3002 \u5411\u539f\u5b50\u503c\u5b58\u50a8\u7684\u7b2c\u4e00\u4e2a\u503c\uff0c\u51b3\u5b9a\u4e86\u5b83\u4eca\u540e\u80fd\u4e14\u53ea\u80fd\u5b58\u50a8\u54ea\u4e00\u4e2a\u7c7b\u578b\u7684\u503c \u4f8b\u5982\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7b2c\u4e00\u6b21\u5b58\u50a8\u4e86string\u7c7b\u578b\u503c\u7684\u539f\u5b50\u503c\uff0c\u5728\u8c03\u7528Store\u53d1\u653e\u5b58\u50a8\u5176\u4ed6\u7c7b\u578b\u65f6\u4f1a\u5f15\u53d1\u4e00\u4e2apanic\uff0c\u63d0\u793a\u8fd9\u6b21\u5b58\u50a8\u7684\u503c\u7684\u7c7b\u578b\u4e0e\u4e4b\u524d\u7684\u4e0d\u4e00\u81f4\u3002 \u5728\u539f\u5b50\u503c\u5185\u90e8\u4f9d\u636e\u88ab\u5b58\u50a8\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u8fdb\u884c\u5224\u65ad\uff0c\u6240\u4ee5\u5373\u4f7f\u5b9e\u73b0\u4e86\u540c\u4e00\u4e2a\u63a5\u53e3\u7684\u4e0d\u540c\u7c7b\u578b\uff0c\u5b83\u4eec\u7684\u503c\u4e5f\u4e0d\u80fd\u88ab\u5148\u540e\u5b58\u50a8\u5728\u540c\u4e00\u4e2a\u539f\u5b50\u503c\u4e2d \u3002 \u9057\u61be\u7684\u662f\uff1a \u65e0\u6cd5\u901a\u8fc7\u67d0\u4e2a\u65b9\u6cd5\u77e5\u9053\u4e00\u4e2a\u539f\u5b50\u503c\u662f\u5426\u5df2\u7ecf\u88ab\u771f\u6b63\u4f7f\u7528 \u65e0\u6cd5\u901a\u8fc7\u5e38\u89c4\u56fe\u89e3\u5f97\u5230\u4e00\u4e2a\u539f\u5b50\u503c\u5b58\u50a8\u7684\u5b9e\u9645\u7c7b\u578b \u8fd9\u4f7f\u5f97\u8bef\u7528\u539f\u5b50\u503c\u7684\u53ef\u80fd\u6027\u5927\u5927\u589e\u52a0\uff0c\u5c24\u5176\u5728\u591a\u4e2a\u5730\u65b9\u4f7f\u7528\u540c\u4e00\u4e2a\u539f\u5b50\u503c\u3002","title":"\u6ce8\u610f\u70b9"},{"location":"Language/Basic/18-atomic/#_3","text":"\u4e0d\u8981\u628a\u5185\u90e8\u4f7f\u7528\u7684\u539f\u5b50\u503c\u66b4\u9732\u7ed9\u5916\u754c\uff0c\u6bd4\u5982\u58f0\u660e\u4e00\u4e2a\u5168\u5c40\u7684\u539f\u5b50\u53d8\u91cf\u5e76\u4e0d\u662f\u4e00\u4e2a\u6b63\u786e\u7684\u505a\u6cd5\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7684\u8bbf\u95ee\u6743\u9650\u81f3\u5c11\u5e94\u8be5\u662f\u5305\u7ea7\u79c1\u6709\u3002 \u5982\u679c\u4e0d\u5f97\u4e0d\u8ba9\u5305\u5916\uff0c\u6216\u8005\u6a21\u5757\u5916\u7684\u4ee3\u7801\u4f7f\u7528\u539f\u5b50\u503c\uff0c\u53ef\u4ee5\u58f0\u660e\u4e00\u4e2a\u5305\u7ea7\u79c1\u6709\u7684\u539f\u5b50\u53d8\u91cf\uff0c\u7136\u540e\u518d\u901a\u8fc7\u4e00\u4e2a\u6216\u591a\u4e2a\u516c\u5f00\u7684\u51fd\u6570\uff0c\u8ba9\u5916\u754c\u95f4\u63a5\u5730\u4f7f\u7528\u5230\u5b83\u3002 \u6ce8\u610f\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e0d\u8981\u628a\u539f\u5b50\u503c\u4f20\u9012\u5230\u5916\u754c\uff0c\u4e0d\u8bba\u662f\u4f20\u9012\u539f\u5b50\u503c\u672c\u8eab\u8fd8\u662f\u5b83\u7684\u6307\u9488\u503c \u3002 \u5982\u679c\u901a\u8fc7\u67d0\u4e2a\u51fd\u6570\u53ef\u4ee5\u5411\u5185\u90e8\u7684\u539f\u5b50\u503c\u5b58\u50a8\u503c\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u5e94\u8be5\u5728\u8fd9\u4e2a\u51fd\u6570\u4e2d\u5148\u5224\u65ad\u88ab\u5b58\u50a8\u503c\u7c7b\u578b\u7684\u5408\u6cd5\u578b\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\uff0c\u76f4\u63a5\u8fd4\u56de\u5bf9\u5e94\u7684\u9519\u8bef\u7406\u6027\uff0c\u4ece\u800c\u907f\u514dpanic\u7684\u53d1\u751f\u3002 \u5982\u679c\u53ef\u80fd\u7684\u8bdd\uff0c\u628a\u539f\u5b50\u503c\u5c01\u88c5\u5230\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u4e2d\uff0c\u6bd4\u5982\u7ed3\u6784\u4f53\uff0c\u8fd9\u6837\u65e2\u53ef\u4ee5\u901a\u8fc7\u8be5\u7c7b\u578b\u7684\u65b9\u6cd5\u66f4\u52a0\u5b89\u5168\u5730\u5b58\u50a8\u503c\uff0c\u6709\u53ef\u4ee5\u5728\u8be5\u7c7b\u578b\u4e2d\u5305\u542b\u53ef\u5b58\u50a8\u503c\u7684\u5408\u6cd5\u4fe1\u606f\u3002 \u5c3d\u91cf\u4e0d\u8981\u5728\u539f\u5b50\u503c\u4e2d\u5b58\u50a8\u5f15\u7528\u7c7b\u578b\u7684\u503c\uff0c\u56e0\u4e3a\u5bb9\u6613\u9020\u6210\u5b89\u5168\u6f0f\u6d1e \u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var box6 atomic.Value v6 := []int{1, 2, 3} // \u5207\u7247\uff0c\u5f15\u7528\u7c7b\u578b box6.Store(v6) v6[1] = 4 // \u6ce8\u610f\uff0c\u6b64\u5904\u7684\u64cd\u4f5c\u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff01 // \u4e0a\u8ff0\u64cd\u4f5c\u4fee\u6539\u4e86\u5207\u7247\u4e2d\u7684\u503c\uff0c\u4e5f\u5c31\u4fee\u6539\u4e86box6\u4e2d\u5b58\u50a8\u7684\u503c // \u8fd9\u6837\u7ed5\u8fc7\u4e86\u539f\u5b50\u503c\u800c\u8fdb\u884c\u4e86\u975e\u5e76\u53d1\u5b89\u5168\u7684\u64cd\u4f5c // \u4fee\u6539\u4e3a\u8fd9\u6837 store := func(v []int) { replica := make([]int, len(v)) // \u4e3a\u5207\u7247\u503c\u521b\u5efa\u4e00\u4e2a\u526f\u672c\uff0c\u526f\u672c\u6d89\u53ca\u7684\u6570\u636e\u4e0e\u539f\u503c\u6beb\u4e0d\u76f8\u5173 copy(replica, v) box6.Store(replica) // \u628a\u526f\u672c\u5b58\u50a8\u5230box6\u4e2d } store(v6) v6[2] = 5 // \u6b64\u5904\u7684\u64cd\u4f5c\u662f\u5b89\u5168\u7684\u3002 // \u4fee\u6539\u5207\u7247\u4e2d\u7684\u503c\uff0c\u4e0d\u4f1a\u4fee\u6539box6\u4e2d\u7684\u503c","title":"\u5efa\u8bae"},{"location":"Language/Basic/19-context/","text":"Context \u4f7f\u7528WaitGroup\u53ef\u4ee5\u5b9e\u73b0\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\u540c\u6b65\uff0c\u5982\u679c\u4e00\u5f00\u59cb\u4e0d\u80fd\u786e\u5b9a\u5b50\u4efb\u52a1\u7684goroutine\u6570\u91cf\uff0c\u90a3\u4e48\u4f7f\u7528WaitGroup\u503c\u6765\u534f\u8c03\u5b83\u4eec\u548c\u5206\u53d1\u5b50\u4efb\u52a1\u7684goroutine\u5c31\u5b58\u5728\u4e00\u5b9a\u7684\u98ce\u9669\u3002 \u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u662f\uff1a\u5206\u6279\u5730\u542f\u7528\u6267\u884c\u5b50\u4efb\u52a1\u7684goroutine\u3002 \u4f7f\u7528Context\u5305\u5b9e\u73b0\u4e00\u5bf9\u591agoroutine\u534f\u4f5c\u6d41\u7a0b func coordinateWithContext() { total := 12 var num int32 fmt.Printf( The number: %d [with context.Context]\\n , num) // \u8c03\u7528context.Backgoound\u548ccontext.WithCancel\u521b\u5efa\u4e00\u4e2a\u53ef\u64a4\u9500\u7684context\u5bf9\u8c61ctx\u548c\u4e00\u4e2a\u64a4\u9500\u51fd\u6570cancelFunc cxt, cancelFunc := context.WithCancel(context.Background()) for i := 1; i = total; i++ { // \u6bcf\u6b21\u8fed\u4ee3\u521b\u5efa\u4e00\u4e2a\u65b0\u7684goroutine go addNum( num, i, func() { // \u5728\u5b50goroutine\u4e2d\u539f\u5b50\u6027\u7684Load num\u53d8\u91cf if atomic.LoadInt32( num) == int32(total) { // \u5982\u679cnum\u4e0etotal\u76f8\u7b49\uff0c\u8868\u793a\u6240\u6709\u5b50goroutine\u6267\u884c\u5b8c\u6210 // \u8c03\u7528context\u7684\u64a4\u9500\u51fd\u6570 cancelFunc() } }) } // \u8c03\u7528Done\u51fd\u6570\uff0c\u5e76\u8bd5\u56fe\u9488\u5bf9\u8be5\u51fd\u6570\u8fd4\u56de\u7684\u901a\u9053\u8fdb\u884c\u63a5\u6536\u64cd\u4f5c // \u4e00\u65e6cancelFunc\u88ab\u8c03\u7528\uff0c\u9488\u5bf9\u8be5\u901a\u9053\u7684\u63a5\u6536\u64cd\u4f5c\u5c31\u4f1a\u9a6c\u4e0a\u7ed3\u675f -cxt.Done() fmt.Println( End. ) } context.Context \u7c7b\u578b\u57281.7\u7248\u672c\u5f15\u5165\u540e\uff0c\u8bb8\u591a\u6807\u51c6\u5e93\u90fd\u8fdb\u884c\u4e86\u6269\u5c55\u652f\u6301\uff0c\u5305\u62ec\uff1a os/exec \uff0c net , database/sql , runtime/pprof \uff0c runtime/trace \u3002 context\u7c7b\u578b\u662f\u4e00\u79cd\u975e\u5e38\u901a\u7528\u7684\u540c\u6b65\u5de5\u5177\uff0c\u5b83\u7684\u503c\u4e0d\u4f46\u53ef\u4ee5\u88ab\u4efb\u610f\u5730\u6269\u6563\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u88ab\u7528\u6765\u4f20\u9012\u989d\u5916\u7684\u4fe1\u606f\u548c\u4fe1\u53f7\u3002\u8ddf\u5177\u4f53\u7684\u8bf4\uff0cContext\u7c7b\u578b\u53ef\u4ee5\u63d0\u4f9b\u4e00\u7c7b\u4ee3\u8868\u4e0a\u4e0b\u6587\u7684\u503c\uff0c\u6b64\u7c7b\u503c\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u53ef\u4ee5\u88ab\u4f20\u64ad\u5230\u591a\u4e2agoroutine \u3002 Context\u7c7b\u578b\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0ccontext\u5305\u4e2d\u5b9e\u73b0\u8be5\u63a5\u53e3\u7684\u6240\u6709\u7684\u79c1\u6709\u7c7b\u578b\uff0c\u90fd\u662f\u57fa\u4e8e\u67d0\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u6307\u9488\u7c7b\u578b\uff0c\u6240\u4ee5\u5982\u6b64\u4f20\u64ad\u5e76\u4e0d\u4f1a\u5f71\u54cd\u8be5\u7c7b\u578b\u503c\u7684\u529f\u80fd\u548c\u5b89\u5168\u3002 Context\u7c7b\u578b\u7684\u503c\u662f\u53ef\u4ee5\u884d\u751f\uff0c\u53ef\u4ee5\u901a\u8fc7Context\u503c\u4ea7\u751f\u51fa\u4efb\u610f\u4e2a\u5b50\u503c\uff0c\u8fd9\u4e9b\u5b50\u503c\u53ef\u4ee5\u643a\u5e26\u5176\u7236\u503c\u7684\u5c5e\u6027\u548c\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u54cd\u5e94\u901a\u8fc7\u5176\u7236\u503c\u4f20\u8fbe\u7684\u4fe1\u53f7\u3002 Context\u503c\u5171\u540c\u6784\u6210\u4e86\u4e00\u68f5\u4ee3\u8868\u4e86\u4e0a\u4e0b\u6587\u5168\u8c8c\u7684\u6811\u5f62\u7ed3\u6784\u3002\u8fd9\u68f5\u6811\u7684\u6811\u6839\uff08\u4e0a\u4e0b\u6587\u6839\u8282\u70b9\uff09\u662f\u4e00\u4e2a\u5df2\u7ecf\u5728context\u5305\u4e2d\u9884\u5b9a\u4e49\u597d\u7684Context\u503c\uff0c\u5b83\u662f\u5168\u5c40\u552f\u4e00\u7684\u3002 \u901a\u8fc7\u8c03\u7528context.Background\u51fd\u6570\u53ef\u4ee5\u83b7\u53d6\u5b83 \u3002\u6b64\u5904\u7684\u4e0a\u4e0b\u6587\u6839\u8282\u70b9\u53ea\u662f\u6700\u57fa\u672c\u7684\u652f\u70b9\uff0c\u4e0d\u901a\u8fc7\u4efb\u4f55\u989d\u5916\u7684\u529f\u80fd\uff0c\u65e2\u4e0d\u80fd\u88ab\u64a4\u9500\u4e5f\u4e0d\u80fd\u643a\u5e26\u4efb\u4f55\u6570\u636e\u3002 context\u5305\u4e2d\u5305\u542b\u56db\u4e2a\u7528\u4e8e\u884d\u751fcontext\u503c\u7684\u51fd\u6570\uff1a WithCancel \uff1a\u4ea7\u751f\u4e00\u4e2a\u53ef\u64a4\u9500\u7684parent\u7684\u5b50\u503c WithDeadline , WithTimeout \uff1a\u4ea7\u751f\u4e00\u4e2a\u4f1a\u5b9a\u65f6\u64a4\u9500\u7684parent\u7684\u5b50\u503c WithValue \uff1a\u4ea7\u751f\u4e00\u4e2a\u4f1a\u643a\u5e26\u989d\u5916\u6570\u636e\u7684parent\u7684\u5b50\u503c \u8fd9\u4e9b\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u7c7b\u578b\u90fd\u662f context.Context \uff0c\u540d\u79f0\u90fd\u662fparent\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u53c2\u6570\u90fd\u662f\u5b83\u4eec\u5c06\u4ea7\u751f\u7684Context\u503c\u7684\u7236\u503c\u3002 \u64a4\u9500\u4fe1\u53f7 Context\u63a5\u53e3\u7c7b\u578b\u4e2d\u6709\u4e24\u4e2a\u65b9\u6cd5\u4e0e\u64a4\u9500\u76f8\u5173\uff1a Done\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20\u7c7b\u578b\u4e3a struct{} \u7684\u63a5\u6536\u901a\u9053\uff0c\u8fd9\u4e2a\u901a\u9053\u7684\u7528\u9014\u4e0d\u662f\u4f20\u9012\u5143\u7d20\u503c\uff0c\u800c\u662f\u8ba9\u8c03\u7528\u65b9\u53bb\u611f\u77e5\u64a4\u9500\u5f53\u524dContext\u503c\u7684\u90a3\u4e2a\u4fe1\u53f7\u3002\u4e00\u65e6\u5f53\u524dContext\u503c\u88ab\u64a4\u9500\uff0c\u63a5\u6536\u901a\u9053\u4f1a\u7acb\u5373\u5173\u95ed\uff0c\uff08\u5bf9\u4e8e\u4e00\u4e2a\u672a\u5305\u542b\u4efb\u4f55\u5143\u7d20\u503c\u7684\u901a\u9053\uff0c\u5b83\u7684\u5173\u95ed\u4f7f\u4efb\u4f55\u9488\u5bf9\u5b83\u7684\u63a5\u6536\u64cd\u4f5c\u7acb\u5373\u7ed3\u675f\uff09\u3002 Err\u65b9\u6cd5\uff0c\u8ba9Context\u503c\u7684\u4f7f\u7528\u65b9\u611f\u77e5\u5230\u64a4\u9500\u4fe1\u53f7\u7684\u540c\u65f6\u5f97\u5230\u64a4\u9500\u7684\u5177\u4f53\u539f\u56e0\uff0c\u8be5\u65b9\u6cd5\u7684\u7ed3\u679c\u662ferror\u7c7b\u578b\u7684\uff0c\u5e76\u4e14\u5176\u503c\u53ea\u53ef\u80fd\u7b49\u4e8e\uff1a context.Canceled \u53d8\u91cf\u7684\u503c\uff1a\u8868\u793a\u624b\u52a8\u64a4\u9500 \u6216\u8005 context.DeadlineExceeded \u53d8\u91cf\u7684\u503c\uff1a\u8868\u793a\u7ed9\u5b9a\u7684\u8fc7\u671f\u65f6\u95f4\u5df2\u5230\u800c\u5bfc\u81f4\u64a4\u9500 context.WithCancel \u51fd\u6570\u4ea7\u751f\u4e00\u4e2a\u53ef\u64a4\u9500\u7684Context\u503c\uff0c\u8fd8\u4f1a\u83b7\u5f97\u4e00\u4e2a\u7528\u4e8e\u51fa\u53d1\u64a4\u9500\u4fe1\u53f7\u7684\u51fd\u6570\uff0c\u901a\u8fc7\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53ef\u4ee5\u89e6\u53d1\u9488\u5bf9\u8fd9\u4e2aContext\u503c\u7684\u64a4\u9500\u4fe1\u53f7\uff0c\u4e00\u65e6\u89e6\u53d1\uff0c\u64a4\u9500\u4fe1\u53f7\u4f1a\u7acb\u5373\u88ab\u4f20\u8fbe\u7ed9\u8fd9\u4e2aContext\u8fd9\uff0c\u5e76\u7531\u5b83\u7684Done\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\uff08\u4e00\u4e2a\u63a5\u6536\u901a\u9053\uff09\u8868\u8fbe\u51fa\u6765\u3002 \u64a4\u9500\u51fd\u6570\u53ea\u8d1f\u8d23\u89e6\u53d1\u4fe1\u53f7\uff0c\u5bf9\u5e94\u7684\u53ef\u64a4\u9500\u7684Context\u503c\u4e5f\u53ea\u8d1f\u8d23\u4f20\u8fbe\u4fe1\u53f7\uff0c\u5b83\u4eec\u4e0d\u4f1a\u7ba1\u540e\u8fb9\u5177\u4f53\u7684\u64a4\u9500\u64cd\u4f5c\uff0c\u4ee3\u7801\u5728\u611f\u77e5\u5230\u64a4\u9500\u4fe1\u53f7\u540e\uff0c\u53ef\u4ee5\u8fdb\u884c\u4efb\u610f\u7684\u64cd\u4f5c\uff0cContext\u503c\u5bf9\u6b64\u5e76\u6ca1\u6709\u4efb\u4f55\u7684\u7ea6\u675f\u3002 \u66f4\u8fdb\u4e00\u6b65\uff0c\u8fd9\u91cc\u7684\u64a4\u9500\u6700\u539f\u59cb\u7684\u542b\u4e49\u662f\u7ec8\u6b62\u7a0b\u5e8f\u5bf9\u67d0\u79cd\u8bf7\u6c42\uff08\u6bd4\u5982HTTP\u8bf7\u6c42\uff09\u7684\u60f3\u7528\uff0c\u6216\u8005\u53d6\u6d88\u5bf9\u67d0\u4e2a\u6307\u4ee4\uff08\u5982SQL\u6307\u4ee4\uff09\u7684\u5904\u7406\uff0c\u8fd9\u662f\u521b\u5efaContext\u5305\u548cContext\u7c7b\u578b\u65f6\u7684\u521d\u8877\u3002 \u64a4\u9500\u4fe1\u53f7\u5728\u4e0a\u4e0b\u6587\u6811\u4e2d\u7684\u4f20\u64ad Context\u5305\u4e2d\u5305\u542b\u56db\u4e2a\u7528\u4e8e\u884d\u751fContext\u503c\u7684\u51fd\u6570\uff0c\u5176\u4e2d\u7684 WithCancel \uff0c WithDeadline \uff0c WithTimeout \u90fd\u662f\u88ab\u7528\u6765\u57fa\u4e8e\u7ed9\u5b9a\u7684Context\u503c\u4ea7\u751f\u53ef\u64a4\u9500\u7684\u5b50\u503c\u3002 func WithCancel(parent Context) (ctx Context, cancel CancelFunc) // \u8fd4\u56de\u4e00\u4e2a\u53ef\u88ab\u64a4\u9500\u7684context\u503c\u548c\u4e00\u4e2a\u51fa\u89e6\u53d1\u64a4\u9500\u4fe1\u53f7\u7684\u51fd\u6570 \u64a4\u9500\u51fd\u6570\u88ab\u8c03\u7528\u540e\uff0cContext\u503c\u4f1a\u5148\u5173\u95ed\u5b83\u5185\u90e8\u7684\u63a5\u6536\u901a\u9053\uff0c\u5373Done\u65b9\u6cd5\u4f1a\u8fd4\u56de\u7684\u90a3\u4e2a\u901a\u9053\u3002\u7136\u540e\uff0c\u5b83\u4f1a\u5411\u5b83\u7684\u6240\u6709\u5b50\u503c\uff08\u6216\u8005\u8bf4\u5b50\u8282\u70b9\uff09\u4f20\u8fbe\u64a4\u9500\u4fe1\u53f7\u3002\u8fd9\u4e9b\u5b50\u503c\u4f1a\u7ee7\u7eed\u628a\u64a4\u9500\u4fe1\u53f7\u4f20\u64ad\u4e0b\u53bb\uff0c\u6700\u540e\u8fd9\u4e2acontext\u503c\u4f1a\u65ad\u5f00\u5b83\u4e0e\u5176\u7236\u503c\u4e4b\u95f4\u7684\u5173\u8054\u3002 func WithDeadline(parent Context, d time.Time) (Context, CancelFunc) func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc) WithDeadline \u548c WithTimeout \u51fd\u6570\u751f\u6210\u7684Context\u503c\u4e5f\u662f\u53ef\u64a4\u9500\u7684\uff0c\u5b83\u4eec\u4e0d\u4f46\u53ef\u4ee5\u88ab\u624b\u52a8\u64a4\u9500\uff0c\u8fd8\u4f1a\u4f9d\u636e\u5728\u751f\u6210\u65f6\u88ab\u7ed9\u5b9a\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u81ea\u52a8\u5730\u8fdb\u884c\u5b9a\u65f6\u64a4\u9500\uff08\u5b9a\u65f6\u64a4\u9500\u7684\u529f\u80fd\u501f\u52a9\u5185\u90e8\u7684\u8ba1\u65f6\u5668\u6765\u5b9e\u73b0\uff09\uff0c\u64a4\u9500\u7684\u540c\u65f6\u91ca\u653e\u5185\u90e8\u7684\u8ba1\u65f6\u5668\u3002 \u6ce8\u610f\uff0c\u901a\u8fc7\u8c03\u7528 context.WithValue \u51fd\u6570\u5f97\u5230\u7684Context\u503c\u662f\u4e0d\u53ef\u64a4\u9500\u7684\u3002\u64a4\u9500\u4fe1\u53f7\u5728\u88ab\u4f20\u64ad\u65f6\uff0c\u5982\u9047\u5230\u5b83\u4eec\u5219\u4f1a\u76f4\u63a5\u8de8\u8fc7\uff0c\u5e76\u8bd5\u56fe\u5c06\u4fe1\u53f7\u76f4\u63a5\u4f20\u7ed9\u5b83\u4eec\u7684\u5b50\u503c \u3002 \u901a\u8fc7Context\u643a\u5e26\u6570\u636e\uff0c\u5e76\u83b7\u53d6\u6570\u636e func WithValue(parent Context, key, val interface{}) Context WithValue\u51fd\u6570\u5728\u4ea7\u751f\u65b0\u7684\u5305\u542b\u6570\u636e\u7684Context\u503c\u7684\u65f6\u5019\uff0c\u9700\u8981\u4e09\u4e2a\u53c2\u6570\uff0c\u5373\uff1a\u7236\u503c\u3001\u952e\uff08\u4e0emap\u5bf9\u952e\u7684\u7ea6\u675f\u7c7b\u4f3c\uff0c\u7c7b\u578b\u5fc5\u987b\u53ef\u5224\u7b49\uff09\u3001\u503c\u3002\u56e0\u4e3a\u4ece\u4e2d\u83b7\u53d6\u6570\u636e\u7684\u65f6\u5019\uff0c\u6839\u636e\u7ed9\u5b9a\u7684\u952e\u6765\u67e5\u627e\u5bf9\u5e94\u7684\u503c\u3002\u4e0d\u8fc7\u8fd9\u91cc\u5e76\u6ca1\u6709\u7528map\u6765\u5b58\u50a8\u6570\u636e\u3002 Context\u7c7b\u578b\u7684Value\u65b9\u6cd5\u5c31\u662f\u88ab\u7528\u6765\u83b7\u53d6\u6570\u636e\u7684\uff0c\u5728\u8c03\u7528\u542b\u6570\u636e\u7684Context\u503c\u7684Value\u65b9\u6cd5\u65f6\uff0c\u5b83\u4f1a\u5148\u5224\u65ad\u7ed9\u5b9a\u7684\u952e\uff0c\u662f\u5426\u4e0e\u5f53\u524d\u503c\u4e2d\u5b58\u50a8\u7684\u952e\u76f8\u7b49\uff0c\u5982\u679c\u76f8\u7b49\u5c31\u628a\u8be5\u503c\u4e2d\u5b58\u50a8\u7684\u503c\u76f4\u63a5\u8fd4\u56de\uff0c\u5426\u5219\u5c31\u5230\u5176\u7236\u503c\u4e2d\u7ee7\u7eed\u67e5\u627e\u3002\u5982\u679c\u7236\u503c\u4e2d\u4ecd\u672a\u5b58\u50a8\u76f8\u7b49\u7684\u952e\uff0c\u90a3\u4e48\u7ee7\u7eed\u5411\u4e0a\u76f4\u5230\u67e5\u627e\u5230\u6839\u8282\u70b9\u3002 \u9664\u4e86\u5305\u542b\u6570\u636e\u7684Context\u53ef\u4ee5\u5b58\u50a8\u6570\u636e\uff0c\u5176\u4ed6\u7684Context\u503c\u90fd\u4e0d\u80fd\u643a\u5e26\u6570\u636e \uff0cContext\u7684Value\u65b9\u6cd5\u5728\u5411\u4e0a\u67e5\u627e\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u76f4\u63a5\u8df3\u8fc7\u8fd9\u96c6\u4e2d\u7c7b\u578b\u7684Context\u503c\u3002 \u5982\u679c\u8c03\u7528\u7684Value\u65b9\u6cd5\u6240\u5c5e\u7684Context\u672c\u8eab\u5c31\u4e0d\u5305\u542b\u6570\u636e\uff0c\u90a3\u4e48\u5b9e\u9645\u8c03\u7528\u7684\u5c31\u4f1a\u662f\u5176\u7236\u503c\u7684Value\u65b9\u6cd5\u3002\u56e0\u4e3a\u8fd9\u51e0\u79cdContext\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u5b83\u4eec\u901a\u8fc7\u5c06\u7236\u503c\u5d4c\u5165\u5230\u81ea\u8eab\u6765\u8868\u8fbe\u7236\u5b50\u5173\u7cfb\u3002 Context\u63a5\u53e3\u5e76\u6ca1\u6709\u63d0\u4f9b\u6539\u53d8\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u56e0\u6b64\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u901a\u8fc7\u4e0a\u4e0b\u6587\u6811\u4e2d\u6dfb\u52a0\u542b\u6570\u636e\u7684Context\u503c\u6765\u5b58\u50a8\u65b0\u7684\u6570\u636e\uff0c\u6216\u8005\u901a\u8fc7\u64a4\u9500\u6b64\u79cd\u503c\u7684\u7236\u503c\u4e22\u5f03\u76f8\u5e94\u7684\u6570\u636e\u3002 \u5982\u679c\u5b58\u50a8\u5728\u8fd9\u91cc\u7684\u6570\u636e\u53ef\u4ee5\u4ece\u5916\u90e8\u6539\u53d8\uff0c\u90a3\u4e48\u5fc5\u987b\u81ea\u884c\u4fdd\u8bc1\u5b89\u5168 \u3002 \u603b\u7ed3 Context\u7c7b\u578b\u7684\u5b9e\u9645\u503c\u5206\u4e3a\u4e09\u79cd\uff1a \u6839Context\u503c \u53ef\u64a4\u9500\u7684Context\u503c \u624b\u52a8\u64a4\u9500\uff0c\u624b\u52a8\u8c03\u7528\u64a4\u9500\u51fd\u6570 \u5b9a\u65f6\u64a4\u9500\uff0c\u8bbe\u7f6e\u5b9a\u65f6\u64a4\u9500\u7684\u65f6\u95f4\uff0c\u4e14\u4e0d\u53ef\u66f4\u6539\uff0c\u53ef\u5728\u8fc7\u671f\u65f6\u95f4\u5230\u8fbe\u4e4b\u524d\u624b\u52a8\u8fdb\u884c\u64a4\u9500 \u542b\u6570\u636e\u7684Context\u503c\uff0c\u53ef\u4ee5\u643a\u5e26\u6570\u636e\uff0c\u6bcf\u4e2a\u503c\u53ef\u4ee5\u5b58\u50a8\u4e00\u5bf9\u952e\u503c\u5bf9\uff0c\u8c03\u7528Value\u65b9\u6cd5\uff0c\u5b83\u4f1a\u6cbf\u7740\u6811\u6839\u7684\u65b9\u5411\u9010\u4e2a\u503c\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u53d1\u73b0\u76f8\u7b49\u7acb\u5373\u8fd4\u56de\uff0c\u5426\u5219\u5c06\u5728\u6700\u540e\u8fd4\u56denil \u6240\u6709\u7684Context\u503c\u5171\u540c\u6784\u6210\u4e00\u9897\u4e0a\u4e0b\u6587\u6811\uff0c\u8fd9\u68f5\u6811\u7684\u4f5c\u7528\u57df\u662f\u5168\u5c40\u7684\uff0c\u6839Context\u503c\u662f\u5168\u5c40\u552f\u4e00\u7684\uff0c\u4e0d\u63d0\u4f9b\u4efb\u4f55\u989d\u5916\u7684\u529f\u80fd\u3002 \u64a4\u9500\u64cd\u4f5c\u662fContext\u503c\u80fd\u591f\u534f\u8c03\u591a\u4e2agoroutine\u7684\u5173\u952e \uff0c\u64a4\u9500\u4fe1\u53f7\u603b\u662f\u4f1a\u6cbf\u7740\u4e0a\u4e0b\u6587\u6811\u53f6\u5b50\u8282\u70b9\u7684\u65b9\u5411\u4f20\u64ad\u3002 \u542b\u6570\u636e\u7684Context\u4e0d\u80fd\u88ab\u64a4\u9500\uff0c\u80fd\u88ab\u64a4\u9500\u7684Context\u65e0\u6cd5\u643a\u5e26\u6570\u636e \uff0c\u5b83\u4eec\u5171\u540c\u7ec4\u6210\u4e00\u4e2a\u6574\u4f53\uff08\u4e0a\u4e0b\u6587\u6811\uff09\u3002","title":"Context"},{"location":"Language/Basic/19-context/#context","text":"\u4f7f\u7528WaitGroup\u53ef\u4ee5\u5b9e\u73b0\u4e00\u5bf9\u591a\u7684goroutine\u534f\u4f5c\u6d41\u7a0b\u540c\u6b65\uff0c\u5982\u679c\u4e00\u5f00\u59cb\u4e0d\u80fd\u786e\u5b9a\u5b50\u4efb\u52a1\u7684goroutine\u6570\u91cf\uff0c\u90a3\u4e48\u4f7f\u7528WaitGroup\u503c\u6765\u534f\u8c03\u5b83\u4eec\u548c\u5206\u53d1\u5b50\u4efb\u52a1\u7684goroutine\u5c31\u5b58\u5728\u4e00\u5b9a\u7684\u98ce\u9669\u3002 \u4e00\u4e2a\u89e3\u51b3\u65b9\u6848\u662f\uff1a\u5206\u6279\u5730\u542f\u7528\u6267\u884c\u5b50\u4efb\u52a1\u7684goroutine\u3002","title":"Context"},{"location":"Language/Basic/19-context/#contextgoroutine","text":"func coordinateWithContext() { total := 12 var num int32 fmt.Printf( The number: %d [with context.Context]\\n , num) // \u8c03\u7528context.Backgoound\u548ccontext.WithCancel\u521b\u5efa\u4e00\u4e2a\u53ef\u64a4\u9500\u7684context\u5bf9\u8c61ctx\u548c\u4e00\u4e2a\u64a4\u9500\u51fd\u6570cancelFunc cxt, cancelFunc := context.WithCancel(context.Background()) for i := 1; i = total; i++ { // \u6bcf\u6b21\u8fed\u4ee3\u521b\u5efa\u4e00\u4e2a\u65b0\u7684goroutine go addNum( num, i, func() { // \u5728\u5b50goroutine\u4e2d\u539f\u5b50\u6027\u7684Load num\u53d8\u91cf if atomic.LoadInt32( num) == int32(total) { // \u5982\u679cnum\u4e0etotal\u76f8\u7b49\uff0c\u8868\u793a\u6240\u6709\u5b50goroutine\u6267\u884c\u5b8c\u6210 // \u8c03\u7528context\u7684\u64a4\u9500\u51fd\u6570 cancelFunc() } }) } // \u8c03\u7528Done\u51fd\u6570\uff0c\u5e76\u8bd5\u56fe\u9488\u5bf9\u8be5\u51fd\u6570\u8fd4\u56de\u7684\u901a\u9053\u8fdb\u884c\u63a5\u6536\u64cd\u4f5c // \u4e00\u65e6cancelFunc\u88ab\u8c03\u7528\uff0c\u9488\u5bf9\u8be5\u901a\u9053\u7684\u63a5\u6536\u64cd\u4f5c\u5c31\u4f1a\u9a6c\u4e0a\u7ed3\u675f -cxt.Done() fmt.Println( End. ) } context.Context \u7c7b\u578b\u57281.7\u7248\u672c\u5f15\u5165\u540e\uff0c\u8bb8\u591a\u6807\u51c6\u5e93\u90fd\u8fdb\u884c\u4e86\u6269\u5c55\u652f\u6301\uff0c\u5305\u62ec\uff1a os/exec \uff0c net , database/sql , runtime/pprof \uff0c runtime/trace \u3002 context\u7c7b\u578b\u662f\u4e00\u79cd\u975e\u5e38\u901a\u7528\u7684\u540c\u6b65\u5de5\u5177\uff0c\u5b83\u7684\u503c\u4e0d\u4f46\u53ef\u4ee5\u88ab\u4efb\u610f\u5730\u6269\u6563\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u88ab\u7528\u6765\u4f20\u9012\u989d\u5916\u7684\u4fe1\u606f\u548c\u4fe1\u53f7\u3002\u8ddf\u5177\u4f53\u7684\u8bf4\uff0cContext\u7c7b\u578b\u53ef\u4ee5\u63d0\u4f9b\u4e00\u7c7b\u4ee3\u8868\u4e0a\u4e0b\u6587\u7684\u503c\uff0c\u6b64\u7c7b\u503c\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u53ef\u4ee5\u88ab\u4f20\u64ad\u5230\u591a\u4e2agoroutine \u3002 Context\u7c7b\u578b\u662f\u4e00\u4e2a\u63a5\u53e3\u7c7b\u578b\uff0ccontext\u5305\u4e2d\u5b9e\u73b0\u8be5\u63a5\u53e3\u7684\u6240\u6709\u7684\u79c1\u6709\u7c7b\u578b\uff0c\u90fd\u662f\u57fa\u4e8e\u67d0\u4e2a\u6570\u636e\u7c7b\u578b\u7684\u6307\u9488\u7c7b\u578b\uff0c\u6240\u4ee5\u5982\u6b64\u4f20\u64ad\u5e76\u4e0d\u4f1a\u5f71\u54cd\u8be5\u7c7b\u578b\u503c\u7684\u529f\u80fd\u548c\u5b89\u5168\u3002 Context\u7c7b\u578b\u7684\u503c\u662f\u53ef\u4ee5\u884d\u751f\uff0c\u53ef\u4ee5\u901a\u8fc7Context\u503c\u4ea7\u751f\u51fa\u4efb\u610f\u4e2a\u5b50\u503c\uff0c\u8fd9\u4e9b\u5b50\u503c\u53ef\u4ee5\u643a\u5e26\u5176\u7236\u503c\u7684\u5c5e\u6027\u548c\u6570\u636e\uff0c\u4e5f\u53ef\u4ee5\u54cd\u5e94\u901a\u8fc7\u5176\u7236\u503c\u4f20\u8fbe\u7684\u4fe1\u53f7\u3002 Context\u503c\u5171\u540c\u6784\u6210\u4e86\u4e00\u68f5\u4ee3\u8868\u4e86\u4e0a\u4e0b\u6587\u5168\u8c8c\u7684\u6811\u5f62\u7ed3\u6784\u3002\u8fd9\u68f5\u6811\u7684\u6811\u6839\uff08\u4e0a\u4e0b\u6587\u6839\u8282\u70b9\uff09\u662f\u4e00\u4e2a\u5df2\u7ecf\u5728context\u5305\u4e2d\u9884\u5b9a\u4e49\u597d\u7684Context\u503c\uff0c\u5b83\u662f\u5168\u5c40\u552f\u4e00\u7684\u3002 \u901a\u8fc7\u8c03\u7528context.Background\u51fd\u6570\u53ef\u4ee5\u83b7\u53d6\u5b83 \u3002\u6b64\u5904\u7684\u4e0a\u4e0b\u6587\u6839\u8282\u70b9\u53ea\u662f\u6700\u57fa\u672c\u7684\u652f\u70b9\uff0c\u4e0d\u901a\u8fc7\u4efb\u4f55\u989d\u5916\u7684\u529f\u80fd\uff0c\u65e2\u4e0d\u80fd\u88ab\u64a4\u9500\u4e5f\u4e0d\u80fd\u643a\u5e26\u4efb\u4f55\u6570\u636e\u3002 context\u5305\u4e2d\u5305\u542b\u56db\u4e2a\u7528\u4e8e\u884d\u751fcontext\u503c\u7684\u51fd\u6570\uff1a WithCancel \uff1a\u4ea7\u751f\u4e00\u4e2a\u53ef\u64a4\u9500\u7684parent\u7684\u5b50\u503c WithDeadline , WithTimeout \uff1a\u4ea7\u751f\u4e00\u4e2a\u4f1a\u5b9a\u65f6\u64a4\u9500\u7684parent\u7684\u5b50\u503c WithValue \uff1a\u4ea7\u751f\u4e00\u4e2a\u4f1a\u643a\u5e26\u989d\u5916\u6570\u636e\u7684parent\u7684\u5b50\u503c \u8fd9\u4e9b\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u7c7b\u578b\u90fd\u662f context.Context \uff0c\u540d\u79f0\u90fd\u662fparent\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u53c2\u6570\u90fd\u662f\u5b83\u4eec\u5c06\u4ea7\u751f\u7684Context\u503c\u7684\u7236\u503c\u3002","title":"\u4f7f\u7528Context\u5305\u5b9e\u73b0\u4e00\u5bf9\u591agoroutine\u534f\u4f5c\u6d41\u7a0b"},{"location":"Language/Basic/19-context/#_1","text":"Context\u63a5\u53e3\u7c7b\u578b\u4e2d\u6709\u4e24\u4e2a\u65b9\u6cd5\u4e0e\u64a4\u9500\u76f8\u5173\uff1a Done\u65b9\u6cd5\u8fd4\u56de\u4e00\u4e2a\u5143\u7d20\u7c7b\u578b\u4e3a struct{} \u7684\u63a5\u6536\u901a\u9053\uff0c\u8fd9\u4e2a\u901a\u9053\u7684\u7528\u9014\u4e0d\u662f\u4f20\u9012\u5143\u7d20\u503c\uff0c\u800c\u662f\u8ba9\u8c03\u7528\u65b9\u53bb\u611f\u77e5\u64a4\u9500\u5f53\u524dContext\u503c\u7684\u90a3\u4e2a\u4fe1\u53f7\u3002\u4e00\u65e6\u5f53\u524dContext\u503c\u88ab\u64a4\u9500\uff0c\u63a5\u6536\u901a\u9053\u4f1a\u7acb\u5373\u5173\u95ed\uff0c\uff08\u5bf9\u4e8e\u4e00\u4e2a\u672a\u5305\u542b\u4efb\u4f55\u5143\u7d20\u503c\u7684\u901a\u9053\uff0c\u5b83\u7684\u5173\u95ed\u4f7f\u4efb\u4f55\u9488\u5bf9\u5b83\u7684\u63a5\u6536\u64cd\u4f5c\u7acb\u5373\u7ed3\u675f\uff09\u3002 Err\u65b9\u6cd5\uff0c\u8ba9Context\u503c\u7684\u4f7f\u7528\u65b9\u611f\u77e5\u5230\u64a4\u9500\u4fe1\u53f7\u7684\u540c\u65f6\u5f97\u5230\u64a4\u9500\u7684\u5177\u4f53\u539f\u56e0\uff0c\u8be5\u65b9\u6cd5\u7684\u7ed3\u679c\u662ferror\u7c7b\u578b\u7684\uff0c\u5e76\u4e14\u5176\u503c\u53ea\u53ef\u80fd\u7b49\u4e8e\uff1a context.Canceled \u53d8\u91cf\u7684\u503c\uff1a\u8868\u793a\u624b\u52a8\u64a4\u9500 \u6216\u8005 context.DeadlineExceeded \u53d8\u91cf\u7684\u503c\uff1a\u8868\u793a\u7ed9\u5b9a\u7684\u8fc7\u671f\u65f6\u95f4\u5df2\u5230\u800c\u5bfc\u81f4\u64a4\u9500 context.WithCancel \u51fd\u6570\u4ea7\u751f\u4e00\u4e2a\u53ef\u64a4\u9500\u7684Context\u503c\uff0c\u8fd8\u4f1a\u83b7\u5f97\u4e00\u4e2a\u7528\u4e8e\u51fa\u53d1\u64a4\u9500\u4fe1\u53f7\u7684\u51fd\u6570\uff0c\u901a\u8fc7\u8c03\u7528\u8be5\u51fd\u6570\uff0c\u53ef\u4ee5\u89e6\u53d1\u9488\u5bf9\u8fd9\u4e2aContext\u503c\u7684\u64a4\u9500\u4fe1\u53f7\uff0c\u4e00\u65e6\u89e6\u53d1\uff0c\u64a4\u9500\u4fe1\u53f7\u4f1a\u7acb\u5373\u88ab\u4f20\u8fbe\u7ed9\u8fd9\u4e2aContext\u8fd9\uff0c\u5e76\u7531\u5b83\u7684Done\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\uff08\u4e00\u4e2a\u63a5\u6536\u901a\u9053\uff09\u8868\u8fbe\u51fa\u6765\u3002 \u64a4\u9500\u51fd\u6570\u53ea\u8d1f\u8d23\u89e6\u53d1\u4fe1\u53f7\uff0c\u5bf9\u5e94\u7684\u53ef\u64a4\u9500\u7684Context\u503c\u4e5f\u53ea\u8d1f\u8d23\u4f20\u8fbe\u4fe1\u53f7\uff0c\u5b83\u4eec\u4e0d\u4f1a\u7ba1\u540e\u8fb9\u5177\u4f53\u7684\u64a4\u9500\u64cd\u4f5c\uff0c\u4ee3\u7801\u5728\u611f\u77e5\u5230\u64a4\u9500\u4fe1\u53f7\u540e\uff0c\u53ef\u4ee5\u8fdb\u884c\u4efb\u610f\u7684\u64cd\u4f5c\uff0cContext\u503c\u5bf9\u6b64\u5e76\u6ca1\u6709\u4efb\u4f55\u7684\u7ea6\u675f\u3002 \u66f4\u8fdb\u4e00\u6b65\uff0c\u8fd9\u91cc\u7684\u64a4\u9500\u6700\u539f\u59cb\u7684\u542b\u4e49\u662f\u7ec8\u6b62\u7a0b\u5e8f\u5bf9\u67d0\u79cd\u8bf7\u6c42\uff08\u6bd4\u5982HTTP\u8bf7\u6c42\uff09\u7684\u60f3\u7528\uff0c\u6216\u8005\u53d6\u6d88\u5bf9\u67d0\u4e2a\u6307\u4ee4\uff08\u5982SQL\u6307\u4ee4\uff09\u7684\u5904\u7406\uff0c\u8fd9\u662f\u521b\u5efaContext\u5305\u548cContext\u7c7b\u578b\u65f6\u7684\u521d\u8877\u3002","title":"\u64a4\u9500\u4fe1\u53f7"},{"location":"Language/Basic/19-context/#_2","text":"Context\u5305\u4e2d\u5305\u542b\u56db\u4e2a\u7528\u4e8e\u884d\u751fContext\u503c\u7684\u51fd\u6570\uff0c\u5176\u4e2d\u7684 WithCancel \uff0c WithDeadline \uff0c WithTimeout \u90fd\u662f\u88ab\u7528\u6765\u57fa\u4e8e\u7ed9\u5b9a\u7684Context\u503c\u4ea7\u751f\u53ef\u64a4\u9500\u7684\u5b50\u503c\u3002 func WithCancel(parent Context) (ctx Context, cancel CancelFunc) // \u8fd4\u56de\u4e00\u4e2a\u53ef\u88ab\u64a4\u9500\u7684context\u503c\u548c\u4e00\u4e2a\u51fa\u89e6\u53d1\u64a4\u9500\u4fe1\u53f7\u7684\u51fd\u6570 \u64a4\u9500\u51fd\u6570\u88ab\u8c03\u7528\u540e\uff0cContext\u503c\u4f1a\u5148\u5173\u95ed\u5b83\u5185\u90e8\u7684\u63a5\u6536\u901a\u9053\uff0c\u5373Done\u65b9\u6cd5\u4f1a\u8fd4\u56de\u7684\u90a3\u4e2a\u901a\u9053\u3002\u7136\u540e\uff0c\u5b83\u4f1a\u5411\u5b83\u7684\u6240\u6709\u5b50\u503c\uff08\u6216\u8005\u8bf4\u5b50\u8282\u70b9\uff09\u4f20\u8fbe\u64a4\u9500\u4fe1\u53f7\u3002\u8fd9\u4e9b\u5b50\u503c\u4f1a\u7ee7\u7eed\u628a\u64a4\u9500\u4fe1\u53f7\u4f20\u64ad\u4e0b\u53bb\uff0c\u6700\u540e\u8fd9\u4e2acontext\u503c\u4f1a\u65ad\u5f00\u5b83\u4e0e\u5176\u7236\u503c\u4e4b\u95f4\u7684\u5173\u8054\u3002 func WithDeadline(parent Context, d time.Time) (Context, CancelFunc) func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc) WithDeadline \u548c WithTimeout \u51fd\u6570\u751f\u6210\u7684Context\u503c\u4e5f\u662f\u53ef\u64a4\u9500\u7684\uff0c\u5b83\u4eec\u4e0d\u4f46\u53ef\u4ee5\u88ab\u624b\u52a8\u64a4\u9500\uff0c\u8fd8\u4f1a\u4f9d\u636e\u5728\u751f\u6210\u65f6\u88ab\u7ed9\u5b9a\u7684\u8fc7\u671f\u65f6\u95f4\uff0c\u81ea\u52a8\u5730\u8fdb\u884c\u5b9a\u65f6\u64a4\u9500\uff08\u5b9a\u65f6\u64a4\u9500\u7684\u529f\u80fd\u501f\u52a9\u5185\u90e8\u7684\u8ba1\u65f6\u5668\u6765\u5b9e\u73b0\uff09\uff0c\u64a4\u9500\u7684\u540c\u65f6\u91ca\u653e\u5185\u90e8\u7684\u8ba1\u65f6\u5668\u3002 \u6ce8\u610f\uff0c\u901a\u8fc7\u8c03\u7528 context.WithValue \u51fd\u6570\u5f97\u5230\u7684Context\u503c\u662f\u4e0d\u53ef\u64a4\u9500\u7684\u3002\u64a4\u9500\u4fe1\u53f7\u5728\u88ab\u4f20\u64ad\u65f6\uff0c\u5982\u9047\u5230\u5b83\u4eec\u5219\u4f1a\u76f4\u63a5\u8de8\u8fc7\uff0c\u5e76\u8bd5\u56fe\u5c06\u4fe1\u53f7\u76f4\u63a5\u4f20\u7ed9\u5b83\u4eec\u7684\u5b50\u503c \u3002","title":"\u64a4\u9500\u4fe1\u53f7\u5728\u4e0a\u4e0b\u6587\u6811\u4e2d\u7684\u4f20\u64ad"},{"location":"Language/Basic/19-context/#context_1","text":"func WithValue(parent Context, key, val interface{}) Context WithValue\u51fd\u6570\u5728\u4ea7\u751f\u65b0\u7684\u5305\u542b\u6570\u636e\u7684Context\u503c\u7684\u65f6\u5019\uff0c\u9700\u8981\u4e09\u4e2a\u53c2\u6570\uff0c\u5373\uff1a\u7236\u503c\u3001\u952e\uff08\u4e0emap\u5bf9\u952e\u7684\u7ea6\u675f\u7c7b\u4f3c\uff0c\u7c7b\u578b\u5fc5\u987b\u53ef\u5224\u7b49\uff09\u3001\u503c\u3002\u56e0\u4e3a\u4ece\u4e2d\u83b7\u53d6\u6570\u636e\u7684\u65f6\u5019\uff0c\u6839\u636e\u7ed9\u5b9a\u7684\u952e\u6765\u67e5\u627e\u5bf9\u5e94\u7684\u503c\u3002\u4e0d\u8fc7\u8fd9\u91cc\u5e76\u6ca1\u6709\u7528map\u6765\u5b58\u50a8\u6570\u636e\u3002 Context\u7c7b\u578b\u7684Value\u65b9\u6cd5\u5c31\u662f\u88ab\u7528\u6765\u83b7\u53d6\u6570\u636e\u7684\uff0c\u5728\u8c03\u7528\u542b\u6570\u636e\u7684Context\u503c\u7684Value\u65b9\u6cd5\u65f6\uff0c\u5b83\u4f1a\u5148\u5224\u65ad\u7ed9\u5b9a\u7684\u952e\uff0c\u662f\u5426\u4e0e\u5f53\u524d\u503c\u4e2d\u5b58\u50a8\u7684\u952e\u76f8\u7b49\uff0c\u5982\u679c\u76f8\u7b49\u5c31\u628a\u8be5\u503c\u4e2d\u5b58\u50a8\u7684\u503c\u76f4\u63a5\u8fd4\u56de\uff0c\u5426\u5219\u5c31\u5230\u5176\u7236\u503c\u4e2d\u7ee7\u7eed\u67e5\u627e\u3002\u5982\u679c\u7236\u503c\u4e2d\u4ecd\u672a\u5b58\u50a8\u76f8\u7b49\u7684\u952e\uff0c\u90a3\u4e48\u7ee7\u7eed\u5411\u4e0a\u76f4\u5230\u67e5\u627e\u5230\u6839\u8282\u70b9\u3002 \u9664\u4e86\u5305\u542b\u6570\u636e\u7684Context\u53ef\u4ee5\u5b58\u50a8\u6570\u636e\uff0c\u5176\u4ed6\u7684Context\u503c\u90fd\u4e0d\u80fd\u643a\u5e26\u6570\u636e \uff0cContext\u7684Value\u65b9\u6cd5\u5728\u5411\u4e0a\u67e5\u627e\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u76f4\u63a5\u8df3\u8fc7\u8fd9\u96c6\u4e2d\u7c7b\u578b\u7684Context\u503c\u3002 \u5982\u679c\u8c03\u7528\u7684Value\u65b9\u6cd5\u6240\u5c5e\u7684Context\u672c\u8eab\u5c31\u4e0d\u5305\u542b\u6570\u636e\uff0c\u90a3\u4e48\u5b9e\u9645\u8c03\u7528\u7684\u5c31\u4f1a\u662f\u5176\u7236\u503c\u7684Value\u65b9\u6cd5\u3002\u56e0\u4e3a\u8fd9\u51e0\u79cdContext\u503c\u7684\u5b9e\u9645\u7c7b\u578b\u662f\u7ed3\u6784\u4f53\uff0c\u5b83\u4eec\u901a\u8fc7\u5c06\u7236\u503c\u5d4c\u5165\u5230\u81ea\u8eab\u6765\u8868\u8fbe\u7236\u5b50\u5173\u7cfb\u3002 Context\u63a5\u53e3\u5e76\u6ca1\u6709\u63d0\u4f9b\u6539\u53d8\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u56e0\u6b64\u5728\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u901a\u8fc7\u4e0a\u4e0b\u6587\u6811\u4e2d\u6dfb\u52a0\u542b\u6570\u636e\u7684Context\u503c\u6765\u5b58\u50a8\u65b0\u7684\u6570\u636e\uff0c\u6216\u8005\u901a\u8fc7\u64a4\u9500\u6b64\u79cd\u503c\u7684\u7236\u503c\u4e22\u5f03\u76f8\u5e94\u7684\u6570\u636e\u3002 \u5982\u679c\u5b58\u50a8\u5728\u8fd9\u91cc\u7684\u6570\u636e\u53ef\u4ee5\u4ece\u5916\u90e8\u6539\u53d8\uff0c\u90a3\u4e48\u5fc5\u987b\u81ea\u884c\u4fdd\u8bc1\u5b89\u5168 \u3002","title":"\u901a\u8fc7Context\u643a\u5e26\u6570\u636e\uff0c\u5e76\u83b7\u53d6\u6570\u636e"},{"location":"Language/Basic/19-context/#_3","text":"Context\u7c7b\u578b\u7684\u5b9e\u9645\u503c\u5206\u4e3a\u4e09\u79cd\uff1a \u6839Context\u503c \u53ef\u64a4\u9500\u7684Context\u503c \u624b\u52a8\u64a4\u9500\uff0c\u624b\u52a8\u8c03\u7528\u64a4\u9500\u51fd\u6570 \u5b9a\u65f6\u64a4\u9500\uff0c\u8bbe\u7f6e\u5b9a\u65f6\u64a4\u9500\u7684\u65f6\u95f4\uff0c\u4e14\u4e0d\u53ef\u66f4\u6539\uff0c\u53ef\u5728\u8fc7\u671f\u65f6\u95f4\u5230\u8fbe\u4e4b\u524d\u624b\u52a8\u8fdb\u884c\u64a4\u9500 \u542b\u6570\u636e\u7684Context\u503c\uff0c\u53ef\u4ee5\u643a\u5e26\u6570\u636e\uff0c\u6bcf\u4e2a\u503c\u53ef\u4ee5\u5b58\u50a8\u4e00\u5bf9\u952e\u503c\u5bf9\uff0c\u8c03\u7528Value\u65b9\u6cd5\uff0c\u5b83\u4f1a\u6cbf\u7740\u6811\u6839\u7684\u65b9\u5411\u9010\u4e2a\u503c\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u53d1\u73b0\u76f8\u7b49\u7acb\u5373\u8fd4\u56de\uff0c\u5426\u5219\u5c06\u5728\u6700\u540e\u8fd4\u56denil \u6240\u6709\u7684Context\u503c\u5171\u540c\u6784\u6210\u4e00\u9897\u4e0a\u4e0b\u6587\u6811\uff0c\u8fd9\u68f5\u6811\u7684\u4f5c\u7528\u57df\u662f\u5168\u5c40\u7684\uff0c\u6839Context\u503c\u662f\u5168\u5c40\u552f\u4e00\u7684\uff0c\u4e0d\u63d0\u4f9b\u4efb\u4f55\u989d\u5916\u7684\u529f\u80fd\u3002 \u64a4\u9500\u64cd\u4f5c\u662fContext\u503c\u80fd\u591f\u534f\u8c03\u591a\u4e2agoroutine\u7684\u5173\u952e \uff0c\u64a4\u9500\u4fe1\u53f7\u603b\u662f\u4f1a\u6cbf\u7740\u4e0a\u4e0b\u6587\u6811\u53f6\u5b50\u8282\u70b9\u7684\u65b9\u5411\u4f20\u64ad\u3002 \u542b\u6570\u636e\u7684Context\u4e0d\u80fd\u88ab\u64a4\u9500\uff0c\u80fd\u88ab\u64a4\u9500\u7684Context\u65e0\u6cd5\u643a\u5e26\u6570\u636e \uff0c\u5b83\u4eec\u5171\u540c\u7ec4\u6210\u4e00\u4e2a\u6574\u4f53\uff08\u4e0a\u4e0b\u6587\u6811\uff09\u3002","title":"\u603b\u7ed3"},{"location":"Language/Basic/20-Unicode/","text":"Unicode Golang\u5b57\u7b26\u7f16\u7801\u57fa\u7840 Golang\u7684\u6807\u8bc6\u7b26\u53ef\u4ee5\u5305\u542b\u201c\u4efb\u4f55Unicode\u7f16\u7801\u53ef\u4ee5\u8868\u793a\u7684\u5b57\u6bcd\u5b57\u7b26\u201d\u3002 \u867d\u7136\u53ef\u4ee5\u76f4\u63a5\u628a\u4e00\u4e2a\u6574\u6570\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\uff0c\u4f46\u662f\u88ab\u8f6c\u6362\u7684\u6574\u6570\u503c\u5e94\u8be5\u53ef\u4ee5\u4ee3\u8868\u4e00\u4e2a\u6709\u6548\u7684Unicode\u4ee3\u7801\u70b9\uff0c\u5426\u5219\u8f6c\u6362\u7684\u7ed3\u679c\u5c06\u4f1a\u662f \ufffd \uff0c\u5373\uff0c\u4e00\u4e2a\u4ec5\u7531\u9ad8\u4eae\u7684\u95ee\u597d\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u503c\u3002 \u5f53\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u88ab\u8f6c\u6362\u4e3a []rune \u7c7b\u578b\u503c\u7684\u65f6\u5019\uff0c\u5176\u4e2d\u7684\u5b57\u7b26\u4e32\u4f1a\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u4e2aUnicode\u5b57\u7b26\u3002 Golang\u7684\u4ee3\u7801\u6b63\u5f0f\u7531Unicode\u5b57\u7b26\u7ec4\u6210\u7684\uff0c\u6240\u4ee5\u7684\u6e90\u4ee3\u7801\u90fd\u5fc5\u987b\u6309\u7167Unicode\u7f16\u7801\u89c4\u8303\u4e2d\u7684UTF-8\u7f16\u7801\u683c\u5f0f\u8fdb\u884c\u7f16\u7801\u3002\u4e5f\u5c31\u662f\u8bf4\uff0cGolang\u7684\u6e90\u7801\u6587\u4ef6\u5fc5\u987b\u4f7f\u7528UTF-8\u7f16\u7801\u683c\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0c\u5982\u679c\u6e90\u7801\u6587\u4ef6\u4e2d\u51fa\u73b0\u4e86\u975eUTF-8\u7f16\u7801\u7684\u5b57\u7b26\uff0c\u90a3\u4e48\u5728\u6784\u5efa\u3001\u5b89\u88c5\u548c\u8fd0\u884c\u7684\u65f6\u5019\uff0cgo\u547d\u4ee4\u4f1a\u62a5\u9519\u201cillegal UTF-8 encoding\u201d\u3002 ASCII\u7f16\u7801 ASCII\u7531ANSI\u5236\u5b9a\u7684 \u5355\u5b57\u8282 \u5b57\u7b26\u7f16\u7801\u65b9\u6848\uff0c\u53ef\u4ee5\u7528\u4e8e\u57fa\u4e8e\u6587\u672c\u7684\u6570\u636e\u4ea4\u6362\u3002ASCII\u7f16\u7801\u65b9\u6848\u4f7f\u7528\u5355\u4e2a\u5b57\u8282\uff08byte\uff09\u7684\u4e8c\u8fdb\u5236\u6570\u6765\u7f16\u7801\u4e00\u4e2a\u5b57\u7b26\u3002 \u6807\u51c6\u7684ASCII\u7f16\u7801\u7528\u4e00\u4e2a\u5b57\u8282\u7684\u6700\u9ad8\u6bd4\u7279\uff08bit\uff09\u4f4d\u4f5c\u4e3a\u5947\u5076\u6821\u9a8c\u4f4d\uff0c \u800c\u6269\u5c55\u7684ASCII\u7f16\u7801\u5219\u5c06\u523a\u732c\u7528\u4e8e\u8868\u793a\u5b57\u7b26\u3002 ASCII\u7f16\u7801\u652f\u6301\u7684\u53ef\u6253\u5370\u5b57\u7b26\u548c\u63a7\u5236\u5b57\u7b26\u7684\u96c6\u5408\u53eb\u505a ASCII\u7f16\u7801\u96c6 \u3002 Unicode\u7f16\u7801\u89c4\u8303\u662f\u53e6\u4e00\u79cd\u66f4\u901a\u7528\u3001\u9488\u5bf9\u6570\u7801\u5b57\u7b26\u548c\u6587\u672c\u7684\u5b57\u7b26\u7f16\u7801\u6807\u51c6\uff0c\u5b83\u4e3a\u4e16\u754c\u4e0a\u73b0\u5b58\u7684\u6240\u6709\u81ea\u7136\u8bed\u8a00\u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\uff0c\u90fd\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u552f\u4e00\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u3002\u5b83\u5b9a\u4e49\u4e86\u4e0d\u540c\u7684\u81ea\u7136\u8bed\u8a00\u7684\u6587\u672c\u6570\u636e\u5728\u56fd\u9645\u95f4\u4ea4\u6362\u7684\u7edf\u4e00\u65b9\u5f0f\uff0c\u5e76\u4e3a\u5168\u7403\u5316\u8f6f\u4ef6\u521b\u5efa\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u57fa\u7840\u3002 Unicode\u7f16\u7801\u89c4\u8303\u4ee5ASCII\u7f16\u7801\u96c6\u4e3a\u51fa\u53d1\u70b9\uff0c\u5e76\u7a81\u7834\u4e86ASCII\u53ea\u80fd\u5bf9\u62c9\u4e01\u5b57\u6bcd\u8fdb\u884c\u7f16\u7801\u7684\u9650\u5236\u3002\u5b83\u4e0d\u4f46\u63d0\u4f9b\u4e86\u53ef\u4ee5\u5bf9\u4e16\u754c\u4e0a\u8d85\u8fc7\u767e\u4e07\u7684\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\u7684\u80fd\u529b\uff0c\u8fd8\u652f\u6301\u6240\u6709\u5df2\u77e5\u7684\u8f6c\u4e49\u5e8f\u5217\u548c\u63a7\u5236\u4ee3\u7801\u3002 \u5728\u8ba1\u7b97\u673a\u5185\u90e8\uff0c\u62bd\u8c61\u7684\u5b57\u7b26\u4f1a\u88ab\u7f16\u7801\u4e3a\u6574\u6570\uff0c\u8fd9\u4e9b\u6574\u6570\u7684\u8303\u56f4\u88ab\u6210\u4e3a\u4ee3\u7801\u7a7a\u95f4\uff0c\u5728\u4ee3\u7801\u7a7a\u95f4\u4e4b\u5185\uff0c\u6bcf\u4e00\u4e2a\u7279\u5b9a\u7684\u6574\u6570\u90fd\u88ab\u6210\u4e3a\u4e00\u4e2a\u4ee3\u7801\u70b9 \u3002\u4e00\u4e2a\u53d7\u652f\u6301\u7684\u62bd\u8c61\u5b57\u7b26\u4f1a\u88ab\u6620\u5c04\u5e76\u5206\u914d\u7ed9\u67d0\u4e2a\u7279\u5b9a\u7684\u4ee3\u7801\u70b9\uff0c\u53cd\u8fc7\u6765\uff0c\u4e00\u4e2a\u4ee3\u7801\u70b9\u603b\u662f\u53ef\u4ee5\u88ab\u770b\u6210\u4e00\u4e2a\u88ab\u7f16\u7801\u7684\u5b57\u7b26\u3002 Unicode\u7f16\u7801 Unicode\u7f16\u7801\u89c4\u8303\u901a\u5e38\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u6807\u8868\u793a\u6cd5\u6765\u8868\u793aUnicode\u4ee3\u7801\u70b9\u7684\u6574\u6570\u503c\uff0c\u5e76\u4f7f\u7528\u201cU+\u201d\u4f5c\u4e3a\u524d\u7f00\u3002 \u5982\uff0c\u82f1\u6587\u5b57\u6bcd\u5b57\u7b26\u201ca\u201d\u7684Unicode\u4ee3\u7801\u70b9\u662f\u201cU+0061\u201d\u3002 \u5728Unicode\u7f16\u7801\u89c4\u8303\u4e2d\uff0c\u4e00\u4e2a\u5b57\u7b26\u80fd\u4e14\u53ea\u80fd\u6709\u4e0e\u5b83\u5bf9\u5e94\u7684\u90a3\u4e2a\u4ee3\u7801\u70b9\u8868\u793a\u3002Unicode\u7f16\u7801\u89c4\u8303\u63d0\u4f9b\u4e86\u4e09\u79cd\u4e0d\u540c\u7684\u7f16\u7801\u683c\u5f0f\uff1a UTF-8 UTF-16 UTF-32 \u5728\u8fd9\u4e09\u79cd\u7f16\u7801\u683c\u5f0f\u7684\u540d\u79f0\u4e2d\uff0c\u201c-\u201d\u53f3\u8fb9\u7684\u6574\u6570\u7684\u542b\u4e49\u662f\uff0c \u4ee5\u591a\u5c11\u4e2a\u6bd4\u7279\u4f4d\u4f5c\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u5143 \u3002 \u4f8b\u5982\uff0cUTF-8\u5c31\u662f\u4ee58\u4e2a\u6bd4\u7279\u4f4d\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u4f5c\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u5143\uff0c\u5e76\u4e14\uff0c\u5b83\u4e0e\u6807\u7816\u7684ASCII\u7f16\u7801\u662f\u5b8c\u5168\u517c\u5bb9\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728[0x00,0x7F]\u7684\u8303\u56f4\u5185\uff0c\u8fd9\u4e24\u79cd\u7f16\u7801\u8868\u793a\u7684\u5b57\u7b26\u90fd\u662f\u76f8\u540c\u7684\uff0c \u8fd9\u662fUTF-8\u7684\u5de8\u5927\u4f18\u52bf \u3002 UTF\u662fUCS Transformation Format\u662f\u7f29\u5199\uff0cUCS\u662fUniversal Charater Set\u6216\u8005Unicode Character Set\u7684\u7f29\u5199\uff0c\u6240\u4ee5UTF\u53ef\u4ee5\u7ffb\u8bd1\u4e3aUNicode\u8f6c\u6362\u683c\u5f0f\uff0c \u5b83\u4ee3\u8868\u7684\u662f\u5b57\u7b26\u4e0e\u5b57\u8282\u5e8f\u5217\u4e4b\u95f4\u7684\u8f6c\u6362\u65b9\u5f0f \u3002 UTF-8\u662f\u4e00\u79cd\u53ef\u53d8\u5bbd\u7684\u7f16\u7801\u65b9\u6848\uff0c\u5b83\u4f1a\u7528\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u6570\u5b57\u6765\u8868\u793a\u67d0\u4e2a\u5b57\u7b26\uff0c\u6700\u591a\u4f7f\u7528\u56db\u4e2a\u5b57\u8282\u3002\u6bd4\u5982\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u82f1\u6587\u5b57\u7b26\uff0c\u5b83\u4ec5\u9700\u8981 \u4e00\u4e2a\u5b57\u8282 \u7684\u4e8c\u8fdb\u5236\u6570\u5c31\u53ef\u4ee5\u8868\u793a \u5bf9\u4e8e\u4e00\u4e2a\u4e2d\u6587\u5b57\u7b26\uff0c\u5b83\u9700\u8981\u8981 \u4e09\u4e2a\u5b57\u8282 \u7684\u4e8c\u8fdb\u5236\u6570\u624d\u80fd\u591f\u8868\u793a \u4e0d\u8bba\u600e\u4e48\uff0c\u4e00\u4e2a\u53d7\u652f\u6301\u7684\u5b57\u7b26\u603b\u662f\u53ef\u4ee5\u7531UTF-8\u7f16\u7801\u4e3a\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u7b80\u79f0UTF-8\u7f16\u7801\u503c\u3002 string\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u7684\u8868\u8fbe \u5728\u5e95\u5c42\uff0cstring\u7c7b\u578b\u7684\u503c\u662f\u7531\u4e00\u7cfb\u5217\u76f8\u5bf9\u5e94\u7684Unicode\u4ee3\u7801\u70b9\u7684UTF-8\u7f16\u7801\u503c\u6765\u8868\u8fbe\u7684\u3002\u5728Golang\u4e2d\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\uff1a \u65e2\u53ef\u4ee5\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u5305\u542b\u591a\u4e2a \u5b57\u7b26 \u7684\u5e8f\u5217\uff1a\u4ee5 rune \u4e3a\u5143\u7d20\u7684\u5207\u7247\u53ef\u4ee5\u8868\u793a \u4e5f\u53ef\u4ee5\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u5305\u542b\u591a\u4e2a \u5b57\u8282 \u7684\u5e8f\u5217\uff1a\u4ee5 byte \u4e3a\u5143\u7d20\u7684\u5207\u7247\u53ef\u4ee5\u8868\u793a rune\u662fGolang\u7279\u6709\u7684\u4e00\u4e2a\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u7684\u4e00\u4e2a\u503c\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff0c\u5373\uff1a\u4e00\u4e2aUnicode\u5b57\u7b26\u3002\u6bd4\u5982'G'\u3001'o'\u3001'\u7231'\u3001'\u597d'\u3001'\u8005'\u4ee3\u8868\u7684\u5c31\u662f\u4e00\u4e2aUnicode\u5b57\u7b26\u3002 \u56e0\u4e3aUTF-8\u7f16\u7801\u683c\u5f0f\u4f1a\u628a\u4e00\u4e2aUnicode\u5b57\u7b26\u7f16\u7801\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a1~4\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u6240\u4ee5\u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u53ef\u4ee5\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u8282\u6765\u8868\u793a\u3002 type rune = int32 // rune\u7c7b\u578b\u5b9e\u9645\u4e0a\u662fint32\u7c7b\u578b\u7684\u4e00\u4e2a\u522b\u540d\u7c7b\u578b // \u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u4f1a\u7531\u56db\u4e2a\u5b57\u8282\u5bbd\u5ea6\u7684\u7a7a\u95f4\u6765\u5b58\u50a8 // \u5b83\u7684\u5b58\u50a8\u7a7a\u95f4\u603b\u662f\u80fd\u591f\u5b58\u4e0b\u4e00\u4e2aUTF-8\u7f16\u7801\u503c \u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\uff0c\u5728\u5e95\u5c42\u5c31\u662f\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\u3002\u524d\u8005\u662f\u4fbf\u4e8e\u4eba\u7c7b\u7406\u89e3\u7684\u5916\u90e8\u5c55\u73b0\uff0c\u540e\u8005\u662f\u4fbf\u4e8e\u8ba1\u7b97\u673a\u7cfb\u7edf\u7406\u89e3\u7684\u5185\u5728\u8868\u8fbe\u3002 str := Go\u7231\u597d\u8005 fmt.Printf( The string: %q\\n , str) // \u5b57\u7b26\u4e32\u503c\u201cGo \u7231\u597d\u8005\u201d\u88ab\u8f6c\u6362\u4e3a[]rune\u7c7b\u578b\u7684\u503c\uff0c // \u5176\u4e2d\u6bcf\u4e00\u4e2a\u5b57\u7b26\uff08\u4e0d\u8bba\u4e2d\u82f1\u6587\uff09\u90fd\u4f1a\u72ec\u7acb\u6210\u4e3a\u4e00\u4e2arune\u7c7b\u578b\u7684\u5143\u7d20\u503c fmt.Printf( = runes(char): %q\\n , []rune(str)) // = runes(char): ['G' 'o' '\u7231' '\u597d' '\u8005'] // \u6bcf\u4e2arune\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u90fd\u662f\u7531\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\u6765\u8868\u8fbe\u7684\uff0c // \u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u65b9\u5f0f\u5c55\u793a\u5b57\u7b26\u5e8f\u5217 fmt.Printf( = runes(hex): %x\\n , []rune(str)) // = runes(hex): [47 6f 7231 597d 8005] // \u5c06\u6bcf\u4e2a\u5b57\u7b26\u7684UTF-8\u7f16\u7801\u503c\u90fd\u62c6\u6210\u54cd\u5e94\u7684\u5b57\u8282\u5e8f\u5217 // \u6bcf\u4e09\u4e2a\u5b57\u8282\u5bf9\u5e94\u4e00\u4e2a\u4e2d\u6587\u5b57\u7b26 fmt.Printf( = bytes(hex): [% x]\\n , []byte(str)) // = bytes(hex): [47 6f e7 88 b1 e5 a5 bd e8 80 85] \u5bf9\u4e8e\u4e00\u4e2a\u591a\u5b57\u8282\u7684UTF-8\u7f16\u7801\u503c\u6765\u8bf4\uff0c\u53ef\u4ee5\u628a\u5b83\u5f53\u6210\u4e00\u4e2a\u6574\u4f53\u8f6c\u6362\u4e3a\u5355\u4e00\u7684\u6574\u6570\uff0c\u4e5f\u53ef\u4ee5\u5148\u628a\u5b83\u62c6\u6210\u5b57\u8282\u5e8f\u5217\uff0c\u5728\u628a\u6bcf\u4e2a\u5b57\u8282\u5206\u522b\u8f6c\u6362\u4e3a\u4e00\u4e2a\u6574\u6570\uff0c\u4ece\u800c\u5f97\u5230\u591a\u4e2a\u6574\u6570\u3002\u8fd9\u4e24\u79cd\u8868\u793a\u6cd5\u5c55\u73b0\u51fa\u6765\u7684\u5185\u5bb9\u5f80\u5f80\u4f1a\u4e0d\u4e00\u6837\uff0c\u6bd4\u5982\uff1a \u5bf9\u4e8e\u4e2d\u6587\u5b57\u7b26\u2018\u7231\u2019\u5b83\u7684UTF-8\u7f16\u7801\u503c \u53ef\u4ee5\u5c55\u73b0\u4e3a\u5355\u4e00\u7684\u6574\u6570\uff1a7231 \u4e5f\u53ef\u4ee5\u5c55\u73b0\u4e3a\u4e09\u4e2a\u6574\u6570\uff1ae7 88 b1 \u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u4f1a\u7531\u82e5\u5e72\u4e2aUnicode\u5b57\u7b26\u7ec4\u6210\uff0c\u6bcf\u4e2aUnicode\u5b57\u7b26\u90fd\u53ef\u4ee5\u7531\u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u6765\u627f\u8f7d\u3002\u8fd9\u4e9b\u5b57\u7b26\u5728\u5e95\u5c42\u90fd\u4f1a\u88ab\u8f6c\u6362\u4e3aUTF-8\u7f16\u7801\u503c\uff0c\u800c\u8fd9\u4e9bUTF-8\u7f16\u7801\u503c\u6709\u4f1a\u4ee5\u5b57\u8282\u5e8f\u5217\u7684\u5f62\u5f0f\u8868\u8fbe\u548c\u5b58\u50a8\u3002\u56e0\u6b64\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u5c31\u662f\u4e00\u4e2a\u80fd\u591f\u8868\u8fbe\u82e5\u5e72\u4e2aUTF-8\u7f16\u7801\u503c\u7684\u5b57\u8282\u5e8f\u5217\u3002 range\u5b50\u53e5\u904d\u5386\u5b57\u7b26\u4e32 \u5e26\u6709range\u5b50\u53e5\u7684for\u8bed\u53e5\u4f1a\u5148\u628a\u904d\u5386\u7684\u5b57\u7b26\u4e32\u503c\u62c6\u6210\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u7136\u540e\u518d\u8bd5\u56fe\u627e\u51fa\u8fd9\u4e2a\u5b57\u8282\u5e8f\u5217\u4e2d\u5305\u542b\u7684\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\uff0c\u6216\u8005\u8bf4\u6bcf\u4e00\u4e2aUnicode\u5b57\u7b26\u3002 \u8fd9\u6837\u7684for\u8bed\u53e5\u53ef\u4ee5\u4e3a\u4e24\u4e2a\u8fed\u4ee3\u53d8\u91cf\u8d4b\u503c\uff1a \u7b2c\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\uff1a\u5c31\u662f\u5f53\u524d\u5b57\u8282\u5e8f\u5217\u4e2d\u7684\u67d0\u4e2aUTF-8\u7f16\u7801\u503c\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u6240\u5bf9\u5e94\u7684\u90a3\u4e2a\u7d22\u5f15\u503c \u7b2c\u4e8c\u4e2a\u53d8\u91cf\u7684\u503c\uff1a\u8fd9\u4e2aUTF-8\u7f16\u7801\u503c\u4ee3\u8868\u7684\u90a3\u4e2aUnicode\u5b57\u7b26\uff0c\u5176\u7c7b\u578b\u662frune str := Go \u7231\u597d\u8005 for i, c := range str { fmt.Printf( %d: %q [% x]\\n , i, c, []byte(string(c))) } // output // \u8f93\u51fafor-range\u8bed\u53e5\u7684\u4e24\u4e2a\u8fed\u4ee3\u53d8\u91cf\u548c\u7b2c\u4e8c\u4e2a\u503c\u7684\u5b57\u8282\u5e8f\u5217\u5f62\u5f0f 0: 'G' [47] 1: 'o' [6f] 2: '\u7231' [e7 88 b1] 5: '\u597d' [e5 a5 bd] 8: '\u8005' [e8 80 85] // for-range\u8bed\u53e5\u53ef\u4ee5\u9010\u4e00\u5730\u8fed\u4ee3\u51fa\u5b57\u7b26\u4e32\u503c\u91cc\u7684\u6bcf\u4e2aUnicode\u5b57\u7b26\uff0c // \u4f46\u662f\u76f8\u90bb\u7684Unicode\u5b57\u7b26\u7684\u7d22\u5f15\u503c\u5e76\u4e0d\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\uff0c // \u8fd9\u53d6\u51b3\u4e0e\u524d\u4e00\u4e2aUnicode\u5b57\u7b26\u662f\u5426\u4e3a\u5355\u5b57\u8282\u5b57\u7b26\u3002","title":"Unicode"},{"location":"Language/Basic/20-Unicode/#unicode","text":"","title":"Unicode"},{"location":"Language/Basic/20-Unicode/#golang","text":"Golang\u7684\u6807\u8bc6\u7b26\u53ef\u4ee5\u5305\u542b\u201c\u4efb\u4f55Unicode\u7f16\u7801\u53ef\u4ee5\u8868\u793a\u7684\u5b57\u6bcd\u5b57\u7b26\u201d\u3002 \u867d\u7136\u53ef\u4ee5\u76f4\u63a5\u628a\u4e00\u4e2a\u6574\u6570\u503c\u8f6c\u6362\u4e3a\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\uff0c\u4f46\u662f\u88ab\u8f6c\u6362\u7684\u6574\u6570\u503c\u5e94\u8be5\u53ef\u4ee5\u4ee3\u8868\u4e00\u4e2a\u6709\u6548\u7684Unicode\u4ee3\u7801\u70b9\uff0c\u5426\u5219\u8f6c\u6362\u7684\u7ed3\u679c\u5c06\u4f1a\u662f \ufffd \uff0c\u5373\uff0c\u4e00\u4e2a\u4ec5\u7531\u9ad8\u4eae\u7684\u95ee\u597d\u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u503c\u3002 \u5f53\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u88ab\u8f6c\u6362\u4e3a []rune \u7c7b\u578b\u503c\u7684\u65f6\u5019\uff0c\u5176\u4e2d\u7684\u5b57\u7b26\u4e32\u4f1a\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u4e2aUnicode\u5b57\u7b26\u3002 Golang\u7684\u4ee3\u7801\u6b63\u5f0f\u7531Unicode\u5b57\u7b26\u7ec4\u6210\u7684\uff0c\u6240\u4ee5\u7684\u6e90\u4ee3\u7801\u90fd\u5fc5\u987b\u6309\u7167Unicode\u7f16\u7801\u89c4\u8303\u4e2d\u7684UTF-8\u7f16\u7801\u683c\u5f0f\u8fdb\u884c\u7f16\u7801\u3002\u4e5f\u5c31\u662f\u8bf4\uff0cGolang\u7684\u6e90\u7801\u6587\u4ef6\u5fc5\u987b\u4f7f\u7528UTF-8\u7f16\u7801\u683c\u5f0f\u8fdb\u884c\u5b58\u50a8\uff0c\u5982\u679c\u6e90\u7801\u6587\u4ef6\u4e2d\u51fa\u73b0\u4e86\u975eUTF-8\u7f16\u7801\u7684\u5b57\u7b26\uff0c\u90a3\u4e48\u5728\u6784\u5efa\u3001\u5b89\u88c5\u548c\u8fd0\u884c\u7684\u65f6\u5019\uff0cgo\u547d\u4ee4\u4f1a\u62a5\u9519\u201cillegal UTF-8 encoding\u201d\u3002","title":"Golang\u5b57\u7b26\u7f16\u7801\u57fa\u7840"},{"location":"Language/Basic/20-Unicode/#ascii","text":"ASCII\u7531ANSI\u5236\u5b9a\u7684 \u5355\u5b57\u8282 \u5b57\u7b26\u7f16\u7801\u65b9\u6848\uff0c\u53ef\u4ee5\u7528\u4e8e\u57fa\u4e8e\u6587\u672c\u7684\u6570\u636e\u4ea4\u6362\u3002ASCII\u7f16\u7801\u65b9\u6848\u4f7f\u7528\u5355\u4e2a\u5b57\u8282\uff08byte\uff09\u7684\u4e8c\u8fdb\u5236\u6570\u6765\u7f16\u7801\u4e00\u4e2a\u5b57\u7b26\u3002 \u6807\u51c6\u7684ASCII\u7f16\u7801\u7528\u4e00\u4e2a\u5b57\u8282\u7684\u6700\u9ad8\u6bd4\u7279\uff08bit\uff09\u4f4d\u4f5c\u4e3a\u5947\u5076\u6821\u9a8c\u4f4d\uff0c \u800c\u6269\u5c55\u7684ASCII\u7f16\u7801\u5219\u5c06\u523a\u732c\u7528\u4e8e\u8868\u793a\u5b57\u7b26\u3002 ASCII\u7f16\u7801\u652f\u6301\u7684\u53ef\u6253\u5370\u5b57\u7b26\u548c\u63a7\u5236\u5b57\u7b26\u7684\u96c6\u5408\u53eb\u505a ASCII\u7f16\u7801\u96c6 \u3002 Unicode\u7f16\u7801\u89c4\u8303\u662f\u53e6\u4e00\u79cd\u66f4\u901a\u7528\u3001\u9488\u5bf9\u6570\u7801\u5b57\u7b26\u548c\u6587\u672c\u7684\u5b57\u7b26\u7f16\u7801\u6807\u51c6\uff0c\u5b83\u4e3a\u4e16\u754c\u4e0a\u73b0\u5b58\u7684\u6240\u6709\u81ea\u7136\u8bed\u8a00\u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\uff0c\u90fd\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u552f\u4e00\u7684\u4e8c\u8fdb\u5236\u7f16\u7801\u3002\u5b83\u5b9a\u4e49\u4e86\u4e0d\u540c\u7684\u81ea\u7136\u8bed\u8a00\u7684\u6587\u672c\u6570\u636e\u5728\u56fd\u9645\u95f4\u4ea4\u6362\u7684\u7edf\u4e00\u65b9\u5f0f\uff0c\u5e76\u4e3a\u5168\u7403\u5316\u8f6f\u4ef6\u521b\u5efa\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u57fa\u7840\u3002 Unicode\u7f16\u7801\u89c4\u8303\u4ee5ASCII\u7f16\u7801\u96c6\u4e3a\u51fa\u53d1\u70b9\uff0c\u5e76\u7a81\u7834\u4e86ASCII\u53ea\u80fd\u5bf9\u62c9\u4e01\u5b57\u6bcd\u8fdb\u884c\u7f16\u7801\u7684\u9650\u5236\u3002\u5b83\u4e0d\u4f46\u63d0\u4f9b\u4e86\u53ef\u4ee5\u5bf9\u4e16\u754c\u4e0a\u8d85\u8fc7\u767e\u4e07\u7684\u5b57\u7b26\u8fdb\u884c\u7f16\u7801\u7684\u80fd\u529b\uff0c\u8fd8\u652f\u6301\u6240\u6709\u5df2\u77e5\u7684\u8f6c\u4e49\u5e8f\u5217\u548c\u63a7\u5236\u4ee3\u7801\u3002 \u5728\u8ba1\u7b97\u673a\u5185\u90e8\uff0c\u62bd\u8c61\u7684\u5b57\u7b26\u4f1a\u88ab\u7f16\u7801\u4e3a\u6574\u6570\uff0c\u8fd9\u4e9b\u6574\u6570\u7684\u8303\u56f4\u88ab\u6210\u4e3a\u4ee3\u7801\u7a7a\u95f4\uff0c\u5728\u4ee3\u7801\u7a7a\u95f4\u4e4b\u5185\uff0c\u6bcf\u4e00\u4e2a\u7279\u5b9a\u7684\u6574\u6570\u90fd\u88ab\u6210\u4e3a\u4e00\u4e2a\u4ee3\u7801\u70b9 \u3002\u4e00\u4e2a\u53d7\u652f\u6301\u7684\u62bd\u8c61\u5b57\u7b26\u4f1a\u88ab\u6620\u5c04\u5e76\u5206\u914d\u7ed9\u67d0\u4e2a\u7279\u5b9a\u7684\u4ee3\u7801\u70b9\uff0c\u53cd\u8fc7\u6765\uff0c\u4e00\u4e2a\u4ee3\u7801\u70b9\u603b\u662f\u53ef\u4ee5\u88ab\u770b\u6210\u4e00\u4e2a\u88ab\u7f16\u7801\u7684\u5b57\u7b26\u3002","title":"ASCII\u7f16\u7801"},{"location":"Language/Basic/20-Unicode/#unicode_1","text":"Unicode\u7f16\u7801\u89c4\u8303\u901a\u5e38\u4f7f\u7528\u5341\u516d\u8fdb\u5236\u6807\u8868\u793a\u6cd5\u6765\u8868\u793aUnicode\u4ee3\u7801\u70b9\u7684\u6574\u6570\u503c\uff0c\u5e76\u4f7f\u7528\u201cU+\u201d\u4f5c\u4e3a\u524d\u7f00\u3002 \u5982\uff0c\u82f1\u6587\u5b57\u6bcd\u5b57\u7b26\u201ca\u201d\u7684Unicode\u4ee3\u7801\u70b9\u662f\u201cU+0061\u201d\u3002 \u5728Unicode\u7f16\u7801\u89c4\u8303\u4e2d\uff0c\u4e00\u4e2a\u5b57\u7b26\u80fd\u4e14\u53ea\u80fd\u6709\u4e0e\u5b83\u5bf9\u5e94\u7684\u90a3\u4e2a\u4ee3\u7801\u70b9\u8868\u793a\u3002Unicode\u7f16\u7801\u89c4\u8303\u63d0\u4f9b\u4e86\u4e09\u79cd\u4e0d\u540c\u7684\u7f16\u7801\u683c\u5f0f\uff1a UTF-8 UTF-16 UTF-32 \u5728\u8fd9\u4e09\u79cd\u7f16\u7801\u683c\u5f0f\u7684\u540d\u79f0\u4e2d\uff0c\u201c-\u201d\u53f3\u8fb9\u7684\u6574\u6570\u7684\u542b\u4e49\u662f\uff0c \u4ee5\u591a\u5c11\u4e2a\u6bd4\u7279\u4f4d\u4f5c\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u5143 \u3002 \u4f8b\u5982\uff0cUTF-8\u5c31\u662f\u4ee58\u4e2a\u6bd4\u7279\u4f4d\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u4f5c\u4e3a\u4e00\u4e2a\u7f16\u7801\u5355\u5143\uff0c\u5e76\u4e14\uff0c\u5b83\u4e0e\u6807\u7816\u7684ASCII\u7f16\u7801\u662f\u5b8c\u5168\u517c\u5bb9\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728[0x00,0x7F]\u7684\u8303\u56f4\u5185\uff0c\u8fd9\u4e24\u79cd\u7f16\u7801\u8868\u793a\u7684\u5b57\u7b26\u90fd\u662f\u76f8\u540c\u7684\uff0c \u8fd9\u662fUTF-8\u7684\u5de8\u5927\u4f18\u52bf \u3002 UTF\u662fUCS Transformation Format\u662f\u7f29\u5199\uff0cUCS\u662fUniversal Charater Set\u6216\u8005Unicode Character Set\u7684\u7f29\u5199\uff0c\u6240\u4ee5UTF\u53ef\u4ee5\u7ffb\u8bd1\u4e3aUNicode\u8f6c\u6362\u683c\u5f0f\uff0c \u5b83\u4ee3\u8868\u7684\u662f\u5b57\u7b26\u4e0e\u5b57\u8282\u5e8f\u5217\u4e4b\u95f4\u7684\u8f6c\u6362\u65b9\u5f0f \u3002 UTF-8\u662f\u4e00\u79cd\u53ef\u53d8\u5bbd\u7684\u7f16\u7801\u65b9\u6848\uff0c\u5b83\u4f1a\u7528\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u5b57\u8282\u7684\u4e8c\u8fdb\u5236\u6570\u5b57\u6765\u8868\u793a\u67d0\u4e2a\u5b57\u7b26\uff0c\u6700\u591a\u4f7f\u7528\u56db\u4e2a\u5b57\u8282\u3002\u6bd4\u5982\uff1a \u5bf9\u4e8e\u4e00\u4e2a\u82f1\u6587\u5b57\u7b26\uff0c\u5b83\u4ec5\u9700\u8981 \u4e00\u4e2a\u5b57\u8282 \u7684\u4e8c\u8fdb\u5236\u6570\u5c31\u53ef\u4ee5\u8868\u793a \u5bf9\u4e8e\u4e00\u4e2a\u4e2d\u6587\u5b57\u7b26\uff0c\u5b83\u9700\u8981\u8981 \u4e09\u4e2a\u5b57\u8282 \u7684\u4e8c\u8fdb\u5236\u6570\u624d\u80fd\u591f\u8868\u793a \u4e0d\u8bba\u600e\u4e48\uff0c\u4e00\u4e2a\u53d7\u652f\u6301\u7684\u5b57\u7b26\u603b\u662f\u53ef\u4ee5\u7531UTF-8\u7f16\u7801\u4e3a\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u7b80\u79f0UTF-8\u7f16\u7801\u503c\u3002","title":"Unicode\u7f16\u7801"},{"location":"Language/Basic/20-Unicode/#string","text":"\u5728\u5e95\u5c42\uff0cstring\u7c7b\u578b\u7684\u503c\u662f\u7531\u4e00\u7cfb\u5217\u76f8\u5bf9\u5e94\u7684Unicode\u4ee3\u7801\u70b9\u7684UTF-8\u7f16\u7801\u503c\u6765\u8868\u8fbe\u7684\u3002\u5728Golang\u4e2d\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\uff1a \u65e2\u53ef\u4ee5\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u5305\u542b\u591a\u4e2a \u5b57\u7b26 \u7684\u5e8f\u5217\uff1a\u4ee5 rune \u4e3a\u5143\u7d20\u7684\u5207\u7247\u53ef\u4ee5\u8868\u793a \u4e5f\u53ef\u4ee5\u88ab\u62c6\u5206\u4e3a\u4e00\u4e2a\u5305\u542b\u591a\u4e2a \u5b57\u8282 \u7684\u5e8f\u5217\uff1a\u4ee5 byte \u4e3a\u5143\u7d20\u7684\u5207\u7247\u53ef\u4ee5\u8868\u793a rune\u662fGolang\u7279\u6709\u7684\u4e00\u4e2a\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u5b83\u7684\u4e00\u4e2a\u503c\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\uff0c\u5373\uff1a\u4e00\u4e2aUnicode\u5b57\u7b26\u3002\u6bd4\u5982'G'\u3001'o'\u3001'\u7231'\u3001'\u597d'\u3001'\u8005'\u4ee3\u8868\u7684\u5c31\u662f\u4e00\u4e2aUnicode\u5b57\u7b26\u3002 \u56e0\u4e3aUTF-8\u7f16\u7801\u683c\u5f0f\u4f1a\u628a\u4e00\u4e2aUnicode\u5b57\u7b26\u7f16\u7801\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a1~4\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u6240\u4ee5\u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u53ef\u4ee5\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u8282\u6765\u8868\u793a\u3002 type rune = int32 // rune\u7c7b\u578b\u5b9e\u9645\u4e0a\u662fint32\u7c7b\u578b\u7684\u4e00\u4e2a\u522b\u540d\u7c7b\u578b // \u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u4f1a\u7531\u56db\u4e2a\u5b57\u8282\u5bbd\u5ea6\u7684\u7a7a\u95f4\u6765\u5b58\u50a8 // \u5b83\u7684\u5b58\u50a8\u7a7a\u95f4\u603b\u662f\u80fd\u591f\u5b58\u4e0b\u4e00\u4e2aUTF-8\u7f16\u7801\u503c \u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\uff0c\u5728\u5e95\u5c42\u5c31\u662f\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\u3002\u524d\u8005\u662f\u4fbf\u4e8e\u4eba\u7c7b\u7406\u89e3\u7684\u5916\u90e8\u5c55\u73b0\uff0c\u540e\u8005\u662f\u4fbf\u4e8e\u8ba1\u7b97\u673a\u7cfb\u7edf\u7406\u89e3\u7684\u5185\u5728\u8868\u8fbe\u3002 str := Go\u7231\u597d\u8005 fmt.Printf( The string: %q\\n , str) // \u5b57\u7b26\u4e32\u503c\u201cGo \u7231\u597d\u8005\u201d\u88ab\u8f6c\u6362\u4e3a[]rune\u7c7b\u578b\u7684\u503c\uff0c // \u5176\u4e2d\u6bcf\u4e00\u4e2a\u5b57\u7b26\uff08\u4e0d\u8bba\u4e2d\u82f1\u6587\uff09\u90fd\u4f1a\u72ec\u7acb\u6210\u4e3a\u4e00\u4e2arune\u7c7b\u578b\u7684\u5143\u7d20\u503c fmt.Printf( = runes(char): %q\\n , []rune(str)) // = runes(char): ['G' 'o' '\u7231' '\u597d' '\u8005'] // \u6bcf\u4e2arune\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u90fd\u662f\u7531\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\u6765\u8868\u8fbe\u7684\uff0c // \u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u8fd9\u79cd\u65b9\u5f0f\u5c55\u793a\u5b57\u7b26\u5e8f\u5217 fmt.Printf( = runes(hex): %x\\n , []rune(str)) // = runes(hex): [47 6f 7231 597d 8005] // \u5c06\u6bcf\u4e2a\u5b57\u7b26\u7684UTF-8\u7f16\u7801\u503c\u90fd\u62c6\u6210\u54cd\u5e94\u7684\u5b57\u8282\u5e8f\u5217 // \u6bcf\u4e09\u4e2a\u5b57\u8282\u5bf9\u5e94\u4e00\u4e2a\u4e2d\u6587\u5b57\u7b26 fmt.Printf( = bytes(hex): [% x]\\n , []byte(str)) // = bytes(hex): [47 6f e7 88 b1 e5 a5 bd e8 80 85] \u5bf9\u4e8e\u4e00\u4e2a\u591a\u5b57\u8282\u7684UTF-8\u7f16\u7801\u503c\u6765\u8bf4\uff0c\u53ef\u4ee5\u628a\u5b83\u5f53\u6210\u4e00\u4e2a\u6574\u4f53\u8f6c\u6362\u4e3a\u5355\u4e00\u7684\u6574\u6570\uff0c\u4e5f\u53ef\u4ee5\u5148\u628a\u5b83\u62c6\u6210\u5b57\u8282\u5e8f\u5217\uff0c\u5728\u628a\u6bcf\u4e2a\u5b57\u8282\u5206\u522b\u8f6c\u6362\u4e3a\u4e00\u4e2a\u6574\u6570\uff0c\u4ece\u800c\u5f97\u5230\u591a\u4e2a\u6574\u6570\u3002\u8fd9\u4e24\u79cd\u8868\u793a\u6cd5\u5c55\u73b0\u51fa\u6765\u7684\u5185\u5bb9\u5f80\u5f80\u4f1a\u4e0d\u4e00\u6837\uff0c\u6bd4\u5982\uff1a \u5bf9\u4e8e\u4e2d\u6587\u5b57\u7b26\u2018\u7231\u2019\u5b83\u7684UTF-8\u7f16\u7801\u503c \u53ef\u4ee5\u5c55\u73b0\u4e3a\u5355\u4e00\u7684\u6574\u6570\uff1a7231 \u4e5f\u53ef\u4ee5\u5c55\u73b0\u4e3a\u4e09\u4e2a\u6574\u6570\uff1ae7 88 b1 \u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u4f1a\u7531\u82e5\u5e72\u4e2aUnicode\u5b57\u7b26\u7ec4\u6210\uff0c\u6bcf\u4e2aUnicode\u5b57\u7b26\u90fd\u53ef\u4ee5\u7531\u4e00\u4e2arune\u7c7b\u578b\u7684\u503c\u6765\u627f\u8f7d\u3002\u8fd9\u4e9b\u5b57\u7b26\u5728\u5e95\u5c42\u90fd\u4f1a\u88ab\u8f6c\u6362\u4e3aUTF-8\u7f16\u7801\u503c\uff0c\u800c\u8fd9\u4e9bUTF-8\u7f16\u7801\u503c\u6709\u4f1a\u4ee5\u5b57\u8282\u5e8f\u5217\u7684\u5f62\u5f0f\u8868\u8fbe\u548c\u5b58\u50a8\u3002\u56e0\u6b64\u4e00\u4e2astring\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u5c31\u662f\u4e00\u4e2a\u80fd\u591f\u8868\u8fbe\u82e5\u5e72\u4e2aUTF-8\u7f16\u7801\u503c\u7684\u5b57\u8282\u5e8f\u5217\u3002","title":"string\u7c7b\u578b\u7684\u503c\u5728\u5e95\u5c42\u7684\u8868\u8fbe"},{"location":"Language/Basic/20-Unicode/#range","text":"\u5e26\u6709range\u5b50\u53e5\u7684for\u8bed\u53e5\u4f1a\u5148\u628a\u904d\u5386\u7684\u5b57\u7b26\u4e32\u503c\u62c6\u6210\u4e00\u4e2a\u5b57\u8282\u5e8f\u5217\uff0c\u7136\u540e\u518d\u8bd5\u56fe\u627e\u51fa\u8fd9\u4e2a\u5b57\u8282\u5e8f\u5217\u4e2d\u5305\u542b\u7684\u4e00\u4e2aUTF-8\u7f16\u7801\u503c\uff0c\u6216\u8005\u8bf4\u6bcf\u4e00\u4e2aUnicode\u5b57\u7b26\u3002 \u8fd9\u6837\u7684for\u8bed\u53e5\u53ef\u4ee5\u4e3a\u4e24\u4e2a\u8fed\u4ee3\u53d8\u91cf\u8d4b\u503c\uff1a \u7b2c\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\uff1a\u5c31\u662f\u5f53\u524d\u5b57\u8282\u5e8f\u5217\u4e2d\u7684\u67d0\u4e2aUTF-8\u7f16\u7801\u503c\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u6240\u5bf9\u5e94\u7684\u90a3\u4e2a\u7d22\u5f15\u503c \u7b2c\u4e8c\u4e2a\u53d8\u91cf\u7684\u503c\uff1a\u8fd9\u4e2aUTF-8\u7f16\u7801\u503c\u4ee3\u8868\u7684\u90a3\u4e2aUnicode\u5b57\u7b26\uff0c\u5176\u7c7b\u578b\u662frune str := Go \u7231\u597d\u8005 for i, c := range str { fmt.Printf( %d: %q [% x]\\n , i, c, []byte(string(c))) } // output // \u8f93\u51fafor-range\u8bed\u53e5\u7684\u4e24\u4e2a\u8fed\u4ee3\u53d8\u91cf\u548c\u7b2c\u4e8c\u4e2a\u503c\u7684\u5b57\u8282\u5e8f\u5217\u5f62\u5f0f 0: 'G' [47] 1: 'o' [6f] 2: '\u7231' [e7 88 b1] 5: '\u597d' [e5 a5 bd] 8: '\u8005' [e8 80 85] // for-range\u8bed\u53e5\u53ef\u4ee5\u9010\u4e00\u5730\u8fed\u4ee3\u51fa\u5b57\u7b26\u4e32\u503c\u91cc\u7684\u6bcf\u4e2aUnicode\u5b57\u7b26\uff0c // \u4f46\u662f\u76f8\u90bb\u7684Unicode\u5b57\u7b26\u7684\u7d22\u5f15\u503c\u5e76\u4e0d\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\uff0c // \u8fd9\u53d6\u51b3\u4e0e\u524d\u4e00\u4e2aUnicode\u5b57\u7b26\u662f\u5426\u4e3a\u5355\u5b57\u8282\u5b57\u7b26\u3002","title":"range\u5b50\u53e5\u904d\u5386\u5b57\u7b26\u4e32"},{"location":"Language/Basic/21-strings/","text":"strings Golang\u4e0d\u4f46\u62e5\u6709\u53ef\u4ee5\u72ec\u7acb\u4ee3\u8868Unicode\u5b57\u7b26\u7684\u7c7b\u578brune\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u503c\u8fdb\u884cUnicode\u5b57\u7b26\u62c6\u5206\u7684for\u8bed\u53e5\u3002\u6807\u51c6\u5e93Unicode\u5305\u53ca\u5176\u5b50\u5305\u8fd8\u63d0\u4f9b\u4e86\u5f88\u591a\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u89e3\u6790\u5404\u79cd\u5185\u5bb9\u4e2d\u7684Unicode\u5b57\u7b26\u3002 \u6807\u51c6\u5e93\u4e2d\u7684strings\u4ee3\u7801\u5305\uff0c\u7528\u5230\u4e86unicode\u5305\u548c unicode/utf8 \u5305\u4e2d\u7684\u7a0b\u5e8f\uff0c\u5982\uff1a strings.Builder \u7c7b\u578b\u7684WriteRune\u65b9\u6cd5 strings.Reader \u7c7b\u578b\u7684ReadRune\u65b9\u6cd5 \u4e0estring\u503c\u76f8\u6bd4 strings.Builder \u7c7b\u578b\u7684\u4f18\u52bf \u5df2\u5b58\u5728\u7684\u5185\u5bb9\u4e0d\u53ef\u53d8\uff0c\u4f46\u53ef\u4ee5\u62fc\u63a5\u66f4\u591a\u7684\u5185\u5bb9 \u51cf\u5c11\u5185\u5b58\u5206\u914d\u548c\u5185\u5bb9\u62f7\u8d1d\u7684\u6b21\u6570 \u53ef\u5c06\u5185\u5bb9\u5145\u503c\uff0c\u53ef\u91cd\u7528\u503c string\u7c7b\u578b \u5728Golang\u4e2d\uff0cstring\u7c7b\u578b\u7684\u503c\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u5982\u679c\u60f3\u8981\u83b7\u5f97\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u53ea\u80fd\u57fa\u4e8e\u539f\u6765\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u88c1\u526a\u3001\u62fc\u63a5\u7b49\u64cd\u4f5c\uff0c\u4ece\u800c\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u3002 \u88c1\u526a\uff1a\u53ef\u4ee5\u4f7f\u7528\u5207\u7247\u8868\u8fbe\u5f0f \u62fc\u63a5\uff1a\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7b26\u201c+\u201d\u5b9e\u73b0 \u5728\u5e95\u5c42\uff0c\u4e00\u4e2astring\u503c\u7684\u5185\u5bb9\u4f1a\u88ab\u5b58\u50a8\u5230\u4e00\u5757\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u540c\u65f6\uff0c\u8fd9\u5757\u5185\u5b58\u5bb9\u7eb3\u7684\u5b57\u8282\u6570\u91cf\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u7528\u4e8e\u8868\u793a\u8be5string\u503c\u7684\u957f\u5ea6\u3002 \u53ef\u4ee5\u628a\u8fd9\u5757\u5185\u5b58\u7684\u5185\u5bb9\u770b\u6210\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u800c\u76f8\u5e94\u7684string\u503c\u5219\u5305\u542b\u4e86\u6307\u5411\u5b57\u8282\u6570\u7ec4\u5934\u90e8\u7684\u6307\u9488\u503c \u3002\u8fd9\u6837\u5728string\u503c\u4e0a\u5e94\u7528\u5207\u7247\u8868\u8fbe\u5f0f\uff0c\u5c31\u76f8\u5f53\u4e8e\u5728\u5bf9\u5176\u5e95\u5c42\u7684\u5b57\u8282\u6570\u7ec4\u505a\u5207\u7247\u3002 \u5728\u8fdb\u884c\u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u65f6\u5019\uff0cGolang\u4f1a\u628a\u6240\u6709\u88ab\u62fc\u63a5\u7684\u5b57\u7b26\u4e32\u4f9d\u6b21\u62f7\u8d1d\u5230\u4e00\u4e2a\u5d2d\u65b0\u4e14\u8db3\u591f\u5927\u7684\u8fde\u7eed\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u5e76\u628a\u6301\u6709\u76f8\u5e94\u6307\u9488\u7684string\u503c\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 \u5f53\u7a0b\u5e8f\u4e2d\u5b58\u5728\u8fc7\u591a\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u5185\u5b58\u5206\u914d\u4ea7\u751f\u975e\u5e38\u5927\u7684\u538b\u529b \u3002 \u867d\u7136string\u503c\u5728\u5185\u90e8\u6301\u6709\u4e00\u4e2a\u6307\u9488\uff0c\u4f46\u5176\u7c7b\u578b\u4ecd\u7136\u5c5e\u4e8e\u503c\u7c7b\u578b\uff0c\u7531\u4e8estring\u503c\u7684\u4e0d\u53ef\u53d8\uff0c\u5176\u4e2d\u7684\u6307\u9488\u503c\u4e5f\u4e3a\u5185\u5b58\u7a7a\u95f4\u7684\u8282\u7701\u505a\u51fa\u4e86\u8d21\u732e\u3002 \u4e00\u4e2astring\u503c\u4f1a\u5728\u5e95\u5c42\u4e0e\u5b83\u6240\u6709\u7684\u526f\u672c\u5171\u7528\u540c\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u7531\u4e8e\u8fd9\u91cc\u7684\u5b57\u8282\u6570\u7ec4\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6539\u53d8\uff0c\u6240\u6709\u8fd9\u6837\u662f\u7edd\u5bf9\u5b89\u5168\u7684 \u3002 strings.Builder \u7c7b\u578b \u4e0estring\u76f8\u6bd4 strings.Builder \u503c\u7684\u4f18\u52bf\u4f53\u73b0\u5728\u5b57\u7b26\u4e32\u62fc\u63a5\u65b9\u9762\u3002Builder\u503c\u4e2d\u6709\u4e00\u4e2a\u7528\u4e8e\u627f\u8f7d\u5185\u5bb9\u7684\u5bb9\u5668\uff08\u7b80\u79f0\u5185\u5bb9\u5bb9\u5668\uff09\uff0c\u5b83\u662f\u4e00\u4e2a\u4ee5byte\u4e3a\u5143\u7d20\u7c7b\u578b\u7684\u5207\u7247\uff08\u5b57\u8282\u5207\u7247\uff09\uff0c\u7531\u4e8e\u8fd9\u6837\u7684\u5b57\u8282\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u5b83\u4e0estring\u503c\u5b58\u50a8\u5185\u5bb9\u7684\u65b9\u5f0f\u662f\u4e00\u6837\u7684\u3002 \u5b9e\u9645\u4e0a\u5b83\u4eec\u90fd\u662f\u901a\u8fc7unsafe.Pointer\u7c7b\u578b\u7684\u5b57\u6bb5\u6765\u6301\u6709\u90a3\u4e2a\u6307\u5411\u4e86\u5e95\u5c42\u5b57\u8282\u6570\u7ec4\u7684\u6307\u9488\u503c\u3002\u56e0\u4e3a\u8fd9\u6837\u7684\u6784\u9020Builder\u503c\u62e5\u6709\u9ad8\u6821\u5229\u7528\u5185\u5b58\u7684\u524d\u63d0\u6761\u4ef6\u3002 \u5bf9\u4e8e\u5b57\u8282\u5207\u7247\u672c\u8eab\u6765\u8bf4\uff0c\u5b83\u5305\u542b\u7684\u4efb\u4f55\u5143\u7d20\u503c\u90fd\u53ef\u4ee5\u88ab\u4fee\u6539\uff0c\u4f46\u662fBuilder\u503c\u5e76\u4e0d\u5141\u8bb8\u8fd9\u6837\u505a\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u53ea\u80fd\u591f\u88ab\u62fc\u63a5\u6216\u8005\u88ab\u91cd\u7f6e\u3002\u8fd9\u5c31\u610f\u5473\u7740Builder\u503c\u4e2d\u7684\u5185\u5bb9\u662f\u4e0d\u53ef\u53d8\u7684\u3002\u56e0\u6b64\uff0c\u5229\u7528Builder\u503c\u63d0\u4f9b\u7684\u65b9\u6cd5\uff08Write\u3001WriteByte\u3001WriteRune\u3001WriteString\uff09\u62fc\u63a5\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u800c\u4e1d\u6beb\u4e0d\u7528\u62c5\u5fc3\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u5f71\u54cd\u5230\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u3002 \u901a\u8fc7\u8c03\u7528\u4e0a\u8ff0\u65b9\u6cd5\u628a\u65b0\u7684\u5185\u5bb9\u62fc\u63a5\u5230\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u7684\u5c3e\u90e8\uff0c\u5982\u679c\u6709\u5fc5\u8981\uff0cBuilder\u4f1a\u81ea\u52a8\u5730\u5bf9\u81ea\u8eab\u7684\u5185\u5bb9\u5bb9\u5668\u8fdb\u884c\u6269\u5bb9\uff0c \u8fd9\u91cc\u7684\u81ea\u52a8\u6269\u5bb9\u7b56\u7565\u4e0e\u5207\u7247\u7684\u6269\u5bb9\u7b56\u7565\u4e00\u81f4 \u3002\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u8db3\u591f\u65f6\u4e0d\u4f1a\u8fdb\u884c\u6269\u5bb9\uff0c\u6ca1\u6709\u6269\u5bb9\uff0c\u90a3\u4e48\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u5c31\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u3002 \u901a\u8fc7Builder\u7684Grow\u65b9\u6cd5\u53ef\u4ee5\u8fdb\u884c\u624b\u52a8\u6269\u5bb9\uff0c\u5b83\u63a5\u6536\u4e00\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570n\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u4ee3\u8868\u5c06\u8981\u6269\u5145\u7684\u5b57\u8282\u6570\u91cf\u3002Grow\u65b9\u6cd5\u4f1a\u628a\u5176\u6240\u5c5e\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u589e\u52a0n\u4e2a\u5b57\u8282\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u8be5\u5207\u7247\u7684\u5bb9\u91cf\u4f1a\u662f\u539f\u5bb9\u5668\u5bb9\u91cf\u7684\u4e24\u88ab\u5728\u52a0\u4e0an\uff0c\u4e4b\u540e\u4f1a\u628a\u539f\u5bb9\u5668\u4e2d\u7684\u6240\u6709\u5b57\u8282\u5168\u90e8\u62f7\u8d1d\u5230\u65b0\u5bb9\u5668\u4e2d\u3002 var builder1 strings.Builder // \u7701\u7565\u82e5\u5e72\u4ee3\u7801\u3002 fmt.Println( Grow the builder ... ) builder1.Grow(10) fmt.Printf( The length of contents in the builder is %d.\\n , builder1.Len()) // \u5982\u679c\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u672a\u7528\u5bb9\u91cf\u5df2\u7ecf\u591f\u7528\uff0c\u5373\u672a\u7528\u5bb9\u91cf =n ,\u90a3\u4e48Grow\u65b9\u6cd5\u4ec0\u4e48\u4e5f\u4e0d\u505a fmt.Println( Reset the builder ... ) // \u8c03\u7528Reset\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8ba9Builder\u503c\u91cd\u65b0\u56de\u5230\u96f6\u503c\u72b6\u6001\uff0c\u5c31\u50cf\u5b83\u4ece\u672a\u88ab\u4f7f\u7528\u8fc7\u90a3\u6837 // \u4e00\u65e6\u88ab\u91cd\u7f6e\uff0cBuilder\u503c\u4e2d\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\u4f1a\u88ab\u76f4\u63a5\u4e22\u5f03 // \u4e0e\u5176\u4ed6\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5c06\u4f1a\u88abGo\u8bed\u8a00\u7684\u5783\u573e\u56de\u5668\u6807\u8bb0\u5e76\u56de\u6536\u6389 builder1.Reset() fmt.Printf( The third output(%d):\\n%q\\n , builder1.Len(), builder1.String()) strings.Builder \u7c7b\u578b\u7684\u4f7f\u7528\u7ea6\u675f \u5728\u5df2\u88ab\u771f\u6b63\u4f7f\u7528\u540e\u5c31\u4e0d\u53ef\u5728\u88ab\u590d\u5236 \u8c03\u7528Builder\u503c\u7684\u62fc\u63a5\u65b9\u6cd5\u548c\u6269\u5bb9\u65b9\u6cd5\u5c31\u610f\u5473\u7740\u5f00\u59cb\u771f\u6b63\u4f7f\u7528\u5b83\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u4f1a\u6539\u53d8\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u72b6\u6001\uff0c\u4e00\u65e6\u8c03\u7528\u4e86\u5b83\u4eec\uff0c\u5c31\u4e0d\u80fd\u518d\u4ee5\u4efb\u4f55\u7684\u65b9\u5f0f\u5bf9\u5176\u6240\u5c5e\u503c\u8fdb\u884c\u590d\u5236\u4e86\uff0c\u5426\u5219\u53ea\u8981\u5728\u4efb\u4f55\u526f\u672c\u4e0a\u8c03\u7528\u4e0a\u8ff0\u65b9\u6cd5\u90fd\u4f1a\u5f15\u53d1panic\u3002 \u8fd9\u79cdpanic\u4f1a\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u6837\u7684\u4f7f\u7528\u65b9\u5f0f\u5e76\u4e0d\u5408\u6cd5\uff0c\u56e0\u4e3a\u8fd9\u91cc\u7684Builder\u503c\u662f\u526f\u672c\u800c\u4e0d\u662f\u539f\u503c\uff0c\u8fd9\u7684\u590d\u5236\u65b9\u6cd5\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u51fd\u6570\u95f4\u4f20\u9012\u503c\u3001\u901a\u8fc7\u901a\u9053\u4f20\u9012\u503c\u3001\u628a\u503c\u8d4b\u4e88\u53d8\u91cf\u7b49 go var builder1 strings.Builder builder1.Grow(1) builder3 := builder1 //builder3.Grow(1) // \u8fd9\u91cc\u4f1a\u5f15\u53d1 panic\u3002 _ = builder3 \u7531\u4e8eBuilder\u503c\u4e0d\u80fd\u5728\u88ab\u590d\u5236\uff0c\u6240\u4ee5\u80af\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u591a\u4e2aBuilder\u503c\u4e2d\u7684\u5185\u5bb9\u5bb9\u5668\u516c\u7528\u4e00\u4e2a\u5e95\u5c42\u5b57\u8282\u6570\u7ec4\u7684\u60c5\u51b5\uff0c\u8fd9\u6837\u907f\u514d\u4e86\u591a\u4e2a\u540c\u6e90\u7684Builder\u503c\u5728\u62fc\u63a5\u5185\u5bb9\u65f6\u53ef\u80fd\u4ea7\u751f\u7684\u51b2\u7a81\u95ee\u9898\u3002 \u867d\u7136\u5df2\u7ecf\u4f7f\u7528\u7684Builder\u503c\u4e0d\u80fd\u518d\u88ab\u590d\u5236\uff0c\u4f46\u662f\u5b83\u7684\u6307\u9488\u503c\u5374\u53ef\u4ee5\uff0c\u65e0\u8bba\u4ec0\u4e48\u65f6\u5019\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u65b9\u5f0f\u590d\u5236\u8fd9\u6837\u7684\u6307\u9488\u503c\u3002\u8fd9\u6837\u7684\u6307\u9488\u503c\u6307\u5411\u7684\u90fd\u4f1a\u662f\u540c\u4e00\u4e2aBuilder\u503c\u3002 go f2 := func(bp *strings.Builder) { (*bp).Grow(1) // \u8fd9\u91cc\u867d\u7136\u4e0d\u4f1a\u5f15\u53d1 panic\uff0c\u4f46\u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\u3002 builder4 := *bp //builder4.Grow(1) // \u8fd9\u91cc\u4f1a\u5f15\u53d1 panic\u3002 _ = builder4 } f2( builder1) \u8fd9\u5c31\u4ea7\u751f\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679cBuilder\u503c\u88ab\u591a\u65b9\u540c\u65f6\u64cd\u4f5c\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u5185\u5bb9\u5c31\u53ef\u80fd\u4ea7\u751f\u6df7\u4e71\uff0c\u8fd9\u5c31\u662f\u6240\u8bf4\u7684\u64cd\u4f5c\u51b2\u7a81\u548c\u5e76\u53d1\u5b89\u5168\u95ee\u9898\u3002 \u7531\u4e8e\u5176\u5185\u5bb9\u4e0d\u662f\u5b8c\u5168\u4e0d\u53ef\u53d8\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u65b9\u81ea\u884c\u89e3\u51b3\u64cd\u4f5c\u51b2\u7a81\u548c\u5e76\u53d1\u5b89\u5168\u95ee\u9898 Builder\u503c\u81ea\u5df1\u662f\u65e0\u6cd5\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\uff0c\u6240\u4ee5\u5728\u901a\u8fc7\u4f20\u9012\u5176\u6307\u9488\u503c\u5171\u4eabBuilder\u503c\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u786e\u4fdd\u5404\u65b9\u5bf9\u5b83\u7684\u4f7f\u7528\u662f\u6b63\u786e\u7684\u3001\u6709\u5e8f\u7684\uff0c\u5e76\u4e14\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c \u5f7b\u5e95\u7684\u89e3\u51b3\u65b9\u6848\u662f\uff0c\u7edd\u5bf9\u4e0d\u8981\u5171\u4eabBuilder\u503c\u4ee5\u53ca\u5b83\u7684\u6307\u9488\u503c \u3002 \u53ef\u4ee5\u5728\u5404\u5904\u5206\u522b\u58f0\u660e\u4e00\u4e2aBuilder\u503c\u6765\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5148\u58f0\u660e\u4e00\u4e2aBuilder\u503c\uff0c\u7136\u540e\u5728\u771f\u6b63\u4f7f\u7528\u5b83\u4e4b\u524d\uff0c\u4fbf\u5c06\u5b83\u7684\u526f\u672c\u4f20\u5230\u5404\u5904\u3002 \u5148\u4f7f\u7528\u5728\u4f20\u9012\uff0c\u53ea\u8981\u5728\u4f20\u9012\u4e4b\u524d\u8c03\u7528\u5b83\u7684Reset\u65b9\u6cd5\u5373\u53ef\u3002 go builder1.Reset() builder5 := builder1 builder5.Grow(1) // \u8fd9\u91cc\u4e0d\u4f1a\u5f15\u53d1 panic\u3002 \u5173\u4e8e\u590d\u5236Builder\u503c\u7684\u7ea6\u675f\u662f\u6709\u610f\u4e49\u7684\uff0c\u4e5f\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002\u867d\u7136\u4ecd\u7136\u5728\u901a\u8fc7\u67d0\u4e9b\u65b9\u5f0f\u5171\u4eabBuilder\u503c\uff0c\u4f46\u6700\u597d\u8fd8\u662f\u4e0d\u8981\u4ee5\u8eab\u72af\u9669\uff0c\u5404\u81ea\u4e3a\u653f\u662f\u6700\u597d\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u5bf9\u4e8e\u5904\u5728\u96f6\u503c\u72b6\u6001\u7684Builder\u503c\uff0c\u590d\u5236\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898 \u3002 strings.Reader \u7c7b\u578b\u7684\u503c\u5982\u4f55\u9ad8\u6548\u8bfb\u53d6\u5b57\u7b26\u4e32 \u4e0e strings.Builder \u7c7b\u578b\u6070\u6070\u76f8\u53cd\uff0c strings.Reader \u7c7b\u578b\u662f\u4e3a\u4e86\u9ad8\u6548\u8bfb\u53d6\u5b57\u7b26\u4e32\u800c\u5b58\u5728\u7684\u3002\u5b83\u7684\u9ad8\u6548\u4f53\u73b0\u5728 \u5b83\u5bf9\u5b57\u7b26\u4e32\u7684\u8bfb\u53d6\u673a\u5236\u4e0a\uff0c\u5b83\u5c01\u88c5\u4e86\u5f88\u591a\u7528\u4e8e\u5728string\u503c\u4e0a\u8bfb\u53d6\u5185\u5bb9\u7684\u6700\u4f73\u5b9e\u8df5 \u3002 strings.Reader \u7c7b\u578b\u7684\u503c\uff08\u7b80\u79f0Reader\u503c\uff09\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u5f88\u65b9\u4fbf\u5730\u8bfb\u53d6\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u7684\u5185\u5bb9\uff0c\u5728\u8bfb\u53d6\u7684\u8fc7\u7a0b\u4e2d\uff0cReader\u503c\u4f1a\u4fdd\u5b58\u5df2\u8bfb\u53d6\u7684\u5b57\u8282\u7684\u8ba1\u6570\uff08\u7b80\u79f0\u5df2\u8bfb\u8ba1\u6570\uff09\u3002 \u5df2\u8bfb\u8ba1\u6570\uff0c\u4ee3\u8868\u8fd9\u4e0b\u4e00\u4e2a\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4e3a\u6b62\uff0cReader\u503c\u5c31\u662f\u4f9d\u9760\u8fd9\u6837\u7684\u4e00\u4e2a\u8ba1\u6570\uff0c\u4ee5\u53ca\u9488\u5bf9\u5b57\u7b26\u4e32\u7684\u5207\u7247\u8868\u8fbe\u5f0f\uff0c\u4ece\u800c\u5b9e\u73b0\u5feb\u8bfb\u901f\u8bfb\u53d6\u7684\u3002 \u5df2\u8bfb\u8ba1\u6570\uff0c\u4e5f\u662f\u8bfb\u53d6\u56de\u9000\u548c\u4f4d\u7f6e\u8bbe\u5b9a\u65f6\u7684\u91cd\u8981\u4f9d\u636e\u3002\u867d\u7136\u5b83\u5c5e\u4e8eReader\u7684\u5185\u90e8\u7ed3\u6784\uff0c\u4f46\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u8be5\u503c\u7684Len\u65b9\u6cd5\u548cSize\u65b9\u6cd5\u628a\u5b83\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var reader1 strings.Reader // \u7701\u7565\u82e5\u5e72\u4ee3\u7801\u3002 readingIndex := reader1.Size() - int64(reader1.Len()) // \u8ba1\u7b97\u51fa\u7684\u5df2\u8bfb\u8ba1\u6570\u3002 Reader\u503c\u62e5\u6709\u7684\u5927\u90e8\u5206\u7528\u4e8e\u8bfb\u53d6\u7684\u65b9\u6cd5\u90fd\u4f1a\u53ca\u65f6\u66f4\u65b0\u5df2\u8bfb\u8ba1\u6570\uff0c\u6bd4\u5982\uff1a ReadByte\u65b9\u6cd5\u4f1a\u5728\u8bfb\u53d6\u6210\u529f\u540e\u5c06\u8fd9\u4e2a\u8ba1\u6570\u7684\u503c\u52a01 ReadRune\u65b9\u6cd5\u8bfb\u53d6\u6210\u529f\u4e4b\u540e\uff0c\u4f1a\u628a\u88ab\u8bfb\u53d6\u7684\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\u4f5c\u4e3a\u8ba1\u6570\u7684\u589e\u91cf Seek\u65b9\u6cd5\u4e5f\u4f1a\u66f4\u65b0\u8be5\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u5668\uff0c\u5b83\u7684\u4e3b\u8981\u64e2\u7528\u6b63\u662f\u8bbe\u5b9a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\u3002\u5982\u679c\u628a io.SeekCurrent \u7684\u503c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u7ed9\u8be5\u65b9\u6cd5\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f9d\u636e\u5f53\u524d\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u4ee5\u53ca\u7b2c\u4e00\u4e2a\u53c2\u6570offset\u7684\u503c\u6765\u8ba1\u7b97\u65b0\u7684\u8ba1\u6570\u503c\u3002Seek\u65b9\u6cd5\u4f1a\u8fd4\u56de\u65b0\u7684\u8ba1\u6570\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff0c\u5982\u4e0b\u6240\u793a\u3002 go offset2 := int64(17) expectedIndex := reader1.Size() - int64(reader1.Len()) + offset2 fmt.Printf(\"Seek with offset %d and whence %d ...\\n\", offset2, io.SeekCurrent) readingIndex, _ := reader1.Seek(offset2, io.SeekCurrent) fmt.Printf(\"The reading index in reader: %d (returned by Seek)\\n\", readingIndex) fmt.Printf(\"The reading index in reader: %d (computed by me)\\n\", expectedIndex) ReadAt\u65b9\u6cd5\u662f\u4e00\u4e2a\u4f8b\u5916\uff0c\u5b83\u65e2\u4e0d\u4f1a\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u4e5f\u4e0d\u4f1a\u5728\u8bfb\u53d6\u4e4b\u540e\u66f4\u65b0\u5b83\u3002\u56e0\u6b64\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u81ea\u7531\u5730\u8bfb\u53d6\u5176\u6240\u5c5e\u7684Reader\u503c\u4e2d\u7684\u4efb\u4f55\u5185\u5bb9\u3002 \u7efc\u4e0a\u6240\u5c5e\uff0cReader\u503c\u5b9e\u73b0\u9ad8\u6548\u8bfb\u53d6\u7684\u5173\u952e\u5728\u4e8e\u5b83\u5185\u90e8\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u8ba1\u6570\u7684\u503c\u5c31\u4ee3\u8868\u8fd9\u4e0b\u4e00\u6b21\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u5f88\u5bb9\u5730\u88ab\u8ba1\u7b97\u51fa\u6765\uff0cReader\u503c\u7684Seek\u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u8be5\u503c\u4e2d\u7684\u5df2\u8bfb\u8ba1\u6570\u503c\u3002","title":"strings"},{"location":"Language/Basic/21-strings/#strings","text":"Golang\u4e0d\u4f46\u62e5\u6709\u53ef\u4ee5\u72ec\u7acb\u4ee3\u8868Unicode\u5b57\u7b26\u7684\u7c7b\u578brune\uff0c\u800c\u4e14\u8fd8\u53ef\u4ee5\u5bf9\u5b57\u7b26\u4e32\u503c\u8fdb\u884cUnicode\u5b57\u7b26\u62c6\u5206\u7684for\u8bed\u53e5\u3002\u6807\u51c6\u5e93Unicode\u5305\u53ca\u5176\u5b50\u5305\u8fd8\u63d0\u4f9b\u4e86\u5f88\u591a\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\uff0c\u53ef\u4ee5\u89e3\u6790\u5404\u79cd\u5185\u5bb9\u4e2d\u7684Unicode\u5b57\u7b26\u3002 \u6807\u51c6\u5e93\u4e2d\u7684strings\u4ee3\u7801\u5305\uff0c\u7528\u5230\u4e86unicode\u5305\u548c unicode/utf8 \u5305\u4e2d\u7684\u7a0b\u5e8f\uff0c\u5982\uff1a strings.Builder \u7c7b\u578b\u7684WriteRune\u65b9\u6cd5 strings.Reader \u7c7b\u578b\u7684ReadRune\u65b9\u6cd5","title":"strings"},{"location":"Language/Basic/21-strings/#stringstringsbuilder","text":"\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u4e0d\u53ef\u53d8\uff0c\u4f46\u53ef\u4ee5\u62fc\u63a5\u66f4\u591a\u7684\u5185\u5bb9 \u51cf\u5c11\u5185\u5b58\u5206\u914d\u548c\u5185\u5bb9\u62f7\u8d1d\u7684\u6b21\u6570 \u53ef\u5c06\u5185\u5bb9\u5145\u503c\uff0c\u53ef\u91cd\u7528\u503c","title":"\u4e0estring\u503c\u76f8\u6bd4strings.Builder\u7c7b\u578b\u7684\u4f18\u52bf"},{"location":"Language/Basic/21-strings/#string","text":"\u5728Golang\u4e2d\uff0cstring\u7c7b\u578b\u7684\u503c\u662f\u4e0d\u53ef\u53d8\u7684\uff0c\u5982\u679c\u60f3\u8981\u83b7\u5f97\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u53ea\u80fd\u57fa\u4e8e\u539f\u6765\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u88c1\u526a\u3001\u62fc\u63a5\u7b49\u64cd\u4f5c\uff0c\u4ece\u800c\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u4e32\u3002 \u88c1\u526a\uff1a\u53ef\u4ee5\u4f7f\u7528\u5207\u7247\u8868\u8fbe\u5f0f \u62fc\u63a5\uff1a\u53ef\u4ee5\u4f7f\u7528\u64cd\u4f5c\u7b26\u201c+\u201d\u5b9e\u73b0 \u5728\u5e95\u5c42\uff0c\u4e00\u4e2astring\u503c\u7684\u5185\u5bb9\u4f1a\u88ab\u5b58\u50a8\u5230\u4e00\u5757\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u540c\u65f6\uff0c\u8fd9\u5757\u5185\u5b58\u5bb9\u7eb3\u7684\u5b57\u8282\u6570\u91cf\u4f1a\u88ab\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u7528\u4e8e\u8868\u793a\u8be5string\u503c\u7684\u957f\u5ea6\u3002 \u53ef\u4ee5\u628a\u8fd9\u5757\u5185\u5b58\u7684\u5185\u5bb9\u770b\u6210\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u800c\u76f8\u5e94\u7684string\u503c\u5219\u5305\u542b\u4e86\u6307\u5411\u5b57\u8282\u6570\u7ec4\u5934\u90e8\u7684\u6307\u9488\u503c \u3002\u8fd9\u6837\u5728string\u503c\u4e0a\u5e94\u7528\u5207\u7247\u8868\u8fbe\u5f0f\uff0c\u5c31\u76f8\u5f53\u4e8e\u5728\u5bf9\u5176\u5e95\u5c42\u7684\u5b57\u8282\u6570\u7ec4\u505a\u5207\u7247\u3002 \u5728\u8fdb\u884c\u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u65f6\u5019\uff0cGolang\u4f1a\u628a\u6240\u6709\u88ab\u62fc\u63a5\u7684\u5b57\u7b26\u4e32\u4f9d\u6b21\u62f7\u8d1d\u5230\u4e00\u4e2a\u5d2d\u65b0\u4e14\u8db3\u591f\u5927\u7684\u8fde\u7eed\u5185\u5b58\u7a7a\u95f4\u4e2d\uff0c\u5e76\u628a\u6301\u6709\u76f8\u5e94\u6307\u9488\u7684string\u503c\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\u3002 \u5f53\u7a0b\u5e8f\u4e2d\u5b58\u5728\u8fc7\u591a\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u4f1a\u5bf9\u5185\u5b58\u5206\u914d\u4ea7\u751f\u975e\u5e38\u5927\u7684\u538b\u529b \u3002 \u867d\u7136string\u503c\u5728\u5185\u90e8\u6301\u6709\u4e00\u4e2a\u6307\u9488\uff0c\u4f46\u5176\u7c7b\u578b\u4ecd\u7136\u5c5e\u4e8e\u503c\u7c7b\u578b\uff0c\u7531\u4e8estring\u503c\u7684\u4e0d\u53ef\u53d8\uff0c\u5176\u4e2d\u7684\u6307\u9488\u503c\u4e5f\u4e3a\u5185\u5b58\u7a7a\u95f4\u7684\u8282\u7701\u505a\u51fa\u4e86\u8d21\u732e\u3002 \u4e00\u4e2astring\u503c\u4f1a\u5728\u5e95\u5c42\u4e0e\u5b83\u6240\u6709\u7684\u526f\u672c\u5171\u7528\u540c\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u7531\u4e8e\u8fd9\u91cc\u7684\u5b57\u8282\u6570\u7ec4\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u6539\u53d8\uff0c\u6240\u6709\u8fd9\u6837\u662f\u7edd\u5bf9\u5b89\u5168\u7684 \u3002","title":"string\u7c7b\u578b"},{"location":"Language/Basic/21-strings/#stringsbuilder","text":"\u4e0estring\u76f8\u6bd4 strings.Builder \u503c\u7684\u4f18\u52bf\u4f53\u73b0\u5728\u5b57\u7b26\u4e32\u62fc\u63a5\u65b9\u9762\u3002Builder\u503c\u4e2d\u6709\u4e00\u4e2a\u7528\u4e8e\u627f\u8f7d\u5185\u5bb9\u7684\u5bb9\u5668\uff08\u7b80\u79f0\u5185\u5bb9\u5bb9\u5668\uff09\uff0c\u5b83\u662f\u4e00\u4e2a\u4ee5byte\u4e3a\u5143\u7d20\u7c7b\u578b\u7684\u5207\u7247\uff08\u5b57\u8282\u5207\u7247\uff09\uff0c\u7531\u4e8e\u8fd9\u6837\u7684\u5b57\u8282\u5207\u7247\u7684\u5e95\u5c42\u6570\u7ec4\u5c31\u662f\u4e00\u4e2a\u5b57\u8282\u6570\u7ec4\uff0c\u5b83\u4e0estring\u503c\u5b58\u50a8\u5185\u5bb9\u7684\u65b9\u5f0f\u662f\u4e00\u6837\u7684\u3002 \u5b9e\u9645\u4e0a\u5b83\u4eec\u90fd\u662f\u901a\u8fc7unsafe.Pointer\u7c7b\u578b\u7684\u5b57\u6bb5\u6765\u6301\u6709\u90a3\u4e2a\u6307\u5411\u4e86\u5e95\u5c42\u5b57\u8282\u6570\u7ec4\u7684\u6307\u9488\u503c\u3002\u56e0\u4e3a\u8fd9\u6837\u7684\u6784\u9020Builder\u503c\u62e5\u6709\u9ad8\u6821\u5229\u7528\u5185\u5b58\u7684\u524d\u63d0\u6761\u4ef6\u3002 \u5bf9\u4e8e\u5b57\u8282\u5207\u7247\u672c\u8eab\u6765\u8bf4\uff0c\u5b83\u5305\u542b\u7684\u4efb\u4f55\u5143\u7d20\u503c\u90fd\u53ef\u4ee5\u88ab\u4fee\u6539\uff0c\u4f46\u662fBuilder\u503c\u5e76\u4e0d\u5141\u8bb8\u8fd9\u6837\u505a\uff0c\u5176\u4e2d\u7684\u5185\u5bb9\u53ea\u80fd\u591f\u88ab\u62fc\u63a5\u6216\u8005\u88ab\u91cd\u7f6e\u3002\u8fd9\u5c31\u610f\u5473\u7740Builder\u503c\u4e2d\u7684\u5185\u5bb9\u662f\u4e0d\u53ef\u53d8\u7684\u3002\u56e0\u6b64\uff0c\u5229\u7528Builder\u503c\u63d0\u4f9b\u7684\u65b9\u6cd5\uff08Write\u3001WriteByte\u3001WriteRune\u3001WriteString\uff09\u62fc\u63a5\u66f4\u591a\u7684\u5185\u5bb9\uff0c\u800c\u4e1d\u6beb\u4e0d\u7528\u62c5\u5fc3\u8fd9\u4e9b\u65b9\u6cd5\u4f1a\u5f71\u54cd\u5230\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u3002 \u901a\u8fc7\u8c03\u7528\u4e0a\u8ff0\u65b9\u6cd5\u628a\u65b0\u7684\u5185\u5bb9\u62fc\u63a5\u5230\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u7684\u5c3e\u90e8\uff0c\u5982\u679c\u6709\u5fc5\u8981\uff0cBuilder\u4f1a\u81ea\u52a8\u5730\u5bf9\u81ea\u8eab\u7684\u5185\u5bb9\u5bb9\u5668\u8fdb\u884c\u6269\u5bb9\uff0c \u8fd9\u91cc\u7684\u81ea\u52a8\u6269\u5bb9\u7b56\u7565\u4e0e\u5207\u7247\u7684\u6269\u5bb9\u7b56\u7565\u4e00\u81f4 \u3002\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u8db3\u591f\u65f6\u4e0d\u4f1a\u8fdb\u884c\u6269\u5bb9\uff0c\u6ca1\u6709\u6269\u5bb9\uff0c\u90a3\u4e48\u5df2\u5b58\u5728\u7684\u5185\u5bb9\u5c31\u4e0d\u4f1a\u88ab\u62f7\u8d1d\u3002 \u901a\u8fc7Builder\u7684Grow\u65b9\u6cd5\u53ef\u4ee5\u8fdb\u884c\u624b\u52a8\u6269\u5bb9\uff0c\u5b83\u63a5\u6536\u4e00\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570n\uff0c\u8be5\u53c2\u6570\u7528\u4e8e\u4ee3\u8868\u5c06\u8981\u6269\u5145\u7684\u5b57\u8282\u6570\u91cf\u3002Grow\u65b9\u6cd5\u4f1a\u628a\u5176\u6240\u5c5e\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u589e\u52a0n\u4e2a\u5b57\u8282\uff0c\u5b83\u4f1a\u751f\u6210\u4e00\u4e2a\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u8be5\u5207\u7247\u7684\u5bb9\u91cf\u4f1a\u662f\u539f\u5bb9\u5668\u5bb9\u91cf\u7684\u4e24\u88ab\u5728\u52a0\u4e0an\uff0c\u4e4b\u540e\u4f1a\u628a\u539f\u5bb9\u5668\u4e2d\u7684\u6240\u6709\u5b57\u8282\u5168\u90e8\u62f7\u8d1d\u5230\u65b0\u5bb9\u5668\u4e2d\u3002 var builder1 strings.Builder // \u7701\u7565\u82e5\u5e72\u4ee3\u7801\u3002 fmt.Println( Grow the builder ... ) builder1.Grow(10) fmt.Printf( The length of contents in the builder is %d.\\n , builder1.Len()) // \u5982\u679c\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u672a\u7528\u5bb9\u91cf\u5df2\u7ecf\u591f\u7528\uff0c\u5373\u672a\u7528\u5bb9\u91cf =n ,\u90a3\u4e48Grow\u65b9\u6cd5\u4ec0\u4e48\u4e5f\u4e0d\u505a fmt.Println( Reset the builder ... ) // \u8c03\u7528Reset\u65b9\u6cd5\uff0c\u53ef\u4ee5\u8ba9Builder\u503c\u91cd\u65b0\u56de\u5230\u96f6\u503c\u72b6\u6001\uff0c\u5c31\u50cf\u5b83\u4ece\u672a\u88ab\u4f7f\u7528\u8fc7\u90a3\u6837 // \u4e00\u65e6\u88ab\u91cd\u7f6e\uff0cBuilder\u503c\u4e2d\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\u4f1a\u88ab\u76f4\u63a5\u4e22\u5f03 // \u4e0e\u5176\u4ed6\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5c06\u4f1a\u88abGo\u8bed\u8a00\u7684\u5783\u573e\u56de\u5668\u6807\u8bb0\u5e76\u56de\u6536\u6389 builder1.Reset() fmt.Printf( The third output(%d):\\n%q\\n , builder1.Len(), builder1.String())","title":"strings.Builder\u7c7b\u578b"},{"location":"Language/Basic/21-strings/#stringsbuilder_1","text":"\u5728\u5df2\u88ab\u771f\u6b63\u4f7f\u7528\u540e\u5c31\u4e0d\u53ef\u5728\u88ab\u590d\u5236 \u8c03\u7528Builder\u503c\u7684\u62fc\u63a5\u65b9\u6cd5\u548c\u6269\u5bb9\u65b9\u6cd5\u5c31\u610f\u5473\u7740\u5f00\u59cb\u771f\u6b63\u4f7f\u7528\u5b83\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u4f1a\u6539\u53d8\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u72b6\u6001\uff0c\u4e00\u65e6\u8c03\u7528\u4e86\u5b83\u4eec\uff0c\u5c31\u4e0d\u80fd\u518d\u4ee5\u4efb\u4f55\u7684\u65b9\u5f0f\u5bf9\u5176\u6240\u5c5e\u503c\u8fdb\u884c\u590d\u5236\u4e86\uff0c\u5426\u5219\u53ea\u8981\u5728\u4efb\u4f55\u526f\u672c\u4e0a\u8c03\u7528\u4e0a\u8ff0\u65b9\u6cd5\u90fd\u4f1a\u5f15\u53d1panic\u3002 \u8fd9\u79cdpanic\u4f1a\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u6837\u7684\u4f7f\u7528\u65b9\u5f0f\u5e76\u4e0d\u5408\u6cd5\uff0c\u56e0\u4e3a\u8fd9\u91cc\u7684Builder\u503c\u662f\u526f\u672c\u800c\u4e0d\u662f\u539f\u503c\uff0c\u8fd9\u7684\u590d\u5236\u65b9\u6cd5\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u51fd\u6570\u95f4\u4f20\u9012\u503c\u3001\u901a\u8fc7\u901a\u9053\u4f20\u9012\u503c\u3001\u628a\u503c\u8d4b\u4e88\u53d8\u91cf\u7b49 go var builder1 strings.Builder builder1.Grow(1) builder3 := builder1 //builder3.Grow(1) // \u8fd9\u91cc\u4f1a\u5f15\u53d1 panic\u3002 _ = builder3 \u7531\u4e8eBuilder\u503c\u4e0d\u80fd\u5728\u88ab\u590d\u5236\uff0c\u6240\u4ee5\u80af\u5b9a\u4e0d\u4f1a\u51fa\u73b0\u591a\u4e2aBuilder\u503c\u4e2d\u7684\u5185\u5bb9\u5bb9\u5668\u516c\u7528\u4e00\u4e2a\u5e95\u5c42\u5b57\u8282\u6570\u7ec4\u7684\u60c5\u51b5\uff0c\u8fd9\u6837\u907f\u514d\u4e86\u591a\u4e2a\u540c\u6e90\u7684Builder\u503c\u5728\u62fc\u63a5\u5185\u5bb9\u65f6\u53ef\u80fd\u4ea7\u751f\u7684\u51b2\u7a81\u95ee\u9898\u3002 \u867d\u7136\u5df2\u7ecf\u4f7f\u7528\u7684Builder\u503c\u4e0d\u80fd\u518d\u88ab\u590d\u5236\uff0c\u4f46\u662f\u5b83\u7684\u6307\u9488\u503c\u5374\u53ef\u4ee5\uff0c\u65e0\u8bba\u4ec0\u4e48\u65f6\u5019\uff0c\u90fd\u53ef\u4ee5\u901a\u8fc7\u4efb\u4f55\u65b9\u5f0f\u590d\u5236\u8fd9\u6837\u7684\u6307\u9488\u503c\u3002\u8fd9\u6837\u7684\u6307\u9488\u503c\u6307\u5411\u7684\u90fd\u4f1a\u662f\u540c\u4e00\u4e2aBuilder\u503c\u3002 go f2 := func(bp *strings.Builder) { (*bp).Grow(1) // \u8fd9\u91cc\u867d\u7136\u4e0d\u4f1a\u5f15\u53d1 panic\uff0c\u4f46\u4e0d\u662f\u5e76\u53d1\u5b89\u5168\u7684\u3002 builder4 := *bp //builder4.Grow(1) // \u8fd9\u91cc\u4f1a\u5f15\u53d1 panic\u3002 _ = builder4 } f2( builder1) \u8fd9\u5c31\u4ea7\u751f\u4e86\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679cBuilder\u503c\u88ab\u591a\u65b9\u540c\u65f6\u64cd\u4f5c\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u5185\u5bb9\u5c31\u53ef\u80fd\u4ea7\u751f\u6df7\u4e71\uff0c\u8fd9\u5c31\u662f\u6240\u8bf4\u7684\u64cd\u4f5c\u51b2\u7a81\u548c\u5e76\u53d1\u5b89\u5168\u95ee\u9898\u3002 \u7531\u4e8e\u5176\u5185\u5bb9\u4e0d\u662f\u5b8c\u5168\u4e0d\u53ef\u53d8\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u65b9\u81ea\u884c\u89e3\u51b3\u64cd\u4f5c\u51b2\u7a81\u548c\u5e76\u53d1\u5b89\u5168\u95ee\u9898 Builder\u503c\u81ea\u5df1\u662f\u65e0\u6cd5\u89e3\u51b3\u8fd9\u4e9b\u95ee\u9898\u7684\uff0c\u6240\u4ee5\u5728\u901a\u8fc7\u4f20\u9012\u5176\u6307\u9488\u503c\u5171\u4eabBuilder\u503c\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u786e\u4fdd\u5404\u65b9\u5bf9\u5b83\u7684\u4f7f\u7528\u662f\u6b63\u786e\u7684\u3001\u6709\u5e8f\u7684\uff0c\u5e76\u4e14\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c \u5f7b\u5e95\u7684\u89e3\u51b3\u65b9\u6848\u662f\uff0c\u7edd\u5bf9\u4e0d\u8981\u5171\u4eabBuilder\u503c\u4ee5\u53ca\u5b83\u7684\u6307\u9488\u503c \u3002 \u53ef\u4ee5\u5728\u5404\u5904\u5206\u522b\u58f0\u660e\u4e00\u4e2aBuilder\u503c\u6765\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u5148\u58f0\u660e\u4e00\u4e2aBuilder\u503c\uff0c\u7136\u540e\u5728\u771f\u6b63\u4f7f\u7528\u5b83\u4e4b\u524d\uff0c\u4fbf\u5c06\u5b83\u7684\u526f\u672c\u4f20\u5230\u5404\u5904\u3002 \u5148\u4f7f\u7528\u5728\u4f20\u9012\uff0c\u53ea\u8981\u5728\u4f20\u9012\u4e4b\u524d\u8c03\u7528\u5b83\u7684Reset\u65b9\u6cd5\u5373\u53ef\u3002 go builder1.Reset() builder5 := builder1 builder5.Grow(1) // \u8fd9\u91cc\u4e0d\u4f1a\u5f15\u53d1 panic\u3002 \u5173\u4e8e\u590d\u5236Builder\u503c\u7684\u7ea6\u675f\u662f\u6709\u610f\u4e49\u7684\uff0c\u4e5f\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002\u867d\u7136\u4ecd\u7136\u5728\u901a\u8fc7\u67d0\u4e9b\u65b9\u5f0f\u5171\u4eabBuilder\u503c\uff0c\u4f46\u6700\u597d\u8fd8\u662f\u4e0d\u8981\u4ee5\u8eab\u72af\u9669\uff0c\u5404\u81ea\u4e3a\u653f\u662f\u6700\u597d\u7684\u89e3\u51b3\u65b9\u6848\u3002 \u5bf9\u4e8e\u5904\u5728\u96f6\u503c\u72b6\u6001\u7684Builder\u503c\uff0c\u590d\u5236\u4e0d\u4f1a\u6709\u4efb\u4f55\u95ee\u9898 \u3002","title":"strings.Builder\u7c7b\u578b\u7684\u4f7f\u7528\u7ea6\u675f"},{"location":"Language/Basic/21-strings/#stringsreader","text":"\u4e0e strings.Builder \u7c7b\u578b\u6070\u6070\u76f8\u53cd\uff0c strings.Reader \u7c7b\u578b\u662f\u4e3a\u4e86\u9ad8\u6548\u8bfb\u53d6\u5b57\u7b26\u4e32\u800c\u5b58\u5728\u7684\u3002\u5b83\u7684\u9ad8\u6548\u4f53\u73b0\u5728 \u5b83\u5bf9\u5b57\u7b26\u4e32\u7684\u8bfb\u53d6\u673a\u5236\u4e0a\uff0c\u5b83\u5c01\u88c5\u4e86\u5f88\u591a\u7528\u4e8e\u5728string\u503c\u4e0a\u8bfb\u53d6\u5185\u5bb9\u7684\u6700\u4f73\u5b9e\u8df5 \u3002 strings.Reader \u7c7b\u578b\u7684\u503c\uff08\u7b80\u79f0Reader\u503c\uff09\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u5f88\u65b9\u4fbf\u5730\u8bfb\u53d6\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u7684\u5185\u5bb9\uff0c\u5728\u8bfb\u53d6\u7684\u8fc7\u7a0b\u4e2d\uff0cReader\u503c\u4f1a\u4fdd\u5b58\u5df2\u8bfb\u53d6\u7684\u5b57\u8282\u7684\u8ba1\u6570\uff08\u7b80\u79f0\u5df2\u8bfb\u8ba1\u6570\uff09\u3002 \u5df2\u8bfb\u8ba1\u6570\uff0c\u4ee3\u8868\u8fd9\u4e0b\u4e00\u4e2a\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4e3a\u6b62\uff0cReader\u503c\u5c31\u662f\u4f9d\u9760\u8fd9\u6837\u7684\u4e00\u4e2a\u8ba1\u6570\uff0c\u4ee5\u53ca\u9488\u5bf9\u5b57\u7b26\u4e32\u7684\u5207\u7247\u8868\u8fbe\u5f0f\uff0c\u4ece\u800c\u5b9e\u73b0\u5feb\u8bfb\u901f\u8bfb\u53d6\u7684\u3002 \u5df2\u8bfb\u8ba1\u6570\uff0c\u4e5f\u662f\u8bfb\u53d6\u56de\u9000\u548c\u4f4d\u7f6e\u8bbe\u5b9a\u65f6\u7684\u91cd\u8981\u4f9d\u636e\u3002\u867d\u7136\u5b83\u5c5e\u4e8eReader\u7684\u5185\u90e8\u7ed3\u6784\uff0c\u4f46\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u8be5\u503c\u7684Len\u65b9\u6cd5\u548cSize\u65b9\u6cd5\u628a\u5b83\u8ba1\u7b97\u51fa\u6765\u7684\u3002\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var reader1 strings.Reader // \u7701\u7565\u82e5\u5e72\u4ee3\u7801\u3002 readingIndex := reader1.Size() - int64(reader1.Len()) // \u8ba1\u7b97\u51fa\u7684\u5df2\u8bfb\u8ba1\u6570\u3002 Reader\u503c\u62e5\u6709\u7684\u5927\u90e8\u5206\u7528\u4e8e\u8bfb\u53d6\u7684\u65b9\u6cd5\u90fd\u4f1a\u53ca\u65f6\u66f4\u65b0\u5df2\u8bfb\u8ba1\u6570\uff0c\u6bd4\u5982\uff1a ReadByte\u65b9\u6cd5\u4f1a\u5728\u8bfb\u53d6\u6210\u529f\u540e\u5c06\u8fd9\u4e2a\u8ba1\u6570\u7684\u503c\u52a01 ReadRune\u65b9\u6cd5\u8bfb\u53d6\u6210\u529f\u4e4b\u540e\uff0c\u4f1a\u628a\u88ab\u8bfb\u53d6\u7684\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\u4f5c\u4e3a\u8ba1\u6570\u7684\u589e\u91cf Seek\u65b9\u6cd5\u4e5f\u4f1a\u66f4\u65b0\u8be5\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u5668\uff0c\u5b83\u7684\u4e3b\u8981\u64e2\u7528\u6b63\u662f\u8bbe\u5b9a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\u3002\u5982\u679c\u628a io.SeekCurrent \u7684\u503c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u7ed9\u8be5\u65b9\u6cd5\uff0c\u90a3\u4e48\u5b83\u4f1a\u4f9d\u636e\u5f53\u524d\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u4ee5\u53ca\u7b2c\u4e00\u4e2a\u53c2\u6570offset\u7684\u503c\u6765\u8ba1\u7b97\u65b0\u7684\u8ba1\u6570\u503c\u3002Seek\u65b9\u6cd5\u4f1a\u8fd4\u56de\u65b0\u7684\u8ba1\u6570\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u9a8c\u8bc1\u8fd9\u4e00\u70b9\uff0c\u5982\u4e0b\u6240\u793a\u3002 go offset2 := int64(17) expectedIndex := reader1.Size() - int64(reader1.Len()) + offset2 fmt.Printf(\"Seek with offset %d and whence %d ...\\n\", offset2, io.SeekCurrent) readingIndex, _ := reader1.Seek(offset2, io.SeekCurrent) fmt.Printf(\"The reading index in reader: %d (returned by Seek)\\n\", readingIndex) fmt.Printf(\"The reading index in reader: %d (computed by me)\\n\", expectedIndex) ReadAt\u65b9\u6cd5\u662f\u4e00\u4e2a\u4f8b\u5916\uff0c\u5b83\u65e2\u4e0d\u4f1a\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u8fdb\u884c\u8bfb\u53d6\uff0c\u4e5f\u4e0d\u4f1a\u5728\u8bfb\u53d6\u4e4b\u540e\u66f4\u65b0\u5b83\u3002\u56e0\u6b64\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u81ea\u7531\u5730\u8bfb\u53d6\u5176\u6240\u5c5e\u7684Reader\u503c\u4e2d\u7684\u4efb\u4f55\u5185\u5bb9\u3002 \u7efc\u4e0a\u6240\u5c5e\uff0cReader\u503c\u5b9e\u73b0\u9ad8\u6548\u8bfb\u53d6\u7684\u5173\u952e\u5728\u4e8e\u5b83\u5185\u90e8\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u8ba1\u6570\u7684\u503c\u5c31\u4ee3\u8868\u8fd9\u4e0b\u4e00\u6b21\u8bfb\u53d6\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\uff0c\u5b83\u53ef\u4ee5\u5f88\u5bb9\u5730\u88ab\u8ba1\u7b97\u51fa\u6765\uff0cReader\u503c\u7684Seek\u65b9\u6cd5\u53ef\u4ee5\u76f4\u63a5\u8bbe\u5b9a\u8be5\u503c\u4e2d\u7684\u5df2\u8bfb\u8ba1\u6570\u503c\u3002","title":"strings.Reader\u7c7b\u578b\u7684\u503c\u5982\u4f55\u9ad8\u6548\u8bfb\u53d6\u5b57\u7b26\u4e32"},{"location":"Language/Basic/22-bytes/","text":"bytes strings\u5305\u548cbytes\u5305\u5728API\u65b9\u9762\u975e\u5e38\u76f8\u4f3c\uff0c\u5355\u4ece\u5b83\u4eec\u63d0\u4f9b\u7684\u51fd\u6570\u7684\u6570\u91cf\u548c\u529f\u80fd\u4e0a\u8bf4\uff0c\u5dee\u522b\u5fae\u4e4e\u5176\u5fae\u3002 strings\u5305\u4e3b\u8981\u9762\u5411\u7684\u662fUnicode\u5b57\u7b26\u548c\u7ecf\u8fc7UTF-8\u7f16\u7801\u7684\u5b57\u7b26\u4e32 bytes\u5305\u4e3b\u8981\u9762\u5411\u7684\u662f\u5b57\u8282\u548c\u5b57\u8282\u5207\u7247 bytes.Buffer // Buffer\u662f\u4e00\u4e2a\u5177\u6709\u8bfb\u5199\u65b9\u6cd5\u7684\u53ef\u53d8\u5927\u5c0f\u7684\u5b57\u8282\u7f13\u51b2\u533a\u3002 // \u96f6\u503c\u7684Buffer\u662f\u4e00\u4e2a\u51c6\u5907\u4f7f\u7528\u7684\u7a7a\u7f13\u51b2\u533a\u3002 type Buffer struct { buf []byte // contents are the bytes buf[off : len(buf)] off int // read at buf[off], write at buf[len(buf)] lastRead readOp // last read operation, so that Unread* can work correctly. } \u4e3b\u8981\u7528\u9014\uff0c\u4f5c\u4e3a\u5b57\u8282\u5e8f\u5217\u7684\u7f13\u51b2\u533a \u3002\u4e0e strings.Builder \u4e00\u6837\uff0c bytes.Buffer \u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u3002 strings.Builder \uff1a\u53ea\u80fd\u62fc\u63a5\u548c\u5bfc\u51fa\u5b57\u7b26\u4e32 bytes.Buffer \uff1a\u4e0d\u4f46\u53ef\u4ee5\u62fc\u63a5\u3001\u622a\u65ad\u5176\u4e2d\u7684\u5b57\u8282\u5e8f\u5217\uff0c\u4ee5\u5404\u79cd\u5f62\u5f0f\u5bfc\u51fa\u5176\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd8\u53ef\u4ee5\u987a\u5e8f\u8bfb\u53d6\u5176\u4e2d\u7684\u5b50\u5e8f\u5217 \u5728\u5185\u90e8\uff0c bytes.Buffer \u7c7b\u578b\u540c\u6837\u4f7f\u7528\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u4e14\u4e0e strings.Reader \u7c7b\u578b\u7c7b\u4f3c\uff0c bytes.Buffer \u6709\u4e00\u4e2aint\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u7528\u4e8e\u8868\u793a\u5df2\u8bfb\u5b57\u8282\u7684\u8ba1\u6570\u3002 \u5df2\u8bfb\u5b57\u8282\u7684\u8ba1\u6570\u65e0\u6cd5\u901a\u8fc7 bytes.Buffer \u63d0\u4f9b\u7684\u65b9\u6cd5\u8ba1\u7b97\u51fa\u6765 \u3002 var buffer1 bytes.Buffer contents := Simple byte buffer for marshaling data. fmt.Printf( Writing contents %q ...\\n , contents) buffer1.WriteString(contents) fmt.Printf( The length of buffer: %d\\n , buffer1.Len()) // \u8fd4\u56de\u5176\u4e2d\u672a\u88ab\u8bfb\u53d6\u90e8\u5206\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5df2\u5b58\u5185\u5bb9\u7684\u603b\u957f\u5ea6 fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // Output Writing contents Simple byte buffer for marshaling data. The length of buffer: 39 // \u7a7a\u683c\uff0c\u6807\u70b9\uff0c\u5b57\u7b26\u52a0\u8d77\u6765\uff0c\u672a\u8c03\u7528\u4efb\u4f55\u8bfb\u53d6\u65b9\u6cd5\uff0c\u56e0\u6b64\u5df2\u8bfb\u8ba1\u6570\u4e3a\u96f6 The capacity of buffer: 64 // \u6839\u636e\u5207\u7247\u81ea\u52a8\u6269\u5bb9\u7b56\u7565\uff0c64\u770b\u8d77\u6765\u4e5f\u5f88\u5408\u7406 p1 := make([]byte, 7) n, _ := buffer1.Read(p1) // \u4ecebuffer\u4e2d\u8bfb\u53d6\u5185\u5bb9\uff0c\u5e76\u7528\u5b83\u4eec\u586b\u6ee1\u957f\u5ea6\u4e3a7\u7684\u5b57\u8282\u5207\u7247 fmt.Printf( %d bytes were read. (call Read)\\n , n) fmt.Printf( The length of buffer: %d\\n , buffer1.Len()) fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // Output 7 bytes were read. (call Read) The length of buffer: 32 The capacity of buffer: 64 Buffer \u503c\u7684\u957f\u5ea6\uff1a Buffer\u503c\u7684\u957f\u5ea6\u662f\u672a\u8bfb\u5185\u5bb9\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5df2\u5b58\u5728\u5185\u5bb9\u7684\u603b\u957f\u5ea6 \u3002\u5b83\u4e0e\u5728\u5f53\u524d\u503c\u4e4b\u4e0a\u7684\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u90fd\u6709\u5173\u7cfb\uff0c\u968f\u7740\u8fd9\u4e24\u79cd\u64cd\u4f5c\u7684\u8fdb\u884c\u800c\u6539\u53d8\u3002 Buffer\u503c\u7684\u5bb9\u91cf\uff1aBuffer\u503c\u7684\u5bb9\u91cf\u662f\u6307\u5b83\u7684\u5185\u5bb9\u5bb9\u5668\uff08\u5b57\u8282\u5207\u7247\uff09\u7684\u5bb9\u91cf\uff0c\u5b83\u53ea\u4e0e\u5728\u5f53\u524d\u503c\u4e4b\u4e0a\u7684\u5199\u64cd\u4f5c\u6709\u5173\uff0c\u5e76\u4f1a\u968f\u7740\u5185\u5bb9\u7684\u5199\u5165\u800c\u4e0d\u65ad\u589e\u957f\u3002 \u5df2\u8bfb\u5b57\u8282\u8ba1\u6570\uff1a\u5728 strings.Reader \u4e2d\u6709Size\u65b9\u6cd5\u53ef\u4ee5\u5f97\u51fa\u5185\u5bb9\u957f\u5ea6\u7684\u503c\uff0c\u6240\u4ee5\u7528\u5185\u5bb9\u957f\u5ea6\u51cf\u53bb\u672a\u8bfb\u90e8\u5206\u957f\u5ea6\u5c31\u662f\u5df2\u8bfb\u8ba1\u6570\uff0c\u4f46\u662f bytes.Buffer \u7c7b\u578b\u6ca1\u6709\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u5b83\u7684Cap\u65b9\u6cd5\u63d0\u4f9b\u7684\u662f\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\uff0c\u800c\u4e0d\u662f\u5185\u5bb9\u7684\u957f\u5ea6\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u8fd9\u4e24\u8005\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u5f88\u96be\u4f30\u8ba1Buffer\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u3002 \u5df2\u8bfb\u5b57\u8282\u8ba1\u6570\u7684\u4f5c\u7528 bytes.Buffer \u4e2d\u7684\u5df2\u8bfb\u8ba1\u6570\u7684\u5927\u81f4\u529f\u80fd\u5982\u4e0b\uff1a \u8bfb\u53d6\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\u627e\u5230\u672a\u8bfb\u90e8\u5206\uff0c\u5e76\u5728\u8bfb\u53d6\u540e\u66f4\u65b0\u8ba1\u6570 \u5199\u5165\u5185\u5bb9\u65f6\uff0c\u5982\u9700\u6269\u5bb9\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\u5b9e\u73b0\u6269\u5bb9\u7b56\u7565 \u622a\u65ad\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u622a\u6389\u7684\u662f\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7d22\u5f15\u4e4b\u540e\u7684\u672a\u8bfb\u90e8\u5206 \u8bfb\u56de\u9000\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u9700\u8981\u7528\u5df2\u8bfb\u8ba1\u6570\u8bb0\u5f55\u56de\u9000\u70b9 \u91cd\u7f6e\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u628a\u5df2\u8bfb\u8ba1\u6570\u91cd\u7f6e\u4e3a0 \u5bfc\u51fa\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u53ea\u4f1a\u5bfc\u51fa\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4e4b\u540e\u7684\u672a\u8bfb\u90e8\u5206 \u83b7\u53d6\u957f\u5ea6\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u548c\u5185\u5bb9\u5bb9\u5668\u7684\u957f\u5ea6\uff0c\u8ba1\u7b97\u672a\u8bfb\u90e8\u5206\u7684\u957f\u5ea6\u5e76\u8fd4\u56de \u5df2\u8bfb\u8ba1\u6570\u5728 bytes.Buffer \u7c7b\u578b\u4e2d\u7684\u91cd\u8981\u4f5c\u7528\uff0c\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u7528\u5230\u5b83 \u3002 \u8bfb\u53d6\u5185\u5bb9 \u76f8\u5e94\u65b9\u6cd5\u5148\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\uff0c\u5224\u65ad\u4e00\u4e0b\u5185\u5bb9\u5bb9\u5668\u4e2d\u662f\u5426\u8fd8\u6709\u672a\u8bfb\u7684\u5185\u5bb9 \u5982\u679c\u6709\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u4ece\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u5904\u5f00\u59cb\u8bfb\u53d6 \u8bfb\u53d6\u5b8c\u6210\u540e\uff0c\u53ca\u65f6\u66f4\u65b0\u5df2\u8bfb\u8ba1\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u8bb0\u5f55\u4e00\u4e0b\u53c8\u6709\u591a\u5c11\u5b57\u8282\u88ab\u8bfb\u53d6\u4e86 \u8bfb\u53d6\u5185\u5bb9\u7684\u76f8\u5e94\u65b9\u6cd5\uff1a\u5305\u62ec\u6240\u6709\u540d\u79f0\u4ee5Read\u5f00\u5934\u7684\u65b9\u6cd5\uff0c\u5df2\u7ecfNext\u65b9\u6cd5\u548cWriteTo\u65b9\u6cd5\u3002 \u5199\u5165\u5185\u5bb9 \u7edd\u5927\u591a\u6570\u7684\u76f8\u5e94\u65b9\u6cd5\u90fd\u4f1a\u5148\u68c0\u67e5\u5f53\u524d\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u662f\u5426\u6709\u8db3\u591f\u7684\u5bb9\u91cf\u5bb9\u7eb3\u65b0\u7684\u5185\u5bb9 \u5982\u679c\u6ca1\u6709\uff0c\u5c31\u5bf9\u5185\u5bb9\u5bb9\u5668\u8fdb\u884c\u6269\u5bb9 \u6269\u5bb9\u7684\u65f6\u5019\uff0c\u65b9\u6cd5\u4f1a\u5728\u5fc5\u8981\u65f6\uff0c\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u627e\u5230\u672a\u8bfb\u90e8\u5206\uff0c\u628a\u5176\u4e2d\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u6269\u5bb9\u540e\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u5934\u90e8\u4f4d\u7f6e \u7136\u540e\u65b9\u6cd5\u628a\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u91cd\u7f6e\u4e3a0\uff0c\u4ee5\u8868\u793a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u9700\u8981\u4ece\u5185\u5bb9\u5bb9\u5668\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5f00\u59cb \u5199\u5165\u5185\u5bb9\u7684\u76f8\u5e94\u65b9\u6cd5\uff1a\u5305\u62ec\u6240\u6709\u540d\u79f0\u4ee5Write\u5f00\u5934\u7684\u65b9\u6cd5\uff0c\u4ee5\u53caReadFrom\u65b9\u6cd5\u3002 \u622a\u53d6\u5185\u5bb9 \u622a\u53d6\u5185\u5bb9\u7684\u65b9\u6cd5 Truncate \uff0c\u5b83\u63a5\u6536\u4e00\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u503c\u4ee3\u8868\u4e86\uff1a\u5728\u622a\u53d6\u65f6\u9700\u8981\u4fdd\u7559\u5934\u90e8\u7684\u591a\u5c11\u4e2a\u5b57\u8282\u3002 \u8fd9\u91cc\u7684\u5934\u90e8\uff0c\u6307\u7684\u5e76\u4e0d\u662f\u5185\u5bb9\u5bb9\u5668\u7684\u5934\u90e8\uff0c\u800c\u662f\u5176\u4e2d\u672a\u8bfb\u90e8\u5206\u7684\u5934\u90e8\u3002\u5934\u90e8\u7684\u8d77\u59cb\u7d22\u5f15\u6b63\u662f\u7531\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u8868\u793a\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u518d\u52a0\u4e0a\u53c2\u6570\u503c\u540e\u5f97\u5230\u7684\u548c\uff0c\u5c31\u662f\u5185\u5bb9\u5bb9\u5668\u65b0\u7684\u603b\u957f\u5ea6\u3002 \u8bfb\u56de\u9000 \u5728 bytes.Buffer \u4e2d\uff0c\u7528\u4e8e\u8bfb\u56de\u9000\u7684\u65b9\u6cd5\u6709\uff1a UnreadByte\uff1a \u56de\u9000\u4e00\u4e2a\u5b57\u8282 \u5b9e\u73b0\u65b9\u6cd5\u662f\u628a\u5df2\u8bfb\u8ba1\u6570\u51cf\u4e00 UnreadRune\uff1a \u56de\u9000\u4e00\u4e2aUnicode\u5b57\u7b26 \u5b9e\u73b0\u65b9\u6cd5\u662f\u5728\u5df2\u8bfb\u8ba1\u6570\u4e2d\u51cf\u53bb\u4e0a\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684Unicode\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570 \u8fd9\u4e2a\u5b57\u8282\u6570\u6709 bytes.Buffer \u7684\u53e6\u4e00\u4e2a\u5b57\u6bb5\u8d1f\u8d23\u5b58\u50a8\uff0c\u5b83\u5728\u8fd9\u91cc\u7684\u6709\u6548\u53d6\u503c\u8303\u56f4\u662f[1,4]\uff0c\u53ea\u6709ReadRune\u65b9\u6cd5\u624d\u4f1a\u628a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u5728\u6b64\u8303\u56f4\u4e4b\u5185 \u53ea\u6709ReadRune\u65b9\u6cd5\u4e4b\u540e\uff0cUnreadRune\u65b9\u6cd5\u7684\u8c03\u7528\u624d\u4f1a\u6210\u529f\uff0c\u8be5\u65b9\u6cd5\u6bd4UnreadByte\u65b9\u6cd5\u7684\u9002\u7528\u9762\u66f4\u7a84\u3002 \u8c03\u7528\u5b83\u4eec\u4e00\u822c\u90fd\u662f\u4e3a\u4e86\u9000\u56de\u4e0a\u4e00\u6b21\u88ab\u8bfb\u53d6\u5185\u5bb9\u672b\u5c3e\u7684\u90a3\u4e2a\u5206\u9694\u7b26\uff0c\u6216\u8005\u5728\u91cd\u65b0\u8bfb\u53d6\u524d\u4e00\u4e2a\u5b57\u8282\u6216\u5b57\u7b26\u505a\u51c6\u5907\u3002 \u9000\u56de\u7684\u524d\u63d0\u662f\uff0c\u5728\u8c03\u7528\u5b83\u4eec\u4e4b\u524d\u7684\u90a3\u4e2a\u64cd\u4f5c\u5fc5\u987b\u662f\u201c\u8bfb\u53d6\u201d\uff0c\u5e76\u4e14\u662f\u6210\u529f\u7684\u8bfb\u53d6\uff0c\u5426\u5219\u8fd9\u4e9b\u65b9\u6cd5\u53ea\u80fd\u5ffd\u7565\u540e\u7eed\u64cd\u4f5c\u5e76\u8fd4\u56de\u4e00\u4e2a\u975enil\u7684\u9519\u8bef\u503c\u3002 bytes.Buffer \u7684Len\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u5185\u5bb9\u5bb9\u5668\u4e2d\u672a\u8bfb\u90e8\u5206\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5176\u4e2d\u5df2\u5b58\u5185\u5bb9\u7684\u603b\u957f\u5ea6\uff0c\u8be5\u7c7b\u578b\u7684Bytes\u65b9\u6cd5\u548cString\u65b9\u6cd5\u7684\u884c\u4e3a\u4e0eLen\u65b9\u6cd5\u7684\u884c\u4e3a\u4fdd\u5b58\u4e00\u76f4\uff0c\u53ea\u4f1a\u8bbf\u95ee\u672a\u8bfb\u90e8\u5206\u4e2d\u7684\u5185\u5bb9\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u7ed3\u679c\u503c\u3002 \u5728\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4e4b\u524d\u7684\u90a3\u4e9b\u5185\u5bb9\uff0c\u6c38\u8fdc\u90fd\u662f\u5df2\u7ecf\u88ab\u8bfb\u8fc7\u7684\uff0c\u5b83\u4eec\u51e0\u4e4e\u6ca1\u6709\u673a\u4f1a\u518d\u6b21\u88ab\u8bfb\u53d6 \u3002\u8fd9\u4e9b\u5df2\u8bfb\u5185\u5bb9\u6240\u5728\u7684\u5185\u5b58\u7a7a\u95f4\u53ef\u80fd\u4f1a\u88ab\u5b58\u5165\u65b0\u7684\u5185\u5bb9\uff0c\u8fd9\u4e00\u822c\u90fd\u662f\u7531\u4e8e\u91cd\u7f6e\u6216\u8005\u6269\u5145\u5185\u5bb9\u5bb9\u5668\u5bfc\u81f4\u7684\u3002\u8fd9\u65f6\uff0c\u5df2\u8bfb\u8ba1\u6570\u4e00\u5b9a\u4f1a\u88ab\u7f6e\u4e3a0\uff0c\u4ece\u800c\u518d\u6b21\u6307\u5411\u5185\u5bb9\u5bb9\u5668\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u3002\u8fd9\u6709\u65f6\u5019\u4e5f\u662f\u4e3a\u4e86\u907f\u514d\u5185\u5b58\u5206\u914d\u548c\u91cd\u7528\u5185\u5b58\u7a7a\u95f4\u3002 \u6269\u5bb9\u7b56\u7565 Buffer\u503c\u65e2\u53ef\u4ee5\u624b\u52a8\u6269\u5bb9\uff0c\u4e5f\u53ef\u4ee5\u81ea\u52a8\u6269\u5bb9\uff0c\u8fd9\u4e24\u79cd\u6269\u5bb9\u65b9\u5f0f\u7684\u7b56\u7565\u57fa\u672c\u4e00\u76f4\uff0c\u9664\u975e\u5b8c\u5168\u786e\u5b9a\u540e\u7eed\u5185\u5bb9\u6240\u9700\u7684\u5b57\u8282\u6570\uff0c\u5426\u5219\u8ba9Buffer\u503c\u81ea\u52a8\u6269\u5bb9\u5c31\u597d\u4e86\u3002 \u6269\u5bb9\u65f6\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u5148\u5224\u65ad\u5185\u5bb9\u5bb9\u5668\u7684\u5269\u4f59\u5bb9\u91cf\uff0c\u662f\u5426\u53ef\u4ee5\u6ee1\u8db3\u8c03\u7528\u65b9\u7684\u8981\u6c42\uff0c\u6216\u8005\u662f\u5426\u8db3\u591f\u5bb9\u7eb3\u65b0\u7684\u5185\u5bb9\u3002\u5982\u679c\u53ef\u4ee5\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u5728\u5f53\u524d\u7684\u5185\u5bb9\u5bb9\u5668\u4e4b\u4e0a\uff0c\u8fdb\u884c\u957f\u5ea6\u6269\u5145\u3002 \u5982\u679c\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4e0e\u5176\u957f\u5ea6\u7684\u5dee\uff0c\u5927\u4e8e\u6216\u7b49\u4e8e\u53e6\u9700\u7684\u5b57\u8282\u6570\uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u4f1a\u901a\u8fc7\u5207\u7247\u64cd\u4f5c\u5bf9\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u957f\u5ea6\u8fdb\u884c\u6269\u5145\uff0c\u5982\u4e0b\u6240\u793a\uff1a go b.buf = b.buf[:length+need] \u5982\u679c\u5185\u5bb9\u5bb9\u5668\u5269\u4f59\u7684\u5bb9\u91cf\u4e0d\u591f\u4e86\uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u53ef\u80fd\u5c31\u4f1a\u7528\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\u53bb\u4ee3\u66ff\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u4ece\u800c\u5b9e\u73b0\u6269\u5bb9\u3002\u6b64\u5904\u8fdb\u884c\u4e00\u6b65\u4f18\u5316\u3002 \u5982\u679c\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u7684\u4e00\u534a\uff0c\u4ecd\u7136\u5927\u4e8e\u6216\u7b49\u4e8e\u5176\u73b0\u6709\u957f\u5ea6\u518d\u52a0\u4e0a\u53e6\u9700\u7684\u5b57\u8282\u6570\u7684\u548c\uff0c\u5373 cap(b.buf)/2 = len(b.buf)+need \uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u4f1a\u670d\u7528\u73b0\u6709\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u628a\u5bb9\u5668\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\u62f7\u8d1d\u5230\u5b83\u7684\u5934\u90e8\u4f4d\u7f6e\u3002 \u8fd9\u6837\u5df2\u8bfb\u7684\u5185\u5bb9\u4f1a\u88ab\u5168\u90e8\u672a\u8bfb\u7684\u5185\u5bb9\u548c\u4e4b\u540e\u7684\u65b0\u5185\u5bb9\u8986\u76d6\u6389 \u3002\u8fd9\u6837\u7684\u590d\u7528\u81f3\u5c11\u8282\u7701\u4e00\u6b21\u6269\u5bb9\u5e26\u6765\u7684\u5185\u5b58\u5206\u914d\u4ee5\u53ca\u82e5\u5e72\u5b57\u8282\u7684\u62f7\u8d1d\u3002 \u82e5\u4e0d\u6ee1\u8db3\u4f18\u5316\u6761\u4ef6\uff0c\u5373\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u5c0f\u4e8e\u65b0\u957f\u5ea6\u7684\u4e24\u500d\u3002\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u53ea\u80fd\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u628a\u539f\u6709\u5bb9\u5668\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\u62f7\u8d1d\u8fdb\u53bb\uff0c\u6700\u540e\u518d\u7528\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\u66ff\u6362\u539f\u6765\u7684\u3002 \u65b0\u5bb9\u5668\u7684\u5bb9\u91cf=2\u00d7\u539f\u6765\u5bb9\u91cf+\u6240\u9700\u5b57\u8282\u6570 \u901a\u8fc7\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u5bf9\u5185\u5bb9\u5bb9\u5668\u7684\u6269\u5bb9\u57fa\u672c\u5b8c\u6210\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u5185\u90e8\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u4ee5\u53ca\u907f\u514d\u539f\u6709\u7684\u5df2\u8bfb\u5185\u5bb9\u9020\u6210\u7684\u6570\u636e\u6df7\u4e71\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u628a\u5df2\u8bfb\u8ba1\u6570\u91cd\u7f6e\u4e3a0\uff0c\u5e76\u518d\u5bf9\u5185\u5bb9\u5bb9\u5668\u505a\u4e00\u6b21\u5207\u7247\u64cd\u4f5c\uff0c\u4ee5\u63a9\u76d6\u6389\u539f\u6709\u7684\u5df2\u8bfb\u5185\u5bb9\u3002 \u5bf9\u4e8e\u5904\u4e8e\u96f6\u503c\u72b6\u6001\u7684Buffer\u503c\u6765\u8bf4\uff0c\u5982\u679c\u7b2c\u4e00\u6b21\u6269\u5bb9\u65f6\u7684\u53e6\u9700\u5b57\u8282\u6570\u4e0d\u5927\u4e8e64\uff0c\u90a3\u4e48\u8be5\u503c\u4f1a\u57fa\u4e8e\u4e00\u4e2a\u9884\u5148\u5b9a\u4e49\u597d\u7684\uff0c\u957f\u5ea6\u4e3a64\u7684\u5b57\u8282\u6570\u7ec4\u6765\u521b\u5efa\u5185\u5bb9\u5bb9\u5668\uff0c\u8fd9\u6837\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u5c31\u662f64\uff0c \u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9Buffer\u503c\u5728\u521a\u88ab\u771f\u6b63\u4f7f\u7528\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u5feb\u901f\u5730\u505a\u597d\u51c6\u5907 \u3002 \u54ea\u4e9b\u65b9\u6cd5\u53ef\u80fd\u9020\u6210\u5185\u5bb9\u6cc4\u9732 \u5185\u5bb9\u6cc4\u9732\u662f\u6307\u4f7f\u7528Buffer\u503c\u7684\u4e00\u65b9\u901a\u8fc7\u67d0\u79cd\u975e\u6807\u51c6\u65b9\u5f0f\u7b49\u5230\u4e86\u672c\u4e0d\u8be5\u5f97\u5230\u7684\u5185\u5bb9\u3002 \u6bd4\u5982\uff0c\u901a\u8fc7\u8c03\u7528Buffer\u503c\u7684\u67d0\u4e2a\u7528\u4e8e\u8bfb\u53d6\u5185\u5bb9\u7684\u65b9\u6cd5\uff0c\u5f97\u5230\u4e86\u4e00\u90e8\u5206\u672a\u8bfb\u5185\u5bb9\uff0c\u6211\u4eec\u5e94\u8be5\u4e5f\u53ea\u5e94\u8be5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\uff0c\u62ff\u5230\u5728\u90a3\u4e00\u65f6\u523b\u503c\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\uff0c\u4f46\u662f\uff0c\u5728\u8fd9\u4e2aBuffer\u503c\u53c8\u6709\u4e86\u4e00\u4e9b\u65b0\u7684\u5185\u5bb9\u4e4b\u540e\uff0c\u5374\u53ef\u4ee5\u901a\u8fc7\u5f53\u65f6\u5f97\u5230\u7684\u7ed3\u679c\u503c\uff0c\u76f4\u63a5\u83b7\u5f97\u65b0\u7684\u5185\u5bb9\uff0c\u800c\u4e0d\u9700\u8981\u518d\u6b21\u8c03\u7528\u76f8\u5e94\u7684\u65b9\u6cd5\u3002 \u8fd9\u5c31\u662f\u5178\u578b\u7684\u975e\u6807\u51c6\u8bfb\u53d6\u65b9\u5f0f \u3002\u8fd9\u79cd\u8bfb\u53d6\u65b9\u5f0f\u4e0d\u5e94\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728\uff0c\u4e0d\u5e94\u8be5\u4f7f\u7528\u3002 \u5728 bytes.Buffer \u4e2d\uff0cBytes\u65b9\u6cd5\u548cNext\u65b9\u6cd5\u90fd\u53ef\u80fd\u4f1a\u9020\u6210\u5185\u5bb9\u7684\u6cc4\u9732\uff0c\u539f\u56e0\u5728\u4e8e\uff0c\u5b83\u4eec\u90fd\u628a\u57fa\u4e8e\u5185\u5bb9\u5bb9\u5668\u7684\u5207\u7247\u76f4\u63a5\u8fd4\u56de\u7ed9\u4e86\u65b9\u6cd5\u7684\u8c03\u7528\u65b9\u3002 \u57fa\u4e8e\u5207\u7247\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u548c\u64cd\u4f5c\u5b83\u7684\u5e95\u5c42\u6570\u7ec4\uff0c\u4e0d\u8bba\u8fd9\u4e2a\u5207\u7247\u662f\u57fa\u4e8e\u67d0\u4e2a\u6570\u7ec4\u5f97\u6765\u7684\uff0c\u8fd8\u662f\u901a\u8fc7\u53e6\u4e00\u4e2a\u5207\u7247\u64cd\u4f5c\u83b7\u5f97\u7684 \u3002 \u5728\u8fd9\u91ccBytes\u65b9\u6cd5\u548cNext\u65b9\u6cd5\u8fd4\u56de\u7684\u5b57\u8282\u5207\u7247\uff0c\u90fd\u662f\u901a\u8fc7\u5bf9\u5185\u5bb9\u5bb9\u5668\u505a\u5207\u7247\u64cd\u4f5c\u5f97\u5230\u7684\uff0c\u5b83\u4eec\u4e0e\u5185\u5bb9\u5bb9\u5668\u5171\u7528\u540c\u4e00\u4e2a\u5e95\u5c42\u6570\u7ec4\uff0c\u8d77\u7801\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u662f\u8fd9\u6837\u7684\u3002 \u4f8b\u5b50 Bytes\u65b9\u6cd5\u4f1a\u8fd4\u56de\u5728\u8c03\u7528\u90a3\u4e00\u523b\u5b83\u6240\u5c5e\u503c\u4e2d\u7684\u6240\u4ee5\u672a\u8bfb\u5185\u5bb9\uff1a contents := ab buffer1 := bytes.NewBufferString(contents) fmt.Printf( The capacity of new buffer with contents %q: %d\\n , contents, buffer1.Cap()) // \u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4e3a\uff1a8\u3002 unreadBytes := buffer1.Bytes() fmt.Printf( The unread bytes of the buffer: %v\\n , unreadBytes) // \u672a\u8bfb\u5185\u5bb9\u4e3a\uff1a[97 98]\u3002 buffer1.WriteString( cdefg )// \u5728\u5411buffer1\u4e2d\u5199\u5165\u5b57\u7b26\u4e32\u503c\u201ccdefg\u201d fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // \u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4ecd\u4e3a\uff1a8\u3002 // \u901a\u8fc7\u7b80\u5355\u7684\u5728\u5207\u7247\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\u503c\u62ff\u5230buffer1\u5728\u6b64\u65f6\u7684\u6240\u6709\u672a\u8bfb\u5185\u5bb9 unreadBytes = unreadBytes[:cap(unreadBytes)] fmt.Printf( The unread bytes of the buffer: %v\\n , unreadBytes) // \u57fa\u4e8e\u524d\u9762\u83b7\u53d6\u5230\u7684\u7ed3\u679c\u503c\u53ef\u5f97\uff0c\u672a\u8bfb\u5185\u5bb9\u4e3a\uff1a[97 98 99 100 101 102 103 0]\u3002 // \u5982\u679c\u5c06unreadBytes\u7684\u503c\u4f20\u5230\u5916\u754c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u8be5\u503c\u64cd\u7eb5buffer1\u7684\u5185\u5bb9 unreadBytes[len(unreadBytes)-2] = byte('X') // 'X'\u7684 ASCII \u7f16\u7801\u4e3a 88\u3002 fmt.Printf( The unread bytes of the buffer: %v\\n , buffer1.Bytes()) // \u672a\u8bfb\u5185\u5bb9\u53d8\u4e3a\u4e86\uff1a[97 98 99 100 101 102 88]\u3002 Next\u65b9\u6cd5\u4e5f\u6709\u8fd9\u6837\u7684\u95ee\u9898\u3002 \u5982\u679c\u7ecf\u8fc7\u6269\u5bb9\uff0cBuffer\u503c\u7684\u5185\u5bb9\u5bb9\u5668\u6216\u8005\u5b83\u7684\u5e95\u5c42\u6570\u7ec4\u88ab\u91cd\u65b0\u8bbe\u5b9a\u4e86\uff0c\u90a3\u4e48\u4e4b\u524d\u7684\u5185\u5bb9\u6cc4\u9732\u95ee\u9898\u5c31\u65e0\u6cd5\u518d\u8fdb\u4e00\u6b65\u53d1\u5c55\u4e86 \u3002\u5728\u4f20\u51fa\u5207\u7247\u8fd9\u7c7b\u503c\u4e4b\u524d\u8981\u505a\u597d\u9694\u79bb\uff0c\u6bd4\u5982\uff0c\u5148\u5bf9\u5b83\u4eec\u8fdb\u884c\u6df1\u5ea6\u62f7\u8d1d\uff0c\u7136\u540e\u518d\u628a\u526f\u672c\u4f20\u51fa\u6765\u3002","title":"bytes"},{"location":"Language/Basic/22-bytes/#bytes","text":"strings\u5305\u548cbytes\u5305\u5728API\u65b9\u9762\u975e\u5e38\u76f8\u4f3c\uff0c\u5355\u4ece\u5b83\u4eec\u63d0\u4f9b\u7684\u51fd\u6570\u7684\u6570\u91cf\u548c\u529f\u80fd\u4e0a\u8bf4\uff0c\u5dee\u522b\u5fae\u4e4e\u5176\u5fae\u3002 strings\u5305\u4e3b\u8981\u9762\u5411\u7684\u662fUnicode\u5b57\u7b26\u548c\u7ecf\u8fc7UTF-8\u7f16\u7801\u7684\u5b57\u7b26\u4e32 bytes\u5305\u4e3b\u8981\u9762\u5411\u7684\u662f\u5b57\u8282\u548c\u5b57\u8282\u5207\u7247","title":"bytes"},{"location":"Language/Basic/22-bytes/#bytesbuffer","text":"// Buffer\u662f\u4e00\u4e2a\u5177\u6709\u8bfb\u5199\u65b9\u6cd5\u7684\u53ef\u53d8\u5927\u5c0f\u7684\u5b57\u8282\u7f13\u51b2\u533a\u3002 // \u96f6\u503c\u7684Buffer\u662f\u4e00\u4e2a\u51c6\u5907\u4f7f\u7528\u7684\u7a7a\u7f13\u51b2\u533a\u3002 type Buffer struct { buf []byte // contents are the bytes buf[off : len(buf)] off int // read at buf[off], write at buf[len(buf)] lastRead readOp // last read operation, so that Unread* can work correctly. } \u4e3b\u8981\u7528\u9014\uff0c\u4f5c\u4e3a\u5b57\u8282\u5e8f\u5217\u7684\u7f13\u51b2\u533a \u3002\u4e0e strings.Builder \u4e00\u6837\uff0c bytes.Buffer \u4e5f\u662f\u5f00\u7bb1\u5373\u7528\u3002 strings.Builder \uff1a\u53ea\u80fd\u62fc\u63a5\u548c\u5bfc\u51fa\u5b57\u7b26\u4e32 bytes.Buffer \uff1a\u4e0d\u4f46\u53ef\u4ee5\u62fc\u63a5\u3001\u622a\u65ad\u5176\u4e2d\u7684\u5b57\u8282\u5e8f\u5217\uff0c\u4ee5\u5404\u79cd\u5f62\u5f0f\u5bfc\u51fa\u5176\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd8\u53ef\u4ee5\u987a\u5e8f\u8bfb\u53d6\u5176\u4e2d\u7684\u5b50\u5e8f\u5217 \u5728\u5185\u90e8\uff0c bytes.Buffer \u7c7b\u578b\u540c\u6837\u4f7f\u7528\u5b57\u8282\u5207\u7247\u4f5c\u4e3a\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u4e14\u4e0e strings.Reader \u7c7b\u578b\u7c7b\u4f3c\uff0c bytes.Buffer \u6709\u4e00\u4e2aint\u7c7b\u578b\u7684\u5b57\u6bb5\uff0c\u7528\u4e8e\u8868\u793a\u5df2\u8bfb\u5b57\u8282\u7684\u8ba1\u6570\u3002 \u5df2\u8bfb\u5b57\u8282\u7684\u8ba1\u6570\u65e0\u6cd5\u901a\u8fc7 bytes.Buffer \u63d0\u4f9b\u7684\u65b9\u6cd5\u8ba1\u7b97\u51fa\u6765 \u3002 var buffer1 bytes.Buffer contents := Simple byte buffer for marshaling data. fmt.Printf( Writing contents %q ...\\n , contents) buffer1.WriteString(contents) fmt.Printf( The length of buffer: %d\\n , buffer1.Len()) // \u8fd4\u56de\u5176\u4e2d\u672a\u88ab\u8bfb\u53d6\u90e8\u5206\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5df2\u5b58\u5185\u5bb9\u7684\u603b\u957f\u5ea6 fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // Output Writing contents Simple byte buffer for marshaling data. The length of buffer: 39 // \u7a7a\u683c\uff0c\u6807\u70b9\uff0c\u5b57\u7b26\u52a0\u8d77\u6765\uff0c\u672a\u8c03\u7528\u4efb\u4f55\u8bfb\u53d6\u65b9\u6cd5\uff0c\u56e0\u6b64\u5df2\u8bfb\u8ba1\u6570\u4e3a\u96f6 The capacity of buffer: 64 // \u6839\u636e\u5207\u7247\u81ea\u52a8\u6269\u5bb9\u7b56\u7565\uff0c64\u770b\u8d77\u6765\u4e5f\u5f88\u5408\u7406 p1 := make([]byte, 7) n, _ := buffer1.Read(p1) // \u4ecebuffer\u4e2d\u8bfb\u53d6\u5185\u5bb9\uff0c\u5e76\u7528\u5b83\u4eec\u586b\u6ee1\u957f\u5ea6\u4e3a7\u7684\u5b57\u8282\u5207\u7247 fmt.Printf( %d bytes were read. (call Read)\\n , n) fmt.Printf( The length of buffer: %d\\n , buffer1.Len()) fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // Output 7 bytes were read. (call Read) The length of buffer: 32 The capacity of buffer: 64 Buffer \u503c\u7684\u957f\u5ea6\uff1a Buffer\u503c\u7684\u957f\u5ea6\u662f\u672a\u8bfb\u5185\u5bb9\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5df2\u5b58\u5728\u5185\u5bb9\u7684\u603b\u957f\u5ea6 \u3002\u5b83\u4e0e\u5728\u5f53\u524d\u503c\u4e4b\u4e0a\u7684\u8bfb\u64cd\u4f5c\u548c\u5199\u64cd\u4f5c\u90fd\u6709\u5173\u7cfb\uff0c\u968f\u7740\u8fd9\u4e24\u79cd\u64cd\u4f5c\u7684\u8fdb\u884c\u800c\u6539\u53d8\u3002 Buffer\u503c\u7684\u5bb9\u91cf\uff1aBuffer\u503c\u7684\u5bb9\u91cf\u662f\u6307\u5b83\u7684\u5185\u5bb9\u5bb9\u5668\uff08\u5b57\u8282\u5207\u7247\uff09\u7684\u5bb9\u91cf\uff0c\u5b83\u53ea\u4e0e\u5728\u5f53\u524d\u503c\u4e4b\u4e0a\u7684\u5199\u64cd\u4f5c\u6709\u5173\uff0c\u5e76\u4f1a\u968f\u7740\u5185\u5bb9\u7684\u5199\u5165\u800c\u4e0d\u65ad\u589e\u957f\u3002 \u5df2\u8bfb\u5b57\u8282\u8ba1\u6570\uff1a\u5728 strings.Reader \u4e2d\u6709Size\u65b9\u6cd5\u53ef\u4ee5\u5f97\u51fa\u5185\u5bb9\u957f\u5ea6\u7684\u503c\uff0c\u6240\u4ee5\u7528\u5185\u5bb9\u957f\u5ea6\u51cf\u53bb\u672a\u8bfb\u90e8\u5206\u957f\u5ea6\u5c31\u662f\u5df2\u8bfb\u8ba1\u6570\uff0c\u4f46\u662f bytes.Buffer \u7c7b\u578b\u6ca1\u6709\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u5b83\u7684Cap\u65b9\u6cd5\u63d0\u4f9b\u7684\u662f\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\uff0c\u800c\u4e0d\u662f\u5185\u5bb9\u7684\u957f\u5ea6\uff0c\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u8fd9\u4e24\u8005\u662f\u4e0d\u540c\u7684\uff0c\u56e0\u6b64\u5f88\u96be\u4f30\u8ba1Buffer\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u3002","title":"bytes.Buffer"},{"location":"Language/Basic/22-bytes/#_1","text":"bytes.Buffer \u4e2d\u7684\u5df2\u8bfb\u8ba1\u6570\u7684\u5927\u81f4\u529f\u80fd\u5982\u4e0b\uff1a \u8bfb\u53d6\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\u627e\u5230\u672a\u8bfb\u90e8\u5206\uff0c\u5e76\u5728\u8bfb\u53d6\u540e\u66f4\u65b0\u8ba1\u6570 \u5199\u5165\u5185\u5bb9\u65f6\uff0c\u5982\u9700\u6269\u5bb9\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\u5b9e\u73b0\u6269\u5bb9\u7b56\u7565 \u622a\u65ad\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u622a\u6389\u7684\u662f\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7d22\u5f15\u4e4b\u540e\u7684\u672a\u8bfb\u90e8\u5206 \u8bfb\u56de\u9000\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u9700\u8981\u7528\u5df2\u8bfb\u8ba1\u6570\u8bb0\u5f55\u56de\u9000\u70b9 \u91cd\u7f6e\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u628a\u5df2\u8bfb\u8ba1\u6570\u91cd\u7f6e\u4e3a0 \u5bfc\u51fa\u5185\u5bb9\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u53ea\u4f1a\u5bfc\u51fa\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4e4b\u540e\u7684\u672a\u8bfb\u90e8\u5206 \u83b7\u53d6\u957f\u5ea6\u65f6\uff0c\u76f8\u5e94\u65b9\u6cd5\u4f1a\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u548c\u5185\u5bb9\u5bb9\u5668\u7684\u957f\u5ea6\uff0c\u8ba1\u7b97\u672a\u8bfb\u90e8\u5206\u7684\u957f\u5ea6\u5e76\u8fd4\u56de \u5df2\u8bfb\u8ba1\u6570\u5728 bytes.Buffer \u7c7b\u578b\u4e2d\u7684\u91cd\u8981\u4f5c\u7528\uff0c\u5927\u90e8\u5206\u65b9\u6cd5\u90fd\u7528\u5230\u5b83 \u3002","title":"\u5df2\u8bfb\u5b57\u8282\u8ba1\u6570\u7684\u4f5c\u7528"},{"location":"Language/Basic/22-bytes/#_2","text":"\u76f8\u5e94\u65b9\u6cd5\u5148\u6839\u636e\u5df2\u8bfb\u8ba1\u6570\uff0c\u5224\u65ad\u4e00\u4e0b\u5185\u5bb9\u5bb9\u5668\u4e2d\u662f\u5426\u8fd8\u6709\u672a\u8bfb\u7684\u5185\u5bb9 \u5982\u679c\u6709\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u4ece\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u5904\u5f00\u59cb\u8bfb\u53d6 \u8bfb\u53d6\u5b8c\u6210\u540e\uff0c\u53ca\u65f6\u66f4\u65b0\u5df2\u8bfb\u8ba1\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f1a\u8bb0\u5f55\u4e00\u4e0b\u53c8\u6709\u591a\u5c11\u5b57\u8282\u88ab\u8bfb\u53d6\u4e86 \u8bfb\u53d6\u5185\u5bb9\u7684\u76f8\u5e94\u65b9\u6cd5\uff1a\u5305\u62ec\u6240\u6709\u540d\u79f0\u4ee5Read\u5f00\u5934\u7684\u65b9\u6cd5\uff0c\u5df2\u7ecfNext\u65b9\u6cd5\u548cWriteTo\u65b9\u6cd5\u3002","title":"\u8bfb\u53d6\u5185\u5bb9"},{"location":"Language/Basic/22-bytes/#_3","text":"\u7edd\u5927\u591a\u6570\u7684\u76f8\u5e94\u65b9\u6cd5\u90fd\u4f1a\u5148\u68c0\u67e5\u5f53\u524d\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u662f\u5426\u6709\u8db3\u591f\u7684\u5bb9\u91cf\u5bb9\u7eb3\u65b0\u7684\u5185\u5bb9 \u5982\u679c\u6ca1\u6709\uff0c\u5c31\u5bf9\u5185\u5bb9\u5bb9\u5668\u8fdb\u884c\u6269\u5bb9 \u6269\u5bb9\u7684\u65f6\u5019\uff0c\u65b9\u6cd5\u4f1a\u5728\u5fc5\u8981\u65f6\uff0c\u4f9d\u636e\u5df2\u8bfb\u8ba1\u6570\u627e\u5230\u672a\u8bfb\u90e8\u5206\uff0c\u628a\u5176\u4e2d\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u6269\u5bb9\u540e\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u5934\u90e8\u4f4d\u7f6e \u7136\u540e\u65b9\u6cd5\u628a\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u91cd\u7f6e\u4e3a0\uff0c\u4ee5\u8868\u793a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u9700\u8981\u4ece\u5185\u5bb9\u5bb9\u5668\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u5f00\u59cb \u5199\u5165\u5185\u5bb9\u7684\u76f8\u5e94\u65b9\u6cd5\uff1a\u5305\u62ec\u6240\u6709\u540d\u79f0\u4ee5Write\u5f00\u5934\u7684\u65b9\u6cd5\uff0c\u4ee5\u53caReadFrom\u65b9\u6cd5\u3002","title":"\u5199\u5165\u5185\u5bb9"},{"location":"Language/Basic/22-bytes/#_4","text":"\u622a\u53d6\u5185\u5bb9\u7684\u65b9\u6cd5 Truncate \uff0c\u5b83\u63a5\u6536\u4e00\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u8fd9\u4e2a\u53c2\u6570\u7684\u503c\u4ee3\u8868\u4e86\uff1a\u5728\u622a\u53d6\u65f6\u9700\u8981\u4fdd\u7559\u5934\u90e8\u7684\u591a\u5c11\u4e2a\u5b57\u8282\u3002 \u8fd9\u91cc\u7684\u5934\u90e8\uff0c\u6307\u7684\u5e76\u4e0d\u662f\u5185\u5bb9\u5bb9\u5668\u7684\u5934\u90e8\uff0c\u800c\u662f\u5176\u4e2d\u672a\u8bfb\u90e8\u5206\u7684\u5934\u90e8\u3002\u5934\u90e8\u7684\u8d77\u59cb\u7d22\u5f15\u6b63\u662f\u7531\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u8868\u793a\u7684\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u518d\u52a0\u4e0a\u53c2\u6570\u503c\u540e\u5f97\u5230\u7684\u548c\uff0c\u5c31\u662f\u5185\u5bb9\u5bb9\u5668\u65b0\u7684\u603b\u957f\u5ea6\u3002","title":"\u622a\u53d6\u5185\u5bb9"},{"location":"Language/Basic/22-bytes/#_5","text":"\u5728 bytes.Buffer \u4e2d\uff0c\u7528\u4e8e\u8bfb\u56de\u9000\u7684\u65b9\u6cd5\u6709\uff1a UnreadByte\uff1a \u56de\u9000\u4e00\u4e2a\u5b57\u8282 \u5b9e\u73b0\u65b9\u6cd5\u662f\u628a\u5df2\u8bfb\u8ba1\u6570\u51cf\u4e00 UnreadRune\uff1a \u56de\u9000\u4e00\u4e2aUnicode\u5b57\u7b26 \u5b9e\u73b0\u65b9\u6cd5\u662f\u5728\u5df2\u8bfb\u8ba1\u6570\u4e2d\u51cf\u53bb\u4e0a\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684Unicode\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570 \u8fd9\u4e2a\u5b57\u8282\u6570\u6709 bytes.Buffer \u7684\u53e6\u4e00\u4e2a\u5b57\u6bb5\u8d1f\u8d23\u5b58\u50a8\uff0c\u5b83\u5728\u8fd9\u91cc\u7684\u6709\u6548\u53d6\u503c\u8303\u56f4\u662f[1,4]\uff0c\u53ea\u6709ReadRune\u65b9\u6cd5\u624d\u4f1a\u628a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u5728\u6b64\u8303\u56f4\u4e4b\u5185 \u53ea\u6709ReadRune\u65b9\u6cd5\u4e4b\u540e\uff0cUnreadRune\u65b9\u6cd5\u7684\u8c03\u7528\u624d\u4f1a\u6210\u529f\uff0c\u8be5\u65b9\u6cd5\u6bd4UnreadByte\u65b9\u6cd5\u7684\u9002\u7528\u9762\u66f4\u7a84\u3002 \u8c03\u7528\u5b83\u4eec\u4e00\u822c\u90fd\u662f\u4e3a\u4e86\u9000\u56de\u4e0a\u4e00\u6b21\u88ab\u8bfb\u53d6\u5185\u5bb9\u672b\u5c3e\u7684\u90a3\u4e2a\u5206\u9694\u7b26\uff0c\u6216\u8005\u5728\u91cd\u65b0\u8bfb\u53d6\u524d\u4e00\u4e2a\u5b57\u8282\u6216\u5b57\u7b26\u505a\u51c6\u5907\u3002 \u9000\u56de\u7684\u524d\u63d0\u662f\uff0c\u5728\u8c03\u7528\u5b83\u4eec\u4e4b\u524d\u7684\u90a3\u4e2a\u64cd\u4f5c\u5fc5\u987b\u662f\u201c\u8bfb\u53d6\u201d\uff0c\u5e76\u4e14\u662f\u6210\u529f\u7684\u8bfb\u53d6\uff0c\u5426\u5219\u8fd9\u4e9b\u65b9\u6cd5\u53ea\u80fd\u5ffd\u7565\u540e\u7eed\u64cd\u4f5c\u5e76\u8fd4\u56de\u4e00\u4e2a\u975enil\u7684\u9519\u8bef\u503c\u3002 bytes.Buffer \u7684Len\u65b9\u6cd5\u8fd4\u56de\u7684\u662f\u5185\u5bb9\u5bb9\u5668\u4e2d\u672a\u8bfb\u90e8\u5206\u7684\u957f\u5ea6\uff0c\u800c\u4e0d\u662f\u5176\u4e2d\u5df2\u5b58\u5185\u5bb9\u7684\u603b\u957f\u5ea6\uff0c\u8be5\u7c7b\u578b\u7684Bytes\u65b9\u6cd5\u548cString\u65b9\u6cd5\u7684\u884c\u4e3a\u4e0eLen\u65b9\u6cd5\u7684\u884c\u4e3a\u4fdd\u5b58\u4e00\u76f4\uff0c\u53ea\u4f1a\u8bbf\u95ee\u672a\u8bfb\u90e8\u5206\u4e2d\u7684\u5185\u5bb9\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u7ed3\u679c\u503c\u3002 \u5728\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4e4b\u524d\u7684\u90a3\u4e9b\u5185\u5bb9\uff0c\u6c38\u8fdc\u90fd\u662f\u5df2\u7ecf\u88ab\u8bfb\u8fc7\u7684\uff0c\u5b83\u4eec\u51e0\u4e4e\u6ca1\u6709\u673a\u4f1a\u518d\u6b21\u88ab\u8bfb\u53d6 \u3002\u8fd9\u4e9b\u5df2\u8bfb\u5185\u5bb9\u6240\u5728\u7684\u5185\u5b58\u7a7a\u95f4\u53ef\u80fd\u4f1a\u88ab\u5b58\u5165\u65b0\u7684\u5185\u5bb9\uff0c\u8fd9\u4e00\u822c\u90fd\u662f\u7531\u4e8e\u91cd\u7f6e\u6216\u8005\u6269\u5145\u5185\u5bb9\u5bb9\u5668\u5bfc\u81f4\u7684\u3002\u8fd9\u65f6\uff0c\u5df2\u8bfb\u8ba1\u6570\u4e00\u5b9a\u4f1a\u88ab\u7f6e\u4e3a0\uff0c\u4ece\u800c\u518d\u6b21\u6307\u5411\u5185\u5bb9\u5bb9\u5668\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u3002\u8fd9\u6709\u65f6\u5019\u4e5f\u662f\u4e3a\u4e86\u907f\u514d\u5185\u5b58\u5206\u914d\u548c\u91cd\u7528\u5185\u5b58\u7a7a\u95f4\u3002","title":"\u8bfb\u56de\u9000"},{"location":"Language/Basic/22-bytes/#_6","text":"Buffer\u503c\u65e2\u53ef\u4ee5\u624b\u52a8\u6269\u5bb9\uff0c\u4e5f\u53ef\u4ee5\u81ea\u52a8\u6269\u5bb9\uff0c\u8fd9\u4e24\u79cd\u6269\u5bb9\u65b9\u5f0f\u7684\u7b56\u7565\u57fa\u672c\u4e00\u76f4\uff0c\u9664\u975e\u5b8c\u5168\u786e\u5b9a\u540e\u7eed\u5185\u5bb9\u6240\u9700\u7684\u5b57\u8282\u6570\uff0c\u5426\u5219\u8ba9Buffer\u503c\u81ea\u52a8\u6269\u5bb9\u5c31\u597d\u4e86\u3002 \u6269\u5bb9\u65f6\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u5148\u5224\u65ad\u5185\u5bb9\u5bb9\u5668\u7684\u5269\u4f59\u5bb9\u91cf\uff0c\u662f\u5426\u53ef\u4ee5\u6ee1\u8db3\u8c03\u7528\u65b9\u7684\u8981\u6c42\uff0c\u6216\u8005\u662f\u5426\u8db3\u591f\u5bb9\u7eb3\u65b0\u7684\u5185\u5bb9\u3002\u5982\u679c\u53ef\u4ee5\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u5728\u5f53\u524d\u7684\u5185\u5bb9\u5bb9\u5668\u4e4b\u4e0a\uff0c\u8fdb\u884c\u957f\u5ea6\u6269\u5145\u3002 \u5982\u679c\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4e0e\u5176\u957f\u5ea6\u7684\u5dee\uff0c\u5927\u4e8e\u6216\u7b49\u4e8e\u53e6\u9700\u7684\u5b57\u8282\u6570\uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u4f1a\u901a\u8fc7\u5207\u7247\u64cd\u4f5c\u5bf9\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\u7684\u957f\u5ea6\u8fdb\u884c\u6269\u5145\uff0c\u5982\u4e0b\u6240\u793a\uff1a go b.buf = b.buf[:length+need] \u5982\u679c\u5185\u5bb9\u5bb9\u5668\u5269\u4f59\u7684\u5bb9\u91cf\u4e0d\u591f\u4e86\uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u53ef\u80fd\u5c31\u4f1a\u7528\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\u53bb\u4ee3\u66ff\u539f\u6709\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u4ece\u800c\u5b9e\u73b0\u6269\u5bb9\u3002\u6b64\u5904\u8fdb\u884c\u4e00\u6b65\u4f18\u5316\u3002 \u5982\u679c\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u7684\u4e00\u534a\uff0c\u4ecd\u7136\u5927\u4e8e\u6216\u7b49\u4e8e\u5176\u73b0\u6709\u957f\u5ea6\u518d\u52a0\u4e0a\u53e6\u9700\u7684\u5b57\u8282\u6570\u7684\u548c\uff0c\u5373 cap(b.buf)/2 = len(b.buf)+need \uff0c\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u4f1a\u670d\u7528\u73b0\u6709\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u628a\u5bb9\u5668\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\u62f7\u8d1d\u5230\u5b83\u7684\u5934\u90e8\u4f4d\u7f6e\u3002 \u8fd9\u6837\u5df2\u8bfb\u7684\u5185\u5bb9\u4f1a\u88ab\u5168\u90e8\u672a\u8bfb\u7684\u5185\u5bb9\u548c\u4e4b\u540e\u7684\u65b0\u5185\u5bb9\u8986\u76d6\u6389 \u3002\u8fd9\u6837\u7684\u590d\u7528\u81f3\u5c11\u8282\u7701\u4e00\u6b21\u6269\u5bb9\u5e26\u6765\u7684\u5185\u5b58\u5206\u914d\u4ee5\u53ca\u82e5\u5e72\u5b57\u8282\u7684\u62f7\u8d1d\u3002 \u82e5\u4e0d\u6ee1\u8db3\u4f18\u5316\u6761\u4ef6\uff0c\u5373\u5f53\u524d\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u5c0f\u4e8e\u65b0\u957f\u5ea6\u7684\u4e24\u500d\u3002\u90a3\u4e48\u6269\u5bb9\u4ee3\u7801\u5c31\u53ea\u80fd\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\uff0c\u5e76\u628a\u539f\u6709\u5bb9\u5668\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\u62f7\u8d1d\u8fdb\u53bb\uff0c\u6700\u540e\u518d\u7528\u65b0\u7684\u5185\u5bb9\u5bb9\u5668\u66ff\u6362\u539f\u6765\u7684\u3002 \u65b0\u5bb9\u5668\u7684\u5bb9\u91cf=2\u00d7\u539f\u6765\u5bb9\u91cf+\u6240\u9700\u5b57\u8282\u6570 \u901a\u8fc7\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u5bf9\u5185\u5bb9\u5bb9\u5668\u7684\u6269\u5bb9\u57fa\u672c\u5b8c\u6210\uff0c\u4e0d\u8fc7\u4e3a\u4e86\u5185\u90e8\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u4ee5\u53ca\u907f\u514d\u539f\u6709\u7684\u5df2\u8bfb\u5185\u5bb9\u9020\u6210\u7684\u6570\u636e\u6df7\u4e71\uff0c\u6269\u5bb9\u4ee3\u7801\u4f1a\u628a\u5df2\u8bfb\u8ba1\u6570\u91cd\u7f6e\u4e3a0\uff0c\u5e76\u518d\u5bf9\u5185\u5bb9\u5bb9\u5668\u505a\u4e00\u6b21\u5207\u7247\u64cd\u4f5c\uff0c\u4ee5\u63a9\u76d6\u6389\u539f\u6709\u7684\u5df2\u8bfb\u5185\u5bb9\u3002 \u5bf9\u4e8e\u5904\u4e8e\u96f6\u503c\u72b6\u6001\u7684Buffer\u503c\u6765\u8bf4\uff0c\u5982\u679c\u7b2c\u4e00\u6b21\u6269\u5bb9\u65f6\u7684\u53e6\u9700\u5b57\u8282\u6570\u4e0d\u5927\u4e8e64\uff0c\u90a3\u4e48\u8be5\u503c\u4f1a\u57fa\u4e8e\u4e00\u4e2a\u9884\u5148\u5b9a\u4e49\u597d\u7684\uff0c\u957f\u5ea6\u4e3a64\u7684\u5b57\u8282\u6570\u7ec4\u6765\u521b\u5efa\u5185\u5bb9\u5bb9\u5668\uff0c\u8fd9\u6837\u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u5c31\u662f64\uff0c \u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u8ba9Buffer\u503c\u5728\u521a\u88ab\u771f\u6b63\u4f7f\u7528\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u5feb\u901f\u5730\u505a\u597d\u51c6\u5907 \u3002","title":"\u6269\u5bb9\u7b56\u7565"},{"location":"Language/Basic/22-bytes/#_7","text":"\u5185\u5bb9\u6cc4\u9732\u662f\u6307\u4f7f\u7528Buffer\u503c\u7684\u4e00\u65b9\u901a\u8fc7\u67d0\u79cd\u975e\u6807\u51c6\u65b9\u5f0f\u7b49\u5230\u4e86\u672c\u4e0d\u8be5\u5f97\u5230\u7684\u5185\u5bb9\u3002 \u6bd4\u5982\uff0c\u901a\u8fc7\u8c03\u7528Buffer\u503c\u7684\u67d0\u4e2a\u7528\u4e8e\u8bfb\u53d6\u5185\u5bb9\u7684\u65b9\u6cd5\uff0c\u5f97\u5230\u4e86\u4e00\u90e8\u5206\u672a\u8bfb\u5185\u5bb9\uff0c\u6211\u4eec\u5e94\u8be5\u4e5f\u53ea\u5e94\u8be5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\uff0c\u62ff\u5230\u5728\u90a3\u4e00\u65f6\u523b\u503c\u4e2d\u7684\u672a\u8bfb\u5185\u5bb9\uff0c\u4f46\u662f\uff0c\u5728\u8fd9\u4e2aBuffer\u503c\u53c8\u6709\u4e86\u4e00\u4e9b\u65b0\u7684\u5185\u5bb9\u4e4b\u540e\uff0c\u5374\u53ef\u4ee5\u901a\u8fc7\u5f53\u65f6\u5f97\u5230\u7684\u7ed3\u679c\u503c\uff0c\u76f4\u63a5\u83b7\u5f97\u65b0\u7684\u5185\u5bb9\uff0c\u800c\u4e0d\u9700\u8981\u518d\u6b21\u8c03\u7528\u76f8\u5e94\u7684\u65b9\u6cd5\u3002 \u8fd9\u5c31\u662f\u5178\u578b\u7684\u975e\u6807\u51c6\u8bfb\u53d6\u65b9\u5f0f \u3002\u8fd9\u79cd\u8bfb\u53d6\u65b9\u5f0f\u4e0d\u5e94\u5b58\u5728\uff0c\u5982\u679c\u5b58\u5728\uff0c\u4e0d\u5e94\u8be5\u4f7f\u7528\u3002 \u5728 bytes.Buffer \u4e2d\uff0cBytes\u65b9\u6cd5\u548cNext\u65b9\u6cd5\u90fd\u53ef\u80fd\u4f1a\u9020\u6210\u5185\u5bb9\u7684\u6cc4\u9732\uff0c\u539f\u56e0\u5728\u4e8e\uff0c\u5b83\u4eec\u90fd\u628a\u57fa\u4e8e\u5185\u5bb9\u5bb9\u5668\u7684\u5207\u7247\u76f4\u63a5\u8fd4\u56de\u7ed9\u4e86\u65b9\u6cd5\u7684\u8c03\u7528\u65b9\u3002 \u57fa\u4e8e\u5207\u7247\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u548c\u64cd\u4f5c\u5b83\u7684\u5e95\u5c42\u6570\u7ec4\uff0c\u4e0d\u8bba\u8fd9\u4e2a\u5207\u7247\u662f\u57fa\u4e8e\u67d0\u4e2a\u6570\u7ec4\u5f97\u6765\u7684\uff0c\u8fd8\u662f\u901a\u8fc7\u53e6\u4e00\u4e2a\u5207\u7247\u64cd\u4f5c\u83b7\u5f97\u7684 \u3002 \u5728\u8fd9\u91ccBytes\u65b9\u6cd5\u548cNext\u65b9\u6cd5\u8fd4\u56de\u7684\u5b57\u8282\u5207\u7247\uff0c\u90fd\u662f\u901a\u8fc7\u5bf9\u5185\u5bb9\u5bb9\u5668\u505a\u5207\u7247\u64cd\u4f5c\u5f97\u5230\u7684\uff0c\u5b83\u4eec\u4e0e\u5185\u5bb9\u5bb9\u5668\u5171\u7528\u540c\u4e00\u4e2a\u5e95\u5c42\u6570\u7ec4\uff0c\u8d77\u7801\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u662f\u8fd9\u6837\u7684\u3002","title":"\u54ea\u4e9b\u65b9\u6cd5\u53ef\u80fd\u9020\u6210\u5185\u5bb9\u6cc4\u9732"},{"location":"Language/Basic/22-bytes/#_8","text":"Bytes\u65b9\u6cd5\u4f1a\u8fd4\u56de\u5728\u8c03\u7528\u90a3\u4e00\u523b\u5b83\u6240\u5c5e\u503c\u4e2d\u7684\u6240\u4ee5\u672a\u8bfb\u5185\u5bb9\uff1a contents := ab buffer1 := bytes.NewBufferString(contents) fmt.Printf( The capacity of new buffer with contents %q: %d\\n , contents, buffer1.Cap()) // \u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4e3a\uff1a8\u3002 unreadBytes := buffer1.Bytes() fmt.Printf( The unread bytes of the buffer: %v\\n , unreadBytes) // \u672a\u8bfb\u5185\u5bb9\u4e3a\uff1a[97 98]\u3002 buffer1.WriteString( cdefg )// \u5728\u5411buffer1\u4e2d\u5199\u5165\u5b57\u7b26\u4e32\u503c\u201ccdefg\u201d fmt.Printf( The capacity of buffer: %d\\n , buffer1.Cap()) // \u5185\u5bb9\u5bb9\u5668\u7684\u5bb9\u91cf\u4ecd\u4e3a\uff1a8\u3002 // \u901a\u8fc7\u7b80\u5355\u7684\u5728\u5207\u7247\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u7ed3\u679c\u503c\u62ff\u5230buffer1\u5728\u6b64\u65f6\u7684\u6240\u6709\u672a\u8bfb\u5185\u5bb9 unreadBytes = unreadBytes[:cap(unreadBytes)] fmt.Printf( The unread bytes of the buffer: %v\\n , unreadBytes) // \u57fa\u4e8e\u524d\u9762\u83b7\u53d6\u5230\u7684\u7ed3\u679c\u503c\u53ef\u5f97\uff0c\u672a\u8bfb\u5185\u5bb9\u4e3a\uff1a[97 98 99 100 101 102 103 0]\u3002 // \u5982\u679c\u5c06unreadBytes\u7684\u503c\u4f20\u5230\u5916\u754c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u8be5\u503c\u64cd\u7eb5buffer1\u7684\u5185\u5bb9 unreadBytes[len(unreadBytes)-2] = byte('X') // 'X'\u7684 ASCII \u7f16\u7801\u4e3a 88\u3002 fmt.Printf( The unread bytes of the buffer: %v\\n , buffer1.Bytes()) // \u672a\u8bfb\u5185\u5bb9\u53d8\u4e3a\u4e86\uff1a[97 98 99 100 101 102 88]\u3002 Next\u65b9\u6cd5\u4e5f\u6709\u8fd9\u6837\u7684\u95ee\u9898\u3002 \u5982\u679c\u7ecf\u8fc7\u6269\u5bb9\uff0cBuffer\u503c\u7684\u5185\u5bb9\u5bb9\u5668\u6216\u8005\u5b83\u7684\u5e95\u5c42\u6570\u7ec4\u88ab\u91cd\u65b0\u8bbe\u5b9a\u4e86\uff0c\u90a3\u4e48\u4e4b\u524d\u7684\u5185\u5bb9\u6cc4\u9732\u95ee\u9898\u5c31\u65e0\u6cd5\u518d\u8fdb\u4e00\u6b65\u53d1\u5c55\u4e86 \u3002\u5728\u4f20\u51fa\u5207\u7247\u8fd9\u7c7b\u503c\u4e4b\u524d\u8981\u505a\u597d\u9694\u79bb\uff0c\u6bd4\u5982\uff0c\u5148\u5bf9\u5b83\u4eec\u8fdb\u884c\u6df1\u5ea6\u62f7\u8d1d\uff0c\u7136\u540e\u518d\u628a\u526f\u672c\u4f20\u51fa\u6765\u3002","title":"\u4f8b\u5b50"},{"location":"Language/Basic/23-io/","text":"io io\u5305\u4e2d\u63a5\u53e3\u7684\u597d\u5904\u4e0e\u4f18\u52bf \u63d0\u9ad8\u4e0d\u540c\u7a0b\u5e8f\u5b9e\u4f53\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u3002 \u5728io\u5305\u4e2d\uff0c\u6709\u8fd9\u6837\u51e0\u4e2a\u62f7\u8d1d\u6570\u636e\u7684\u51fd\u6570\uff1a io.Copy \uff0c io.CopyBuffer \uff0c io.CopyN \u3002\u8fd9\u51e0\u4e2a\u51fd\u6570\u5728\u529f\u80fd\u4e0a\u7565\u6709\u5dee\u522b\uff0c\u4f46\u5b83\u4eec\u9996\u5148\u4f1a\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a \u7528\u4e8e\u4ee3\u8868\u6570\u636e\u76ee\u7684\u5730\uff0c io.Writer \u7c7b\u578b\u7684\u53c2\u6570dst \u7528\u4e8e\u4ee3\u8868\u6570\u636e\u6765\u6e90\u7684\uff0c io.Reader \u7c7b\u578b\u7684\u53c2\u6570src \u8fd9\u4e9b\u51fd\u6570\u7684\u529f\u80fd\u5927\u81f4\u4e0a\u90fd\u662f\u628a\u6570\u636e\u4ecesrc\u62f7\u8d1d\u5230dst\u3002\u4e0d\u8bba\u7ed9\u4e88\u7684\u53c2\u6570\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u53ea\u8981\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u63a5\u53e3\uff0c\u5c31\u51e0\u4e4e\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\u3002 \u51fd\u6570\u4e2d\u8fd8\u4f1a\u5bf9\u5fc5\u8981\u7684\u53c2\u6570\u503c\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5\uff0c\u5982\u679c\u68c0\u67e5\u4e0d\u901a\u8fc7\uff0c\u5b83\u7684\u6267\u884c\u4e5f\u662f\u4e0d\u80fd\u591f\u6210\u529f\u7ed3\u675f\u7684 \u3002 // \u521b\u5efa\u5b57\u7b26\u4e32\u8bfb\u53d6\u5668 src := strings.NewReader( CopyN copies n bytes (or until an error) from src to dst. + It returns the number of bytes copied and + the earliest error encountered while copying. ) // \u521b\u5efa\u5b57\u7b26\u4e32\u6784\u9020\u5668 dst := new(strings.Builder) written, err := io.CopyN(dst, src, 58) if err != nil { fmt.Printf( error: %v\\n , err) } else { fmt.Printf( Written(%d): %q\\n , written, dst.String()) } \u53d8\u91cfsrc\u548cdst\u7684\u7c7b\u578b\u5206\u522b\u662f strings.Reader \u548c strings.Builder \uff0c\u5f53\u5b83\u4eec\u88ab\u4f20\u5165\u5230 io.CopyN \u51fd\u6570\u65f6\uff0c\u5c31\u5df2\u7ecf\u88ab\u5305\u88c5\u6210\u4e86 io.Reader \u548c io.Writer \u7c7b\u578b\u7684\u503c\u3002 \u4e3a\u4e86\u4f18\u5316\u7684\u76ee\u7684\uff0c io.CopyN \u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u4f1a\u5bf9\u53c2\u6570\u503c\u8fdb\u884c\u5728\u5305\u88c5\uff0c\u4e5f\u4f1a\u68c0\u6d4b\u8fd9\u4e9b\u53c2\u6570\u503c\u662f\u5426\u8fd8\u5b9e\u73b0\u4e86\u522b\u7684\u63a5\u53e3\uff0c\u751a\u81f3\u8fd8\u4f1a\u53bb\u63a2\u6c42\u67d0\u4e2a\u53c2\u6570\u503c\u88ab\u626e\u88c5\u540e\u7684\u5b9e\u9645\u7c7b\u578b\uff0c\u662f\u5426\u4e3a\u67d0\u4e2a\u7279\u6b8a\u7684\u7c7b\u578b\u3002 \u4ece\u603b\u4f53\u4e0a\u6765\u770b\uff0c\u8fd9\u4e9b\u4ee3\u7801\u90fd\u662f\u9762\u5411\u53c2\u6570\u58f0\u660e\u4e2d\u7684\u63a5\u53e3\u6765\u505a\u7684\uff0c\u6781\u5927\u7684\u6269\u5c55\u4e86\u5b83\u7684\u9002\u7528\u8303\u56f4\u548c\u5e94\u7528\u573a\u666f \u3002 \u6362\u4e2a\u89d2\u5ea6\uff0c\u6b63\u56e0\u4e3a strings.Reader \u548c strings.Builder \u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u4e0d\u5c11\u63a5\u53e3\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u503c\u624d\u80fd\u88ab\u4f7f\u7528\u5728\u66f4\u5e7f\u9614\u7684\u573a\u666f\u4e2d \u3002Go\u8bed\u8a00\u7684\u5404\u79cd\u5e93\u4e2d\uff0c\u80fd\u591f\u64cd\u4f5c\u5b83\u4eec\u7684\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\u660e\u663e\u591a\u4e86\u5f88\u591a\u3002\u8fd9\u5c31\u662fstrings\u548cbytes\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u5b9e\u73b0\u4e86\u82e5\u5e72\u4e2a\u63a5\u53e3\u4e4b\u540e\u7684\u6700\u5927\u597d\u5904\u3002 \u8fd9\u662f\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\u7684\u6700\u5927\u597d\u5904 \u3002 io.Reader \u548c ioWriter \u8fd9\u4e24\u4e2a\u6838\u5fc3\u63a5\u53e3\u662f\u5f88\u591a\u63a5\u53e3\u7684\u6269\u5c55\u5bf9\u8c61\u548c\u8bbe\u8ba1\u6e90\u6cc9\uff0c\u5f88\u591a\u6570\u636e\u7c7b\u578b\u5b9e\u73b0\u4e86 io.Reader \u63a5\u53e3\uff0c\u662f\u56e0\u4e3a\u5b83\u4eec\u63d0\u4f9b\u4e86\u4ece\u67d0\u5904\u8bfb\u53d6\u6570\u636e\u7684\u529f\u80fd\u3002 \u4e0d\u5c11\u7c7b\u578b\u7684\u8bbe\u8ba1\u521d\u8877\u662f\uff1a\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u6838\u5fc3\u63a5\u53e3\u7684\u67d0\u4e2a\uff0c\u6216\u67d0\u4e9b\u6269\u5c55\u63a5\u53e3\uff0c\u4ee5\u63d0\u4f9b\u6bd4\u5355\u7eaf\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u6216\u5199\u5165\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\u3002 \u5728Go\u8bed\u8a00\u4e2d\uff0c\u5bf9\u63a5\u53e3\u7684\u6269\u5c55\u662f\u901a\u8fc7\u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u7684\u5d4c\u5165\u6765\u5b9e\u73b0\u7684\uff0c\u79f0\u4e3a\u63a5\u53e3\u7ec4\u5408 \u3002Go\u8bed\u8a00\u63d0\u5021\u4f7f\u7528\u5c0f\u63a5\u53e3\u52a0\u4e0a\u63a5\u53e3\u7ec4\u5408\u7684\u65b9\u5f0f\uff0c\u6765\u6269\u5c55\u7a0b\u5e8f\u7684\u884c\u4e3a\u4ee5\u53ca\u589e\u52a0\u7a0b\u5e8f\u7684\u7075\u6d3b\u6027\u3002 io.Reader \u6269\u5c55\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u578b\u53ca\u5176\u529f\u80fd \u5728io\u5305\u4e2d\uff0c io.Reader \u7684\u6269\u5c55\u63a5\u53e3\uff1a io.ReaderWriter \uff1a\u65e2\u662f io.Reader \u7684\u6269\u5c55\u63a5\u53e3\uff0c\u4e5f\u662f io.Writer \u7684\u6269\u5c55\u63a5\u53e3\u3002\u8be5\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e00\u7ec4\u884c\u4e3a\uff0c\u5305\u542b\u4e14\u4ec5\u5305\u542b\u4e86\u57fa\u672c\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u65b9\u6cd5Read\u548c\u5b57\u8282\u5e8f\u5217\u5199\u5165\u65b9\u6cd5Write\u3002 io.ReaderCloser \uff1a\u6b64\u63a5\u53e3\u5904\u7406\u5305\u542b\u57fa\u672c\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u65b9\u6cd5\u4e4b\u5916\uff0c\u8fd8\u6709\u57fa\u672c\u7684\u5173\u95ed\u65b9\u6cd5Close\uff0c\u4e00\u822c\u7528\u4e8e\u5173\u95ed\u6570\u636e\u8bfb\u5199\u7684\u901a\u8def\u3002 io.ReadWriteCloser \uff1a\u4e09\u4e2a\u63a5\u53e3\u7684\u7ec4\u5408\u3002 io.ReaderSeeker \uff1a\u6b64\u63a5\u53e3\u7684\u7279\u70b9\u662f\u62e5\u6709\u4e00\u4e2a\u7528\u4e8e\u5bfb\u627e\u8bfb\u5199\u4f4d\u7f6e\u7684\u57fa\u672c\u65b9\u6cd5Seek\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u6839\u636e\u89c4\u5b9a\u7684\u504f\u79fb\u91cf\u57fa\u4e8e\u6570\u636e\u7684\u8d77\u59cb\u4f4d\u7f6e\u3001\u672b\u5c3e\u4e3a\u6b62\u6216\u8005\u5f53\u524d\u8bfb\u5199\u4e3a\u6b62\u5bfb\u627e\u5230\u65b0\u7684\u8bfb\u5199\u4f4d\u7f6e\u3002 \u65b0\u7684\u8bfb\u5199\u4e3a\u6b62\u7528\u4e8e\u8868\u660e\u4e0b\u4e00\u6b21\u8bfb\u6216\u5199\u7684\u8d77\u59cb\u7d22\u5f15 \u3002Seek\u662f io.Seeker \u63a5\u53e3\u552f\u4e00\u62e5\u6709\u7684\u65b9\u6cd5\u3002 io.ReadWriteSeeker \uff1a\u662f\u4e09\u4e2a\u63a5\u53e3\u7684\u7ec4\u5408\u3002 \u5728io\u5305\u4e2d\u7684 io.Reader \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff1a *io.LimitedReader \uff1a\u6b64\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u4f1a\u5305\u88c5 io.Reader \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u63d0\u4f9b\u4e00\u4e2a\u5916\u7684\u53d7\u9650\u8bfb\u53d6\u7684\u529f\u80fd\u3002 \u53d7\u9650\u8bfb\u53d6\u662f\u6307\uff0c\u6b64\u7c7b\u578b\u7684\u8bfb\u53d6\u65b9\u6cd5Read\u8fd4\u56de\u7684\u603b\u6570\u636e\u91cf\u4f1a\u6536\u5230\u9650\u5236\uff0c\u65e0\u8bba\u8be5\u65b9\u6cd5\u88ab\u8c03\u7528\u591a\u5c11\u6b21\uff0c\u8fd9\u4e2a\u9650\u5236\u7531\u8be5\u7c7b\u578b\u7684\u5b57\u6bb5N\u81f4\u547d\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\u3002 *io.SelectionReader \uff1a\u6b64\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u53ef\u4ee5\u5305\u88c5 io.ReaderAt \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u4e14\u4f1a\u9650\u5236\u5b83\u7684Read\u65b9\u6cd5\uff0c\u53ea\u80fd\u602a\u8bfb\u53d6\u539f\u59cb\u6570\u636e\u4e2d\u7684\u67d0\u4e00\u4e2a\u90e8\u5206\uff08\u6216\u8005\u67d0\u4e00\u6bb5\uff09\u3002 \u8fd9\u4e2a\u6570\u636e\u6bb5\u7684\u8d77\u59cb\u4f4d\u7f6e\u548c\u672b\u5c3e\u4f4d\u7f6e\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6307\u660e\uff0c\u5e76\u4e14\u4e4b\u540e\u65e0\u6cd5\u4fee\u6539\u3002\u8be5\u7c7b\u578b\u503c\u7684\u884c\u4e3a\u4e0e\u5207\u7247\u7c7b\u4f3c\uff0c\u53ea\u4f1a\u5bf9\u5916\u66b4\u9732\u5176\u7a97\u53e3\u4e2d\u7684\u90a3\u4e9b\u6570\u636e\u3002 *io.teeReader \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u662f io.TeeReader \u51fd\u6570\u7ed3\u679c\u503c\u7684\u5b9e\u9645\u7c7b\u578b\uff0c\u8fd9\u4e2a\u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570r\u548cw\uff0c\u7c7b\u578b\u5206\u522b\u662f io.Reader \u548c io.Writer \u3002 \u5176\u7ed3\u679c\u503c\u7684Read\u65b9\u6cd5\u4f1a\u628ar\u4e2d\u7684\u6570\u636e\u7ecf\u8fc7\u4f5c\u4e3a\u65b9\u6cd5\u53c2\u6570\u7684\u5b57\u8282\u5207\u7247p\u5199\u5165\u5230w\u3002 io.multiReader \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u7c7b\u4f3c\u7684\uff0cio\u5305\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3aMutliReader\u7684\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u63a5\u53d7\u82e5\u5e72\u4e2aio.Reader\u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5b9e\u9645\u7c7b\u578b\u4e3a io.mutliReader \u7684\u7ed3\u679c\u503c\u3002 \u8fd9\u4e2a\u7ed3\u679c\u503c\u7684Reader\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4ed6\u4f1a\u987a\u5e8f\u5730\u4ece\u524d\u9762\u90a3\u4e9b io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u79f0\u4e4b\u4e3a\u591a\u5bf9\u8c61\u8bfb\u53d6\u5668\u3002 io.pipe \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u4f46\u5b9e\u73b0 io.Reader \u63a5\u53e3\uff0c\u8fd8\u5b9e\u73b0 io.Writer \u63a5\u53e3\u3002 io.PipeReader \u548c io.PipeWriter \u7c7b\u578b\u62e5\u6709\u7684\u6240\u4ee5\u6307\u9488\u65b9\u6cd5\u90fd\u4ee5\u5b83\u4e3a\u57fa\u7840\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u53ea\u662f\u4ee3\u7406 io.pipe \u7c7b\u578b\u503c\u6240\u62e5\u6709\u7684\u67d0\u4e00\u4e2a\u65b9\u6cd5\u800c\u5df2\u3002\u56e0\u4e3a io.Pipe \u51fd\u6570\u8fd4\u56de\u8fd9\u4e24\u4e2a\u4e50\u884c\u7684\u6307\u9488\u503c\u5e76\u5206\u522b\u628a\u5b83\u4eec\u4f5c\u4e3a\u5176\u751f\u6210\u7684\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u4e24\u7aef\uff0c\u6240\u4ee5\uff0c *io.pipe \u7c7b\u578b\u5c31\u662fio\u5305\u63d0\u4f9b\u7684\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u6838\u5fc3\u5b9e\u73b0\u3002 io.Pipereader \uff1a\u88ab\u89c6\u4e3a io.pipe \u7c7b\u578b\u7684\u4ee3\u7406\u7c7b\u578b\uff0c\u5b83\u4ee3\u7406\u4e86\u540e\u8005\u7684\u4e00\u90e8\u5206\u529f\u80fd\uff0c\u5e76\u57fa\u4e8e\u540e\u8005\u5b9e\u73b0\u4e86 io.ReadCloser \u63a5\u53e3\uff0c\u540c\u65f6\u8fd8\u5b9a\u4e49\u4e86\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u8bfb\u53d6\u7aef\u3002 io\u5305\u662fGo\u8bed\u8a00\u6807\u51c6\u5e93\u4e2d\u6240\u6709I/O\u76f8\u5173API\u7684\u6839\u57fa\uff0c\u5fc5\u987b\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u90fd\u4e86\u89e3 \u3002 io\u5305\u4e2d\u7684\u63a5\u53e3\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb \u7b80\u5355\u63a5\u53e3\uff1a\u6ca1\u6709\u5d4c\u5165\u5176\u4ed6\u63a5\u53e3\u5e76\u4e14\u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5\u7684\u63a5\u53e3\u3002 \u5728io\u5305\u4e2d\uff0c\u8fd9\u6837\u7684\u63a5\u53e3\u4e00\u5171\u670911\u4e2a\u3002\u5206\u4e3a\u56db\u5927\u7c7b\uff1a\u8bfb\u53d6\uff085\u4e2a\uff09\u3001\u5199\u5165\uff084\u4e2a\uff09\u3001\u5173\u95ed\uff081\u4e2a\uff09\u3001\u8bfb\u5199\u4f4d\u7f6e\u8bbe\u5b9a\uff081\u4e2a\uff09\u3002\u76ee\u524d\u4e09\u79cd\u64cd\u4f5c\u5c5e\u4e8e\u57fa\u672c\u7684I/O\u64cd\u4f5c\u3002 \u6838\u5fc3\u63a5\u53e3\uff1a\u6709\u8fd9\u4f17\u591a\u7684\u6269\u5c55\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u578b\u3002 \u5728io\u5305\u4e2d\uff0c\u6838\u5fc3\u63a5\u53e3\u53ea\u67093\u4e2a\uff1a io.Reader \uff085\u4e2a\u6269\u5c55\u63a5\u53e3\u30016\u4e2a\u5b9e\u73b0\u7c7b\u578b\uff09\u3001 io.Writer \u3001 io.Closer \u8bfb\u53d6 io.ByteReader \u548c io.RuneReader \u5206\u522b\u5b9a\u4e49\u4e86\u8bfb\u53d6\u65b9\u6cd5\uff1aReadByte\u548cReadRune\u3002\u4e0e io.Reader \u63a5\u53e3\u4e2d\u7684Reader\u65b9\u6cd5\u4e0d\u540c\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ea\u80fd\u8bfb\u53d6\u4e0b\u4e00\u4e2a\u5355\u4e00\u5b57\u8282\u548cUnicode\u5b57\u7b26\u3002 strings.Reader \u548c strings.Buffer \u90fd\u662f io.ByteReader \u548c io.RuneReader \u7684\u5b9e\u73b0\u7c7b\u578b\u3002 \u8fd9\u4e24\u4e2a\u7c7b\u578b\u8fd8\u5b9e\u73b0\u4e86 io.ByteScanner \u63a5\u53e3\u548c io.RuneScanner \u63a5\u53e3\u3002 io.ByteScanner \u63a5\u53e3\u5185\u5d4c\u4e86\u7b80\u5355\u63a5\u53e3 io.ByteReader \uff0c\u5e76\u5b9a\u4e49\u4e86\u989d\u5916\u7684UnreadByte\u65b9\u6cd5\uff0c\u5b83\u62bd\u8c61\u51fa\u4e86\u53ef\u4ee5\u8bfb\u53d6\u548c\u8bfb\u56de\u9000\u5355\u4e2a\u5b57\u8282\u7684\u529f\u80fd\u96c6\u3002 io.RuneScanner \u63a5\u53e3\u5185\u5d4c\u4e86\u7b80\u5355\u63a5\u53e3 io.RuneReader \uff0c\u5e76\u5b9a\u4e49\u4e86\u989d\u5916\u7684UnreadRune\u65b9\u6cd5\uff0c\u5b83\u62bd\u8c61\u51fa\u4e86\u53ef\u4ee5\u8bfb\u53d6\u548c\u8bfb\u56de\u9000\u5355\u4e2aUnicode\u5b57\u7b26\u7684\u529f\u80fd\u96c6\u3002 io.ReaderAt \u63a5\u53e3\uff0c\u5176\u4e2d\u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5ReadAt\uff0c\u4e0e\u524d\u9762\u8bf4\u8fc7\u7684\u8bfb\u53d6\u65b9\u6cd5\u90fd\u4e0d\u540c\uff0cReadAt\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684\u53ea\u8bfb\u65b9\u6cd5\u3002\u53ea\u53bb\u8bfb\u53d6\u5176\u6240\u5c5e\u503c\u603b\u5305\u542b\u7684\u5b57\u8282\uff0c\u800c\u4e0d\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u4efb\u4f55\u7684\u6539\u52a8\uff0c\u6bd4\u5982\u5b83\u7edd\u5bf9\u4e0d\u80fd\u53bb\u4fee\u6539\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\uff0c \u8fd9\u662fio.ReaderAt\u63a5\u53e3\u4e0e\u5176\u4ed6\u5b9e\u73b0\u7c7b\u578b\u4e4b\u95f4\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u7ea6\u5b9a \u3002\u5982\u679c\u4ec5\u4ec5\u5e76\u53d1\u5730\u8c03\u7528\u67d0\u4e00\u4e2a\u503c\u7684ReadAt\u65b9\u6cd5\uff0c\u90a3\u4e48\u5b89\u5168\u6027\u5e94\u8be5\u662f\u53ef\u4ee5\u5f97\u5230\u4fdd\u969c\u7684\u3002 io.WriteTo \u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2aWriteTo\u65b9\u6cd5\uff0c\u8fd9\u662f\u4e00\u4e2a\u8bfb\u53d6\u65b9\u6cd5\uff0c\u5b83\u4f1a\u63a5\u53d7\u4e00\u4e2a io.Writer \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u4f1a\u628a\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u6570\u636e\u8bfb\u51fa\u5e76\u5199\u5165\u5230\u8fd9\u4e2a\u53c2\u6570\u4e2d\u3002 \u5728io\u5305\u4e2d\uff0c\u4e0e\u5199\u5165\u64cd\u4f5c\u6709\u5173\u7684\u63a5\u53e3\u90fd\u4e0e\u8bfb\u53d6\u64cd\u4f5c\u7684\u76f8\u5173\u63a5\u53e3\u6709\u7740\u4e00\u5b9a\u7684\u5bf9\u5e94\u5173\u7cfb \u3002 \u5199\u5165 io.ReaderFrom \u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86ReadFrom\u65b9\u6cd5\uff0c\u8fd9\u662f\u4e00\u4e2a\u5199\u5165\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u63a5\u53d7\u4e00\u4e2a io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u4f1a\u4ece\u8be5\u7c7b\u578b\u503c\u4e2d\u8bfb\u51fa\u6570\u636e\uff0c\u5e76\u5199\u5165\u5230\u5176\u6240\u5c5e\u503c\u4e2d\u3002 io.Writer \u6838\u5fc3\u63a5\u53e3\uff0c\u57fa\u4e8e\u5b83\u6269\u5c55\u63a5\u53e3\u9664\u4e86 io.ReadWriter \u3001 io.ReadWriteCloser \u3001 io.ReadWriteSeeker \u3001 io.WriteCloser \u548c io.WriteSeeker \u3002 \u8bfb\u5199\u4f4d\u7f6e io.Seeker \u63a5\u53e3\u4f5c\u4e3a\u8bfb\u5199\u4f4d\u7f6e\u8bbe\u5b9a\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5Seek\u3002 \u6570\u636e\u7c7b\u578b *os.File \uff0c\u8fd9\u4e2a\u7c7b\u578b\u4e0d\u4f46\u662f io.WriterAt \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u8fd8\u5b9e\u73b0\u4e86 io.ByteWritCloser \u548c io.ReadWriteSeeker \uff0c\u8be5\u7c7b\u578b\u652f\u6301\u7684I/O\u64cd\u4f5c\u975e\u5e38\u4e30\u5bcc\u3002 \u603b\u7ed3 io\u5305\u4e2d\u7684\u63a5\u53e3\u4f53\u7cfb","title":"io"},{"location":"Language/Basic/23-io/#io","text":"","title":"io"},{"location":"Language/Basic/23-io/#io_1","text":"\u63d0\u9ad8\u4e0d\u540c\u7a0b\u5e8f\u5b9e\u4f53\u4e4b\u95f4\u7684\u4e92\u64cd\u4f5c\u6027\u3002 \u5728io\u5305\u4e2d\uff0c\u6709\u8fd9\u6837\u51e0\u4e2a\u62f7\u8d1d\u6570\u636e\u7684\u51fd\u6570\uff1a io.Copy \uff0c io.CopyBuffer \uff0c io.CopyN \u3002\u8fd9\u51e0\u4e2a\u51fd\u6570\u5728\u529f\u80fd\u4e0a\u7565\u6709\u5dee\u522b\uff0c\u4f46\u5b83\u4eec\u9996\u5148\u4f1a\u63a5\u6536\u4e24\u4e2a\u53c2\u6570\uff1a \u7528\u4e8e\u4ee3\u8868\u6570\u636e\u76ee\u7684\u5730\uff0c io.Writer \u7c7b\u578b\u7684\u53c2\u6570dst \u7528\u4e8e\u4ee3\u8868\u6570\u636e\u6765\u6e90\u7684\uff0c io.Reader \u7c7b\u578b\u7684\u53c2\u6570src \u8fd9\u4e9b\u51fd\u6570\u7684\u529f\u80fd\u5927\u81f4\u4e0a\u90fd\u662f\u628a\u6570\u636e\u4ecesrc\u62f7\u8d1d\u5230dst\u3002\u4e0d\u8bba\u7ed9\u4e88\u7684\u53c2\u6570\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u53ea\u8981\u5b9e\u73b0\u4e86\u8fd9\u4e24\u4e2a\u63a5\u53e3\uff0c\u5c31\u51e0\u4e4e\u53ef\u4ee5\u6b63\u5e38\u6267\u884c\u3002 \u51fd\u6570\u4e2d\u8fd8\u4f1a\u5bf9\u5fc5\u8981\u7684\u53c2\u6570\u503c\u8fdb\u884c\u6709\u6548\u6027\u68c0\u67e5\uff0c\u5982\u679c\u68c0\u67e5\u4e0d\u901a\u8fc7\uff0c\u5b83\u7684\u6267\u884c\u4e5f\u662f\u4e0d\u80fd\u591f\u6210\u529f\u7ed3\u675f\u7684 \u3002 // \u521b\u5efa\u5b57\u7b26\u4e32\u8bfb\u53d6\u5668 src := strings.NewReader( CopyN copies n bytes (or until an error) from src to dst. + It returns the number of bytes copied and + the earliest error encountered while copying. ) // \u521b\u5efa\u5b57\u7b26\u4e32\u6784\u9020\u5668 dst := new(strings.Builder) written, err := io.CopyN(dst, src, 58) if err != nil { fmt.Printf( error: %v\\n , err) } else { fmt.Printf( Written(%d): %q\\n , written, dst.String()) } \u53d8\u91cfsrc\u548cdst\u7684\u7c7b\u578b\u5206\u522b\u662f strings.Reader \u548c strings.Builder \uff0c\u5f53\u5b83\u4eec\u88ab\u4f20\u5165\u5230 io.CopyN \u51fd\u6570\u65f6\uff0c\u5c31\u5df2\u7ecf\u88ab\u5305\u88c5\u6210\u4e86 io.Reader \u548c io.Writer \u7c7b\u578b\u7684\u503c\u3002 \u4e3a\u4e86\u4f18\u5316\u7684\u76ee\u7684\uff0c io.CopyN \u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u4f1a\u5bf9\u53c2\u6570\u503c\u8fdb\u884c\u5728\u5305\u88c5\uff0c\u4e5f\u4f1a\u68c0\u6d4b\u8fd9\u4e9b\u53c2\u6570\u503c\u662f\u5426\u8fd8\u5b9e\u73b0\u4e86\u522b\u7684\u63a5\u53e3\uff0c\u751a\u81f3\u8fd8\u4f1a\u53bb\u63a2\u6c42\u67d0\u4e2a\u53c2\u6570\u503c\u88ab\u626e\u88c5\u540e\u7684\u5b9e\u9645\u7c7b\u578b\uff0c\u662f\u5426\u4e3a\u67d0\u4e2a\u7279\u6b8a\u7684\u7c7b\u578b\u3002 \u4ece\u603b\u4f53\u4e0a\u6765\u770b\uff0c\u8fd9\u4e9b\u4ee3\u7801\u90fd\u662f\u9762\u5411\u53c2\u6570\u58f0\u660e\u4e2d\u7684\u63a5\u53e3\u6765\u505a\u7684\uff0c\u6781\u5927\u7684\u6269\u5c55\u4e86\u5b83\u7684\u9002\u7528\u8303\u56f4\u548c\u5e94\u7528\u573a\u666f \u3002 \u6362\u4e2a\u89d2\u5ea6\uff0c\u6b63\u56e0\u4e3a strings.Reader \u548c strings.Builder \u7c7b\u578b\u90fd\u5b9e\u73b0\u4e86\u4e0d\u5c11\u63a5\u53e3\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u503c\u624d\u80fd\u88ab\u4f7f\u7528\u5728\u66f4\u5e7f\u9614\u7684\u573a\u666f\u4e2d \u3002Go\u8bed\u8a00\u7684\u5404\u79cd\u5e93\u4e2d\uff0c\u80fd\u591f\u64cd\u4f5c\u5b83\u4eec\u7684\u51fd\u6570\u548c\u6570\u636e\u7c7b\u578b\u660e\u663e\u591a\u4e86\u5f88\u591a\u3002\u8fd9\u5c31\u662fstrings\u548cbytes\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u5b9e\u73b0\u4e86\u82e5\u5e72\u4e2a\u63a5\u53e3\u4e4b\u540e\u7684\u6700\u5927\u597d\u5904\u3002 \u8fd9\u662f\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\u7684\u6700\u5927\u597d\u5904 \u3002 io.Reader \u548c ioWriter \u8fd9\u4e24\u4e2a\u6838\u5fc3\u63a5\u53e3\u662f\u5f88\u591a\u63a5\u53e3\u7684\u6269\u5c55\u5bf9\u8c61\u548c\u8bbe\u8ba1\u6e90\u6cc9\uff0c\u5f88\u591a\u6570\u636e\u7c7b\u578b\u5b9e\u73b0\u4e86 io.Reader \u63a5\u53e3\uff0c\u662f\u56e0\u4e3a\u5b83\u4eec\u63d0\u4f9b\u4e86\u4ece\u67d0\u5904\u8bfb\u53d6\u6570\u636e\u7684\u529f\u80fd\u3002 \u4e0d\u5c11\u7c7b\u578b\u7684\u8bbe\u8ba1\u521d\u8877\u662f\uff1a\u5b9e\u73b0\u8fd9\u4e24\u4e2a\u6838\u5fc3\u63a5\u53e3\u7684\u67d0\u4e2a\uff0c\u6216\u67d0\u4e9b\u6269\u5c55\u63a5\u53e3\uff0c\u4ee5\u63d0\u4f9b\u6bd4\u5355\u7eaf\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u6216\u5199\u5165\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\u3002 \u5728Go\u8bed\u8a00\u4e2d\uff0c\u5bf9\u63a5\u53e3\u7684\u6269\u5c55\u662f\u901a\u8fc7\u63a5\u53e3\u7c7b\u578b\u4e4b\u95f4\u7684\u5d4c\u5165\u6765\u5b9e\u73b0\u7684\uff0c\u79f0\u4e3a\u63a5\u53e3\u7ec4\u5408 \u3002Go\u8bed\u8a00\u63d0\u5021\u4f7f\u7528\u5c0f\u63a5\u53e3\u52a0\u4e0a\u63a5\u53e3\u7ec4\u5408\u7684\u65b9\u5f0f\uff0c\u6765\u6269\u5c55\u7a0b\u5e8f\u7684\u884c\u4e3a\u4ee5\u53ca\u589e\u52a0\u7a0b\u5e8f\u7684\u7075\u6d3b\u6027\u3002","title":"io\u5305\u4e2d\u63a5\u53e3\u7684\u597d\u5904\u4e0e\u4f18\u52bf"},{"location":"Language/Basic/23-io/#ioreader","text":"\u5728io\u5305\u4e2d\uff0c io.Reader \u7684\u6269\u5c55\u63a5\u53e3\uff1a io.ReaderWriter \uff1a\u65e2\u662f io.Reader \u7684\u6269\u5c55\u63a5\u53e3\uff0c\u4e5f\u662f io.Writer \u7684\u6269\u5c55\u63a5\u53e3\u3002\u8be5\u63a5\u53e3\u5b9a\u4e49\u4e86\u4e00\u7ec4\u884c\u4e3a\uff0c\u5305\u542b\u4e14\u4ec5\u5305\u542b\u4e86\u57fa\u672c\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u65b9\u6cd5Read\u548c\u5b57\u8282\u5e8f\u5217\u5199\u5165\u65b9\u6cd5Write\u3002 io.ReaderCloser \uff1a\u6b64\u63a5\u53e3\u5904\u7406\u5305\u542b\u57fa\u672c\u7684\u5b57\u8282\u5e8f\u5217\u8bfb\u53d6\u65b9\u6cd5\u4e4b\u5916\uff0c\u8fd8\u6709\u57fa\u672c\u7684\u5173\u95ed\u65b9\u6cd5Close\uff0c\u4e00\u822c\u7528\u4e8e\u5173\u95ed\u6570\u636e\u8bfb\u5199\u7684\u901a\u8def\u3002 io.ReadWriteCloser \uff1a\u4e09\u4e2a\u63a5\u53e3\u7684\u7ec4\u5408\u3002 io.ReaderSeeker \uff1a\u6b64\u63a5\u53e3\u7684\u7279\u70b9\u662f\u62e5\u6709\u4e00\u4e2a\u7528\u4e8e\u5bfb\u627e\u8bfb\u5199\u4f4d\u7f6e\u7684\u57fa\u672c\u65b9\u6cd5Seek\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u6839\u636e\u89c4\u5b9a\u7684\u504f\u79fb\u91cf\u57fa\u4e8e\u6570\u636e\u7684\u8d77\u59cb\u4f4d\u7f6e\u3001\u672b\u5c3e\u4e3a\u6b62\u6216\u8005\u5f53\u524d\u8bfb\u5199\u4e3a\u6b62\u5bfb\u627e\u5230\u65b0\u7684\u8bfb\u5199\u4f4d\u7f6e\u3002 \u65b0\u7684\u8bfb\u5199\u4e3a\u6b62\u7528\u4e8e\u8868\u660e\u4e0b\u4e00\u6b21\u8bfb\u6216\u5199\u7684\u8d77\u59cb\u7d22\u5f15 \u3002Seek\u662f io.Seeker \u63a5\u53e3\u552f\u4e00\u62e5\u6709\u7684\u65b9\u6cd5\u3002 io.ReadWriteSeeker \uff1a\u662f\u4e09\u4e2a\u63a5\u53e3\u7684\u7ec4\u5408\u3002 \u5728io\u5305\u4e2d\u7684 io.Reader \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff1a *io.LimitedReader \uff1a\u6b64\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u4f1a\u5305\u88c5 io.Reader \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u63d0\u4f9b\u4e00\u4e2a\u5916\u7684\u53d7\u9650\u8bfb\u53d6\u7684\u529f\u80fd\u3002 \u53d7\u9650\u8bfb\u53d6\u662f\u6307\uff0c\u6b64\u7c7b\u578b\u7684\u8bfb\u53d6\u65b9\u6cd5Read\u8fd4\u56de\u7684\u603b\u6570\u636e\u91cf\u4f1a\u6536\u5230\u9650\u5236\uff0c\u65e0\u8bba\u8be5\u65b9\u6cd5\u88ab\u8c03\u7528\u591a\u5c11\u6b21\uff0c\u8fd9\u4e2a\u9650\u5236\u7531\u8be5\u7c7b\u578b\u7684\u5b57\u6bb5N\u81f4\u547d\uff0c\u5355\u4f4d\u4e3a\u5b57\u8282\u3002 *io.SelectionReader \uff1a\u6b64\u7c7b\u578b\u7684\u57fa\u672c\u7c7b\u578b\u53ef\u4ee5\u5305\u88c5 io.ReaderAt \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u4e14\u4f1a\u9650\u5236\u5b83\u7684Read\u65b9\u6cd5\uff0c\u53ea\u80fd\u602a\u8bfb\u53d6\u539f\u59cb\u6570\u636e\u4e2d\u7684\u67d0\u4e00\u4e2a\u90e8\u5206\uff08\u6216\u8005\u67d0\u4e00\u6bb5\uff09\u3002 \u8fd9\u4e2a\u6570\u636e\u6bb5\u7684\u8d77\u59cb\u4f4d\u7f6e\u548c\u672b\u5c3e\u4f4d\u7f6e\uff0c\u9700\u8981\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6307\u660e\uff0c\u5e76\u4e14\u4e4b\u540e\u65e0\u6cd5\u4fee\u6539\u3002\u8be5\u7c7b\u578b\u503c\u7684\u884c\u4e3a\u4e0e\u5207\u7247\u7c7b\u4f3c\uff0c\u53ea\u4f1a\u5bf9\u5916\u66b4\u9732\u5176\u7a97\u53e3\u4e2d\u7684\u90a3\u4e9b\u6570\u636e\u3002 *io.teeReader \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u662f io.TeeReader \u51fd\u6570\u7ed3\u679c\u503c\u7684\u5b9e\u9645\u7c7b\u578b\uff0c\u8fd9\u4e2a\u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570r\u548cw\uff0c\u7c7b\u578b\u5206\u522b\u662f io.Reader \u548c io.Writer \u3002 \u5176\u7ed3\u679c\u503c\u7684Read\u65b9\u6cd5\u4f1a\u628ar\u4e2d\u7684\u6570\u636e\u7ecf\u8fc7\u4f5c\u4e3a\u65b9\u6cd5\u53c2\u6570\u7684\u5b57\u8282\u5207\u7247p\u5199\u5165\u5230w\u3002 io.multiReader \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u7c7b\u4f3c\u7684\uff0cio\u5305\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3aMutliReader\u7684\u51fd\u6570\uff0c\u5b83\u53ef\u4ee5\u63a5\u53d7\u82e5\u5e72\u4e2aio.Reader\u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5b9e\u9645\u7c7b\u578b\u4e3a io.mutliReader \u7684\u7ed3\u679c\u503c\u3002 \u8fd9\u4e2a\u7ed3\u679c\u503c\u7684Reader\u65b9\u6cd5\u88ab\u8c03\u7528\u65f6\uff0c\u4ed6\u4f1a\u987a\u5e8f\u5730\u4ece\u524d\u9762\u90a3\u4e9b io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\u4e2d\u8bfb\u53d6\u6570\u636e\u3002\u79f0\u4e4b\u4e3a\u591a\u5bf9\u8c61\u8bfb\u53d6\u5668\u3002 io.pipe \uff1a\u6b64\u7c7b\u578b\u662f\u5305\u7ea7\u79c1\u6709\u7684\u6570\u636e\u7c7b\u578b\uff0c\u4e0d\u4f46\u5b9e\u73b0 io.Reader \u63a5\u53e3\uff0c\u8fd8\u5b9e\u73b0 io.Writer \u63a5\u53e3\u3002 io.PipeReader \u548c io.PipeWriter \u7c7b\u578b\u62e5\u6709\u7684\u6240\u4ee5\u6307\u9488\u65b9\u6cd5\u90fd\u4ee5\u5b83\u4e3a\u57fa\u7840\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u53ea\u662f\u4ee3\u7406 io.pipe \u7c7b\u578b\u503c\u6240\u62e5\u6709\u7684\u67d0\u4e00\u4e2a\u65b9\u6cd5\u800c\u5df2\u3002\u56e0\u4e3a io.Pipe \u51fd\u6570\u8fd4\u56de\u8fd9\u4e24\u4e2a\u4e50\u884c\u7684\u6307\u9488\u503c\u5e76\u5206\u522b\u628a\u5b83\u4eec\u4f5c\u4e3a\u5176\u751f\u6210\u7684\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u4e24\u7aef\uff0c\u6240\u4ee5\uff0c *io.pipe \u7c7b\u578b\u5c31\u662fio\u5305\u63d0\u4f9b\u7684\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u6838\u5fc3\u5b9e\u73b0\u3002 io.Pipereader \uff1a\u88ab\u89c6\u4e3a io.pipe \u7c7b\u578b\u7684\u4ee3\u7406\u7c7b\u578b\uff0c\u5b83\u4ee3\u7406\u4e86\u540e\u8005\u7684\u4e00\u90e8\u5206\u529f\u80fd\uff0c\u5e76\u57fa\u4e8e\u540e\u8005\u5b9e\u73b0\u4e86 io.ReadCloser \u63a5\u53e3\uff0c\u540c\u65f6\u8fd8\u5b9a\u4e49\u4e86\u540c\u6b65\u5185\u5b58\u7ba1\u9053\u7684\u8bfb\u53d6\u7aef\u3002 io\u5305\u662fGo\u8bed\u8a00\u6807\u51c6\u5e93\u4e2d\u6240\u6709I/O\u76f8\u5173API\u7684\u6839\u57fa\uff0c\u5fc5\u987b\u5bf9\u5176\u4e2d\u7684\u6bcf\u4e00\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u90fd\u4e86\u89e3 \u3002","title":"io.Reader\u6269\u5c55\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u578b\u53ca\u5176\u529f\u80fd"},{"location":"Language/Basic/23-io/#io_2","text":"\u7b80\u5355\u63a5\u53e3\uff1a\u6ca1\u6709\u5d4c\u5165\u5176\u4ed6\u63a5\u53e3\u5e76\u4e14\u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5\u7684\u63a5\u53e3\u3002 \u5728io\u5305\u4e2d\uff0c\u8fd9\u6837\u7684\u63a5\u53e3\u4e00\u5171\u670911\u4e2a\u3002\u5206\u4e3a\u56db\u5927\u7c7b\uff1a\u8bfb\u53d6\uff085\u4e2a\uff09\u3001\u5199\u5165\uff084\u4e2a\uff09\u3001\u5173\u95ed\uff081\u4e2a\uff09\u3001\u8bfb\u5199\u4f4d\u7f6e\u8bbe\u5b9a\uff081\u4e2a\uff09\u3002\u76ee\u524d\u4e09\u79cd\u64cd\u4f5c\u5c5e\u4e8e\u57fa\u672c\u7684I/O\u64cd\u4f5c\u3002 \u6838\u5fc3\u63a5\u53e3\uff1a\u6709\u8fd9\u4f17\u591a\u7684\u6269\u5c55\u63a5\u53e3\u548c\u5b9e\u73b0\u7c7b\u578b\u3002 \u5728io\u5305\u4e2d\uff0c\u6838\u5fc3\u63a5\u53e3\u53ea\u67093\u4e2a\uff1a io.Reader \uff085\u4e2a\u6269\u5c55\u63a5\u53e3\u30016\u4e2a\u5b9e\u73b0\u7c7b\u578b\uff09\u3001 io.Writer \u3001 io.Closer","title":"io\u5305\u4e2d\u7684\u63a5\u53e3\u4ee5\u53ca\u5b83\u4eec\u4e4b\u95f4\u7684\u5173\u7cfb"},{"location":"Language/Basic/23-io/#_1","text":"io.ByteReader \u548c io.RuneReader \u5206\u522b\u5b9a\u4e49\u4e86\u8bfb\u53d6\u65b9\u6cd5\uff1aReadByte\u548cReadRune\u3002\u4e0e io.Reader \u63a5\u53e3\u4e2d\u7684Reader\u65b9\u6cd5\u4e0d\u540c\uff0c\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ea\u80fd\u8bfb\u53d6\u4e0b\u4e00\u4e2a\u5355\u4e00\u5b57\u8282\u548cUnicode\u5b57\u7b26\u3002 strings.Reader \u548c strings.Buffer \u90fd\u662f io.ByteReader \u548c io.RuneReader \u7684\u5b9e\u73b0\u7c7b\u578b\u3002 \u8fd9\u4e24\u4e2a\u7c7b\u578b\u8fd8\u5b9e\u73b0\u4e86 io.ByteScanner \u63a5\u53e3\u548c io.RuneScanner \u63a5\u53e3\u3002 io.ByteScanner \u63a5\u53e3\u5185\u5d4c\u4e86\u7b80\u5355\u63a5\u53e3 io.ByteReader \uff0c\u5e76\u5b9a\u4e49\u4e86\u989d\u5916\u7684UnreadByte\u65b9\u6cd5\uff0c\u5b83\u62bd\u8c61\u51fa\u4e86\u53ef\u4ee5\u8bfb\u53d6\u548c\u8bfb\u56de\u9000\u5355\u4e2a\u5b57\u8282\u7684\u529f\u80fd\u96c6\u3002 io.RuneScanner \u63a5\u53e3\u5185\u5d4c\u4e86\u7b80\u5355\u63a5\u53e3 io.RuneReader \uff0c\u5e76\u5b9a\u4e49\u4e86\u989d\u5916\u7684UnreadRune\u65b9\u6cd5\uff0c\u5b83\u62bd\u8c61\u51fa\u4e86\u53ef\u4ee5\u8bfb\u53d6\u548c\u8bfb\u56de\u9000\u5355\u4e2aUnicode\u5b57\u7b26\u7684\u529f\u80fd\u96c6\u3002 io.ReaderAt \u63a5\u53e3\uff0c\u5176\u4e2d\u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5ReadAt\uff0c\u4e0e\u524d\u9762\u8bf4\u8fc7\u7684\u8bfb\u53d6\u65b9\u6cd5\u90fd\u4e0d\u540c\uff0cReadAt\u662f\u4e00\u4e2a\u7eaf\u7cb9\u7684\u53ea\u8bfb\u65b9\u6cd5\u3002\u53ea\u53bb\u8bfb\u53d6\u5176\u6240\u5c5e\u503c\u603b\u5305\u542b\u7684\u5b57\u8282\uff0c\u800c\u4e0d\u5bf9\u8fd9\u4e2a\u503c\u8fdb\u884c\u4efb\u4f55\u7684\u6539\u52a8\uff0c\u6bd4\u5982\u5b83\u7edd\u5bf9\u4e0d\u80fd\u53bb\u4fee\u6539\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\uff0c \u8fd9\u662fio.ReaderAt\u63a5\u53e3\u4e0e\u5176\u4ed6\u5b9e\u73b0\u7c7b\u578b\u4e4b\u95f4\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u7ea6\u5b9a \u3002\u5982\u679c\u4ec5\u4ec5\u5e76\u53d1\u5730\u8c03\u7528\u67d0\u4e00\u4e2a\u503c\u7684ReadAt\u65b9\u6cd5\uff0c\u90a3\u4e48\u5b89\u5168\u6027\u5e94\u8be5\u662f\u53ef\u4ee5\u5f97\u5230\u4fdd\u969c\u7684\u3002 io.WriteTo \u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2aWriteTo\u65b9\u6cd5\uff0c\u8fd9\u662f\u4e00\u4e2a\u8bfb\u53d6\u65b9\u6cd5\uff0c\u5b83\u4f1a\u63a5\u53d7\u4e00\u4e2a io.Writer \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u4f1a\u628a\u5176\u6240\u5c5e\u503c\u4e2d\u7684\u6570\u636e\u8bfb\u51fa\u5e76\u5199\u5165\u5230\u8fd9\u4e2a\u53c2\u6570\u4e2d\u3002 \u5728io\u5305\u4e2d\uff0c\u4e0e\u5199\u5165\u64cd\u4f5c\u6709\u5173\u7684\u63a5\u53e3\u90fd\u4e0e\u8bfb\u53d6\u64cd\u4f5c\u7684\u76f8\u5173\u63a5\u53e3\u6709\u7740\u4e00\u5b9a\u7684\u5bf9\u5e94\u5173\u7cfb \u3002","title":"\u8bfb\u53d6"},{"location":"Language/Basic/23-io/#_2","text":"io.ReaderFrom \u63a5\u53e3\uff0c\u5176\u4e2d\u5b9a\u4e49\u4e86ReadFrom\u65b9\u6cd5\uff0c\u8fd9\u662f\u4e00\u4e2a\u5199\u5165\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u63a5\u53d7\u4e00\u4e2a io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff0c\u5e76\u4f1a\u4ece\u8be5\u7c7b\u578b\u503c\u4e2d\u8bfb\u51fa\u6570\u636e\uff0c\u5e76\u5199\u5165\u5230\u5176\u6240\u5c5e\u503c\u4e2d\u3002 io.Writer \u6838\u5fc3\u63a5\u53e3\uff0c\u57fa\u4e8e\u5b83\u6269\u5c55\u63a5\u53e3\u9664\u4e86 io.ReadWriter \u3001 io.ReadWriteCloser \u3001 io.ReadWriteSeeker \u3001 io.WriteCloser \u548c io.WriteSeeker \u3002","title":"\u5199\u5165"},{"location":"Language/Basic/23-io/#_3","text":"io.Seeker \u63a5\u53e3\u4f5c\u4e3a\u8bfb\u5199\u4f4d\u7f6e\u8bbe\u5b9a\u76f8\u5173\u7684\u63a5\u53e3\uff0c\u5b9a\u4e49\u4e86\u4e00\u4e2a\u65b9\u6cd5Seek\u3002","title":"\u8bfb\u5199\u4f4d\u7f6e"},{"location":"Language/Basic/23-io/#_4","text":"*os.File \uff0c\u8fd9\u4e2a\u7c7b\u578b\u4e0d\u4f46\u662f io.WriterAt \u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u578b\uff0c\u8fd8\u5b9e\u73b0\u4e86 io.ByteWritCloser \u548c io.ReadWriteSeeker \uff0c\u8be5\u7c7b\u578b\u652f\u6301\u7684I/O\u64cd\u4f5c\u975e\u5e38\u4e30\u5bcc\u3002","title":"\u6570\u636e\u7c7b\u578b"},{"location":"Language/Basic/23-io/#_5","text":"io\u5305\u4e2d\u7684\u63a5\u53e3\u4f53\u7cfb","title":"\u603b\u7ed3"},{"location":"Language/Basic/24-bufio/","text":"bufio bufio\u662fbuffered I/O\u7684\u7f29\u5199\uff0c\u8fd9\u4e2a\u4ee3\u7801\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u5b9e\u73b0\u7684I/O\u64cd\u4f5c\u90fd\u5185\u7f6e\u4e86\u7f13\u51b2\u533a\u3002bufio\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u4e3b\u8981\u6709\uff1a Reader Scanner Writer ReadWriter \u4e0eio\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u7c7b\u4f3c\uff0c\u8fd9\u4e9b\u7c7b\u578b\u7684\u503c\u4e5f\u90fd\u9700\u8981\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u5305\u88c5\u4e00\u4e2a\u6216\u591a\u4e2a\u7b80\u5355I/O\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002\uff08\u7b80\u5355\u63a5\u53e3\u7c7b\u578b\u503c\u7684\u5c31\u662fio\u5305\u4e2d\u7684\u90a3\u4e9b\u7b80\u5355\u63a5\u53e3\u3002\uff09 bufio.Reader \u7c7b\u578b\u503c\u4e2d\u7684\u7f13\u51b2\u533a\u7684\u4f5c\u7528 bufio.Reader \u7c7b\u578b\u503c\u5185\u7684\u7f13\u51b2\u533a\uff0c\u662f\u4e00\u4e2a\u6570\u636e\u5b58\u50a8\u4e2d\u95f4\uff0c\u5b83\u4ecb\u4e8e\u5e95\u5c42\u8bfb\u53d6\u5668\uff08\u521d\u59cb\u5316\u6b64\u7c7b\u503c\u7684\u65f6\u5019\u4f20\u5165 io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff09\u4e0e\u8bfb\u53d6\u65b9\u6cd5\u53ca\u5176\u8c03\u7528\u65b9\u4e4b\u95f4\u3002 bufio.Reader \u503c\u7684\u8bfb\u53d6\u65b9\u6cd5\u4e00\u822c\u90fd\u4f1a\u5148\u4ece\u5176\u6240\u5c5e\u503c\u7684\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u5b83\u4eec\u8fd8\u4f1a\u9884\u5148\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u90a3\u91cc\u8bfb\u53d6\u4e00\u90e8\u5206\u6570\u636e\uff0c\u5e76\u6682\u5b58\u4e8e\u7f13\u51b2\u533a\u4e2d\u4ee5\u5907\u540e\u7528\u3002 \u6709\u8fd9\u6837\u4e00\u4e2a\u7f13\u51b2\u533a\u7684\u597d\u5904\u662f\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u65f6\u5019\u964d\u4f4e\u8bfb\u53d6\u65b9\u6cd5\u7684\u6267\u884c\u65f6\u95f4\uff0c\u867d\u7136\u8bfb\u53d6\u65b9\u6cd5\u6709\u65f6\u8fd8\u8981\u8d1f\u8d23\u586b\u5145\u7f13\u51b2\u533a\uff0c\u4f46\u4ece\u603b\u4f53\u6765\u770b\uff0c\u8bfb\u53d6\u65b9\u6cd5\u5e73\u5747\u6267\u884c\u65f6\u95f4\u4e00\u822c\u4f1a\u56e0\u6b64\u6709\u5927\u5e45\u7684\u7f29\u77ed\u3002 bufio.Reader \u7c7b\u578b\u5e76\u4e0d\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u5b83\u5305\u542b\u4e00\u4e9b\u9700\u8981\u663e\u5f0f\u521d\u59cb\u5316\u7684\u5b57\u6bb5\uff0c\u5982\u4e0b\uff1a // Reader\u4e3aio.Reader\u5bf9\u8c61\u5b9e\u73b0\u7f13\u51b2\u3002 type Reader struct { // \u5b57\u8282\u5207\u7247\uff0c\u4ee3\u8868\u7f13\u51b2\u533a\uff0c // \u867d\u7136\u8fd9\u662f\u5207\u7247\u7c7b\u578b\uff0c\u4f46\u662f\u5b83\u7684\u957f\u5ea6\u5374\u662f\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6307\u5b9a\uff0c\u5e76\u4e14\u5728\u4e4b\u540e\u4fdd\u6301\u4e0d\u53d8 buf []byte rd io.Reader //\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684reader\uff0c\u4ee3\u8868\u5e95\u5c42\u8bfb\u53d6\u5668\uff0c\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u5c31\u662f\u4ece\u8fd9\u91cc\u62f7\u8d1d\u6765\u7684 r, w int // buf \u8bfb\u5199\u4f4d\u7f6e // r \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u8bfb\u53d6\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5df2\u8bfb\u8ba1\u6570 // w \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u5199\u5165\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5df2\u5199\u8ba1\u6570 // \u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u5728\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u83b7\u5f97\u6570\u636e\u65f6\u53d1\u751f\u7684\u9519\u8bef // \u8fd9\u91cc\u503c\u5728\u88ab\u8bfb\u53d6\u6216\u5ffd\u7565\u4e4b\u540e\uff0c\u8be5\u5b57\u6bb5\u4f1a\u88ab\u8bbe\u7f6e\u4e3anil err error // UnreadByte\u8bfb\u53d6\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff1b -1\u8868\u793a\u65e0\u6548 // \u7528\u4e8e\u8bb0\u5f55\u7f13\u51b2\u533a\u4e2d\u6700\u540e\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684\u5b57\u8282\uff0c\u8bfb\u56de\u9000\u65f6\u4f1a\u7528\u5230\u5b83\u7684\u503c lastByte int // UnreadRune\u8bfb\u53d6\u7684\u6700\u540e\u4e00\u4e2arune\u7684\u5927\u5c0f\uff1b -1\u8868\u793a\u65e0\u6548 // \u7528\u4e8e\u8bb0\u5f55\u7f13\u51b2\u533a\u4e2d\u6700\u540e\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684Unicode\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\uff0c // \u8bfb\u56de\u9000\u7684\u65f6\u5019\u4f1a\u7528\u5230\u5b83\u7684\u503c\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u53ea\u4f1a\u5728\u5176\u6240\u5c5e\u503c\u7684ReadRune\u65b9\u6cd5\u4e2d\u624d\u4f1a\u88ab\u8d4b\u4e88\u6709\u610f\u4e49\u7684\u503c // \u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u5b83\u90fd\u88ab\u7f6e\u4e3a-1 lastRuneSize int } bufio\u5305\u63d0\u4f9b\u4e86\u4e24\u4e2a\u7528\u4e8e\u521d\u59cb\u5316Reader\u503c\u7684\u51fd\u6570\uff1a NewReader\uff1a\u521d\u59cb\u5316\u7684Reader\u503c\u4f1a\u62e5\u6709\u4e00\u4e2a\u9ed8\u8ba4\u5927\u5c0f\uff084096\u5b57\u8282\uff0c\u53734KB\uff09\u7684\u7f13\u51b2\u533a\uff0c NewReaderSize\uff1a\u5c06\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u7684\u51b3\u5b9a\u6743\u4ea4\u7ed9\u4f7f\u7528\u65b9 \u5b83\u4eec\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a *bufio.Reader \u7c7b\u578b\u7684\u503c\u3002\u8fd9\u91cc\u7684\u7f13\u51b2\u533a\u5728\u4e00\u4e2aReader\u503c\u7684\u751f\u547d\u5468\u671f\u5185\u5927\u5c0f\u662f\u4e0d\u53d8\u7684\uff0c\u6240\u4ee5\u5728\u6709\u4e9b\u65f6\u5019\u9700\u8981\u505a\u4e00\u4e9b\u6743\u8861\u3002 \u8bfb\u53d6Peek\u548cReadSlice\u65b9\u6cd5\uff0c\u90fd\u4f1a\u8c03\u7528\u8be5\u7c7b\u578b\u7684\u4e00\u4e2a\u540d\u4e3afill\u7684\u5305\u7ea7\u79c1\u6709\u65b9\u6cd5\uff0cfill\u65b9\u6cd5\u7684\u4f5c\u7528\u662f\u586b\u5145\u5185\u90e8\u7f13\u51b2\u533a\u3002 fill\u65b9\u6cd5\uff0c\u9996\u5148\u68c0\u67e5\u5176\u6240\u5c5e\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u5982\u679c\u8fd9\u4e2a\u8ba1\u6570\u4e0d\u5927\u4e8e0\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u53ef\u80fd\uff1a \u7f13\u51b2\u533a\u4e2d\u7684\u5b57\u8282\u90fd\u662f\u5168\u65b0\u7684\uff0c\u5b83\u4eec\u6ca1\u6709\u88ab\u8bfb\u53d6\u8fc7 \u7f13\u51b2\u533a\u521a\u88ab\u538b\u7f29\u8fc7\uff0c\u5bf9\u7f13\u51b2\u533a\u7684\u538b\u7f29\u64cd\u4f5c\uff1a \u628a\u7f13\u51b2\u533a\u4e2d\u5728[\u5df2\u8bfb\u8ba1\u6570\uff0c\u5df2\u5199\u8ba1\u6570]\u8303\u56f4\u4e4b\u5185\u7684\u6240\u6709\u5b57\u8282\u90fd\u4e00\u6b21\u62f7\u8d1d\u5230\u7f13\u51b2\u533a\u7684\u5934\u90e8\uff0c\u8fd9\u4e00\u6b65\u4e0d\u4f1a\u6709\u526f\u4f5c\u7528\uff0c\u56e0\u4e3a\uff1a \u5df2\u8bfb\u8ba1\u6570\u4e4b\u524d\u7684\u5b57\u8282\u90fd\u5df2\u7ecf\u88ab\u8bfb\u53d6\u8fc7\uff0c\u80af\u5b9a\u4e0d\u4f1a\u518d\u88ab\u8bfb\u53d6\uff0c\u56e0\u6b64\u628a\u5b83\u4eec\u8986\u76d6\u6389\u662f\u5b89\u5168\u7684 \u5728\u538b\u7f29\u7f13\u51b2\u533a\u4e4b\u540e\uff0c\u5df2\u5199\u8ba1\u6570\u4e4b\u540e\u7684\u5b57\u8282\u53ea\u53ef\u80fd\u662f\u5df2\u7ecf\u88ab\u8bfb\u53d6\u8fc7\u7684\u5b57\u8282\uff0c\u6216\u8005\u662f\u5df2\u88ab\u62f7\u8d1d\u5230\u7f13\u51b2\u533a\u5934\u90e8\u7684\u672a\u8bfb\u5b57\u8282\uff0c\u6216\u8005\u662f\u4ee3\u8868\u672a\u66fe\u88ab\u586b\u5165\u6570\u636e\u7684\u96f6\u503c\uff080x00\uff09\uff0c\u6240\u4ee5\u540e\u7eed\u7684\u65b0\u5b57\u8282\u53ef\u4ee5\u88ab\u5378\u8f7d\u8fd9\u4e9b\u4f4d\u7f6e\u4e0a\u3002 fill\u65b9\u6cd5\u4f1a\u628a\u5df2\u5199\u8ba1\u6570\u7684\u65b0\u503c\u8bbe\u5b9a\u4e3a\u539f\u5df2\u5199\u8ba1\u6570\u4e0e\u5df2\u8bfb\u8ba1\u6570\u53ea\u5dee\uff0c\u8fd9\u4e2a\u5dee\u9501\u4ee3\u8868\u7684\u7d22\u5f15\uff0c\u5c31\u662f\u538b\u7f29\u540e\u7b2c\u4e00\u6b21\u5199\u5165\u5b57\u8282\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\u3002 \u7f13\u51b2\u533a\u7684\u538b\u7f29\u8fc7\u7a0b\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5b9e\u9645\u4e0a\uff0cfill\u65b9\u6cd5\u53ea\u8981\u5728\u5f00\u59cb\u65f6\u53d1\u73b0\u5176\u6240\u5c5e\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u5927\u4e8e0\uff0c\u5c31\u4f1a\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e00\u6b21\u538b\u7f29\uff0c\u4e4b\u540e\uff0c\u5982\u679c\u7f13\u51b2\u533a\u4e2d\u8fd8\u6709\u53ef\u5199\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u8be5\u65b9\u6cd5\u5c31\u4f1a\u5bf9\u5176\u8fdb\u884c\u586b\u5145\u3002 \u5728\u586b\u5145\u7f13\u51b2\u533a\u7684\u65f6\u5019\uff0cfill\u65b9\u6cd5\u4f1a\u8bd5\u56fe\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u54ea\u91cc\uff0c\u8bfb\u53d6\u8db3\u591f\u591a\u7684\u5b57\u8282\uff0c\u5e76\u5c3d\u91cf\u628a\u4ece\u5df2\u5199\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4f4d\u7f6e\u5230\u7f13\u51b2\u533a\u672b\u5c3e\u4e4b\u95f4\u7684\u7a7a\u95f4\u90fd\u586b\u6ee1\u3002 \u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2dfill\u65b9\u6cd5\u4f1a\u53ca\u65f6\u66f4\u65b0\u5df2\u5199\u8ba1\u6570\uff0c\u4ee5\u4fdd\u8bc1\u586b\u5145\u7684\u6b63\u786e\u6027\u548c\u987a\u5e8f\u6027\uff0c\u5b83\u8fd8\u4f1a\u5224\u65ad\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u8bfb\u53d6\u6570\u636e\u7684\u65f6\u5019\uff0c\u662f\u5426\u6709\u9519\u8bef\u53d1\u751f\uff0c\u5982\u679c\u6709\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u628a\u9519\u8bef\u503c\u8d4b\u4e88\u7ed9\u5176\u6240\u5c5e\u503c\u7684err\u5b57\u6bb5\uff0c\u5e76\u7ec8\u6b62\u586b\u5145\u6d41\u7a0b\u3002 bufio.Writer \u7c7b\u578b\u503c\u4e2d\u7f13\u51b2\u7684\u6570\u636e\u4f55\u65f6\u5199\u5165\u5e95\u5c42\u5199\u5165\u5668 // Writer\u4e3aio.Writer\u5bf9\u8c61\u5b9e\u73b0\u7f13\u51b2\u3002 // \u5982\u679c\u5728\u5199\u5165Writer\u65f6\u53d1\u751f\u9519\u8bef\uff0c\u5c06\u4e0d\u518d\u63a5\u53d7\u4efb\u4f55\u6570\u636e\uff0c // \u5e76\u4e14\u6240\u6709\u540e\u7eed\u5199\u5165\u548cFlush\u90fd\u5c06\u8fd4\u56de\u9519\u8bef\u3002 // \u5199\u5165\u6240\u6709\u6570\u636e\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u5e94\u8c03\u7528Flush\u65b9\u6cd5\u4ee5\u786e\u4fdd\u6240\u6709\u6570\u636e\u90fd\u5df2\u8f6c\u53d1\u5230\u5e95\u5c42io.Writer\u3002 type Writer struct { err error // \u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u5728\u5411\u5e95\u5c42\u5199\u5165\u5668\u5199\u6570\u636e\u65f6\u53d1\u751f\u7684\u9519\u8bef buf []byte // \u4ee3\u8868\u7f13\u51b2\u533a\uff0c\u5728\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u5b83\u7684\u957f\u5ea6\u4f1a\u4fdd\u6301\u4e0d\u53d8 n int // \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u5199\u5165\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5199\u5165\u8ba1\u6570 wr io.Writer // \u4ee3\u8868\u5e95\u5c42\u5199\u5165\u5668 } bufio.Writer \u7c7b\u578b\u6709\u4e00\u4e2a\u540d\u4e3aFlush\u7684\u65b9\u6cd5\uff0c\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u628a\u76f8\u5e94\u7f13\u51b2\u533a\u4e2d\u6682\u5b58\u7684\u6240\u4ee5\u6570\u636e\uff0c\u90fd\u5199\u5230\u5e95\u5c42\u5199\u5165\u5668\u4e2d\uff0c\u6570\u636e\u4e00\u65e6\u88ab\u5199\u5165\u5e95\u5c42\u5199\u5165\u5668\uff0c\u8be5\u65b9\u6cd5\u5c31\u4f1a\u628a\u5b83\u4eec\u4ece\u7f13\u51b2\u533a\u4e2d\u5220\u9664\u6389\u3002 \u8fd9\u91cc\u7684\u5220\u9664\u6709\u65f6\u5019\u53ea\u662f\u903b\u8f91\u5220\u9664 \u3002\u4e0d\u8bba\u662f\u5426\u6210\u529f\u5199\u5165\u4e86\u6240\u6709\u6682\u5b58\u6570\u636e\uff0cFlush\u65b9\u6cd5\u90fd\u4f1a\u59a5\u5f53\u5904\u7f6e\uff0c\u5e76\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u91cd\u5199\u6216\u8005\u6f0f\u5199\u7684\u60c5\u51b5\u3002 bufio.Writer \u7c7b\u578b\u62e5\u6709\u7684\u6240\u4ee5\u6570\u636e\u5199\u5165\u65b9\u6cd5\u90fd\u4f1a\u5728\u5fc5\u8981\u7684\u65f6\u5019\u8c03\u7528\u5b83\u7684Flush\u65b9\u6cd5\u3002 Write\u65b9\u6cd5\u6709\u65f6\u5019\u4f1a\u5728\u628a\u6570\u636e\u5199\u8fdb\u7f13\u51b2\u533a\u4e4b\u540e\uff0c\u8c03\u7528Flush\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u4e3a\u540e\u7eed\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\uff0c\u5982\u679cWrite\u65b9\u6cd5\u53d1\u73b0\u8981\u5199\u5165\u7684\u5b57\u8282\u592a\u591a\uff0c\u540c\u65f6\u7f13\u51b2\u533a\u5df2\u7a7a\uff0c\u90a3\u4e48\u4f1a\u76f4\u63a5\u8de8\u8fc7\u7f13\u51b2\u533a\uff0c\u76f4\u63a5\u628a\u65b0\u7684\u6570\u636e\u5199\u5230\u5e95\u5c42\u5199\u5165\u5668\u4e2d\u3002 WriteByte\u65b9\u6cd5\u548cWriteRune\u65b9\u6cd5\u90fd\u4f1a\u5728\u53d1\u73b0\u7f13\u51b2\u533a\u4e2d\u7684\u53ef\u5199\u7a7a\u95f4\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u7684\u5b57\u8282\u6216Unicode\u5b57\u7b26\u7684\u65f6\u5019\uff0c\u8c03\u7528Flush\u65b9\u6cd5 ReadFrom\u65b9\u6cd5\uff0c\u4f1a\u5728\u53d1\u73b0\u5e95\u5c42\u5199\u5165\u5668\u7684\u7c7b\u578b\u662f io.ReaderFrom \u63a5\u53e3\u7684\u5b9e\u73b0\u4e4b\u540e\uff0c\u76f4\u63a5\u8c03\u7528\u5176 ReadFrom \u65b9\u6cd5\u628a\u53c2\u6570\u503c\u6301\u6709\u7684\u6570\u636e\u5199\u8fdb\u53bb\u3002 \u53ea\u8981\u7f13\u51b2\u533a\u4e2d\u7684\u53ef\u5199\u7a7a\u95f4\u65e0\u6cd5\u5bb9\u7eb3\u9700\u8981\u5199\u5165\u7684\u65b0\u6570\u636e\uff0cFlush\u65b9\u6cd5\u5c31\u4e00\u5b9a\u4f1a\u88ab\u8c03\u7528 \uff0c bufio.Writer \u7c7b\u578b\u7684\u4e00\u4e9b\u65b9\u6cd5\u6709\u65f6\u5019\u8fd8\u4f1a\u8bd5\u56fe\u8d70\u6377\u5f84\uff0c\u8de8\u8fc7\u7f13\u51b2\u533a\u800c\u76f4\u63a5\u5bf9\u63a5\u6570\u636e\u4f9b\u9700\u65b9\u3002 bufio.Reader \u7c7b\u578b\u7684\u8bfb\u53d6\u65b9\u6cd5 bufio.Reader \u7c7b\u578b\u62e5\u6709\u5f88\u591a\u7528\u4e8e\u8bfb\u53d6\u6570\u636e\u7684\u6307\u9488\u65b9\u6cd5\uff0c\u8fd9\u91cc\u6709\u56db\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f5c\u4e3a\u4e0d\u540c\u8bfb\u53d6\u6d41\u7a0b\u7684\u4ee3\u8868\uff1a func (b *Reader) Peek(n int) ([]byte, error) Peek\uff1a\u8bfb\u53d6\u5e76\u8fd4\u56de\u5176\u7f13\u51b2\u533a\u4e2dn\u4e2a\u672a\u8bfb\u5b57\u8282\uff0c\u5e76\u4e14\u5b83\u4f1a\u4ece\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb\u8bfb\u3002 \u5728\u7f13\u51b2\u533a\u672a\u88ab\u586b\u6ee1\uff0c\u5e76\u4e14\u5176\u4e2d\u7684\u672a\u8bfb\u5b57\u8282\u7684\u6570\u91cf\u5c0f\u4e8en\u7684\u65f6\u5019\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8c03\u7528fill\u65b9\u6cd5\uff0c\u4ee5\u542f\u52a8\u7f13\u51b2\u533a\u586b\u5145\u6d41\u7a0b\uff0c\u5982\u679c\u53d1\u73b0\u4e0a\u6b21\u586b\u5145\u7f13\u51b2\u533a\u65f6\u6709\u9519\u8bef\uff0c\u5219\u4e0d\u518d\u586b\u5145\u3002 \u5982\u679c\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684n\u6bd4\u7f13\u51b2\u533a\u7684\u957f\u5ea6\u8fd8\u5927\uff0c\u6216\u8005\u7f13\u51b2\u533a\u4e2d\u672a\u8bfb\u5b57\u8282\u7684\u6570\u91cf\u5c0f\u4e8en\uff0c\u90a3\u4e48\uff1a \u6240\u6709\u672a\u8bfb\u5b57\u8282\u7ec4\u6210\u7684\u5e8f\u5217\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c bufio.ErrBufferFull \u53d8\u91cf\u7684\u503c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u7ed3\u679c\uff0c\u7528\u6765\u8868\u793a\u867d\u7136\u7f13\u51b2\u533a\u88ab\u538b\u7f29\u548c\u586b\u6ee1\u4e86\uff0c\u4f46\u662f\u4ecd\u7136\u4e0d\u6ee1\u8db3\u8981\u6c42 \u4e0a\u8ff0\u60c5\u51b5\u90fd\u672a\u51fa\u73b0\uff0c\u5219\u8fd4\u56de \u5df2\u8bfb\u8ba1\u6570\u4e3a\u8d77\u59cb\u7684n\u4e2a\u5b57\u8282 \u548c \u8868\u793a\u672a\u53d1\u751f\u4efb\u4f55\u9519\u8bef\u7684 nil Peek\u65b9\u6cd5\u7684\u4e00\u4e2a\u7279\u70b9\uff0c\u5373\u4f7f\u5b83\u8bfb\u53d6\u4e86\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\uff0c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u5df2\u8bfb\u8ba1\u6570\u7684\u503c \u3002\u5176\u4ed6\u7684\u8bfb\u53d6\u65b9\u6cd5\u4e0d\u662f\u8fd9\u6837\u7684\u3002 func (b *Reader) Read(p []byte) (n int, err error) Read\uff1a\u628a\u7f13\u51b2\u533a\u4e2d\u7684\u672a\u8bfb\u5b57\u8282\uff0c\u4f9d\u6b21\u62f7\u8d1d\u5230\u5176\u53c2\u6570p\u4ee3\u8868\u7684\u5b57\u8282\u5207\u7247\u4e2d\uff0c\u5e76\u7acb\u5373\u6839\u636e\u5b9e\u9645\u62f7\u8d1d\u7684\u5b57\u8282\u6570\u589e\u52a0\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u3002 \u5728\u7f13\u51b2\u533a\u4e2d\u8fd8\u6709\u672a\u8bfb\u5b57\u8282\u7684\u60c5\u51b5\u4e0b\uff0cRead\u65b9\u6cd5\u662f\u8fd9\u6837\u505a\u7684\u3002\uff08\u5f53\u5df2\u8bfb\u8ba1\u6570\u7b49\u4e8e\u5df2\u5199\u8ba1\u6570\u65f6\uff0c\u8868\u793a\u6b64\u65f6\u7684\u7f13\u51b2\u533a\u4e2d\u6ca1\u6709\u4efb\u4f55\u672a\u8bfb\u7684\u5b57\u8282\uff09 \u5f53\u7f13\u51b2\u533a\u4e2d\u65e0\u672a\u8bfb\u5b57\u8282\u65f6\uff0cRead\u65b9\u6cd5\u4f1a\u5148\u68c0\u67e5\u53c2\u6570p\u7684\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6216\u7b49\u4e8e\u7f13\u51b2\u533a\u7684\u957f\u5ea6\u3002 \u5982\u679c\u662f\uff0cRead\u65b9\u6cd5\u653e\u5f03\u7f13\u51b2\u533a\u4e2d\u7684\u586b\u5145\u6570\u636e\uff0c\u76f4\u63a5\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u4e2d\u8bfb\u51fa\u6570\u636e\u5e76\u62f7\u8d1d\u5230p\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5b8c\u5168\u8de8\u8fc7\u4e86\u7f13\u51b2\u533a\uff0c\u5e76\u76f4\u8fde\u4e86\u6570\u636e\u4f9b\u9700\u7684\u53cc\u65b9\u3002 \u5982\u679c\u5426\uff0c\u4f1a\u5148\u628a\u5df2\u8bfb\u8ba1\u6570\u548c\u5df2\u5199\u8ba1\u6570\u90fd\u91cd\u7f6e\u4e3a0\uff0c\u7136\u540e\u518d\u5c1d\u8bd5\uff08\u53ea\u8fdb\u884c\u4e00\u6b21\uff09\u4f7f\u7528\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u90a3\u91cc\u56de\u53bb\u7684\u6570\u636e\uff0c\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e00\u6b21\u4ece\u5934\u5230\u5c3e\u7684\u586b\u5145\u3002 func (b *Reader) ReadSlice(delim byte) (line []byte, err error) ReadSlice\uff1a\u6301\u7eed\u5730\u8bfb\u53d6\u6570\u636e\uff0c\u76f4\u5230\u9047\u5230\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u4e3a\u6b62\u3002 \u5148\u5728\u7f13\u51b2\u533a\u7684\u672a\u8bfb\u90e8\u5206\u4e2d\u5bfb\u627e\u5206\u9694\u7b26\uff0c\u5982\u679c\u672a\u627e\u5230\uff0c\u5e76\u4e14\u7f13\u51b2\u533a\u672a\u6ee1\uff0c\u90a3\u4e48\u8c03\u52a8fill\u65b9\u6cd5\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u586b\u5145\uff0c\u7136\u540e\u518d\u6b21\u5bfb\u627e\uff0c\u5982\u6b64\u5f80\u590d\u3002 - \u5982\u679c\u5728\u586b\u5145\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u9519\u8bef\uff0c\u4f1a\u628a\u672a\u8bfb\u90e8\u5206\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u9519\u8bef\u503c\u3002 - \u5982\u679c\u7f13\u51b2\u533a\u88ab\u586b\u6ee1\uff0c\u4ecd\u7136\u6ca1\u6709\u627e\u5230\u5206\u9694\u7b26\uff0c\u90a3\u4e48\u6574\u4e2a\u7f13\u51b2\u533a\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c\uff0c bufio.ErrBufferFull \uff08\u7f13\u51b2\u533a\u5df2\u6ee1\u7684\u9519\u8bef\uff09\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u7ed3\u679c func (b *Reader) ReadBytes(delim byte) ([]byte, error) ReadBytes\uff1a\u6301\u7eed\u5730\u8bfb\u53d6\u6570\u636e\uff0c\u76f4\u5230\u9047\u5230\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u4e3a\u6b62\u3002 ReadBytes\u65b9\u6cd5\u4f9d\u8d56ReadSlice\u65b9\u6cd5\u3002 ReadLine\u65b9\u6cd5\u4f9d\u8d56ReadSlice\u65b9\u6cd5\u3002 ReadString\u65b9\u6cd5\u5b8c\u5168\u4f9d\u8d56ReadBytes\u65b9\u6cd5\uff0c\u53ea\u662f\u5728\u8fd4\u56de\u7684\u7ed3\u679c\u4e4b\u4e0a\u505a\u7b80\u5355\u7684\u7c7b\u578b\u8f6c\u6362\u3002 Peek\u3001ReadSlice\u3001ReadLine\u65b9\u6cd5\u90fd\u53ef\u80fd\u4f1a\u9020\u6210\u5185\u5bb9\u6cc4\u9732 \uff0c\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u90fd\u4f1a\u76f4\u63a5\u8fd4\u56de\u57fa\u4e8e\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5207\u7247\uff0c\u8c03\u7528\u65b9\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\u8bbf\u95ee\u5230\u7f13\u51b2\u533a\u7684\u5176\u4ed6\u90e8\u5206\uff0c\u751a\u81f3\u4fee\u6539\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd9\u662f\u975e\u5e38\u5371\u9669\u7684\u3002","title":"bufio"},{"location":"Language/Basic/24-bufio/#bufio","text":"bufio\u662fbuffered I/O\u7684\u7f29\u5199\uff0c\u8fd9\u4e2a\u4ee3\u7801\u5305\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u5b9e\u73b0\u7684I/O\u64cd\u4f5c\u90fd\u5185\u7f6e\u4e86\u7f13\u51b2\u533a\u3002bufio\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u4e3b\u8981\u6709\uff1a Reader Scanner Writer ReadWriter \u4e0eio\u5305\u4e2d\u7684\u6570\u636e\u7c7b\u578b\u7c7b\u4f3c\uff0c\u8fd9\u4e9b\u7c7b\u578b\u7684\u503c\u4e5f\u90fd\u9700\u8981\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u5305\u88c5\u4e00\u4e2a\u6216\u591a\u4e2a\u7b80\u5355I/O\u63a5\u53e3\u7c7b\u578b\u7684\u503c\u3002\uff08\u7b80\u5355\u63a5\u53e3\u7c7b\u578b\u503c\u7684\u5c31\u662fio\u5305\u4e2d\u7684\u90a3\u4e9b\u7b80\u5355\u63a5\u53e3\u3002\uff09","title":"bufio"},{"location":"Language/Basic/24-bufio/#bufioreader","text":"bufio.Reader \u7c7b\u578b\u503c\u5185\u7684\u7f13\u51b2\u533a\uff0c\u662f\u4e00\u4e2a\u6570\u636e\u5b58\u50a8\u4e2d\u95f4\uff0c\u5b83\u4ecb\u4e8e\u5e95\u5c42\u8bfb\u53d6\u5668\uff08\u521d\u59cb\u5316\u6b64\u7c7b\u503c\u7684\u65f6\u5019\u4f20\u5165 io.Reader \u7c7b\u578b\u7684\u53c2\u6570\u503c\uff09\u4e0e\u8bfb\u53d6\u65b9\u6cd5\u53ca\u5176\u8c03\u7528\u65b9\u4e4b\u95f4\u3002 bufio.Reader \u503c\u7684\u8bfb\u53d6\u65b9\u6cd5\u4e00\u822c\u90fd\u4f1a\u5148\u4ece\u5176\u6240\u5c5e\u503c\u7684\u7f13\u51b2\u533a\u4e2d\u8bfb\u53d6\u6570\u636e\uff0c\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u5b83\u4eec\u8fd8\u4f1a\u9884\u5148\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u90a3\u91cc\u8bfb\u53d6\u4e00\u90e8\u5206\u6570\u636e\uff0c\u5e76\u6682\u5b58\u4e8e\u7f13\u51b2\u533a\u4e2d\u4ee5\u5907\u540e\u7528\u3002 \u6709\u8fd9\u6837\u4e00\u4e2a\u7f13\u51b2\u533a\u7684\u597d\u5904\u662f\uff0c\u53ef\u4ee5\u5728\u5927\u591a\u6570\u65f6\u5019\u964d\u4f4e\u8bfb\u53d6\u65b9\u6cd5\u7684\u6267\u884c\u65f6\u95f4\uff0c\u867d\u7136\u8bfb\u53d6\u65b9\u6cd5\u6709\u65f6\u8fd8\u8981\u8d1f\u8d23\u586b\u5145\u7f13\u51b2\u533a\uff0c\u4f46\u4ece\u603b\u4f53\u6765\u770b\uff0c\u8bfb\u53d6\u65b9\u6cd5\u5e73\u5747\u6267\u884c\u65f6\u95f4\u4e00\u822c\u4f1a\u56e0\u6b64\u6709\u5927\u5e45\u7684\u7f29\u77ed\u3002 bufio.Reader \u7c7b\u578b\u5e76\u4e0d\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u5b83\u5305\u542b\u4e00\u4e9b\u9700\u8981\u663e\u5f0f\u521d\u59cb\u5316\u7684\u5b57\u6bb5\uff0c\u5982\u4e0b\uff1a // Reader\u4e3aio.Reader\u5bf9\u8c61\u5b9e\u73b0\u7f13\u51b2\u3002 type Reader struct { // \u5b57\u8282\u5207\u7247\uff0c\u4ee3\u8868\u7f13\u51b2\u533a\uff0c // \u867d\u7136\u8fd9\u662f\u5207\u7247\u7c7b\u578b\uff0c\u4f46\u662f\u5b83\u7684\u957f\u5ea6\u5374\u662f\u5728\u521d\u59cb\u5316\u7684\u65f6\u5019\u6307\u5b9a\uff0c\u5e76\u4e14\u5728\u4e4b\u540e\u4fdd\u6301\u4e0d\u53d8 buf []byte rd io.Reader //\u5ba2\u6237\u7aef\u63d0\u4f9b\u7684reader\uff0c\u4ee3\u8868\u5e95\u5c42\u8bfb\u53d6\u5668\uff0c\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\u5c31\u662f\u4ece\u8fd9\u91cc\u62f7\u8d1d\u6765\u7684 r, w int // buf \u8bfb\u5199\u4f4d\u7f6e // r \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u8bfb\u53d6\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5df2\u8bfb\u8ba1\u6570 // w \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u5199\u5165\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5df2\u5199\u8ba1\u6570 // \u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u5728\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u83b7\u5f97\u6570\u636e\u65f6\u53d1\u751f\u7684\u9519\u8bef // \u8fd9\u91cc\u503c\u5728\u88ab\u8bfb\u53d6\u6216\u5ffd\u7565\u4e4b\u540e\uff0c\u8be5\u5b57\u6bb5\u4f1a\u88ab\u8bbe\u7f6e\u4e3anil err error // UnreadByte\u8bfb\u53d6\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u8282\uff1b -1\u8868\u793a\u65e0\u6548 // \u7528\u4e8e\u8bb0\u5f55\u7f13\u51b2\u533a\u4e2d\u6700\u540e\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684\u5b57\u8282\uff0c\u8bfb\u56de\u9000\u65f6\u4f1a\u7528\u5230\u5b83\u7684\u503c lastByte int // UnreadRune\u8bfb\u53d6\u7684\u6700\u540e\u4e00\u4e2arune\u7684\u5927\u5c0f\uff1b -1\u8868\u793a\u65e0\u6548 // \u7528\u4e8e\u8bb0\u5f55\u7f13\u51b2\u533a\u4e2d\u6700\u540e\u4e00\u4e2a\u88ab\u8bfb\u53d6\u7684Unicode\u5b57\u7b26\u6240\u5360\u7528\u7684\u5b57\u8282\u6570\uff0c // \u8bfb\u56de\u9000\u7684\u65f6\u5019\u4f1a\u7528\u5230\u5b83\u7684\u503c\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u53ea\u4f1a\u5728\u5176\u6240\u5c5e\u503c\u7684ReadRune\u65b9\u6cd5\u4e2d\u624d\u4f1a\u88ab\u8d4b\u4e88\u6709\u610f\u4e49\u7684\u503c // \u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u5b83\u90fd\u88ab\u7f6e\u4e3a-1 lastRuneSize int } bufio\u5305\u63d0\u4f9b\u4e86\u4e24\u4e2a\u7528\u4e8e\u521d\u59cb\u5316Reader\u503c\u7684\u51fd\u6570\uff1a NewReader\uff1a\u521d\u59cb\u5316\u7684Reader\u503c\u4f1a\u62e5\u6709\u4e00\u4e2a\u9ed8\u8ba4\u5927\u5c0f\uff084096\u5b57\u8282\uff0c\u53734KB\uff09\u7684\u7f13\u51b2\u533a\uff0c NewReaderSize\uff1a\u5c06\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u7684\u51b3\u5b9a\u6743\u4ea4\u7ed9\u4f7f\u7528\u65b9 \u5b83\u4eec\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a *bufio.Reader \u7c7b\u578b\u7684\u503c\u3002\u8fd9\u91cc\u7684\u7f13\u51b2\u533a\u5728\u4e00\u4e2aReader\u503c\u7684\u751f\u547d\u5468\u671f\u5185\u5927\u5c0f\u662f\u4e0d\u53d8\u7684\uff0c\u6240\u4ee5\u5728\u6709\u4e9b\u65f6\u5019\u9700\u8981\u505a\u4e00\u4e9b\u6743\u8861\u3002 \u8bfb\u53d6Peek\u548cReadSlice\u65b9\u6cd5\uff0c\u90fd\u4f1a\u8c03\u7528\u8be5\u7c7b\u578b\u7684\u4e00\u4e2a\u540d\u4e3afill\u7684\u5305\u7ea7\u79c1\u6709\u65b9\u6cd5\uff0cfill\u65b9\u6cd5\u7684\u4f5c\u7528\u662f\u586b\u5145\u5185\u90e8\u7f13\u51b2\u533a\u3002 fill\u65b9\u6cd5\uff0c\u9996\u5148\u68c0\u67e5\u5176\u6240\u5c5e\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\uff0c\u5982\u679c\u8fd9\u4e2a\u8ba1\u6570\u4e0d\u5927\u4e8e0\uff0c\u90a3\u4e48\u6709\u4e24\u79cd\u53ef\u80fd\uff1a \u7f13\u51b2\u533a\u4e2d\u7684\u5b57\u8282\u90fd\u662f\u5168\u65b0\u7684\uff0c\u5b83\u4eec\u6ca1\u6709\u88ab\u8bfb\u53d6\u8fc7 \u7f13\u51b2\u533a\u521a\u88ab\u538b\u7f29\u8fc7\uff0c\u5bf9\u7f13\u51b2\u533a\u7684\u538b\u7f29\u64cd\u4f5c\uff1a \u628a\u7f13\u51b2\u533a\u4e2d\u5728[\u5df2\u8bfb\u8ba1\u6570\uff0c\u5df2\u5199\u8ba1\u6570]\u8303\u56f4\u4e4b\u5185\u7684\u6240\u6709\u5b57\u8282\u90fd\u4e00\u6b21\u62f7\u8d1d\u5230\u7f13\u51b2\u533a\u7684\u5934\u90e8\uff0c\u8fd9\u4e00\u6b65\u4e0d\u4f1a\u6709\u526f\u4f5c\u7528\uff0c\u56e0\u4e3a\uff1a \u5df2\u8bfb\u8ba1\u6570\u4e4b\u524d\u7684\u5b57\u8282\u90fd\u5df2\u7ecf\u88ab\u8bfb\u53d6\u8fc7\uff0c\u80af\u5b9a\u4e0d\u4f1a\u518d\u88ab\u8bfb\u53d6\uff0c\u56e0\u6b64\u628a\u5b83\u4eec\u8986\u76d6\u6389\u662f\u5b89\u5168\u7684 \u5728\u538b\u7f29\u7f13\u51b2\u533a\u4e4b\u540e\uff0c\u5df2\u5199\u8ba1\u6570\u4e4b\u540e\u7684\u5b57\u8282\u53ea\u53ef\u80fd\u662f\u5df2\u7ecf\u88ab\u8bfb\u53d6\u8fc7\u7684\u5b57\u8282\uff0c\u6216\u8005\u662f\u5df2\u88ab\u62f7\u8d1d\u5230\u7f13\u51b2\u533a\u5934\u90e8\u7684\u672a\u8bfb\u5b57\u8282\uff0c\u6216\u8005\u662f\u4ee3\u8868\u672a\u66fe\u88ab\u586b\u5165\u6570\u636e\u7684\u96f6\u503c\uff080x00\uff09\uff0c\u6240\u4ee5\u540e\u7eed\u7684\u65b0\u5b57\u8282\u53ef\u4ee5\u88ab\u5378\u8f7d\u8fd9\u4e9b\u4f4d\u7f6e\u4e0a\u3002 fill\u65b9\u6cd5\u4f1a\u628a\u5df2\u5199\u8ba1\u6570\u7684\u65b0\u503c\u8bbe\u5b9a\u4e3a\u539f\u5df2\u5199\u8ba1\u6570\u4e0e\u5df2\u8bfb\u8ba1\u6570\u53ea\u5dee\uff0c\u8fd9\u4e2a\u5dee\u9501\u4ee3\u8868\u7684\u7d22\u5f15\uff0c\u5c31\u662f\u538b\u7f29\u540e\u7b2c\u4e00\u6b21\u5199\u5165\u5b57\u8282\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\u3002 \u7f13\u51b2\u533a\u7684\u538b\u7f29\u8fc7\u7a0b\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u5b9e\u9645\u4e0a\uff0cfill\u65b9\u6cd5\u53ea\u8981\u5728\u5f00\u59cb\u65f6\u53d1\u73b0\u5176\u6240\u5c5e\u503c\u7684\u5df2\u8bfb\u8ba1\u6570\u5927\u4e8e0\uff0c\u5c31\u4f1a\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e00\u6b21\u538b\u7f29\uff0c\u4e4b\u540e\uff0c\u5982\u679c\u7f13\u51b2\u533a\u4e2d\u8fd8\u6709\u53ef\u5199\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u8be5\u65b9\u6cd5\u5c31\u4f1a\u5bf9\u5176\u8fdb\u884c\u586b\u5145\u3002 \u5728\u586b\u5145\u7f13\u51b2\u533a\u7684\u65f6\u5019\uff0cfill\u65b9\u6cd5\u4f1a\u8bd5\u56fe\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u54ea\u91cc\uff0c\u8bfb\u53d6\u8db3\u591f\u591a\u7684\u5b57\u8282\uff0c\u5e76\u5c3d\u91cf\u628a\u4ece\u5df2\u5199\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4f4d\u7f6e\u5230\u7f13\u51b2\u533a\u672b\u5c3e\u4e4b\u95f4\u7684\u7a7a\u95f4\u90fd\u586b\u6ee1\u3002 \u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2dfill\u65b9\u6cd5\u4f1a\u53ca\u65f6\u66f4\u65b0\u5df2\u5199\u8ba1\u6570\uff0c\u4ee5\u4fdd\u8bc1\u586b\u5145\u7684\u6b63\u786e\u6027\u548c\u987a\u5e8f\u6027\uff0c\u5b83\u8fd8\u4f1a\u5224\u65ad\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u8bfb\u53d6\u6570\u636e\u7684\u65f6\u5019\uff0c\u662f\u5426\u6709\u9519\u8bef\u53d1\u751f\uff0c\u5982\u679c\u6709\uff0c\u90a3\u4e48\u5b83\u5c31\u4f1a\u628a\u9519\u8bef\u503c\u8d4b\u4e88\u7ed9\u5176\u6240\u5c5e\u503c\u7684err\u5b57\u6bb5\uff0c\u5e76\u7ec8\u6b62\u586b\u5145\u6d41\u7a0b\u3002","title":"bufio.Reader\u7c7b\u578b\u503c\u4e2d\u7684\u7f13\u51b2\u533a\u7684\u4f5c\u7528"},{"location":"Language/Basic/24-bufio/#bufiowriter","text":"// Writer\u4e3aio.Writer\u5bf9\u8c61\u5b9e\u73b0\u7f13\u51b2\u3002 // \u5982\u679c\u5728\u5199\u5165Writer\u65f6\u53d1\u751f\u9519\u8bef\uff0c\u5c06\u4e0d\u518d\u63a5\u53d7\u4efb\u4f55\u6570\u636e\uff0c // \u5e76\u4e14\u6240\u6709\u540e\u7eed\u5199\u5165\u548cFlush\u90fd\u5c06\u8fd4\u56de\u9519\u8bef\u3002 // \u5199\u5165\u6240\u6709\u6570\u636e\u4e4b\u540e\uff0c\u5ba2\u6237\u7aef\u5e94\u8c03\u7528Flush\u65b9\u6cd5\u4ee5\u786e\u4fdd\u6240\u6709\u6570\u636e\u90fd\u5df2\u8f6c\u53d1\u5230\u5e95\u5c42io.Writer\u3002 type Writer struct { err error // \u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u5728\u5411\u5e95\u5c42\u5199\u5165\u5668\u5199\u6570\u636e\u65f6\u53d1\u751f\u7684\u9519\u8bef buf []byte // \u4ee3\u8868\u7f13\u51b2\u533a\uff0c\u5728\u521d\u59cb\u5316\u4e4b\u540e\uff0c\u5b83\u7684\u957f\u5ea6\u4f1a\u4fdd\u6301\u4e0d\u53d8 n int // \u4ee3\u8868\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e0b\u4e00\u6b21\u5199\u5165\u65f6\u7684\u5f00\u59cb\u7d22\u5f15\uff0c\u79f0\u4e3a\u5199\u5165\u8ba1\u6570 wr io.Writer // \u4ee3\u8868\u5e95\u5c42\u5199\u5165\u5668 } bufio.Writer \u7c7b\u578b\u6709\u4e00\u4e2a\u540d\u4e3aFlush\u7684\u65b9\u6cd5\uff0c\u5b83\u7684\u4e3b\u8981\u529f\u80fd\u662f\u628a\u76f8\u5e94\u7f13\u51b2\u533a\u4e2d\u6682\u5b58\u7684\u6240\u4ee5\u6570\u636e\uff0c\u90fd\u5199\u5230\u5e95\u5c42\u5199\u5165\u5668\u4e2d\uff0c\u6570\u636e\u4e00\u65e6\u88ab\u5199\u5165\u5e95\u5c42\u5199\u5165\u5668\uff0c\u8be5\u65b9\u6cd5\u5c31\u4f1a\u628a\u5b83\u4eec\u4ece\u7f13\u51b2\u533a\u4e2d\u5220\u9664\u6389\u3002 \u8fd9\u91cc\u7684\u5220\u9664\u6709\u65f6\u5019\u53ea\u662f\u903b\u8f91\u5220\u9664 \u3002\u4e0d\u8bba\u662f\u5426\u6210\u529f\u5199\u5165\u4e86\u6240\u6709\u6682\u5b58\u6570\u636e\uff0cFlush\u65b9\u6cd5\u90fd\u4f1a\u59a5\u5f53\u5904\u7f6e\uff0c\u5e76\u4fdd\u8bc1\u4e0d\u4f1a\u51fa\u73b0\u91cd\u5199\u6216\u8005\u6f0f\u5199\u7684\u60c5\u51b5\u3002 bufio.Writer \u7c7b\u578b\u62e5\u6709\u7684\u6240\u4ee5\u6570\u636e\u5199\u5165\u65b9\u6cd5\u90fd\u4f1a\u5728\u5fc5\u8981\u7684\u65f6\u5019\u8c03\u7528\u5b83\u7684Flush\u65b9\u6cd5\u3002 Write\u65b9\u6cd5\u6709\u65f6\u5019\u4f1a\u5728\u628a\u6570\u636e\u5199\u8fdb\u7f13\u51b2\u533a\u4e4b\u540e\uff0c\u8c03\u7528Flush\u65b9\u6cd5\uff0c\u4ee5\u4fbf\u4e3a\u540e\u7eed\u7684\u65b0\u6570\u636e\u817e\u51fa\u7a7a\u95f4\uff0c\u5982\u679cWrite\u65b9\u6cd5\u53d1\u73b0\u8981\u5199\u5165\u7684\u5b57\u8282\u592a\u591a\uff0c\u540c\u65f6\u7f13\u51b2\u533a\u5df2\u7a7a\uff0c\u90a3\u4e48\u4f1a\u76f4\u63a5\u8de8\u8fc7\u7f13\u51b2\u533a\uff0c\u76f4\u63a5\u628a\u65b0\u7684\u6570\u636e\u5199\u5230\u5e95\u5c42\u5199\u5165\u5668\u4e2d\u3002 WriteByte\u65b9\u6cd5\u548cWriteRune\u65b9\u6cd5\u90fd\u4f1a\u5728\u53d1\u73b0\u7f13\u51b2\u533a\u4e2d\u7684\u53ef\u5199\u7a7a\u95f4\u4e0d\u8db3\u4ee5\u5bb9\u7eb3\u65b0\u7684\u5b57\u8282\u6216Unicode\u5b57\u7b26\u7684\u65f6\u5019\uff0c\u8c03\u7528Flush\u65b9\u6cd5 ReadFrom\u65b9\u6cd5\uff0c\u4f1a\u5728\u53d1\u73b0\u5e95\u5c42\u5199\u5165\u5668\u7684\u7c7b\u578b\u662f io.ReaderFrom \u63a5\u53e3\u7684\u5b9e\u73b0\u4e4b\u540e\uff0c\u76f4\u63a5\u8c03\u7528\u5176 ReadFrom \u65b9\u6cd5\u628a\u53c2\u6570\u503c\u6301\u6709\u7684\u6570\u636e\u5199\u8fdb\u53bb\u3002 \u53ea\u8981\u7f13\u51b2\u533a\u4e2d\u7684\u53ef\u5199\u7a7a\u95f4\u65e0\u6cd5\u5bb9\u7eb3\u9700\u8981\u5199\u5165\u7684\u65b0\u6570\u636e\uff0cFlush\u65b9\u6cd5\u5c31\u4e00\u5b9a\u4f1a\u88ab\u8c03\u7528 \uff0c bufio.Writer \u7c7b\u578b\u7684\u4e00\u4e9b\u65b9\u6cd5\u6709\u65f6\u5019\u8fd8\u4f1a\u8bd5\u56fe\u8d70\u6377\u5f84\uff0c\u8de8\u8fc7\u7f13\u51b2\u533a\u800c\u76f4\u63a5\u5bf9\u63a5\u6570\u636e\u4f9b\u9700\u65b9\u3002","title":"bufio.Writer\u7c7b\u578b\u503c\u4e2d\u7f13\u51b2\u7684\u6570\u636e\u4f55\u65f6\u5199\u5165\u5e95\u5c42\u5199\u5165\u5668"},{"location":"Language/Basic/24-bufio/#bufioreader_1","text":"bufio.Reader \u7c7b\u578b\u62e5\u6709\u5f88\u591a\u7528\u4e8e\u8bfb\u53d6\u6570\u636e\u7684\u6307\u9488\u65b9\u6cd5\uff0c\u8fd9\u91cc\u6709\u56db\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f5c\u4e3a\u4e0d\u540c\u8bfb\u53d6\u6d41\u7a0b\u7684\u4ee3\u8868\uff1a func (b *Reader) Peek(n int) ([]byte, error) Peek\uff1a\u8bfb\u53d6\u5e76\u8fd4\u56de\u5176\u7f13\u51b2\u533a\u4e2dn\u4e2a\u672a\u8bfb\u5b57\u8282\uff0c\u5e76\u4e14\u5b83\u4f1a\u4ece\u5df2\u8bfb\u8ba1\u6570\u4ee3\u8868\u7684\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb\u8bfb\u3002 \u5728\u7f13\u51b2\u533a\u672a\u88ab\u586b\u6ee1\uff0c\u5e76\u4e14\u5176\u4e2d\u7684\u672a\u8bfb\u5b57\u8282\u7684\u6570\u91cf\u5c0f\u4e8en\u7684\u65f6\u5019\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8c03\u7528fill\u65b9\u6cd5\uff0c\u4ee5\u542f\u52a8\u7f13\u51b2\u533a\u586b\u5145\u6d41\u7a0b\uff0c\u5982\u679c\u53d1\u73b0\u4e0a\u6b21\u586b\u5145\u7f13\u51b2\u533a\u65f6\u6709\u9519\u8bef\uff0c\u5219\u4e0d\u518d\u586b\u5145\u3002 \u5982\u679c\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684n\u6bd4\u7f13\u51b2\u533a\u7684\u957f\u5ea6\u8fd8\u5927\uff0c\u6216\u8005\u7f13\u51b2\u533a\u4e2d\u672a\u8bfb\u5b57\u8282\u7684\u6570\u91cf\u5c0f\u4e8en\uff0c\u90a3\u4e48\uff1a \u6240\u6709\u672a\u8bfb\u5b57\u8282\u7ec4\u6210\u7684\u5e8f\u5217\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c bufio.ErrBufferFull \u53d8\u91cf\u7684\u503c\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u7ed3\u679c\uff0c\u7528\u6765\u8868\u793a\u867d\u7136\u7f13\u51b2\u533a\u88ab\u538b\u7f29\u548c\u586b\u6ee1\u4e86\uff0c\u4f46\u662f\u4ecd\u7136\u4e0d\u6ee1\u8db3\u8981\u6c42 \u4e0a\u8ff0\u60c5\u51b5\u90fd\u672a\u51fa\u73b0\uff0c\u5219\u8fd4\u56de \u5df2\u8bfb\u8ba1\u6570\u4e3a\u8d77\u59cb\u7684n\u4e2a\u5b57\u8282 \u548c \u8868\u793a\u672a\u53d1\u751f\u4efb\u4f55\u9519\u8bef\u7684 nil Peek\u65b9\u6cd5\u7684\u4e00\u4e2a\u7279\u70b9\uff0c\u5373\u4f7f\u5b83\u8bfb\u53d6\u4e86\u7f13\u51b2\u533a\u4e2d\u7684\u6570\u636e\uff0c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u5df2\u8bfb\u8ba1\u6570\u7684\u503c \u3002\u5176\u4ed6\u7684\u8bfb\u53d6\u65b9\u6cd5\u4e0d\u662f\u8fd9\u6837\u7684\u3002 func (b *Reader) Read(p []byte) (n int, err error) Read\uff1a\u628a\u7f13\u51b2\u533a\u4e2d\u7684\u672a\u8bfb\u5b57\u8282\uff0c\u4f9d\u6b21\u62f7\u8d1d\u5230\u5176\u53c2\u6570p\u4ee3\u8868\u7684\u5b57\u8282\u5207\u7247\u4e2d\uff0c\u5e76\u7acb\u5373\u6839\u636e\u5b9e\u9645\u62f7\u8d1d\u7684\u5b57\u8282\u6570\u589e\u52a0\u5df2\u8bfb\u8ba1\u6570\u7684\u503c\u3002 \u5728\u7f13\u51b2\u533a\u4e2d\u8fd8\u6709\u672a\u8bfb\u5b57\u8282\u7684\u60c5\u51b5\u4e0b\uff0cRead\u65b9\u6cd5\u662f\u8fd9\u6837\u505a\u7684\u3002\uff08\u5f53\u5df2\u8bfb\u8ba1\u6570\u7b49\u4e8e\u5df2\u5199\u8ba1\u6570\u65f6\uff0c\u8868\u793a\u6b64\u65f6\u7684\u7f13\u51b2\u533a\u4e2d\u6ca1\u6709\u4efb\u4f55\u672a\u8bfb\u7684\u5b57\u8282\uff09 \u5f53\u7f13\u51b2\u533a\u4e2d\u65e0\u672a\u8bfb\u5b57\u8282\u65f6\uff0cRead\u65b9\u6cd5\u4f1a\u5148\u68c0\u67e5\u53c2\u6570p\u7684\u957f\u5ea6\u662f\u5426\u5927\u4e8e\u6216\u7b49\u4e8e\u7f13\u51b2\u533a\u7684\u957f\u5ea6\u3002 \u5982\u679c\u662f\uff0cRead\u65b9\u6cd5\u653e\u5f03\u7f13\u51b2\u533a\u4e2d\u7684\u586b\u5145\u6570\u636e\uff0c\u76f4\u63a5\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u4e2d\u8bfb\u51fa\u6570\u636e\u5e76\u62f7\u8d1d\u5230p\u4e2d\uff0c\u8fd9\u610f\u5473\u7740\u5b83\u5b8c\u5168\u8de8\u8fc7\u4e86\u7f13\u51b2\u533a\uff0c\u5e76\u76f4\u8fde\u4e86\u6570\u636e\u4f9b\u9700\u7684\u53cc\u65b9\u3002 \u5982\u679c\u5426\uff0c\u4f1a\u5148\u628a\u5df2\u8bfb\u8ba1\u6570\u548c\u5df2\u5199\u8ba1\u6570\u90fd\u91cd\u7f6e\u4e3a0\uff0c\u7136\u540e\u518d\u5c1d\u8bd5\uff08\u53ea\u8fdb\u884c\u4e00\u6b21\uff09\u4f7f\u7528\u4ece\u5e95\u5c42\u8bfb\u53d6\u5668\u90a3\u91cc\u56de\u53bb\u7684\u6570\u636e\uff0c\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u4e00\u6b21\u4ece\u5934\u5230\u5c3e\u7684\u586b\u5145\u3002 func (b *Reader) ReadSlice(delim byte) (line []byte, err error) ReadSlice\uff1a\u6301\u7eed\u5730\u8bfb\u53d6\u6570\u636e\uff0c\u76f4\u5230\u9047\u5230\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u4e3a\u6b62\u3002 \u5148\u5728\u7f13\u51b2\u533a\u7684\u672a\u8bfb\u90e8\u5206\u4e2d\u5bfb\u627e\u5206\u9694\u7b26\uff0c\u5982\u679c\u672a\u627e\u5230\uff0c\u5e76\u4e14\u7f13\u51b2\u533a\u672a\u6ee1\uff0c\u90a3\u4e48\u8c03\u52a8fill\u65b9\u6cd5\u5bf9\u7f13\u51b2\u533a\u8fdb\u884c\u586b\u5145\uff0c\u7136\u540e\u518d\u6b21\u5bfb\u627e\uff0c\u5982\u6b64\u5f80\u590d\u3002 - \u5982\u679c\u5728\u586b\u5145\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u9519\u8bef\uff0c\u4f1a\u628a\u672a\u8bfb\u90e8\u5206\u4f5c\u4e3a\u7ed3\u679c\u8fd4\u56de\uff0c\u5e76\u8fd4\u56de\u76f8\u5e94\u7684\u9519\u8bef\u503c\u3002 - \u5982\u679c\u7f13\u51b2\u533a\u88ab\u586b\u6ee1\uff0c\u4ecd\u7136\u6ca1\u6709\u627e\u5230\u5206\u9694\u7b26\uff0c\u90a3\u4e48\u6574\u4e2a\u7f13\u51b2\u533a\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c\uff0c bufio.ErrBufferFull \uff08\u7f13\u51b2\u533a\u5df2\u6ee1\u7684\u9519\u8bef\uff09\u4f5c\u4e3a\u7b2c\u4e8c\u4e2a\u7ed3\u679c func (b *Reader) ReadBytes(delim byte) ([]byte, error) ReadBytes\uff1a\u6301\u7eed\u5730\u8bfb\u53d6\u6570\u636e\uff0c\u76f4\u5230\u9047\u5230\u8c03\u7528\u65b9\u7ed9\u5b9a\u7684\u5206\u9694\u7b26\u4e3a\u6b62\u3002 ReadBytes\u65b9\u6cd5\u4f9d\u8d56ReadSlice\u65b9\u6cd5\u3002 ReadLine\u65b9\u6cd5\u4f9d\u8d56ReadSlice\u65b9\u6cd5\u3002 ReadString\u65b9\u6cd5\u5b8c\u5168\u4f9d\u8d56ReadBytes\u65b9\u6cd5\uff0c\u53ea\u662f\u5728\u8fd4\u56de\u7684\u7ed3\u679c\u4e4b\u4e0a\u505a\u7b80\u5355\u7684\u7c7b\u578b\u8f6c\u6362\u3002 Peek\u3001ReadSlice\u3001ReadLine\u65b9\u6cd5\u90fd\u53ef\u80fd\u4f1a\u9020\u6210\u5185\u5bb9\u6cc4\u9732 \uff0c\u5728\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u5b83\u4eec\u90fd\u4f1a\u76f4\u63a5\u8fd4\u56de\u57fa\u4e8e\u7f13\u51b2\u533a\u7684\u5b57\u8282\u5207\u7247\uff0c\u8c03\u7528\u65b9\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u65b9\u6cd5\u7684\u7ed3\u679c\u503c\u8bbf\u95ee\u5230\u7f13\u51b2\u533a\u7684\u5176\u4ed6\u90e8\u5206\uff0c\u751a\u81f3\u4fee\u6539\u7f13\u51b2\u533a\u4e2d\u7684\u5185\u5bb9\uff0c\u8fd9\u662f\u975e\u5e38\u5371\u9669\u7684\u3002","title":"bufio.Reader\u7c7b\u578b\u7684\u8bfb\u53d6\u65b9\u6cd5"},{"location":"Language/Basic/25-os/","text":"os os\u5305\u63d0\u4f9b\u64cd\u63a7\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u7684\u80fd\u529b\uff0c\u90fd\u662f\u4e0e\u5e73\u53f0\u4e0d\u76f8\u5173\u7684API\u3002 \u5e73\u53f0\u4e0d\u76f8\u5173API\uff1a\u8fd9\u4e9bAPI\u57fa\u4e8e\uff08\u6216\u8005\u8bf4\u62bd\u8c61\u81ea\uff09\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e3a\u6211\u4eec\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u529f\u80fd\u63d0\u4f9b\u9ad8\u5c42\u6b21\u7684\u652f\u6301\uff0c\u4f46\u662f\uff0c\u5b83\u4eec\u5e76\u4e0d\u4f9d\u8d56\u4e8e\u5177\u4f53\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 \u4e0d\u8bba\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\uff0cos\u5305\u90fd\u63d0\u4f9b\u7edf\u4e00\u7684\u4f7f\u7528\u63a5\u53e3\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u5f0f\uff0c\u6765\u64cd\u7eb5\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u5f97\u5230\u76f8\u4f3c\u7684\u7ed3\u679c\u3002\u5176\u4e2d\u7684API\u5e2e\u52a9\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\uff1a \u6587\u4ef6\u7cfb\u7edf\uff1a\u64cd\u4f5c\u6587\u4ef6\u7cfb\u7edf\u7684API\u6700\u4e30\u5bcc os.File \u6570\u636e\u7c7b\u578b\uff0c\u4ee3\u8868\u4e86\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\uff08\u5bf9\u4e8eUnix\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e07\u7269\u7686\u6587\u4ef6\uff09\uff0c\u9664\u4e86\u5e38\u89c1\u7684\u6587\u672c\u6587\u4ef6\u3001\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u538b\u7f29\u6587\u4ef6\u3001\u76ee\u5f55\u7b49\uff0c\u8fd8\u6709\u7b26\u53f7\u94fe\u63a5\u3001\u5404\u79cd\u7269\u7406\u8bbe\u5907\uff08\u5185\u7f6e\u6216\u5916\u754c\u7684\u9762\u5411\u5757\u6216\u8005\u5b57\u7b26\u7684\u8bbe\u5907\uff09\u3001\u547d\u540d\u7ba1\u9053\u3001\u5957\u63a5\u5b57\uff08socket\uff09\u7b49\u3002 \u6743\u9650\u7cfb\u7edf \u73af\u5883\u53d8\u91cf \u7cfb\u7edf\u8fdb\u7a0b \u7cfb\u7edf\u4fe1\u53f7 os.File \u7c7b\u578b\u5b9e\u73b0\u4e86\u54ea\u4e9bio\u5305\u7684\u63a5\u53e3 os.File \u7c7b\u578b\u62e5\u6709\u7684\u90fd\u662f\u6307\u9488\u65b9\u6cd5\uff0c\u6240\u4ee5\u9664\u4e86\u7a7a\u63a5\u53e3\uff0c\u5b83\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u63a5\u53e3\uff0c\u5b83\u7684\u6307\u9488\u7c7b\u578b\u5b9e\u73b0\u4e86\u5f88\u591aio\u5305\u4e2d\u7684\u63a5\u53e3\u3002 *os.File \u7c7b\u578b\u5b9e\u73b0\u4e86 io.Reader \u3001 io.Writer \u3001 io.Closer \u3001 io.ReadAt \u3001 io.Seeker \u3001 io.WriterAt \u3002\u6ca1\u6709\u5b9e\u73b0 io.ByteReader \u548c io.RuneReader \u3002 os.File \u7c7b\u578b\u4ee5\u4f55\u79cd\u65b9\u5f0f\u64cd\u4f5c\u6587\u4ef6 \u83b7\u53d6 os.File \u7c7b\u578b\u7684\u6307\u9488\u503c\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u6267\u884c\u540c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u5e76\u4e14\u5728\u6210\u529f\u4e4b\u540e\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4f1a\u88ab\u5b58\u50a8\u5728\u5b83\u4eec\u8fd4\u56de\u7684File\u503c\u4e2d\uff1a func Create(name string) (*File, error) Create\uff1a\u6839\u636e\u7ed9\u5b9a\u7684\u8def\u5f84\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u8fd4\u56de\u4e00\u4e2aFile\u503c\u548c\u4e00\u4e2a\u9519\u8bef\u503c\uff08\u53ef\u80fd\u4e3a\u975enil\u7684\u9519\u8bef\u503c\uff09\uff0c\u5bf9\u8be5\u51fd\u6570\u8fd4\u56de\u7684File\u503c\u5bf9\u5e94\u7684\u6587\u4ef6\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002 \u8be5\u51fd\u6570\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7684\u6240\u6709\u7528\u6237\u90fd\u662f\u53ef\u8bfb\u5199\u7684 \u5982\u679c\u51fd\u6570\u7684\u8def\u5f84\u4e0a\u5df2\u7ecf\u5b58\u5728\u4e86\u4e00\u4e2a\u6587\u4ef6\uff0c\u90a3\u4e48\u4f1a\u6e05\u7a7a\u6587\u4ef6\u4e2d\u5168\u90e8\u7684\u5185\u5bb9\uff0c\u7136\u540e\u628a\u5b83\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c\u503c\u8fd4\u56de func NewFile(fd uintptr, name string) *File NewFile\uff1a\u5728\u88ab\u8c03\u7528\u65f6\uff0c\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u4ee3\u8868\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684uintptr\u7c7b\u578b\u7684\u503c\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u540d\u7684\u5b57\u7b26\u4e32\u503c \u5982\u679c\u7ed9\u5b9a\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5e76\u4e0d\u6709\u6548\uff0c\u90a3\u4e48\u51fd\u6570\u4f1a\u8fd4\u56denil \u5426\u5219\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868\u6587\u4ef6\u7684File\u503c \u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u5e76\u4e0d\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u800c\u662f\u4f9d\u636e\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u7684\u63cf\u8ff0\u7b26\uff0c\u6765\u521b\u5efa\u4e00\u4e2a\u5305\u88c5\u4e86\u8be5\u6587\u4ef6\u7684File\u503c \u3002\u5982\u4e0b\u6240\u793a\uff0c\u83b7\u53d6\u4e00\u4e2a\u5305\u88c5\u4e86\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u7684File\u503c,\u7136\u540e\u901a\u8fc7\u8fd9\u4e2aFile\u503c\u5411\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e2d\u5199\u5165\u4e00\u4e9b\u5185\u5bb9\uff1a go file3 := os.NewFile(uintptr(syscall.Stderr), \"/dev/stderr\") if file3 != nil { defer file3.Close() file3.WriteString(\"The Go language program writes the contents into stderr.\\n\") } func Open(name string) (*File, error) Open\uff1a\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u8fd4\u56de\u5305\u88c5\u4e86\u8be5\u6587\u4ef6\u7684File\u503c\u3002\u8be5\u51fd\u6570\u53ea\u80fd\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u53ea\u80fd\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4e0d\u80fd\u5199\u5165\u5185\u5bb9\u3002\u5982\u679c\u8c03\u7528\u8fd9\u4e2aFile\u503c\u7684\u4efb\u4f55\u5199\u5165\u65b9\u6cd5\uff0c\u90fd\u4f1a\u5f97\u5230\u201c\u574f\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u201d\u7684\u9519\u8bef\u503c\u3002\u8fd9\u4e2a\u53ea\u8bfb\u6a21\u5f0f\u5e94\u7528\u4e0eFile\u503c\u6240\u6301\u6709\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u662f\u53c8\u901a\u5e38\u5f88\u5c0f\u7684\u975e\u8d1f\u6574\u6570\u4ee3\u8868\u7684\uff0c\u5b83\u4e00\u822c\u4f1a\u7531I/O\u76f8\u5173\u7684\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\uff0c\u5e76\u4f5c\u4e3a\u67d0\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6807\u8bc6\u5b58\u5728\u3002 \u4ece\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u770b\uff0c\u9488\u5bf9\u4efb\u4f55\u6587\u4ef6\u7684I/O\u64cd\u4f5c\u90fd\u9700\u8981\u7528\u5230\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u53ea\u4e0d\u8fc7Golang\u4e2d\u7684\u4e00\u4e9b\u6570\u636e\u7c7b\u578b\uff0c\u6211\u4eec\u9690\u85cf\u6389\u4e86\u8fd9\u4e2a\u63cf\u8ff0\u7b26\uff0c\u5982\u6b64\u4e00\u6765\uff0c\u5c31\u4e0d\u9700\u8981\u65f6\u523b\u5173\u6ce8\u548c\u8fa8\u522b\u5b83\uff0c\u5982 os.File \u7c7b\u578b\u3002 os.File \u7c7b\u578b\u6709\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5\uff0c\u53ebFd\uff0c\u5b83\u5728\u88ab\u8c03\u7528\u4e4b\u540e\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2auintptr\u7c7b\u578b\u7684\u503c\uff0c\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e86\u5f53\u524dFile\u503c\u6240\u6301\u6709\u7684\u90a3\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u5728os\u5305\u4e2d\uff0c\u53ea\u6709NewFile\u51fd\u6570\u9700\u8981\u7528\u5230\u5b83\uff0c\u5b83\u4e5f\u6ca1\u6709\u522b\u7684\u7528\u6b66\u4e4b\u5730\uff0c\u5982\u679c\u53ea\u662f\u64cd\u4f5c\u5e38\u89c4\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u65e0\u9700\u7279\u522b\u6ce8\u610f\u5b83\u3002 func OpenFile(name string, flag int, perm FileMode) (*File, error) OpenFile\uff1a\u8fd9\u4e2a\u51fd\u6570\u662f os.Create \u548c os.Open \u51fd\u6570\u7684\u5e95\u5c42\u652f\u6301\uff0c\u5b83\u6700\u4e3a\u7075\u6d3b\u3002 \u8fd9\u4e2a\u51fd\u6570\u7684\u4e09\u4e2a\u53c2\u6570\uff1a name\uff1a\u8868\u793a\u6587\u4ef6\u7684\u8def\u5f84 flag\uff1a\u9700\u8981\u65bd\u52a0\u5728\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u4e0a\u7684\u6a21\u5f0f\uff08\u5982\uff0c\u53ea\u8bfb\u6a21\u5f0f os.O_RDONLY \uff0c\u5b83\u662fint\u7c7b\u578b\u7684\uff09\uff0c\u79f0\u4e3a\u64cd\u4f5c\u6a21\u5f0f\uff0c\u9650\u5b9a\u64cd\u4f5c\u6587\u4ef6\u7684\u65b9\u5f0f perm\uff1a\u4e5f\u662f\u6a21\u5f0f\uff0c\u5b83\u7684\u7c7b\u578b\u662f os.FileMode \uff08\u6b64\u7c7b\u578b\u662f\u4e00\u4e2a\u57fa\u4e8eunit32\u7c7b\u578b\u7684\u518d\u5b9a\u4e49\u7c7b\u578b\uff09\uff0c\u79f0\u4e3a\u6743\u9650\u6a21\u5f0f\uff0c\u63a7\u5236\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650 \u901a\u8fc7 os.File \u7c7b\u578b\u7684\u503c\uff0c\u6211\u4eec\u4e0d\u4f46\u53ef\u4ee5\u5bf9\u6587\u4ef6\u8fdb\u884c\u8bfb\u53d6\u3001\u5199\u5165\u3001\u5173\u95ed\u7b49\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u5b9a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u6216\u5199\u5165\u662f\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\u3002os\u5305\u4e2d\uff1a \u7528\u4e8e\u5e38\u89c1\u6743\u9650\u6587\u4ef6\u7684Create\u51fd\u6570 \u7528\u6237\u5305\u88c5\u73b0\u5b58\u6587\u4ef6\u7684NewFile\u51fd\u6570 \u7528\u4ee5\u6253\u5f00\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u7684Open\u51fd\u6570\u548cOpenFile\u51fd\u6570 File\u7684\u64cd\u4f5c\u6a21\u5f0f \u9488\u5bf9File\u503c\u7684\u64cd\u4f5c\u6a21\u5f0f\u4e3b\u8981\u6709\uff1a \u53ea\u8bfb\u6a21\u5f0f\uff1a os.O_RDONLY \u53ea\u5199\u6a21\u5f0f\uff1a os.O_WRONLY \u8bfb\u5199\u6a21\u5f0f\uff1a os.O_RDWR \u5728\u6211\u4eec\u65b0\u5efa\u6216\u8005\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u628a\u8fd9\u4e09\u79cd\u6a21\u5f0f\u4e2d\u7684\u4e00\u4e2a\u8bbe\u5b9a\u4e3a\u6b64\u6587\u4ef6\u7684\u64cd\u4f5c\u6a21\u5f0f\u3002 \u8fd8\u53ef\u4ee5\u4e3a\u6587\u4ef6\u8bbe\u7f6e\u989d\u5916\u7684\u64cd\u4f5c\u6a21\u5f0f\uff1a os.O_APPEND \uff1a\u5f53\u5411\u6587\u4ef6\u4e2d\u5199\u5165\u5185\u5bb9\u65f6\uff0c\u628a\u65b0\u5185\u5bb9\u8ffd\u52a0\u5230\u73b0\u6709\u5185\u5bb9\u7684\u540e\u8fb9 os.O_CREATE \uff1a\u5f53\u7ed9\u5b9a\u8def\u5f84\u4e0a\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\u65f6\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6 os.O_EXCL \uff1a\u9700\u8981\u4e0e os.O_CREATE \u4e00\u540c\u4f7f\u7528\uff0c\u8868\u793a\u5728\u7ed9\u5b9a\u8def\u5f84\u4e0a\u4e0d\u80fd\u6709\u5df2\u5b58\u5728\u7684\u6587\u4ef6 os.O_SYNC \uff1a\u5728\u6253\u5f00\u7684\u6587\u4ef6\u4e4b\u4e0a\u5b9e\u65bd\u540c\u6b65I/O\uff0c\u5b83\u4f1a\u4fdd\u8bc1\u8bfb\u5199\u7684\u5185\u5bb9\u603b\u4f1a\u4e0e\u786c\u76d8\u4e0a\u7684\u6570\u636e\u4fdd\u6301\u540c\u6b65 os.O_TRUNC \uff1a\u5982\u679c\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u5e76\u4e14\u662f\u5e38\u89c4\u6587\u4ef6\uff0c\u90a3\u4e48\u5c31\u5148\u60c5\u51b5\u5176\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u4efb\u4f55\u5185\u5bb9 \u4f8b\u5b50 // Create\u51fd\u6570 func Create(name string) (*File, error) { return OpenFile(name, O_RDWR|O_CREATE|O_TRUNC, 0666) // \u7ed9\u4e88\u7684\u64cd\u4f5c\u6a21\u5f0f\u662f O_RDWR|O_CREATE|O_TRUNC\u7684\u7ec4\u5408 // \u5982\u679c\u53c2\u6570name\u4ee3\u8868\u7684\u8def\u5f84\u4e4b\u4e0a\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\u90a3\u4e48\u5c31\u4f1a\u65b0\u5efa\u4e00\u4e2a // \u5426\u5219\u5148\u60c5\u51b5\u73b0\u5b58\u6587\u4ef6\u4e2d\u7684\u5168\u90e8\u5185\u5bb9 // \u8fd4\u56de\u7684File\u503c\u7684\u8bfb\u65b9\u6cd5\u548c\u5199\u65b9\u6cd5\u90fd\u80fd\u53ef\u7528 } // Open\u51fd\u6570 // \u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u5df2\u5b58\u5728\u7684\u6587\u4ef6 func open(name string)(*File, error){ return OpenFile(name, O_REONLY, 0) } \u6ce8\u610f\uff0c\u591a\u4e2a\u64cd\u4f5c\u6a21\u5f0f\u901a\u8fc7\u6849\u4f4d\u6216\u64cd\u4f5c\u7b26\u7ec4\u5408\u8d77\u6765 \u3002 File\u7684\u6743\u9650\u6a21\u5f0f os.FileMode \u7c7b\u578b\u4e0d\u4f46\u53ef\u4ee5\u4ee3\u8868\u6743\u9650\u6a21\u5f0f\uff0c\u8fd8\u80fd\u4ee3\u8868\u6587\u4ef6\u6a21\u5f0f\uff08\u5373\uff0c\u6587\u4ef6\u79cd\u7c7b\uff09\u3002 os.FileMode \u662f\u57fa\u4e8euint32\u7c7b\u578b\u7684\u5728\u5b9a\u4e49\u7c7b\u578b\uff0c\u6240\u4ee5\u5b83\u7684\u6bcf\u4e2a\u503c\u90fd\u5305\u542b\u4e8632\u4e2a\u6bd4\u7279\u4f4d\uff0c\u6bcf\u4e2a\u6bd4\u7279\u4f4d\u90fd\u6709\u7279\u5b9a\u7684\u542b\u4e49\u3002 \u5728\u4e00\u4e2a os.FileMode \u7c7b\u578b\u503c\u4e2d\uff0c\u53ea\u6709\u6700\u4f4e\u76849\u4e2a\u6bd4\u7279\u4f4d\u624d\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u6743\u9650\uff083\u4e2a\u4e00\u7ec4\uff0c\u5171\u5206\u4e3a3\u7ec4\uff09\uff0c\u5f53\u6211\u4eec\u62ff\u5230\u4e00\u4e2a\u6b64\u7c7b\u578b\u7684\u503c\u65f6\uff0c\u53ef\u4ee5\u628a\u5b83\u548c os.ModePerm \u5e38\u91cf\u7684\u503c\u505a\u6309\u4f4d\u4e0e\u64cd\u4f5c\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230FileMode\u4e2d\u6240\u6709\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u6743\u9650\u7684\u6bd4\u7279\u4f4d\uff0c\u5373\u6743\u9650\u6a21\u5f0f\u3002 \u4f8b\u5982\uff0c\u5e38\u91cf0777\uff0c\u662f\u4e00\u4e2a\u516b\u8fdb\u5236\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5b83\u7684\u6700\u4f4e9\u4e2a\u6bd4\u7279\u4f4d\u90fd\u662f1\uff0c\u66f4\u9ad8\u768423\u4e2a\u6bd4\u7279\u4f4d\u90fd\u662f0. \u6700\u9ad8\u6bd4\u7279\u4f4d\u4e3a1\uff0c\u8be5\u503c\u7684\u6587\u4ef6\u6a21\u5f0f\u7b49\u540c\u4e8e os.ModeDir \uff0c\u4ee3\u8868\u4e00\u4e2a\u76ee\u5f55 \u7b2c26\u4e2a\u6bd4\u7279\u4f4d\u4e3a1\uff0c\u544a\u77e5\u7684\u6587\u4ef6\u6a21\u5f0f\u7b49\u540c\u4e8e os.ModeNamedPipe \uff0c\u4ee3\u8868\u4e00\u4e2a\u547d\u540d\u7ba1\u9053 \u4ece\u9ad8\u5230\u5e95\uff0c\u8fd93\u7ec4\u5206\u522b\uff1a \u8868\u793a\u6587\u4ef6\u6240\u6709\u8005\uff08\u521b\u5efa\u6587\u4ef6\u7684\u7528\u6237\uff09 \u6587\u4ef6\u6240\u6709\u8005\u6240\u5c5e\u7684\u7528\u6237\u7ec4 \u5176\u4ed6\u7528\u6237\u5bf9\u8be5\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650 \u6bcf\u7ec4\u4e2d\u76843\u4e2a\u6bd4\u7279\u4f4d\u4ece\u9ad8\u5230\u5e95\u5206\u522b\u8868\u793a\uff1a \u8bfb\u6743\u9650 \u5199\u6743\u9650 \u6267\u884c\u6743\u9650 \u5982\u679c\u5728\u5176\u4e2d\u7684\u67d0\u4e2a\u6bd4\u7279\u4f4d\u4e0a\u7684\u662f1\uff0c\u5c31\u610f\u5473\u7740\u76f8\u5e94\u7684\u6743\u9650\u5f00\u542f\uff0c\u5426\u5219\uff0c\u5c31\u6807\u4e66\u76f8\u5e94\u7684\u6743\u9650\u5173\u95ed\u3002 \u5728\u8c03\u7528 os.OpenFile \u51fd\u6570\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u7684\u8bf4\u660e\u8bbe\u7f6e\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u53ea\u6709\u5728\u65b0\u5efa\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u8fd9\u91cc\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u624d\u662f\u6709\u6548\u7684\uff0c\u5728\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u6b64\u53c2\u6570\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u76ee\u6807\u6587\u4ef6\u4ea7\u751f\u4efb\u4f55\u7684\u5f71\u54cd\u3002","title":"os"},{"location":"Language/Basic/25-os/#os","text":"os\u5305\u63d0\u4f9b\u64cd\u63a7\u8ba1\u7b97\u673a\u64cd\u4f5c\u7cfb\u7edf\u7684\u80fd\u529b\uff0c\u90fd\u662f\u4e0e\u5e73\u53f0\u4e0d\u76f8\u5173\u7684API\u3002 \u5e73\u53f0\u4e0d\u76f8\u5173API\uff1a\u8fd9\u4e9bAPI\u57fa\u4e8e\uff08\u6216\u8005\u8bf4\u62bd\u8c61\u81ea\uff09\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e3a\u6211\u4eec\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u529f\u80fd\u63d0\u4f9b\u9ad8\u5c42\u6b21\u7684\u652f\u6301\uff0c\u4f46\u662f\uff0c\u5b83\u4eec\u5e76\u4e0d\u4f9d\u8d56\u4e8e\u5177\u4f53\u7684\u64cd\u4f5c\u7cfb\u7edf\u3002 \u4e0d\u8bba\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\uff0cos\u5305\u90fd\u63d0\u4f9b\u7edf\u4e00\u7684\u4f7f\u7528\u63a5\u53e3\uff0c\u4f7f\u5f97\u6211\u4eec\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u5f0f\uff0c\u6765\u64cd\u7eb5\u4e0d\u540c\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u5e76\u5f97\u5230\u76f8\u4f3c\u7684\u7ed3\u679c\u3002\u5176\u4e2d\u7684API\u5e2e\u52a9\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\uff1a \u6587\u4ef6\u7cfb\u7edf\uff1a\u64cd\u4f5c\u6587\u4ef6\u7cfb\u7edf\u7684API\u6700\u4e30\u5bcc os.File \u6570\u636e\u7c7b\u578b\uff0c\u4ee3\u8868\u4e86\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\uff08\u5bf9\u4e8eUnix\u64cd\u4f5c\u7cfb\u7edf\uff0c\u4e07\u7269\u7686\u6587\u4ef6\uff09\uff0c\u9664\u4e86\u5e38\u89c1\u7684\u6587\u672c\u6587\u4ef6\u3001\u4e8c\u8fdb\u5236\u6587\u4ef6\u3001\u538b\u7f29\u6587\u4ef6\u3001\u76ee\u5f55\u7b49\uff0c\u8fd8\u6709\u7b26\u53f7\u94fe\u63a5\u3001\u5404\u79cd\u7269\u7406\u8bbe\u5907\uff08\u5185\u7f6e\u6216\u5916\u754c\u7684\u9762\u5411\u5757\u6216\u8005\u5b57\u7b26\u7684\u8bbe\u5907\uff09\u3001\u547d\u540d\u7ba1\u9053\u3001\u5957\u63a5\u5b57\uff08socket\uff09\u7b49\u3002 \u6743\u9650\u7cfb\u7edf \u73af\u5883\u53d8\u91cf \u7cfb\u7edf\u8fdb\u7a0b \u7cfb\u7edf\u4fe1\u53f7","title":"os"},{"location":"Language/Basic/25-os/#osfileio","text":"os.File \u7c7b\u578b\u62e5\u6709\u7684\u90fd\u662f\u6307\u9488\u65b9\u6cd5\uff0c\u6240\u4ee5\u9664\u4e86\u7a7a\u63a5\u53e3\uff0c\u5b83\u672c\u8eab\u6ca1\u6709\u4efb\u4f55\u63a5\u53e3\uff0c\u5b83\u7684\u6307\u9488\u7c7b\u578b\u5b9e\u73b0\u4e86\u5f88\u591aio\u5305\u4e2d\u7684\u63a5\u53e3\u3002 *os.File \u7c7b\u578b\u5b9e\u73b0\u4e86 io.Reader \u3001 io.Writer \u3001 io.Closer \u3001 io.ReadAt \u3001 io.Seeker \u3001 io.WriterAt \u3002\u6ca1\u6709\u5b9e\u73b0 io.ByteReader \u548c io.RuneReader \u3002","title":"os.File\u7c7b\u578b\u5b9e\u73b0\u4e86\u54ea\u4e9bio\u5305\u7684\u63a5\u53e3"},{"location":"Language/Basic/25-os/#osfile","text":"\u83b7\u53d6 os.File \u7c7b\u578b\u7684\u6307\u9488\u503c\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u90fd\u6267\u884c\u540c\u4e00\u4e2a\u7cfb\u7edf\u8c03\u7528\uff0c\u5e76\u4e14\u5728\u6210\u529f\u4e4b\u540e\u5f97\u5230\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u4f1a\u88ab\u5b58\u50a8\u5728\u5b83\u4eec\u8fd4\u56de\u7684File\u503c\u4e2d\uff1a func Create(name string) (*File, error) Create\uff1a\u6839\u636e\u7ed9\u5b9a\u7684\u8def\u5f84\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u8fd4\u56de\u4e00\u4e2aFile\u503c\u548c\u4e00\u4e2a\u9519\u8bef\u503c\uff08\u53ef\u80fd\u4e3a\u975enil\u7684\u9519\u8bef\u503c\uff09\uff0c\u5bf9\u8be5\u51fd\u6570\u8fd4\u56de\u7684File\u503c\u5bf9\u5e94\u7684\u6587\u4ef6\u8fdb\u884c\u8bfb\u5199\u64cd\u4f5c\u3002 \u8be5\u51fd\u6570\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u5bf9\u64cd\u4f5c\u7cfb\u7edf\u7684\u6240\u6709\u7528\u6237\u90fd\u662f\u53ef\u8bfb\u5199\u7684 \u5982\u679c\u51fd\u6570\u7684\u8def\u5f84\u4e0a\u5df2\u7ecf\u5b58\u5728\u4e86\u4e00\u4e2a\u6587\u4ef6\uff0c\u90a3\u4e48\u4f1a\u6e05\u7a7a\u6587\u4ef6\u4e2d\u5168\u90e8\u7684\u5185\u5bb9\uff0c\u7136\u540e\u628a\u5b83\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u7ed3\u679c\u503c\u8fd4\u56de func NewFile(fd uintptr, name string) *File NewFile\uff1a\u5728\u88ab\u8c03\u7528\u65f6\uff0c\u9700\u8981\u63a5\u53d7\u4e00\u4e2a\u4ee3\u8868\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684uintptr\u7c7b\u578b\u7684\u503c\uff0c\u4ee5\u53ca\u4e00\u4e2a\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u540d\u7684\u5b57\u7b26\u4e32\u503c \u5982\u679c\u7ed9\u5b9a\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5e76\u4e0d\u6709\u6548\uff0c\u90a3\u4e48\u51fd\u6570\u4f1a\u8fd4\u56denil \u5426\u5219\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868\u6587\u4ef6\u7684File\u503c \u8fd9\u4e2a\u51fd\u6570\u7684\u529f\u80fd\u5e76\u4e0d\u662f\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\uff0c\u800c\u662f\u4f9d\u636e\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u7684\u63cf\u8ff0\u7b26\uff0c\u6765\u521b\u5efa\u4e00\u4e2a\u5305\u88c5\u4e86\u8be5\u6587\u4ef6\u7684File\u503c \u3002\u5982\u4e0b\u6240\u793a\uff0c\u83b7\u53d6\u4e00\u4e2a\u5305\u88c5\u4e86\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u7684File\u503c,\u7136\u540e\u901a\u8fc7\u8fd9\u4e2aFile\u503c\u5411\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e2d\u5199\u5165\u4e00\u4e9b\u5185\u5bb9\uff1a go file3 := os.NewFile(uintptr(syscall.Stderr), \"/dev/stderr\") if file3 != nil { defer file3.Close() file3.WriteString(\"The Go language program writes the contents into stderr.\\n\") } func Open(name string) (*File, error) Open\uff1a\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\uff0c\u5e76\u8fd4\u56de\u5305\u88c5\u4e86\u8be5\u6587\u4ef6\u7684File\u503c\u3002\u8be5\u51fd\u6570\u53ea\u80fd\u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u53ea\u80fd\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4e0d\u80fd\u5199\u5165\u5185\u5bb9\u3002\u5982\u679c\u8c03\u7528\u8fd9\u4e2aFile\u503c\u7684\u4efb\u4f55\u5199\u5165\u65b9\u6cd5\uff0c\u90fd\u4f1a\u5f97\u5230\u201c\u574f\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u201d\u7684\u9519\u8bef\u503c\u3002\u8fd9\u4e2a\u53ea\u8bfb\u6a21\u5f0f\u5e94\u7528\u4e0eFile\u503c\u6240\u6301\u6709\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e0a\u3002 \u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u662f\u53c8\u901a\u5e38\u5f88\u5c0f\u7684\u975e\u8d1f\u6574\u6570\u4ee3\u8868\u7684\uff0c\u5b83\u4e00\u822c\u4f1a\u7531I/O\u76f8\u5173\u7684\u7cfb\u7edf\u8c03\u7528\u8fd4\u56de\uff0c\u5e76\u4f5c\u4e3a\u67d0\u4e2a\u6587\u4ef6\u7684\u4e00\u4e2a\u6807\u8bc6\u5b58\u5728\u3002 \u4ece\u64cd\u4f5c\u7cfb\u7edf\u5c42\u9762\u770b\uff0c\u9488\u5bf9\u4efb\u4f55\u6587\u4ef6\u7684I/O\u64cd\u4f5c\u90fd\u9700\u8981\u7528\u5230\u8fd9\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u53ea\u4e0d\u8fc7Golang\u4e2d\u7684\u4e00\u4e9b\u6570\u636e\u7c7b\u578b\uff0c\u6211\u4eec\u9690\u85cf\u6389\u4e86\u8fd9\u4e2a\u63cf\u8ff0\u7b26\uff0c\u5982\u6b64\u4e00\u6765\uff0c\u5c31\u4e0d\u9700\u8981\u65f6\u523b\u5173\u6ce8\u548c\u8fa8\u522b\u5b83\uff0c\u5982 os.File \u7c7b\u578b\u3002 os.File \u7c7b\u578b\u6709\u4e00\u4e2a\u6307\u9488\u65b9\u6cd5\uff0c\u53ebFd\uff0c\u5b83\u5728\u88ab\u8c03\u7528\u4e4b\u540e\u5c06\u4f1a\u8fd4\u56de\u4e00\u4e2auintptr\u7c7b\u578b\u7684\u503c\uff0c\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e86\u5f53\u524dFile\u503c\u6240\u6301\u6709\u7684\u90a3\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u5728os\u5305\u4e2d\uff0c\u53ea\u6709NewFile\u51fd\u6570\u9700\u8981\u7528\u5230\u5b83\uff0c\u5b83\u4e5f\u6ca1\u6709\u522b\u7684\u7528\u6b66\u4e4b\u5730\uff0c\u5982\u679c\u53ea\u662f\u64cd\u4f5c\u5e38\u89c4\u6587\u4ef6\u548c\u76ee\u5f55\uff0c\u65e0\u9700\u7279\u522b\u6ce8\u610f\u5b83\u3002 func OpenFile(name string, flag int, perm FileMode) (*File, error) OpenFile\uff1a\u8fd9\u4e2a\u51fd\u6570\u662f os.Create \u548c os.Open \u51fd\u6570\u7684\u5e95\u5c42\u652f\u6301\uff0c\u5b83\u6700\u4e3a\u7075\u6d3b\u3002 \u8fd9\u4e2a\u51fd\u6570\u7684\u4e09\u4e2a\u53c2\u6570\uff1a name\uff1a\u8868\u793a\u6587\u4ef6\u7684\u8def\u5f84 flag\uff1a\u9700\u8981\u65bd\u52a0\u5728\u6587\u4ef6\u63cf\u8ff0\u7b26\u4e4b\u4e0a\u7684\u6a21\u5f0f\uff08\u5982\uff0c\u53ea\u8bfb\u6a21\u5f0f os.O_RDONLY \uff0c\u5b83\u662fint\u7c7b\u578b\u7684\uff09\uff0c\u79f0\u4e3a\u64cd\u4f5c\u6a21\u5f0f\uff0c\u9650\u5b9a\u64cd\u4f5c\u6587\u4ef6\u7684\u65b9\u5f0f perm\uff1a\u4e5f\u662f\u6a21\u5f0f\uff0c\u5b83\u7684\u7c7b\u578b\u662f os.FileMode \uff08\u6b64\u7c7b\u578b\u662f\u4e00\u4e2a\u57fa\u4e8eunit32\u7c7b\u578b\u7684\u518d\u5b9a\u4e49\u7c7b\u578b\uff09\uff0c\u79f0\u4e3a\u6743\u9650\u6a21\u5f0f\uff0c\u63a7\u5236\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650 \u901a\u8fc7 os.File \u7c7b\u578b\u7684\u503c\uff0c\u6211\u4eec\u4e0d\u4f46\u53ef\u4ee5\u5bf9\u6587\u4ef6\u8fdb\u884c\u8bfb\u53d6\u3001\u5199\u5165\u3001\u5173\u95ed\u7b49\u64cd\u4f5c\uff0c\u8fd8\u53ef\u4ee5\u8bbe\u5b9a\u4e0b\u4e00\u6b21\u8bfb\u53d6\u6216\u5199\u5165\u662f\u7684\u8d77\u59cb\u7d22\u5f15\u4f4d\u7f6e\u3002os\u5305\u4e2d\uff1a \u7528\u4e8e\u5e38\u89c1\u6743\u9650\u6587\u4ef6\u7684Create\u51fd\u6570 \u7528\u6237\u5305\u88c5\u73b0\u5b58\u6587\u4ef6\u7684NewFile\u51fd\u6570 \u7528\u4ee5\u6253\u5f00\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u7684Open\u51fd\u6570\u548cOpenFile\u51fd\u6570","title":"os.File\u7c7b\u578b\u4ee5\u4f55\u79cd\u65b9\u5f0f\u64cd\u4f5c\u6587\u4ef6"},{"location":"Language/Basic/25-os/#file","text":"\u9488\u5bf9File\u503c\u7684\u64cd\u4f5c\u6a21\u5f0f\u4e3b\u8981\u6709\uff1a \u53ea\u8bfb\u6a21\u5f0f\uff1a os.O_RDONLY \u53ea\u5199\u6a21\u5f0f\uff1a os.O_WRONLY \u8bfb\u5199\u6a21\u5f0f\uff1a os.O_RDWR \u5728\u6211\u4eec\u65b0\u5efa\u6216\u8005\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u5fc5\u987b\u628a\u8fd9\u4e09\u79cd\u6a21\u5f0f\u4e2d\u7684\u4e00\u4e2a\u8bbe\u5b9a\u4e3a\u6b64\u6587\u4ef6\u7684\u64cd\u4f5c\u6a21\u5f0f\u3002 \u8fd8\u53ef\u4ee5\u4e3a\u6587\u4ef6\u8bbe\u7f6e\u989d\u5916\u7684\u64cd\u4f5c\u6a21\u5f0f\uff1a os.O_APPEND \uff1a\u5f53\u5411\u6587\u4ef6\u4e2d\u5199\u5165\u5185\u5bb9\u65f6\uff0c\u628a\u65b0\u5185\u5bb9\u8ffd\u52a0\u5230\u73b0\u6709\u5185\u5bb9\u7684\u540e\u8fb9 os.O_CREATE \uff1a\u5f53\u7ed9\u5b9a\u8def\u5f84\u4e0a\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\u65f6\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6 os.O_EXCL \uff1a\u9700\u8981\u4e0e os.O_CREATE \u4e00\u540c\u4f7f\u7528\uff0c\u8868\u793a\u5728\u7ed9\u5b9a\u8def\u5f84\u4e0a\u4e0d\u80fd\u6709\u5df2\u5b58\u5728\u7684\u6587\u4ef6 os.O_SYNC \uff1a\u5728\u6253\u5f00\u7684\u6587\u4ef6\u4e4b\u4e0a\u5b9e\u65bd\u540c\u6b65I/O\uff0c\u5b83\u4f1a\u4fdd\u8bc1\u8bfb\u5199\u7684\u5185\u5bb9\u603b\u4f1a\u4e0e\u786c\u76d8\u4e0a\u7684\u6570\u636e\u4fdd\u6301\u540c\u6b65 os.O_TRUNC \uff1a\u5982\u679c\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u5e76\u4e14\u662f\u5e38\u89c4\u6587\u4ef6\uff0c\u90a3\u4e48\u5c31\u5148\u60c5\u51b5\u5176\u4e2d\u5df2\u7ecf\u5b58\u5728\u7684\u4efb\u4f55\u5185\u5bb9","title":"File\u7684\u64cd\u4f5c\u6a21\u5f0f"},{"location":"Language/Basic/25-os/#_1","text":"// Create\u51fd\u6570 func Create(name string) (*File, error) { return OpenFile(name, O_RDWR|O_CREATE|O_TRUNC, 0666) // \u7ed9\u4e88\u7684\u64cd\u4f5c\u6a21\u5f0f\u662f O_RDWR|O_CREATE|O_TRUNC\u7684\u7ec4\u5408 // \u5982\u679c\u53c2\u6570name\u4ee3\u8868\u7684\u8def\u5f84\u4e4b\u4e0a\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\u90a3\u4e48\u5c31\u4f1a\u65b0\u5efa\u4e00\u4e2a // \u5426\u5219\u5148\u60c5\u51b5\u73b0\u5b58\u6587\u4ef6\u4e2d\u7684\u5168\u90e8\u5185\u5bb9 // \u8fd4\u56de\u7684File\u503c\u7684\u8bfb\u65b9\u6cd5\u548c\u5199\u65b9\u6cd5\u90fd\u80fd\u53ef\u7528 } // Open\u51fd\u6570 // \u4ee5\u53ea\u8bfb\u6a21\u5f0f\u6253\u5f00\u5df2\u5b58\u5728\u7684\u6587\u4ef6 func open(name string)(*File, error){ return OpenFile(name, O_REONLY, 0) } \u6ce8\u610f\uff0c\u591a\u4e2a\u64cd\u4f5c\u6a21\u5f0f\u901a\u8fc7\u6849\u4f4d\u6216\u64cd\u4f5c\u7b26\u7ec4\u5408\u8d77\u6765 \u3002","title":"\u4f8b\u5b50"},{"location":"Language/Basic/25-os/#file_1","text":"os.FileMode \u7c7b\u578b\u4e0d\u4f46\u53ef\u4ee5\u4ee3\u8868\u6743\u9650\u6a21\u5f0f\uff0c\u8fd8\u80fd\u4ee3\u8868\u6587\u4ef6\u6a21\u5f0f\uff08\u5373\uff0c\u6587\u4ef6\u79cd\u7c7b\uff09\u3002 os.FileMode \u662f\u57fa\u4e8euint32\u7c7b\u578b\u7684\u5728\u5b9a\u4e49\u7c7b\u578b\uff0c\u6240\u4ee5\u5b83\u7684\u6bcf\u4e2a\u503c\u90fd\u5305\u542b\u4e8632\u4e2a\u6bd4\u7279\u4f4d\uff0c\u6bcf\u4e2a\u6bd4\u7279\u4f4d\u90fd\u6709\u7279\u5b9a\u7684\u542b\u4e49\u3002 \u5728\u4e00\u4e2a os.FileMode \u7c7b\u578b\u503c\u4e2d\uff0c\u53ea\u6709\u6700\u4f4e\u76849\u4e2a\u6bd4\u7279\u4f4d\u624d\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u6743\u9650\uff083\u4e2a\u4e00\u7ec4\uff0c\u5171\u5206\u4e3a3\u7ec4\uff09\uff0c\u5f53\u6211\u4eec\u62ff\u5230\u4e00\u4e2a\u6b64\u7c7b\u578b\u7684\u503c\u65f6\uff0c\u53ef\u4ee5\u628a\u5b83\u548c os.ModePerm \u5e38\u91cf\u7684\u503c\u505a\u6309\u4f4d\u4e0e\u64cd\u4f5c\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230FileMode\u4e2d\u6240\u6709\u7528\u4e8e\u8868\u793a\u6587\u4ef6\u6743\u9650\u7684\u6bd4\u7279\u4f4d\uff0c\u5373\u6743\u9650\u6a21\u5f0f\u3002 \u4f8b\u5982\uff0c\u5e38\u91cf0777\uff0c\u662f\u4e00\u4e2a\u516b\u8fdb\u5236\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u5b83\u7684\u6700\u4f4e9\u4e2a\u6bd4\u7279\u4f4d\u90fd\u662f1\uff0c\u66f4\u9ad8\u768423\u4e2a\u6bd4\u7279\u4f4d\u90fd\u662f0. \u6700\u9ad8\u6bd4\u7279\u4f4d\u4e3a1\uff0c\u8be5\u503c\u7684\u6587\u4ef6\u6a21\u5f0f\u7b49\u540c\u4e8e os.ModeDir \uff0c\u4ee3\u8868\u4e00\u4e2a\u76ee\u5f55 \u7b2c26\u4e2a\u6bd4\u7279\u4f4d\u4e3a1\uff0c\u544a\u77e5\u7684\u6587\u4ef6\u6a21\u5f0f\u7b49\u540c\u4e8e os.ModeNamedPipe \uff0c\u4ee3\u8868\u4e00\u4e2a\u547d\u540d\u7ba1\u9053 \u4ece\u9ad8\u5230\u5e95\uff0c\u8fd93\u7ec4\u5206\u522b\uff1a \u8868\u793a\u6587\u4ef6\u6240\u6709\u8005\uff08\u521b\u5efa\u6587\u4ef6\u7684\u7528\u6237\uff09 \u6587\u4ef6\u6240\u6709\u8005\u6240\u5c5e\u7684\u7528\u6237\u7ec4 \u5176\u4ed6\u7528\u6237\u5bf9\u8be5\u6587\u4ef6\u7684\u8bbf\u95ee\u6743\u9650 \u6bcf\u7ec4\u4e2d\u76843\u4e2a\u6bd4\u7279\u4f4d\u4ece\u9ad8\u5230\u5e95\u5206\u522b\u8868\u793a\uff1a \u8bfb\u6743\u9650 \u5199\u6743\u9650 \u6267\u884c\u6743\u9650 \u5982\u679c\u5728\u5176\u4e2d\u7684\u67d0\u4e2a\u6bd4\u7279\u4f4d\u4e0a\u7684\u662f1\uff0c\u5c31\u610f\u5473\u7740\u76f8\u5e94\u7684\u6743\u9650\u5f00\u542f\uff0c\u5426\u5219\uff0c\u5c31\u6807\u4e66\u76f8\u5e94\u7684\u6743\u9650\u5173\u95ed\u3002 \u5728\u8c03\u7528 os.OpenFile \u51fd\u6570\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6839\u636e\u4e0a\u9762\u7684\u8bf4\u660e\u8bbe\u7f6e\u7b2c\u4e09\u4e2a\u53c2\u6570\uff0c\u4f46\u662f\u9700\u8981\u6ce8\u610f\uff0c\u53ea\u6709\u5728\u65b0\u5efa\u6587\u4ef6\u7684\u65f6\u5019\uff0c\u8fd9\u91cc\u7684\u7b2c\u4e09\u4e2a\u53c2\u6570\u624d\u662f\u6709\u6548\u7684\uff0c\u5728\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u5373\u4f7f\u8bbe\u7f6e\u4e86\u6b64\u53c2\u6570\uff0c\u4e5f\u4e0d\u4f1a\u5bf9\u76ee\u6807\u6587\u4ef6\u4ea7\u751f\u4efb\u4f55\u7684\u5f71\u54cd\u3002","title":"File\u7684\u6743\u9650\u6a21\u5f0f"},{"location":"Language/Basic/26.net/","text":"net socket\u4e0eIPC socket\u662f\u4e00\u79cdIPC\u65b9\u6cd5\uff08Inter-Process Communication\uff0c\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff09\uff0cIPC\u53ea\u8981\u5b9a\u4e49\u7684\u662f\u591a\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\uff0c\u76f8\u4e92\u901a\u4fe1\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4e3b\u8981\u5305\u62ec\uff1a \u7cfb\u7edf\u4fe1\u53f7\uff08signal\uff09 \u7ba1\u9053\uff08pipe\uff09 \u5957\u63a5\u5b57\uff08socket\uff09 \u6587\u4ef6\u9501\uff08file lock\uff09 \u6d88\u606f\u961f\u5217\uff08message queue\uff09 \u4fe1\u53f7\u706f\uff08semaphore\uff0c\u6216\u79f0\u4e3a\u4fe1\u53f7\u91cf\uff09\u7b49 \u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u5927\u90fd\u5bf9IPC\u63d0\u4f9b\u4e86\u5f3a\u529b\u7684\u652f\u6301\uff0c\u5c24\u5176\u662fsocket\u3002 Golang\u5bf9IPC\u4e5f\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u652f\u6301\uff0c\u5982\uff1a os\u5305\u548c os/signal \u5305\u4e2d\u9488\u5bf9\u7cfb\u7edf\u4fe1\u53f7\u7684API os.Pipe \u51fd\u6570\u53ef\u4ee5\u521b\u5efa\u547d\u540d\u7ba1\u9053 os/exec \u5305\u5bf9\u533f\u540d\u7ba1\u9053\u63d0\u4f9b\u652f\u6301 net\u5305\u5bf9socket\u63d0\u4f9b\u652f\u6301 \u5728\u4f17\u591a\u7684IPC\u65b9\u6cd5\u4e2d\uff0csocket\u662f\u6700\u4e3a\u901a\u7528\u548c\u7075\u6d3b\u7684\u4e00\u79cd \uff0c\u4ee5\u5176\u4ed6\u7684IPC\u65b9\u6cd5\u4e0d\u540c\uff0c\u5229\u7528socket\u8fdb\u884c\u901a\u4fe1\u7684\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4e0d\u5c40\u9650\u4e8e\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u5f53\u4e2d\u3002\u901a\u4fe1\u53cc\u65b9\u53ea\u8981\u80fd\u591f\u901a\u8fc7\u8ba1\u7b97\u673a\u7684\u7f51\u5361\u7aef\u53e3\u4ee5\u53ca\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528socket\u3002 \u652f\u6301socket\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e00\u822c\u90fd\u4f1a\u5bf9\u5916\u63d0\u4f9b\u4e00\u5957API\u3002 \u8dd1\u5728\u5b83\u4eec\u4e4b\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u5229\u7528\u8fd9\u5957API\uff0c\u5c31\u53ef\u4ee5\u4e0e\u4e92\u8054\u7f51\u4e0a\u7684\u53e6\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\u7684\u7a0b\u5e8f\u3001\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\u7684\u5176\u4ed6\u7a0b\u5e8f\uff0c\u751a\u81f3\u540c\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\u8fdb\u884c\u901a\u4fe1 \u3002 Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u7528\u4e0e\u521b\u5efasocket\u5b9e\u4f8b\u7684API\uff0c\u5c31\u662f\u4e00\u4e2a\u540d\u4e3asocket\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u662fLinux\u5185\u6838\u7684\u4e00\u90e8\u5206\u3002 \u6240\u8c13\u7cfb\u7edf\u8c03\u7528\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u7279\u6b8a\u7684C\u8bed\u8a00\u51fd\u6570\uff0c\u5b83\u4eec\u662f\u8fde\u63a5\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u6865\u6881\uff0c\u4e5f\u662f\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u7684 \u552f\u4e00\u6e20\u9053 \u3002 syscall\u5305\u4e2d\u6709\u4e00\u4e2a\u4e0esocket\u7cfb\u7edf\u8c03\u7528\u76f8\u5bf9\u5e94\u7684\u51fd\u6570\uff0c\u8fd9\u4e24\u8005\u7684\u51fd\u6570\u7b7e\u540d\u57fa\u672c\u4e00\u81f4\uff0c\u90fd\u4f1a\u63a5\u6536\u4e09\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u4f1a\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u4ee3\u8868\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u7ed3\u679c\u3002 go func Socket(domain, typ, proto int) (fd int, err error) syscall\u5305\u4e2d\u7684Socket\u51fd\u6570\u672c\u8eab\u662f\u4e0e\u5e73\u53f0\u4e0d\u76f8\u5173\u7684\uff0c\u5728\u5176\u5e95\u5c42\uff0cGo\u8bed\u8a00\u4e3a\u5b83\u652f\u6301\u7684\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u90fd\u505a\u4e86\u9002\u914d\uff0c\u8fd9\u624d\u4f7f\u5f97\u8fd9\u4e2a\u51fd\u6570\u65e0\u8bba\u5728\u54ea\u4e2a\u5e73\u53f0\u4e0a\uff0c\u603b\u662f\u6709\u6548\u7684\u3002 net\u5305\u4e2d\u7684\u5f88\u591a\u7a0b\u5e8f\u5b9e\u4f53\u90fd\u4f1a\u76f4\u63a5\u6216\u95f4\u63a5\u5730\u4f7f\u7528 syscall.Socket \u51fd\u6570\uff1a \u8c03\u7528 net.Dial \u51fd\u6570\u7684\u65f6\u5019\u4f1a\u4e3a\u5b83\u7684\u4e24\u4e2a\u53c2\u6570\u8bbe\u5b9a\u503c\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u540d\u4e3anetwork\uff0c\u5b83\u51b3\u5b9a\u4e86Go\u7a0b\u5e8f\u5e95\u5c42\u4f1a\u521b\u5efa\u4ec0\u4e48\u6837\u7684socket\u5b9e\u4f8b\uff0c\u5e76\u4f7f\u7528\u4ec0\u4e48\u6837\u7684\u534f\u8bae\u4e0e\u5176\u4ed6\u7a0b\u5e8f\u901a\u4fe1\u3002 net.Dial \u51fd\u6570\u7684\u4e00\u4e2a\u53c2\u6570network\u7684\u53ef\u9009\u503c func Dial(network, address string) (Conn, error) net.Dial \u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0cnetwork\u548caddress\uff0c\u90fd\u662fstring\u7c7b\u578b\u7684\u3002 network\u53c2\u6570\u5e38\u7528\u7684\u53ef\u9009\u503c\u67099\u4e2a\uff0c\u8fd9\u4e9b\u503c\u5206\u522b\u4ee3\u8868\u4e86socket\u5b9e\u4f8b\u53ef\u4f7f\u7528\u7684\u4e0d\u540c\u901a\u4fe1\u534f\u8bae\uff1a tcp\uff1a\u4ee3\u8868TCP\u534f\u8bae\uff0c\u5176\u57fa\u4e8e\u7684IP\u534f\u8bae\u7684\u7248\u672c\u6839\u636e\u53c2\u6570address\u7684\u503c\u81ea\u9002\u5e94 tcp4\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684TCP\u534f\u8bae tcp6\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u516d\u7248\u7684TCP\u534f\u8bae udp\uff1a\u4ee3\u8868UDP\u534f\u8bae\uff0c\u5176\u57fa\u4e8e\u7684IP\u534f\u8bae\u7684\u7248\u672c\u6839\u636e\u53c2\u6570address\u7684\u503c\u81ea\u9002\u5e94 udp4\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684UDP\u534f\u8bae udp6\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u516d\u7248\u7684UDP\u534f\u8bae unix\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_STREAM\u4e3asocket\u7c7b\u578b unixgram\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_DGRAM\u4e3asocket\u7c7b\u578b unixpacket\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_SEQPACKET\u4e3asocket\u7c7b\u578b syscall.Socket \u51fd\u6570\u63a5\u53d7\u7684\u4e09\u4e2a\u53c2\u6570 func Socket(domain, typ, proto int) (fd int, err error) \u8fd9\u4e09\u4e2a\u53c2\u6570\u90fd\u662fint\u7c7b\u578b\uff0c\u8fd9\u4e9b\u53c2\u6570\u4ee3\u8868\u5206\u522b\u662f\uff1a domain\uff1asocket\u901a\u4fe1\u57df\uff0c\u4e3b\u8981\u6709\uff1a IPv4\u57df\uff1a\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684\u7f51\u7edc\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_INET\u8868\u793a\uff09 IPv6\u57df\uff1a\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684\u7f51\u7edc\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_INET6\u8868\u793a\uff09 Unix\u57df\uff1a\u4e00\u79cd\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7279\u6709\u7684\u901a\u4fe1\u57df\uff0c\u88c5\u6709\u6b64\u7c7b\u64cd\u4f5c\u7cfb\u7edf\u7684\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u57fa\u4e8e\u6b64\u57df\u521b\u5efasocket\u8fde\u63a5\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_UNIX\u8868\u793a\uff09 typ\uff1a\u7c7b\u578b\uff0c\u5171\u6709\u56db\u79cd: SOCK_DGRAM\uff1a\u4ee3\u8868datagram\u5373\u6570\u636e\u62a5\u6587\uff0c\u4e00\u79cd \u6709\u6d88\u606f\u8fb9\u754c \uff0c\u4f46\u6ca1 \u6709\u903b\u8f91\u8fde\u63a5 \u7684 \u975e\u53ef\u9760 socket\u7c7b\u578b\uff0c\u57fa\u4e8eUDP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u5c5e\u4e8e\u6b64\u7c7b\u3002 \u6709\u6d88\u606f\u8fb9\u754c\u6307\u7684\u662f\uff0c\u4e0esocket\u76f8\u5173\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u7684\u7a0b\u5e8f\u5728\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u7684\u65f6\u5019\u662f\u4ee5\u6d88\u606f\u4e3a\u5355\u4f4d\u7684\u3002\u628a\u6d88\u606f\u7406\u89e3\u4e3a\u5e26\u6709\u56fa\u5b9a\u8fb9\u754c\u7684\u4e00\u6bb5\u6570\u636e\uff0c\u5185\u6838\u7a0b\u5e8f\u81ea\u52a8\u8bc6\u522b\u548c\u7ef4\u62a4\u8fd9\u79cd\u8fb9\u754c\uff0c\u5728\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u628a\u6570\u636e\u5207\u5272\u6210\u4e00\u4e2a\u4e2a\u6d88\u606f\uff0c\u6216\u8005\u628a\u591a\u4e2a\u6d88\u606f\u4e32\u63a5\u6210\u8fde\u7eed\u7684\u6570\u636e\uff0c\u8fd9\u6837\u5e94\u7528\u7a0b\u5e8f\u53ea\u9700\u8981\u9762\u5411\u6d88\u606f\u8fdb\u5904\u7406\u5c31\u53ef\u4ee5\u4e86\u3002 \u6709\u903b\u8f91\u8fde\u63a5\u6307\u7684\u662f\uff0c\u901a\u4fe1\u53cc\u53d1\u5728\u6536\u53d1\u6570\u636e\u4e4b\u524d\u5fc5\u987b\u5148\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u5f85\u8fde\u63a5\u5efa\u7acb\u597d\u4e4b\u540e\uff0c\u53cc\u65b9\u5c31\u53ef\u4ee5\u4e00\u5bf9\u4e00\u5730\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u57fa\u4e8eUDP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u662f\u6ca1\u6709\u903b\u8f91\u8fde\u63a5\u7684\u3002 \u53ea\u8981\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u597d\u5bf9\u65b9\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5185\u6838\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u7acb\u5373\u628a\u6570\u636e\u62a5\u6587\u53d1\u9001\u51fa\u53bb\uff1a - \u4f18\u52bf\uff1a\u53d1\u9001\u901f\u5ea6\u5feb\uff0c\u4e0d\u957f\u671f\u5360\u7528\u7f51\u7edc\u8d44\u6e90\uff0c\u5e76\u4e14\u6bcf\u6b21\u53d1\u9001\u90fd\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u7684\u7f51\u7edc\u5730\u5740 - \u52a3\u52bf\uff1a\u6bcf\u6b21\u90fd\u9700\u8981\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u4f7f\u5f97\u6570\u636e\u62a5\u6587\u66f4\u957f\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u4f20\u8f93\u7684\u53ef\u9760\u6027\uff0c\u4e0d\u80fd\u5b9e\u73b0\u6570\u636e\u7684\u6709\u5e8f\u6027\uff0c\u6570\u636e\u53ea\u80fd\u5355\u5411\u8fdb\u884c\u4f20\u8f93 SOCK_STREAM\uff1a\u4e0eSOCK_DGRAM\u76f8\u53cd\uff0c\u5b83\u662f \u6ca1\u6709\u6d88\u606f\u8fb9\u754c \uff0c\u4f46 \u6709\u903b\u8f91\u8fde\u63a5 \uff0c\u80fd\u591f\u4fdd\u8bc1\u4f20\u8f93\u7684 \u53ef\u9760\u6027 \u548c\u6570\u636e\u7684 \u6709\u5e8f\u6027 \uff0c\u540c\u65f6\u5f00\u53ef\u4ee5\u5b9e\u73b0\u6570\u636e\u7684 \u53cc\u5411\u4f20\u8f93 \u3002\u57fa\u4e8eTCP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u5c5e\u4e8e\u6b64\u7c7b\u3002 \u8fd9\u6837\u7684\u7f51\u7edc\u901a\u4fe1\u4f20\u8f93\u6570\u636e\u7684\u5f62\u5f0f\u662f \u5b57\u8282\u6d41 \uff08\u5b57\u8282\u6d41\u662f\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\uff09\uff0c\u800c\u4e0d\u662f\u6570\u636e\u62a5\u6587\u3002\u5185\u6838\u7a0b\u5e8f\u65e0\u6cd5\u611f\u77e5\u4e00\u6bb5\u5b57\u8282\u6d41\u4e2d\u5305\u542b\u4e86\u591a\u5c11\u4e2a\u6d88\u606f\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u6d88\u606f\u662f\u5426\u5b8c\u6574\uff0c\u8fd9\u5b8c\u5168\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u628a\u63a7\u3002 \u6b64\u7c7b\u7f51\u7edc\u901a\u4fe1\u4e2d\u7684\u4e00\u7aef\uff0c\u603b\u662f\u4f1a\u5fe0\u5b9e\u5730\u6309\u7167\u53e6\u4e00\u7aef\u53d1\u6b7b\u4f60\u4e2a\u6570\u636e\u65f6\u7684\u5b57\u8282\u6392\u5e8f\uff0c\u63a5\u6536\u548c\u7f13\u5b58\u5b83\u4eec\uff0c\u6240\u4ee5\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u66f4\u5177\u53cc\u65b9\u7684\u7ea6\u5b9a\u53bb\u6570\u636e\u4e2d\u67e5\u627e\u6d88\u606f\u8fb9\u754c\uff0c\u5e76\u6309\u7167\u8fb9\u754c\u5207\u5272\u6570\u636e\u3002 SOCK_SEQPACKET SOCK_RAW syscall\u5305\u4e2d\u90fd\u6709\u540c\u540d\u5e38\u91cf\u4e0e\u4e4b\u5bf9\u5e94\u3002 proto\uff1a\u534f\u8bae\uff1b\u8868\u793asocket\u5b9e\u4f8b\u6240\u4f7f\u7528\u7684\u534f\u8bae\uff0c;\u901a\u5e38\u660e\u786e\u4e86\u524d\u4e24\u4e2a\u53c2\u6570\uff0c\u5c31\u4e0d\u5728\u9700\u8981\u786e\u5b9a\u7b2c\u4e09\u4e2a\u53c2\u6570\u503c\u4e86\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a0\u5373\u53ef\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u9009\u62e9\u6700\u9002\u5408\u7684\u534f\u8bae\u3002 \u5f53\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u4e3a syscall.AF_INET \u548c syscall.SOCK_DGRAM \u7684\u65f6\u5019\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u9009\u62e9UDP\u4f5c\u4e3a\u534f\u8bae \u5f53\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u4e3a syscall.AF_INET6 \u548c syscall.SOCK_STREAM \u7684\u65f6\u5019\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u9009\u62e9TCP\u4f5c\u4e3a\u534f\u8bae \u5728\u4f7f\u7528net\u5305\u4e2d\u7684\u9ad8\u5c42\u6b21API\u7684\u65f6\u5019\uff0c\u524d\u4e24\u4e2a\u53c2\u6570\uff08domain\u548ctyp\uff09\u4e5f\u4e0d\u9700\u8981\u7ed9\u5b9a\uff0c\u53ea\u9700\u8981\u628a\u524d\u9762\u6d1b\u514b\u7684\u90a3\u4e9b\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u4f5c\u4e3anetwork\u53c2\u6570\u7684\u503c\u5c31\u597d\u4e86\u3002 \u8c03\u7528 net.DialTimeout \u51fd\u6570\u65f6\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4 func DialTimeout(network, address string, timeout time.Duration) (Conn, error) \u8d85\u65f6\u65f6\u95f4\u4ee3\u8868\u8fd9\u51fd\u6570\u4e3a\u7f51\u7edc\u8fde\u63a5\u5efa\u7acb\u5b8c\u6210\u800c\u7b49\u5f85\u7684\u6700\u957f\u65f6\u95f4\uff0c \u8fd9\u662f\u4e00\u4e2a\u76f8\u5bf9\u65f6\u95f4 \uff0c\u6709\u51fd\u6570\u7684\u53c2\u6570timeout\u7684\u503c\u8868\u793a\u3002 \u5f00\u59cb\u7684\u65f6\u95f4\u70b9\u51e0\u4e4e\u662f\u8c03\u7528 net.DialTimeout \u51fd\u6570\u7684\u90a3\u4e00\u523b\uff0c \u4e4b\u540e\u7684\u65f6\u95f4\uff0c\u4e3b\u8981\u4f1a\u82b1\u8d39\u5728\uff1a \u89e3\u6790\u53c2\u6570network\u548caddress\u7684\u503c\uff1a\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u51fd\u6570\u4f1a\u786e\u5b9a\u7f51\u7edc\u670d\u52a1\u7684IP\u5730\u5740\u3001\u7aef\u53e3\u597d\u7b49\u5fc5\u8981\u4fe1\u606f\u3001\u5e76\u5728\u9700\u8981\u65f6\u8bbf\u95eeDNS\u670d\u52a1\u3002 \u5982\u679c\u89e3\u6790\u51fa\u7684IP\u5730\u5740\u6709\u591a\u4e2a\uff0c\u90a3\u4e48\u51fd\u6570\u4f1a\u4e32\u884c\u6216\u5e76\u53d1\u5730\u5c1d\u8bd5\u5efa\u7acb\u8fde\u63a5\uff0c\u65e0\u8bba\u4ee5\u4ec0\u4e48\u65b9\u5f0f\u5c1d\u8bd5\uff0c\u51fd\u6570\u603b\u4f1a\u4ee5\u6700\u5148\u5efa\u7acb\u6210\u529f\u7684\u90a3\u4e2a\u8fde\u63a5\u4e3a\u51c6\u3002 \u4f1a\u6839\u636e\u8d85\u65f6\u524d\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u53bb\u8bbe\u5b9a\u6bcf\u6b21\u8fde\u63a5\u5c1d\u8bd5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u4ee5\u4fbf\u8ba9\u5b83\u4eec\u90fd\u8981\u9002\u5f53\u7684\u65f6\u95f4\u6267\u884c \u3002 \u521b\u5efasocket\u5b9e\u4f8b\u5e76\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5 \u4e0d\u8bba\u6267\u884c\u5230\u54ea\u4e00\u6b65\uff0c\u53ea\u8981\u7edd\u5bf9\u7684\u8d85\u65f6\u65f6\u95f4\u5230\u8fbe\u7684\u90a3\u4e00\u523b\uff0c\u7f51\u7edc\u8fde\u63a5\u8fd8\u6ca1\u6709\u5efa\u7acb\u5b8c\u6210\uff0c\u8be5\u51fd\u6570\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868I/O\u64cd\u4f5c\u8d85\u65f6\u7684\u9519\u8bef\u503c\u3002 net\u5305\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3aDialer\u7684\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u6709\u4e00\u4e2aTimeout\u5b57\u6bb5\uff0c\u4e0e\u4e0a\u8ff0timeout\u53c2\u6570\u7684\u542b\u4e49\u5b8c\u5168\u4e00\u81f4\uff0c\u5b9e\u9645\u4e0a\uff0c net.DialTimeout \u51fd\u6570\u6b63\u662f\u5229\u7528\u4e86\u8fd9\u4e2a\u7c7b\u578b\u7684\u503c\u624d\u5f97\u4ee5\u5b9e\u73b0\u529f\u80fd\u7684\u3002 net/http \u4f7f\u7528 net.Dial \u548c net.DialTimeout \u51fd\u6570\u8bbf\u95ee\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\u662f\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u7684\uff0cHTTP\u534f\u8bae\u662f\u57fa\u4e8eTCP/IP\u534f\u8bae\u6808\uff0c\u5e76\u4e14\u662f\u4e00\u4e2a\u9762\u5411\u666e\u901a\u6587\u672c\u7684\u534f\u8bae\u3002\u5982\u679c\u9700\u8981\u65b9\u4fbf\u7684\u8bbf\u95ee\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u5219\u4f7f\u7528 net/http \u5305\u3002\u5176\u4e2d\u6700\u4fbf\u6377\u7684\u662f\u4f7f\u7528 http.Get \u51fd\u6570\uff0c\u5728\u8c03\u7528\u5b83\u7684\u65f6\u5019\u53ea\u9700\u8981\u4f20\u5165\u4e00\u4e2aURL\u5c31\u53ef\u4ee5\uff0c\u5982\u4e0b\u6240\u793a\uff1a url1 := http://google.cn fmt.Printf( Send request to %q with method GET ...\\n , url1) resp1, err := http.Get(url1) if err != nil { fmt.Printf( request sending error: %v\\n , err) } defer resp1.Body.Close() line1 := resp1.Proto + + resp1.Status fmt.Printf( The first line of response:\\n%s\\n , line1) func (c *Client) Get(url string) (resp *Response, err error) http.Get \u51fd\u6570\u8fd4\u56de\u4e24\u4e2a\u7ed3\u679c\u503c\uff1a \u7b2c\u4e00\u4e2a\u7ed3\u679c\u503c\u7684\u7c7b\u578b\u662f *http.Response \uff0c\u5b83\u662f\u7f51\u7edc\u670d\u52a1\u7ed9\u6211\u4eec\u4f20\u56de\u7684\u51fd\u6570\u5185\u5bb9\u7684\u7ed3\u6784\u5316\u8868\u793a \u7b2c\u4e8c\u4e2a\u7ed3\u679c\u503c\u662ferror\u7c7b\u578b\uff0c\u5b83\u4ee3\u8868\u4e86\u5728\u521b\u5efa\u548c\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u4ee5\u53ca\u63a5\u6536\u548c\u89e3\u6790HTTP\u76f8\u5e94\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u53d1\u751f\u7684\u9519\u8bef http.Get \u51fd\u6570\u4f1a\u5728\u5185\u90e8\u4f7f\u7528\u7f3a\u7701\u7684HTTP\u5ba2\u6237\u7aef\uff0c\u5e76\u4e14\u8c03\u7528\u5b83\u7684Get\u65b9\u6cd5\u4ee5\u5b8c\u6210\u529f\u80fd\uff0c\u8fd9\u4e2a\u7f3a\u7701\u7684HTTP\u5ba2\u6237\u7aef\u6709 net/http \u5305\u4e2d\u7684\u516c\u5f00\u53d8\u91cfDefaultClient\u4ee3\u8868\uff0c\u5176\u7c7b\u578b\u662f *http.Client \uff0c\u5b83\u7684\u57fa\u672c\u7c7b\u578b\u4e5f\u662f\u53ef\u4ee5\u88ab\u62ff\u6765\u4f7f\u7528\u7684\uff0c\u751a\u81f3\u5b83\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var httpClient1 http.Client resp2, err := httpClient1.Get(url1) // \u7b49\u4ef7\u4e8e resp1, err := http.Get(url1) http.Client \u662f\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u5e76\u4e14\u5b83\u5305\u542b\u7684\u5b57\u6bb5\u90fd\u662f\u516c\u5f00\u7684\u3002\u4e4b\u6240\u4ee5\u8be5\u7c7b\u578b\u7684\u96f6\u503c\u4ecd\u7136\u53ef\u7528\uff0c\u662f\u56e0\u4e3a\u5b83\u7684\u8fd9\u4e9b\u5b57\u6bb5\u8981\u4e48\u5b58\u5728\u8fd9\u76f8\u5e94\u7684\u7f3a\u7701\u503c\uff0c\u8981\u4e48\u5176\u96f6\u503c\u76f4\u63a5\u53ef\u4ee5\u4f7f\u7528\uff0c\u4e14\u4ee3\u8868\u7740\u7279\u5b9a\u7684\u542b\u4e49\u3002 http.Client \u7c7b\u578b\u4e2dTransport\u5b57\u6bb5\u7684\u542b\u4e49 http.Client \u7c7b\u578b\u4e2d\u7684Transport\u5b57\u6bb5\u4ee3\u8868\u7740\uff1a\u5411\u7f51\u7edc\u670d\u52a1\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u5e76\u4ece\u7f51\u7edc\u670d\u52a1\u63a5\u6536HTTP\u76f8\u5e94\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5b57\u6bb5\u7684\u65b9\u6cd5RoundTrip\u5e94\u8be5\u5b9e\u73b0\u5355\u6b21HTTP\u4e8b\u52a1\uff08\u6216\u8005\u8bf4\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u5355\u6b21\u4ea4\u4e92\uff09\u9700\u8981\u7684\u6240\u6709\u6b65\u9aa4\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u662f http.RoundTripper \u63a5\u53e3\u7c7b\u578b\u7684\uff0c\u5b83\u6709\u4e00\u4e2a\u7531 http.DefaultTransport \u53d8\u91cf\u4ee3\u8868\u7684\u7f3a\u7701\u503c\uff0c\u5f53\u6211\u4eec\u5728\u521d\u59cb\u5316\u4e00\u4e2a http.Client \u7c7b\u578b\u7684\u503c\u7684\u65f6\u5019\uff0c\u5982\u679c\u663e\u5f0f\u5730\u4e3a\u8be5\u5b57\u6bb5\u8d4b\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2aClient\u503c\u5c31\u4f1a\u76f4\u63a5\u4f7f\u7528 http.DefaultTransport \u3002 DefaultTransport DefaultTransport\u7684\u5b9e\u9645\u7c7b\u578b\u662f *http.Transport \uff0c\u540e\u8005\u5373\u4e3a http.RoundTripper \u63a5\u53e3\u7684\u9ed8\u8ba4\u5b9e\u73b0\uff0c\u8fd9\u4e2a\u7c7b\u578b\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u5b83\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u56e0\u6b64 http.Client \u7c7b\u578b\u4e5f\u62e5\u6709\u540c\u6837\u7684\u7279\u8d28\u3002 http.Transport \u7c7b\u578b\u4f1a\u5728\u5185\u90e8\u4f7f\u7528\u4e00\u4e2a net.Dialer \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u4e14\u4f1a\u628a\u8be5\u503c\u7684Timeout\u5b57\u6bb5\u7684\u503c\uff0c\u8bbe\u5b9a\u4e3a30\u79d2\u3002\u5982\u679c30\u79d2\u4e4b\u5185\u6ca1\u6709\u5efa\u7acb\u597d\u8fde\u63a5\u5c31\u4f1a\u5224\u65ad\u4e3a\u64cd\u4f5c\u8d85\u65f6\u3002\u5728DefaultTransport\u7684\u503c\u88ab\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u8fd9\u6837\u7684 net.Dialer \u503c\u7684DialContext\u65b9\u6cd5\u4f1a\u88ab\u8d4b\u7ed9\u524d\u8005\u7684DialContext\u5b57\u6bb5\u3002 http.Transport \u7c7b\u578b\u8fd8\u5305\u542b\u5f88\u591a\u5176\u4ed6\u7684\u5b57\u6bb5\uff0c\u5176\u4e2d\u6709\u4e00\u4e9b\u5b57\u6bb5\u662f\u5173\u4e8e\u64cd\u4f5c\u8d85\u65f6\u7684\uff1a IdleConnTimeout\uff1a\u7a7a\u95f2\u7684\u8fde\u63a5\u5728\u591a\u4e45\u4e4b\u540e\u5c31\u5e94\u8be5\u88ab\u5173\u95ed\u3002 DefaultTransport\u4f1a\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u7f6e\u4e3a90\u79d2\uff0c\u5982\u679c\u8be5\u503c\u8bbe\u7f6e\u4e3a0 \uff0c\u90a3\u4e48\u5c31\u8868\u793a\u4e0d\u5173\u95ed\u7a7a\u95f2\u7684\u8fde\u63a5\u3002 \u8fd9\u6837\u4f1a\u9020\u6210\u8d44\u6e90\u7684\u6cc4\u9732 \u3002 \u4e0e\u8be5\u5b57\u6bb5\u76f8\u5173\u7684\u4e00\u4e9b\u5b57\u6bb5\uff1a MaxIdleConns\uff1a\u65e0\u8bba\u5f53\u524d\u7684 http.Transport \u7c7b\u578b\u7684\u503c\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u90fd\u53ea\u4f1a\u5bf9\u7a7a\u95f2\u8fde\u63a5\u7684\u603b\u6570\u505a\u51fa\u9650\u5b9a\u3002 MaxIdleConnsPerHost\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u9650\u5b9a\u7684\u662f http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u6700\u5927\u7a7a\u95f2\u8fde\u63a5\u6570\u3002 \u6bcf\u4e2a\u7f51\u7edc\u670d\u52a1\u90fd\u4f1a\u6709\u81ea\u5df1\u7684\u7f51\u7edc\u5730\u5740\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e0d\u540c\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5bf9\u4e00\u4e9bHTTP\u8bf7\u6c42\u4e5f\u53ef\u80fd\u4f1a\u4f7f\u7528\u4ee3\u7406\uff0c http.Transport \u503c\u5c31\u662f\u901a\u8fc7\u8fd9\u4e09\u65b9\u9762\u7684\u5177\u4f53\u60c5\u51b5\uff0c\u6765\u9274\u522b\u4e0d\u540c\u7684\u7f51\u7edc\u670d\u52a1\u7684\u3002MaxIdleConnsPerHost\u5b57\u6bb5\u7684\u7f3a\u7701\u503c\uff0c\u7531 http.DefaultMaxIdleConnsPerHost \u53d8\u91cf\u4ee3\u8868\uff0c\u503c\u4e3a2\u3002\u5373\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bf9\u67d0\u4e2a http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u5b83\u7684\u7a7a\u95f2\u8fde\u63a5\u6570\u6700\u591a\u53ea\u80fd\u6709\u4e24\u4e2a\u3002 MaxConnsPerHost\uff1a\u9488\u5bf9\u67d0\u4e2a http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u4e0d\u8bba\u8fd9\u4e9b\u8fde\u63a5\u662f\u5426\u7a7a\u95f2\u7684\uff0c\u8be5\u5b57\u6bb5\u6ca1\u6709\u76f8\u5e94\u7684\u7f3a\u7701\u503c\uff0c\u5b83\u7684\u96f6\u503c\u8868\u793a\u4e0d\u5bf9\u6b64\u8bbe\u9650\u5236\u3002 ResponseHeaderTimeout\uff1a\u4ece\u5ba2\u6237\u7aef\u628a\u8bf7\u6c42\u5b8c\u5168\u9012\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u5230\u4ece\u64cd\u4f5c\u7cfb\u7edf\u90a3\u91cc\u63a5\u6536\u5230\u54cd\u5e94\u62a5\u6587\u5934\u7684\u6700\u5927\u65f6\u957f\u3002 DefaultTransport\u6ca1\u6709\u8bbe\u5b9a\u8be5\u5b57\u6bb5\u7684\u503c\u3002 ExpectContinueTimeout\uff1a\u5728\u5ba2\u6237\u7aef\u9012\u4ea4\u4e86\u8bf7\u6c42\u62a5\u6587\u5934\u4e4b\u540e\uff0c\u7b49\u5f85\u63a5\u6536\u7b2c\u4e00\u4e2a\u54cd\u5e94\u62a5\u6587\u5934\u7684\u6700\u957f\u65f6\u95f4\u3002 \u5728\u5ba2\u6237\u7aef\u60f3\u8981\u4f7f\u7528HTTP\u7684POST\u65b9\u6cd5\u628a\u4e00\u4e2a\u5f88\u5927\u7684\u62a5\u6587\u4f53\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u7684\u65f6\u5019\uff0c\u5b83\u53ef\u4ee5\u5148\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u5305\u542b\u4e86Expect:100-continue\u7684\u8bf7\u6c42\u62a5\u6587\u5934\uff0c\u6765\u8be2\u95ee\u670d\u52a1\u7aef\u662f\u5426\u613f\u610f\u63a5\u6536\u8fd9\u4e2a\u5927\u62a5\u6587\u4f53\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u662f\u7528\u4e8e\u8bbe\u5b9a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u8d85\u65f6\u65f6\u95f4\u7684\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u8be5\u5b57\u6bb5\u7684\u503c\u4e0d\u5927\u4e8e0 \uff0c\u90a3\u4e48\u65e0\u8bba\u591a\u5927\u7684\u8bf7\u6c42\u62a5\u6587\u90fd\u5c06\u4f1a\u7acb\u5373\u53d1\u9001\u51fa\u53bb\uff0c\u8fd9\u53ef\u80fd\u4f1a\u9020\u6210\u7f51\u7edc\u8d44\u6e90\u7684\u6d6a\u8d39\u3002DefaultTransport\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a1\u79d2\u3002 TLSHandshakeTimeout\uff1a\uff08TLS\u662fTransport Layer Security\u7684\u7f29\u5199\uff0c\u7ffb\u8bd1\u4e3a\u4f20\u8f93\u5c42\u5b89\u5168\uff09\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u4ee3\u8868\u4e86\u57fa\u4e8eTLS\u534f\u8bae\u7684\u8fde\u63a5\u5728\u88ab\u5efa\u7acb\u65f6\u7684\u63e1\u624b\u9636\u6bb5\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u82e5\u8be5\u503c\u4e3a0 \uff0c\u5219\u8868\u793a\u5bf9\u8fd9\u4e2a\u65f6\u95f4\u4e0d\u8bbe\u9650\u3002 DefaultTransport\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a10\u79d2\u3002 \u4ea7\u751f\u7a7a\u95f2\u8fde\u63a5\u7684\u539f\u56e0\uff1aHTTP\u534f\u8bae\u6709\u4e00\u4e2a\u8bf7\u6c42\u62a5\u6587\u5934\u53eb\u505a\u201cConnection\u201d\uff0c\u5728HTTP 1.1 \u4e2d\uff0c\u8fd9\u4e2a\u62a5\u6587\u5934\u7684\u503c\u9ed8\u8ba4\u662f\u201ckeep-alive\u201d\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u7f51\u7edc\u8fde\u63a5\u90fd\u662f\u6301\u4e45\u8fde\u63a5\uff0c\u5b83\u4eec\u4f1a\u5728\u5f53\u524d\u7684HTTP\u4e8b\u7269\u5b8c\u6210\u540e\u4ecd\u7136\u4fdd\u6301\u8fd9\u8fde\u901a\u6027\uff0c\u56e0\u6b64\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u90a3\u5c31\u6709\u4e24\u79cd\u53ef\u80fd\uff1a \u9488\u5bf9\u540c\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u6709\u65b0\u7684HTTP\u8bf7\u6c42\u88ab\u9012\u4ea4\uff0c\u8be5\u8fde\u63a5\u88ab\u518d\u6b21\u4f7f\u7528 \u4e0d\u518d\u6709\u9488\u5bf9\u8be5\u7f51\u7edc\u670d\u52a1\u7684HTTP\u8bf7\u6c42\uff0c\u8be5\u8fde\u63a5\u88ab\u95f2\u7f6e\uff08\u8fd9\u5c31\u4f1a\u4ea7\u751f\u7a7a\u95f2\u7684\u8fde\u63a5\uff09 \u5982\u679c\u5206\u914d\u7ed9\u67d0\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u8fde\u63a5\u8fc7\u591a\u7684\u8bdd\uff0c\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7a7a\u95f2\u8fde\u63a5\u7684\u4ea7\u751f\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u65b0\u9012\u4ea4\u7684HTTP\u8bf7\u6c42\uff0c\u90fd\u53ea\u4f1a\u5f81\u7528\u4e00\u4e2a\u7a7a\u95f2\u7684\u8fde\u63a5\uff0c\u6240\u4ee5\u4e3a\u7a7a\u95f2\u8fde\u63a5\u8bbe\u5b9a\u9650\u5236\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002 \u5982\u679c\u8981\u675c\u7edd\u7a7a\u8fde\u63a5\u4ea7\u751f\uff0c\u53ef\u4ee5\u5728\u521d\u59cb\u5316 http.Transport \u503c\u7684\u65f6\u5019\u628a\u5b83\u7684DisableKeepAlives\u5b57\u6bb5\u7684\u503c\u8bbe\u7f6e\u4e3atrue\uff0c\u8fd9\u65f6HTTP\u8bf7\u6c42\u7684\u201cConnection\u201d\u62a5\u6587\u5934\u7684\u503c\u5c31\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u201cclose\u201d\uff0c\u8fd9\u4f1a\u544a\u8bc9\u7f51\u7edc\u670d\u52a1\uff0c\u8fd9\u4e2a\u7f51\u7edc\u8fde\u63a5\u4e0d\u5fc5\u4fdd\u6301\uff0c\u5f53\u524d\u7684HTTP\u4e8b\u7269\u5b8c\u6210\u540e\u5c31\u53ef\u4ee5\u65ad\u5f00\u5b83\u4e86\u3002\u8fd9\u6837\u6bcf\u4e00\u4e2aHTTP\u8bf7\u6c42\u88ab\u9012\u4ea4\u65f6\uff0c\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u660e\u663e\u5bb6\u4e2d\u7f51\u7edc\u670d\u52a1\u4ee5\u53ca\u5ba2\u6237\u7aef\u7684\u8d1f\u8f7d\uff0c\u5e76\u4f1a\u8ba9\u6bcf\u4e2aHTTP\u4e8b\u7269\u90fd\u6d88\u8017\u66f4\u591a\u7684\u65f6\u95f4\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u8bbe\u7f6eDisableKeepAlives\u3002 \u5728 net.Dialer \u7c7b\u578b\u4e2d\u4e5f\u6709\u4e00\u4e2akeepAlive\u5b57\u6bb5\uff0c\u5b83\u662f\u76f4\u63a5\u4f5c\u7528\u5728\u5e95\u5c42\u7684socket\u4e0a\u7684\uff0c\u4e00\u79cd\u9488\u5bf9\u7f51\u7edc\u8fde\u63a5\uff08TCP\u8fde\u63a5\uff09\u7684\u5b58\u6d3b\u63a2\u6d4b\u673a\u5236\u3002\u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u6bcf\u9694\u591a\u957f\u65f6\u95f4\u53d1\u9001\u4e00\u6b21\u63a2\u6d4b\u5305\uff0c\u5f53\u8be5\u503c\u4e0d\u5927\u4e8e0\u662f\uff0c\u5219\u8868\u793a\u4e0d\u5f00\u542f\u8fd9\u4e2a\u673a\u5236\u3002DefaultTransport\u4f1a\u628a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a30\u79d2\u3002 http.Server \u7c7b\u578b\u7684ListenAndServer\u65b9\u6cd5 http.Server \u4ee3\u8868\u7684\u662f\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u5b83\u7684ListenAndServer\u65b9\u6cd5\u7684\u529f\u80fd\u662f\uff1a\u76d1\u542c\u4e00\u4e2a\u57fa\u4e8eTCP\u534f\u8bae\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5e76\u5bf9\u63a5\u6536\u5230\u7684HTTP\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u9ed8\u8ba4\u5f00\u542f\u9488\u5bf9\u7f51\u7edc\u8fde\u63a5\u7684\u5b58\u6d3b\u63a2\u6d4b\u673a\u5236\uff0c\u4ee5\u4fdd\u8bc1\u8fde\u63a5\u662f\u6301\u4e45\u7684\u3002\u8be5\u65b9\u6cd5\u4f1a\u4e00\u76f4\u6267\u884c\uff0c\u76f4\u5230\u6709\u4e25\u91cd\u7684\u9519\u8bef\u53d1\u9001\u6216\u8005\u88ab\u5916\u754c\u5173\u95ed\u3002\u5f53\u88ab\u5916\u754c\u5173\u95ed\u65f6\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7531 http.ErrServerClosed \u53d8\u91cf\u4ee3\u8868\u7684\u9519\u8bef\u503c\u3002 ListenAndServer\u65b9\u6cd5\u4e3b\u8981\u505a\u4e0b\u9762\u51e0\u4ef6\u4e8b\u60c5\uff1a \u68c0\u67e5\u5f53\u524d\u7684 http.Server \u7c7b\u578b\u7684\u503c\u7684Addr\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u7684\u503c\u4ee3\u8868\u4e86\u5f53\u524d\u7684\u7f51\u7edc\u8bfb\u7269\u9700\u8981\u4f7f\u7528\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5373IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002 \u5982\u679c\u8be5\u5b57\u6bb5\u7684\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5c31\u7528\u201c:http\u4ee3\u66ff\uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u4efb\u4f55\u53ef\u4ee5\u4ee3\u8868\u672c\u673a\u7684\u57df\u540d\u548cIP\u5730\u5740\uff0c\u5e76\u4e14\u7aef\u53e3\u53f7\u4e3a80\u3002 \u901a\u8fc7\u8c03\u7528 net.Listen \u51fd\u6570\u5728\u5df2\u786e\u5b9a\u7684\u7f51\u7edc\u5730\u5740\u4e0a\u542f\u52a8\u57fa\u4e8eTCP\u534f\u8bae\u7684\u76d1\u542c\u3002 \u68c0\u67e5 net.Listen \u51fd\u6570\u8fd4\u56de\u7684\u9519\u8bef\u503c\uff0c\u5982\u679c\u8be5\u9519\u8bef\u503c\u4e0d\u662fnil\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de\u8be5\u503c\uff0c\u5426\u5219\u901a\u8fc7\u8c03\u7528\u5f53\u524d\u503c\u7684Serve\u65b9\u6cd5\u51c6\u5907\u63a5\u6536\u548c\u5904\u7406\u5c06\u8981\u5230\u6765\u7684HTTP\u8bf7\u6c42\u3002 net.Listen \u51fd\u6570\u5b8c\u6210\u5982\u4e0b\u64cd\u4f5c\uff1a \u89e3\u6790\u53c2\u6570\u503c\u4e2d\u5305\u542b\u7684\u7f51\u7edc\u5730\u5740\u9690\u542b\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7 \u6839\u636e\u7ed9\u5b9a\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u786e\u5b9a\u76d1\u542c\u7684\u65b9\u6cd5\uff0c\u5e76\u5f00\u59cb\u8fdb\u884c\u76d1\u542c","title":"net"},{"location":"Language/Basic/26.net/#net","text":"","title":"net"},{"location":"Language/Basic/26.net/#socketipc","text":"socket\u662f\u4e00\u79cdIPC\u65b9\u6cd5\uff08Inter-Process Communication\uff0c\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff09\uff0cIPC\u53ea\u8981\u5b9a\u4e49\u7684\u662f\u591a\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\uff0c\u76f8\u4e92\u901a\u4fe1\u7684\u65b9\u6cd5\uff0c\u8fd9\u4e9b\u65b9\u6cd5\u4e3b\u8981\u5305\u62ec\uff1a \u7cfb\u7edf\u4fe1\u53f7\uff08signal\uff09 \u7ba1\u9053\uff08pipe\uff09 \u5957\u63a5\u5b57\uff08socket\uff09 \u6587\u4ef6\u9501\uff08file lock\uff09 \u6d88\u606f\u961f\u5217\uff08message queue\uff09 \u4fe1\u53f7\u706f\uff08semaphore\uff0c\u6216\u79f0\u4e3a\u4fe1\u53f7\u91cf\uff09\u7b49 \u4e3b\u6d41\u64cd\u4f5c\u7cfb\u7edf\u5927\u90fd\u5bf9IPC\u63d0\u4f9b\u4e86\u5f3a\u529b\u7684\u652f\u6301\uff0c\u5c24\u5176\u662fsocket\u3002 Golang\u5bf9IPC\u4e5f\u63d0\u4f9b\u4e86\u4e00\u5b9a\u7684\u652f\u6301\uff0c\u5982\uff1a os\u5305\u548c os/signal \u5305\u4e2d\u9488\u5bf9\u7cfb\u7edf\u4fe1\u53f7\u7684API os.Pipe \u51fd\u6570\u53ef\u4ee5\u521b\u5efa\u547d\u540d\u7ba1\u9053 os/exec \u5305\u5bf9\u533f\u540d\u7ba1\u9053\u63d0\u4f9b\u652f\u6301 net\u5305\u5bf9socket\u63d0\u4f9b\u652f\u6301 \u5728\u4f17\u591a\u7684IPC\u65b9\u6cd5\u4e2d\uff0csocket\u662f\u6700\u4e3a\u901a\u7528\u548c\u7075\u6d3b\u7684\u4e00\u79cd \uff0c\u4ee5\u5176\u4ed6\u7684IPC\u65b9\u6cd5\u4e0d\u540c\uff0c\u5229\u7528socket\u8fdb\u884c\u901a\u4fe1\u7684\u8fdb\u7a0b\uff0c\u53ef\u4ee5\u4e0d\u5c40\u9650\u4e8e\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u5f53\u4e2d\u3002\u901a\u4fe1\u53cc\u65b9\u53ea\u8981\u80fd\u591f\u901a\u8fc7\u8ba1\u7b97\u673a\u7684\u7f51\u5361\u7aef\u53e3\u4ee5\u53ca\u7f51\u7edc\u8fdb\u884c\u901a\u4fe1\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528socket\u3002 \u652f\u6301socket\u7684\u64cd\u4f5c\u7cfb\u7edf\u4e00\u822c\u90fd\u4f1a\u5bf9\u5916\u63d0\u4f9b\u4e00\u5957API\u3002 \u8dd1\u5728\u5b83\u4eec\u4e4b\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u5229\u7528\u8fd9\u5957API\uff0c\u5c31\u53ef\u4ee5\u4e0e\u4e92\u8054\u7f51\u4e0a\u7684\u53e6\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\u7684\u7a0b\u5e8f\u3001\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\u7684\u5176\u4ed6\u7a0b\u5e8f\uff0c\u751a\u81f3\u540c\u4e00\u4e2a\u7a0b\u5e8f\u4e2d\u7684\u5176\u4ed6\u7ebf\u7a0b\u8fdb\u884c\u901a\u4fe1 \u3002 Linux\u64cd\u4f5c\u7cfb\u7edf\u4e2d\uff0c\u7528\u4e0e\u521b\u5efasocket\u5b9e\u4f8b\u7684API\uff0c\u5c31\u662f\u4e00\u4e2a\u540d\u4e3asocket\u7684\u7cfb\u7edf\u8c03\u7528\uff0c\u8fd9\u4e2a\u7cfb\u7edf\u8c03\u7528\u662fLinux\u5185\u6838\u7684\u4e00\u90e8\u5206\u3002 \u6240\u8c13\u7cfb\u7edf\u8c03\u7528\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u7279\u6b8a\u7684C\u8bed\u8a00\u51fd\u6570\uff0c\u5b83\u4eec\u662f\u8fde\u63a5\u5e94\u7528\u7a0b\u5e8f\u548c\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u7684\u6865\u6881\uff0c\u4e5f\u662f\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u529f\u80fd\u7684 \u552f\u4e00\u6e20\u9053 \u3002 syscall\u5305\u4e2d\u6709\u4e00\u4e2a\u4e0esocket\u7cfb\u7edf\u8c03\u7528\u76f8\u5bf9\u5e94\u7684\u51fd\u6570\uff0c\u8fd9\u4e24\u8005\u7684\u51fd\u6570\u7b7e\u540d\u57fa\u672c\u4e00\u81f4\uff0c\u90fd\u4f1a\u63a5\u6536\u4e09\u4e2aint\u7c7b\u578b\u7684\u53c2\u6570\uff0c\u5e76\u4f1a\u8fd4\u56de\u4e00\u4e2a\u53ef\u4ee5\u4ee3\u8868\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u7ed3\u679c\u3002 go func Socket(domain, typ, proto int) (fd int, err error) syscall\u5305\u4e2d\u7684Socket\u51fd\u6570\u672c\u8eab\u662f\u4e0e\u5e73\u53f0\u4e0d\u76f8\u5173\u7684\uff0c\u5728\u5176\u5e95\u5c42\uff0cGo\u8bed\u8a00\u4e3a\u5b83\u652f\u6301\u7684\u6bcf\u4e2a\u64cd\u4f5c\u7cfb\u7edf\u90fd\u505a\u4e86\u9002\u914d\uff0c\u8fd9\u624d\u4f7f\u5f97\u8fd9\u4e2a\u51fd\u6570\u65e0\u8bba\u5728\u54ea\u4e2a\u5e73\u53f0\u4e0a\uff0c\u603b\u662f\u6709\u6548\u7684\u3002 net\u5305\u4e2d\u7684\u5f88\u591a\u7a0b\u5e8f\u5b9e\u4f53\u90fd\u4f1a\u76f4\u63a5\u6216\u95f4\u63a5\u5730\u4f7f\u7528 syscall.Socket \u51fd\u6570\uff1a \u8c03\u7528 net.Dial \u51fd\u6570\u7684\u65f6\u5019\u4f1a\u4e3a\u5b83\u7684\u4e24\u4e2a\u53c2\u6570\u8bbe\u5b9a\u503c\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u540d\u4e3anetwork\uff0c\u5b83\u51b3\u5b9a\u4e86Go\u7a0b\u5e8f\u5e95\u5c42\u4f1a\u521b\u5efa\u4ec0\u4e48\u6837\u7684socket\u5b9e\u4f8b\uff0c\u5e76\u4f7f\u7528\u4ec0\u4e48\u6837\u7684\u534f\u8bae\u4e0e\u5176\u4ed6\u7a0b\u5e8f\u901a\u4fe1\u3002","title":"socket\u4e0eIPC"},{"location":"Language/Basic/26.net/#netdialnetwork","text":"func Dial(network, address string) (Conn, error) net.Dial \u51fd\u6570\u63a5\u53d7\u4e24\u4e2a\u53c2\u6570\uff0cnetwork\u548caddress\uff0c\u90fd\u662fstring\u7c7b\u578b\u7684\u3002 network\u53c2\u6570\u5e38\u7528\u7684\u53ef\u9009\u503c\u67099\u4e2a\uff0c\u8fd9\u4e9b\u503c\u5206\u522b\u4ee3\u8868\u4e86socket\u5b9e\u4f8b\u53ef\u4f7f\u7528\u7684\u4e0d\u540c\u901a\u4fe1\u534f\u8bae\uff1a tcp\uff1a\u4ee3\u8868TCP\u534f\u8bae\uff0c\u5176\u57fa\u4e8e\u7684IP\u534f\u8bae\u7684\u7248\u672c\u6839\u636e\u53c2\u6570address\u7684\u503c\u81ea\u9002\u5e94 tcp4\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684TCP\u534f\u8bae tcp6\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u516d\u7248\u7684TCP\u534f\u8bae udp\uff1a\u4ee3\u8868UDP\u534f\u8bae\uff0c\u5176\u57fa\u4e8e\u7684IP\u534f\u8bae\u7684\u7248\u672c\u6839\u636e\u53c2\u6570address\u7684\u503c\u81ea\u9002\u5e94 udp4\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684UDP\u534f\u8bae udp6\uff1a\u4ee3\u8868\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u516d\u7248\u7684UDP\u534f\u8bae unix\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_STREAM\u4e3asocket\u7c7b\u578b unixgram\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_DGRAM\u4e3asocket\u7c7b\u578b unixpacket\uff1a\u4ee3\u8868Unix\u901a\u4fe1\u57df\u4e0b\u7684\u4e00\u79cd\u5185\u90e8socket\u534f\u8bae\uff0c\u4ee5SOCK_SEQPACKET\u4e3asocket\u7c7b\u578b","title":"net.Dial\u51fd\u6570\u7684\u4e00\u4e2a\u53c2\u6570network\u7684\u53ef\u9009\u503c"},{"location":"Language/Basic/26.net/#syscallsocket","text":"func Socket(domain, typ, proto int) (fd int, err error) \u8fd9\u4e09\u4e2a\u53c2\u6570\u90fd\u662fint\u7c7b\u578b\uff0c\u8fd9\u4e9b\u53c2\u6570\u4ee3\u8868\u5206\u522b\u662f\uff1a domain\uff1asocket\u901a\u4fe1\u57df\uff0c\u4e3b\u8981\u6709\uff1a IPv4\u57df\uff1a\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684\u7f51\u7edc\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_INET\u8868\u793a\uff09 IPv6\u57df\uff1a\u57fa\u4e8eIP\u534f\u8bae\u7b2c\u56db\u7248\u7684\u7f51\u7edc\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_INET6\u8868\u793a\uff09 Unix\u57df\uff1a\u4e00\u79cd\u7c7bUnix\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u7279\u6709\u7684\u901a\u4fe1\u57df\uff0c\u88c5\u6709\u6b64\u7c7b\u64cd\u4f5c\u7cfb\u7edf\u7684\u540c\u4e00\u53f0\u8ba1\u7b97\u673a\u4e2d\uff0c\u5e94\u7528\u7a0b\u5e8f\u53ef\u4ee5\u57fa\u4e8e\u6b64\u57df\u521b\u5efasocket\u8fde\u63a5\uff08syscall\u4e2d\u7684\u5e38\u91cfAF_UNIX\u8868\u793a\uff09 typ\uff1a\u7c7b\u578b\uff0c\u5171\u6709\u56db\u79cd: SOCK_DGRAM\uff1a\u4ee3\u8868datagram\u5373\u6570\u636e\u62a5\u6587\uff0c\u4e00\u79cd \u6709\u6d88\u606f\u8fb9\u754c \uff0c\u4f46\u6ca1 \u6709\u903b\u8f91\u8fde\u63a5 \u7684 \u975e\u53ef\u9760 socket\u7c7b\u578b\uff0c\u57fa\u4e8eUDP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u5c5e\u4e8e\u6b64\u7c7b\u3002 \u6709\u6d88\u606f\u8fb9\u754c\u6307\u7684\u662f\uff0c\u4e0esocket\u76f8\u5173\u7684\u64cd\u4f5c\u7cfb\u7edf\u5185\u6838\u4e2d\u7684\u7a0b\u5e8f\u5728\u53d1\u9001\u6216\u63a5\u6536\u6570\u636e\u7684\u65f6\u5019\u662f\u4ee5\u6d88\u606f\u4e3a\u5355\u4f4d\u7684\u3002\u628a\u6d88\u606f\u7406\u89e3\u4e3a\u5e26\u6709\u56fa\u5b9a\u8fb9\u754c\u7684\u4e00\u6bb5\u6570\u636e\uff0c\u5185\u6838\u7a0b\u5e8f\u81ea\u52a8\u8bc6\u522b\u548c\u7ef4\u62a4\u8fd9\u79cd\u8fb9\u754c\uff0c\u5728\u5fc5\u8981\u7684\u65f6\u5019\uff0c\u628a\u6570\u636e\u5207\u5272\u6210\u4e00\u4e2a\u4e2a\u6d88\u606f\uff0c\u6216\u8005\u628a\u591a\u4e2a\u6d88\u606f\u4e32\u63a5\u6210\u8fde\u7eed\u7684\u6570\u636e\uff0c\u8fd9\u6837\u5e94\u7528\u7a0b\u5e8f\u53ea\u9700\u8981\u9762\u5411\u6d88\u606f\u8fdb\u5904\u7406\u5c31\u53ef\u4ee5\u4e86\u3002 \u6709\u903b\u8f91\u8fde\u63a5\u6307\u7684\u662f\uff0c\u901a\u4fe1\u53cc\u53d1\u5728\u6536\u53d1\u6570\u636e\u4e4b\u524d\u5fc5\u987b\u5148\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5\uff0c\u5f85\u8fde\u63a5\u5efa\u7acb\u597d\u4e4b\u540e\uff0c\u53cc\u65b9\u5c31\u53ef\u4ee5\u4e00\u5bf9\u4e00\u5730\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u57fa\u4e8eUDP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u662f\u6ca1\u6709\u903b\u8f91\u8fde\u63a5\u7684\u3002 \u53ea\u8981\u5e94\u7528\u7a0b\u5e8f\u6307\u5b9a\u597d\u5bf9\u65b9\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5185\u6838\u7a0b\u5e8f\u5c31\u53ef\u4ee5\u7acb\u5373\u628a\u6570\u636e\u62a5\u6587\u53d1\u9001\u51fa\u53bb\uff1a - \u4f18\u52bf\uff1a\u53d1\u9001\u901f\u5ea6\u5feb\uff0c\u4e0d\u957f\u671f\u5360\u7528\u7f51\u7edc\u8d44\u6e90\uff0c\u5e76\u4e14\u6bcf\u6b21\u53d1\u9001\u90fd\u53ef\u4ee5\u6307\u5b9a\u4e0d\u540c\u7684\u7f51\u7edc\u5730\u5740 - \u52a3\u52bf\uff1a\u6bcf\u6b21\u90fd\u9700\u8981\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u4f7f\u5f97\u6570\u636e\u62a5\u6587\u66f4\u957f\uff0c\u65e0\u6cd5\u4fdd\u8bc1\u4f20\u8f93\u7684\u53ef\u9760\u6027\uff0c\u4e0d\u80fd\u5b9e\u73b0\u6570\u636e\u7684\u6709\u5e8f\u6027\uff0c\u6570\u636e\u53ea\u80fd\u5355\u5411\u8fdb\u884c\u4f20\u8f93 SOCK_STREAM\uff1a\u4e0eSOCK_DGRAM\u76f8\u53cd\uff0c\u5b83\u662f \u6ca1\u6709\u6d88\u606f\u8fb9\u754c \uff0c\u4f46 \u6709\u903b\u8f91\u8fde\u63a5 \uff0c\u80fd\u591f\u4fdd\u8bc1\u4f20\u8f93\u7684 \u53ef\u9760\u6027 \u548c\u6570\u636e\u7684 \u6709\u5e8f\u6027 \uff0c\u540c\u65f6\u5f00\u53ef\u4ee5\u5b9e\u73b0\u6570\u636e\u7684 \u53cc\u5411\u4f20\u8f93 \u3002\u57fa\u4e8eTCP\u534f\u8bae\u7684\u7f51\u7edc\u901a\u4fe1\u5c5e\u4e8e\u6b64\u7c7b\u3002 \u8fd9\u6837\u7684\u7f51\u7edc\u901a\u4fe1\u4f20\u8f93\u6570\u636e\u7684\u5f62\u5f0f\u662f \u5b57\u8282\u6d41 \uff08\u5b57\u8282\u6d41\u662f\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\uff09\uff0c\u800c\u4e0d\u662f\u6570\u636e\u62a5\u6587\u3002\u5185\u6838\u7a0b\u5e8f\u65e0\u6cd5\u611f\u77e5\u4e00\u6bb5\u5b57\u8282\u6d41\u4e2d\u5305\u542b\u4e86\u591a\u5c11\u4e2a\u6d88\u606f\uff0c\u4ee5\u53ca\u8fd9\u4e9b\u6d88\u606f\u662f\u5426\u5b8c\u6574\uff0c\u8fd9\u5b8c\u5168\u9700\u8981\u5e94\u7528\u7a0b\u5e8f\u81ea\u5df1\u628a\u63a7\u3002 \u6b64\u7c7b\u7f51\u7edc\u901a\u4fe1\u4e2d\u7684\u4e00\u7aef\uff0c\u603b\u662f\u4f1a\u5fe0\u5b9e\u5730\u6309\u7167\u53e6\u4e00\u7aef\u53d1\u6b7b\u4f60\u4e2a\u6570\u636e\u65f6\u7684\u5b57\u8282\u6392\u5e8f\uff0c\u63a5\u6536\u548c\u7f13\u5b58\u5b83\u4eec\uff0c\u6240\u4ee5\u5e94\u7528\u7a0b\u5e8f\u9700\u8981\u66f4\u5177\u53cc\u65b9\u7684\u7ea6\u5b9a\u53bb\u6570\u636e\u4e2d\u67e5\u627e\u6d88\u606f\u8fb9\u754c\uff0c\u5e76\u6309\u7167\u8fb9\u754c\u5207\u5272\u6570\u636e\u3002 SOCK_SEQPACKET SOCK_RAW syscall\u5305\u4e2d\u90fd\u6709\u540c\u540d\u5e38\u91cf\u4e0e\u4e4b\u5bf9\u5e94\u3002 proto\uff1a\u534f\u8bae\uff1b\u8868\u793asocket\u5b9e\u4f8b\u6240\u4f7f\u7528\u7684\u534f\u8bae\uff0c;\u901a\u5e38\u660e\u786e\u4e86\u524d\u4e24\u4e2a\u53c2\u6570\uff0c\u5c31\u4e0d\u5728\u9700\u8981\u786e\u5b9a\u7b2c\u4e09\u4e2a\u53c2\u6570\u503c\u4e86\uff0c\u4e00\u822c\u8bbe\u7f6e\u4e3a0\u5373\u53ef\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u81ea\u52a8\u9009\u62e9\u6700\u9002\u5408\u7684\u534f\u8bae\u3002 \u5f53\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u4e3a syscall.AF_INET \u548c syscall.SOCK_DGRAM \u7684\u65f6\u5019\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u9009\u62e9UDP\u4f5c\u4e3a\u534f\u8bae \u5f53\u4e24\u4e2a\u53c2\u6570\u5206\u522b\u4e3a syscall.AF_INET6 \u548c syscall.SOCK_STREAM \u7684\u65f6\u5019\uff0c\u5185\u6838\u7a0b\u5e8f\u4f1a\u9009\u62e9TCP\u4f5c\u4e3a\u534f\u8bae \u5728\u4f7f\u7528net\u5305\u4e2d\u7684\u9ad8\u5c42\u6b21API\u7684\u65f6\u5019\uff0c\u524d\u4e24\u4e2a\u53c2\u6570\uff08domain\u548ctyp\uff09\u4e5f\u4e0d\u9700\u8981\u7ed9\u5b9a\uff0c\u53ea\u9700\u8981\u628a\u524d\u9762\u6d1b\u514b\u7684\u90a3\u4e9b\u5b57\u7b26\u4e32\u5b57\u9762\u91cf\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u4f5c\u4e3anetwork\u53c2\u6570\u7684\u503c\u5c31\u597d\u4e86\u3002","title":"syscall.Socket\u51fd\u6570\u63a5\u53d7\u7684\u4e09\u4e2a\u53c2\u6570"},{"location":"Language/Basic/26.net/#netdialtimeout","text":"func DialTimeout(network, address string, timeout time.Duration) (Conn, error) \u8d85\u65f6\u65f6\u95f4\u4ee3\u8868\u8fd9\u51fd\u6570\u4e3a\u7f51\u7edc\u8fde\u63a5\u5efa\u7acb\u5b8c\u6210\u800c\u7b49\u5f85\u7684\u6700\u957f\u65f6\u95f4\uff0c \u8fd9\u662f\u4e00\u4e2a\u76f8\u5bf9\u65f6\u95f4 \uff0c\u6709\u51fd\u6570\u7684\u53c2\u6570timeout\u7684\u503c\u8868\u793a\u3002 \u5f00\u59cb\u7684\u65f6\u95f4\u70b9\u51e0\u4e4e\u662f\u8c03\u7528 net.DialTimeout \u51fd\u6570\u7684\u90a3\u4e00\u523b\uff0c \u4e4b\u540e\u7684\u65f6\u95f4\uff0c\u4e3b\u8981\u4f1a\u82b1\u8d39\u5728\uff1a \u89e3\u6790\u53c2\u6570network\u548caddress\u7684\u503c\uff1a\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u51fd\u6570\u4f1a\u786e\u5b9a\u7f51\u7edc\u670d\u52a1\u7684IP\u5730\u5740\u3001\u7aef\u53e3\u597d\u7b49\u5fc5\u8981\u4fe1\u606f\u3001\u5e76\u5728\u9700\u8981\u65f6\u8bbf\u95eeDNS\u670d\u52a1\u3002 \u5982\u679c\u89e3\u6790\u51fa\u7684IP\u5730\u5740\u6709\u591a\u4e2a\uff0c\u90a3\u4e48\u51fd\u6570\u4f1a\u4e32\u884c\u6216\u5e76\u53d1\u5730\u5c1d\u8bd5\u5efa\u7acb\u8fde\u63a5\uff0c\u65e0\u8bba\u4ee5\u4ec0\u4e48\u65b9\u5f0f\u5c1d\u8bd5\uff0c\u51fd\u6570\u603b\u4f1a\u4ee5\u6700\u5148\u5efa\u7acb\u6210\u529f\u7684\u90a3\u4e2a\u8fde\u63a5\u4e3a\u51c6\u3002 \u4f1a\u6839\u636e\u8d85\u65f6\u524d\u5269\u4f59\u7684\u65f6\u95f4\uff0c\u53bb\u8bbe\u5b9a\u6bcf\u6b21\u8fde\u63a5\u5c1d\u8bd5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u4ee5\u4fbf\u8ba9\u5b83\u4eec\u90fd\u8981\u9002\u5f53\u7684\u65f6\u95f4\u6267\u884c \u3002 \u521b\u5efasocket\u5b9e\u4f8b\u5e76\u5efa\u7acb\u7f51\u7edc\u8fde\u63a5 \u4e0d\u8bba\u6267\u884c\u5230\u54ea\u4e00\u6b65\uff0c\u53ea\u8981\u7edd\u5bf9\u7684\u8d85\u65f6\u65f6\u95f4\u5230\u8fbe\u7684\u90a3\u4e00\u523b\uff0c\u7f51\u7edc\u8fde\u63a5\u8fd8\u6ca1\u6709\u5efa\u7acb\u5b8c\u6210\uff0c\u8be5\u51fd\u6570\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u4ee3\u8868I/O\u64cd\u4f5c\u8d85\u65f6\u7684\u9519\u8bef\u503c\u3002 net\u5305\u4e2d\u6709\u4e00\u4e2a\u540d\u4e3aDialer\u7684\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u6709\u4e00\u4e2aTimeout\u5b57\u6bb5\uff0c\u4e0e\u4e0a\u8ff0timeout\u53c2\u6570\u7684\u542b\u4e49\u5b8c\u5168\u4e00\u81f4\uff0c\u5b9e\u9645\u4e0a\uff0c net.DialTimeout \u51fd\u6570\u6b63\u662f\u5229\u7528\u4e86\u8fd9\u4e2a\u7c7b\u578b\u7684\u503c\u624d\u5f97\u4ee5\u5b9e\u73b0\u529f\u80fd\u7684\u3002","title":"\u8c03\u7528net.DialTimeout\u51fd\u6570\u65f6\u8bbe\u5b9a\u8d85\u65f6\u65f6\u95f4"},{"location":"Language/Basic/26.net/#nethttp","text":"\u4f7f\u7528 net.Dial \u548c net.DialTimeout \u51fd\u6570\u8bbf\u95ee\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\u662f\u5b8c\u5168\u6ca1\u6709\u95ee\u9898\u7684\uff0cHTTP\u534f\u8bae\u662f\u57fa\u4e8eTCP/IP\u534f\u8bae\u6808\uff0c\u5e76\u4e14\u662f\u4e00\u4e2a\u9762\u5411\u666e\u901a\u6587\u672c\u7684\u534f\u8bae\u3002\u5982\u679c\u9700\u8981\u65b9\u4fbf\u7684\u8bbf\u95ee\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u5219\u4f7f\u7528 net/http \u5305\u3002\u5176\u4e2d\u6700\u4fbf\u6377\u7684\u662f\u4f7f\u7528 http.Get \u51fd\u6570\uff0c\u5728\u8c03\u7528\u5b83\u7684\u65f6\u5019\u53ea\u9700\u8981\u4f20\u5165\u4e00\u4e2aURL\u5c31\u53ef\u4ee5\uff0c\u5982\u4e0b\u6240\u793a\uff1a url1 := http://google.cn fmt.Printf( Send request to %q with method GET ...\\n , url1) resp1, err := http.Get(url1) if err != nil { fmt.Printf( request sending error: %v\\n , err) } defer resp1.Body.Close() line1 := resp1.Proto + + resp1.Status fmt.Printf( The first line of response:\\n%s\\n , line1) func (c *Client) Get(url string) (resp *Response, err error) http.Get \u51fd\u6570\u8fd4\u56de\u4e24\u4e2a\u7ed3\u679c\u503c\uff1a \u7b2c\u4e00\u4e2a\u7ed3\u679c\u503c\u7684\u7c7b\u578b\u662f *http.Response \uff0c\u5b83\u662f\u7f51\u7edc\u670d\u52a1\u7ed9\u6211\u4eec\u4f20\u56de\u7684\u51fd\u6570\u5185\u5bb9\u7684\u7ed3\u6784\u5316\u8868\u793a \u7b2c\u4e8c\u4e2a\u7ed3\u679c\u503c\u662ferror\u7c7b\u578b\uff0c\u5b83\u4ee3\u8868\u4e86\u5728\u521b\u5efa\u548c\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u4ee5\u53ca\u63a5\u6536\u548c\u89e3\u6790HTTP\u76f8\u5e94\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u53d1\u751f\u7684\u9519\u8bef http.Get \u51fd\u6570\u4f1a\u5728\u5185\u90e8\u4f7f\u7528\u7f3a\u7701\u7684HTTP\u5ba2\u6237\u7aef\uff0c\u5e76\u4e14\u8c03\u7528\u5b83\u7684Get\u65b9\u6cd5\u4ee5\u5b8c\u6210\u529f\u80fd\uff0c\u8fd9\u4e2a\u7f3a\u7701\u7684HTTP\u5ba2\u6237\u7aef\u6709 net/http \u5305\u4e2d\u7684\u516c\u5f00\u53d8\u91cfDefaultClient\u4ee3\u8868\uff0c\u5176\u7c7b\u578b\u662f *http.Client \uff0c\u5b83\u7684\u57fa\u672c\u7c7b\u578b\u4e5f\u662f\u53ef\u4ee5\u88ab\u62ff\u6765\u4f7f\u7528\u7684\uff0c\u751a\u81f3\u5b83\u662f\u5f00\u7bb1\u5373\u7528\u7684\uff0c\u5982\u4e0b\u4ee3\u7801\u6240\u793a\uff1a var httpClient1 http.Client resp2, err := httpClient1.Get(url1) // \u7b49\u4ef7\u4e8e resp1, err := http.Get(url1) http.Client \u662f\u4e00\u4e2a\u7ed3\u6784\u4f53\u7c7b\u578b\uff0c\u5e76\u4e14\u5b83\u5305\u542b\u7684\u5b57\u6bb5\u90fd\u662f\u516c\u5f00\u7684\u3002\u4e4b\u6240\u4ee5\u8be5\u7c7b\u578b\u7684\u96f6\u503c\u4ecd\u7136\u53ef\u7528\uff0c\u662f\u56e0\u4e3a\u5b83\u7684\u8fd9\u4e9b\u5b57\u6bb5\u8981\u4e48\u5b58\u5728\u8fd9\u76f8\u5e94\u7684\u7f3a\u7701\u503c\uff0c\u8981\u4e48\u5176\u96f6\u503c\u76f4\u63a5\u53ef\u4ee5\u4f7f\u7528\uff0c\u4e14\u4ee3\u8868\u7740\u7279\u5b9a\u7684\u542b\u4e49\u3002","title":"net/http"},{"location":"Language/Basic/26.net/#httpclienttransport","text":"http.Client \u7c7b\u578b\u4e2d\u7684Transport\u5b57\u6bb5\u4ee3\u8868\u7740\uff1a\u5411\u7f51\u7edc\u670d\u52a1\u53d1\u9001HTTP\u8bf7\u6c42\uff0c\u5e76\u4ece\u7f51\u7edc\u670d\u52a1\u63a5\u6536HTTP\u76f8\u5e94\u7684\u64cd\u4f5c\u8fc7\u7a0b\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8be5\u5b57\u6bb5\u7684\u65b9\u6cd5RoundTrip\u5e94\u8be5\u5b9e\u73b0\u5355\u6b21HTTP\u4e8b\u52a1\uff08\u6216\u8005\u8bf4\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u5355\u6b21\u4ea4\u4e92\uff09\u9700\u8981\u7684\u6240\u6709\u6b65\u9aa4\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u662f http.RoundTripper \u63a5\u53e3\u7c7b\u578b\u7684\uff0c\u5b83\u6709\u4e00\u4e2a\u7531 http.DefaultTransport \u53d8\u91cf\u4ee3\u8868\u7684\u7f3a\u7701\u503c\uff0c\u5f53\u6211\u4eec\u5728\u521d\u59cb\u5316\u4e00\u4e2a http.Client \u7c7b\u578b\u7684\u503c\u7684\u65f6\u5019\uff0c\u5982\u679c\u663e\u5f0f\u5730\u4e3a\u8be5\u5b57\u6bb5\u8d4b\u503c\uff0c\u90a3\u4e48\u8fd9\u4e2aClient\u503c\u5c31\u4f1a\u76f4\u63a5\u4f7f\u7528 http.DefaultTransport \u3002","title":"http.Client\u7c7b\u578b\u4e2dTransport\u5b57\u6bb5\u7684\u542b\u4e49"},{"location":"Language/Basic/26.net/#defaulttransport","text":"DefaultTransport\u7684\u5b9e\u9645\u7c7b\u578b\u662f *http.Transport \uff0c\u540e\u8005\u5373\u4e3a http.RoundTripper \u63a5\u53e3\u7684\u9ed8\u8ba4\u5b9e\u73b0\uff0c\u8fd9\u4e2a\u7c7b\u578b\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u5b83\u662f\u5e76\u53d1\u5b89\u5168\u7684\uff0c\u56e0\u6b64 http.Client \u7c7b\u578b\u4e5f\u62e5\u6709\u540c\u6837\u7684\u7279\u8d28\u3002 http.Transport \u7c7b\u578b\u4f1a\u5728\u5185\u90e8\u4f7f\u7528\u4e00\u4e2a net.Dialer \u7c7b\u578b\u7684\u503c\uff0c\u5e76\u4e14\u4f1a\u628a\u8be5\u503c\u7684Timeout\u5b57\u6bb5\u7684\u503c\uff0c\u8bbe\u5b9a\u4e3a30\u79d2\u3002\u5982\u679c30\u79d2\u4e4b\u5185\u6ca1\u6709\u5efa\u7acb\u597d\u8fde\u63a5\u5c31\u4f1a\u5224\u65ad\u4e3a\u64cd\u4f5c\u8d85\u65f6\u3002\u5728DefaultTransport\u7684\u503c\u88ab\u521d\u59cb\u5316\u7684\u65f6\u5019\uff0c\u8fd9\u6837\u7684 net.Dialer \u503c\u7684DialContext\u65b9\u6cd5\u4f1a\u88ab\u8d4b\u7ed9\u524d\u8005\u7684DialContext\u5b57\u6bb5\u3002 http.Transport \u7c7b\u578b\u8fd8\u5305\u542b\u5f88\u591a\u5176\u4ed6\u7684\u5b57\u6bb5\uff0c\u5176\u4e2d\u6709\u4e00\u4e9b\u5b57\u6bb5\u662f\u5173\u4e8e\u64cd\u4f5c\u8d85\u65f6\u7684\uff1a IdleConnTimeout\uff1a\u7a7a\u95f2\u7684\u8fde\u63a5\u5728\u591a\u4e45\u4e4b\u540e\u5c31\u5e94\u8be5\u88ab\u5173\u95ed\u3002 DefaultTransport\u4f1a\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u7f6e\u4e3a90\u79d2\uff0c\u5982\u679c\u8be5\u503c\u8bbe\u7f6e\u4e3a0 \uff0c\u90a3\u4e48\u5c31\u8868\u793a\u4e0d\u5173\u95ed\u7a7a\u95f2\u7684\u8fde\u63a5\u3002 \u8fd9\u6837\u4f1a\u9020\u6210\u8d44\u6e90\u7684\u6cc4\u9732 \u3002 \u4e0e\u8be5\u5b57\u6bb5\u76f8\u5173\u7684\u4e00\u4e9b\u5b57\u6bb5\uff1a MaxIdleConns\uff1a\u65e0\u8bba\u5f53\u524d\u7684 http.Transport \u7c7b\u578b\u7684\u503c\u8bbf\u95ee\u4e86\u591a\u5c11\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u90fd\u53ea\u4f1a\u5bf9\u7a7a\u95f2\u8fde\u63a5\u7684\u603b\u6570\u505a\u51fa\u9650\u5b9a\u3002 MaxIdleConnsPerHost\uff1a\u8fd9\u4e2a\u5b57\u6bb5\u9650\u5b9a\u7684\u662f http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u6700\u5927\u7a7a\u95f2\u8fde\u63a5\u6570\u3002 \u6bcf\u4e2a\u7f51\u7edc\u670d\u52a1\u90fd\u4f1a\u6709\u81ea\u5df1\u7684\u7f51\u7edc\u5730\u5740\uff0c\u53ef\u80fd\u4f1a\u4f7f\u7528\u4e0d\u540c\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u5bf9\u4e00\u4e9bHTTP\u8bf7\u6c42\u4e5f\u53ef\u80fd\u4f1a\u4f7f\u7528\u4ee3\u7406\uff0c http.Transport \u503c\u5c31\u662f\u901a\u8fc7\u8fd9\u4e09\u65b9\u9762\u7684\u5177\u4f53\u60c5\u51b5\uff0c\u6765\u9274\u522b\u4e0d\u540c\u7684\u7f51\u7edc\u670d\u52a1\u7684\u3002MaxIdleConnsPerHost\u5b57\u6bb5\u7684\u7f3a\u7701\u503c\uff0c\u7531 http.DefaultMaxIdleConnsPerHost \u53d8\u91cf\u4ee3\u8868\uff0c\u503c\u4e3a2\u3002\u5373\uff0c\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5bf9\u67d0\u4e2a http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u5b83\u7684\u7a7a\u95f2\u8fde\u63a5\u6570\u6700\u591a\u53ea\u80fd\u6709\u4e24\u4e2a\u3002 MaxConnsPerHost\uff1a\u9488\u5bf9\u67d0\u4e2a http.Transport \u503c\u8bbf\u95ee\u7684\u6bcf\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u4e0d\u8bba\u8fd9\u4e9b\u8fde\u63a5\u662f\u5426\u7a7a\u95f2\u7684\uff0c\u8be5\u5b57\u6bb5\u6ca1\u6709\u76f8\u5e94\u7684\u7f3a\u7701\u503c\uff0c\u5b83\u7684\u96f6\u503c\u8868\u793a\u4e0d\u5bf9\u6b64\u8bbe\u9650\u5236\u3002 ResponseHeaderTimeout\uff1a\u4ece\u5ba2\u6237\u7aef\u628a\u8bf7\u6c42\u5b8c\u5168\u9012\u4ea4\u7ed9\u64cd\u4f5c\u7cfb\u7edf\u5230\u4ece\u64cd\u4f5c\u7cfb\u7edf\u90a3\u91cc\u63a5\u6536\u5230\u54cd\u5e94\u62a5\u6587\u5934\u7684\u6700\u5927\u65f6\u957f\u3002 DefaultTransport\u6ca1\u6709\u8bbe\u5b9a\u8be5\u5b57\u6bb5\u7684\u503c\u3002 ExpectContinueTimeout\uff1a\u5728\u5ba2\u6237\u7aef\u9012\u4ea4\u4e86\u8bf7\u6c42\u62a5\u6587\u5934\u4e4b\u540e\uff0c\u7b49\u5f85\u63a5\u6536\u7b2c\u4e00\u4e2a\u54cd\u5e94\u62a5\u6587\u5934\u7684\u6700\u957f\u65f6\u95f4\u3002 \u5728\u5ba2\u6237\u7aef\u60f3\u8981\u4f7f\u7528HTTP\u7684POST\u65b9\u6cd5\u628a\u4e00\u4e2a\u5f88\u5927\u7684\u62a5\u6587\u4f53\u53d1\u9001\u7ed9\u670d\u52a1\u7aef\u7684\u65f6\u5019\uff0c\u5b83\u53ef\u4ee5\u5148\u901a\u8fc7\u53d1\u9001\u4e00\u4e2a\u5305\u542b\u4e86Expect:100-continue\u7684\u8bf7\u6c42\u62a5\u6587\u5934\uff0c\u6765\u8be2\u95ee\u670d\u52a1\u7aef\u662f\u5426\u613f\u610f\u63a5\u6536\u8fd9\u4e2a\u5927\u62a5\u6587\u4f53\u3002 \u8fd9\u4e2a\u5b57\u6bb5\u662f\u7528\u4e8e\u8bbe\u5b9a\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u8d85\u65f6\u65f6\u95f4\u7684\uff0c\u6ce8\u610f\uff0c\u5982\u679c\u8be5\u5b57\u6bb5\u7684\u503c\u4e0d\u5927\u4e8e0 \uff0c\u90a3\u4e48\u65e0\u8bba\u591a\u5927\u7684\u8bf7\u6c42\u62a5\u6587\u90fd\u5c06\u4f1a\u7acb\u5373\u53d1\u9001\u51fa\u53bb\uff0c\u8fd9\u53ef\u80fd\u4f1a\u9020\u6210\u7f51\u7edc\u8d44\u6e90\u7684\u6d6a\u8d39\u3002DefaultTransport\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a1\u79d2\u3002 TLSHandshakeTimeout\uff1a\uff08TLS\u662fTransport Layer Security\u7684\u7f29\u5199\uff0c\u7ffb\u8bd1\u4e3a\u4f20\u8f93\u5c42\u5b89\u5168\uff09\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u4ee3\u8868\u4e86\u57fa\u4e8eTLS\u534f\u8bae\u7684\u8fde\u63a5\u5728\u88ab\u5efa\u7acb\u65f6\u7684\u63e1\u624b\u9636\u6bb5\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u82e5\u8be5\u503c\u4e3a0 \uff0c\u5219\u8868\u793a\u5bf9\u8fd9\u4e2a\u65f6\u95f4\u4e0d\u8bbe\u9650\u3002 DefaultTransport\u628a\u8be5\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a10\u79d2\u3002 \u4ea7\u751f\u7a7a\u95f2\u8fde\u63a5\u7684\u539f\u56e0\uff1aHTTP\u534f\u8bae\u6709\u4e00\u4e2a\u8bf7\u6c42\u62a5\u6587\u5934\u53eb\u505a\u201cConnection\u201d\uff0c\u5728HTTP 1.1 \u4e2d\uff0c\u8fd9\u4e2a\u62a5\u6587\u5934\u7684\u503c\u9ed8\u8ba4\u662f\u201ckeep-alive\u201d\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u7f51\u7edc\u8fde\u63a5\u90fd\u662f\u6301\u4e45\u8fde\u63a5\uff0c\u5b83\u4eec\u4f1a\u5728\u5f53\u524d\u7684HTTP\u4e8b\u7269\u5b8c\u6210\u540e\u4ecd\u7136\u4fdd\u6301\u8fd9\u8fde\u901a\u6027\uff0c\u56e0\u6b64\u662f\u53ef\u4ee5\u88ab\u590d\u7528\u7684\uff0c\u90a3\u5c31\u6709\u4e24\u79cd\u53ef\u80fd\uff1a \u9488\u5bf9\u540c\u4e00\u4e2a\u7f51\u7edc\u670d\u52a1\uff0c\u6709\u65b0\u7684HTTP\u8bf7\u6c42\u88ab\u9012\u4ea4\uff0c\u8be5\u8fde\u63a5\u88ab\u518d\u6b21\u4f7f\u7528 \u4e0d\u518d\u6709\u9488\u5bf9\u8be5\u7f51\u7edc\u670d\u52a1\u7684HTTP\u8bf7\u6c42\uff0c\u8be5\u8fde\u63a5\u88ab\u95f2\u7f6e\uff08\u8fd9\u5c31\u4f1a\u4ea7\u751f\u7a7a\u95f2\u7684\u8fde\u63a5\uff09 \u5982\u679c\u5206\u914d\u7ed9\u67d0\u4e2a\u7f51\u7edc\u670d\u52a1\u7684\u8fde\u63a5\u8fc7\u591a\u7684\u8bdd\uff0c\u4e5f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7a7a\u95f2\u8fde\u63a5\u7684\u4ea7\u751f\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u65b0\u9012\u4ea4\u7684HTTP\u8bf7\u6c42\uff0c\u90fd\u53ea\u4f1a\u5f81\u7528\u4e00\u4e2a\u7a7a\u95f2\u7684\u8fde\u63a5\uff0c\u6240\u4ee5\u4e3a\u7a7a\u95f2\u8fde\u63a5\u8bbe\u5b9a\u9650\u5236\uff0c\u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u662f\u5f88\u6709\u5fc5\u8981\u7684\u3002 \u5982\u679c\u8981\u675c\u7edd\u7a7a\u8fde\u63a5\u4ea7\u751f\uff0c\u53ef\u4ee5\u5728\u521d\u59cb\u5316 http.Transport \u503c\u7684\u65f6\u5019\u628a\u5b83\u7684DisableKeepAlives\u5b57\u6bb5\u7684\u503c\u8bbe\u7f6e\u4e3atrue\uff0c\u8fd9\u65f6HTTP\u8bf7\u6c42\u7684\u201cConnection\u201d\u62a5\u6587\u5934\u7684\u503c\u5c31\u4f1a\u88ab\u8bbe\u7f6e\u4e3a\u201cclose\u201d\uff0c\u8fd9\u4f1a\u544a\u8bc9\u7f51\u7edc\u670d\u52a1\uff0c\u8fd9\u4e2a\u7f51\u7edc\u8fde\u63a5\u4e0d\u5fc5\u4fdd\u6301\uff0c\u5f53\u524d\u7684HTTP\u4e8b\u7269\u5b8c\u6210\u540e\u5c31\u53ef\u4ee5\u65ad\u5f00\u5b83\u4e86\u3002\u8fd9\u6837\u6bcf\u4e00\u4e2aHTTP\u8bf7\u6c42\u88ab\u9012\u4ea4\u65f6\uff0c\u5c31\u4f1a\u4ea7\u751f\u4e00\u4e2a\u65b0\u7684\u7f51\u7edc\u8fde\u63a5\uff0c\u660e\u663e\u5bb6\u4e2d\u7f51\u7edc\u670d\u52a1\u4ee5\u53ca\u5ba2\u6237\u7aef\u7684\u8d1f\u8f7d\uff0c\u5e76\u4f1a\u8ba9\u6bcf\u4e2aHTTP\u4e8b\u7269\u90fd\u6d88\u8017\u66f4\u591a\u7684\u65f6\u95f4\u3002\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u4f1a\u8bbe\u7f6eDisableKeepAlives\u3002 \u5728 net.Dialer \u7c7b\u578b\u4e2d\u4e5f\u6709\u4e00\u4e2akeepAlive\u5b57\u6bb5\uff0c\u5b83\u662f\u76f4\u63a5\u4f5c\u7528\u5728\u5e95\u5c42\u7684socket\u4e0a\u7684\uff0c\u4e00\u79cd\u9488\u5bf9\u7f51\u7edc\u8fde\u63a5\uff08TCP\u8fde\u63a5\uff09\u7684\u5b58\u6d3b\u63a2\u6d4b\u673a\u5236\u3002\u5b83\u7684\u503c\u7528\u4e8e\u8868\u793a\u6bcf\u9694\u591a\u957f\u65f6\u95f4\u53d1\u9001\u4e00\u6b21\u63a2\u6d4b\u5305\uff0c\u5f53\u8be5\u503c\u4e0d\u5927\u4e8e0\u662f\uff0c\u5219\u8868\u793a\u4e0d\u5f00\u542f\u8fd9\u4e2a\u673a\u5236\u3002DefaultTransport\u4f1a\u628a\u8fd9\u4e2a\u5b57\u6bb5\u7684\u503c\u8bbe\u5b9a\u4e3a30\u79d2\u3002","title":"DefaultTransport"},{"location":"Language/Basic/26.net/#httpserverlistenandserver","text":"http.Server \u4ee3\u8868\u7684\u662f\u57fa\u4e8eHTTP\u534f\u8bae\u7684\u7f51\u7edc\u670d\u52a1\uff0c\u5b83\u7684ListenAndServer\u65b9\u6cd5\u7684\u529f\u80fd\u662f\uff1a\u76d1\u542c\u4e00\u4e2a\u57fa\u4e8eTCP\u534f\u8bae\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5e76\u5bf9\u63a5\u6536\u5230\u7684HTTP\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\u3002\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u9ed8\u8ba4\u5f00\u542f\u9488\u5bf9\u7f51\u7edc\u8fde\u63a5\u7684\u5b58\u6d3b\u63a2\u6d4b\u673a\u5236\uff0c\u4ee5\u4fdd\u8bc1\u8fde\u63a5\u662f\u6301\u4e45\u7684\u3002\u8be5\u65b9\u6cd5\u4f1a\u4e00\u76f4\u6267\u884c\uff0c\u76f4\u5230\u6709\u4e25\u91cd\u7684\u9519\u8bef\u53d1\u9001\u6216\u8005\u88ab\u5916\u754c\u5173\u95ed\u3002\u5f53\u88ab\u5916\u754c\u5173\u95ed\u65f6\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u7531 http.ErrServerClosed \u53d8\u91cf\u4ee3\u8868\u7684\u9519\u8bef\u503c\u3002 ListenAndServer\u65b9\u6cd5\u4e3b\u8981\u505a\u4e0b\u9762\u51e0\u4ef6\u4e8b\u60c5\uff1a \u68c0\u67e5\u5f53\u524d\u7684 http.Server \u7c7b\u578b\u7684\u503c\u7684Addr\u5b57\u6bb5\uff0c\u8be5\u5b57\u6bb5\u7684\u503c\u4ee3\u8868\u4e86\u5f53\u524d\u7684\u7f51\u7edc\u8bfb\u7269\u9700\u8981\u4f7f\u7528\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5373IP\u5730\u5740\u548c\u7aef\u53e3\u53f7\u3002 \u5982\u679c\u8be5\u5b57\u6bb5\u7684\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5c31\u7528\u201c:http\u4ee3\u66ff\uff0c\u4e5f\u5c31\u662f\u4f7f\u7528\u4efb\u4f55\u53ef\u4ee5\u4ee3\u8868\u672c\u673a\u7684\u57df\u540d\u548cIP\u5730\u5740\uff0c\u5e76\u4e14\u7aef\u53e3\u53f7\u4e3a80\u3002 \u901a\u8fc7\u8c03\u7528 net.Listen \u51fd\u6570\u5728\u5df2\u786e\u5b9a\u7684\u7f51\u7edc\u5730\u5740\u4e0a\u542f\u52a8\u57fa\u4e8eTCP\u534f\u8bae\u7684\u76d1\u542c\u3002 \u68c0\u67e5 net.Listen \u51fd\u6570\u8fd4\u56de\u7684\u9519\u8bef\u503c\uff0c\u5982\u679c\u8be5\u9519\u8bef\u503c\u4e0d\u662fnil\uff0c\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de\u8be5\u503c\uff0c\u5426\u5219\u901a\u8fc7\u8c03\u7528\u5f53\u524d\u503c\u7684Serve\u65b9\u6cd5\u51c6\u5907\u63a5\u6536\u548c\u5904\u7406\u5c06\u8981\u5230\u6765\u7684HTTP\u8bf7\u6c42\u3002 net.Listen \u51fd\u6570\u5b8c\u6210\u5982\u4e0b\u64cd\u4f5c\uff1a \u89e3\u6790\u53c2\u6570\u503c\u4e2d\u5305\u542b\u7684\u7f51\u7edc\u5730\u5740\u9690\u542b\u7684IP\u5730\u5740\u548c\u7aef\u53e3\u53f7 \u6839\u636e\u7ed9\u5b9a\u7684\u7f51\u7edc\u534f\u8bae\uff0c\u786e\u5b9a\u76d1\u542c\u7684\u65b9\u6cd5\uff0c\u5e76\u5f00\u59cb\u8fdb\u884c\u76d1\u542c","title":"http.Server\u7c7b\u578b\u7684ListenAndServer\u65b9\u6cd5"},{"location":"Language/Basic/Go-Modules/","text":"Go Modules Go \u8bed\u8a00\u4e2d\u4e00\u76f4\u88ab\u4eba\u8bdf\u75c5\u7684\u4e00\u4e2a\u95ee\u9898\u5c31\u662f \u6ca1\u6709\u4e00\u4e2a\u6bd4\u8f83\u597d\u7528\u7684\u4f9d\u8d56\u7ba1\u7406\u7cfb\u7edf \u3002 GOPATH \u7684\u8bbe\u8ba1\u8ba9\u5f00\u53d1\u8005\u4e00\u76f4\u6709\u5f88\u591a\u6028\u8a00\uff0c\u5728 Go \u8bed\u8a00\u5feb\u901f\u53d1\u5c55\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u51fa\u73b0\u4e86\u4e00\u4e9b\u6bd4\u8f83\u4f18\u79c0\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\uff0c\u6bd4\u5982: govendor dep glide\u7b49 \u6709\u4e00\u4e9b\u5dee\u4e0d\u591a\u6210\u4e86\u534a\u5b98\u65b9\u7684\u5de5\u5177\u4e86\uff0c\u4f46\u662f\u8fd9\u4e9b\u5de5\u5177\u90fd\u8fd8\u662f\u9700\u8981\u4f9d\u8d56\u4e8e GOPATH \u3002 \u968f\u7740 Go1.11 \u7684\u53d1\u5e03\uff0cGolang \u5b98\u65b9\u7ed9\u6211\u4eec\u5e26\u6765\u4e86\u4f9d\u8d56\u7ba1\u7406\u7684\u5168\u65b0\u7279\u6027 Go Modules \uff0c\u8fd9\u662f Golang \u5168\u65b0\u7684\u4e00\u5957\u4f9d\u8d56\u7ba1\u7406\u7cfb\u7edf\u3002 \u65b0\u5efaModules \u8981\u4f7f\u7528 Go Modules \u9996\u5148\u9700\u8981\u4fdd\u8bc1\u4f60\u73af\u5883\u4e2d Golang \u7248\u672c\u5927\u4e8e 1.11 \uff1a $ go version go version go1.12.7 linux/amd64 Go Modules \u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u6d88\u9664 GOPATH \u7684\uff0c\u6240\u4ee5 \u65b0\u5efa\u7684\u9879\u76ee\u53ef\u4ee5\u5b8c\u5168\u4e0d\u7528\u653e\u5728 $GOPATH/src \u76ee\u5f55\u4e0b\u9762 \uff0c\u4efb\u4f55\u5730\u65b9\u90fd\u53ef\u4ee5\u3002 \u7b2c\u4e00\u6b65 \u5728 bashrc \u4e2d\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u4ee5\u542f\u52a8Go Modules: vim ~/bashrc export GO111MODULE=on \u7f16\u5199\u5e93\u51fd\u6570\uff1a package stringsx import ( fmt ) func Hello(name string) string{ return fmt.Sprintf( Hello, %s , name), nil } \u7b2c\u4e8c\u6b65 \u5728\u9879\u76ee\u6839\u76ee\u5f55\u521d\u59cb\u5316GO Modules: go mod init \u6a21\u5757\u540d # \u8be5\u547d\u4ee4\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210go.mod\u6587\u4ef6 # \u751f\u6210\u7684\u5185\u5bb9\u5c31\u662f\u5305\u542b\u4e00\u4e2a\u6a21\u5757\u540d\u79f0\u7684\u58f0\u660e module \u6a21\u5757\u540d \u6ce8\u610f\uff1a\u6a21\u5757\u540d\u975e\u5e38\u91cd\u8981\uff0c\u76f8\u5f53\u4e8e\u58f0\u660e\u4e86\u6a21\u5757\u7684\u540d\u79f0\uff0c\u540e\u9762\u4f7f\u7528\u8be5\u6a21\u5757\u5c31\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u540d\u79f0\u6765\u83b7\u53d6\u6a21\u5757 \u3002 \u7b2c\u4e09\u6b65 \u4e0a\u8ff0\u7b2c\u4e8c\u6b65\uff0c\u5c06\u5f53\u524d\u5305\u53d8\u6210\u4e86\u4e00\u4e2aModule\uff0c\u5c06\u4ee3\u7801\u63a8\u9001\u5230\u4ed3\u5e93\uff0c\u4ee5Github\u4e3a\u4f8b\uff0c\u4ed3\u5e93\u5730\u5740\u4e3a\uff1ahttps://github.com/sample_golang_module/example\u3002 git init git add . git commit -am init commit git remote add origin git@github.com:sample_golang_module/example.git git push -u origin master \u7b2c\u56db\u6b65 \u81f3\u6b64\uff0c\u5b8c\u6210\u4e86\u6700\u7b80\u5355\u7684Go Module\u7f16\u5199\uff0c\u5176\u4ed6\u4efb\u4f55\u5f00\u53d1\u8005\u60f3\u8981\u4f7f\u7528\u8fd9\u4e2a\u6a21\u5757\uff0c\u901a\u8fc7 go get \u547d\u4ee4\u6765\u83b7\u53d6\uff1a go get github.com/sample_golang_module/example \u4e0a\u9762\u7684\u547d\u4ee4\u662f\u83b7\u53d6master\u5206\u652f\u7684\u6700\u65b0\u4ee3\u7801\uff0c\u8fd9\u6ca1\u6709\u95ee\u9898\u4f46\u4e0d\u662f\u6700\u4f73\u5b9e\u8df5\uff0c\u6a21\u5757\u53ef\u80fd\u8981\u66f4\u65b0\u5185\u5bb9\u6216\u8005\u4fee\u590dBug\uff0c\u653e\u5728master\u5206\u652f\u4f1a\u9020\u6210\u4f7f\u7528\u8005\u7684\u6df7\u4e71\uff0c\u5f88\u53ef\u80fd\u4f7f\u7528\u8005\u7684\u4ee3\u7801\u5728\u6a21\u5757\u66f4\u65b0\u540e\u5c31\u4e0d\u517c\u5bb9\u4e86\uff0c Go Modules\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u7248\u672c\u95ee\u9898 \u3002 Module\u7248\u672c\u7ba1\u7406 Go Modules\u662f\u9700\u8981\u8fdb\u884c\u7248\u672c\u5316\u7ba1\u7406\u7684\uff0c\u5f3a\u70c8\u63a8\u8350\u4f7f\u7528 \u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236 \uff0c\u6700\u4e3b\u8981\u7684\u7248\u672c\u89c4\u5219\u5982\u4e0b\uff1a \u7248\u672c\u683c\u5f0f\uff1a\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u53f7 \u7248\u672c\u53f7\u9012\u589e\u89c4\u5219\u5982\u4e0b\uff1a \u4e3b\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u4e0d\u517c\u5bb9\u7684API\u4fee\u6539 \u6b21\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u529f\u80fd\u6027\u65b0\u589e \u4fee\u8ba2\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u95ee\u9898\u4fee\u6b63 \u5148\u884c\u7248\u672c\u53f7\u53ca\u7248\u672c\u7f16\u8bd1\u5143\u6570\u636e\u53ef\u4ee5\u52a0\u5230\u201c\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u53f7\u201d\u7684\u540e\u9762\uff0c\u4f5c\u4e3a\u5ef6\u4f38\u3002 \u5728\u4f7f\u7528Go Modules\u67e5\u627e\u7248\u672c\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u4ed3\u5e93\u4e2d\u7684tags\u5e76\u4e14\u67d0\u4e9b\u7248\u672c\u548c\u5176\u4ed6\u7248\u672c\u6709\u4e00\u4e9b\u4e0d\u540c\u4e4b\u5904\uff0c\u6bd4\u5982V2\u6216\u8005\u66f4\u9ad8\u7684\u7248\u672c\u8981\u548cV1\u7684\u7248\u672c\u6a21\u5757\u7684\u5bfc\u5165\u8def\u5f84\u662f\u4e0d\u540c\u7684\uff0c\u8fd9\u6837\u624d\u80fd\u901a\u8fc7\u6a21\u5757\u6765\u533a\u5206\u4f7f\u7528\u7684\u662f\u4e0d\u540c\u7684\u7248\u672c\uff0c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang\u4f1a\u83b7\u53d6\u4ed3\u5e93\u4e2d\u6700\u65b0\u7684tag\u7248\u672c \u3002 \u6700\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u53d1\u5e03\u6a21\u5757\u65f6\uff0c\u8981\u4f7f\u7528 git tag \u6765\u6807\u8bb0\u4ed3\u5e93\u7684\u7248\u672c\u3002 \u53d1\u5e03\u7b2c\u4e00\u4e2a\u7248\u672c \u53d1\u5e03release\u5305\uff0c\u9700\u8981\u7ed9\u5f53\u524d\u7684\u5305\u6253\u4e0atag\uff0c\u4f7f\u7528\u8bed\u4e49\u5316\u7684\u7248\u672c\uff0c\u5982v1.0.0\uff1a git tag v1.0.0 git push --tags \u66f4\u597d\u7684\u65b9\u6cd5\u662f\u521b\u5efa\u4e00\u4e2a\u540d\u53ebv1\u7684\u65b0\u5206\u652f\uff0c\u8fd9\u6837\u53ef\u4ee5\u65b9\u4fbf\u4ee5\u540e\u4fee\u590d\u5f53\u524d\u7248\u672c\u4ee3\u7801\u4e2d\u7684Bug\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230master\u6216\u8005\u5176\u4ed6\u5206\u652f\u7684\u4ee3\u7801\uff1a git checkout -b v1 git push -u origin v1 \u6a21\u5757\u4f7f\u7528 \u6a21\u5757\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u4f7f\u7528\u4e0a\u9762\u7684\u6a21\u5757\uff1a package main import ( fmt github.com/sample_golang_module/example/stringsx ) func main() { fmt.Println(stringsx.Hello( cnych )) } \u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528 github.com/sample_golang_module/example/stringsx \u8fd9\u4e2a\u5305\uff0c\u5728\u5bfc\u5165\u4e4b\u524d\uff0c\u4f7f\u7528 go get \u547d\u4ee4\u5c06\u8fd9\u4e2a\u5305\u62c9\u5230 GOPATH \u6216\u8005 vendor \u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u5c06\u8fd9\u4e2a\u5305\u5f53\u6210module\u6765\u4f7f\u7528\u3002 # \u5728\u5f53\u524d\u9879\u76ee\u4e0b\u521d\u59cb\u5316module go mod init # \u4e0d\u5199\u6a21\u5757\u540d\uff0c\u5219\u4e0epackage\u540d\u76f8\u540c go run main.go go: finding github.com/sample_golang_module/example v1.0.0 go: downloading github.com/sample_golang_module/example v1.0.0 Hello, cnych \u6267\u884c\u5b8c\u6210\u540e\uff0c\u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u7a0b\u5e8f\u4e2d\u5bfc\u5165\u7684\u5305\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u67e5\u770b\u5f53\u524d\u9879\u76ee\u7684 go.mod \u6587\u4ef6\uff1a module \u5f53\u524d\u9879\u76ee\u6a21\u5757\u540d require github.com/cnych/stardust v1.0.0 \u5e76\u4e14\u8fd8\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540d\u4e3a go.sum \u7684\u65b0\u6587\u4ef6\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4f9d\u8d56\u5305\u7684\u4e00\u4e9bhash\u4fe1\u606f\uff0c\u7528\u6765\u786e\u4fdd\u6587\u4ef6\u548c\u7248\u672c\u7684\u6b63\u786e\u6027\uff1a github.com/sample_golang_module/example v1.0.0 h1:8EcmmpIoIxq2VrzXdkwUYTD4OcMnYlZuLgNntZ+DxUE= github.com/sample_golang_module/example v1.0.0/go.mod h1:Qgo0xT9MhtGo0zz48gnmbT9XjO/9kuuWKIOIKVqAv28= \u6a21\u5757\u4f1a\u88ab\u4e0b\u8f7d\u5230 $GOPATH/pkg/mod \u76ee\u5f55\u4e0b\uff1a $ ls $GOPATH/pkg/mod/github.com/sample_golang_module/example example@v1.0.0 \u8fd9\u6837\u5c31\u6210\u529f\u4f7f\u7528\u4e86\u7f16\u5199\u7684\u6a21\u5757\u3002 \u53d1\u5e03\u4e00\u4e2abugfix\u7248\u672c \u53d1\u73b0\u6a21\u5757\u4e2d\u7684Hello\u51fd\u6570\u6709bug\uff0c\u9700\u8981\u4fee\u590d\u5e76\u53d1\u5e03\u4e00\u4e2a\u65b0\u7248\u672c\uff1a func Hello(name string) string{ return fmt.Sprintf( Hello, %s!!! , name) } \u5728v1\u8fd9\u4e2a\u5206\u652f\u4e0a\u8fdb\u884cfix\uff0c\u5b8c\u6210\u4e4b\u540emerge\u5230master\u5206\u652f\u4e0a\u53bb\uff0c\u7136\u540e\u53d1\u5e03\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u9075\u4ece\u8bed\u4e49\u5316\u7248\u672c\u9aa8\u5b50\u989d\uff0c\u4fee\u6b63\u4e00\u4e2abug\u4e4b\u540e\u9700\u8981\u6dfb\u52a0\u4fee\u6b63\u7248\u672c\u53f7\uff0c\u5373v1.0.1\uff1a git add . git commit -m fix Hello function #123 git tag v1.0.1 git push --tags origin v1 \u66f4\u65b0modules \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang\u4e0d\u4f1a\u81ea\u52a8\u66f4\u65b0\u6a21\u5757\uff0c\u5982\u679c\u81ea\u52a8\u66f4\u65b0\u4f1a\u9020\u6210\u7248\u672c\u7ba1\u7406\u6df7\u4e71\uff0c\u6240\u4ee5\u9700\u8981\u660e\u786e\u544a\u77e5Golang\u9700\u8981\u66f4\u65b0\u7684\u6a21\u5757\uff0c\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a \u8fd0\u884c go get -u xxx \u547d\u4ee4\u6765\u83b7\u53d6\u6700\u65b0\u7248\u7684\u6a21\u5757 \u8fd0\u884c go get package@version \u547d\u4ee4\u6765\u66f4\u65b0\u6307\u5b9a\u7248\u672c\u7684\u6a21\u5757 \u76f4\u63a5\u66f4\u65b0 go.mod \u6587\u4ef6\u4e2d\u7684\u6a21\u5757\u4f9d\u8d56\u7248\u672c\uff0c\u7136\u540e\u6267\u884c go mod tidy \u547d\u4ee4\u6765\u66f4\u65b0 \u66f4\u65b0\u4e4b\u540e\uff0c go.mod \u6587\u4ef6\u4e2d\u7684\u4f9d\u8d56\u6a21\u5757\u7684\u7248\u672c\u4f1a\u53d8\u5316\uff0c \uffe5GOPATH/pkg/mod \u6587\u4ef6\u5939\u4e2d\u4f1a\u589e\u52a0\u65b0\u7248\u672c\u7684\u6a21\u5757\u3002 \u5728Go Modules\u4e2d\uff0c\u6bcf\u4e2a\u7248\u672c\u90fd\u662f\u72ec\u7acb\u7684\u6587\u4ef6\u5939\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0\u7248\u672c\u51b2\u7a81\u3002 \u4e3b\u7248\u672c\u5347\u7ea7 \u6839\u636e\u8bed\u4e49\u5316\u7248\u672c\u89c4\u5219\uff0c\u4e3b\u7248\u672c\u5347\u7ea7\u7684\u4e0d\u5411\u540e\u517c\u5bb9\u7684\uff0c\u4ece Go Modules \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u4e3b\u7248\u672c\u662f\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u5757\u4e86\uff0c\u56e0\u4e3a\u4e24\u4e2a\u5927\u7248\u672c\u4e4b\u95f4\u662f\u4e92\u76f8\u4e0d\u517c\u5bb9\u7684\u3002 \u4fee\u6539\u6a21\u5757\u4e2d\u7684Hello\u51fd\u6570\uff1a func Hello(name, lang string) (string, error) { switch lang { case en : return fmt.Sprintf( Hi, %s! , name), nil case zh : return fmt.Sprintf( \u4f60\u597d, %s! , name), nil case fr : return fmt.Sprintf( Bonjour, %s! , name), nil default: return , fmt.Errorf( unknow language ) } } \u8fd9\u91cc\u9700\u8981\u5207\u6362\u5230master\u5206\u652f\u8fdb\u884c\u4fee\u6539\uff0c\u56e0\u4e3av1\u5206\u652f\u548c\u73b0\u5728\u4fee\u6539\u7684\u5185\u5bb9\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u7248\u672c\u3002 \u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u503c\u4e5f\u6709\u4e24\u4e2a\uff0c\u4e0ev1\u4e0d\u517c\u5bb9\u3002\u9700\u8981\u66f4\u65b0\u7248\u672c\u5230v2.0.0\uff0c \u901a\u8fc7\u66f4\u6539v2\u7248\u672c\u7684\u6a21\u5757\u8def\u5f84\u6765\u533a\u5206\u4e24\u4e2a\u5927\u7248\u672c \u3002\u6bd4\u5982 github.com/sample_golang_module/example/v2 \uff0c\u8fd9\u6837v2\u7248\u672c\u7684\u6a21\u5757\u548cv1\u7248\u672c\u7684\u6a21\u5757\u5c31\u662f\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u5757\u4e86\uff0c\u5728\u4f7f\u7528\u65b0\u7248\u6a21\u5757\u65f6\u5728\u6a21\u5757\u540d\u79f0\u540e\u9762\u52a0\u4e0av2\u5373\u53ef\u3002 module github.com/cnych/stardust/v2 \u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u7ed9\u5f53\u524d\u7248\u672c\u6dfb\u52a0\u4e00\u4e2av2.0.0\u7684 git tag \u6216\u8005\u521b\u5efa\u4e00\u4e2a\u540d\u4e3av2\u7684\u5206\u652f\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u7248\u672c\u4e4b\u95f4\u7684\u5f71\u54cd\u964d\u5230\u6700\u4f4e\uff1a git add . git commit -m change Hello function to support lang git checkout -b v2 git tag v2.0.0 git push origin v2 --tags v2 \u7248\u672c\u7684\u6a21\u5757\u5c31\u53d1\u5e03\u6210\u529f\uff0c\u4e4b\u524d\u7a0b\u5e8f\u4e5f\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u5f71\u54cd\uff0c\u8fd8\u662f\u7ee7\u7eed\u4f7f\u7528\u73b0\u6709\u7684 v1.0.1 \u7248\u672c\uff0c\u800c\u4e14\u4f7f\u7528 go get -u \u547d\u4ee4\u4e5f\u4e0d\u4f1a\u62c9\u53d6\u6700\u65b0\u7684 v2.0.0 \u7248\u672c\u4ee3\u7801\u3002 \u7528\u6237\u8981\u8bd5\u7528v2.0.0\u7248\u672c\u7684\u6a21\u5757\uff0c\u53ea\u9700\u8981\u5355\u72ec\u5f15\u5165v2\u7248\u672c\u7684\u6a21\u5757\u5373\u53ef\uff1a package main import ( fmt github.com/sample_golang_module/example/stringsx stringsV2 github.com/sample_golang_module/example/v2/stringsx ) func main() { fmt.Println(stringsx.Hello( cnych )) if greet, err := stringsV2.Hello( cnych , zh ); err != nil { fmt.Println(err) } else { fmt.Println(greet) } } go run main.go\u547d\u4ee4\u4f1a\u81ea\u52a8\u62c9\u53d6v2\u6a21\u5757\u7684\u4ee3\u7801\uff1a $ go run main.go go: finding github.com/sample_golang_module/example/v2 v2.0.0 go: downloading github.com/sample_golang_module/example/v2 v1.0.0 Hi, cnych\uff01\uff01\uff01 \u4f60\u597d, cnych! \u5728\u540c\u4e00\u4e2a go \u6587\u4ef6\u4e2d\u5c31\u4f7f\u7528\u4e24\u4e2a\u4e0d\u517c\u5bb9\u7248\u672c\u7684\u6a21\u5757\u3002\u540c\u6837\u8fd9\u4e2a\u65f6\u5019\u518d\u6b21\u67e5\u770b\u4e0b go.mod \u6587\u4ef6\u7684\u53d8\u5316\uff1a module \u6a21\u5757\u540d require github.com/sample_golang_module/example v1.0.1 require github.com/sample_golang_module/example/v2 v2.0.0 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang \u662f\u4e0d\u4f1a\u4ece go.mod \u6587\u4ef6\u4e2d\u5220\u9664\u4f9d\u8d56\u9879\u7684\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e0d\u4f7f\u7528\u7684\u4e00\u4e9b\u4f9d\u8d56\u9879\u9700\u8981\u6e05\u7406\uff0c\u53ef\u4ee5\u4f7f\u7528 tidy \u547d\u4ee4\uff1a go mod tidy \u8be5\u547d\u4ee4\u4f1a\u6e05\u9664\u6ca1\u6709\u4f7f\u7528\u7684\u6a21\u5757\uff0c\u4e5f\u4f1a\u66f4\u65b0\u6a21\u5757\u5230\u6307\u5b9a\u7684\u6700\u65b0\u7248\u672c\u3002 Vendor Go Modules \u9ed8\u8ba4\u4f1a\u5ffd\u7565 vendor/ \u8fd9\u4e2a\u76ee\u5f55\uff0c\u4f46\u662f\u5982\u679c\u8fd8\u60f3\u5c06\u4f9d\u8d56\u653e\u5165 vendor \u76ee\u5f55\u7684\u8bdd\uff0c\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a go mod vendor \u8be5\u547d\u4ee4\u4f1a\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a vendor/ \u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u4f1a\u5305\u542b\u6240\u6709\u7684\u4f9d\u8d56\u6a21\u5757\u4ee3\u7801\uff0c\u5e76\u4e14\u4f1a\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3a modules.txt \u7684\u6587\u4ef6\uff0c\u7528\u6765\u8bb0\u5f55\u4f9d\u8d56\u5305\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u6bd4\u8f83\u7c7b\u4f3c\u4e8e govendor \u4e2d\u7684 vendor.json \u6587\u4ef6\u3002 \u4e0d\u8fc7\u5efa\u8bae\u8fd8\u662f\u4e0d\u8981\u4f7f\u7528\u8be5\u547d\u4ee4\uff0c\u5c3d\u91cf\u53bb\u5fd8\u6389 vendor \u7684\u5b58\u5728\u3002 \u955c\u50cf\u4ed3\u5e93 \u5982\u679c\u6709\u4e00\u4e9b\u4f9d\u8d56\u5305\u4e0b\u8f7d\u4e0d\u4e0b\u6765\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 GOPROXY \u8fd9\u4e2a\u53c2\u6570\u6765\u8bbe\u7f6e\u6a21\u5757\u4ee3\u7406\uff0c\u6bd4\u5982\uff1a $ export GOPROXY= https://goproxy.io \u963f\u91cc\u4e91\u4e5f\u63d0\u4f9b\u4e86 Go Modules \u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff1ahttp://mirrors.aliyun.com/goproxy/\uff0c\u4f7f\u7528\u5f88\u7b80\u5355\u5c31\u4e24\u6b65\uff1a \u4f7f\u7528 go1.11 \u4ee5\u4e0a\u7248\u672c\u5e76\u5f00\u542f go module \u673a\u5236\uff1a export GO111MODULE=on \u5bfc\u51fa GOPROXY \u73af\u5883\u53d8\u91cf\uff1a export GOPROXY=https://mirrors.aliyun.com/goproxy/ \u5982\u679c\u4f60\u60f3\u4e0a\u9762\u7684\u914d\u7f6e\u59cb\u7ec8\u751f\u6548\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e24\u6761\u547d\u4ee4\u6dfb\u52a0\u5230. bashrc \u4e2d\u53bb\u3002 \u642d\u5efa\u79c1\u6709\u4ed3\u5e93 \u9664\u4e86\u4f7f\u7528\u516c\u6709\u7684 Go Modules \u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\u4e4b\u5916\uff0c\u5f88\u591a\u65f6\u5019\u6211\u4eec\u5728\u516c\u53f8\u5185\u90e8\u9700\u8981\u642d\u5efa\u79c1\u6709\u7684\u4ee3\u7406\u670d\u52a1\uff0c\u7279\u522b\u662f\u5728\u4f7f\u7528 CI/CD \u7684\u65f6\u5019\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u79c1\u6709\u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff0c\u4f1a\u5927\u5927\u7684\u63d0\u4f9b\u5e94\u7528\u7684\u6784\u5efa\u6548\u7387\u3002 \u53ef\u4ee5\u4f7f\u7528 Athens \u6765\u642d\u5efa\u79c1\u6709\u7684\u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff0c\u642d\u5efa\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u7528 docker \u955c\u50cf\u8fd0\u884c\u4e00\u4e2a\u670d\u52a1\u5373\u53ef\uff1a export ATHENS_STORAGE=~/athens-storage mkdir -p $ATHENS_STORAGE docker run -d -v $ATHENS_STORAGE:/var/lib/athens \\ -e ATHENS_DISK_STORAGE_ROOT=/var/lib/athens \\ -e ATHENS_STORAGE_TYPE=disk \\ --name goproxy \\ --restart always \\ -p 3000:3000 \\ gomods/athens:latest \u5176\u4e2d ATHENS_STORAGE \u662f\u7528\u6765\u5b58\u653e\u6211\u4eec\u4e0b\u8f7d\u4e0b\u6765\u7684\u6a21\u5757\u7684\u672c\u5730\u8def\u5f84\uff0c\u53e6\u5916 ATHENS \u8fd8\u652f\u6301\u5176\u4ed6\u7c7b\u578b\u7684\u5b58\u50a8\uff0c\u6bd4\u5982 \u5185\u5b58, AWS S3 \u6216 Minio\uff0c\u90fd\u662f OK \u7684\u3002 \u7136\u540e\u4fee\u6539 GOPROXY \u914d\u7f6e\uff1a export GOPROXY=http://127.0.0.1:3000 \u603b\u7ed3 \u4e00\u53e5\u8bdd\uff1aGo Modules \u771f\u7684\u7528\u8d77\u6765\u975e\u5e38\u723d\uff0c\u7279\u522b\u662f\u6d88\u9664\u4e86 GOPATH\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5bf9\u4e8e Golang \u521d\u5b66\u8005\u6765\u8bf4\u662f\u975e\u5e38\u70e6\u4eba\u7684\uff0c\u5f88\u96be\u7406\u89e3\u4e3a\u4ec0\u4e48\u9700\u8981\u8fdb\u5165\u5230\u7279\u5b9a\u76ee\u5f55\u4e0b\u9762\u624d\u53ef\u4ee5\u7f16\u5199 Go \u4ee3\u7801\uff0c\u73b0\u5728\u4e0d\u7528\u62c5\u5fc3\u4e86\uff0c\u76f4\u63a5\u4f7f\u7528 Go Modules \u5c31\u884c\u3002","title":"Go Modules"},{"location":"Language/Basic/Go-Modules/#go-modules","text":"Go \u8bed\u8a00\u4e2d\u4e00\u76f4\u88ab\u4eba\u8bdf\u75c5\u7684\u4e00\u4e2a\u95ee\u9898\u5c31\u662f \u6ca1\u6709\u4e00\u4e2a\u6bd4\u8f83\u597d\u7528\u7684\u4f9d\u8d56\u7ba1\u7406\u7cfb\u7edf \u3002 GOPATH \u7684\u8bbe\u8ba1\u8ba9\u5f00\u53d1\u8005\u4e00\u76f4\u6709\u5f88\u591a\u6028\u8a00\uff0c\u5728 Go \u8bed\u8a00\u5feb\u901f\u53d1\u5c55\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u51fa\u73b0\u4e86\u4e00\u4e9b\u6bd4\u8f83\u4f18\u79c0\u7684\u4f9d\u8d56\u7ba1\u7406\u5de5\u5177\uff0c\u6bd4\u5982: govendor dep glide\u7b49 \u6709\u4e00\u4e9b\u5dee\u4e0d\u591a\u6210\u4e86\u534a\u5b98\u65b9\u7684\u5de5\u5177\u4e86\uff0c\u4f46\u662f\u8fd9\u4e9b\u5de5\u5177\u90fd\u8fd8\u662f\u9700\u8981\u4f9d\u8d56\u4e8e GOPATH \u3002 \u968f\u7740 Go1.11 \u7684\u53d1\u5e03\uff0cGolang \u5b98\u65b9\u7ed9\u6211\u4eec\u5e26\u6765\u4e86\u4f9d\u8d56\u7ba1\u7406\u7684\u5168\u65b0\u7279\u6027 Go Modules \uff0c\u8fd9\u662f Golang \u5168\u65b0\u7684\u4e00\u5957\u4f9d\u8d56\u7ba1\u7406\u7cfb\u7edf\u3002","title":"Go Modules"},{"location":"Language/Basic/Go-Modules/#modules","text":"\u8981\u4f7f\u7528 Go Modules \u9996\u5148\u9700\u8981\u4fdd\u8bc1\u4f60\u73af\u5883\u4e2d Golang \u7248\u672c\u5927\u4e8e 1.11 \uff1a $ go version go version go1.12.7 linux/amd64 Go Modules \u4e3b\u8981\u5c31\u662f\u4e3a\u4e86\u6d88\u9664 GOPATH \u7684\uff0c\u6240\u4ee5 \u65b0\u5efa\u7684\u9879\u76ee\u53ef\u4ee5\u5b8c\u5168\u4e0d\u7528\u653e\u5728 $GOPATH/src \u76ee\u5f55\u4e0b\u9762 \uff0c\u4efb\u4f55\u5730\u65b9\u90fd\u53ef\u4ee5\u3002","title":"\u65b0\u5efaModules"},{"location":"Language/Basic/Go-Modules/#_1","text":"\u5728 bashrc \u4e2d\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u4ee5\u542f\u52a8Go Modules: vim ~/bashrc export GO111MODULE=on \u7f16\u5199\u5e93\u51fd\u6570\uff1a package stringsx import ( fmt ) func Hello(name string) string{ return fmt.Sprintf( Hello, %s , name), nil }","title":"\u7b2c\u4e00\u6b65"},{"location":"Language/Basic/Go-Modules/#_2","text":"\u5728\u9879\u76ee\u6839\u76ee\u5f55\u521d\u59cb\u5316GO Modules: go mod init \u6a21\u5757\u540d # \u8be5\u547d\u4ee4\u4f1a\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210go.mod\u6587\u4ef6 # \u751f\u6210\u7684\u5185\u5bb9\u5c31\u662f\u5305\u542b\u4e00\u4e2a\u6a21\u5757\u540d\u79f0\u7684\u58f0\u660e module \u6a21\u5757\u540d \u6ce8\u610f\uff1a\u6a21\u5757\u540d\u975e\u5e38\u91cd\u8981\uff0c\u76f8\u5f53\u4e8e\u58f0\u660e\u4e86\u6a21\u5757\u7684\u540d\u79f0\uff0c\u540e\u9762\u4f7f\u7528\u8be5\u6a21\u5757\u5c31\u9700\u8981\u4f7f\u7528\u8fd9\u4e2a\u540d\u79f0\u6765\u83b7\u53d6\u6a21\u5757 \u3002","title":"\u7b2c\u4e8c\u6b65"},{"location":"Language/Basic/Go-Modules/#_3","text":"\u4e0a\u8ff0\u7b2c\u4e8c\u6b65\uff0c\u5c06\u5f53\u524d\u5305\u53d8\u6210\u4e86\u4e00\u4e2aModule\uff0c\u5c06\u4ee3\u7801\u63a8\u9001\u5230\u4ed3\u5e93\uff0c\u4ee5Github\u4e3a\u4f8b\uff0c\u4ed3\u5e93\u5730\u5740\u4e3a\uff1ahttps://github.com/sample_golang_module/example\u3002 git init git add . git commit -am init commit git remote add origin git@github.com:sample_golang_module/example.git git push -u origin master","title":"\u7b2c\u4e09\u6b65"},{"location":"Language/Basic/Go-Modules/#_4","text":"\u81f3\u6b64\uff0c\u5b8c\u6210\u4e86\u6700\u7b80\u5355\u7684Go Module\u7f16\u5199\uff0c\u5176\u4ed6\u4efb\u4f55\u5f00\u53d1\u8005\u60f3\u8981\u4f7f\u7528\u8fd9\u4e2a\u6a21\u5757\uff0c\u901a\u8fc7 go get \u547d\u4ee4\u6765\u83b7\u53d6\uff1a go get github.com/sample_golang_module/example \u4e0a\u9762\u7684\u547d\u4ee4\u662f\u83b7\u53d6master\u5206\u652f\u7684\u6700\u65b0\u4ee3\u7801\uff0c\u8fd9\u6ca1\u6709\u95ee\u9898\u4f46\u4e0d\u662f\u6700\u4f73\u5b9e\u8df5\uff0c\u6a21\u5757\u53ef\u80fd\u8981\u66f4\u65b0\u5185\u5bb9\u6216\u8005\u4fee\u590dBug\uff0c\u653e\u5728master\u5206\u652f\u4f1a\u9020\u6210\u4f7f\u7528\u8005\u7684\u6df7\u4e71\uff0c\u5f88\u53ef\u80fd\u4f7f\u7528\u8005\u7684\u4ee3\u7801\u5728\u6a21\u5757\u66f4\u65b0\u540e\u5c31\u4e0d\u517c\u5bb9\u4e86\uff0c Go Modules\u53ef\u4ee5\u5f88\u597d\u7684\u89e3\u51b3\u7248\u672c\u95ee\u9898 \u3002","title":"\u7b2c\u56db\u6b65"},{"location":"Language/Basic/Go-Modules/#module","text":"Go Modules\u662f\u9700\u8981\u8fdb\u884c\u7248\u672c\u5316\u7ba1\u7406\u7684\uff0c\u5f3a\u70c8\u63a8\u8350\u4f7f\u7528 \u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236 \uff0c\u6700\u4e3b\u8981\u7684\u7248\u672c\u89c4\u5219\u5982\u4e0b\uff1a \u7248\u672c\u683c\u5f0f\uff1a\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u53f7 \u7248\u672c\u53f7\u9012\u589e\u89c4\u5219\u5982\u4e0b\uff1a \u4e3b\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u4e0d\u517c\u5bb9\u7684API\u4fee\u6539 \u6b21\u7248\u672c\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u529f\u80fd\u6027\u65b0\u589e \u4fee\u8ba2\u53f7\uff1a\u5f53\u4f60\u505a\u4e86\u5411\u4e0b\u517c\u5bb9\u7684\u95ee\u9898\u4fee\u6b63 \u5148\u884c\u7248\u672c\u53f7\u53ca\u7248\u672c\u7f16\u8bd1\u5143\u6570\u636e\u53ef\u4ee5\u52a0\u5230\u201c\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u53f7\u201d\u7684\u540e\u9762\uff0c\u4f5c\u4e3a\u5ef6\u4f38\u3002 \u5728\u4f7f\u7528Go Modules\u67e5\u627e\u7248\u672c\u7684\u65f6\u5019\uff0c\u4f1a\u4f7f\u7528\u4ed3\u5e93\u4e2d\u7684tags\u5e76\u4e14\u67d0\u4e9b\u7248\u672c\u548c\u5176\u4ed6\u7248\u672c\u6709\u4e00\u4e9b\u4e0d\u540c\u4e4b\u5904\uff0c\u6bd4\u5982V2\u6216\u8005\u66f4\u9ad8\u7684\u7248\u672c\u8981\u548cV1\u7684\u7248\u672c\u6a21\u5757\u7684\u5bfc\u5165\u8def\u5f84\u662f\u4e0d\u540c\u7684\uff0c\u8fd9\u6837\u624d\u80fd\u901a\u8fc7\u6a21\u5757\u6765\u533a\u5206\u4f7f\u7528\u7684\u662f\u4e0d\u540c\u7684\u7248\u672c\uff0c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang\u4f1a\u83b7\u53d6\u4ed3\u5e93\u4e2d\u6700\u65b0\u7684tag\u7248\u672c \u3002 \u6700\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u53d1\u5e03\u6a21\u5757\u65f6\uff0c\u8981\u4f7f\u7528 git tag \u6765\u6807\u8bb0\u4ed3\u5e93\u7684\u7248\u672c\u3002","title":"Module\u7248\u672c\u7ba1\u7406"},{"location":"Language/Basic/Go-Modules/#_5","text":"\u53d1\u5e03release\u5305\uff0c\u9700\u8981\u7ed9\u5f53\u524d\u7684\u5305\u6253\u4e0atag\uff0c\u4f7f\u7528\u8bed\u4e49\u5316\u7684\u7248\u672c\uff0c\u5982v1.0.0\uff1a git tag v1.0.0 git push --tags \u66f4\u597d\u7684\u65b9\u6cd5\u662f\u521b\u5efa\u4e00\u4e2a\u540d\u53ebv1\u7684\u65b0\u5206\u652f\uff0c\u8fd9\u6837\u53ef\u4ee5\u65b9\u4fbf\u4ee5\u540e\u4fee\u590d\u5f53\u524d\u7248\u672c\u4ee3\u7801\u4e2d\u7684Bug\uff0c\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u5230master\u6216\u8005\u5176\u4ed6\u5206\u652f\u7684\u4ee3\u7801\uff1a git checkout -b v1 git push -u origin v1","title":"\u53d1\u5e03\u7b2c\u4e00\u4e2a\u7248\u672c"},{"location":"Language/Basic/Go-Modules/#_6","text":"\u6a21\u5757\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u521b\u5efa\u4e00\u4e2a\u7b80\u5355\u7684\u7a0b\u5e8f\u6765\u4f7f\u7528\u4e0a\u9762\u7684\u6a21\u5757\uff1a package main import ( fmt github.com/sample_golang_module/example/stringsx ) func main() { fmt.Println(stringsx.Hello( cnych )) } \u5728\u7a0b\u5e8f\u4e2d\u4f7f\u7528 github.com/sample_golang_module/example/stringsx \u8fd9\u4e2a\u5305\uff0c\u5728\u5bfc\u5165\u4e4b\u524d\uff0c\u4f7f\u7528 go get \u547d\u4ee4\u5c06\u8fd9\u4e2a\u5305\u62c9\u5230 GOPATH \u6216\u8005 vendor \u76ee\u5f55\u4e0b\u5373\u53ef\uff0c\u5c06\u8fd9\u4e2a\u5305\u5f53\u6210module\u6765\u4f7f\u7528\u3002 # \u5728\u5f53\u524d\u9879\u76ee\u4e0b\u521d\u59cb\u5316module go mod init # \u4e0d\u5199\u6a21\u5757\u540d\uff0c\u5219\u4e0epackage\u540d\u76f8\u540c go run main.go go: finding github.com/sample_golang_module/example v1.0.0 go: downloading github.com/sample_golang_module/example v1.0.0 Hello, cnych \u6267\u884c\u5b8c\u6210\u540e\uff0c\u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u81ea\u52a8\u4e0b\u8f7d\u7a0b\u5e8f\u4e2d\u5bfc\u5165\u7684\u5305\uff0c\u4e0b\u8f7d\u5b8c\u6210\u540e\u67e5\u770b\u5f53\u524d\u9879\u76ee\u7684 go.mod \u6587\u4ef6\uff1a module \u5f53\u524d\u9879\u76ee\u6a21\u5757\u540d require github.com/cnych/stardust v1.0.0 \u5e76\u4e14\u8fd8\u5728\u5f53\u524d\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2a\u540d\u4e3a go.sum \u7684\u65b0\u6587\u4ef6\uff0c\u91cc\u9762\u5305\u542b\u4e86\u4f9d\u8d56\u5305\u7684\u4e00\u4e9bhash\u4fe1\u606f\uff0c\u7528\u6765\u786e\u4fdd\u6587\u4ef6\u548c\u7248\u672c\u7684\u6b63\u786e\u6027\uff1a github.com/sample_golang_module/example v1.0.0 h1:8EcmmpIoIxq2VrzXdkwUYTD4OcMnYlZuLgNntZ+DxUE= github.com/sample_golang_module/example v1.0.0/go.mod h1:Qgo0xT9MhtGo0zz48gnmbT9XjO/9kuuWKIOIKVqAv28= \u6a21\u5757\u4f1a\u88ab\u4e0b\u8f7d\u5230 $GOPATH/pkg/mod \u76ee\u5f55\u4e0b\uff1a $ ls $GOPATH/pkg/mod/github.com/sample_golang_module/example example@v1.0.0 \u8fd9\u6837\u5c31\u6210\u529f\u4f7f\u7528\u4e86\u7f16\u5199\u7684\u6a21\u5757\u3002","title":"\u6a21\u5757\u4f7f\u7528"},{"location":"Language/Basic/Go-Modules/#bugfix","text":"\u53d1\u73b0\u6a21\u5757\u4e2d\u7684Hello\u51fd\u6570\u6709bug\uff0c\u9700\u8981\u4fee\u590d\u5e76\u53d1\u5e03\u4e00\u4e2a\u65b0\u7248\u672c\uff1a func Hello(name string) string{ return fmt.Sprintf( Hello, %s!!! , name) } \u5728v1\u8fd9\u4e2a\u5206\u652f\u4e0a\u8fdb\u884cfix\uff0c\u5b8c\u6210\u4e4b\u540emerge\u5230master\u5206\u652f\u4e0a\u53bb\uff0c\u7136\u540e\u53d1\u5e03\u4e00\u4e2a\u65b0\u7684\u7248\u672c\uff0c\u9075\u4ece\u8bed\u4e49\u5316\u7248\u672c\u9aa8\u5b50\u989d\uff0c\u4fee\u6b63\u4e00\u4e2abug\u4e4b\u540e\u9700\u8981\u6dfb\u52a0\u4fee\u6b63\u7248\u672c\u53f7\uff0c\u5373v1.0.1\uff1a git add . git commit -m fix Hello function #123 git tag v1.0.1 git push --tags origin v1","title":"\u53d1\u5e03\u4e00\u4e2abugfix\u7248\u672c"},{"location":"Language/Basic/Go-Modules/#modules_1","text":"\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang\u4e0d\u4f1a\u81ea\u52a8\u66f4\u65b0\u6a21\u5757\uff0c\u5982\u679c\u81ea\u52a8\u66f4\u65b0\u4f1a\u9020\u6210\u7248\u672c\u7ba1\u7406\u6df7\u4e71\uff0c\u6240\u4ee5\u9700\u8981\u660e\u786e\u544a\u77e5Golang\u9700\u8981\u66f4\u65b0\u7684\u6a21\u5757\uff0c\u901a\u8fc7\u4ee5\u4e0b\u51e0\u79cd\u65b9\u5f0f\uff1a \u8fd0\u884c go get -u xxx \u547d\u4ee4\u6765\u83b7\u53d6\u6700\u65b0\u7248\u7684\u6a21\u5757 \u8fd0\u884c go get package@version \u547d\u4ee4\u6765\u66f4\u65b0\u6307\u5b9a\u7248\u672c\u7684\u6a21\u5757 \u76f4\u63a5\u66f4\u65b0 go.mod \u6587\u4ef6\u4e2d\u7684\u6a21\u5757\u4f9d\u8d56\u7248\u672c\uff0c\u7136\u540e\u6267\u884c go mod tidy \u547d\u4ee4\u6765\u66f4\u65b0 \u66f4\u65b0\u4e4b\u540e\uff0c go.mod \u6587\u4ef6\u4e2d\u7684\u4f9d\u8d56\u6a21\u5757\u7684\u7248\u672c\u4f1a\u53d8\u5316\uff0c \uffe5GOPATH/pkg/mod \u6587\u4ef6\u5939\u4e2d\u4f1a\u589e\u52a0\u65b0\u7248\u672c\u7684\u6a21\u5757\u3002 \u5728Go Modules\u4e2d\uff0c\u6bcf\u4e2a\u7248\u672c\u90fd\u662f\u72ec\u7acb\u7684\u6587\u4ef6\u5939\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0\u7248\u672c\u51b2\u7a81\u3002","title":"\u66f4\u65b0modules"},{"location":"Language/Basic/Go-Modules/#_7","text":"\u6839\u636e\u8bed\u4e49\u5316\u7248\u672c\u89c4\u5219\uff0c\u4e3b\u7248\u672c\u5347\u7ea7\u7684\u4e0d\u5411\u540e\u517c\u5bb9\u7684\uff0c\u4ece Go Modules \u7684\u89d2\u5ea6\u6765\u770b\uff0c\u4e3b\u7248\u672c\u662f\u4e00\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u5757\u4e86\uff0c\u56e0\u4e3a\u4e24\u4e2a\u5927\u7248\u672c\u4e4b\u95f4\u662f\u4e92\u76f8\u4e0d\u517c\u5bb9\u7684\u3002 \u4fee\u6539\u6a21\u5757\u4e2d\u7684Hello\u51fd\u6570\uff1a func Hello(name, lang string) (string, error) { switch lang { case en : return fmt.Sprintf( Hi, %s! , name), nil case zh : return fmt.Sprintf( \u4f60\u597d, %s! , name), nil case fr : return fmt.Sprintf( Bonjour, %s! , name), nil default: return , fmt.Errorf( unknow language ) } } \u8fd9\u91cc\u9700\u8981\u5207\u6362\u5230master\u5206\u652f\u8fdb\u884c\u4fee\u6539\uff0c\u56e0\u4e3av1\u5206\u652f\u548c\u73b0\u5728\u4fee\u6539\u7684\u5185\u5bb9\u662f\u5b8c\u5168\u4e0d\u540c\u7684\u7248\u672c\u3002 \u51fd\u6570\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u8fd4\u56de\u503c\u4e5f\u6709\u4e24\u4e2a\uff0c\u4e0ev1\u4e0d\u517c\u5bb9\u3002\u9700\u8981\u66f4\u65b0\u7248\u672c\u5230v2.0.0\uff0c \u901a\u8fc7\u66f4\u6539v2\u7248\u672c\u7684\u6a21\u5757\u8def\u5f84\u6765\u533a\u5206\u4e24\u4e2a\u5927\u7248\u672c \u3002\u6bd4\u5982 github.com/sample_golang_module/example/v2 \uff0c\u8fd9\u6837v2\u7248\u672c\u7684\u6a21\u5757\u548cv1\u7248\u672c\u7684\u6a21\u5757\u5c31\u662f\u4e24\u4e2a\u5b8c\u5168\u4e0d\u540c\u7684\u6a21\u5757\u4e86\uff0c\u5728\u4f7f\u7528\u65b0\u7248\u6a21\u5757\u65f6\u5728\u6a21\u5757\u540d\u79f0\u540e\u9762\u52a0\u4e0av2\u5373\u53ef\u3002 module github.com/cnych/stardust/v2 \u63a5\u4e0b\u6765\u7684\u64cd\u4f5c\u7ed9\u5f53\u524d\u7248\u672c\u6dfb\u52a0\u4e00\u4e2av2.0.0\u7684 git tag \u6216\u8005\u521b\u5efa\u4e00\u4e2a\u540d\u4e3av2\u7684\u5206\u652f\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06\u7248\u672c\u4e4b\u95f4\u7684\u5f71\u54cd\u964d\u5230\u6700\u4f4e\uff1a git add . git commit -m change Hello function to support lang git checkout -b v2 git tag v2.0.0 git push origin v2 --tags v2 \u7248\u672c\u7684\u6a21\u5757\u5c31\u53d1\u5e03\u6210\u529f\uff0c\u4e4b\u524d\u7a0b\u5e8f\u4e5f\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u5f71\u54cd\uff0c\u8fd8\u662f\u7ee7\u7eed\u4f7f\u7528\u73b0\u6709\u7684 v1.0.1 \u7248\u672c\uff0c\u800c\u4e14\u4f7f\u7528 go get -u \u547d\u4ee4\u4e5f\u4e0d\u4f1a\u62c9\u53d6\u6700\u65b0\u7684 v2.0.0 \u7248\u672c\u4ee3\u7801\u3002 \u7528\u6237\u8981\u8bd5\u7528v2.0.0\u7248\u672c\u7684\u6a21\u5757\uff0c\u53ea\u9700\u8981\u5355\u72ec\u5f15\u5165v2\u7248\u672c\u7684\u6a21\u5757\u5373\u53ef\uff1a package main import ( fmt github.com/sample_golang_module/example/stringsx stringsV2 github.com/sample_golang_module/example/v2/stringsx ) func main() { fmt.Println(stringsx.Hello( cnych )) if greet, err := stringsV2.Hello( cnych , zh ); err != nil { fmt.Println(err) } else { fmt.Println(greet) } } go run main.go\u547d\u4ee4\u4f1a\u81ea\u52a8\u62c9\u53d6v2\u6a21\u5757\u7684\u4ee3\u7801\uff1a $ go run main.go go: finding github.com/sample_golang_module/example/v2 v2.0.0 go: downloading github.com/sample_golang_module/example/v2 v1.0.0 Hi, cnych\uff01\uff01\uff01 \u4f60\u597d, cnych! \u5728\u540c\u4e00\u4e2a go \u6587\u4ef6\u4e2d\u5c31\u4f7f\u7528\u4e24\u4e2a\u4e0d\u517c\u5bb9\u7248\u672c\u7684\u6a21\u5757\u3002\u540c\u6837\u8fd9\u4e2a\u65f6\u5019\u518d\u6b21\u67e5\u770b\u4e0b go.mod \u6587\u4ef6\u7684\u53d8\u5316\uff1a module \u6a21\u5757\u540d require github.com/sample_golang_module/example v1.0.1 require github.com/sample_golang_module/example/v2 v2.0.0 \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cGolang \u662f\u4e0d\u4f1a\u4ece go.mod \u6587\u4ef6\u4e2d\u5220\u9664\u4f9d\u8d56\u9879\u7684\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e0d\u4f7f\u7528\u7684\u4e00\u4e9b\u4f9d\u8d56\u9879\u9700\u8981\u6e05\u7406\uff0c\u53ef\u4ee5\u4f7f\u7528 tidy \u547d\u4ee4\uff1a go mod tidy \u8be5\u547d\u4ee4\u4f1a\u6e05\u9664\u6ca1\u6709\u4f7f\u7528\u7684\u6a21\u5757\uff0c\u4e5f\u4f1a\u66f4\u65b0\u6a21\u5757\u5230\u6307\u5b9a\u7684\u6700\u65b0\u7248\u672c\u3002","title":"\u4e3b\u7248\u672c\u5347\u7ea7"},{"location":"Language/Basic/Go-Modules/#vendor","text":"Go Modules \u9ed8\u8ba4\u4f1a\u5ffd\u7565 vendor/ \u8fd9\u4e2a\u76ee\u5f55\uff0c\u4f46\u662f\u5982\u679c\u8fd8\u60f3\u5c06\u4f9d\u8d56\u653e\u5165 vendor \u76ee\u5f55\u7684\u8bdd\uff0c\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff1a go mod vendor \u8be5\u547d\u4ee4\u4f1a\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a vendor/ \u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u4f1a\u5305\u542b\u6240\u6709\u7684\u4f9d\u8d56\u6a21\u5757\u4ee3\u7801\uff0c\u5e76\u4e14\u4f1a\u5728\u8be5\u76ee\u5f55\u4e0b\u9762\u6dfb\u52a0\u4e00\u4e2a\u540d\u4e3a modules.txt \u7684\u6587\u4ef6\uff0c\u7528\u6765\u8bb0\u5f55\u4f9d\u8d56\u5305\u7684\u4e00\u4e9b\u4fe1\u606f\uff0c\u6bd4\u8f83\u7c7b\u4f3c\u4e8e govendor \u4e2d\u7684 vendor.json \u6587\u4ef6\u3002 \u4e0d\u8fc7\u5efa\u8bae\u8fd8\u662f\u4e0d\u8981\u4f7f\u7528\u8be5\u547d\u4ee4\uff0c\u5c3d\u91cf\u53bb\u5fd8\u6389 vendor \u7684\u5b58\u5728\u3002","title":"Vendor"},{"location":"Language/Basic/Go-Modules/#_8","text":"\u5982\u679c\u6709\u4e00\u4e9b\u4f9d\u8d56\u5305\u4e0b\u8f7d\u4e0d\u4e0b\u6765\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 GOPROXY \u8fd9\u4e2a\u53c2\u6570\u6765\u8bbe\u7f6e\u6a21\u5757\u4ee3\u7406\uff0c\u6bd4\u5982\uff1a $ export GOPROXY= https://goproxy.io \u963f\u91cc\u4e91\u4e5f\u63d0\u4f9b\u4e86 Go Modules \u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff1ahttp://mirrors.aliyun.com/goproxy/\uff0c\u4f7f\u7528\u5f88\u7b80\u5355\u5c31\u4e24\u6b65\uff1a \u4f7f\u7528 go1.11 \u4ee5\u4e0a\u7248\u672c\u5e76\u5f00\u542f go module \u673a\u5236\uff1a export GO111MODULE=on \u5bfc\u51fa GOPROXY \u73af\u5883\u53d8\u91cf\uff1a export GOPROXY=https://mirrors.aliyun.com/goproxy/ \u5982\u679c\u4f60\u60f3\u4e0a\u9762\u7684\u914d\u7f6e\u59cb\u7ec8\u751f\u6548\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e24\u6761\u547d\u4ee4\u6dfb\u52a0\u5230. bashrc \u4e2d\u53bb\u3002","title":"\u955c\u50cf\u4ed3\u5e93"},{"location":"Language/Basic/Go-Modules/#_9","text":"\u9664\u4e86\u4f7f\u7528\u516c\u6709\u7684 Go Modules \u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\u4e4b\u5916\uff0c\u5f88\u591a\u65f6\u5019\u6211\u4eec\u5728\u516c\u53f8\u5185\u90e8\u9700\u8981\u642d\u5efa\u79c1\u6709\u7684\u4ee3\u7406\u670d\u52a1\uff0c\u7279\u522b\u662f\u5728\u4f7f\u7528 CI/CD \u7684\u65f6\u5019\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u79c1\u6709\u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff0c\u4f1a\u5927\u5927\u7684\u63d0\u4f9b\u5e94\u7528\u7684\u6784\u5efa\u6548\u7387\u3002 \u53ef\u4ee5\u4f7f\u7528 Athens \u6765\u642d\u5efa\u79c1\u6709\u7684\u4ee3\u7406\u4ed3\u5e93\u670d\u52a1\uff0c\u642d\u5efa\u975e\u5e38\u7b80\u5355\uff0c\u76f4\u63a5\u7528 docker \u955c\u50cf\u8fd0\u884c\u4e00\u4e2a\u670d\u52a1\u5373\u53ef\uff1a export ATHENS_STORAGE=~/athens-storage mkdir -p $ATHENS_STORAGE docker run -d -v $ATHENS_STORAGE:/var/lib/athens \\ -e ATHENS_DISK_STORAGE_ROOT=/var/lib/athens \\ -e ATHENS_STORAGE_TYPE=disk \\ --name goproxy \\ --restart always \\ -p 3000:3000 \\ gomods/athens:latest \u5176\u4e2d ATHENS_STORAGE \u662f\u7528\u6765\u5b58\u653e\u6211\u4eec\u4e0b\u8f7d\u4e0b\u6765\u7684\u6a21\u5757\u7684\u672c\u5730\u8def\u5f84\uff0c\u53e6\u5916 ATHENS \u8fd8\u652f\u6301\u5176\u4ed6\u7c7b\u578b\u7684\u5b58\u50a8\uff0c\u6bd4\u5982 \u5185\u5b58, AWS S3 \u6216 Minio\uff0c\u90fd\u662f OK \u7684\u3002 \u7136\u540e\u4fee\u6539 GOPROXY \u914d\u7f6e\uff1a export GOPROXY=http://127.0.0.1:3000","title":"\u642d\u5efa\u79c1\u6709\u4ed3\u5e93"},{"location":"Language/Basic/Go-Modules/#_10","text":"\u4e00\u53e5\u8bdd\uff1aGo Modules \u771f\u7684\u7528\u8d77\u6765\u975e\u5e38\u723d\uff0c\u7279\u522b\u662f\u6d88\u9664\u4e86 GOPATH\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5bf9\u4e8e Golang \u521d\u5b66\u8005\u6765\u8bf4\u662f\u975e\u5e38\u70e6\u4eba\u7684\uff0c\u5f88\u96be\u7406\u89e3\u4e3a\u4ec0\u4e48\u9700\u8981\u8fdb\u5165\u5230\u7279\u5b9a\u76ee\u5f55\u4e0b\u9762\u624d\u53ef\u4ee5\u7f16\u5199 Go \u4ee3\u7801\uff0c\u73b0\u5728\u4e0d\u7528\u62c5\u5fc3\u4e86\uff0c\u76f4\u63a5\u4f7f\u7528 Go Modules \u5c31\u884c\u3002","title":"\u603b\u7ed3"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/","text":"\u6d4b\u8bd5\u7684\u57fa\u672c\u89c4\u5219\u4e0e\u6d41\u7a0b \u5bf9\u4e8e\u7a0b\u5e8f\u6216\u8f6f\u4ef6\u7684\u6d4b\u8bd5\u5206\u4e3a\u5f88\u591a\u79cd\uff1a \u5355\u5143\u6d4b\u8bd5 API\u6d4b\u8bd5 \u96c6\u6210\u6d4b\u8bd5 \u7070\u5ea6\u6d4b\u8bd5 \u5355\u5143\u6d4b\u8bd5 \u5355\u5143\u6d4b\u8bd5\u4e5f\u79f0\u4e3a\u7a0b\u5e8f\u5458\u6d4b\u8bd5\uff0c\u5c31\u662f\u7a0b\u5e8f\u5458\u672c\u8be5\u505a\u7684\u81ea\u6211\u68c0\u67e5\u5de5\u4f5c\u4e4b\u4e00\u3002 Go\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684API\u548c\u5de5\u5177\uff0c\u53ef\u4ee5\u521b\u5efa\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\uff0c\u5e76\u4e3a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u548c\u5e93\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u7f16\u5199\u6d4b\u8bd5\u7528\u4f8b\u3002\u5728Go\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u5f80\u5f80\u4f1a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u51fd\u6570\u6765\u4ee3\u8868\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4ec5\u7528\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\uff08\u5f80\u5f80\u7528\u4e8e\u63cf\u8ff0\u67d0\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u7684\u67d0\u65b9\u9762\u529f\u80fd\uff09\u5c31\u8db3\u591f\u4e86\u3002 Go\u7a0b\u5e8f\u53ef\u4ee5\u7f16\u5199\u4e09\u7c7b\u6d4b\u8bd5\uff1a \u529f\u80fd\u6d4b\u8bd5\uff08test\uff09\uff1a \u57fa\u51c6\u6d4b\u8bd5\uff08benchmark\uff0c\u6027\u80fd\u6d4b\u8bd5\uff09\uff1a \u793a\u4f8b\u6d4b\u8bd5\uff08example\uff09\uff1a\u4e5f\u662f\u529f\u80fd\u6d4b\u8bd5\u7684\u4e00\u79cd\uff0c\u66f4\u5173\u6ce8\u7a0b\u5e8f\u6253\u5370\u51fa\u6765\u7684\u5185\u5bb9 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u53ea\u4f1a\u9488\u5bf9\u67d0\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u6216\u8005\u5e93\u6587\u4ef6\u505a\u6d4b\u8bd5\uff0c\u6240\u4ee5\u5e94\u8be5\u628a\u5b83\u4eec\u653e\u5728\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u3002\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u4ee5\u88ab\u6d4b\u6e90\u7801\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u524d\u5bfc\uff0c\u5e76\u4e14\uff0c\u5fc5\u987b\u4ee5 \u201c_test\u201d \u4e3a\u540e\u7f00\u3002\u5982 demo.go \u548c demo_test.go \u3002 \u6bcf\u4e2a\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u90fd\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\uff0c\u7528\u6765\u505a\u4efb\u4f55\u4e00\u7c7b\u6d4b\u8bd5\uff0c\u901a\u5e38\u628a\u4e09\u7c7b\u6d4b\u8bd5\u90fd\u653e\u5728\u4e00\u8d77\uff0c\u628a\u63a7\u597d\u6d4b\u8bd5\u51fd\u6570\u7684\u5206\u7ec4\u548c\u6570\u91cf\u5373\u53ef\u3002\u5206\u7ec4\u4f9d\u636e\uff1a \u4f9d\u636e\u6d4b\u8bd5\u51fd\u6570\u9488\u5bf9\u7684\u4e0d\u540c\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u628a\u5b83\u4eec\u5206\u6210\u4e0d\u540c\u7684\u903b\u8f91\u7ec4\uff0c\u5229\u7528\u6ce8\u91ca\u4ee5\u53ca\u5e2e\u52a9\u7c7b\u7684\u53d8\u91cf\u6216\u6d4b\u8bd5\u51fd\u6570\u6765\u505a\u5206\u5272 \u4f9d\u636e\u88ab\u6d4b\u6e90\u7801\u6587\u4ef6\u4e2d\u7a0b\u5e8f\u5b9e\u4f53\u7684\u5148\u540e\u987a\u5e8f\uff0c\u6765\u5b89\u6392\u6d4b\u8bd5\u6e90\u6587\u4ef6\u4e2d\u6d4b\u8bd5\u51fd\u6570\u7684\u987a\u5e8f \u6d4b\u8bd5\u51fd\u6570\u7684\u540d\u79f0\u548c\u7b7e\u540d\u7684\u89c4\u5b9a \u529f\u80fd\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Test \u4e3a\u524d\u7f00\uff0c\u5e76\u4e14\u53c2\u6570\u5217\u8868\u4e2d\u53ea\u5e94\u6709\u4e00\u4e2a \u00d7testing.T \u7c7b\u578b\u7684\u53c2\u6570\u58f0\u660e \u6027\u80fd\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Benchmark \u4e3a\u524d\u7f00\uff0c\u5e76\u4e14 \u552f\u4e00 \u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662f \u00d7testing.B \u7c7b\u578b \u793a\u4f8b\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Example \u4e3a\u524d\u7f00\uff0c\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u6ca1\u6709\u5f3a\u5236\u89c4\u5b9a go test\u6267\u884c\u7684\u6d41\u7a0b go test \u547d\u4ee4\u8fd0\u884c\u7684\u524d\u7f6e\u6761\u4ef6\uff1a \u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u7684\u540d\u79f0\u5bf9\u4e86 \u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\u548c\u7b7e\u540d\u5bf9\u4e86 go test \u6d41\u7a0b\uff1a \u51c6\u5907\u5de5\u4f5c\uff1a\u786e\u5b9a\u5185\u90e8\u9700\u8981\u7528\u5230\u7684\u547d\u4ee4\uff0c\u68c0\u67e5\u5236\u5b9a\u7684\u4ee3\u7801\u5305\u548c\u6e90\u7801\u6587\u4ef6\u7684\u6709\u6548\u6027\uff0c\u5224\u65ad\u7ed9\u4e88\u7684\u6807\u8bb0\u662f\u5426\u5408\u6cd5 \u5f00\u59cb\u6267\u884c\uff1a\u9488\u5bf9\u6bcf\u4e2a\u88ab\u6d4b\u8bd5\u4ee3\u7801\u5305\uff0c \u4f9d\u6b21 \u8fdb\u884c\u6784\u5efa\u3001\u6267\u884c\u5305\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u6d4b\u8bd5\u51fd\u6570\uff0c\u6e05\u7406\u4e34\u65f6\u6587\u4ef6\uff0c\u6253\u5370\u6d4b\u8bd5\u7ed3\u679c \u6ce8\u610f\u662f\u4f9d\u6b21\uff0c\u5bf9\u6bcf\u4e2a\u88ab\u6d4b\u4ee3\u7801\u5305 go test \u547d\u4ee4\u4f1a\u4e32\u884c\u5730\u6267\u884c\u6d4b\u8bd5\u6d41\u7a0b\u4e2d\u7684\u6bcf\u4e2a\u6b65\u9aa4\u3002\u4f46\u662f\u4e3a\u4e86\u52a0\u5feb\u6d4b\u8bd5\u901f\u5ea6\uff0c\u901a\u5e38\u4f1a\u5e76\u53d1\u5730\u5bf9\u591a\u4e2a\u88ab\u6d4b\u4ee3\u7801\u5305\u8fdb\u884c\u529f\u80fd\u6d4b\u8bd5\uff0c\u53ea\u4e0d\u8fc7\u5728\u6700\u540e\u6253\u5370\u6d4b\u8bd5\u7ed3\u679c\u7684\u65f6\u5019\uff0c\u4f1a\u4f9d\u7167\u7ed9\u5b9a\u7684\u6d4b\u8bd5\u9010\u4e2a\u8fdb\u884c\u3002 \u5e76\u53d1\u5730\u6d4b\u8bd5\u4f1a\u8ba9\u6027\u80fd\u6d4b\u8bd5\u7684\u7ed3\u679c\u51fa\u73b0\u504f\u5dee\uff0c\u6240\u4ee5\u6027\u80fd\u6d4b\u8bd5\u4e00\u822c\u662f\u4e32\u884c\u7684\uff08\u53ea\u8981\u5728\u6240\u6709\u6784\u5efa\u6b65\u9aa4\u90fd\u505a\u5b8c\u4e4b\u540e\uff0c go test \u547d\u4ee4\u624d\u4f1a\u771f\u6b63\u5f00\u59cb\u8fdb\u884c\u6027\u80fd\u6d4b\u8bd5\uff09 \u3002 Go\u8bed\u8a00\u662f\u4e00\u95e8\u91cd\u89c6\u6d4b\u8bd5\u7684\u8bed\u8a00\uff0c\u4e0d\u4f46\u81ea\u5e26testing\u5305\uff0c\u8fd8\u6709\u4e13\u7528\u4e8e\u7a0b\u5e8f\u6d4b\u8bd5\u7684 go test \u547d\u4ee4\u3002 \u8981\u60f3\u771f\u6b63\u7528\u597d\u4e00\u4e2a\u5de5\u5177\uff0c\u5fc5\u987b\u5148\u4e86\u89e3\u5b83\u7684\u6838\u5fc3\u903b\u8f91 \u3002 \u529f\u80fd\u6d4b\u8bd5 // \u7b2c\u4e00\u6b21\u7684\u6d4b\u8bd5\u7ed3\u679c ok puzzlers/article20/q2 0.008s // \u7b2c\u4e8c\u6b21\u7684\u6d4b\u8bd5\u7ed3\u679c ok puzzlers/article20/q2 (cached) \u6d4b\u8bd5\u7ed3\u679c\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a ok\uff1a\u8868\u793a\u6b64\u6b21\u6d4b\u8bd5\u6210\u529f \u88ab\u6d4b\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84 \u5bf9\u8be5\u4ee3\u7801\u5305\u7684\u6d4b\u8bd5\u6d88\u8017\u7684\u65f6\u95f4 \u518d\u6b21\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u5728\u6d4b\u8bd5\u7ed3\u679c\u4e2d\u7b2c\u4e09\u90e8\u5206\u4e0d\u518d\u663e\u793a\u6d4b\u8bd5\u65f6\u95f4\uff0c\u800c\u662f\u663e\u793a\uff08cached\uff09\u3002 \u7531\u4e8e\u6d4b\u8bd5\u4ee3\u7801\u548c\u88ab\u6d4b\u8bd5\u4ee3\u7801\u6ca1\u6709\u53d8\u5316\uff0c\u6240\u4ee5 go test \u4f1a\u76f4\u63a5\u5c06\u7f13\u5b58\u6d4b\u8bd5\u6210\u529f\u7684\u7ed3\u679c\u6253\u5370\u51fa\u6765\u3002 \u4e00\u65e6\u6709\u4efb\u4f55\u6539\u52a8\uff0c\u7f13\u5b58\u6570\u636e\u5931\u6548\uff0cgo\u547d\u4ee4\u518d\u6b21\u771f\u6b63\u7684\u6267\u884c\u64cd\u4f5c\u3002 go \u547d\u4ee4\u901a\u5e38\u4f1a\u7f13\u5b58\u7a0b\u5e8f\u6784\u5efa\u7684\u7ed3\u679c\uff0c\u4ee5\u4fbf\u5728\u5c06\u6765\u7684\u6784\u5efa\u4e2d\u91cd\u7528\u3002\u8fd0\u884c go env GOCACHE \u547d\u4ee4\u6765\u67e5\u770b\u7f13\u5b58\u76ee\u5f55\u7684\u8def\u5f84\u3002\u7f13\u5b58\u7684\u6570\u636e\u603b\u662f\u80fd\u591f\u6b63\u786e\u5730\u653e\u53cd\u6620\u51fa\u5f53\u65f6\u7684\u5404\u79cd\u6e90\u7801\u6587\u4ef6\u3001\u6784\u5efa\u73af\u5883\u3001\u7f16\u8bd1\u5668\u9009\u9879\u7b49\u7684\u771f\u5b9e\u60c5\u51b5\u3002 go \u547d\u4ee4\u4f1a\u5b9a\u671f\u6e05\u695a\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u7f13\u5b58\u6570\u636e\uff0c\u6267\u884c go clean -cache \u547d\u4ee4\u624b\u52a8\u5220\u9664\u7f13\u5b58\u6570\u636e\uff0c\u6267\u884c go clean -testcache \u624b\u52a8\u5220\u9664\u6240\u6709\u7684\u6d4b\u8bd5\u7ed3\u679c\u7f13\u5b58\u3002 \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf GODEBUG \u7684\u503c\u53ef\u4ee5\u6539\u53d8go\u547d\u4ee4\u7684\u7f13\u5b58\u884c\u4e3a\u3002\u6bd4\u5982\u8bbe\u7f6e gocacheverify=1 \u5c06\u5bfc\u81f4go\u547d\u4ee4\u7ed5\u8fc7\u4efb\u4f55\u7684\u7f13\u5b58\u6570\u636e\uff0c\u771f\u6b63\u7684\u6267\u884c\u64cd\u4f5c\u5e76\u91cd\u65b0\u751f\u6210\u6240\u6709\u7ed3\u679c\uff0c\u7136\u540e\u518d\u53bb\u68c0\u67e5\u65b0\u7684\u7ed3\u679c\u4e0e\u7f13\u5b58\u6570\u636e\u662f\u5426\u4e00\u81f4\u3002","title":"\u6d4b\u8bd5\u7684\u57fa\u672c\u89c4\u5219\u4e0e\u6d41\u7a0b"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/#_1","text":"\u5bf9\u4e8e\u7a0b\u5e8f\u6216\u8f6f\u4ef6\u7684\u6d4b\u8bd5\u5206\u4e3a\u5f88\u591a\u79cd\uff1a \u5355\u5143\u6d4b\u8bd5 API\u6d4b\u8bd5 \u96c6\u6210\u6d4b\u8bd5 \u7070\u5ea6\u6d4b\u8bd5","title":"\u6d4b\u8bd5\u7684\u57fa\u672c\u89c4\u5219\u4e0e\u6d41\u7a0b"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/#_2","text":"\u5355\u5143\u6d4b\u8bd5\u4e5f\u79f0\u4e3a\u7a0b\u5e8f\u5458\u6d4b\u8bd5\uff0c\u5c31\u662f\u7a0b\u5e8f\u5458\u672c\u8be5\u505a\u7684\u81ea\u6211\u68c0\u67e5\u5de5\u4f5c\u4e4b\u4e00\u3002 Go\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4e30\u5bcc\u7684API\u548c\u5de5\u5177\uff0c\u53ef\u4ee5\u521b\u5efa\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\uff0c\u5e76\u4e3a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u548c\u5e93\u6e90\u7801\u6587\u4ef6\u4e2d\u7684\u7a0b\u5e8f\u5b9e\u4f53\u7f16\u5199\u6d4b\u8bd5\u7528\u4f8b\u3002\u5728Go\u8bed\u8a00\u4e2d\uff0c\u4e00\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u5f80\u5f80\u4f1a\u7531\u4e00\u4e2a\u6216\u591a\u4e2a\u51fd\u6570\u6765\u4ee3\u8868\uff0c\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4ec5\u7528\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\uff08\u5f80\u5f80\u7528\u4e8e\u63cf\u8ff0\u67d0\u4e2a\u7a0b\u5e8f\u5b9e\u4f53\u7684\u67d0\u65b9\u9762\u529f\u80fd\uff09\u5c31\u8db3\u591f\u4e86\u3002 Go\u7a0b\u5e8f\u53ef\u4ee5\u7f16\u5199\u4e09\u7c7b\u6d4b\u8bd5\uff1a \u529f\u80fd\u6d4b\u8bd5\uff08test\uff09\uff1a \u57fa\u51c6\u6d4b\u8bd5\uff08benchmark\uff0c\u6027\u80fd\u6d4b\u8bd5\uff09\uff1a \u793a\u4f8b\u6d4b\u8bd5\uff08example\uff09\uff1a\u4e5f\u662f\u529f\u80fd\u6d4b\u8bd5\u7684\u4e00\u79cd\uff0c\u66f4\u5173\u6ce8\u7a0b\u5e8f\u6253\u5370\u51fa\u6765\u7684\u5185\u5bb9 \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u4e00\u4e2a\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u53ea\u4f1a\u9488\u5bf9\u67d0\u4e2a\u547d\u4ee4\u6e90\u7801\u6587\u4ef6\u6216\u8005\u5e93\u6587\u4ef6\u505a\u6d4b\u8bd5\uff0c\u6240\u4ee5\u5e94\u8be5\u628a\u5b83\u4eec\u653e\u5728\u4e00\u4e2a\u4ee3\u7801\u5305\u4e2d\u3002\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u4ee5\u88ab\u6d4b\u6e90\u7801\u6587\u4ef6\u7684\u4e3b\u540d\u79f0\u524d\u5bfc\uff0c\u5e76\u4e14\uff0c\u5fc5\u987b\u4ee5 \u201c_test\u201d \u4e3a\u540e\u7f00\u3002\u5982 demo.go \u548c demo_test.go \u3002 \u6bcf\u4e2a\u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u90fd\u5fc5\u987b\u5305\u542b\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\uff0c\u7528\u6765\u505a\u4efb\u4f55\u4e00\u7c7b\u6d4b\u8bd5\uff0c\u901a\u5e38\u628a\u4e09\u7c7b\u6d4b\u8bd5\u90fd\u653e\u5728\u4e00\u8d77\uff0c\u628a\u63a7\u597d\u6d4b\u8bd5\u51fd\u6570\u7684\u5206\u7ec4\u548c\u6570\u91cf\u5373\u53ef\u3002\u5206\u7ec4\u4f9d\u636e\uff1a \u4f9d\u636e\u6d4b\u8bd5\u51fd\u6570\u9488\u5bf9\u7684\u4e0d\u540c\u7a0b\u5e8f\u5b9e\u4f53\uff0c\u628a\u5b83\u4eec\u5206\u6210\u4e0d\u540c\u7684\u903b\u8f91\u7ec4\uff0c\u5229\u7528\u6ce8\u91ca\u4ee5\u53ca\u5e2e\u52a9\u7c7b\u7684\u53d8\u91cf\u6216\u6d4b\u8bd5\u51fd\u6570\u6765\u505a\u5206\u5272 \u4f9d\u636e\u88ab\u6d4b\u6e90\u7801\u6587\u4ef6\u4e2d\u7a0b\u5e8f\u5b9e\u4f53\u7684\u5148\u540e\u987a\u5e8f\uff0c\u6765\u5b89\u6392\u6d4b\u8bd5\u6e90\u6587\u4ef6\u4e2d\u6d4b\u8bd5\u51fd\u6570\u7684\u987a\u5e8f","title":"\u5355\u5143\u6d4b\u8bd5"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/#_3","text":"\u529f\u80fd\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Test \u4e3a\u524d\u7f00\uff0c\u5e76\u4e14\u53c2\u6570\u5217\u8868\u4e2d\u53ea\u5e94\u6709\u4e00\u4e2a \u00d7testing.T \u7c7b\u578b\u7684\u53c2\u6570\u58f0\u660e \u6027\u80fd\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Benchmark \u4e3a\u524d\u7f00\uff0c\u5e76\u4e14 \u552f\u4e00 \u53c2\u6570\u7684\u7c7b\u578b\u5fc5\u987b\u662f \u00d7testing.B \u7c7b\u578b \u793a\u4f8b\u6d4b\u8bd5\u51fd\u6570\uff1a\u540d\u79f0\u5fc5\u987b\u4ee5 Example \u4e3a\u524d\u7f00\uff0c\u51fd\u6570\u7684\u53c2\u6570\u5217\u8868\u6ca1\u6709\u5f3a\u5236\u89c4\u5b9a","title":"\u6d4b\u8bd5\u51fd\u6570\u7684\u540d\u79f0\u548c\u7b7e\u540d\u7684\u89c4\u5b9a"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/#go-test","text":"go test \u547d\u4ee4\u8fd0\u884c\u7684\u524d\u7f6e\u6761\u4ef6\uff1a \u6d4b\u8bd5\u6e90\u7801\u6587\u4ef6\u7684\u540d\u79f0\u5bf9\u4e86 \u6d4b\u8bd5\u51fd\u6570\u540d\u79f0\u548c\u7b7e\u540d\u5bf9\u4e86 go test \u6d41\u7a0b\uff1a \u51c6\u5907\u5de5\u4f5c\uff1a\u786e\u5b9a\u5185\u90e8\u9700\u8981\u7528\u5230\u7684\u547d\u4ee4\uff0c\u68c0\u67e5\u5236\u5b9a\u7684\u4ee3\u7801\u5305\u548c\u6e90\u7801\u6587\u4ef6\u7684\u6709\u6548\u6027\uff0c\u5224\u65ad\u7ed9\u4e88\u7684\u6807\u8bb0\u662f\u5426\u5408\u6cd5 \u5f00\u59cb\u6267\u884c\uff1a\u9488\u5bf9\u6bcf\u4e2a\u88ab\u6d4b\u8bd5\u4ee3\u7801\u5305\uff0c \u4f9d\u6b21 \u8fdb\u884c\u6784\u5efa\u3001\u6267\u884c\u5305\u4e2d\u7b26\u5408\u8981\u6c42\u7684\u6d4b\u8bd5\u51fd\u6570\uff0c\u6e05\u7406\u4e34\u65f6\u6587\u4ef6\uff0c\u6253\u5370\u6d4b\u8bd5\u7ed3\u679c \u6ce8\u610f\u662f\u4f9d\u6b21\uff0c\u5bf9\u6bcf\u4e2a\u88ab\u6d4b\u4ee3\u7801\u5305 go test \u547d\u4ee4\u4f1a\u4e32\u884c\u5730\u6267\u884c\u6d4b\u8bd5\u6d41\u7a0b\u4e2d\u7684\u6bcf\u4e2a\u6b65\u9aa4\u3002\u4f46\u662f\u4e3a\u4e86\u52a0\u5feb\u6d4b\u8bd5\u901f\u5ea6\uff0c\u901a\u5e38\u4f1a\u5e76\u53d1\u5730\u5bf9\u591a\u4e2a\u88ab\u6d4b\u4ee3\u7801\u5305\u8fdb\u884c\u529f\u80fd\u6d4b\u8bd5\uff0c\u53ea\u4e0d\u8fc7\u5728\u6700\u540e\u6253\u5370\u6d4b\u8bd5\u7ed3\u679c\u7684\u65f6\u5019\uff0c\u4f1a\u4f9d\u7167\u7ed9\u5b9a\u7684\u6d4b\u8bd5\u9010\u4e2a\u8fdb\u884c\u3002 \u5e76\u53d1\u5730\u6d4b\u8bd5\u4f1a\u8ba9\u6027\u80fd\u6d4b\u8bd5\u7684\u7ed3\u679c\u51fa\u73b0\u504f\u5dee\uff0c\u6240\u4ee5\u6027\u80fd\u6d4b\u8bd5\u4e00\u822c\u662f\u4e32\u884c\u7684\uff08\u53ea\u8981\u5728\u6240\u6709\u6784\u5efa\u6b65\u9aa4\u90fd\u505a\u5b8c\u4e4b\u540e\uff0c go test \u547d\u4ee4\u624d\u4f1a\u771f\u6b63\u5f00\u59cb\u8fdb\u884c\u6027\u80fd\u6d4b\u8bd5\uff09 \u3002 Go\u8bed\u8a00\u662f\u4e00\u95e8\u91cd\u89c6\u6d4b\u8bd5\u7684\u8bed\u8a00\uff0c\u4e0d\u4f46\u81ea\u5e26testing\u5305\uff0c\u8fd8\u6709\u4e13\u7528\u4e8e\u7a0b\u5e8f\u6d4b\u8bd5\u7684 go test \u547d\u4ee4\u3002 \u8981\u60f3\u771f\u6b63\u7528\u597d\u4e00\u4e2a\u5de5\u5177\uff0c\u5fc5\u987b\u5148\u4e86\u89e3\u5b83\u7684\u6838\u5fc3\u903b\u8f91 \u3002","title":"go test\u6267\u884c\u7684\u6d41\u7a0b"},{"location":"Language/Basic/\u6d4b\u8bd5\u89c4\u5219\u4e0e\u6d41\u7a0b/#_4","text":"// \u7b2c\u4e00\u6b21\u7684\u6d4b\u8bd5\u7ed3\u679c ok puzzlers/article20/q2 0.008s // \u7b2c\u4e8c\u6b21\u7684\u6d4b\u8bd5\u7ed3\u679c ok puzzlers/article20/q2 (cached) \u6d4b\u8bd5\u7ed3\u679c\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a ok\uff1a\u8868\u793a\u6b64\u6b21\u6d4b\u8bd5\u6210\u529f \u88ab\u6d4b\u4ee3\u7801\u5305\u7684\u5bfc\u5165\u8def\u5f84 \u5bf9\u8be5\u4ee3\u7801\u5305\u7684\u6d4b\u8bd5\u6d88\u8017\u7684\u65f6\u95f4 \u518d\u6b21\u8fd0\u884c\u6d4b\u8bd5\u547d\u4ee4\uff0c\u5728\u6d4b\u8bd5\u7ed3\u679c\u4e2d\u7b2c\u4e09\u90e8\u5206\u4e0d\u518d\u663e\u793a\u6d4b\u8bd5\u65f6\u95f4\uff0c\u800c\u662f\u663e\u793a\uff08cached\uff09\u3002 \u7531\u4e8e\u6d4b\u8bd5\u4ee3\u7801\u548c\u88ab\u6d4b\u8bd5\u4ee3\u7801\u6ca1\u6709\u53d8\u5316\uff0c\u6240\u4ee5 go test \u4f1a\u76f4\u63a5\u5c06\u7f13\u5b58\u6d4b\u8bd5\u6210\u529f\u7684\u7ed3\u679c\u6253\u5370\u51fa\u6765\u3002 \u4e00\u65e6\u6709\u4efb\u4f55\u6539\u52a8\uff0c\u7f13\u5b58\u6570\u636e\u5931\u6548\uff0cgo\u547d\u4ee4\u518d\u6b21\u771f\u6b63\u7684\u6267\u884c\u64cd\u4f5c\u3002 go \u547d\u4ee4\u901a\u5e38\u4f1a\u7f13\u5b58\u7a0b\u5e8f\u6784\u5efa\u7684\u7ed3\u679c\uff0c\u4ee5\u4fbf\u5728\u5c06\u6765\u7684\u6784\u5efa\u4e2d\u91cd\u7528\u3002\u8fd0\u884c go env GOCACHE \u547d\u4ee4\u6765\u67e5\u770b\u7f13\u5b58\u76ee\u5f55\u7684\u8def\u5f84\u3002\u7f13\u5b58\u7684\u6570\u636e\u603b\u662f\u80fd\u591f\u6b63\u786e\u5730\u653e\u53cd\u6620\u51fa\u5f53\u65f6\u7684\u5404\u79cd\u6e90\u7801\u6587\u4ef6\u3001\u6784\u5efa\u73af\u5883\u3001\u7f16\u8bd1\u5668\u9009\u9879\u7b49\u7684\u771f\u5b9e\u60c5\u51b5\u3002 go \u547d\u4ee4\u4f1a\u5b9a\u671f\u6e05\u695a\u6700\u8fd1\u672a\u4f7f\u7528\u7684\u7f13\u5b58\u6570\u636e\uff0c\u6267\u884c go clean -cache \u547d\u4ee4\u624b\u52a8\u5220\u9664\u7f13\u5b58\u6570\u636e\uff0c\u6267\u884c go clean -testcache \u624b\u52a8\u5220\u9664\u6240\u6709\u7684\u6d4b\u8bd5\u7ed3\u679c\u7f13\u5b58\u3002 \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf GODEBUG \u7684\u503c\u53ef\u4ee5\u6539\u53d8go\u547d\u4ee4\u7684\u7f13\u5b58\u884c\u4e3a\u3002\u6bd4\u5982\u8bbe\u7f6e gocacheverify=1 \u5c06\u5bfc\u81f4go\u547d\u4ee4\u7ed5\u8fc7\u4efb\u4f55\u7684\u7f13\u5b58\u6570\u636e\uff0c\u771f\u6b63\u7684\u6267\u884c\u64cd\u4f5c\u5e76\u91cd\u65b0\u751f\u6210\u6240\u6709\u7ed3\u679c\uff0c\u7136\u540e\u518d\u53bb\u68c0\u67e5\u65b0\u7684\u7ed3\u679c\u4e0e\u7f13\u5b58\u6570\u636e\u662f\u5426\u4e00\u81f4\u3002","title":"\u529f\u80fd\u6d4b\u8bd5"},{"location":"Language/Library/context/","text":"package context import context context \u5305\u5b9a\u4e49\u4e86 Context \u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u81ea\u5e26 \u622a\u6b62\u65f6\u95f4 \u53d6\u6d88\u4fe1\u53f7 \u8de8API\u8fb9\u754c\u6216\u5728\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u5176\u4ed6\u8bf7\u6c42\u503c \u5bf9\u670d\u52a1\u7aef\u7684\u4f20\u5165\u8bf7\u6c42\u4f1a\u521b\u5efa\u4e00\u4e2a Context \uff0c\u670d\u52a1\u7aef\u7684\u4f20\u51fa\u8c03\u7528\u4f1a\u643a\u5e26\u4e00\u4e2a Context \u3002\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u4e4b\u95f4\u7684\u51fd\u6570\u8c03\u7528\u94fe\u5fc5\u987b\u4f20\u9012 Context \uff0c\u5176\u4ed6\u53ef\u9009\u7684\u66ff\u4ee3 Context \u662f\u4e00\u4e2a\u4f7f\u7528 WithCancel \uff0c WithDeadline \uff0c WithTimeout \u6216 WithValue \u521b\u5efa\u7684\u6d3e\u751f Context \u3002\u5f53\u67d0\u4e2a Context \u88ab\u53d6\u6d88\u540e\uff0c\u57fa\u4e8e\u5b83\u6d3e\u751f\u7684\u6240\u6709 Context \u4e5f\u90fd\u4f1a\u88ab\u53d6\u6d88\u3002 WithCancel \uff0c WithDeadline \u548c WithTimeout \u51fd\u6570\u63a5\u53d7\u7236 Context \u5e76\u8fd4\u56de\u6d3e\u751f\u7684\u5b50 Context \u548c\u4e00\u4e2a CancelFunc \u51fd\u6570\u3002\u8c03\u7528 CancelFunc \u51fd\u6570\u4f1a\u53d6\u6d88\u5b50\u6d3e\u751f\u53ca\u5b50\u6d3e\u751f\u7684\u5b50\u9879\uff0c\u5220\u9664\u7236\u9879\u5bf9\u5b50\u9879\u7684\u5f15\u7528\uff0c\u5e76\u505c\u6b62\u6240\u6709\u5173\u8054\u7684\u8ba1\u65f6\u5668\u3002\u8c03\u7528 CancelFunc \u51fd\u6570\u5931\u8d25\u4f1a\u5bfc\u81f4\u6cc4\u6f0f\u5b50\u6d3e\u751f\u53ca\u5b50\u6d3e\u751f\u5b50\u9879\uff0c\u76f4\u5230\u6700\u5f00\u59cb\u7684\u7236\u9879\u88ab\u53d6\u6d88\u6216\u8005\u8ba1\u65f6\u5668\u5230\u8fbe\u800c\u88ab\u89e6\u53d1\u3002 go vet \u5de5\u5177\u68c0\u67e5 CancelFunc \u51fd\u6570\u662f\u5426\u5728\u6240\u6709\u63a7\u5236\u6d41\u8def\u5f84\u4e0a\u4f7f\u7528\u3002 \u4f7f\u7528 Context \u7684\u7a0b\u5e8f\u5e94\u9075\u5faa\u8fd9\u4e9b\u89c4\u5219\uff0c\u4ee5\u4f7f\u5404\u4e2a\u5305\u4e4b\u95f4\u7684\u63a5\u53e3\u4fdd\u6301\u4e00\u81f4\uff0c\u5e76\u542f\u7528\u9759\u6001\u5206\u6790\u5de5\u5177\u6765\u68c0\u67e5 Context \u7684\u4f20\u64ad\uff1a \u4e0d\u8981\u5c06 Context \u5b58\u50a8\u5728\u7ed3\u6784\u7c7b\u578b\u4e2d\uff1b\u800c\u5e94\u8be5\u5c06 Context \u660e\u786e\u4f20\u9012\u7ed9\u9700\u8981\u5b83\u7684\u6bcf\u4e2a\u51fd\u6570\u3002 Context\u5e94\u8be5\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u901a\u5e38\u547d\u540d\u4e3actx\uff1a go func DoSomething(ctx context.Context, arg Arg) error { // ... use ctx ... } \u5373\u4f7f\u51fd\u6570\u5141\u8bb8\uff0c\u4e5f\u4e0d\u8981\u4f20\u9012 nil Context \u3002\u5982\u679c\u4e0d\u786e\u5b9a\u8981\u4f7f\u7528\u54ea\u4e2a context \uff0c\u8bf7\u4f20\u9012 context.TODO \u3002 \u4ec5\u5c06 Context \u503c\u7528\u4e8e\u8f6c\u6362\u8fdb\u7a0b\u548cAPI\u4e4b\u95f4\u7684\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 \u53ef\u4ee5\u5c06\u76f8\u540c\u7684 Context \u4f20\u9012\u7ed9\u5728\u4e0d\u540c goroutine \u4e2d\u8fd0\u884c\u7684\u51fd\u6570\uff1b Context \u5bf9\u4e8e\u591a\u4e2a goroutine \u540c\u65f6\u4f7f\u7528\u662f\u5b89\u5168\u7684\u3002 \u6709\u5173\u4f7f\u7528 Context \u7684\u670d\u52a1\u793a\u4f8b\u4ee3\u7801\uff0c\u8bf7\u53c2\u9605 \u793a\u4f8b \u53d8\u91cf // Canceled\u662fcontext\u53d6\u6d88\u65f6Context.Err\u8fd4\u56de\u7684\u9519\u8bef var Canceled = errors.New( context canceled ) // DeadlineExceeded\u662fContext.Err\u5728context\u622a\u6b62\u65f6\u95f4\u8fc7\u540e\u8fd4\u56de\u7684\u9519\u8bef var DeadlineExceeded error = deadlineExceededError{} \u51fd\u6570 WithCancel func WithCancel(parent Context) (ctx Context, cancel CancelFunc) WithCancel \u8fd4\u56de\u5e26\u6709\u65b0 Done \u901a\u9053\u7684\u7236 context \u7684\u526f\u672c\u3002\u8fd4\u56de\u7684 context \u7684 Done \u901a\u9053\u5c06\u4f1a\u5728\u8c03\u7528\u8fd4\u56de\u7684 cancel \u51fd\u6570\u6216\u7236 context \u7684 Done \u901a\u9053\u5173\u95ed\u65f6\u88ab\u5173\u95ed(\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e2d\u5148\u53d1\u751f\u7684\u4e3a\u51c6\uff09\u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002 WithCancel\u793a\u4f8b \u6b64\u793a\u4f8b\u6f14\u793a\u4e86\u4f7f\u7528\u53ef\u53d6\u6d88\u7684context\u6765\u9632\u6b62goroutine\u6cc4\u6f0f\u3002\u5728\u793a\u4f8b\u51fd\u6570\u7ed3\u675f\u65f6\uff0cgen\u542f\u52a8\u7684goroutine\u5c06\u8fd4\u56de\u800c\u4e0d\u4f1a\u6cc4\u6f0f\u3002 // gen\u5728\u5355\u72ec\u7684goroutine\u4e2d\u751f\u6210\u6574\u6570\u5c06\u5b83\u4eec\u53d1\u9001\u5230\u8fd4\u56de\u7684channel\u3002 // gen\u7684\u8c03\u7528\u8005\u9700\u8981\u53d6\u6d88\u4e00\u6b21\u4e0a\u4e0b\u6587\uff0c\u4ed6\u4eec\u6d88\u8d39\u751f\u6210\u7684\u6574\u6570\u800c\u4e0d\u6cc4\u6f0f\uff0c // \u5185\u90e8\u7684goroutine\u7531gen\u5f00\u59cb gen := func(ctx context.Context) -chan int { dst := make(chan int) n := 1 go func() { for { select { case -ctx.Done(): return // returning not to leak the goroutine case dst - n: n++ } } }() return dst } ctx, cancel := context.WithCancel(context.Background()) defer cancel() // cancel when we are finished consuming integers for n := range gen(ctx) { fmt.Println(n) if n == 5 { break } } // \u8f93\u51fa 1 2 3 4 5 \u51fd\u6570 WithDeadline func WithDeadline(parent Context, d time.Time) (Context, CancelFunc) WithDeadline\u8fd4\u56de context \u7684\u526f\u672c\uff0c\u4e14\u8be5\u526f\u672c\u7684\u622a\u6b62\u65f6\u95f4\u88ab\u8c03\u6574\u4e3a\u4e0d\u8fdf\u4e8e d \u3002\u5982\u679c\u7236 context \u7684\u622a\u6b62\u65f6\u95f4\u65e9\u4e8e d \uff0c\u5219 WithDeadline\uff08parent\uff0cd\uff09 \u5728\u8bed\u4e49\u4e0a\u7b49\u540c\u4e8e\u7236 context \u3002\u8fd4\u56de\u7684 context \u7684 Done \u901a\u9053\u5728\u622a\u6b62\u65f6\u95f4\u5230\u671f\u3001\u8c03\u7528\u8fd4\u56de\u7684 cancel \u51fd\u6570\u65f6\u6216\u7236 context \u7684 Done \u901a\u9053\u5173\u95ed\u65f6\u5173\u95ed\uff08\u4ee5\u5148\u53d1\u751f\u7684\u60c5\u51b5\u4e3a\u51c6\uff09\u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002 WithDeadline\u793a\u4f8b \u8fd9\u4e2a\u4f8b\u5b50\u4f20\u9012\u4e00\u4e2a\u5e26\u6709\u4efb\u610f\u622a\u6b62\u65f6\u95f4\u7684 contezt \u6765\u544a\u8bc9\u963b\u585e\u51fd\u6570\u5b83\u5e94\u8be5\u5728\u622a\u6b62\u65f6\u95f4\u5230\u8fbe\u65f6\u653e\u5f03\u5b83\u7684\u5de5\u4f5c\u3002 d := time.Now().Add(50 * time.Millisecond) ctx, cancel := context.WithDeadline(context.Background(), d) // \u5c3d\u7ba1ctx\u5c06\u4f1a\u8fc7\u671f\uff0c\u6700\u4f73\u5b9e\u8df5\u662f\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u8981\u8c03\u7528\u5b83\u7684\u53d6\u6d88\u51fd\u6570\u3002 // \u5982\u679c\u4e0d\u8fd9\u6837\u505a\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4fdd\u7559context\u53ca\u5176\u7236context\u7684\u6d3b\u52a8\u65f6\u95f4\u8d85\u8fc7\u6211\u4eec\u7684\u9884\u671f defer cancel() select { case -time.After(1 * time.Second): fmt.Println( overslept ) case -ctx.Done(): fmt.Println(ctx.Err()) } \u51fd\u6570 WithTimeout func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc) WithTimeout \u51fd\u6570\u8fd4\u56de WithDeadline(parent,time.Now().Add(timeout)) \u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002 func slowOperationWithTimeout(ctx context.Context) (Result, error) { ctx, cancel := context.WithTimeout(ctx, 100*time.Millisecond) defer cancel() // releases resources if slowOperation completes before timeout elapses return slowOperation(ctx) } WithTimeout\u793a\u4f8b \u6b64\u793a\u4f8b\u4f20\u9012\u5177\u6709\u8d85\u65f6\u7684\u4e0a\u4e0b\u6587\uff0c\u4ee5\u544a\u77e5\u963b\u585e\u51fd\u6570\u5728\u8d85\u65f6\u8fc7\u540e\u5b83\u5e94\u8be5\u653e\u5f03\u5176\u5de5\u4f5c\u3002 // \u4f20\u9012\u4e00\u4e2a\u5e26\u6709\u8d85\u65f6\u65f6\u95f4\u7684context\u6765\u544a\u8bc9\u4e00\u4e2a\u6b63\u5728\u963b\u585e\u7684\u51fd\u6570\uff0c // \u5b83\u5e94\u8be5\u5728\u8d85\u65f6\u65f6\u95f4\u8fc7\u540e\u653e\u5f03\u6b63\u5728\u8fdb\u7684\u5de5\u4f5c\u3002 ctx, cancel := context.WithTimeout(context.Background(), 50*time.Millisecond) defer cancel() select { case -time.After(1 * time.Second): fmt.Println( overslept ) case -ctx.Done(): fmt.Println(ctx.Err()) // prints context deadline exceeded } \u7c7b\u578b CancelFunc type CancelFunc func() CancelFunc \u544a\u8bc9\u67d0\u4e2a\u64cd\u4f5c\u653e\u5f03\u5b83\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\u3002 CancelFunc \u4e0d\u4f1a\u7b49\u5f85\u5de5\u4f5c\u505c\u6b62\u3002\u7b2c\u4e00\u6b21\u8c03\u7528\u540e\uff0c\u5bf9 CancelFunc \u7684\u540e\u7eed\u8c03\u7528\u90fd\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002 \u7c7b\u578b Context type Context interface { // Deadline\u51fd\u6570\u8fd4\u56de\u5b8c\u6210\u5de5\u4f5c\u7684\u65f6\u95f4\uff08\u8be5\u65f6\u95f4\u4ee3\u8868\u6b64context\u5e94\u8be5\u88ab\u53d6\u6d88\uff09\u3002 // \u5982\u679c\u6ca1\u6709\u8bbe\u7f6edeadline\uff0cDeadline\u51fd\u6570\u8fd4\u56deok==false\u3002 // \u5bf9Deadline\u51fd\u6570\u7684\u8fde\u7eed\u8c03\u7528\u90fd\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 Deadline() (deadline time.Time, ok bool) // Done\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u901a\u9053\uff0c\u5f53\u5de5\u4f5c\u5b8c\u6210\u65f6\u901a\u9053\u5c06\u4f1a\u88ab\u5173\u95ed\uff0c(\u8fd9\u4ee3\u8868\u4e86\u8fd9\u4e2acontext\u5e94\u8be5\u88ab\u53d6\u6d88)\u3002 // \u5982\u679c\u8fd9\u4e2acontext\u4e0d\u80fd\u88ab\u53d6\u6d88\uff0cDone\u51fd\u6570\u4e5f\u53ef\u80fd\u8fd4\u56denil\u3002 // \u5bf9Done\u51fd\u6570\u7684\u8fde\u7eed\u8c03\u7528\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 // \u5f53\u53d6\u6d88\u88ab\u8c03\u7528\u65f6\uff0cWithCancel\u5b89\u6392Done\u901a\u9053\u5173\u95ed // \u5f53\u622a\u6b62\u65f6\u95f4\u8fc7\u671f\u65f6\uff0cWithDeadline\u5b89\u6392Done\u901a\u9053\u5173\u95ed // \u5f53\u8d85\u65f6\u65f6\u95f4\u5230\u671f\u65f6\uff0cWithTimeout\u5b89\u6392Done\u901a\u9053\u5173\u95ed // // Done\u63d0\u4f9b\u7528\u4e8eselect\u8bed\u53e5: // // // Stream\u4f7f\u7528DoSomething\u6765\u751f\u6210\u503c\u5e76\u5c06\u8fd9\u4e9b\u503c\u53d1\u9001\u51fa\u53bb\uff0c // // \u77e5\u9053DoSomething\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u6216\u8005ctx.Done\u88ab\u5173\u95ed\u3002 // func Stream(ctx context.Context, out chan - Value) error { // for { // v, err := DoSomething(ctx) // if err != nil { // return err // } // select { // case -ctx.Done(): // return ctx.Err() // case out - v: // } // } // } // // \u67e5\u9605 https://blog.golang.org/pipelines \u83b7\u53d6\u8ddf\u591a\u5982\u4f55\u4f7f\u7528Done\u901a\u9053\u6765\u53d6\u6d88context\u7684\u4f8b\u5b50\u3002 Done() -chan struct{} // \u5982\u679cDone\u6ca1\u6709\u5173\u95ed\uff0cErr\u51fd\u6570\u8fd4\u56denil\u3002 // \u5982\u679cDone\u5df2\u7ecf\u5173\u95ed\uff0cErr\u51fd\u6570\u8fd4\u56denon-nil\u6765\u89e3\u91ca\uff1a // \u5982\u679c\u662f\u53d6\u6d88\uff0c\u4e3a\u4ec0\u4e48context\u88ab\u53d6\u6d88 // \u5982\u679c\u662f\u622a\u6b62\u65f6\u95f4\u8d85\u65f6\uff0c\u4e3a\u4ec0\u4e48context\u7684\u622a\u6b62\u65f6\u95f4\u8fc7\u4e86 // \u5728Err\u51fd\u6570\u8fd4\u56de\u4e00\u4e2anon-nil\u9519\u8bef\u540e, \u6301\u7eed\u7684\u8c03\u7528Err\u8fd4\u56de\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u9519\u8bef\u3002 Err() error // Value\u51fd\u6570\u8fd4\u56de\u4e0e\u6b64context\u7684\u952e\u5173\u8054\u7684\u503c\uff0c\u5982\u679c\u6ca1\u6709\u503c\u4e0e\u952e\u5173\u8054\uff0c\u5219\u8fd4\u56denil\u3002 // \u4f7f\u7528\u76f8\u540c\u7684\u952e\u8fde\u7eed\u8c03\u7528Value\u51fd\u6570\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 // \u4ec5\u5c06context\u503c\u7528\u4e8e\u5207\u6362\u8fdb\u7a0b\u548cAPI\u7684\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 // \u952e\u6807\u8bc6context\u4e2d\u7279\u5b9a\u7684\u503c\u3002\u60f3\u8981\u5728Context\u4e2d\u5b58\u50a8\u503c\u7684\u51fd\u6570\u901a\u5e38\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u5206\u914d\u4e00\u4e2a\u952e\uff0c // \u7136\u540e\u4f7f\u7528\u8be5\u952e\u4f5c\u4e3acontext.WithValue\u548cContext.Value\u7684\u53c2\u6570\u3002 // \u952e\u53ef\u4ee5\u662f\u652f\u6301\u5224\u7b49\u7684\u4efb\u4f55\u7c7b\u578b; \u5305\u5e94\u8be5\u5c06\u952e\u5b9a\u4e49\u4e3a\u672a\u5bfc\u51fa\u7c7b\u578b\u4ee5\u907f\u514d\u51b2\u7a81\u3002 // \u5b9a\u4e49Context\u952e\u7684\u5305\u5e94\u8be5\u4e3a\u4f7f\u7528\u8be5\u952e\u5b58\u50a8\u7684\u503c\u63d0\u4f9b\u7c7b\u578b\u5b89\u5168\u7684\u8bbf\u95ee\u5668\uff1a // // \u5305\u4f7f\u7528\u8005\u5b9a\u4e49\u4e00\u4e2aUser\u7c7b\u578b\u5b58\u50a8\u5728Context\u4e2d\u3002 // package user // // import context // // // User\u662f\u5b58\u50a8\u5728context\u4e2d\u7684\u503c\u7684\u7c7b\u578b // type User struct {...} // // // \u5b9a\u4e49\u5728\u672c\u5305\u4e2d\u7684\u952e\u662f\u4e00\u4e2a\u975e\u5bfc\u51fa\u7c7b\u578b\u3002 // // \u8fd9\u907f\u514d\u4e86\u4e0e\u5b9a\u4e49\u5728\u5176\u4ed6\u5305\u4e2d\u7684\u952e\u4ea7\u751f\u51b2\u7a81\u3002 // type key int // // // userKey\u662fcontext\u4e2duser.User\u503c\u7684\u952e\u3002\u5b83\u7684\u672a\u5bfc\u51fa\u7684\u3002 // // \u5ba2\u6237\u7aef\u4f7f\u7528user.NewContext\u548cuser.FromContext\u800c\u4e0d\u662f\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e2a\u952e\u3002 // var userKey key // // // NewContext\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684Context\u5176\u4e2d\u643a\u5e26\u503cu\u3002 // func NewContext(ctx context.Context, u *User) context.Context { // return context.WithValue(ctx, userKey, u) // } // // // FromContext\u8fd4\u56deUser\u7684\u503c\uff0c\u8be5\u503c\u5b58\u50a8\u5728ctx\u4e2d(\u5982\u679c\u6709)\u3002 // func FromContext(ctx context.Context) (*User, bool) { // u, ok := ctx.Value(userKey).(*User) // return u, ok // } Value(key interface{}) interface{} } Context \u8de8\u8d8aAPI\u8fb9\u754c\u643a\u5e26\u622a\u6b62\u65f6\u95f4\uff0c\u53d6\u6d88\u4fe1\u53f7\u548c\u5176\u4ed6\u8de8API\u8fb9\u754c\u7684\u503c\u3002 Context \u7684\u65b9\u6cd5\u53ef\u4ee5\u7531\u591a\u4e2a goroutine \u540c\u65f6\u8c03\u7528\u3002 \u65b9\u6cd5 Background func Background() Context Background() \u8fd4\u56de\u4e00\u4e2a non-nil \u548c\u7a7a\u7684 Context \u3002\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u53d6\u6d88\uff0c\u6ca1\u6709\u503c\uff0c\u4e5f\u6ca1\u6709\u622a\u6b62\u65f6\u95f4\u3002\u5b83\u901a\u5e38\u7531\u4e3b\u51fd\u6570\u521d\u59cb\u5316\u548c\u6d4b\u8bd5\uff0c\u5e76\u4f5c\u4e3a\u4f20\u5165\u8bf7\u6c42\u7684\u9876\u7ea7Context\u3002 \u65b9\u6cd5 TODO func TODO() Context TODO() \u8fd4\u56de\u4e00\u4e2a non-nil \u548c\u7a7a\u7684 Context \u3002\u4ee3\u7801\u5e94\u8be5\u4f7f\u7528 context.TODO \u5f53\u4e0d\u6e05\u695a\u4f7f\u7528\u54ea\u4e2a Context \u6216\u8005\u5b83\u8fd8\u4e0d\u53ef\u7528\u65f6\uff08\u56e0\u4e3a\u5468\u56f4\u7684\u51fd\u6570\u5c1a\u672a\u6269\u5c55\u4e3a\u63a5\u53d7 Context \u53c2\u6570\uff09\u3002 \u65b9\u6cd5 WithValue func WithValue(parent Context, key, val interface{}) Context WithValue() \u8fd4\u56de\u7236 context \u7684\u526f\u672c\uff0c\u5176\u4e2d\u4e0ekey\u5173\u8054\u7684\u503c\u4e3a val \u3002 \u4ec5\u5c06 context \u503c\u7528\u4e8e\u8f6c\u6362\u8fdb\u7a0b\u548cAPI\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 \u63d0\u4f9b\u7684\u952e\u5fc5\u987b\u662f\u53ef\u6bd4\u8f83\u7684\uff0c\u4e0d\u5e94\u8be5\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u6216\u4efb\u4f55\u5176\u4ed6\u5185\u7f6e\u7c7b\u578b\uff0c\u4ee5\u907f\u514d\u4f7f\u7528 context \u7684\u5305\u4e4b\u95f4\u7684\u51b2\u7a81\u3002 WithValue() \u7684\u7528\u6237\u5e94\u8be5\u4e3a\u952e\u5b9a\u4e49\u4ed6\u4eec\u81ea\u5df1\u7684\u7c7b\u578b\u3002\u4e3a\u4e86\u907f\u514d\u5728\u6307\u6d3e\u63a5\u53e3\u65f6\u5206\u914d\uff0c context \u7684\u952e\u901a\u5e38\u6709\u5177\u4f53\u7c7b\u578b\u7684\u7ed3\u6784\u4f53\u3002\u6216\u8005\uff0c\u5bfc\u51fa context \u952e\u7684\u53d8\u91cf\u7684\u9759\u6001\u7c7b\u578b\u5e94\u8be5\u662f\u6307\u9488\u6216\u63a5\u53e3\u3002 WithValue\u793a\u4f8b \u6b64\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5c06\u503c\u4f20\u9012\u7ed9 context \u4ee5\u53ca\u5982\u4f55\u68c0\u7d22\u5b83\uff08\u5982\u679c\u5b58\u5728\uff09\u3002 type favContextKey string f := func(ctx context.Context, k favContextKey) { if v := ctx.Value(k); v != nil { fmt.Println( found value: , v) return } fmt.Println( key not found: , k) } k := favContextKey( language ) ctx := context.WithValue(context.Background(), k, Go ) f(ctx, k) f(ctx, favContextKey( color )) // \u8f93\u51fa found value: Go key not found: color","title":"package context"},{"location":"Language/Library/context/#package-context","text":"import context context \u5305\u5b9a\u4e49\u4e86 Context \u7c7b\u578b\uff0c\u8be5\u7c7b\u578b\u81ea\u5e26 \u622a\u6b62\u65f6\u95f4 \u53d6\u6d88\u4fe1\u53f7 \u8de8API\u8fb9\u754c\u6216\u5728\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u5176\u4ed6\u8bf7\u6c42\u503c \u5bf9\u670d\u52a1\u7aef\u7684\u4f20\u5165\u8bf7\u6c42\u4f1a\u521b\u5efa\u4e00\u4e2a Context \uff0c\u670d\u52a1\u7aef\u7684\u4f20\u51fa\u8c03\u7528\u4f1a\u643a\u5e26\u4e00\u4e2a Context \u3002\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u7aef\u4e4b\u95f4\u7684\u51fd\u6570\u8c03\u7528\u94fe\u5fc5\u987b\u4f20\u9012 Context \uff0c\u5176\u4ed6\u53ef\u9009\u7684\u66ff\u4ee3 Context \u662f\u4e00\u4e2a\u4f7f\u7528 WithCancel \uff0c WithDeadline \uff0c WithTimeout \u6216 WithValue \u521b\u5efa\u7684\u6d3e\u751f Context \u3002\u5f53\u67d0\u4e2a Context \u88ab\u53d6\u6d88\u540e\uff0c\u57fa\u4e8e\u5b83\u6d3e\u751f\u7684\u6240\u6709 Context \u4e5f\u90fd\u4f1a\u88ab\u53d6\u6d88\u3002 WithCancel \uff0c WithDeadline \u548c WithTimeout \u51fd\u6570\u63a5\u53d7\u7236 Context \u5e76\u8fd4\u56de\u6d3e\u751f\u7684\u5b50 Context \u548c\u4e00\u4e2a CancelFunc \u51fd\u6570\u3002\u8c03\u7528 CancelFunc \u51fd\u6570\u4f1a\u53d6\u6d88\u5b50\u6d3e\u751f\u53ca\u5b50\u6d3e\u751f\u7684\u5b50\u9879\uff0c\u5220\u9664\u7236\u9879\u5bf9\u5b50\u9879\u7684\u5f15\u7528\uff0c\u5e76\u505c\u6b62\u6240\u6709\u5173\u8054\u7684\u8ba1\u65f6\u5668\u3002\u8c03\u7528 CancelFunc \u51fd\u6570\u5931\u8d25\u4f1a\u5bfc\u81f4\u6cc4\u6f0f\u5b50\u6d3e\u751f\u53ca\u5b50\u6d3e\u751f\u5b50\u9879\uff0c\u76f4\u5230\u6700\u5f00\u59cb\u7684\u7236\u9879\u88ab\u53d6\u6d88\u6216\u8005\u8ba1\u65f6\u5668\u5230\u8fbe\u800c\u88ab\u89e6\u53d1\u3002 go vet \u5de5\u5177\u68c0\u67e5 CancelFunc \u51fd\u6570\u662f\u5426\u5728\u6240\u6709\u63a7\u5236\u6d41\u8def\u5f84\u4e0a\u4f7f\u7528\u3002 \u4f7f\u7528 Context \u7684\u7a0b\u5e8f\u5e94\u9075\u5faa\u8fd9\u4e9b\u89c4\u5219\uff0c\u4ee5\u4f7f\u5404\u4e2a\u5305\u4e4b\u95f4\u7684\u63a5\u53e3\u4fdd\u6301\u4e00\u81f4\uff0c\u5e76\u542f\u7528\u9759\u6001\u5206\u6790\u5de5\u5177\u6765\u68c0\u67e5 Context \u7684\u4f20\u64ad\uff1a \u4e0d\u8981\u5c06 Context \u5b58\u50a8\u5728\u7ed3\u6784\u7c7b\u578b\u4e2d\uff1b\u800c\u5e94\u8be5\u5c06 Context \u660e\u786e\u4f20\u9012\u7ed9\u9700\u8981\u5b83\u7684\u6bcf\u4e2a\u51fd\u6570\u3002 Context\u5e94\u8be5\u662f\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u901a\u5e38\u547d\u540d\u4e3actx\uff1a go func DoSomething(ctx context.Context, arg Arg) error { // ... use ctx ... } \u5373\u4f7f\u51fd\u6570\u5141\u8bb8\uff0c\u4e5f\u4e0d\u8981\u4f20\u9012 nil Context \u3002\u5982\u679c\u4e0d\u786e\u5b9a\u8981\u4f7f\u7528\u54ea\u4e2a context \uff0c\u8bf7\u4f20\u9012 context.TODO \u3002 \u4ec5\u5c06 Context \u503c\u7528\u4e8e\u8f6c\u6362\u8fdb\u7a0b\u548cAPI\u4e4b\u95f4\u7684\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 \u53ef\u4ee5\u5c06\u76f8\u540c\u7684 Context \u4f20\u9012\u7ed9\u5728\u4e0d\u540c goroutine \u4e2d\u8fd0\u884c\u7684\u51fd\u6570\uff1b Context \u5bf9\u4e8e\u591a\u4e2a goroutine \u540c\u65f6\u4f7f\u7528\u662f\u5b89\u5168\u7684\u3002 \u6709\u5173\u4f7f\u7528 Context \u7684\u670d\u52a1\u793a\u4f8b\u4ee3\u7801\uff0c\u8bf7\u53c2\u9605 \u793a\u4f8b","title":"package context"},{"location":"Language/Library/context/#_1","text":"// Canceled\u662fcontext\u53d6\u6d88\u65f6Context.Err\u8fd4\u56de\u7684\u9519\u8bef var Canceled = errors.New( context canceled ) // DeadlineExceeded\u662fContext.Err\u5728context\u622a\u6b62\u65f6\u95f4\u8fc7\u540e\u8fd4\u56de\u7684\u9519\u8bef var DeadlineExceeded error = deadlineExceededError{}","title":"\u53d8\u91cf"},{"location":"Language/Library/context/#withcancel","text":"func WithCancel(parent Context) (ctx Context, cancel CancelFunc) WithCancel \u8fd4\u56de\u5e26\u6709\u65b0 Done \u901a\u9053\u7684\u7236 context \u7684\u526f\u672c\u3002\u8fd4\u56de\u7684 context \u7684 Done \u901a\u9053\u5c06\u4f1a\u5728\u8c03\u7528\u8fd4\u56de\u7684 cancel \u51fd\u6570\u6216\u7236 context \u7684 Done \u901a\u9053\u5173\u95ed\u65f6\u88ab\u5173\u95ed(\u8fd9\u4e24\u79cd\u60c5\u51b5\u4e2d\u5148\u53d1\u751f\u7684\u4e3a\u51c6\uff09\u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002","title":"\u51fd\u6570WithCancel"},{"location":"Language/Library/context/#withcancel_1","text":"\u6b64\u793a\u4f8b\u6f14\u793a\u4e86\u4f7f\u7528\u53ef\u53d6\u6d88\u7684context\u6765\u9632\u6b62goroutine\u6cc4\u6f0f\u3002\u5728\u793a\u4f8b\u51fd\u6570\u7ed3\u675f\u65f6\uff0cgen\u542f\u52a8\u7684goroutine\u5c06\u8fd4\u56de\u800c\u4e0d\u4f1a\u6cc4\u6f0f\u3002 // gen\u5728\u5355\u72ec\u7684goroutine\u4e2d\u751f\u6210\u6574\u6570\u5c06\u5b83\u4eec\u53d1\u9001\u5230\u8fd4\u56de\u7684channel\u3002 // gen\u7684\u8c03\u7528\u8005\u9700\u8981\u53d6\u6d88\u4e00\u6b21\u4e0a\u4e0b\u6587\uff0c\u4ed6\u4eec\u6d88\u8d39\u751f\u6210\u7684\u6574\u6570\u800c\u4e0d\u6cc4\u6f0f\uff0c // \u5185\u90e8\u7684goroutine\u7531gen\u5f00\u59cb gen := func(ctx context.Context) -chan int { dst := make(chan int) n := 1 go func() { for { select { case -ctx.Done(): return // returning not to leak the goroutine case dst - n: n++ } } }() return dst } ctx, cancel := context.WithCancel(context.Background()) defer cancel() // cancel when we are finished consuming integers for n := range gen(ctx) { fmt.Println(n) if n == 5 { break } } // \u8f93\u51fa 1 2 3 4 5","title":"WithCancel\u793a\u4f8b"},{"location":"Language/Library/context/#withdeadline","text":"func WithDeadline(parent Context, d time.Time) (Context, CancelFunc) WithDeadline\u8fd4\u56de context \u7684\u526f\u672c\uff0c\u4e14\u8be5\u526f\u672c\u7684\u622a\u6b62\u65f6\u95f4\u88ab\u8c03\u6574\u4e3a\u4e0d\u8fdf\u4e8e d \u3002\u5982\u679c\u7236 context \u7684\u622a\u6b62\u65f6\u95f4\u65e9\u4e8e d \uff0c\u5219 WithDeadline\uff08parent\uff0cd\uff09 \u5728\u8bed\u4e49\u4e0a\u7b49\u540c\u4e8e\u7236 context \u3002\u8fd4\u56de\u7684 context \u7684 Done \u901a\u9053\u5728\u622a\u6b62\u65f6\u95f4\u5230\u671f\u3001\u8c03\u7528\u8fd4\u56de\u7684 cancel \u51fd\u6570\u65f6\u6216\u7236 context \u7684 Done \u901a\u9053\u5173\u95ed\u65f6\u5173\u95ed\uff08\u4ee5\u5148\u53d1\u751f\u7684\u60c5\u51b5\u4e3a\u51c6\uff09\u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002","title":"\u51fd\u6570WithDeadline"},{"location":"Language/Library/context/#withdeadline_1","text":"\u8fd9\u4e2a\u4f8b\u5b50\u4f20\u9012\u4e00\u4e2a\u5e26\u6709\u4efb\u610f\u622a\u6b62\u65f6\u95f4\u7684 contezt \u6765\u544a\u8bc9\u963b\u585e\u51fd\u6570\u5b83\u5e94\u8be5\u5728\u622a\u6b62\u65f6\u95f4\u5230\u8fbe\u65f6\u653e\u5f03\u5b83\u7684\u5de5\u4f5c\u3002 d := time.Now().Add(50 * time.Millisecond) ctx, cancel := context.WithDeadline(context.Background(), d) // \u5c3d\u7ba1ctx\u5c06\u4f1a\u8fc7\u671f\uff0c\u6700\u4f73\u5b9e\u8df5\u662f\u5728\u4efb\u4f55\u60c5\u51b5\u4e0b\u90fd\u8981\u8c03\u7528\u5b83\u7684\u53d6\u6d88\u51fd\u6570\u3002 // \u5982\u679c\u4e0d\u8fd9\u6837\u505a\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4fdd\u7559context\u53ca\u5176\u7236context\u7684\u6d3b\u52a8\u65f6\u95f4\u8d85\u8fc7\u6211\u4eec\u7684\u9884\u671f defer cancel() select { case -time.After(1 * time.Second): fmt.Println( overslept ) case -ctx.Done(): fmt.Println(ctx.Err()) }","title":"WithDeadline\u793a\u4f8b"},{"location":"Language/Library/context/#withtimeout","text":"func WithTimeout(parent Context, timeout time.Duration) (Context, CancelFunc) WithTimeout \u51fd\u6570\u8fd4\u56de WithDeadline(parent,time.Now().Add(timeout)) \u3002 \u53d6\u6d88\u6b64 context \u4f1a\u91ca\u653e\u4e0e\u5176\u5173\u8054\u7684\u8d44\u6e90\uff0c\u56e0\u6b64\u4ee3\u7801\u5e94\u5728\u6b64 context \u4e2d\u8fd0\u884c\u7684\u64cd\u4f5c\u5b8c\u6210\u540e\u7acb\u5373\u8c03\u7528 cancel \u51fd\u6570\u3002 func slowOperationWithTimeout(ctx context.Context) (Result, error) { ctx, cancel := context.WithTimeout(ctx, 100*time.Millisecond) defer cancel() // releases resources if slowOperation completes before timeout elapses return slowOperation(ctx) }","title":"\u51fd\u6570WithTimeout"},{"location":"Language/Library/context/#withtimeout_1","text":"\u6b64\u793a\u4f8b\u4f20\u9012\u5177\u6709\u8d85\u65f6\u7684\u4e0a\u4e0b\u6587\uff0c\u4ee5\u544a\u77e5\u963b\u585e\u51fd\u6570\u5728\u8d85\u65f6\u8fc7\u540e\u5b83\u5e94\u8be5\u653e\u5f03\u5176\u5de5\u4f5c\u3002 // \u4f20\u9012\u4e00\u4e2a\u5e26\u6709\u8d85\u65f6\u65f6\u95f4\u7684context\u6765\u544a\u8bc9\u4e00\u4e2a\u6b63\u5728\u963b\u585e\u7684\u51fd\u6570\uff0c // \u5b83\u5e94\u8be5\u5728\u8d85\u65f6\u65f6\u95f4\u8fc7\u540e\u653e\u5f03\u6b63\u5728\u8fdb\u7684\u5de5\u4f5c\u3002 ctx, cancel := context.WithTimeout(context.Background(), 50*time.Millisecond) defer cancel() select { case -time.After(1 * time.Second): fmt.Println( overslept ) case -ctx.Done(): fmt.Println(ctx.Err()) // prints context deadline exceeded }","title":"WithTimeout\u793a\u4f8b"},{"location":"Language/Library/context/#cancelfunc","text":"type CancelFunc func() CancelFunc \u544a\u8bc9\u67d0\u4e2a\u64cd\u4f5c\u653e\u5f03\u5b83\u6b63\u5728\u8fdb\u884c\u7684\u5de5\u4f5c\u3002 CancelFunc \u4e0d\u4f1a\u7b49\u5f85\u5de5\u4f5c\u505c\u6b62\u3002\u7b2c\u4e00\u6b21\u8c03\u7528\u540e\uff0c\u5bf9 CancelFunc \u7684\u540e\u7eed\u8c03\u7528\u90fd\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u3002","title":"\u7c7b\u578bCancelFunc"},{"location":"Language/Library/context/#context","text":"type Context interface { // Deadline\u51fd\u6570\u8fd4\u56de\u5b8c\u6210\u5de5\u4f5c\u7684\u65f6\u95f4\uff08\u8be5\u65f6\u95f4\u4ee3\u8868\u6b64context\u5e94\u8be5\u88ab\u53d6\u6d88\uff09\u3002 // \u5982\u679c\u6ca1\u6709\u8bbe\u7f6edeadline\uff0cDeadline\u51fd\u6570\u8fd4\u56deok==false\u3002 // \u5bf9Deadline\u51fd\u6570\u7684\u8fde\u7eed\u8c03\u7528\u90fd\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 Deadline() (deadline time.Time, ok bool) // Done\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u901a\u9053\uff0c\u5f53\u5de5\u4f5c\u5b8c\u6210\u65f6\u901a\u9053\u5c06\u4f1a\u88ab\u5173\u95ed\uff0c(\u8fd9\u4ee3\u8868\u4e86\u8fd9\u4e2acontext\u5e94\u8be5\u88ab\u53d6\u6d88)\u3002 // \u5982\u679c\u8fd9\u4e2acontext\u4e0d\u80fd\u88ab\u53d6\u6d88\uff0cDone\u51fd\u6570\u4e5f\u53ef\u80fd\u8fd4\u56denil\u3002 // \u5bf9Done\u51fd\u6570\u7684\u8fde\u7eed\u8c03\u7528\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 // \u5f53\u53d6\u6d88\u88ab\u8c03\u7528\u65f6\uff0cWithCancel\u5b89\u6392Done\u901a\u9053\u5173\u95ed // \u5f53\u622a\u6b62\u65f6\u95f4\u8fc7\u671f\u65f6\uff0cWithDeadline\u5b89\u6392Done\u901a\u9053\u5173\u95ed // \u5f53\u8d85\u65f6\u65f6\u95f4\u5230\u671f\u65f6\uff0cWithTimeout\u5b89\u6392Done\u901a\u9053\u5173\u95ed // // Done\u63d0\u4f9b\u7528\u4e8eselect\u8bed\u53e5: // // // Stream\u4f7f\u7528DoSomething\u6765\u751f\u6210\u503c\u5e76\u5c06\u8fd9\u4e9b\u503c\u53d1\u9001\u51fa\u53bb\uff0c // // \u77e5\u9053DoSomething\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u6216\u8005ctx.Done\u88ab\u5173\u95ed\u3002 // func Stream(ctx context.Context, out chan - Value) error { // for { // v, err := DoSomething(ctx) // if err != nil { // return err // } // select { // case -ctx.Done(): // return ctx.Err() // case out - v: // } // } // } // // \u67e5\u9605 https://blog.golang.org/pipelines \u83b7\u53d6\u8ddf\u591a\u5982\u4f55\u4f7f\u7528Done\u901a\u9053\u6765\u53d6\u6d88context\u7684\u4f8b\u5b50\u3002 Done() -chan struct{} // \u5982\u679cDone\u6ca1\u6709\u5173\u95ed\uff0cErr\u51fd\u6570\u8fd4\u56denil\u3002 // \u5982\u679cDone\u5df2\u7ecf\u5173\u95ed\uff0cErr\u51fd\u6570\u8fd4\u56denon-nil\u6765\u89e3\u91ca\uff1a // \u5982\u679c\u662f\u53d6\u6d88\uff0c\u4e3a\u4ec0\u4e48context\u88ab\u53d6\u6d88 // \u5982\u679c\u662f\u622a\u6b62\u65f6\u95f4\u8d85\u65f6\uff0c\u4e3a\u4ec0\u4e48context\u7684\u622a\u6b62\u65f6\u95f4\u8fc7\u4e86 // \u5728Err\u51fd\u6570\u8fd4\u56de\u4e00\u4e2anon-nil\u9519\u8bef\u540e, \u6301\u7eed\u7684\u8c03\u7528Err\u8fd4\u56de\u7684\u90fd\u662f\u540c\u4e00\u4e2a\u9519\u8bef\u3002 Err() error // Value\u51fd\u6570\u8fd4\u56de\u4e0e\u6b64context\u7684\u952e\u5173\u8054\u7684\u503c\uff0c\u5982\u679c\u6ca1\u6709\u503c\u4e0e\u952e\u5173\u8054\uff0c\u5219\u8fd4\u56denil\u3002 // \u4f7f\u7528\u76f8\u540c\u7684\u952e\u8fde\u7eed\u8c03\u7528Value\u51fd\u6570\u4f1a\u8fd4\u56de\u76f8\u540c\u7684\u7ed3\u679c\u3002 // \u4ec5\u5c06context\u503c\u7528\u4e8e\u5207\u6362\u8fdb\u7a0b\u548cAPI\u7684\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 // \u952e\u6807\u8bc6context\u4e2d\u7279\u5b9a\u7684\u503c\u3002\u60f3\u8981\u5728Context\u4e2d\u5b58\u50a8\u503c\u7684\u51fd\u6570\u901a\u5e38\u5728\u5168\u5c40\u53d8\u91cf\u4e2d\u5206\u914d\u4e00\u4e2a\u952e\uff0c // \u7136\u540e\u4f7f\u7528\u8be5\u952e\u4f5c\u4e3acontext.WithValue\u548cContext.Value\u7684\u53c2\u6570\u3002 // \u952e\u53ef\u4ee5\u662f\u652f\u6301\u5224\u7b49\u7684\u4efb\u4f55\u7c7b\u578b; \u5305\u5e94\u8be5\u5c06\u952e\u5b9a\u4e49\u4e3a\u672a\u5bfc\u51fa\u7c7b\u578b\u4ee5\u907f\u514d\u51b2\u7a81\u3002 // \u5b9a\u4e49Context\u952e\u7684\u5305\u5e94\u8be5\u4e3a\u4f7f\u7528\u8be5\u952e\u5b58\u50a8\u7684\u503c\u63d0\u4f9b\u7c7b\u578b\u5b89\u5168\u7684\u8bbf\u95ee\u5668\uff1a // // \u5305\u4f7f\u7528\u8005\u5b9a\u4e49\u4e00\u4e2aUser\u7c7b\u578b\u5b58\u50a8\u5728Context\u4e2d\u3002 // package user // // import context // // // User\u662f\u5b58\u50a8\u5728context\u4e2d\u7684\u503c\u7684\u7c7b\u578b // type User struct {...} // // // \u5b9a\u4e49\u5728\u672c\u5305\u4e2d\u7684\u952e\u662f\u4e00\u4e2a\u975e\u5bfc\u51fa\u7c7b\u578b\u3002 // // \u8fd9\u907f\u514d\u4e86\u4e0e\u5b9a\u4e49\u5728\u5176\u4ed6\u5305\u4e2d\u7684\u952e\u4ea7\u751f\u51b2\u7a81\u3002 // type key int // // // userKey\u662fcontext\u4e2duser.User\u503c\u7684\u952e\u3002\u5b83\u7684\u672a\u5bfc\u51fa\u7684\u3002 // // \u5ba2\u6237\u7aef\u4f7f\u7528user.NewContext\u548cuser.FromContext\u800c\u4e0d\u662f\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e2a\u952e\u3002 // var userKey key // // // NewContext\u8fd4\u56de\u4e00\u4e2a\u65b0\u7684Context\u5176\u4e2d\u643a\u5e26\u503cu\u3002 // func NewContext(ctx context.Context, u *User) context.Context { // return context.WithValue(ctx, userKey, u) // } // // // FromContext\u8fd4\u56deUser\u7684\u503c\uff0c\u8be5\u503c\u5b58\u50a8\u5728ctx\u4e2d(\u5982\u679c\u6709)\u3002 // func FromContext(ctx context.Context) (*User, bool) { // u, ok := ctx.Value(userKey).(*User) // return u, ok // } Value(key interface{}) interface{} } Context \u8de8\u8d8aAPI\u8fb9\u754c\u643a\u5e26\u622a\u6b62\u65f6\u95f4\uff0c\u53d6\u6d88\u4fe1\u53f7\u548c\u5176\u4ed6\u8de8API\u8fb9\u754c\u7684\u503c\u3002 Context \u7684\u65b9\u6cd5\u53ef\u4ee5\u7531\u591a\u4e2a goroutine \u540c\u65f6\u8c03\u7528\u3002","title":"\u7c7b\u578bContext"},{"location":"Language/Library/context/#background","text":"func Background() Context Background() \u8fd4\u56de\u4e00\u4e2a non-nil \u548c\u7a7a\u7684 Context \u3002\u5b83\u6c38\u8fdc\u4e0d\u4f1a\u88ab\u53d6\u6d88\uff0c\u6ca1\u6709\u503c\uff0c\u4e5f\u6ca1\u6709\u622a\u6b62\u65f6\u95f4\u3002\u5b83\u901a\u5e38\u7531\u4e3b\u51fd\u6570\u521d\u59cb\u5316\u548c\u6d4b\u8bd5\uff0c\u5e76\u4f5c\u4e3a\u4f20\u5165\u8bf7\u6c42\u7684\u9876\u7ea7Context\u3002","title":"\u65b9\u6cd5Background"},{"location":"Language/Library/context/#todo","text":"func TODO() Context TODO() \u8fd4\u56de\u4e00\u4e2a non-nil \u548c\u7a7a\u7684 Context \u3002\u4ee3\u7801\u5e94\u8be5\u4f7f\u7528 context.TODO \u5f53\u4e0d\u6e05\u695a\u4f7f\u7528\u54ea\u4e2a Context \u6216\u8005\u5b83\u8fd8\u4e0d\u53ef\u7528\u65f6\uff08\u56e0\u4e3a\u5468\u56f4\u7684\u51fd\u6570\u5c1a\u672a\u6269\u5c55\u4e3a\u63a5\u53d7 Context \u53c2\u6570\uff09\u3002","title":"\u65b9\u6cd5TODO"},{"location":"Language/Library/context/#withvalue","text":"func WithValue(parent Context, key, val interface{}) Context WithValue() \u8fd4\u56de\u7236 context \u7684\u526f\u672c\uff0c\u5176\u4e2d\u4e0ekey\u5173\u8054\u7684\u503c\u4e3a val \u3002 \u4ec5\u5c06 context \u503c\u7528\u4e8e\u8f6c\u6362\u8fdb\u7a0b\u548cAPI\u8bf7\u6c42\u6570\u636e\uff0c\u800c\u4e0d\u662f\u5c06\u53ef\u9009\u53c2\u6570\u4f20\u9012\u7ed9\u51fd\u6570\u3002 \u63d0\u4f9b\u7684\u952e\u5fc5\u987b\u662f\u53ef\u6bd4\u8f83\u7684\uff0c\u4e0d\u5e94\u8be5\u662f\u5b57\u7b26\u4e32\u7c7b\u578b\u6216\u4efb\u4f55\u5176\u4ed6\u5185\u7f6e\u7c7b\u578b\uff0c\u4ee5\u907f\u514d\u4f7f\u7528 context \u7684\u5305\u4e4b\u95f4\u7684\u51b2\u7a81\u3002 WithValue() \u7684\u7528\u6237\u5e94\u8be5\u4e3a\u952e\u5b9a\u4e49\u4ed6\u4eec\u81ea\u5df1\u7684\u7c7b\u578b\u3002\u4e3a\u4e86\u907f\u514d\u5728\u6307\u6d3e\u63a5\u53e3\u65f6\u5206\u914d\uff0c context \u7684\u952e\u901a\u5e38\u6709\u5177\u4f53\u7c7b\u578b\u7684\u7ed3\u6784\u4f53\u3002\u6216\u8005\uff0c\u5bfc\u51fa context \u952e\u7684\u53d8\u91cf\u7684\u9759\u6001\u7c7b\u578b\u5e94\u8be5\u662f\u6307\u9488\u6216\u63a5\u53e3\u3002","title":"\u65b9\u6cd5WithValue"},{"location":"Language/Library/context/#withvalue_1","text":"\u6b64\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5c06\u503c\u4f20\u9012\u7ed9 context \u4ee5\u53ca\u5982\u4f55\u68c0\u7d22\u5b83\uff08\u5982\u679c\u5b58\u5728\uff09\u3002 type favContextKey string f := func(ctx context.Context, k favContextKey) { if v := ctx.Value(k); v != nil { fmt.Println( found value: , v) return } fmt.Println( key not found: , k) } k := favContextKey( language ) ctx := context.WithValue(context.Background(), k, Go ) f(ctx, k) f(ctx, favContextKey( color )) // \u8f93\u51fa found value: Go key not found: color","title":"WithValue\u793a\u4f8b"},{"location":"Language/Library/flag/","text":"package flag import flag flag\u5305\u5b9e\u73b0\u4e86\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u89e3\u6790\u3002 \u4f7f\u7528\u65b9\u5f0f \u4f7f\u7528 flag.String() , Bool() , Int() \u7b49\u6765\u5b9a\u4e49\u547d\u4ee4\u884c\u6807\u8bc6\u3002 \u65b9\u5f0f\u4e00 \u5b9a\u4e49\u4e00\u4e2a\u6574\u6570\u6807\u8bc6 -flagname \uff0c\u5e76\u5c06\u503c\u4fdd\u5b58\u5728 *int \u7c7b\u578b\u7684\u6307\u9488 ip \u4e2d\uff0c\u5176\u4e2d 1234 \u4e3a\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\uff0c \u201dhelp message for flagname\u201c \u662f\u8be5\u6807\u8bc6\u7684\u5e2e\u52a9\u4fe1\u606f\uff1a var ip = flag.Int( flagname , 1234, help message for flagname ) \u65b9\u5f0f\u4e8c \u4f7f\u7528 Var() \u51fd\u6570\u5c06\u8be5\u6807\u8bc6\u7ed1\u5b9a\u5230\u4e00\u4e2a \u53d8\u91cf \u4e0a\uff0c\u5982\u4e0b\u6240\u793a\uff1a var flagvar int // \u5b9a\u4e49\u6807\u8bc6\u8981\u7ed1\u5b9a\u7684\u53d8\u91cf func init() { flag.IntVar( flagvar, flagname , 1234, help message for flagname ) } \u65b9\u5f0f\u4e09 \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u6807\u8bc6\uff08\u4f7f\u7528\u6307\u9488\u63a5\u6536\u5668\uff09\uff0c\u53ea\u8981\u8be5\u6807\u8bc6\u6ee1\u8db3Value\u63a5\u53e3\uff0c\u7136\u540e\u5c06\u5b83\u7ed1\u5b9a\u5230\u6807\u8bc6\u89e3\u6790\u5668\uff0c\u5982\u679c\u4f7f\u7528\u8fd9\u6837\u7684\u53d8\u91cf\u6765\u81ea\u5b9a\u4e49\u6807\u8bc6\uff0c\u90a3\u4e48\u9ed8\u8ba4\u503c\u5c31\u662f \u53d8\u91cf\u7684\u521d\u59cb\u503c \u3002 flag.Var( flagVal, name , help message for flagname ) \u5728\u6240\u6709\u7684\u6807\u8bc6\u90fd\u5b9a\u4e49\u5b8c\u6210\u4e4b\u540e\uff0c\u6267\u884c\u4e0b\u9762\u7684\u8c03\u7528,\u5c06\u547d\u4ee4\u884c\u89e3\u6790\u5230\u5b9a\u4e49\u7684\u6807\u8bc6\u4e2d\uff1a flag.Parse() \u7136\u540e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bc6\uff1a \u5982\u679c\u76f4\u63a5\u4f7f\u7528\u6807\u8bc6\u672c\u8eab\uff0c\u90a3\u4e48\u5b83\u4eec\u90fd\u662f \u6307\u9488 \u5982\u679c\u5c06\u6807\u8bc6\u7ed1\u5b9a\u5230\u53d8\u91cf\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u662f \u503c fmt.Println( ip has value , *ip) fmt.Println( flagvar has value , flagvar) \u89e3\u6790\u540e\uff0c\u6240\u6709\u6807\u8bc6\u5bf9\u5e94\u7684\u53c2\u6570\u53ef\u7528\u5207\u7247 flag.Args() \u6216\u7528 flag.Arg(i) \u4e00\u4e2a\u4e2a\u72ec\u7acb\u7684\u83b7\u53d6\u5230\u3002\u53c2\u6570\u4ece0\u5f00\u59cb\u901a\u8fc7 flag.NArg()-1 \u7d22\u5f15\u3002 \u547d\u4ee4\u884c\u6807\u8bc6\u8bed\u6cd5 \u4ee5\u4e0b\u5f62\u5f0f\u7684\u547d\u4ee4\u884c\u53c2\u6570\u662f\u5141\u8bb8\u7684\uff1a -flag -flag=x -flag x // \u4ec5\u9650\u975e\u5e03\u5c14\u6807\u8bc6 \u4f7f\u7528 - \u6216\u8005 -- \u90fd\u662f\u53ef\u4ee5\uff0c\u5b83\u4eec\u662f\u7b49\u4ef7\u7684\u3002\u7531\u4e8e\u547d\u4ee4\u53ef\u80fd\u5305\u542b\u7684\u542b\u4e49\uff0c\u5e03\u5c14\u578b\u7684\u6807\u8bc6\u4e0d\u5141\u8bb8\u4f7f\u7528\u7b2c\u4e09\u79cd\u5f62\u5f0f\u3002 cmd -x * \u5176\u4e2d * \u662fUnix shell\u7684\u901a\u914d\u7b26\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u6587\u4ef6\u7684\u540d\u5b57\u662f 0 \u3001 false \u7b49\u7b49\u65f6\uff0c\u4f1a\u4f7f\u547d\u4ee4\u4ea7\u751f\u6b67\u4e49\uff0c\u56e0\u6b64\u5fc5\u987b\u4f7f\u7528 -flag=false \u6765\u5173\u95ed\u4e00\u4e2a\u5e03\u5c14\u578b\u7684\u6807\u8bc6\u3002 \u505c\u6b62\u89e3\u6790\u6807\u8bc6\u7684\u4f4d\u7f6e\uff1a \u7b2c\u4e00\u4e2a\u975e\u6807\u8bc6\u53c2\u6570\u524d\uff08 - \u662f\u4e00\u4e2a\u975e\u6807\u8bc6\u53c2\u6570\uff09 \u5728\u7ec8\u6b62\u7b26 -- \u540e \u6574\u578b\u6807\u8bc6\u63a5\u6536 1234 \u3001 0666 \u3001 0x1234 \u6216\u8005\u53ef\u80fd\u662f\u8d1f\u6574\u6570\u3002 \u5e03\u5c14\u578b\u7684\u6807\u8bc6\u53ef\u4ee5\u5982\u4e0b\uff1a 1, t, T, true, TRUE\uff0c True 0, f, F, false, FALSE, False \u6301\u7eed\u65f6\u95f4( Duration )\u6807\u8bc6\u63a5\u53d7\u4efb\u4f55 time.ParseDuration \u7684\u6709\u6548\u8f93\u5165\u3002 \u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\u7531\u9876\u7ea7\u51fd\u6570\u63a7\u5236\u3002 FlagSet \u7c7b\u578b\u5141\u8bb8\u5b9a\u4e49\u72ec\u7acb\u7684\u6807\u8bc6\u96c6\uff0c\u4f8b\u5982\u5728\u547d\u4ee4\u884c\u754c\u9762\u4e2d\u5b9e\u73b0\u5b50\u547d\u4ee4\u3002 FlagSet \u7684\u65b9\u6cd5\u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\u7684\u9876\u7ea7\u51fd\u6570\u3002 \u793a\u4f8b // \u8fd9\u4e9b\u793a\u4f8b\u6f14\u793a\u4e86flag\u5305\u7684\u66f4\u590d\u6742\u7528\u6cd5 package main import ( errors flag fmt strings time ) // \u793a\u4f8b1\uff1a\u540d\u4e3a\u201cspecies\u201d\u7684\u5355\u5b57\u7b26\u4e32\u6807\u8bc6\uff0c\u9ed8\u8ba4\u503c\u4e3a\u201cgopher\u201d\u3002 var species = flag.String( species , gopher , the species we are studying ) //\u793a\u4f8b2\uff1a\u5171\u4eab\u53d8\u91cf\u7684\u4e24\u4e2a\u6807\u8bc6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b80\u5199\u3002 //\u521d\u59cb\u5316\u987a\u5e8f\u672a\u5b9a\u4e49\uff0c\u56e0\u6b64\u8bf7\u786e\u4fdd\u4e24\u8005\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u9ed8\u8ba4\u503c\u3002\u5fc5\u987b\u4f7f\u7528init\u51fd\u6570\u8bbe\u7f6e\u5b83\u4eec\u3002 var gopherType string func init() { const ( defaultGopher = pocket usage = the variety of gopher ) flag.StringVar( gopherType, gopher_type , defaultGopher, usage) flag.StringVar( gopherType, g , defaultGopher, usage+ (shorthand) ) } // \u793a\u4f8b3:\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u6807\u8bc6\u7c7b\u578b,\u662f\u4e00\u4e2a\u6301\u7eed\u65f6\u95f4\u7684\u5207\u7247 type interval []time.Duration // String\u65b9\u6cd5\u7528\u4e8e\u683c\u5f0f\u6237\u6807\u8bc6\u7684\u503c,\u662fflag.Value\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002 // String\u65b9\u6cd5\u7684\u8f93\u51fa\u5c06\u7528\u4e8e\u8bca\u65ad\u3002 func (i *interval) String() string { return fmt.Sprint(*i) } // Set\u65b9\u6cd5\u7528\u4e8e\u8bbe\u7f6e\u6807\u8bc6\u7684\u503c\uff0c\u4e5f\u662fflag.Value\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002 // Set\u65b9\u6cd5\u7684\u53c2\u6570\u662fstring\u7c7b\u578b\u7684\u88ab\u89e3\u6790\u540e\u7528\u4e8e\u8bbe\u7f6e\u8be5\u6807\u8bc6\u3002 // \u8fd9\u662f\u4e00\u4e2a\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff0c\u6240\u4ee5\u6211\u4eec\u62c6\u5206\u5b83\u3002 func (i *interval) Set(value string) error { // \u5982\u679c\u6211\u4eec\u5141\u8bb8\u591a\u6b21\u8bbe\u7f6e\u6807\u8bc6\u6765\u7d2f\u79ef\u503c\uff0c\u5c31\u9700\u8981\u5c06\u4e0b\u9762\u7684if\u8bed\u53e5\u5220\u9664\u3002 // \u8fd9\u5c06\u8fd0\u884c\u8bf8\u5982\u6b64\u7c7b\u7684\u7528\u6cd5\uff1a -deltaT 10s -deltaT 15s \u548c\u5176\u4ed6\u7684\u7ec4\u5408\u3002 if len(*i) 0 { return errors.New( interval flag already set ) } for _, dt := range strings.Split(value, , ) { duration, err := time.ParseDuration(dt) if err != nil { return err } *i = append(*i, duration) } return nil } // \u5b9a\u4e49\u4e00\u4e2a\u6807\u8bc6\u6765\u7d2f\u79ef\u6301\u7eed\u65f6\u95f4\u3002\u56e0\u4e3a\u5b83\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u7c7b\u578b\uff0c // \u6211\u4eec\u9700\u8981\u4f7f\u7528Var\u51fd\u6570\uff0c\u5e76\u5728init\u671f\u95f4\u521b\u5efa\u8be5\u6807\u8bc6\u3002 var intervalFlag interval func init() { // \u5c06\u547d\u4ee4\u884c\u6807\u8bc6\u7ed1\u5b9a\u5230intervalFlag\u53d8\u91cf\u5e76\u8bbe\u7f6e\u4f7f\u7528\u65b9\u5f0f\u6d88\u606f\u3002 flag.Var( intervalFlag, deltaT , comma-separated list of intervals to use between events ) } func main() { // \u6709\u8da3\u7684\u662f\u4f7f\u7528\u4e0a\u9762\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u4e3a\u4e86\u4f7fflag\u5305\u80fd\u591f\u770b\u5230\u4e0a\u9762\u5b9a\u4e49\u7684\u6807\u8bc6\uff0c\u5fc5\u987b\u6267\u884c\uff0c\u901a\u5e38\u5728main\uff08\u800c\u4e0d\u662finit\uff09\u7684\u5f00\u5934\u6267\u884c\uff1a flag.Parse() // \u6211\u4eec\u4e0d\u5728\u8fd9\u91cc\u8fd0\u884c\u5b83\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u662fmain\u51fd\u6570\uff0c\u5e76\u4e14\u6d4b\u8bd5\u5957\u4ef6\u5df2\u7ecf\u89e3\u6790\u4e86\u6807\u8bc6\u3002 } \u53d8\u91cf var CommandLine = NewFlagSet(os.Args[0], ExitOnError) CommandLine\u662f\u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\uff0c\u4ece os.Args \u89e3\u6790\u3002\u9876\u7ea7\u51fd\u6570\uff08\u5982BoolVar\uff0cArg\u7b49\uff09\u662fCommandLine\u65b9\u6cd5\u7684\u5305\u88c5\u5668\u3002 var ErrHelp = errors.New( flag: help requested ) ErrHelp\u662f\u5728\u8c03\u7528 -help \u6216 -h \u6807\u8bc6\u4f46\u672a\u5b9a\u4e49\u6b64\u7c7b\u6807\u8bc6\u65f6\u8fd4\u56de\u7684\u9519\u8bef\u3002 var Usage = func() { fmt.Fprintf(CommandLine.Output(), Usage of %s:\\n , os.Args[0]) PrintDefaults() } Usage \u6253\u5370\u4e00\u6761\u7528\u6cd5\u6d88\u606f\uff0c\u8be5\u6d88\u606f\u4e2d\u8bb0\u5f55\u6240\u6709\u5df2\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u5e76\u8f93\u51fa\u5230 CommandLine.output() \uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u8f93\u51fa\u5230 os.Stderr \u3002\u53ea\u6709\u5f53\u89e3\u6790\u6807\u8bc6\u53d1\u751f\u9519\u8bef\u65f6\u624d\u8c03\u7528 Usage \uff0c \u89c1\u7c7b\u578b\u90e8\u5206\u4e2dFlag\u7ed3\u6784\u4f53 \u3002 Usage \u53d8\u91cf\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u66f4\u6539\u4e3a\u6307\u5411\u5176\u4ed6\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f1a\u6253\u5370\u4e00\u4e2a\u7b80\u5355\u7684\u6807\u9898\u5e76\u8c03\u7528 PrintDefaults \uff1b\u6709\u5173\u8f93\u51fa\u683c\u5f0f\u53ca\u5176\u63a7\u5236\u65b9\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 PrintDefaults \u7684\u6587\u6863\u6216\u8005\u67e5\u770b\u4e0b\u9762\u7684\u51fd\u6570\u8bf4\u660e\u3002 \u81ea\u5b9a\u4e49\u7684 Usage \u51fd\u6570\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u9000\u51fa\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u662f\u8fd9\u6837\uff0c\u56e0\u4e3a\u547d\u4ee4\u884c\u7684\u9519\u8bef\u5904\u7406\u7b56\u7565\u8bbe\u7f6e\u4e3a ExitOnError \u3002 \u51fd\u6570 func Arg\uff08i int\uff09 string Arg\u8fd4\u56de\u7b2ci\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002 Arg(0) \u662f\u5904\u7406\u5b8c\u6807\u8bc6\u540e\u7684\u7b2c\u4e00\u4e2a\u5269\u4f59\u53c2\u6570\u3002\u5982\u679c\u8bf7\u6c42\u7684\u5143\u7d20\u4e0d\u5b58\u5728\uff0cArg\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u3002 func Args() []string Args\u8fd4\u56de\u975e\u6807\u8bc6\u547d\u4ee4\u884c\u53c2\u6570\u3002 // Bool\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684bool\u53d8\u91cf\u7684\u5730\u5740\uff08\u6307\u9488\uff09 func Bool(name string, value bool, usage string) *bool{ } // BoolVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2abool\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func BoolVar(p *bool, name string, value bool, usage string){ } // Duration\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684time.Duration\u53d8\u91cf\u7684\u5730\u5740\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func Duration(name string, value time.Duration, usage string) *time.Duration{ } // DurationVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411time.Duration\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func DurationVar(p *time.Duration, name string, value time.Duration, usage string){ } // Float64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684float64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Float64(name string, value float64, usage string) *float64{ } // Float64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2afloat64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Float64Var(p *float64, name string, value float64, usage string){ } // Int\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int\u53d8\u91cf\u7684\u5730\u5740\u3002 func Int(name string, value int, usage string) *int{ } // IntVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func IntVar(p *int, name string, value int, usage string){ } // Int64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Int64(name string, value int64, usage string) *int64{ } // Int64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Int64Var(p *int64, name string, value int64, usage string){ } // NArg\u8fd4\u56de\u7684\u662f\u5904\u7406\u6807\u8bc6\u540e\u5269\u4f59\u7684\u53c2\u6570\u4e2a\u6570\u3002 func NArg() int{ } // NFlag\u8fd4\u56de\u5df2\u8bbe\u7f6e\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u6570\u91cf\u3002 func NFlag() int{ } // Parse\u4eceos.Args[1:]\u4e2d\u89e3\u6790\u547d\u4ee4\u884c\u6807\u8bc6\u3002\u5fc5\u987b\u5728\u5b9a\u4e49\u6240\u6709\u6807\u8bc6\u4e4b\u540e\u5e76\u4e14\u5728\u7a0b\u5e8f\u8bbf\u95ee\u6807\u8bc6\u4e4b\u524d\u8c03\u7528\u3002 func Parse(){ } // Parsed\u62a5\u544a\u662f\u5426\u5df2\u89e3\u6790\u547d\u4ee4\u884c\u6807\u8bc6\u3002 func Parsed() bool{ } // \u9664\u975e\u53e6\u5916\u914d\u7f6e\u4e86\u8f93\u51fa\u4f4d\u7f6e\uff0c\u5426\u5219PrintDefaults\u4f1a\u5c06\u5185\u5bb9\u6253\u5370\u5728\u6807\u51c6\u9519\u8bef\u4e2d\u3002\u8f93\u51fa\u7684\u5185\u5bb9\u4e3a\u4e00\u4e2a\u5305\u542b\u6240\u6709\u5df2\u7ecf\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u7684\u7528\u6cd5\u6d88\u606f\u3002 func PrintDefaults() // \u5bf9\u4e8e\u6574\u6570\u503c\u6807\u8bc6x\uff0c\u9ed8\u8ba4\u8f93\u51fa\u5982\u4e0b\u6240\u793a\uff1a -x int usage-message-for-x (default 7) \u9664\u4e86\u5e26\u6709\u5355\u5b57\u8282\u540d\u79f0\u7684bool\u6807\u8bc6\u5916\uff0c\u7528\u6cd5\u6d88\u606f\u5c06\u53e6\u8d77\u4e00\u884c\u663e\u793a\u3002\u5bf9\u4e8ebool\u6807\u8bc6\uff0c\u7701\u7565\u7c7b\u578b\uff0c\u5982\u679c\u6807\u8bc6\u540d\u79f0\u662f\u4e00\u4e2a\u5b57\u8282\uff0c\u5219\u7528\u6cd5\u6d88\u606f\u5c06\u663e\u793a\u5728\u540c\u4e00\u884c\u3002 \u5982\u679c\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\u4e3a\u96f6\u503c\uff0c\u5219\u4f1a\u7701\u7565\u7528\u6cd5\u6d88\u606f\u540e\u9762\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u3002\u5728\u5b9a\u4e49\u6807\u8bc6\u65f6\uff0c\u53ef\u4ee5\u7528\u53cd\u5f15\u53f7\u5c06\u6807\u8bc6\u7684\u7528\u6cd5\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e2a\u540d\u79f0\u5f15\u8d77\u6765\uff0c\u90a3\u4e48\uff0c\u7528\u6cd5\u6d88\u606f\u4e2d\u7684\u7b2c\u4e00\u4e2a\u88ab\u53cd\u5f15\u53f7\u5f15\u8d77\u6765\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u8981\u5728\u6d88\u606f\u4e2d\u663e\u793a\u7684\u9ed8\u8ba4\u503c\uff0c\u5e76\u4e14\u5728\u663e\u793a\u65f6\u5c06\u4ece\u6d88\u606f\u4e2d\u5220\u9664\u53cd\u5f15\u53f7\u3002 \u5982\u4e0b\u6240\u793a\uff1a flag.String( I , , search `directory` for include files ) // \u7528\u6cd5\u6d88\u606f\u8f93\u51fa\u5982\u4e0b -I directory search directory for include files. \u8981\u66f4\u6539\u6807\u8bc6\u7684\u7528\u6cd5\u6d88\u606f\u7684\u8f93\u51fa\u4f4d\u7f6e\uff0c\u8bf7\u8c03\u7528 CommandLine.SetOutput() \u3002 func Set(name, value string) error{ } Set\u8bbe\u7f6e\u5df2\u7ecf\u88ab\u547d\u540d\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u503c\u3002 // String\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5730\u5740\u3002 func String(name string, value string, usage string) *string{ } // StringVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func StringVar(p *string, name string, value string, usage string){ } // Uint\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint\u53d8\u91cf\u7684\u5730\u5740\u3002 func Uint(name string, value uint, usage string) *uint{ } // UintVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func UintVar(p *uint, name string, value uint, usage string){ } // Uint64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Uint64(name string, value uint64, usage string) *uint64{ } // Uint64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Uint64Var(p *uint64, name string, value uint64, usage string){ } // UnquoteUsage\u4ece\u6807\u8bc6\u7684\u7528\u6cd5\u5b57\u7b26\u4e32\u4e2d\u63d0\u53d6\u88ab\u53cd\u5f15\u53f7\u5f15\u8d77\u6765\u7684\u540d\u79f0\u5e76\u8fd4\u56de\u5b83,\u540c\u65f6\u8fd4\u56de\u53bb\u6389\u53cd\u5f15\u53f7\u540e\u7684\u7528\u6cd5\u6d88\u606f\u3002 func UnquoteUsage(flag *Flag) (name string, usage string){ } // \u7ed9\u5b9a\u5982\u4e0b\u7528\u6cd5\u6d88\u606f a `name` to show // UnquoteUsage\u8f93\u51fa\u7684\u5185\u5bb9\u5982\u4e0b ( name , a name to show ) // \u5982\u679c\u6ca1\u6709\u53cd\u5f15\u53f7\uff0c\u5219\u8be5\u540d\u79f0\u662f\u5bf9\u6807\u8bc6\u503c\u7c7b\u578b\u7684\u6709\u6839\u636e\u7684\u731c\u6d4b\uff0c\u5982\u679c\u8be5\u6807\u8bc6\u662f\u5e03\u5c14\u503c\uff0c\u5219\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 func Var(value Value, name string, usage string) Var\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u6807\u8bc6\u3002 \u6807\u8bc6\u7684\u7c7b\u578b\u548c\u503c\u7531\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\uff0c\u7c7b\u578b\u4e3aValue\uff0c\u5b83\u901a\u5e38\u5305\u542b \u7528\u6237\u5b9a\u4e49\u7684Value\u5b9e\u73b0 \u3002 \u4f8b\u5982\uff0c\u8c03\u7528\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6807\u8bc6\uff0c\u901a\u8fc7\u4e3a\u5207\u7247\u63d0\u4f9bValue\u65b9\u6cd5\uff0c\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5207\u7247; \u5c24\u5176\u662f\uff0cSet\u4f1a\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u5206\u89e3\u4e3a\u5207\u7247\u3002 // Visit\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u547d\u4ee4\u884c\u6807\u8bc6\uff0c\u5b83\u53ea\u8bbf\u95ee\u5df2\u8bbe\u7f6e\u7684\u90a3\u4e9b\u6807\u8bc6\u3002 func Visit(fn func(*Flag)){ } // VisitAll\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u547d\u4ee4\u884c\u6807\u8bc6\uff0c\u5b83\u8bbf\u95ee\u6240\u6709\u6807\u8bc6\uff0c\u751a\u81f3\u90a3\u4e9b\u672a\u8bbe\u7f6e\u7684\u6807\u8bc6\u3002 func VisitAll(fn func(*Flag)){ } \u7c7b\u578b // ErrorHandling\u5b9a\u4e49\u4e86\u5982\u679c\u89e3\u6790\u5931\u8d25\uff0cFlagSet.Parse\u7684\u884c\u4e3a\u65b9\u5f0f\u3002 type ErrorHandling int // \u5982\u679c\u89e3\u6790\u5931\u8d25\uff0c\u8fd9\u4e9b\u5e38\u91cf\u53cd\u5e94\u4e86FlagSet.Parse\u7684\u884c\u4e3a\u3002 const ( ContinueOnError ErrorHandling = iota // \u8fd4\u56de\u63cf\u8ff0\u6027\u9519\u8bef ExitOnError // \u8c03\u7528os.Exit(2). PanicOnError // \u8c03\u7528\u8fd0\u884c\u65f6\u6050\u614c\u5e76\u8fd4\u56de\u63cf\u8ff0\u6027\u9519\u8bef ) // Flag\u8868\u793a\u6807\u8bc6\u7684\u72b6\u6001\u3002 type Flag struct { Name string // \u547d\u4ee4\u884c\u4e0a\u663e\u793a\u7684\u540d\u79f0 Usage string // \u5e2e\u52a9\u4fe1\u606f/\u7528\u6cd5\u4fe1\u606f Value Value // \u8bbe\u5b9a\u7684\u503c DefValue string // \u7528\u6cd5\u4fe1\u606f\u7684\u9ed8\u8ba4\u503c\uff08\u6587\u672c\u5f62\u5f0f\uff09 } // Lookup\u8fd4\u56de\u6307\u5b9a\u547d\u4ee4\u884c\u6807\u8bc6\u7684Flag\u7ed3\u6784\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denil\u3002 func Lookup(name string) *Flag // FlagSet\u8868\u793a\u4e00\u7ec4\u5b9a\u4e49\u7684\u6807\u8bc6\u3002FlagSet\u7684\u96f6\u503c\u6ca1\u6709\u540d\u79f0\uff0c\u5e76\u4e14\u5177\u6709ContinueOnError\u9519\u8bef\u5904\u7406\u3002 type FlagSet struct { // Usage\u662f\u5728\u89e3\u6790\u6807\u8bc6\u53d1\u751f\u9519\u8bef\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u8be5\u5b57\u6bb5\u662f\u4e00\u4e2a\u51fd\u6570\uff08\u4e0d\u662f\u65b9\u6cd5\uff09\uff0c // \u53ef\u4ee5\u66f4\u6539\u4e3a\u6307\u5411\u81ea\u5b9a\u4e49\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002\u8c03\u7528Usage\u540e\u4f1a\u53d1\u751f\u4ec0\u4e48\u53d6\u51b3\u4e8eErrorHandling\u7684\u8bbe\u7f6e; // \u5bf9\u4e8e\u547d\u4ee4\u884c\uff0c\u9ed8\u8ba4\u662fExitOnError\uff0c\u5b83\u5c06\u5728\u8c03\u7528Usage\u540e\u9000\u51fa\u7a0b\u5e8f\u3002 Usage func(){} // \u4e3a\u4e86\u663e\u793a\u6b63\u5e38\uff0c\u6b64\u5904\u6ca1\u6709\u5927\u62ec\u53f7 // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } // NewFlagSet\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\u548c\u9519\u8bef\u5904\u7406\u5c5e\u6027\u7684\u65b0\u7684\u7a7a\u6807\u8bc6\u96c6\u3002\u5982\u679c\u540d\u79f0\u4e0d\u4e3a\u7a7a\uff0c\u5219\u5c06\u5728\u9ed8\u8ba4\u7528\u6cd5\u6d88\u606f\u548c\u9519\u8bef\u6d88\u606f\u4e2d\u6253\u5370\u3002 func NewFlagSet(name string, errorHandling ErrorHandling) *FlagSet{ } // Arg\u8fd4\u56de\u7b2ci\u4e2a\u53c2\u6570\u3002Arg(0)\u662f\u5904\u7406\u5b8c\u6807\u8bc6\u540e\u5269\u4f59\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002\u5982\u679c\u8bf7\u6c42\u7684\u5143\u7d20\u4e0d\u5b58\u5728\uff0cArg\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u3002 func (f *FlagSet) Arg(i int) string{ } // Args\u8fd4\u56de\u975e\u6807\u8bc6\u7684\u53c2\u6570\u3002 func (f *FlagSet) Args() []string{ } // Bool\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684bool\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Bool(name string, value bool, usage string) *bool{ } // BoolVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2abool\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) BoolVar(p *bool, name string, value bool, usage string){ } // Duration\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684time.Duration\u53d8\u91cf\u7684\u5730\u5740\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func (f *FlagSet) Duration(name string, value time.Duration, usage string) *time.Duration{ } // DurationVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411time.Duration\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func (f *FlagSet) DurationVar(p *time.Duration, name string, value time.Duration, usage string){ } // ErrorHandling\u8fd4\u56de\u6807\u8bc6\u96c6\u7684\u9519\u8bef\u5904\u7406\u884c\u4e3a\u3002 func (f *FlagSet) ErrorHandling() ErrorHandling // Float64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684float64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Float64(name string, value float64, usage string) *float64{ } // Float64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2afloat64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Float64Var(p *float64, name string, value float64, usage string){ } // Init\u4e3a\u6807\u8bc6\u96c6\u8bbe\u7f6e\u540d\u79f0\u548c\u9519\u8bef\u5904\u7406\u5c5e\u6027\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e3a\u96f6\u503c\u7684FlagSet\u4f7f\u7528\u7a7a\u540d\u79f0\u548cContinueOnError\u9519\u8bef\u5904\u7406\u7b56\u7565\u3002 func (f *FlagSet) Init(name string, errorHandling ErrorHandling){ } // Int\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Int(name string, value int, usage string) *int{ } // Int64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Int64(name string, value int64, usage string) *int64{ } // Int64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Int64Var(p *int64, name string, value int64, usage string){ } // IntVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) IntVar(p *int, name string, value int, usage string){ } // Lookup\u8fd4\u56de\u6307\u5b9a\u6807\u8bc6\u7684Flag\u7ed3\u6784\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denil\u3002 func (f *FlagSet) Lookup(name string) *Flag{ } // NArg\u662f\u5904\u7406\u6807\u8bc6\u540e\u5269\u4f59\u7684\u53c2\u6570\u4e2a\u6570\u3002 func (f *FlagSet) NArg() int{ } // NFlag\u8fd4\u56de\u5df2\u8bbe\u7f6e\u7684\u6807\u8bc6\u6570\u3002 func (f *FlagSet) NFlag() int{ } // Name\u8fd4\u56de\u6807\u8bc6\u96c6\u7684\u540d\u79f0\u3002 func (f *FlagSet) Name() string{ } // Output\u8fd4\u56de\u7528\u6cd5\u6d88\u548c\u9519\u8bef\u6d88\u606f\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002\u5982\u679c\u672a\u8bbe\u7f6eoutput\u6216\u8bbe\u7f6e\u4e3anil\uff0c\u5219\u8fd4\u56deos.Stderr\u3002 func (f *FlagSet) Output() io.Writer{ } // Parse\u4ece\u53c2\u6570\u5217\u8868\u4e2d\u89e3\u6790\u6807\u8bc6\u5b9a\u4e49\uff0c\u8be5\u5217\u8868\u4e0d\u5305\u542b\u547d\u4ee4\u7684\u540d\u79f0\u3002\u5fc5\u987b\u5728\u5b9a\u4e49FlagSet\u4e2d\u7684\u6240\u6709\u6807\u8bc6\u4e4b\u540e\u5e76\u4e14\u5728\u7a0b\u5e8f\u8bbf\u95ee\u6807\u8bc6\u4e4b\u524d\u8c03\u7528\u3002\u5982\u679c\u672a\u5b9a\u4e49-help\u6216-h\uff0c\u5219\u8fd4\u56de\u503c\u4e3aErrHelp\u3002 func (f *FlagSet) Parse(arguments []string) error{ } // Parsed\u62a5\u544a\u662f\u5426\u5df2\u8c03\u7528f.Parse\u3002 func (f *FlagSet) Parsed() bool{ } // \u9664\u975e\u53e6\u5916\u914d\u7f6e\uff0c\u5426\u5219PrintDefaults\u4f1a\u628a\u6574\u4e2a\u6807\u8bc6\u96c6\u4e2d\u5b9a\u4e49\u7684\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\u8f93\u51fa\u5230\u6807\u51c6\u9519\u8bef\u4e2d\uff0c\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4e0a\u9762\u7684\u5168\u5c40\u51fd\u6570PrintDefaults\u7684\u6587\u6863\u3002 func (f *FlagSet) PrintDefaults(){ } // Set\u8bbe\u7f6e\u6307\u5b9a\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Set(name, value string) error{ } // SetOutput\u8bbe\u7f6e\u7528\u6cd5\u6d88\u606f\u548c\u9519\u8bef\u6d88\u606f\u7684\u76ee\u7684\u5730\u3002\u5982\u679coutput\u8bbe\u7f6e\u4e3anil\uff0c\u5219\u4f7f\u7528os.Stderr\u3002 func (f *FlagSet) SetOutput(output io.Writer){ } // String\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) String(name string, value string, usage string) *string{ } // StringVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) StringVar(p *string, name string, value string, usage string){ } // Uint\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Uint(name string, value uint, usage string) *uint{ } // Uint64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Uint64(name string, value uint64, usage string) *uint64{ } // Uint64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Uint64Var(p *uint64, name string, value uint64, usage string){ } // UintVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) UintVar(p *uint, name string, value uint, usage string){ } // Var\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u6807\u8bc6\u3002\u6807\u8bc6\u7684\u7c7b\u578b\u548c\u503c\u7531\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\uff0c\u7c7b\u578b\u4e3aValue\uff0c\u5b83\u901a\u5e38\u5305\u542b\u7528\u6237\u5b9a\u4e49\u7684Value\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u8c03\u7528\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6807\u8bc6\uff0c\u901a\u8fc7\u4e3a\u5207\u7247\u63d0\u4f9bValue\u65b9\u6cd5\uff0c\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5207\u7247; \u5c24\u5176\u662f\uff0cSet\u4f1a\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u5206\u89e3\u4e3a\u5207\u7247\u3002 func (f *FlagSet) Var(value Value, name string, usage string) // Visit\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u6807\u8bc6\uff0c\u5b83\u53ea\u8bbf\u95ee\u5df2\u8bbe\u7f6e\u7684\u90a3\u4e9b\u6807\u8bc6\u3002 func (f *FlagSet) Visit(fn func(*Flag)) // VisitAll\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u6807\u8bc6\uff0c\u5b83\u8bbf\u95ee\u6240\u6709\u6807\u8bc6\uff0c\u751a\u81f3\u90a3\u4e9b\u672a\u8bbe\u7f6e\u7684\u6807\u8bc6\u3002 func (f *FlagSet) VisitAll(fn func(*Flag)) type Getter interface { Value Get() interface{} } Getter\u662f\u4e00\u4e2a\u5141\u8bb8\u68c0\u7d22Value\u5185\u5bb9\u7684\u63a5\u53e3\u3002\u56e0\u4e3a\u5b83\u51fa\u73b0\u5728Go1\u53ca\u5176\u517c\u5bb9\u6027\u89c4\u5219\u4e4b\u540e\uff0c\u6240\u4ee5\u5b83\u7ec4\u5408\u4e86Value\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u6210\u4e3avalue\u63a5\u53e3\u7684\u4e00\u90e8\u5206\uff0c\u6b64flag\u5305\u63d0\u4f9b\u7684\u6240\u6709Value\u7c7b\u578b\u90fd\u6ee1\u8db3Getter\u63a5\u53e3\u3002 type Value interface { String() string Set(string) error } Value\u662f\u5b58\u50a8\u5728\u4e00\u4e2a\u6807\u8bc6\u4e2d\u7684\u52a8\u6001\u503c\u7684\u63a5\u53e3\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u8868\u793a\u662f\u5b57\u7b26\u4e32\u3002 \u5982\u679c\u67d0\u4e2aValue\u63a5\u53e3\u7684 IsBoolFlag() \u65b9\u6cd5\u8fd4\u56detrue\uff0c\u5219\u547d\u4ee4\u884c\u89e3\u6790\u5668\u4f7f -name \u7b49\u6548\u4e8e -name=true \uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u4e0b\u4e00\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002 \u4e3a\u6bcf\u4e2a\u5b58\u5728\u7684\u6807\u8bc6\uff0c\u4ee5\u547d\u4ee4\u884c\u987a\u5e8f\u8c03\u7528\u4e14\u4ec5\u8c03\u7528\u4e00\u6b21Set\u3002flag\u5305\u4f1a\u4f7f\u7528\u96f6\u503c\u63a5\u6536\u5668\u8c03\u7528String\u65b9\u6cd5\uff0c\u4f8b\u5982nil\u6307\u9488\u3002 \u6837\u4f8b package main import ( flag fmt net/url ) type URLValue struct { URL *url.URL } func (v URLValue) String() string { if v.URL != nil { return v.URL.String() } return } func (v URLValue) Set(s string) error { if u, err := url.Parse(s); err != nil { return err } else { *v.URL = *u } return nil } var u = url.URL{} func main() { fs := flag.NewFlagSet( ExampleValue , flag.ExitOnError) fs.Var( URLValue{u}, url , URL to parse ) fs.Parse([]string{ -url , https://golang.org/pkg/flag/ }) fmt.Printf(`{scheme: %q, host: %q, path: %q}`, u.Scheme, u.Host, u.Path) }","title":"package flag"},{"location":"Language/Library/flag/#package-flag","text":"import flag flag\u5305\u5b9e\u73b0\u4e86\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u89e3\u6790\u3002","title":"package flag"},{"location":"Language/Library/flag/#_1","text":"\u4f7f\u7528 flag.String() , Bool() , Int() \u7b49\u6765\u5b9a\u4e49\u547d\u4ee4\u884c\u6807\u8bc6\u3002","title":"\u4f7f\u7528\u65b9\u5f0f"},{"location":"Language/Library/flag/#_2","text":"\u5b9a\u4e49\u4e00\u4e2a\u6574\u6570\u6807\u8bc6 -flagname \uff0c\u5e76\u5c06\u503c\u4fdd\u5b58\u5728 *int \u7c7b\u578b\u7684\u6307\u9488 ip \u4e2d\uff0c\u5176\u4e2d 1234 \u4e3a\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\uff0c \u201dhelp message for flagname\u201c \u662f\u8be5\u6807\u8bc6\u7684\u5e2e\u52a9\u4fe1\u606f\uff1a var ip = flag.Int( flagname , 1234, help message for flagname )","title":"\u65b9\u5f0f\u4e00"},{"location":"Language/Library/flag/#_3","text":"\u4f7f\u7528 Var() \u51fd\u6570\u5c06\u8be5\u6807\u8bc6\u7ed1\u5b9a\u5230\u4e00\u4e2a \u53d8\u91cf \u4e0a\uff0c\u5982\u4e0b\u6240\u793a\uff1a var flagvar int // \u5b9a\u4e49\u6807\u8bc6\u8981\u7ed1\u5b9a\u7684\u53d8\u91cf func init() { flag.IntVar( flagvar, flagname , 1234, help message for flagname ) }","title":"\u65b9\u5f0f\u4e8c"},{"location":"Language/Library/flag/#_4","text":"\u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684\u6807\u8bc6\uff08\u4f7f\u7528\u6307\u9488\u63a5\u6536\u5668\uff09\uff0c\u53ea\u8981\u8be5\u6807\u8bc6\u6ee1\u8db3Value\u63a5\u53e3\uff0c\u7136\u540e\u5c06\u5b83\u7ed1\u5b9a\u5230\u6807\u8bc6\u89e3\u6790\u5668\uff0c\u5982\u679c\u4f7f\u7528\u8fd9\u6837\u7684\u53d8\u91cf\u6765\u81ea\u5b9a\u4e49\u6807\u8bc6\uff0c\u90a3\u4e48\u9ed8\u8ba4\u503c\u5c31\u662f \u53d8\u91cf\u7684\u521d\u59cb\u503c \u3002 flag.Var( flagVal, name , help message for flagname ) \u5728\u6240\u6709\u7684\u6807\u8bc6\u90fd\u5b9a\u4e49\u5b8c\u6210\u4e4b\u540e\uff0c\u6267\u884c\u4e0b\u9762\u7684\u8c03\u7528,\u5c06\u547d\u4ee4\u884c\u89e3\u6790\u5230\u5b9a\u4e49\u7684\u6807\u8bc6\u4e2d\uff1a flag.Parse() \u7136\u540e\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u8fd9\u4e9b\u6807\u8bc6\uff1a \u5982\u679c\u76f4\u63a5\u4f7f\u7528\u6807\u8bc6\u672c\u8eab\uff0c\u90a3\u4e48\u5b83\u4eec\u90fd\u662f \u6307\u9488 \u5982\u679c\u5c06\u6807\u8bc6\u7ed1\u5b9a\u5230\u53d8\u91cf\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u662f \u503c fmt.Println( ip has value , *ip) fmt.Println( flagvar has value , flagvar) \u89e3\u6790\u540e\uff0c\u6240\u6709\u6807\u8bc6\u5bf9\u5e94\u7684\u53c2\u6570\u53ef\u7528\u5207\u7247 flag.Args() \u6216\u7528 flag.Arg(i) \u4e00\u4e2a\u4e2a\u72ec\u7acb\u7684\u83b7\u53d6\u5230\u3002\u53c2\u6570\u4ece0\u5f00\u59cb\u901a\u8fc7 flag.NArg()-1 \u7d22\u5f15\u3002","title":"\u65b9\u5f0f\u4e09"},{"location":"Language/Library/flag/#_5","text":"\u4ee5\u4e0b\u5f62\u5f0f\u7684\u547d\u4ee4\u884c\u53c2\u6570\u662f\u5141\u8bb8\u7684\uff1a -flag -flag=x -flag x // \u4ec5\u9650\u975e\u5e03\u5c14\u6807\u8bc6 \u4f7f\u7528 - \u6216\u8005 -- \u90fd\u662f\u53ef\u4ee5\uff0c\u5b83\u4eec\u662f\u7b49\u4ef7\u7684\u3002\u7531\u4e8e\u547d\u4ee4\u53ef\u80fd\u5305\u542b\u7684\u542b\u4e49\uff0c\u5e03\u5c14\u578b\u7684\u6807\u8bc6\u4e0d\u5141\u8bb8\u4f7f\u7528\u7b2c\u4e09\u79cd\u5f62\u5f0f\u3002 cmd -x * \u5176\u4e2d * \u662fUnix shell\u7684\u901a\u914d\u7b26\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u6587\u4ef6\u7684\u540d\u5b57\u662f 0 \u3001 false \u7b49\u7b49\u65f6\uff0c\u4f1a\u4f7f\u547d\u4ee4\u4ea7\u751f\u6b67\u4e49\uff0c\u56e0\u6b64\u5fc5\u987b\u4f7f\u7528 -flag=false \u6765\u5173\u95ed\u4e00\u4e2a\u5e03\u5c14\u578b\u7684\u6807\u8bc6\u3002 \u505c\u6b62\u89e3\u6790\u6807\u8bc6\u7684\u4f4d\u7f6e\uff1a \u7b2c\u4e00\u4e2a\u975e\u6807\u8bc6\u53c2\u6570\u524d\uff08 - \u662f\u4e00\u4e2a\u975e\u6807\u8bc6\u53c2\u6570\uff09 \u5728\u7ec8\u6b62\u7b26 -- \u540e \u6574\u578b\u6807\u8bc6\u63a5\u6536 1234 \u3001 0666 \u3001 0x1234 \u6216\u8005\u53ef\u80fd\u662f\u8d1f\u6574\u6570\u3002 \u5e03\u5c14\u578b\u7684\u6807\u8bc6\u53ef\u4ee5\u5982\u4e0b\uff1a 1, t, T, true, TRUE\uff0c True 0, f, F, false, FALSE, False \u6301\u7eed\u65f6\u95f4( Duration )\u6807\u8bc6\u63a5\u53d7\u4efb\u4f55 time.ParseDuration \u7684\u6709\u6548\u8f93\u5165\u3002 \u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\u7531\u9876\u7ea7\u51fd\u6570\u63a7\u5236\u3002 FlagSet \u7c7b\u578b\u5141\u8bb8\u5b9a\u4e49\u72ec\u7acb\u7684\u6807\u8bc6\u96c6\uff0c\u4f8b\u5982\u5728\u547d\u4ee4\u884c\u754c\u9762\u4e2d\u5b9e\u73b0\u5b50\u547d\u4ee4\u3002 FlagSet \u7684\u65b9\u6cd5\u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\u7684\u9876\u7ea7\u51fd\u6570\u3002","title":"\u547d\u4ee4\u884c\u6807\u8bc6\u8bed\u6cd5"},{"location":"Language/Library/flag/#_6","text":"// \u8fd9\u4e9b\u793a\u4f8b\u6f14\u793a\u4e86flag\u5305\u7684\u66f4\u590d\u6742\u7528\u6cd5 package main import ( errors flag fmt strings time ) // \u793a\u4f8b1\uff1a\u540d\u4e3a\u201cspecies\u201d\u7684\u5355\u5b57\u7b26\u4e32\u6807\u8bc6\uff0c\u9ed8\u8ba4\u503c\u4e3a\u201cgopher\u201d\u3002 var species = flag.String( species , gopher , the species we are studying ) //\u793a\u4f8b2\uff1a\u5171\u4eab\u53d8\u91cf\u7684\u4e24\u4e2a\u6807\u8bc6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u7b80\u5199\u3002 //\u521d\u59cb\u5316\u987a\u5e8f\u672a\u5b9a\u4e49\uff0c\u56e0\u6b64\u8bf7\u786e\u4fdd\u4e24\u8005\u90fd\u4f7f\u7528\u76f8\u540c\u7684\u9ed8\u8ba4\u503c\u3002\u5fc5\u987b\u4f7f\u7528init\u51fd\u6570\u8bbe\u7f6e\u5b83\u4eec\u3002 var gopherType string func init() { const ( defaultGopher = pocket usage = the variety of gopher ) flag.StringVar( gopherType, gopher_type , defaultGopher, usage) flag.StringVar( gopherType, g , defaultGopher, usage+ (shorthand) ) } // \u793a\u4f8b3:\u7528\u6237\u81ea\u5b9a\u4e49\u7684\u6807\u8bc6\u7c7b\u578b,\u662f\u4e00\u4e2a\u6301\u7eed\u65f6\u95f4\u7684\u5207\u7247 type interval []time.Duration // String\u65b9\u6cd5\u7528\u4e8e\u683c\u5f0f\u6237\u6807\u8bc6\u7684\u503c,\u662fflag.Value\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002 // String\u65b9\u6cd5\u7684\u8f93\u51fa\u5c06\u7528\u4e8e\u8bca\u65ad\u3002 func (i *interval) String() string { return fmt.Sprint(*i) } // Set\u65b9\u6cd5\u7528\u4e8e\u8bbe\u7f6e\u6807\u8bc6\u7684\u503c\uff0c\u4e5f\u662fflag.Value\u63a5\u53e3\u7684\u4e00\u90e8\u5206\u3002 // Set\u65b9\u6cd5\u7684\u53c2\u6570\u662fstring\u7c7b\u578b\u7684\u88ab\u89e3\u6790\u540e\u7528\u4e8e\u8bbe\u7f6e\u8be5\u6807\u8bc6\u3002 // \u8fd9\u662f\u4e00\u4e2a\u9017\u53f7\u5206\u9694\u7684\u5217\u8868\uff0c\u6240\u4ee5\u6211\u4eec\u62c6\u5206\u5b83\u3002 func (i *interval) Set(value string) error { // \u5982\u679c\u6211\u4eec\u5141\u8bb8\u591a\u6b21\u8bbe\u7f6e\u6807\u8bc6\u6765\u7d2f\u79ef\u503c\uff0c\u5c31\u9700\u8981\u5c06\u4e0b\u9762\u7684if\u8bed\u53e5\u5220\u9664\u3002 // \u8fd9\u5c06\u8fd0\u884c\u8bf8\u5982\u6b64\u7c7b\u7684\u7528\u6cd5\uff1a -deltaT 10s -deltaT 15s \u548c\u5176\u4ed6\u7684\u7ec4\u5408\u3002 if len(*i) 0 { return errors.New( interval flag already set ) } for _, dt := range strings.Split(value, , ) { duration, err := time.ParseDuration(dt) if err != nil { return err } *i = append(*i, duration) } return nil } // \u5b9a\u4e49\u4e00\u4e2a\u6807\u8bc6\u6765\u7d2f\u79ef\u6301\u7eed\u65f6\u95f4\u3002\u56e0\u4e3a\u5b83\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u7c7b\u578b\uff0c // \u6211\u4eec\u9700\u8981\u4f7f\u7528Var\u51fd\u6570\uff0c\u5e76\u5728init\u671f\u95f4\u521b\u5efa\u8be5\u6807\u8bc6\u3002 var intervalFlag interval func init() { // \u5c06\u547d\u4ee4\u884c\u6807\u8bc6\u7ed1\u5b9a\u5230intervalFlag\u53d8\u91cf\u5e76\u8bbe\u7f6e\u4f7f\u7528\u65b9\u5f0f\u6d88\u606f\u3002 flag.Var( intervalFlag, deltaT , comma-separated list of intervals to use between events ) } func main() { // \u6709\u8da3\u7684\u662f\u4f7f\u7528\u4e0a\u9762\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u4e3a\u4e86\u4f7fflag\u5305\u80fd\u591f\u770b\u5230\u4e0a\u9762\u5b9a\u4e49\u7684\u6807\u8bc6\uff0c\u5fc5\u987b\u6267\u884c\uff0c\u901a\u5e38\u5728main\uff08\u800c\u4e0d\u662finit\uff09\u7684\u5f00\u5934\u6267\u884c\uff1a flag.Parse() // \u6211\u4eec\u4e0d\u5728\u8fd9\u91cc\u8fd0\u884c\u5b83\uff0c\u56e0\u4e3a\u8fd9\u4e0d\u662fmain\u51fd\u6570\uff0c\u5e76\u4e14\u6d4b\u8bd5\u5957\u4ef6\u5df2\u7ecf\u89e3\u6790\u4e86\u6807\u8bc6\u3002 }","title":"\u793a\u4f8b"},{"location":"Language/Library/flag/#_7","text":"var CommandLine = NewFlagSet(os.Args[0], ExitOnError) CommandLine\u662f\u9ed8\u8ba4\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u96c6\uff0c\u4ece os.Args \u89e3\u6790\u3002\u9876\u7ea7\u51fd\u6570\uff08\u5982BoolVar\uff0cArg\u7b49\uff09\u662fCommandLine\u65b9\u6cd5\u7684\u5305\u88c5\u5668\u3002 var ErrHelp = errors.New( flag: help requested ) ErrHelp\u662f\u5728\u8c03\u7528 -help \u6216 -h \u6807\u8bc6\u4f46\u672a\u5b9a\u4e49\u6b64\u7c7b\u6807\u8bc6\u65f6\u8fd4\u56de\u7684\u9519\u8bef\u3002 var Usage = func() { fmt.Fprintf(CommandLine.Output(), Usage of %s:\\n , os.Args[0]) PrintDefaults() } Usage \u6253\u5370\u4e00\u6761\u7528\u6cd5\u6d88\u606f\uff0c\u8be5\u6d88\u606f\u4e2d\u8bb0\u5f55\u6240\u6709\u5df2\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u5e76\u8f93\u51fa\u5230 CommandLine.output() \uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u8f93\u51fa\u5230 os.Stderr \u3002\u53ea\u6709\u5f53\u89e3\u6790\u6807\u8bc6\u53d1\u751f\u9519\u8bef\u65f6\u624d\u8c03\u7528 Usage \uff0c \u89c1\u7c7b\u578b\u90e8\u5206\u4e2dFlag\u7ed3\u6784\u4f53 \u3002 Usage \u53d8\u91cf\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u66f4\u6539\u4e3a\u6307\u5411\u5176\u4ed6\u7684\u81ea\u5b9a\u4e49\u51fd\u6570\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5b83\u4f1a\u6253\u5370\u4e00\u4e2a\u7b80\u5355\u7684\u6807\u9898\u5e76\u8c03\u7528 PrintDefaults \uff1b\u6709\u5173\u8f93\u51fa\u683c\u5f0f\u53ca\u5176\u63a7\u5236\u65b9\u6cd5\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 PrintDefaults \u7684\u6587\u6863\u6216\u8005\u67e5\u770b\u4e0b\u9762\u7684\u51fd\u6570\u8bf4\u660e\u3002 \u81ea\u5b9a\u4e49\u7684 Usage \u51fd\u6570\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u9000\u51fa\uff1b\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e5f\u662f\u8fd9\u6837\uff0c\u56e0\u4e3a\u547d\u4ee4\u884c\u7684\u9519\u8bef\u5904\u7406\u7b56\u7565\u8bbe\u7f6e\u4e3a ExitOnError \u3002","title":"\u53d8\u91cf"},{"location":"Language/Library/flag/#_8","text":"func Arg\uff08i int\uff09 string Arg\u8fd4\u56de\u7b2ci\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002 Arg(0) \u662f\u5904\u7406\u5b8c\u6807\u8bc6\u540e\u7684\u7b2c\u4e00\u4e2a\u5269\u4f59\u53c2\u6570\u3002\u5982\u679c\u8bf7\u6c42\u7684\u5143\u7d20\u4e0d\u5b58\u5728\uff0cArg\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u3002 func Args() []string Args\u8fd4\u56de\u975e\u6807\u8bc6\u547d\u4ee4\u884c\u53c2\u6570\u3002 // Bool\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684bool\u53d8\u91cf\u7684\u5730\u5740\uff08\u6307\u9488\uff09 func Bool(name string, value bool, usage string) *bool{ } // BoolVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2abool\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func BoolVar(p *bool, name string, value bool, usage string){ } // Duration\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684time.Duration\u53d8\u91cf\u7684\u5730\u5740\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func Duration(name string, value time.Duration, usage string) *time.Duration{ } // DurationVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411time.Duration\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func DurationVar(p *time.Duration, name string, value time.Duration, usage string){ } // Float64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684float64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Float64(name string, value float64, usage string) *float64{ } // Float64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2afloat64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Float64Var(p *float64, name string, value float64, usage string){ } // Int\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int\u53d8\u91cf\u7684\u5730\u5740\u3002 func Int(name string, value int, usage string) *int{ } // IntVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func IntVar(p *int, name string, value int, usage string){ } // Int64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Int64(name string, value int64, usage string) *int64{ } // Int64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Int64Var(p *int64, name string, value int64, usage string){ } // NArg\u8fd4\u56de\u7684\u662f\u5904\u7406\u6807\u8bc6\u540e\u5269\u4f59\u7684\u53c2\u6570\u4e2a\u6570\u3002 func NArg() int{ } // NFlag\u8fd4\u56de\u5df2\u8bbe\u7f6e\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u6570\u91cf\u3002 func NFlag() int{ } // Parse\u4eceos.Args[1:]\u4e2d\u89e3\u6790\u547d\u4ee4\u884c\u6807\u8bc6\u3002\u5fc5\u987b\u5728\u5b9a\u4e49\u6240\u6709\u6807\u8bc6\u4e4b\u540e\u5e76\u4e14\u5728\u7a0b\u5e8f\u8bbf\u95ee\u6807\u8bc6\u4e4b\u524d\u8c03\u7528\u3002 func Parse(){ } // Parsed\u62a5\u544a\u662f\u5426\u5df2\u89e3\u6790\u547d\u4ee4\u884c\u6807\u8bc6\u3002 func Parsed() bool{ } // \u9664\u975e\u53e6\u5916\u914d\u7f6e\u4e86\u8f93\u51fa\u4f4d\u7f6e\uff0c\u5426\u5219PrintDefaults\u4f1a\u5c06\u5185\u5bb9\u6253\u5370\u5728\u6807\u51c6\u9519\u8bef\u4e2d\u3002\u8f93\u51fa\u7684\u5185\u5bb9\u4e3a\u4e00\u4e2a\u5305\u542b\u6240\u6709\u5df2\u7ecf\u5b9a\u4e49\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u9ed8\u8ba4\u8bbe\u7f6e\u7684\u7528\u6cd5\u6d88\u606f\u3002 func PrintDefaults() // \u5bf9\u4e8e\u6574\u6570\u503c\u6807\u8bc6x\uff0c\u9ed8\u8ba4\u8f93\u51fa\u5982\u4e0b\u6240\u793a\uff1a -x int usage-message-for-x (default 7) \u9664\u4e86\u5e26\u6709\u5355\u5b57\u8282\u540d\u79f0\u7684bool\u6807\u8bc6\u5916\uff0c\u7528\u6cd5\u6d88\u606f\u5c06\u53e6\u8d77\u4e00\u884c\u663e\u793a\u3002\u5bf9\u4e8ebool\u6807\u8bc6\uff0c\u7701\u7565\u7c7b\u578b\uff0c\u5982\u679c\u6807\u8bc6\u540d\u79f0\u662f\u4e00\u4e2a\u5b57\u8282\uff0c\u5219\u7528\u6cd5\u6d88\u606f\u5c06\u663e\u793a\u5728\u540c\u4e00\u884c\u3002 \u5982\u679c\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\u4e3a\u96f6\u503c\uff0c\u5219\u4f1a\u7701\u7565\u7528\u6cd5\u6d88\u606f\u540e\u9762\u62ec\u53f7\u4e2d\u7684\u5185\u5bb9\u3002\u5728\u5b9a\u4e49\u6807\u8bc6\u65f6\uff0c\u53ef\u4ee5\u7528\u53cd\u5f15\u53f7\u5c06\u6807\u8bc6\u7684\u7528\u6cd5\u5b57\u7b26\u4e32\u4e2d\u7684\u67d0\u4e2a\u540d\u79f0\u5f15\u8d77\u6765\uff0c\u90a3\u4e48\uff0c\u7528\u6cd5\u6d88\u606f\u4e2d\u7684\u7b2c\u4e00\u4e2a\u88ab\u53cd\u5f15\u53f7\u5f15\u8d77\u6765\u7684\u5185\u5bb9\u5c06\u88ab\u89c6\u4e3a\u8981\u5728\u6d88\u606f\u4e2d\u663e\u793a\u7684\u9ed8\u8ba4\u503c\uff0c\u5e76\u4e14\u5728\u663e\u793a\u65f6\u5c06\u4ece\u6d88\u606f\u4e2d\u5220\u9664\u53cd\u5f15\u53f7\u3002 \u5982\u4e0b\u6240\u793a\uff1a flag.String( I , , search `directory` for include files ) // \u7528\u6cd5\u6d88\u606f\u8f93\u51fa\u5982\u4e0b -I directory search directory for include files. \u8981\u66f4\u6539\u6807\u8bc6\u7684\u7528\u6cd5\u6d88\u606f\u7684\u8f93\u51fa\u4f4d\u7f6e\uff0c\u8bf7\u8c03\u7528 CommandLine.SetOutput() \u3002 func Set(name, value string) error{ } Set\u8bbe\u7f6e\u5df2\u7ecf\u88ab\u547d\u540d\u7684\u547d\u4ee4\u884c\u6807\u8bc6\u7684\u503c\u3002 // String\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5730\u5740\u3002 func String(name string, value string, usage string) *string{ } // StringVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func StringVar(p *string, name string, value string, usage string){ } // Uint\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint\u53d8\u91cf\u7684\u5730\u5740\u3002 func Uint(name string, value uint, usage string) *uint{ } // UintVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func UintVar(p *uint, name string, value uint, usage string){ } // Uint64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint64\u53d8\u91cf\u7684\u5730\u5740\u3002 func Uint64(name string, value uint64, usage string) *uint64{ } // Uint64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func Uint64Var(p *uint64, name string, value uint64, usage string){ } // UnquoteUsage\u4ece\u6807\u8bc6\u7684\u7528\u6cd5\u5b57\u7b26\u4e32\u4e2d\u63d0\u53d6\u88ab\u53cd\u5f15\u53f7\u5f15\u8d77\u6765\u7684\u540d\u79f0\u5e76\u8fd4\u56de\u5b83,\u540c\u65f6\u8fd4\u56de\u53bb\u6389\u53cd\u5f15\u53f7\u540e\u7684\u7528\u6cd5\u6d88\u606f\u3002 func UnquoteUsage(flag *Flag) (name string, usage string){ } // \u7ed9\u5b9a\u5982\u4e0b\u7528\u6cd5\u6d88\u606f a `name` to show // UnquoteUsage\u8f93\u51fa\u7684\u5185\u5bb9\u5982\u4e0b ( name , a name to show ) // \u5982\u679c\u6ca1\u6709\u53cd\u5f15\u53f7\uff0c\u5219\u8be5\u540d\u79f0\u662f\u5bf9\u6807\u8bc6\u503c\u7c7b\u578b\u7684\u6709\u6839\u636e\u7684\u731c\u6d4b\uff0c\u5982\u679c\u8be5\u6807\u8bc6\u662f\u5e03\u5c14\u503c\uff0c\u5219\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002 func Var(value Value, name string, usage string) Var\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u6807\u8bc6\u3002 \u6807\u8bc6\u7684\u7c7b\u578b\u548c\u503c\u7531\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\uff0c\u7c7b\u578b\u4e3aValue\uff0c\u5b83\u901a\u5e38\u5305\u542b \u7528\u6237\u5b9a\u4e49\u7684Value\u5b9e\u73b0 \u3002 \u4f8b\u5982\uff0c\u8c03\u7528\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6807\u8bc6\uff0c\u901a\u8fc7\u4e3a\u5207\u7247\u63d0\u4f9bValue\u65b9\u6cd5\uff0c\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5207\u7247; \u5c24\u5176\u662f\uff0cSet\u4f1a\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u5206\u89e3\u4e3a\u5207\u7247\u3002 // Visit\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u547d\u4ee4\u884c\u6807\u8bc6\uff0c\u5b83\u53ea\u8bbf\u95ee\u5df2\u8bbe\u7f6e\u7684\u90a3\u4e9b\u6807\u8bc6\u3002 func Visit(fn func(*Flag)){ } // VisitAll\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u547d\u4ee4\u884c\u6807\u8bc6\uff0c\u5b83\u8bbf\u95ee\u6240\u6709\u6807\u8bc6\uff0c\u751a\u81f3\u90a3\u4e9b\u672a\u8bbe\u7f6e\u7684\u6807\u8bc6\u3002 func VisitAll(fn func(*Flag)){ }","title":"\u51fd\u6570"},{"location":"Language/Library/flag/#_9","text":"// ErrorHandling\u5b9a\u4e49\u4e86\u5982\u679c\u89e3\u6790\u5931\u8d25\uff0cFlagSet.Parse\u7684\u884c\u4e3a\u65b9\u5f0f\u3002 type ErrorHandling int // \u5982\u679c\u89e3\u6790\u5931\u8d25\uff0c\u8fd9\u4e9b\u5e38\u91cf\u53cd\u5e94\u4e86FlagSet.Parse\u7684\u884c\u4e3a\u3002 const ( ContinueOnError ErrorHandling = iota // \u8fd4\u56de\u63cf\u8ff0\u6027\u9519\u8bef ExitOnError // \u8c03\u7528os.Exit(2). PanicOnError // \u8c03\u7528\u8fd0\u884c\u65f6\u6050\u614c\u5e76\u8fd4\u56de\u63cf\u8ff0\u6027\u9519\u8bef ) // Flag\u8868\u793a\u6807\u8bc6\u7684\u72b6\u6001\u3002 type Flag struct { Name string // \u547d\u4ee4\u884c\u4e0a\u663e\u793a\u7684\u540d\u79f0 Usage string // \u5e2e\u52a9\u4fe1\u606f/\u7528\u6cd5\u4fe1\u606f Value Value // \u8bbe\u5b9a\u7684\u503c DefValue string // \u7528\u6cd5\u4fe1\u606f\u7684\u9ed8\u8ba4\u503c\uff08\u6587\u672c\u5f62\u5f0f\uff09 } // Lookup\u8fd4\u56de\u6307\u5b9a\u547d\u4ee4\u884c\u6807\u8bc6\u7684Flag\u7ed3\u6784\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denil\u3002 func Lookup(name string) *Flag // FlagSet\u8868\u793a\u4e00\u7ec4\u5b9a\u4e49\u7684\u6807\u8bc6\u3002FlagSet\u7684\u96f6\u503c\u6ca1\u6709\u540d\u79f0\uff0c\u5e76\u4e14\u5177\u6709ContinueOnError\u9519\u8bef\u5904\u7406\u3002 type FlagSet struct { // Usage\u662f\u5728\u89e3\u6790\u6807\u8bc6\u53d1\u751f\u9519\u8bef\u65f6\u8c03\u7528\u7684\u51fd\u6570\u3002\u8be5\u5b57\u6bb5\u662f\u4e00\u4e2a\u51fd\u6570\uff08\u4e0d\u662f\u65b9\u6cd5\uff09\uff0c // \u53ef\u4ee5\u66f4\u6539\u4e3a\u6307\u5411\u81ea\u5b9a\u4e49\u9519\u8bef\u5904\u7406\u7a0b\u5e8f\u3002\u8c03\u7528Usage\u540e\u4f1a\u53d1\u751f\u4ec0\u4e48\u53d6\u51b3\u4e8eErrorHandling\u7684\u8bbe\u7f6e; // \u5bf9\u4e8e\u547d\u4ee4\u884c\uff0c\u9ed8\u8ba4\u662fExitOnError\uff0c\u5b83\u5c06\u5728\u8c03\u7528Usage\u540e\u9000\u51fa\u7a0b\u5e8f\u3002 Usage func(){} // \u4e3a\u4e86\u663e\u793a\u6b63\u5e38\uff0c\u6b64\u5904\u6ca1\u6709\u5927\u62ec\u53f7 // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } // NewFlagSet\u8fd4\u56de\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\u548c\u9519\u8bef\u5904\u7406\u5c5e\u6027\u7684\u65b0\u7684\u7a7a\u6807\u8bc6\u96c6\u3002\u5982\u679c\u540d\u79f0\u4e0d\u4e3a\u7a7a\uff0c\u5219\u5c06\u5728\u9ed8\u8ba4\u7528\u6cd5\u6d88\u606f\u548c\u9519\u8bef\u6d88\u606f\u4e2d\u6253\u5370\u3002 func NewFlagSet(name string, errorHandling ErrorHandling) *FlagSet{ } // Arg\u8fd4\u56de\u7b2ci\u4e2a\u53c2\u6570\u3002Arg(0)\u662f\u5904\u7406\u5b8c\u6807\u8bc6\u540e\u5269\u4f59\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002\u5982\u679c\u8bf7\u6c42\u7684\u5143\u7d20\u4e0d\u5b58\u5728\uff0cArg\u5c06\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\u3002 func (f *FlagSet) Arg(i int) string{ } // Args\u8fd4\u56de\u975e\u6807\u8bc6\u7684\u53c2\u6570\u3002 func (f *FlagSet) Args() []string{ } // Bool\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684bool\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Bool(name string, value bool, usage string) *bool{ } // BoolVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684bool\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2abool\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) BoolVar(p *bool, name string, value bool, usage string){ } // Duration\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684time.Duration\u53d8\u91cf\u7684\u5730\u5740\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func (f *FlagSet) Duration(name string, value time.Duration, usage string) *time.Duration{ } // DurationVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684time.Duration\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411time.Duration\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002\u8be5\u6807\u8bc6\u63a5\u53d7time.ParseDuration\u53ef\u63a5\u53d7\u7684\u503c\u3002 func (f *FlagSet) DurationVar(p *time.Duration, name string, value time.Duration, usage string){ } // ErrorHandling\u8fd4\u56de\u6807\u8bc6\u96c6\u7684\u9519\u8bef\u5904\u7406\u884c\u4e3a\u3002 func (f *FlagSet) ErrorHandling() ErrorHandling // Float64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684float64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Float64(name string, value float64, usage string) *float64{ } // Float64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684float64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2afloat64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Float64Var(p *float64, name string, value float64, usage string){ } // Init\u4e3a\u6807\u8bc6\u96c6\u8bbe\u7f6e\u540d\u79f0\u548c\u9519\u8bef\u5904\u7406\u5c5e\u6027\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u4e3a\u96f6\u503c\u7684FlagSet\u4f7f\u7528\u7a7a\u540d\u79f0\u548cContinueOnError\u9519\u8bef\u5904\u7406\u7b56\u7565\u3002 func (f *FlagSet) Init(name string, errorHandling ErrorHandling){ } // Int\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Int(name string, value int, usage string) *int{ } // Int64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684int64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Int64(name string, value int64, usage string) *int64{ } // Int64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Int64Var(p *int64, name string, value int64, usage string){ } // IntVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684int\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2aint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) IntVar(p *int, name string, value int, usage string){ } // Lookup\u8fd4\u56de\u6307\u5b9a\u6807\u8bc6\u7684Flag\u7ed3\u6784\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u8fd4\u56denil\u3002 func (f *FlagSet) Lookup(name string) *Flag{ } // NArg\u662f\u5904\u7406\u6807\u8bc6\u540e\u5269\u4f59\u7684\u53c2\u6570\u4e2a\u6570\u3002 func (f *FlagSet) NArg() int{ } // NFlag\u8fd4\u56de\u5df2\u8bbe\u7f6e\u7684\u6807\u8bc6\u6570\u3002 func (f *FlagSet) NFlag() int{ } // Name\u8fd4\u56de\u6807\u8bc6\u96c6\u7684\u540d\u79f0\u3002 func (f *FlagSet) Name() string{ } // Output\u8fd4\u56de\u7528\u6cd5\u6d88\u548c\u9519\u8bef\u6d88\u606f\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002\u5982\u679c\u672a\u8bbe\u7f6eoutput\u6216\u8bbe\u7f6e\u4e3anil\uff0c\u5219\u8fd4\u56deos.Stderr\u3002 func (f *FlagSet) Output() io.Writer{ } // Parse\u4ece\u53c2\u6570\u5217\u8868\u4e2d\u89e3\u6790\u6807\u8bc6\u5b9a\u4e49\uff0c\u8be5\u5217\u8868\u4e0d\u5305\u542b\u547d\u4ee4\u7684\u540d\u79f0\u3002\u5fc5\u987b\u5728\u5b9a\u4e49FlagSet\u4e2d\u7684\u6240\u6709\u6807\u8bc6\u4e4b\u540e\u5e76\u4e14\u5728\u7a0b\u5e8f\u8bbf\u95ee\u6807\u8bc6\u4e4b\u524d\u8c03\u7528\u3002\u5982\u679c\u672a\u5b9a\u4e49-help\u6216-h\uff0c\u5219\u8fd4\u56de\u503c\u4e3aErrHelp\u3002 func (f *FlagSet) Parse(arguments []string) error{ } // Parsed\u62a5\u544a\u662f\u5426\u5df2\u8c03\u7528f.Parse\u3002 func (f *FlagSet) Parsed() bool{ } // \u9664\u975e\u53e6\u5916\u914d\u7f6e\uff0c\u5426\u5219PrintDefaults\u4f1a\u628a\u6574\u4e2a\u6807\u8bc6\u96c6\u4e2d\u5b9a\u4e49\u7684\u6807\u8bc6\u7684\u9ed8\u8ba4\u503c\u8f93\u51fa\u5230\u6807\u51c6\u9519\u8bef\u4e2d\uff0c\u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605\u4e0a\u9762\u7684\u5168\u5c40\u51fd\u6570PrintDefaults\u7684\u6587\u6863\u3002 func (f *FlagSet) PrintDefaults(){ } // Set\u8bbe\u7f6e\u6307\u5b9a\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Set(name, value string) error{ } // SetOutput\u8bbe\u7f6e\u7528\u6cd5\u6d88\u606f\u548c\u9519\u8bef\u6d88\u606f\u7684\u76ee\u7684\u5730\u3002\u5982\u679coutput\u8bbe\u7f6e\u4e3anil\uff0c\u5219\u4f7f\u7528os.Stderr\u3002 func (f *FlagSet) SetOutput(output io.Writer){ } // String\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) String(name string, value string, usage string) *string{ } // StringVar\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u5b57\u7b26\u4e32\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2a\u5b57\u7b26\u4e32\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) StringVar(p *string, name string, value string, usage string){ } // Uint\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Uint(name string, value uint, usage string) *uint{ } // Uint64\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u8fd4\u56de\u503c\u662f\u5b58\u50a8\u6807\u8bc6\u503c\u7684uint64\u53d8\u91cf\u7684\u5730\u5740\u3002 func (f *FlagSet) Uint64(name string, value uint64, usage string) *uint64{ } // Uint64Var\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint64\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint64\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u8be5\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) Uint64Var(p *uint64, name string, value uint64, usage string){ } // UintVar\u5b9a\u4e49\u4e86\u4e00\u4e2a\u5e26\u6709\u6307\u5b9a\u540d\u79f0\uff0c\u9ed8\u8ba4\u503c\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684uint\u6807\u8bc6\u3002\u53c2\u6570p\u6307\u5411\u4e00\u4e2auint\u53d8\u91cf\uff0c\u7528\u4e8e\u5b58\u50a8\u6807\u8bc6\u7684\u503c\u3002 func (f *FlagSet) UintVar(p *uint, name string, value uint, usage string){ } // Var\u5b9a\u4e49\u5177\u6709\u6307\u5b9a\u540d\u79f0\u548c\u7528\u6cd5\u5b57\u7b26\u4e32\u7684\u6807\u8bc6\u3002\u6807\u8bc6\u7684\u7c7b\u578b\u548c\u503c\u7531\u7b2c\u4e00\u4e2a\u53c2\u6570\u8868\u793a\uff0c\u7c7b\u578b\u4e3aValue\uff0c\u5b83\u901a\u5e38\u5305\u542b\u7528\u6237\u5b9a\u4e49\u7684Value\u5b9e\u73b0\u3002\u4f8b\u5982\uff0c\u8c03\u7528\u8005\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u6807\u8bc6\uff0c\u901a\u8fc7\u4e3a\u5207\u7247\u63d0\u4f9bValue\u65b9\u6cd5\uff0c\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\u5207\u7247; \u5c24\u5176\u662f\uff0cSet\u4f1a\u5c06\u9017\u53f7\u5206\u9694\u7684\u5b57\u7b26\u4e32\u5206\u89e3\u4e3a\u5207\u7247\u3002 func (f *FlagSet) Var(value Value, name string, usage string) // Visit\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u6807\u8bc6\uff0c\u5b83\u53ea\u8bbf\u95ee\u5df2\u8bbe\u7f6e\u7684\u90a3\u4e9b\u6807\u8bc6\u3002 func (f *FlagSet) Visit(fn func(*Flag)) // VisitAll\u4e3a\u6bcf\u4e2afn\u8c03\u7528\u4ee5\u5b57\u5178\u987a\u5e8f\u8bbf\u95ee\u6807\u8bc6\uff0c\u5b83\u8bbf\u95ee\u6240\u6709\u6807\u8bc6\uff0c\u751a\u81f3\u90a3\u4e9b\u672a\u8bbe\u7f6e\u7684\u6807\u8bc6\u3002 func (f *FlagSet) VisitAll(fn func(*Flag)) type Getter interface { Value Get() interface{} } Getter\u662f\u4e00\u4e2a\u5141\u8bb8\u68c0\u7d22Value\u5185\u5bb9\u7684\u63a5\u53e3\u3002\u56e0\u4e3a\u5b83\u51fa\u73b0\u5728Go1\u53ca\u5176\u517c\u5bb9\u6027\u89c4\u5219\u4e4b\u540e\uff0c\u6240\u4ee5\u5b83\u7ec4\u5408\u4e86Value\u63a5\u53e3\uff0c\u800c\u4e0d\u662f\u6210\u4e3avalue\u63a5\u53e3\u7684\u4e00\u90e8\u5206\uff0c\u6b64flag\u5305\u63d0\u4f9b\u7684\u6240\u6709Value\u7c7b\u578b\u90fd\u6ee1\u8db3Getter\u63a5\u53e3\u3002 type Value interface { String() string Set(string) error } Value\u662f\u5b58\u50a8\u5728\u4e00\u4e2a\u6807\u8bc6\u4e2d\u7684\u52a8\u6001\u503c\u7684\u63a5\u53e3\uff0c\u5b83\u7684\u9ed8\u8ba4\u503c\u8868\u793a\u662f\u5b57\u7b26\u4e32\u3002 \u5982\u679c\u67d0\u4e2aValue\u63a5\u53e3\u7684 IsBoolFlag() \u65b9\u6cd5\u8fd4\u56detrue\uff0c\u5219\u547d\u4ee4\u884c\u89e3\u6790\u5668\u4f7f -name \u7b49\u6548\u4e8e -name=true \uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u4e0b\u4e00\u4e2a\u547d\u4ee4\u884c\u53c2\u6570\u3002 \u4e3a\u6bcf\u4e2a\u5b58\u5728\u7684\u6807\u8bc6\uff0c\u4ee5\u547d\u4ee4\u884c\u987a\u5e8f\u8c03\u7528\u4e14\u4ec5\u8c03\u7528\u4e00\u6b21Set\u3002flag\u5305\u4f1a\u4f7f\u7528\u96f6\u503c\u63a5\u6536\u5668\u8c03\u7528String\u65b9\u6cd5\uff0c\u4f8b\u5982nil\u6307\u9488\u3002","title":"\u7c7b\u578b"},{"location":"Language/Library/flag/#_10","text":"package main import ( flag fmt net/url ) type URLValue struct { URL *url.URL } func (v URLValue) String() string { if v.URL != nil { return v.URL.String() } return } func (v URLValue) Set(s string) error { if u, err := url.Parse(s); err != nil { return err } else { *v.URL = *u } return nil } var u = url.URL{} func main() { fs := flag.NewFlagSet( ExampleValue , flag.ExitOnError) fs.Var( URLValue{u}, url , URL to parse ) fs.Parse([]string{ -url , https://golang.org/pkg/flag/ }) fmt.Printf(`{scheme: %q, host: %q, path: %q}`, u.Scheme, u.Host, u.Path) }","title":"\u6837\u4f8b"},{"location":"Language/Library/log/","text":"packages log import log log\u5305\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u65e5\u5fd7\u5305\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u79cd\u7c7b\u578b Logger \uff0c\u5176\u4e2d\u5305\u542b\u683c\u5f0f\u5316\u8f93\u51fa\u7684\u65b9\u6cd5\u3002 \u5b83\u8fd8\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u201c\u6807\u51c6\u201dLogger\uff0c\u53ef\u4ee5\u901a\u8fc7\u8f85\u52a9\u51fd\u6570 Print[f|ln] \uff0c Fatal[f|ln] \u548c Panic[f|ln] \u8bbf\u95ee\uff0c\u4f7f\u7528\u8fd9\u4e9b\u8f85\u52a9\u51fd\u6570\u6bd4\u624b\u52a8\u521b\u5efaLogger\u66f4\u5bb9\u6613\u4f7f\u7528\u3002Logger\u5199\u5165\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5e76\u6253\u5370\u6bcf\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u7684\u65f6\u95f4\u548c\u65e5\u671f\u3002 \u6bcf\u6761\u65e5\u5fd7\u8bb0\u5f55\u90fd\u5728\u5355\u72ec\u7684\u884c\u4e2d\u8f93\u51fa\uff1a\u5982\u679c\u6b63\u5728\u6253\u5370\u7684\u6d88\u606f\u672a\u4ee5\u6362\u884c\u7b26\u7ed3\u5c3e\uff0c\u5219Logger\u5c06\u4f1a\u5728\u884c\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u6362\u884c\u7b26\u3002 Fatal\u51fd\u6570\u5728\u5199\u5165\u65e5\u5fd7\u6d88\u606f\u540e\u8c03\u7528 os.Exit(1) \u3002 Panic\u51fd\u6570\u5728\u5199\u5165\u65e5\u5fd7\u6d88\u606f\u540e\u8c03\u7528\u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09\u3002 \u5e38\u91cf const ( Ldate = 1 iota // \u5f53\u5730\u65f6\u533a\u7684\u65e5\u671f: 2009/01/23 Ltime // \u5f53\u5730\u65f6\u533a\u7684\u65f6\u95f4: 01:23:23 Lmicroseconds // \u5fae\u79d2\u7cbe\u5ea6: 01:23:23.123123. \u5047\u8bbe\u662fLtime Llongfile // \u5b8c\u6574\u7684\u6587\u4ef6\u540d\u548c\u884c\u53f7: /a/b/c/d.go:23 Lshortfile // \u6700\u7ec8\u6587\u4ef6\u540d\u5143\u7d20\u548c\u884c\u53f7: d.go:23. \u8986\u76d6Llongfile LUTC // \u5982\u679c\u8bbe\u7f6e\u4e86Ldate\u6216\u8005Ltime\uff0c\u90a3\u4e48\u4f7f\u7528UTC\u800c\u4e0d\u662f\u672c\u5730\u65f6\u533a LstdFlags = Ldate | Ltime // \u6807\u51c6Logger\u7684\u521d\u59cb\u503c ) \u8fd9\u4e9b\u6807\u5fd7\u5b9a\u4e49\u4e86Logger\u751f\u6210\u7684\u6bcf\u4e2a\u65e5\u5fd7\u6761\u76ee\u7684 \u524d\u7f00 \uff0c\uff08 | \uff09 \u6216\u8fd0\u7b97\u6765\u63a7\u5236\u54ea\u4e9b\u9700\u8981\u8f93\u51fa\u3002\u65e0\u6cd5\u63a7\u5236\u5b83\u4eec\u51fa\u73b0\u7684\u987a\u5e8f\uff08\u5982\uff0c\u6b64\u5904\u5217\u51fa\u7684\u987a\u5e8f\uff09\u6216\u5b83\u4eec\u5448\u73b0\u7684\u683c\u5f0f\uff08\u5982\uff0c\u6ce8\u91ca\u4e2d\u6240\u8ff0\uff09\u3002\u4ec5\u5f53\u6307\u5b9a Llongfile \u6216 Lshortfile \u65f6\uff0c\u524d\u7f00\u540e\u8ddf\u5192\u53f7\u3002\u67e5\u770b\u5982\u4e0b\u793a\u4f8b\uff1a // \u8bbe\u7f6eLdate | Ltime\uff08\u6216LstdFlags\uff09\u5219\u4ea7\u751f\u5982\u4e0b\u6548\u679c 2009/01/23 01:23:23 message // \u8bbe\u7f6eLdate | Ltime | Lmicroseconds | Llongfile \u5219\u4ea7\u751f\u5982\u4e0b\u6548\u679c 2009/01/23 01:23:23.123123 /a/b/c/d.go:23: message \u51fd\u6570Fatal func Fatal(v ...interface{}) Fatal() \u7b49\u6548\u4e8e Print() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u51fd\u6570Fatalf func Fatalf(format string, v ...interface{}) Fatal() \u7b49\u6548\u4e8e Printf() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u51fd\u6570Fatalln func Fatalln(v ...interface{}) Fatal() \u7b49\u6548\u4e8e Println() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u51fd\u6570Flags func Flags() int Flags() \u8fd4\u56de\u6807\u51c6 Logger \u7684\u8f93\u51fa\u6807\u5fd7\u3002 \u51fd\u6570Output func Output(calldepth int, s string) error Output() \u5c06\u8bb0\u5f55\u4e8b\u4ef6\u7684\u8f93\u51fa\u5199\u51fa\u6765\u3002 \u5b57\u7b26\u4e32 s \u5305\u542b\u8981\u5728 Logger \u7684 flags \u4e2d\u6307\u5b9a\u7684\u524d\u7f00\u4e4b\u540e\u6253\u5370\u7684\u6587\u672c\u5185\u5bb9\u3002\u5982\u679c s \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u6362\u884c\u7b26\uff0c\u5219\u4f1a\u9644\u52a0\u6362\u884c\u7b26\u3002 Calldepth \u662f\u8bbe\u7f6e\u4e86 Llongfile \u6216 Lshortfile \u540e\uff0c\u8ba1\u7b97\u6587\u4ef6\u540d\u548c\u884c\u53f7\u65f6\u8981\u8df3\u8fc7\u7684\u5e27\u6570; \u5982\u679c Calldepth \u7684\u503c\u4e3a1\u5c06\u6253\u5370 Output() \u8c03\u7528\u8005\u7684\u8be6\u7ec6\u4fe1\u606f\u3002 \u51fd\u6570Panic func Panic(v ...interface{}) Panic() \u7b49\u6548\u4e8e Print() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u51fd\u6570Panicf func Panicf(format string, v ...interface{}) Panic() \u7b49\u6548\u4e8e Printf() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u51fd\u6570Panicln func Panicln(v ...interface{}) Panic() \u7b49\u6548\u4e8e Println() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u51fd\u6570Prefix func Prefix() string Prefix() \u8fd4\u56de\u6807\u51c6 Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002 \u51fd\u6570Print func Print(v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Print() \u7684\u65b9\u5f0f\u5904\u7406\u3002 \u51fd\u6570Printf func Printf(format string, v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Printf() \u7684\u65b9\u5f0f\u5904\u7406\u3002 \u51fd\u6570Println func Println(v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Println() \u7684\u65b9\u5f0f\u5904\u7406\u3002 \u603b\u7ed3\u51e0\u4e2a\u65b9\u6cd5 \u51fd\u6570SetFlags func SetFlags(flag int) SetFlags() \u4e3a\u6807\u51c6 Logger \u8bbe\u7f6e\u8f93\u51fa\u6807\u8bc6\u3002 \u51fd\u6570SetOutput func SetOutput(w io.Writer) SetOutput() \u8bbe\u7f6e\u6807\u51c6 longer \u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002 \u51fd\u6570SetPrefix func SetPrefix(prefix string) SetPrefix() \u8bbe\u7f6e\u6807\u51c6 Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002 \u51fd\u6570New func New(out io.Writer, prefix string, flag int) *Logger New() \u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 Logger \u3002 out \u8bbe\u7f6e\u65e5\u5fd7\u6570\u636e\u7684\u76ee\u7684\u5730 prefix \u6bcf\u884c\u65e5\u5fd7\u8bb0\u5f55\u7684\u524d\u7f00 flag \u5b9a\u4e49\u65e5\u5fd7\u8bb0\u5f55\u64cd\u4f5c\u7684\u5c5e\u6027 \u7c7b\u578bLogger type Logger struct { // contains filtered or unexported fields } Logger\u8868\u793a\u4e00\u4e2a\u6d3b\u8dc3\u7684\u65e5\u5fd7\u8bb0\u5f55\u5bf9\u8c61\uff0c\u5b83\u5411 io.Writer \u751f\u6210\u8f93\u51fa\u3002\u6bcf\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u64cd\u4f5c\u53ea\u5bf9 Writer \u7684 Write() \u65b9\u6cd5\u8fdb\u884c\u4e00\u6b21\u8c03\u7528\u3002Logger\u53ef\u4ee5\u540c\u65f6\u88ab\u591a\u4e2agoroutine\u4f7f\u7528; \u5b83\u4fdd\u8bc1\u5bf9Writer\u7684\u5e8f\u5217\u5316\u8bbf\u95ee\u3002 \u4f8b\u5b50 var ( buf bytes.Buffer logger = log.New( buf, logger: , log.Lshortfile) ) logger.Print( Hello, log file! ) fmt.Print( buf) // \u8f93\u51fa logger: example_test.go:19: Hello, log file! \u65b9\u6cd5 (*Logger)Fatal func (l *Logger) Fatal(v ...interface{}) Fatal() \u7b49\u6548\u4e8e l.Print() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u65b9\u6cd5 (*Logger)Fatalf func (l *Logger) Fatalf(format string, v ...interface{}) Fatalf() \u7b49\u6548\u4e8e l.Printf() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u65b9\u6cd5 (*Logger)Fatalln func (l *Logger) Fatalln(v ...interface{}) Fatalln() \u7b49\u6548\u4e8e l.Println() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002 \u65b9\u6cd5 (*Logger)Flags func (l *Logger) Flags() int Flags\u8fd4\u56deLogger\u7684\u8f93\u51fa\u6807\u5fd7\u3002 \u65b9\u6cd5 (*Logger)Output func (l *Logger) Output(calldepth int, s string) error Output\u5199\u5165\u8bb0\u5f55\u4e8b\u4ef6\u7684\u8f93\u51fa\u3002 \u5b57\u7b26\u4e32 s \u5305\u542b\u8981\u5728 Logger \u4e2d flags \u6307\u5b9a\u7684\u524d\u7f00\u4e4b\u540e\u6253\u5370\u7684\u6587\u672c\u3002\u5982\u679c s \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u6362\u884c\u7b26\uff0c\u5219\u4f1a\u9644\u52a0\u6362\u884c\u7b26 Calldepth \u63d0\u4f9b\u901a\u7528\u7684\u7528\u4e8e\u6062\u590dPC(\u7a0b\u5e8f\u8ba1\u6570\u5668)\uff0c\u5f53\u524d\u6240\u6709\u9884\u5b9a\u4e49\u8def\u5f84\u4e0a\u5b83\u90fd\u662f2 \u6837\u4f8b var ( buf bytes.Buffer logger = log.New( buf, INFO: , log.Lshortfile) infof = func(info string) { logger.Output(2, info) } ) infof( Hello world ) fmt.Print( buf) // \u8f93\u51fa INFO: example_test.go:36: Hello world \u65b9\u6cd5(*Logger) Panic func (l *Logger) Panic(v ...interface{}) Panic() \u7b49\u6548\u4e8e l.Print() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u65b9\u6cd5(*Logger) Panicf func (l *Logger) Panicf(format string, v ...interface{}) Panicf() \u7b49\u6548\u4e8e l.Printf() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u65b9\u6cd5(*Logger) Panicln func (l *Logger) Panicln(v ...interface{}) Panicln() \u7b49\u6548\u4e8e l.Println() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002 \u65b9\u6cd5(*Logger) Prefix func (l *Logger) Prefix() string Prefix() \u8fd4\u56de Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002 \u65b9\u6cd5(*Logger) Print func (l *Logger) Print(v ...interface{}) Print() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Println() \u7684\u65b9\u5f0f\u5904\u7406\u3002 \u65b9\u6cd5(*Logger) Printf func (l *Logger) Printf(format string, v ...interface{}) Printf() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Printf() \u7684\u65b9\u5f0f\u5904\u7406\u3002 \u65b9\u6cd5(*Logger) Println func (l *Logger) Println(v ...interface{}) Println() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Println() \u65b9\u5f0f\u5904\u7406\u3002 \u65b9\u6cd5(*Logger) SetFlags func (l *Logger) SetFlags(flag int) SetFlags() \u8bbe\u7f6e Logger \u7684\u8f93\u51fa flags \u3002 \u65b9\u6cd5(*Logger) SetOutput func (l *Logger) SetOutput(w io.Writer) SetOutput() \u8bbe\u7f6eLogger\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002 \u65b9\u6cd5(*Logger) SetPrefix func (l *Logger) SetPrefix(prefix string) SetPrefix() \u8bbe\u7f6eLogger\u7684\u8f93\u51fa\u524d\u7f00\u3002 \u65b9\u6cd5(*Logger) Writer func (l *Logger) Writer() io.Writer Writer() \u8fd4\u56deLogger\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002","title":"packages log"},{"location":"Language/Library/log/#packages-log","text":"import log log\u5305\u5b9e\u73b0\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u65e5\u5fd7\u5305\uff0c\u5b83\u5b9a\u4e49\u4e86\u4e00\u79cd\u7c7b\u578b Logger \uff0c\u5176\u4e2d\u5305\u542b\u683c\u5f0f\u5316\u8f93\u51fa\u7684\u65b9\u6cd5\u3002 \u5b83\u8fd8\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u201c\u6807\u51c6\u201dLogger\uff0c\u53ef\u4ee5\u901a\u8fc7\u8f85\u52a9\u51fd\u6570 Print[f|ln] \uff0c Fatal[f|ln] \u548c Panic[f|ln] \u8bbf\u95ee\uff0c\u4f7f\u7528\u8fd9\u4e9b\u8f85\u52a9\u51fd\u6570\u6bd4\u624b\u52a8\u521b\u5efaLogger\u66f4\u5bb9\u6613\u4f7f\u7528\u3002Logger\u5199\u5165\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u5e76\u6253\u5370\u6bcf\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u7684\u65f6\u95f4\u548c\u65e5\u671f\u3002 \u6bcf\u6761\u65e5\u5fd7\u8bb0\u5f55\u90fd\u5728\u5355\u72ec\u7684\u884c\u4e2d\u8f93\u51fa\uff1a\u5982\u679c\u6b63\u5728\u6253\u5370\u7684\u6d88\u606f\u672a\u4ee5\u6362\u884c\u7b26\u7ed3\u5c3e\uff0c\u5219Logger\u5c06\u4f1a\u5728\u884c\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u6362\u884c\u7b26\u3002 Fatal\u51fd\u6570\u5728\u5199\u5165\u65e5\u5fd7\u6d88\u606f\u540e\u8c03\u7528 os.Exit(1) \u3002 Panic\u51fd\u6570\u5728\u5199\u5165\u65e5\u5fd7\u6d88\u606f\u540e\u8c03\u7528\u8fd0\u884c\u65f6\u6050\u614c\uff08panic\uff09\u3002","title":"packages log"},{"location":"Language/Library/log/#_1","text":"const ( Ldate = 1 iota // \u5f53\u5730\u65f6\u533a\u7684\u65e5\u671f: 2009/01/23 Ltime // \u5f53\u5730\u65f6\u533a\u7684\u65f6\u95f4: 01:23:23 Lmicroseconds // \u5fae\u79d2\u7cbe\u5ea6: 01:23:23.123123. \u5047\u8bbe\u662fLtime Llongfile // \u5b8c\u6574\u7684\u6587\u4ef6\u540d\u548c\u884c\u53f7: /a/b/c/d.go:23 Lshortfile // \u6700\u7ec8\u6587\u4ef6\u540d\u5143\u7d20\u548c\u884c\u53f7: d.go:23. \u8986\u76d6Llongfile LUTC // \u5982\u679c\u8bbe\u7f6e\u4e86Ldate\u6216\u8005Ltime\uff0c\u90a3\u4e48\u4f7f\u7528UTC\u800c\u4e0d\u662f\u672c\u5730\u65f6\u533a LstdFlags = Ldate | Ltime // \u6807\u51c6Logger\u7684\u521d\u59cb\u503c ) \u8fd9\u4e9b\u6807\u5fd7\u5b9a\u4e49\u4e86Logger\u751f\u6210\u7684\u6bcf\u4e2a\u65e5\u5fd7\u6761\u76ee\u7684 \u524d\u7f00 \uff0c\uff08 | \uff09 \u6216\u8fd0\u7b97\u6765\u63a7\u5236\u54ea\u4e9b\u9700\u8981\u8f93\u51fa\u3002\u65e0\u6cd5\u63a7\u5236\u5b83\u4eec\u51fa\u73b0\u7684\u987a\u5e8f\uff08\u5982\uff0c\u6b64\u5904\u5217\u51fa\u7684\u987a\u5e8f\uff09\u6216\u5b83\u4eec\u5448\u73b0\u7684\u683c\u5f0f\uff08\u5982\uff0c\u6ce8\u91ca\u4e2d\u6240\u8ff0\uff09\u3002\u4ec5\u5f53\u6307\u5b9a Llongfile \u6216 Lshortfile \u65f6\uff0c\u524d\u7f00\u540e\u8ddf\u5192\u53f7\u3002\u67e5\u770b\u5982\u4e0b\u793a\u4f8b\uff1a // \u8bbe\u7f6eLdate | Ltime\uff08\u6216LstdFlags\uff09\u5219\u4ea7\u751f\u5982\u4e0b\u6548\u679c 2009/01/23 01:23:23 message // \u8bbe\u7f6eLdate | Ltime | Lmicroseconds | Llongfile \u5219\u4ea7\u751f\u5982\u4e0b\u6548\u679c 2009/01/23 01:23:23.123123 /a/b/c/d.go:23: message","title":"\u5e38\u91cf"},{"location":"Language/Library/log/#fatal","text":"func Fatal(v ...interface{}) Fatal() \u7b49\u6548\u4e8e Print() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u51fd\u6570Fatal"},{"location":"Language/Library/log/#fatalf","text":"func Fatalf(format string, v ...interface{}) Fatal() \u7b49\u6548\u4e8e Printf() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u51fd\u6570Fatalf"},{"location":"Language/Library/log/#fatalln","text":"func Fatalln(v ...interface{}) Fatal() \u7b49\u6548\u4e8e Println() ,\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u51fd\u6570Fatalln"},{"location":"Language/Library/log/#flags","text":"func Flags() int Flags() \u8fd4\u56de\u6807\u51c6 Logger \u7684\u8f93\u51fa\u6807\u5fd7\u3002","title":"\u51fd\u6570Flags"},{"location":"Language/Library/log/#output","text":"func Output(calldepth int, s string) error Output() \u5c06\u8bb0\u5f55\u4e8b\u4ef6\u7684\u8f93\u51fa\u5199\u51fa\u6765\u3002 \u5b57\u7b26\u4e32 s \u5305\u542b\u8981\u5728 Logger \u7684 flags \u4e2d\u6307\u5b9a\u7684\u524d\u7f00\u4e4b\u540e\u6253\u5370\u7684\u6587\u672c\u5185\u5bb9\u3002\u5982\u679c s \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u6362\u884c\u7b26\uff0c\u5219\u4f1a\u9644\u52a0\u6362\u884c\u7b26\u3002 Calldepth \u662f\u8bbe\u7f6e\u4e86 Llongfile \u6216 Lshortfile \u540e\uff0c\u8ba1\u7b97\u6587\u4ef6\u540d\u548c\u884c\u53f7\u65f6\u8981\u8df3\u8fc7\u7684\u5e27\u6570; \u5982\u679c Calldepth \u7684\u503c\u4e3a1\u5c06\u6253\u5370 Output() \u8c03\u7528\u8005\u7684\u8be6\u7ec6\u4fe1\u606f\u3002","title":"\u51fd\u6570Output"},{"location":"Language/Library/log/#panic","text":"func Panic(v ...interface{}) Panic() \u7b49\u6548\u4e8e Print() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u51fd\u6570Panic"},{"location":"Language/Library/log/#panicf","text":"func Panicf(format string, v ...interface{}) Panic() \u7b49\u6548\u4e8e Printf() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u51fd\u6570Panicf"},{"location":"Language/Library/log/#panicln","text":"func Panicln(v ...interface{}) Panic() \u7b49\u6548\u4e8e Println() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u51fd\u6570Panicln"},{"location":"Language/Library/log/#prefix","text":"func Prefix() string Prefix() \u8fd4\u56de\u6807\u51c6 Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002","title":"\u51fd\u6570Prefix"},{"location":"Language/Library/log/#print","text":"func Print(v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Print() \u7684\u65b9\u5f0f\u5904\u7406\u3002","title":"\u51fd\u6570Print"},{"location":"Language/Library/log/#printf","text":"func Printf(format string, v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Printf() \u7684\u65b9\u5f0f\u5904\u7406\u3002","title":"\u51fd\u6570Printf"},{"location":"Language/Library/log/#println","text":"func Println(v ...interface{}) Print() \u8c03\u7528 Output() \u6765\u6253\u5370\u5230\u6807\u51c6 Logger \uff0c\u53c2\u6570\u4ee5 fmt.Println() \u7684\u65b9\u5f0f\u5904\u7406\u3002","title":"\u51fd\u6570Println"},{"location":"Language/Library/log/#_2","text":"","title":"\u603b\u7ed3\u51e0\u4e2a\u65b9\u6cd5"},{"location":"Language/Library/log/#setflags","text":"func SetFlags(flag int) SetFlags() \u4e3a\u6807\u51c6 Logger \u8bbe\u7f6e\u8f93\u51fa\u6807\u8bc6\u3002","title":"\u51fd\u6570SetFlags"},{"location":"Language/Library/log/#setoutput","text":"func SetOutput(w io.Writer) SetOutput() \u8bbe\u7f6e\u6807\u51c6 longer \u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002","title":"\u51fd\u6570SetOutput"},{"location":"Language/Library/log/#setprefix","text":"func SetPrefix(prefix string) SetPrefix() \u8bbe\u7f6e\u6807\u51c6 Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002","title":"\u51fd\u6570SetPrefix"},{"location":"Language/Library/log/#new","text":"func New(out io.Writer, prefix string, flag int) *Logger New() \u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 Logger \u3002 out \u8bbe\u7f6e\u65e5\u5fd7\u6570\u636e\u7684\u76ee\u7684\u5730 prefix \u6bcf\u884c\u65e5\u5fd7\u8bb0\u5f55\u7684\u524d\u7f00 flag \u5b9a\u4e49\u65e5\u5fd7\u8bb0\u5f55\u64cd\u4f5c\u7684\u5c5e\u6027","title":"\u51fd\u6570New"},{"location":"Language/Library/log/#logger","text":"type Logger struct { // contains filtered or unexported fields } Logger\u8868\u793a\u4e00\u4e2a\u6d3b\u8dc3\u7684\u65e5\u5fd7\u8bb0\u5f55\u5bf9\u8c61\uff0c\u5b83\u5411 io.Writer \u751f\u6210\u8f93\u51fa\u3002\u6bcf\u4e2a\u65e5\u5fd7\u8bb0\u5f55\u64cd\u4f5c\u53ea\u5bf9 Writer \u7684 Write() \u65b9\u6cd5\u8fdb\u884c\u4e00\u6b21\u8c03\u7528\u3002Logger\u53ef\u4ee5\u540c\u65f6\u88ab\u591a\u4e2agoroutine\u4f7f\u7528; \u5b83\u4fdd\u8bc1\u5bf9Writer\u7684\u5e8f\u5217\u5316\u8bbf\u95ee\u3002","title":"\u7c7b\u578bLogger"},{"location":"Language/Library/log/#_3","text":"var ( buf bytes.Buffer logger = log.New( buf, logger: , log.Lshortfile) ) logger.Print( Hello, log file! ) fmt.Print( buf) // \u8f93\u51fa logger: example_test.go:19: Hello, log file!","title":"\u4f8b\u5b50"},{"location":"Language/Library/log/#loggerfatal","text":"func (l *Logger) Fatal(v ...interface{}) Fatal() \u7b49\u6548\u4e8e l.Print() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u65b9\u6cd5 (*Logger)Fatal"},{"location":"Language/Library/log/#loggerfatalf","text":"func (l *Logger) Fatalf(format string, v ...interface{}) Fatalf() \u7b49\u6548\u4e8e l.Printf() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u65b9\u6cd5 (*Logger)Fatalf"},{"location":"Language/Library/log/#loggerfatalln","text":"func (l *Logger) Fatalln(v ...interface{}) Fatalln() \u7b49\u6548\u4e8e l.Println() \uff0c\u7136\u540e\u8c03\u7528 os.Exit(1) \u3002","title":"\u65b9\u6cd5 (*Logger)Fatalln"},{"location":"Language/Library/log/#loggerflags","text":"func (l *Logger) Flags() int Flags\u8fd4\u56deLogger\u7684\u8f93\u51fa\u6807\u5fd7\u3002","title":"\u65b9\u6cd5 (*Logger)Flags"},{"location":"Language/Library/log/#loggeroutput","text":"func (l *Logger) Output(calldepth int, s string) error Output\u5199\u5165\u8bb0\u5f55\u4e8b\u4ef6\u7684\u8f93\u51fa\u3002 \u5b57\u7b26\u4e32 s \u5305\u542b\u8981\u5728 Logger \u4e2d flags \u6307\u5b9a\u7684\u524d\u7f00\u4e4b\u540e\u6253\u5370\u7684\u6587\u672c\u3002\u5982\u679c s \u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u4e0d\u662f\u6362\u884c\u7b26\uff0c\u5219\u4f1a\u9644\u52a0\u6362\u884c\u7b26 Calldepth \u63d0\u4f9b\u901a\u7528\u7684\u7528\u4e8e\u6062\u590dPC(\u7a0b\u5e8f\u8ba1\u6570\u5668)\uff0c\u5f53\u524d\u6240\u6709\u9884\u5b9a\u4e49\u8def\u5f84\u4e0a\u5b83\u90fd\u662f2","title":"\u65b9\u6cd5 (*Logger)Output"},{"location":"Language/Library/log/#_4","text":"var ( buf bytes.Buffer logger = log.New( buf, INFO: , log.Lshortfile) infof = func(info string) { logger.Output(2, info) } ) infof( Hello world ) fmt.Print( buf) // \u8f93\u51fa INFO: example_test.go:36: Hello world","title":"\u6837\u4f8b"},{"location":"Language/Library/log/#logger-panic","text":"func (l *Logger) Panic(v ...interface{}) Panic() \u7b49\u6548\u4e8e l.Print() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u65b9\u6cd5(*Logger) Panic"},{"location":"Language/Library/log/#logger-panicf","text":"func (l *Logger) Panicf(format string, v ...interface{}) Panicf() \u7b49\u6548\u4e8e l.Printf() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u65b9\u6cd5(*Logger) Panicf"},{"location":"Language/Library/log/#logger-panicln","text":"func (l *Logger) Panicln(v ...interface{}) Panicln() \u7b49\u6548\u4e8e l.Println() \uff0c\u7136\u540e\u8c03\u7528 panic() \u3002","title":"\u65b9\u6cd5(*Logger) Panicln"},{"location":"Language/Library/log/#logger-prefix","text":"func (l *Logger) Prefix() string Prefix() \u8fd4\u56de Logger \u7684\u8f93\u51fa\u524d\u7f00\u3002","title":"\u65b9\u6cd5(*Logger) Prefix"},{"location":"Language/Library/log/#logger-print","text":"func (l *Logger) Print(v ...interface{}) Print() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Println() \u7684\u65b9\u5f0f\u5904\u7406\u3002","title":"\u65b9\u6cd5(*Logger) Print"},{"location":"Language/Library/log/#logger-printf","text":"func (l *Logger) Printf(format string, v ...interface{}) Printf() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Printf() \u7684\u65b9\u5f0f\u5904\u7406\u3002","title":"\u65b9\u6cd5(*Logger) Printf"},{"location":"Language/Library/log/#logger-println","text":"func (l *Logger) Println(v ...interface{}) Println() \u8c03\u7528 l.Output() \u6765\u8f93\u51fa\u5230 Logger \u3002\u53c2\u6570\u4ee5 fmt.Println() \u65b9\u5f0f\u5904\u7406\u3002","title":"\u65b9\u6cd5(*Logger) Println"},{"location":"Language/Library/log/#logger-setflags","text":"func (l *Logger) SetFlags(flag int) SetFlags() \u8bbe\u7f6e Logger \u7684\u8f93\u51fa flags \u3002","title":"\u65b9\u6cd5(*Logger) SetFlags"},{"location":"Language/Library/log/#logger-setoutput","text":"func (l *Logger) SetOutput(w io.Writer) SetOutput() \u8bbe\u7f6eLogger\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002","title":"\u65b9\u6cd5(*Logger) SetOutput"},{"location":"Language/Library/log/#logger-setprefix","text":"func (l *Logger) SetPrefix(prefix string) SetPrefix() \u8bbe\u7f6eLogger\u7684\u8f93\u51fa\u524d\u7f00\u3002","title":"\u65b9\u6cd5(*Logger) SetPrefix"},{"location":"Language/Library/log/#logger-writer","text":"func (l *Logger) Writer() io.Writer Writer() \u8fd4\u56deLogger\u7684\u8f93\u51fa\u76ee\u7684\u5730\u3002","title":"\u65b9\u6cd5(*Logger) Writer"},{"location":"Language/Library/io/ioutil/","text":"package ioutil import io/ioutil ioutil \u5305\u5b9e\u73b0\u4e86I/O\u5b9e\u7528\u5de5\u5177\u3002 \u53d8\u91cf var Discard io.Writer = devNull(0) Discard \u662f\u4e00\u4e2a io.Writer \uff0c\u5728\u8be5 Writer \u4e0a\u6240\u6709 Write \u8c03\u7528\u90fd\u53ef\u4ee5\u5728\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u7684\u60c5\u51b5\u4e0b\u6210\u529f\u5b8c\u6210\u3002 \u51fd\u6570 NopCloser func NopCloser(r io.Reader) io.ReadCloser NopCloser \u8fd4\u56de\u4e00\u4e2a ReadCloser \uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u65e0\u64cd\u4f5c\uff08 no-op \uff09\u7684 Close \u65b9\u6cd5\uff0c\u7528\u4e8e\u5305\u88c5\u63d0\u4f9b\u7684 Reader r \u3002 \u51fd\u6570 ReadAll func ReadAll(r io.Reader) ([]byte, error) ReadAll \u4ece r \u8bfb\u53d6\uff0c\u76f4\u5230\u51fa\u73b0\u9519\u8bef\u6216 EOF \u5e76\u8fd4\u56de\u5b83\u8bfb\u53d6\u5230\u7684\u6570\u636e\u3002\u6210\u529f\u7684\u8c03\u7528\u5c06\u8fd4\u56de err==nil \uff0c\u800c\u4e0d\u662f err==EOF \u3002\u56e0\u4e3a ReadAll \u88ab\u5b9a\u4e49\u4e3a\u4ece src \u8bfb\u53d6\u76f4\u5230 EOF \uff0c\u6240\u4ee5\u5b83\u4e0d\u4f1a\u5c06\u6765\u81ea Read \u7684 EOF \u89c6\u4e3a\u8981\u62a5\u544a\u7684\u9519\u8bef\u3002 r := strings.NewReader( Go is a general-purpose language designed with systems programming in mind. ) b, err := ioutil.ReadAll(r) if err != nil { log.Fatal(err) } fmt.Printf( %s , b) // \u8f93\u51fa Go is a general-purpose language designed with systems programming in mind. \u51fd\u6570 ReadDir func ReadDir(dirname string) ([]os.FileInfo, error) ReadDir \u8bfb\u53d6\u7531 dirname \u547d\u540d\u7684\u76ee\u5f55\uff0c\u5e76\u8fd4\u56de\u6309 filename \u6392\u5e8f\u7684\u76ee\u5f55\u6761\u76ee\u5217\u8868\u3002 files, err := ioutil.ReadDir( . ) if err != nil { log.Fatal(err) } for _, file := range files { fmt.Println(file.Name()) } \u51fd\u6570 ReadFile func ReadFile(filename string) ([]byte, error) ReadFile \u8bfb\u53d6\u7531 filename \u547d\u540d\u7684\u6587\u4ef6\u5e76\u8fd4\u56de\u5185\u5bb9\u3002\u6210\u529f\u7684\u8c03\u7528\u5c06\u8fd4\u56de err==nil \uff0c\u800c\u4e0d\u662f err==EOF \u3002\u56e0\u4e3a ReadFile \u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\uff0c\u6240\u4ee5\u5b83\u4e0d\u4f1a\u5c06 Read \u4e2d\u7684 EOF \u89c6\u4e3a\u8981\u62a5\u544a\u7684\u9519\u8bef\u3002 content, err := ioutil.ReadFile( testdata/hello ) if err != nil { log.Fatal(err) } fmt.Printf( File contents: %s , content) // \u8f93\u51fa File contents: Hello, Gophers! \u51fd\u6570 TempDir func TempDir(dir, prefix string) (name string, err error) TempDir \u5728\u76ee\u5f55 dir \u4e2d\u521b\u5efa\u4e00\u4e2a \u65b0\u7684\u4e34\u65f6\u76ee\u5f55 \uff0c\u5176\u540d\u79f0\u4ee5 prefix \u5f00\u5934\uff0c\u5e76\u8fd4\u56de\u65b0\u76ee\u5f55\u7684\u8def\u5f84\u3002\u5982\u679c dir \u662f\u7a7a\u5b57\u7b26\u4e32\uff0c TempDir \u5c06\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u7684\u9ed8\u8ba4\u76ee\u5f55\uff08\u8bf7\u53c2\u9605 os.TempDir \uff09\u3002\u540c\u65f6\u8c03\u7528 TempDir \u7684\u591a\u4e2a\u7a0b\u5e8f\u5c06\u4e0d\u4f1a\u9009\u62e9\u76f8\u540c\u7684\u76ee\u5f55\u3002\u8c03\u7528\u8005\u6709\u8d23\u4efb\u5728\u4e0d\u518d\u9700\u8981\u65f6\u5220\u9664\u76ee\u5f55\u3002 content := []byte( temporary file's content ) dir, err := ioutil.TempDir( , example ) if err != nil { log.Fatal(err) } defer os.RemoveAll(dir) // clean up tmpfn := filepath.Join(dir, tmpfile ) if err := ioutil.WriteFile(tmpfn, content, 0666); err != nil { log.Fatal(err) } \u51fd\u6570 TempFile func TempFile(dir, pattern string) (f *os.File, err error) TempFile \u5728\u76ee\u5f55 dir \u4e2d\u521b\u5efa\u4e00\u4e2a \u65b0\u7684\u4e34\u65f6\u6587\u4ef6 \uff0c\u6253\u5f00\u6587\u4ef6\u8fdb\u884c\u8bfb\u5199\uff0c\u5e76\u8fd4\u56de\u751f\u6210\u7684 *os.File \u3002\u6587\u4ef6\u540d\u662f\u901a\u8fc7\u83b7\u53d6 pattern \u5e76\u5728\u672b\u5c3e\u6dfb\u52a0\u968f\u673a\u5b57\u7b26\u4e32\u751f\u6210\u7684\u3002\u5982\u679c pattern \u5305\u542b \u201c*\u201d \uff0c\u5219\u968f\u673a\u5b57\u7b26\u4e32\u5c06\u66ff\u6362\u6700\u540e\u4e00\u4e2a \u201c*\u201d \u3002\u5982\u679c dir \u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u5219 TempFile \u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u7684\u9ed8\u8ba4\u76ee\u5f55\uff08\u8bf7\u53c2\u9605 os.TempDir \uff09\u3002\u540c\u65f6\u8c03\u7528 TempFile \u7684\u591a\u4e2a\u7a0b\u5e8f\u4e0d\u4f1a\u9009\u62e9\u76f8\u540c\u7684\u6587\u4ef6\u3002\u8c03\u7528\u8005\u53ef\u4ee5\u4f7f\u7528 f.Name() \u6765\u67e5\u627e\u6587\u4ef6\u7684\u8def\u5f84\u540d\u3002\u5f53\u4e0d\u518d\u9700\u8981\u65f6\uff0c\u8c03\u7528\u8005\u6709\u8d23\u4efb\u5220\u9664\u8be5\u6587\u4ef6\u3002 content := []byte( temporary file's content ) tmpfile, err := ioutil.TempFile( , example ) if err != nil { log.Fatal(err) } defer os.Remove(tmpfile.Name()) // clean up if _, err := tmpfile.Write(content); err != nil { log.Fatal(err) } if err := tmpfile.Close(); err != nil { log.Fatal(err) } content := []byte( temporary file's content ) tmpfile, err := ioutil.TempFile( , example.*.txt ) if err != nil { log.Fatal(err) } defer os.Remove(tmpfile.Name()) // clean up if _, err := tmpfile.Write(content); err != nil { tmpfile.Close() log.Fatal(err) } if err := tmpfile.Close(); err != nil { log.Fatal(err) } \u51fd\u6570 WriteFile func WriteFile(filename string, data []byte, perm os.FileMode) error WriteFile \u5c06\u6570\u636e\u5199\u5165\u7531 filename \u547d\u540d\u7684\u6587\u4ef6\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219 WriteFile \u4f7f\u7528\u6743\u9650 perm \u521b\u5efa\u5b83;\u5426\u5219 WriteFile \u4f1a\u5728\u5199\u5165\u4e4b\u524d\u622a\u65ad\u5b83\u3002 message := []byte( Hello, Gophers! ) err := ioutil.WriteFile( testdata/hello , message, 0644) if err != nil { log.Fatal(err) }","title":"package ioutil"},{"location":"Language/Library/io/ioutil/#package-ioutil","text":"import io/ioutil ioutil \u5305\u5b9e\u73b0\u4e86I/O\u5b9e\u7528\u5de5\u5177\u3002","title":"package ioutil"},{"location":"Language/Library/io/ioutil/#_1","text":"var Discard io.Writer = devNull(0) Discard \u662f\u4e00\u4e2a io.Writer \uff0c\u5728\u8be5 Writer \u4e0a\u6240\u6709 Write \u8c03\u7528\u90fd\u53ef\u4ee5\u5728\u4e0d\u6267\u884c\u4efb\u4f55\u64cd\u4f5c\u7684\u60c5\u51b5\u4e0b\u6210\u529f\u5b8c\u6210\u3002","title":"\u53d8\u91cf"},{"location":"Language/Library/io/ioutil/#nopcloser","text":"func NopCloser(r io.Reader) io.ReadCloser NopCloser \u8fd4\u56de\u4e00\u4e2a ReadCloser \uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u65e0\u64cd\u4f5c\uff08 no-op \uff09\u7684 Close \u65b9\u6cd5\uff0c\u7528\u4e8e\u5305\u88c5\u63d0\u4f9b\u7684 Reader r \u3002","title":"\u51fd\u6570NopCloser"},{"location":"Language/Library/io/ioutil/#readall","text":"func ReadAll(r io.Reader) ([]byte, error) ReadAll \u4ece r \u8bfb\u53d6\uff0c\u76f4\u5230\u51fa\u73b0\u9519\u8bef\u6216 EOF \u5e76\u8fd4\u56de\u5b83\u8bfb\u53d6\u5230\u7684\u6570\u636e\u3002\u6210\u529f\u7684\u8c03\u7528\u5c06\u8fd4\u56de err==nil \uff0c\u800c\u4e0d\u662f err==EOF \u3002\u56e0\u4e3a ReadAll \u88ab\u5b9a\u4e49\u4e3a\u4ece src \u8bfb\u53d6\u76f4\u5230 EOF \uff0c\u6240\u4ee5\u5b83\u4e0d\u4f1a\u5c06\u6765\u81ea Read \u7684 EOF \u89c6\u4e3a\u8981\u62a5\u544a\u7684\u9519\u8bef\u3002 r := strings.NewReader( Go is a general-purpose language designed with systems programming in mind. ) b, err := ioutil.ReadAll(r) if err != nil { log.Fatal(err) } fmt.Printf( %s , b) // \u8f93\u51fa Go is a general-purpose language designed with systems programming in mind.","title":"\u51fd\u6570ReadAll"},{"location":"Language/Library/io/ioutil/#readdir","text":"func ReadDir(dirname string) ([]os.FileInfo, error) ReadDir \u8bfb\u53d6\u7531 dirname \u547d\u540d\u7684\u76ee\u5f55\uff0c\u5e76\u8fd4\u56de\u6309 filename \u6392\u5e8f\u7684\u76ee\u5f55\u6761\u76ee\u5217\u8868\u3002 files, err := ioutil.ReadDir( . ) if err != nil { log.Fatal(err) } for _, file := range files { fmt.Println(file.Name()) }","title":"\u51fd\u6570ReadDir"},{"location":"Language/Library/io/ioutil/#readfile","text":"func ReadFile(filename string) ([]byte, error) ReadFile \u8bfb\u53d6\u7531 filename \u547d\u540d\u7684\u6587\u4ef6\u5e76\u8fd4\u56de\u5185\u5bb9\u3002\u6210\u529f\u7684\u8c03\u7528\u5c06\u8fd4\u56de err==nil \uff0c\u800c\u4e0d\u662f err==EOF \u3002\u56e0\u4e3a ReadFile \u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\uff0c\u6240\u4ee5\u5b83\u4e0d\u4f1a\u5c06 Read \u4e2d\u7684 EOF \u89c6\u4e3a\u8981\u62a5\u544a\u7684\u9519\u8bef\u3002 content, err := ioutil.ReadFile( testdata/hello ) if err != nil { log.Fatal(err) } fmt.Printf( File contents: %s , content) // \u8f93\u51fa File contents: Hello, Gophers!","title":"\u51fd\u6570ReadFile"},{"location":"Language/Library/io/ioutil/#tempdir","text":"func TempDir(dir, prefix string) (name string, err error) TempDir \u5728\u76ee\u5f55 dir \u4e2d\u521b\u5efa\u4e00\u4e2a \u65b0\u7684\u4e34\u65f6\u76ee\u5f55 \uff0c\u5176\u540d\u79f0\u4ee5 prefix \u5f00\u5934\uff0c\u5e76\u8fd4\u56de\u65b0\u76ee\u5f55\u7684\u8def\u5f84\u3002\u5982\u679c dir \u662f\u7a7a\u5b57\u7b26\u4e32\uff0c TempDir \u5c06\u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u7684\u9ed8\u8ba4\u76ee\u5f55\uff08\u8bf7\u53c2\u9605 os.TempDir \uff09\u3002\u540c\u65f6\u8c03\u7528 TempDir \u7684\u591a\u4e2a\u7a0b\u5e8f\u5c06\u4e0d\u4f1a\u9009\u62e9\u76f8\u540c\u7684\u76ee\u5f55\u3002\u8c03\u7528\u8005\u6709\u8d23\u4efb\u5728\u4e0d\u518d\u9700\u8981\u65f6\u5220\u9664\u76ee\u5f55\u3002 content := []byte( temporary file's content ) dir, err := ioutil.TempDir( , example ) if err != nil { log.Fatal(err) } defer os.RemoveAll(dir) // clean up tmpfn := filepath.Join(dir, tmpfile ) if err := ioutil.WriteFile(tmpfn, content, 0666); err != nil { log.Fatal(err) }","title":"\u51fd\u6570TempDir"},{"location":"Language/Library/io/ioutil/#tempfile","text":"func TempFile(dir, pattern string) (f *os.File, err error) TempFile \u5728\u76ee\u5f55 dir \u4e2d\u521b\u5efa\u4e00\u4e2a \u65b0\u7684\u4e34\u65f6\u6587\u4ef6 \uff0c\u6253\u5f00\u6587\u4ef6\u8fdb\u884c\u8bfb\u5199\uff0c\u5e76\u8fd4\u56de\u751f\u6210\u7684 *os.File \u3002\u6587\u4ef6\u540d\u662f\u901a\u8fc7\u83b7\u53d6 pattern \u5e76\u5728\u672b\u5c3e\u6dfb\u52a0\u968f\u673a\u5b57\u7b26\u4e32\u751f\u6210\u7684\u3002\u5982\u679c pattern \u5305\u542b \u201c*\u201d \uff0c\u5219\u968f\u673a\u5b57\u7b26\u4e32\u5c06\u66ff\u6362\u6700\u540e\u4e00\u4e2a \u201c*\u201d \u3002\u5982\u679c dir \u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u5219 TempFile \u4f7f\u7528\u4e34\u65f6\u6587\u4ef6\u7684\u9ed8\u8ba4\u76ee\u5f55\uff08\u8bf7\u53c2\u9605 os.TempDir \uff09\u3002\u540c\u65f6\u8c03\u7528 TempFile \u7684\u591a\u4e2a\u7a0b\u5e8f\u4e0d\u4f1a\u9009\u62e9\u76f8\u540c\u7684\u6587\u4ef6\u3002\u8c03\u7528\u8005\u53ef\u4ee5\u4f7f\u7528 f.Name() \u6765\u67e5\u627e\u6587\u4ef6\u7684\u8def\u5f84\u540d\u3002\u5f53\u4e0d\u518d\u9700\u8981\u65f6\uff0c\u8c03\u7528\u8005\u6709\u8d23\u4efb\u5220\u9664\u8be5\u6587\u4ef6\u3002 content := []byte( temporary file's content ) tmpfile, err := ioutil.TempFile( , example ) if err != nil { log.Fatal(err) } defer os.Remove(tmpfile.Name()) // clean up if _, err := tmpfile.Write(content); err != nil { log.Fatal(err) } if err := tmpfile.Close(); err != nil { log.Fatal(err) } content := []byte( temporary file's content ) tmpfile, err := ioutil.TempFile( , example.*.txt ) if err != nil { log.Fatal(err) } defer os.Remove(tmpfile.Name()) // clean up if _, err := tmpfile.Write(content); err != nil { tmpfile.Close() log.Fatal(err) } if err := tmpfile.Close(); err != nil { log.Fatal(err) }","title":"\u51fd\u6570TempFile"},{"location":"Language/Library/io/ioutil/#writefile","text":"func WriteFile(filename string, data []byte, perm os.FileMode) error WriteFile \u5c06\u6570\u636e\u5199\u5165\u7531 filename \u547d\u540d\u7684\u6587\u4ef6\u3002\u5982\u679c\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219 WriteFile \u4f7f\u7528\u6743\u9650 perm \u521b\u5efa\u5b83;\u5426\u5219 WriteFile \u4f1a\u5728\u5199\u5165\u4e4b\u524d\u622a\u65ad\u5b83\u3002 message := []byte( Hello, Gophers! ) err := ioutil.WriteFile( testdata/hello , message, 0644) if err != nil { log.Fatal(err) }","title":"\u51fd\u6570WriteFile"},{"location":"Language/Library/log/syslog/","text":"package syslog import log/syslog syslog\u5305\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u7cfb\u7edf\u65e5\u5fd7\u670d\u52a1\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 UNIX domain sockets \uff0c UDP \u6216 TCP \u5c06\u6d88\u606f\u53d1\u9001\u5230syslog\u5b88\u62a4\u7a0b\u5e8f\u3002 \u53ea\u9700\u8c03\u7528\u4e00\u6b21 Dial \uff0c\u56e0\u4e3a\u5728\u5199\u5165\u5931\u8d25\u65f6\uff0csyslog\u5ba2\u6237\u7aef\u5c06\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5e76\u518d\u6b21\u5199\u5165\u3002 syslog\u5305\u5df2\u5f52\u6863\uff0c\u4e0d\u518d\u63a5\u53d7\u65b0\u529f\u80fd\u3002\u4e00\u4e9b\u5916\u90e8\u5305\u63d0\u4f9b\u66f4\u591a\u529f\u80fd\u3002\u770b\u5230\uff1ahttps://godoc.org/?q=syslog \u51fd\u6570NewLogger func NewLogger(p Priority, logFlag int) (*log.Logger, error) NewLogger() \u521b\u5efa\u4e00\u4e2a log.Logger \uff0c\u5176\u8f93\u51fa\u5c06\u5199\u5165\u5177\u6709\u6307\u5b9a\u4f18\u5148\u7ea7\u7684\u7cfb\u7edf\u65e5\u5fd7\u670d\u52a1\uff0c\u5373syslog\u5de5\u5177\u548cseverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u7684\u7ec4\u5408\u3002 logFlag\u662f\u4f20\u9012\u7ed9 log.New() \u4ee5\u521b\u5efa Logger \u7684\u6807\u5fd7\u96c6(flag set)\u3002 \u7c7b\u578bPriority type Priority int \u4f18\u5148\u7ea7\u662fsyslog\u5de5\u5177\u548cserverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u7684\u7ec4\u5408\u3002\u4f8b\u5982\uff0c LOG_ALERT | LOG_FTP \u4eceFTP\u5de5\u5177\u53d1\u9001\u8b66\u62a5serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u6d88\u606f\u3002\u9ed8\u8ba4serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_EMERG \uff1b\u9ed8\u8ba4\u5de5\u5177\u662f LOG_KERN \u3002 const ( // From /usr/include/sys/syslog.h. // These are the same on Linux, BSD, and OS X. LOG_EMERG Priority = iota LOG_ALERT LOG_CRIT LOG_ERR LOG_WARNING LOG_NOTICE LOG_INFO LOG_DEBUG ) const ( // From /usr/include/sys/syslog.h. // These are the same up to LOG_FTP on Linux, BSD, and OS X. LOG_KERN Priority = iota 3 LOG_USER LOG_MAIL LOG_DAEMON LOG_AUTH LOG_SYSLOG LOG_LPR LOG_NEWS LOG_UUCP LOG_CRON LOG_AUTHPRIV LOG_FTP LOG_LOCAL0 LOG_LOCAL1 LOG_LOCAL2 LOG_LOCAL3 LOG_LOCAL4 LOG_LOCAL5 LOG_LOCAL6 LOG_LOCAL7 ) \u51fd\u6570Dail func Dial(network, raddr string, priority Priority, tag string) (*Writer, error) Dial\u901a\u8fc7\u8fde\u63a5\u5230\u6307\u5b9a\u7f51\u7edc\u7684 raddr \u5730\u5740\u6765\u5efa\u7acb\u4e0e\u65e5\u5fd7\u5b88\u62a4\u7a0b\u5e8f\u7684\u8fde\u63a5\u3002\u6bcf\u6b21\u5199\u5165\u8fd4\u56de\u7684writer\u90fd\u4f1a\u53d1\u9001\u4e00\u6761\u65e5\u5fd7\u6d88\u606f\uff0c\u5176\u4e2d\u5305\u542b\u5de5\u5177\u548cserverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u548c\u6807\u8bb0\u3002 \u5982\u679ctag\u4e3a\u7a7a\uff0c\u5219\u4f7f\u7528 os.Args[0] \u3002 \u5982\u679c\u7f51\u7edc\u4e3a\u7a7a\uff0cDial\u5c06\u8fde\u63a5\u5230\u672c\u5730 syslog \u670d\u52a1\u5668\u3002 \u5426\u5219\uff0c\u8bf7\u53c2\u9605 net.Dial \u7684\u6587\u6863\u4ee5\u83b7\u53d6 network \u548c raddr \u7684\u6709\u6548\u503c\u3002 sysLog, err := syslog.Dial( tcp , localhost:1234 , syslog.LOG_WARNING|syslog.LOG_DAEMON, demotag ) if err != nil { log.Fatal(err) } fmt.Fprintf(sysLog, This is a daemon warning with demotag. ) sysLog.Emerg( And this is a daemon emergency with demotag. ) \u51fd\u6570New func New(priority Priority, tag string) (*Writer, error) New() \u5efa\u7acb\u4e0e\u7cfb\u7edf\u65e5\u5fd7\u5b88\u62a4\u7a0b\u5e8f\u7684\u65b0\u8fde\u63a5\u3002\u6bcf\u6b21\u5199\u5165\u8fd4\u56de\u7684writer\u90fd\u4f1a\u53d1\u9001\u4e00\u6761\u65e5\u5fd7\u6d88\u606f\uff0c\u5176\u4e2d\u5305\u542b\u7ed9\u5b9a\u7684\u4f18\u5148\u7ea7\uff08syslog\u5de5\u5177\u548cserverity\u7684\u7ec4\u5408\uff09\u548c\u524d\u7f00\u6807\u8bb0\u3002\u5982\u679ctag\u4e3a\u7a7a\uff0c\u5219\u4f7f\u7528 os.Args[0] \u3002 \u7c7b\u578bWriter type Writer struct { // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } Writer \u662f\u4e00\u4e2a syslog \u670d\u52a1\u7684\u8fde\u63a5\u3002 \u65b9\u6cd5 (*Writer) Alert func (w *Writer) Alert(m string) error Alert()\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3aLOG_ALERT\u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684severity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u3002 \u65b9\u6cd5 (*Writer) Close func (w *Writer) Close() error Close\u5173\u95ed\u4e0esyslog\u5b88\u62a4\u7a0b\u5e8f\u7684\u8fde\u63a5\u3002 \u65b9\u6cd5 (*Writer) Crit func (w *Writer) Crit(m string) errors Crit\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_CRIT \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Debug func (w *Writer) Debug(m string) error Debug\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_DEBUG \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Emerg func (w *Writer) Emerg(m string) error Emerg\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_EMERG \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Err func (w *Writer) Err(m string) error Err\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_ERR \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Info func (w *Writer) Info(m string) error Info\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_INFO \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Notice func (w *Writer) Notice(m string) error \u6ce8\u610f\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_NOTICE \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Warning func (w *Writer) Warning(m string) error Warning\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_WARNING \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002 \u65b9\u6cd5 (*Writer) Write func (w *Writer) Write(b []byte) (int, error) Write\u5c06\u65e5\u5fd7\u6d88\u606f\u53d1\u9001\u5230syslog\u5b88\u62a4\u7a0b\u5e8f\u3002","title":"package syslog"},{"location":"Language/Library/log/syslog/#package-syslog","text":"import log/syslog syslog\u5305\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u7cfb\u7edf\u65e5\u5fd7\u670d\u52a1\u63a5\u53e3\uff0c\u53ef\u4ee5\u901a\u8fc7\u4f7f\u7528 UNIX domain sockets \uff0c UDP \u6216 TCP \u5c06\u6d88\u606f\u53d1\u9001\u5230syslog\u5b88\u62a4\u7a0b\u5e8f\u3002 \u53ea\u9700\u8c03\u7528\u4e00\u6b21 Dial \uff0c\u56e0\u4e3a\u5728\u5199\u5165\u5931\u8d25\u65f6\uff0csyslog\u5ba2\u6237\u7aef\u5c06\u5c1d\u8bd5\u91cd\u65b0\u8fde\u63a5\u5230\u670d\u52a1\u5668\u5e76\u518d\u6b21\u5199\u5165\u3002 syslog\u5305\u5df2\u5f52\u6863\uff0c\u4e0d\u518d\u63a5\u53d7\u65b0\u529f\u80fd\u3002\u4e00\u4e9b\u5916\u90e8\u5305\u63d0\u4f9b\u66f4\u591a\u529f\u80fd\u3002\u770b\u5230\uff1ahttps://godoc.org/?q=syslog","title":"package syslog"},{"location":"Language/Library/log/syslog/#newlogger","text":"func NewLogger(p Priority, logFlag int) (*log.Logger, error) NewLogger() \u521b\u5efa\u4e00\u4e2a log.Logger \uff0c\u5176\u8f93\u51fa\u5c06\u5199\u5165\u5177\u6709\u6307\u5b9a\u4f18\u5148\u7ea7\u7684\u7cfb\u7edf\u65e5\u5fd7\u670d\u52a1\uff0c\u5373syslog\u5de5\u5177\u548cseverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u7684\u7ec4\u5408\u3002 logFlag\u662f\u4f20\u9012\u7ed9 log.New() \u4ee5\u521b\u5efa Logger \u7684\u6807\u5fd7\u96c6(flag set)\u3002","title":"\u51fd\u6570NewLogger"},{"location":"Language/Library/log/syslog/#priority","text":"type Priority int \u4f18\u5148\u7ea7\u662fsyslog\u5de5\u5177\u548cserverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u7684\u7ec4\u5408\u3002\u4f8b\u5982\uff0c LOG_ALERT | LOG_FTP \u4eceFTP\u5de5\u5177\u53d1\u9001\u8b66\u62a5serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u6d88\u606f\u3002\u9ed8\u8ba4serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_EMERG \uff1b\u9ed8\u8ba4\u5de5\u5177\u662f LOG_KERN \u3002 const ( // From /usr/include/sys/syslog.h. // These are the same on Linux, BSD, and OS X. LOG_EMERG Priority = iota LOG_ALERT LOG_CRIT LOG_ERR LOG_WARNING LOG_NOTICE LOG_INFO LOG_DEBUG ) const ( // From /usr/include/sys/syslog.h. // These are the same up to LOG_FTP on Linux, BSD, and OS X. LOG_KERN Priority = iota 3 LOG_USER LOG_MAIL LOG_DAEMON LOG_AUTH LOG_SYSLOG LOG_LPR LOG_NEWS LOG_UUCP LOG_CRON LOG_AUTHPRIV LOG_FTP LOG_LOCAL0 LOG_LOCAL1 LOG_LOCAL2 LOG_LOCAL3 LOG_LOCAL4 LOG_LOCAL5 LOG_LOCAL6 LOG_LOCAL7 )","title":"\u7c7b\u578bPriority"},{"location":"Language/Library/log/syslog/#dail","text":"func Dial(network, raddr string, priority Priority, tag string) (*Writer, error) Dial\u901a\u8fc7\u8fde\u63a5\u5230\u6307\u5b9a\u7f51\u7edc\u7684 raddr \u5730\u5740\u6765\u5efa\u7acb\u4e0e\u65e5\u5fd7\u5b88\u62a4\u7a0b\u5e8f\u7684\u8fde\u63a5\u3002\u6bcf\u6b21\u5199\u5165\u8fd4\u56de\u7684writer\u90fd\u4f1a\u53d1\u9001\u4e00\u6761\u65e5\u5fd7\u6d88\u606f\uff0c\u5176\u4e2d\u5305\u542b\u5de5\u5177\u548cserverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u548c\u6807\u8bb0\u3002 \u5982\u679ctag\u4e3a\u7a7a\uff0c\u5219\u4f7f\u7528 os.Args[0] \u3002 \u5982\u679c\u7f51\u7edc\u4e3a\u7a7a\uff0cDial\u5c06\u8fde\u63a5\u5230\u672c\u5730 syslog \u670d\u52a1\u5668\u3002 \u5426\u5219\uff0c\u8bf7\u53c2\u9605 net.Dial \u7684\u6587\u6863\u4ee5\u83b7\u53d6 network \u548c raddr \u7684\u6709\u6548\u503c\u3002 sysLog, err := syslog.Dial( tcp , localhost:1234 , syslog.LOG_WARNING|syslog.LOG_DAEMON, demotag ) if err != nil { log.Fatal(err) } fmt.Fprintf(sysLog, This is a daemon warning with demotag. ) sysLog.Emerg( And this is a daemon emergency with demotag. )","title":"\u51fd\u6570Dail"},{"location":"Language/Library/log/syslog/#new","text":"func New(priority Priority, tag string) (*Writer, error) New() \u5efa\u7acb\u4e0e\u7cfb\u7edf\u65e5\u5fd7\u5b88\u62a4\u7a0b\u5e8f\u7684\u65b0\u8fde\u63a5\u3002\u6bcf\u6b21\u5199\u5165\u8fd4\u56de\u7684writer\u90fd\u4f1a\u53d1\u9001\u4e00\u6761\u65e5\u5fd7\u6d88\u606f\uff0c\u5176\u4e2d\u5305\u542b\u7ed9\u5b9a\u7684\u4f18\u5148\u7ea7\uff08syslog\u5de5\u5177\u548cserverity\u7684\u7ec4\u5408\uff09\u548c\u524d\u7f00\u6807\u8bb0\u3002\u5982\u679ctag\u4e3a\u7a7a\uff0c\u5219\u4f7f\u7528 os.Args[0] \u3002","title":"\u51fd\u6570New"},{"location":"Language/Library/log/syslog/#writer","text":"type Writer struct { // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } Writer \u662f\u4e00\u4e2a syslog \u670d\u52a1\u7684\u8fde\u63a5\u3002","title":"\u7c7b\u578bWriter"},{"location":"Language/Library/log/syslog/#writer-alert","text":"func (w *Writer) Alert(m string) error Alert()\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3aLOG_ALERT\u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684severity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u3002","title":"\u65b9\u6cd5 (*Writer) Alert"},{"location":"Language/Library/log/syslog/#writer-close","text":"func (w *Writer) Close() error Close\u5173\u95ed\u4e0esyslog\u5b88\u62a4\u7a0b\u5e8f\u7684\u8fde\u63a5\u3002","title":"\u65b9\u6cd5 (*Writer) Close"},{"location":"Language/Library/log/syslog/#writer-crit","text":"func (w *Writer) Crit(m string) errors Crit\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_CRIT \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Crit"},{"location":"Language/Library/log/syslog/#writer-debug","text":"func (w *Writer) Debug(m string) error Debug\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_DEBUG \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Debug"},{"location":"Language/Library/log/syslog/#writer-emerg","text":"func (w *Writer) Emerg(m string) error Emerg\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_EMERG \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Emerg"},{"location":"Language/Library/log/syslog/#writer-err","text":"func (w *Writer) Err(m string) error Err\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_ERR \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Err"},{"location":"Language/Library/log/syslog/#writer-info","text":"func (w *Writer) Info(m string) error Info\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_INFO \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Info"},{"location":"Language/Library/log/syslog/#writer-notice","text":"func (w *Writer) Notice(m string) error \u6ce8\u610f\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_NOTICE \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Notice"},{"location":"Language/Library/log/syslog/#writer-warning","text":"func (w *Writer) Warning(m string) error Warning\u4f1a\u8bb0\u5f55serverity\uff08\u4f18\u5148\u7ea7\u522b\uff09\u4e3a LOG_WARNING \u7684\u6d88\u606f\uff0c\u5ffd\u7565\u4f20\u9012\u7ed9New\u7684serverity\u3002","title":"\u65b9\u6cd5 (*Writer) Warning"},{"location":"Language/Library/log/syslog/#writer-write","text":"func (w *Writer) Write(b []byte) (int, error) Write\u5c06\u65e5\u5fd7\u6d88\u606f\u53d1\u9001\u5230syslog\u5b88\u62a4\u7a0b\u5e8f\u3002","title":"\u65b9\u6cd5 (*Writer) Write"},{"location":"Language/Library/net/http/","text":"package http import net/http http\u5305\u63d0\u4f9bHTTP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5b9e\u73b0\u3002 Get\u3001Head\u3001Post\u548cPostForm\u53d1\u8d77HTTP\uff08\u6216HTTPS\uff09\u8bf7\u6c42\uff1a resp , err := http.Get( http://example.com/ ) ... resp, err := http.Post( http://example.com/upload , image/jpeg , buf) ... resp, err := http.PostForm( http://example.com/form ,url.Values{ Key :{ Value }, id :{ 123 }}) \u7ed3\u675f\u540e\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5173\u95ed\u54cd\u5e94\u4f53\uff1a resp, err := http.Get( http://example.com ) if err != nil { // handle error } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) \u60f3\u8981\u63a7\u5236HTTP\u5ba2\u6237\u7aef\u7684\u5934\u3001\u91cd\u5b9a\u5411\u7b56\u7565\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a Client \uff1a client := http.Client{ CheckRedirect: redirectPolicyFunc, } resp, err := client.Get( http://example.com ) // ... req, err := http,NewRequest( GET , http://example.com ,nil) // ... req.Header.Add( if-None-Match ,`W/ wyzzy `) resp, err := client.Do(req) // ... \u60f3\u8981\u63a7\u5236\u4ee3\u7406\uff0cTLS\u914d\u7f6e\uff0ckeep-alive\uff0c\u538b\u7f29\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a Transport \uff1a tr := http.Transport{ MaxldleConns: 10, ldleConnTimeout: 30 * time.Second, DisableCompression: true, } client := http.Client{Transport: tr} resp, err := client.Get( https://example.com ) Client \u548c Transport \u53ef\u4ee5\u5b89\u5168\u5730\u88ab\u591a\u4e2a goroutine \u5e76\u53d1\u4f7f\u7528\uff0c\u4e3a\u4e86\u9ad8\u6548\u5e94\u8be5\u53ea\u521b\u5efa\u4e00\u6b21\u5e76\u91cd\u590d\u4f7f\u7528\u3002 ListenAndServe \u4f7f\u7528\u7ed9\u5b9a\u5730\u5740\u548c\u5904\u7406\u7a0b\u5e8f\u542f\u52a8\u4e00\u4e2aHTTP\u670d\u52a1\u7aef\u3002\u8fd9\u4e2a\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u662f nil ,\u8fd9\u8868\u793a\u4f7f\u7528 DefaultServeMux \u3002 Handle \u548c HandleFunc \u5c06\u5904\u7406\u7a0b\u5e8f\u6dfb\u52a0\u5230 DefaultServeMux : http.Handle( /foo \uff0cfooHandler) http.HandleFunc( /bar ,func(w http.ResponseWriter, r *http.Request){ fmt.Fprintf(w, Hello,%q ,html.EscapeString(r.URL,Path)) }) log.Fatal(http.ListenAndServe( :8080 ,nil)) \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684Server\u6765\u66f4\u597d\u7684\u63a7\u5236server\u7684\u884c\u4e3a\uff1a s := http.Server{ Addr : :8080 , Handler: myHandler, ReadTimeout: 10 * time.Second, WriteTimeout: 10 * time.Second, MaxHeaderBytes: 1 20, } log.Fatal(s.ListenAndServe()) \u4eceGo 1.6\u5f00\u59cb\uff0c\u4f7f\u7528HTTPS\u65f6\uff0chttp\u5305\u5bf9HTTP/2\u534f\u8bae\u5177\u6709\u900f\u660e\u652f\u6301\u3002 \u5fc5\u987b\u7981\u7528HTTP/2\u7684\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e Transport.TLSNextProto(\u5ba2\u6237\u7aef\u8bbe\u7f6e) \u6216\u8005 Server.TLSNextProto (\u670d\u52a1\u7aef\u8bbe\u7f6e)\u7684\u503c\u4e3a\u975enil\u7684\u7a7amap\u3002\u6216\u8005\uff0c\u5f53\u524d\u652f\u6301\u5982\u4e0b\u7684 GODEBUG \u73af\u5883\u53d8\u91cf\uff1a GODEBUG=http2client=0 // \u7981\u7528HTTP/2\u5ba2\u6237\u7aef\u652f\u6301 GODEBUG=http2server=0 // \u7981\u7528HTTP/2\u670d\u52a1\u7aef\u652f\u6301 GODEBUG=http2debug=1 // \u542f\u52a8\u8be6\u7ec6\u7684HTTP/2 \u8c03\u8bd5\u65e5\u5fd7 GODEBUG=http2debug=2 // \u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\uff0c\u5305\u542b frame dumps Go\u7684API\u517c\u5bb9\u6027\u4fdd\u8bc1\u4e0d\u6db5\u76d6GODEBUG\u53d8\u91cf\u3002\u5728\u7981\u7528HTTP / 2\u652f\u6301\u4e4b\u524d\uff0c\u8bf7\u62a5\u544a\u6240\u6709\u95ee\u9898\uff1a https://golang.org/s/http2bug \u4e3a\u4e86\u7b80\u5316\u914d\u7f6e http \u5305\u4e2d\u7684 Transport \u548c Server \u90fd\u81ea\u5b9a\u542f\u52a8HTTP/2\u652f\u6301\u3002\u8981\u4e3a\u66f4\u590d\u6742\u7684\u914d\u7f6e\u542f\u7528HTTP/2\uff0c\u4ee5\u4f7f\u7528\u4f4e\u7ea7\u522bHTTP/2\u529f\u80fd\u6216\u4f7f\u7528Go\u7684http2\u8f6f\u4ef6\u5305\u7684\u65b0\u7248\u672c\uff0c\u8bf7\u76f4\u63a5\u5bfc\u5165 golang.org/x/net/http2 \u5e76\u4f7f\u7528\u5176 ConfigureTransport \u548c / \u6216 ConfigureServer \u529f\u80fd\u3002\u901a\u8fc7 golang.org/x/net/http2 \u5305\u624b\u52a8\u914d\u7f6eHTTP/2\u4f18\u5148\u4e8enet/http\u5305\u7684\u5185\u7f6eHTTP/2\u652f\u6301\u3002 Constants const( MethodGet = GET MethodHead = HEAD MethodPost = POST MethodPut = PUT MethodPath = PATCH // RFC 5789 MethodDelete = DELETE MethodConnect = CONNECT MethodOPtions = OPTIONS MethodTrace = TRACE ) \u5e38\u89c1\u7684HTTP\u65b9\u6cd5\u3002 \u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u5b83\u4eec\u5728 RFC 7231\u7b2c4.3\u8282 \u4e2d\u5b9a\u4e49\u3002 const ( StatusContinue = 100 // RFC 7231, 6.2.1 StatusSwitchingProtocols = 101 // RFC 7231, 6.2.2 StatusProcessing = 102 // RFC 2518, 10.1 StatusEarlyHints = 103 // RFC 8297 StatusOK = 200 // RFC 7231, 6.3.1 StatusCreated = 201 // RFC 7231, 6.3.2 StatusAccepted = 202 // RFC 7231, 6.3.3 StatusNonAuthoritativeInfo = 203 // RFC 7231, 6.3.4 StatusNoContent = 204 // RFC 7231, 6.3.5 StatusResetContent = 205 // RFC 7231, 6.3.6 StatusPartialContent = 206 // RFC 7233, 4.1 StatusMultiStatus = 207 // RFC 4918, 11.1 StatusAlreadyReported = 208 // RFC 5842, 7.1 StatusIMUsed = 226 // RFC 3229, 10.4.1 StatusMultipleChoices = 300 // RFC 7231, 6.4.1 StatusMovedPermanently = 301 // RFC 7231, 6.4.2 StatusFound = 302 // RFC 7231, 6.4.3 StatusSeeOther = 303 // RFC 7231, 6.4.4 StatusNotModified = 304 // RFC 7232, 4.1 StatusUseProxy = 305 // RFC 7231, 6.4.5 StatusTemporaryRedirect = 307 // RFC 7231, 6.4.7 StatusPermanentRedirect = 308 // RFC 7538, 3 StatusBadRequest = 400 // RFC 7231, 6.5.1 StatusUnauthorized = 401 // RFC 7235, 3.1 StatusPaymentRequired = 402 // RFC 7231, 6.5.2 StatusForbidden = 403 // RFC 7231, 6.5.3 StatusNotFound = 404 // RFC 7231, 6.5.4 StatusMethodNotAllowed = 405 // RFC 7231, 6.5.5 StatusNotAcceptable = 406 // RFC 7231, 6.5.6 StatusProxyAuthRequired = 407 // RFC 7235, 3.2 StatusRequestTimeout = 408 // RFC 7231, 6.5.7 StatusConflict = 409 // RFC 7231, 6.5.8 StatusGone = 410 // RFC 7231, 6.5.9 StatusLengthRequired = 411 // RFC 7231, 6.5.10 StatusPreconditionFailed = 412 // RFC 7232, 4.2 StatusRequestEntityTooLarge = 413 // RFC 7231, 6.5.11 StatusRequestURITooLong = 414 // RFC 7231, 6.5.12 StatusUnsupportedMediaType = 415 // RFC 7231, 6.5.13 StatusRequestedRangeNotSatisfiable = 416 // RFC 7233, 4.4 StatusExpectationFailed = 417 // RFC 7231, 6.5.14 StatusTeapot = 418 // RFC 7168, 2.3.3 StatusMisdirectedRequest = 421 // RFC 7540, 9.1.2 StatusUnprocessableEntity = 422 // RFC 4918, 11.2 StatusLocked = 423 // RFC 4918, 11.3 StatusFailedDependency = 424 // RFC 4918, 11.4 StatusTooEarly = 425 // RFC 8470, 5.2. StatusUpgradeRequired = 426 // RFC 7231, 6.5.15 StatusPreconditionRequired = 428 // RFC 6585, 3 StatusTooManyRequests = 429 // RFC 6585, 4 StatusRequestHeaderFieldsTooLarge = 431 // RFC 6585, 5 StatusUnavailableForLegalReasons = 451 // RFC 7725, 3 StatusInternalServerError = 500 // RFC 7231, 6.6.1 StatusNotImplemented = 501 // RFC 7231, 6.6.2 StatusBadGateway = 502 // RFC 7231, 6.6.3 StatusServiceUnavailable = 503 // RFC 7231, 6.6.4 StatusGatewayTimeout = 504 // RFC 7231, 6.6.5 StatusHTTPVersionNotSupported = 505 // RFC 7231, 6.6.6 StatusVariantAlsoNegotiates = 506 // RFC 2295, 8.1 StatusInsufficientStorage = 507 // RFC 4918, 11.5 StatusLoopDetected = 508 // RFC 5842, 7.2 StatusNotExtended = 510 // RFC 2774, 7 StatusNetworkAuthenticationRequired = 511 // RFC 6585, 6 ) \u6ce8\u518c\u5728IANA\u4e0a\u7684HTTP\u72b6\u6001\u7801\uff0c\u67e5\u770b\uff1a https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml const DefaultMaxHeaderBytes = 1 20 // 1 MB DefaultMaxHeaderBytes \u662fHTTP\u8bf7\u6c42\u5934\u7684\u6700\u5927\u5141\u8bb8\u5927\u5c0f\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e Server.MaxHeaderBytes \u6765\u8986\u76d6\u5b83\u3002 const DefaultMaxIdleConnsPerHost = 2 DefaultMaxIdleConnsPerHost \u662f Transport \u7684 MaxIdleConnsPerHost \u7684\u9ed8\u8ba4\u503c\u3002 const TimeFormat = Mon, 02 Jan 2006 15:04:05 GMT TimeFormat \u662f\u5728HTTP\u6807\u5934\u4e2d\u751f\u6210\u65f6\u95f4\u65f6\u8981\u4f7f\u7528\u7684\u65f6\u95f4\u683c\u5f0f\u3002\u5c31\u50cf time.RFC1123 \u4e00\u6837\uff0c\u4f46\u662f\u5c06GMT\u786c\u7f16\u7801\u4e3a\u65f6\u533a\u3002\u683c\u5f0f\u5316\u65f6\u95f4\u5fc5\u987b\u91c7\u7528UTC\u683c\u5f0f\u624d\u80fd\u751f\u6210\u6b63\u786e\u7684\u683c\u5f0f\u3002 \u6709\u5173\u89e3\u6790\u6b64\u65f6\u95f4\u683c\u5f0f\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 ParseTime \u3002 const TrailerPrefix = Trailer: TrailerPrefix \u662f ResponseWriter.Header \u7684map\u7684\u952e\u7684\u524d\u7f00\uff08\u5982\u679c\u5b58\u5728\u7684\u8bdd\uff09\uff0c\u8868\u793amap\u6761\u76ee\u5b9e\u9645\u4e0a\u662f\u7528\u4e8e\u54cd\u5e94\u5c3e\u90e8\u7684\uff0c\u800c\u4e0d\u662f\u54cd\u5e94\u5934\u7684\u3002 ServeHTTP \u8c03\u7528\u5b8c\u6210\u540e\uff0c\u524d\u7f00\u5c06\u88ab\u5220\u9664\uff0c\u5e76\u4e14\u503c\u5c06\u5728\u5c3e\u90e8\u4e2d\u53d1\u9001\u3002 \u6b64\u673a\u5236\u4ec5\u9002\u7528\u4e8e\u5728\u5199\u5165\u6807\u5934\u4e4b\u524d\u672a\u77e5\u7684\u5c3e\u90e8\u3002\u5982\u679c\u5728\u5199\u6807\u5934\u4e4b\u524d\u56fa\u5b9a\u7684\u6216\u5df2\u77e5\u7684\u5c3e\u90e8\u7ec4\uff0c\u5219\u9996\u9009\u666e\u901a\u7684Go\u5c3e\u90e8\u673a\u5236\uff1a https://golang.org/pkg/net/http/#ResponseWriter https://golang.org/pkg/net/http/#example_ResponseWriter_trailers Variables var ( // ErrNotSupported \u662f\u7531Pusher\u7684Push\u65b9\u6cd5\u8fd4\u56de\u7684\uff0c\u8868\u793a\u4e0d\u53ef\u83b7\u5f97\u5bf9HTTP/2\u7684\u652f\u6301 ErrNotSupported = ProtocolError{ feature not supported } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrUnexpectedTrailer // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrUnexpectedTrailer = ProtocolError{ trailer header without chunked transfer encoding } // \u5f53\u8bf7\u6c42\u7684 Content-Type \u4e0d\u5305\u542b\u4e00\u4e2a\u201cboundary\u201d\u53c2\u6570\u65f6\uff0cRequest.MultipartReader \u8fd4\u56de ErrMissingBoundary ErrMissingBoundary = ProtocolError{ no multipart boundary param in Content-Type } // \u5f53\u8bf7\u6c42\u7684 Content-Type \u4e0d\u662f multipart/form-data \u65f6\uff0cRequest.MultipartReader \u8fd4\u56de ErrNotMultipart ErrNotMultipart = ProtocolError{ request Content-Type isn't multipart/form-data } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrHeaderTooLong // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrHeaderTooLong = ProtocolError{ header too long } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrShortBody // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrShortBody = ProtocolError{ entity body too short } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrMissingContentLength // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrMissingContentLength = ProtocolError{ missing ContentLength in HEAD response } ) var ( // HTTP\u65b9\u6cd5\u6216\u54cd\u5e94\u4ee3\u7801\u4e0d\u5141\u8bb8body\u65f6\uff0cResponseWriter.Write\u8c03\u7528\u8fd4\u56deErrBodyNotAllowed ErrBodyNotAllowed = errors.New( http: request method or response status code does not allow body ) // \u5f53\u4f7f\u7528Hijacker\u63a5\u53e3\u65f6\u57fa\u7840\u8fde\u63a5\u88ab\u52ab\u6301\uff0cResponseWriter.Write \u8fd4\u56de ErrHijacked // \u5728\u88ab\u52ab\u6301\u7684\u8fde\u63a5\u4e0a\u8fdb\u884c\u96f6\u5b57\u8282\u5199\u5165\u5c06\u8fd4\u56deErrHijacked\uff0c\u800c\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5176\u4ed6\u526f\u4f5c\u7528 ErrHijacked = errors.New( http: connection has been hijacked ) // \u5f53 Handler \u4e3aContent-Length\u54cd\u5e94\u5934\u8bbe\u7f6e\u4e00\u4e2a\u957f\u5ea6\uff0c\u7136\u540e\u5c1d\u8bd5\u5199\u5165\u6bd4\u58f0\u660e\u66f4\u591a\u7684\u5b57\u8282\u65f6\uff0c // ResponseWriter.Write\u8c03\u7528\u8fd4\u56deErrContentLength ErrContentLength = errors.New( http: wrote more than the declared Content-Length ) // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrWriteAfterFlush // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrWriteAfterFlush = errors.New( unused ) ) HTTP\u670d\u52a1\u7aef\u4f7f\u7528\u7684\u9519\u8bef\u3002 var ( // ServerContextKey\u662f context key\u3002\u53ef\u4ee5\u5728\u5e26\u6709 Context.Value \u7684 HTTP handler \u4e2d // \u4f7f\u7528\u5b83\u6765\u8bbf\u95ee\u542f\u52a8 handler \u7684\u670d\u52a1\u5668 // \u5173\u8054\u7684\u503c\u5c06\u662f* Server\u7c7b\u578b ServerContextKey = contextKey{ http-server } // LocalAddrContextKey\u662fcontext key\u3002 \u53ef\u4ee5\u5728\u5e26\u6709Context.Value\u7684HTTP handler\u4e2d\u4f7f\u7528\u5b83\u6765\u8bbf\u95ee\u8fde\u63a5\u7684\u672c\u5730\u5730\u5740 // \u5173\u8054\u7684\u503c\u5c06\u4e3anet.Addr\u7c7b\u578b\u3002 LocalAddrContextKey = contextKey{ local-addr } ) var DefaultClient = Client{} DefaultClient\u662f\u9ed8\u8ba4\u5ba2\u6237\u7aef\uff0c\u7531Get\uff0cHead\u548cPost\u4f7f\u7528\u3002 var DefaultServeMux = defaultServeMux DefaultServeMux\u662fServe\u4f7f\u7528\u7684\u9ed8\u8ba4ServeMux\u3002 var ErrAbortHandler = errors.New( net/http: abort Handler ) ErrAbortHandler \u662f\u4e00\u4e2a\u4e2d\u6b62panic\u503c\uff0c\u7528\u4e8e\u4e2d\u6b62handler\u3002\u6765\u81eaServeHTTP\u7684\u4efb\u4f55panic\u90fd\u4f1a\u4e2d\u6b62\u5bf9\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\uff0c\u4f46\u662f\u4f7f\u7528 ErrAbortHandler \u8fdb\u884cpanic\u4e5f\u4f1a\u6291\u5236\u5c06\u5806\u6808\u8ddf\u8e2a\u8bb0\u5f55\u5230\u670d\u52a1\u5668\u7684\u9519\u8bef\u65e5\u5fd7\u4e2d\u3002 var ErrBodyReadAfterClose = errors.New( http: invalid Read on closed Body ) \u5728\u5173\u95ed\u8bf7\u6c42\u6216\u54cd\u5e94\u4e3b\u4f53\u540e\uff0c\u8bfb\u53d6\u8bf7\u6c42\u6216\u54cd\u5e94\u4e3b\u4f53\u65f6\uff0c\u5c06\u8fd4\u56de ErrBodyReadAfterClose \u3002\u901a\u5e38\u5728HTTP\u5904\u7406\u7a0b\u5e8f\u5728\u5176 ResponseWriter \u4e0a\u8c03\u7528 WriteHeader \u6216 Write \u540e\u8bfb\u53d6\u6b63\u6587\u65f6\uff0c\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002 var ErrHandlerTimeout = errors.New( http: Handler timeout )s \u5728\u5df2\u8d85\u65f6\u7684\u5904\u7406\u7a0b\u5e8f\u4e0a\u8fdb\u884c ResponseWriter \u7684Write\u8c03\u7528\u4f1a\u8fd4\u56de ErrHandlerTimeout \u3002 var ErrLineTooLong = internal.ErrLineTooLong \u8bfb\u53d6\u5206\u5757\u7f16\u7801\u5f02\u5e38\u7684\u8bf7\u6c42\u6216\u54cd\u5e94\u4f53\u65f6\uff0c\u5c06\u8fd4\u56de ErrLineTooLong \u3002 var ErrMissingFile = errors.New( http: no such file ) \u5f53\u63d0\u4f9b\u7684\u6587\u4ef6\u5b57\u6bb5\u4e0d\u5b58\u5728\u4e8e\u8bf7\u6c42\u4e2d\u6216\u8005\u5b83\u4e0d\u662f\u4e00\u4e2a\u6587\u4ef6\u5b57\u6bb5\u4e2d\u65f6\uff0cFormFile\u8fd4\u56de ErrMissingFile \u3002 var ErrNoCookie = errors.New( http: named cookie not present ) \u672a\u627e\u5230Cookie\u65f6\uff0cRequest\u7684Cookie\u65b9\u6cd5\u5c06\u8fd4\u56de ErrNoCookie \u3002 var ErrNoLocation = errors.New( http: no Location header in response ) \u5982\u679c\u4e0d\u5b58\u5728Location\u6807\u5934\uff0c\u5219\u7531Response\u7684Location\u65b9\u6cd5\u8fd4\u56de ErrNoLocation \u3002 var ErrServerClosed = errors.New( http: Server closed ) \u8c03\u7528Shutdown\u6216Close\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u7684Serve\uff0cServeTLS\uff0cListenAndServe\u548cListenAndServeTLS\u65b9\u6cd5\u8fd4\u56de ErrServerClosed \u3002 var ErrSkipAltProtocol = errors.New( net/http: skip alternate protocol ) ErrSkipAltProtocol \u662f\u7531 Transport.RegisterProtocol \u5b9a\u4e49\u7684\u6807\u8bb0\u9519\u8bef\u503c\u3002 var ErrUseLastResponse = errors.New( net/http: use last response ) Client.CheckRedirect hooks \u53ef\u4ee5\u8fd4\u56de ErrUseLastResponse \uff0c\u4ee5\u63a7\u5236\u5982\u4f55\u5904\u7406\u91cd\u5b9a\u5411\u3002\u5982\u679c\u8fd4\u56de\uff0c\u5219\u4e0d\u53d1\u9001\u4e0b\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd4\u56de\u6700\u8fd1\u7684\u54cd\u5e94\uff0c\u4e14\u5176\u4e3b\u4f53\u672a\u5173\u95ed\u3002 var NoBody = noBody{} NoBody \u662f\u4e00\u4e2a\u6ca1\u6709\u5b57\u8282\u7684 io.ReadCloser \u3002\u8bfb\u53d6\u59cb\u7ec8\u8fd4\u56deEOF\uff0c\u800c\u5173\u95ed\u59cb\u7ec8\u8fd4\u56denil\u3002\u53ef\u4ee5\u5728\u4f20\u51fa\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u4f7f\u7528\u5b83\u6765\u660e\u786e\u8868\u793a\u8bf7\u6c42\u7684\u5b57\u8282\u6570\u4e3a\u96f6\u3002\u4e5f\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5c06 Request.Body \u8bbe\u7f6e\u4e3anil\u3002 \u51fd\u6570 func CanonicalHeaderKey func CanonicalHeaderKey(s string) string CanonicalHeaderKey \u8fd4\u56deheader key s \u7684\u89c4\u8303\u683c\u5f0f\u3002\u89c4\u8303\u5316\u5c06\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u548c\u8fde\u5b57\u7b26\u540e\u7684\u4efb\u4f55\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199\uff1b\u5176\u4f59\u7684\u5c06\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u4f8b\u5982\uff0c\"accept-encoding\"\u7684\u89c4\u8303\u683c\u5f0f\u662f\"Accept-Encoding\"\u3002\u5982\u679c`s``\u5305\u542b\u7a7a\u683c\u6216\u65e0\u6548\u7684header field bytes\uff0c\u5219\u8fd4\u56de\u5b83\u800c\u65e0\u9700\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002 func DetectContentType func DetectContentType(data []byte) string DetectContentType \u5b9e\u73b0\u5728 https://mimesniff.spec.whatwg.org/ \u4e0a\u63cf\u8ff0\u7684\u7b97\u6cd5\uff0c\u4ee5\u786e\u5b9a\u7ed9\u5b9a\u6570\u636e\u7684 Content-Type \u3002\u5b83\u6700\u591a\u8003\u8651\u524d512\u4e2a\u5b57\u8282\u7684\u6570\u636e\u3002 DetectContentType \u59cb\u7ec8\u8fd4\u56de\u6709\u6548\u7684 MIME \u7c7b\u578b\uff1a\u5982\u679c\u65e0\u6cd5\u786e\u5b9a\u66f4\u5177\u4f53\u7684\u7c7b\u578b\uff0c\u5219\u8fd4\u56de \"application/octet-stream\" \u3002 func Error func Error(w ResponseWriter, error string, code int) Error\u56de\u590d\u5e26\u6709\u7279\u5b9a\u9519\u8bef\u6d88\u606f\u548cHTTP\u4ee3\u7801\u7684\u8bf7\u6c42\u3002\u5426\u5219\uff0c\u5b83\u4e0d\u4f1a\u7ed3\u675f\u8bf7\u6c42\uff1b\u8c03\u7528\u8005\u5e94\u786e\u4fdd\u4e0d\u518d\u5bf9 w \u8fdb\u884c\u5199\u64cd\u4f5c\u3002\u9519\u8bef\u6d88\u606f\u5e94\u4e3a\u7eaf\u6587\u672c\u3002 func Handle func Handle(pattern string, handler Handler) Handle \u5728 DefaultServeMux \u4e2d\u6ce8\u518c\u7ed9\u5b9a\u6a21\u5f0f\u7684\u5904\u7406\u7a0b\u5e8f\u3002 ServeMux \u7684\u6587\u6863\u8bf4\u660e\u4e86\u5982\u4f55\u5339\u914d\u6a21\u5f0f\u3002 handler-example package main import ( fmt log net/http sync ) type countHander struct{ mu sync.Mutex // guards n n int } func (h *countHandler) ServeHTTP(w http.ResponseWriter, r *http.Request){ h.mu.Lock() defer h.mu.Unlock() h.n++ fmt.Fprintf(w, count is %d\\n ,h.n) } func main(){ http.Handle( /count ,new(countHandler)) log.Fatal(http.ListenAndServe( :8080 ,nil)) } func HandleFunc func HandleFunc(pattern string, handler func(ResponseWriter, *Request)) HandleFunc \u5728 DefaultServeMux \u4e2d\u6ce8\u518c\u7ed9\u5b9a\u6a21\u5f0f\u7684\u5904\u7406\u51fd\u6570\u3002 ServeMux \u7684\u6587\u6863\u8bf4\u660e\u4e86\u5982\u4f55\u5339\u914d\u6a21\u5f0f\u3002 handlerfunc-example h1 := func(w http.ResponseWriter, _ *http.Request){ io.WriteString(w, Hello from a HandleFunc #1!\\n ) } h2 := func(w http.ResponseWriter, _ *http.Request){ io.WriteString(w, Hello from a HandleFunc #2!\\n ) } http.HandleFunc( / , h1) http.HandleFunc( /endpoint , h2) log.Fatal(http.ListenAndServe( :8080 ,nil)) func ListenAndServe func ListenAndServe(addr string, handler Handler) error ListenAndServe \u4fa6\u542cTCP\u7f51\u7edc\u5730\u5740addr\uff0c\u7136\u540e\u8c03\u7528\u5e26\u6709\u5904\u7406\u7a0b\u5e8f\u7684Serve\u6765\u5904\u7406\u4f20\u5165\u8fde\u63a5\u4e0a\u7684\u8bf7\u6c42\u3002\u80fd\u591f\u63a5\u53d7\u7684\u8fde\u63a5\u9700\u8981\u914d\u7f6e\u4e3a\u542f\u7528TCP keep-alives\u3002 \u8be5\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u4e3anil\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f7f\u7528 DefaultServeMux \u3002 ListenAndServe \u59cb\u7ec8\u8fd4\u56de\u975enil\u9519\u8bef\u3002 listenandserve-example helloHandler := func(w http.ResponseWriter, req *http.Request){ io.WriteString(w, Hello,world!\\n ) } http.HandlerFunc( /hello ,helloHandler) log.Fatal(http.ListenAndServe( :8080 ,nil)) func ListenAndServeTLS func ListenAndServeTLS(addr, certFile, keyFile string, handler Handler) error ListenAndServeTLS \u7684\u884c\u4e3a\u4e0e ListenAndServe \u76f8\u540c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5b83\u9700\u8981 HTTPS \u8fde\u63a5\u3002\u6b64\u5916\uff0c\u5fc5\u987b\u63d0\u4f9b\u5305\u542b\u670d\u52a1\u5668\u8bc1\u4e66\u548c\u5339\u914d\u79c1\u94a5\u7684\u6587\u4ef6\u3002\u5982\u679c\u8bc1\u4e66\u662f\u7531\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7b7e\u540d\u7684\uff0c\u5219 certFile \u5e94\u8be5\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4efb\u4f55\u4e2d\u95f4\u4ef6\u548cCA\u8bc1\u4e66\u7684\u4e32\u8054\u3002 listenandservetls-example http.HandlerFunc( / ,func(w http.ResponseWriter, req *http.Request){ io.WriteString(w, Hello,TLS!\\n ) }) // One can use generate_cert.go in crypto/tls to generate cert.pem and key.pem log.Printf( About to listen on 8443. Go to https://127.0,0.1:8443/ ) err := http.ListenAndServeTLS( :8443 , cert.pem , key.pem ,nil) log.Fatal(err) func MaxBytesReader func MaxBytesReader(w ResponseWriter, r io.ReadCloser, n int64) io.ReadCloser MaxBytesReader \u4e0e io.LimitReader \u76f8\u4f3c\uff0c\u4f46\u65e8\u5728\u9650\u5236\u4f20\u5165\u8bf7\u6c42\u4f53\u7684\u5927\u5c0f\u3002\u4e0e io.LimitReader \u76f8\u6bd4\uff0c MaxBytesReader \u7684\u7ed3\u679c\u4e3a ReadCloser \uff0c\u5bf9\u4e8e\u8d85\u51fa\u9650\u5236\u7684Read\u8fd4\u56de\u975eEOF\u9519\u8bef\uff0c\u5e76\u5728\u8c03\u7528\u5176Close\u65b9\u6cd5\u65f6\u5173\u95ed\u5e95\u5c42reader\u3002 MaxBytesReader \u53ef\u4ee5\u9632\u6b62\u5ba2\u6237\u7aef\u610f\u5916\u6216\u6076\u610f\u53d1\u9001\u5927\u8bf7\u6c42\u5e76\u6d6a\u8d39\u670d\u52a1\u5668\u8d44\u6e90\u3002 func NotFound func NotFound(w ResponseWriter, r *Request) NotFound \u56de\u590d\u8bf7\u6c42\uff0c\u5e76\u663e\u793aHTTP 404 not found\u9519\u8bef\u3002 func ParseHTTPVersion func ParseHTTPVersion(vers string) (major, minor int, ok bool) ParseHTTPVersion \u89e3\u6790HTTP\u7248\u672c\u5b57\u7b26\u4e32\u3002 \"HTTP/1.0\" \u8fd4\u56de (1,0,true) \u3002 funcParseTime func ParseTime(text string) (t time.Time, err error) ParseTime \u89e3\u6790\u65f6\u95f4\u6807\u5934\uff08\u4f8b\u5982 Date: header \uff09\uff0c\u5c1d\u8bd5\u4f7f\u7528HTTP/1.1\u5141\u8bb8\u7684\u4e09\u79cd\u683c\u5f0f\uff1a TimeFormat \uff0c time.RFC850 \u548c time.ANSIC \u3002 func ProxyFromEnvironment func ProxyFromEnvironment(req *Request) (*url.URL, error) ProxyFromEnvironment \u8fd4\u56de\u7528\u4e8e\u7ed9\u5b9a\u8bf7\u6c42\u7684\u4ee3\u7406\u7684URL\uff0c\u5982\u73af\u5883\u53d8\u91cf HTTP_PROXY \uff0c HTTPS_PROXY \u548c NO_PROXY \uff08\u6216\u5176\u5c0f\u5199\u7248\u672c\uff09\u6240\u6307\u793a\u3002 \u5bf9\u4e8eHTTPS\u8bf7\u6c42\uff0cHTTPS_PROXY\u4f18\u5148\u4e8eHTTP_PROXY \u3002 \u73af\u5883\u503c\u53ef\u4ee5\u662f\u5b8c\u6574\u7684URL\u6216 \"host [:port]\" \uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5047\u5b9a\u4f7f\u7528\"http\"\u534f\u8bae\u3002\u5982\u679c\u503c\u7684\u683c\u5f0f\u4e0d\u540c\uff0c\u5219\u8fd4\u56de\u9519\u8bef\u3002 \u5982\u679c\u73af\u5883\u4e2d\u672a\u5b9a\u4e49\u4efb\u4f55\u4ee3\u7406\uff0c\u5219\u8fd4\u56denil URL\u548cnil\u9519\u8bef\uff0c\u6216\u8005\u4e0d\u5e94\u5c06\u4ee3\u7406\u7528\u4e8e\u8fd9\u6837\u7684\u8bf7\u6c42\uff08\u5982 NO_PROXY \u6240\u5b9a\u4e49\uff09\u3002 \u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5982\u679c req.URL.Host \u4e3a \"localhost\" \uff08\u6709\u6216\u6ca1\u6709\u7aef\u53e3\u53f7\uff09\uff0c\u5219\u5c06\u8fd4\u56denil URL\u548cnil\u9519\u8bef\u3002 func ProxyURL func ProxyURL(fixedURL *url.URL) func(*Request) (*url.URL, error) ProxyURL \u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u51fd\u6570\uff08\u5728Transport\u4e2d\u4f7f\u7528\uff09\uff0c\u8be5\u51fd\u6570\u59cb\u7ec8\u8fd4\u56de\u76f8\u540cURL\u3002 func Redirect func Redirect(w ResponseWriter, r *Request, url string, code int) Redirect \u901a\u8fc7\u91cd\u5b9a\u5411\u5230URL\u6765\u54cd\u5e94\u8bf7\u6c42\uff0cURL\u53ef\u80fd\u662f\u76f8\u5bf9\u4e8e\u8bf7\u6c42\u8def\u5f84\u7684\u8def\u5f84\u3002 \u8fd4\u56de\u7684\u72b6\u6001\u7801\u5e94\u57283xx\u8303\u56f4\u5185\uff0c\u901a\u5e38\u4e3a StatusMovedPermanently \uff08301\uff09\uff0c StatusFound \uff08302\uff09\u6216 StatusSeeOther (303\uff09\u3002 \u5982\u679c\u5c1a\u672a\u8bbe\u7f6e Content-Type \u6807\u5934\uff0c Redirect \u4f1a\u5c06\u5176\u8bbe\u7f6e\u4e3a \"text / html; charset = utf-8\" \u5e76\u7f16\u5199\u4e00\u4e2a\u5c0f\u7684HTML\u3002\u5c06 Content-Type \u6807\u5934\u8bbe\u7f6e\u4e3a\u4efb\u4f55\u503c\uff08\u5305\u62ecnil\uff09\u5c06\u7981\u7528\u8be5\u884c\u4e3a\u3002 func Serve func Serve(l net.Listener, handler Handler) error Serve \u63a5\u53d7\u4fa6\u542c\u5668 l \u4e0a\u4f20\u5165\u7684HTTP\u8fde\u63a5\uff0c\u4ece\u800c\u4e3a\u6bcf\u4e2a\u4fa6\u542c\u5668\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1 goroutine \u3002\u670d\u52a1 goroutine \u8bfb\u53d6\u8bf7\u6c42\uff0c\u7136\u540e\u8c03\u7528\u5904\u7406\u7a0b\u5e8f\u4ee5\u56de\u590d\u8bf7\u6c42\u3002\u8be5\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u4e3anil\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f7f\u7528 DefaultServeMux \u3002 \u4ec5\u5f53\u4fa6\u542c\u5668\u8fd4\u56de * tls.Conn \u8fde\u63a5\u5e76\u4e14\u5728 TLS Config.NextProtos \u4e2d\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a \"h2\" \u65f6\uff0c\u624d\u542f\u7528HTTP/2\u652f\u6301\u3002 Serve \u59cb\u7ec8\u8fd4\u56de\u975enil\u9519\u8bef\u3002 func ServeContent func ServeContent(w ResponseWriter, req *Request, name string, modtime time.Time, content io.ReadSeeker) ServeContent \u4f7f\u7528\u63d0\u4f9b\u7684 ReadSeeker \u4e2d\u7684\u5185\u5bb9\u56de\u590d\u8bf7\u6c42\u3002 ServeContent \u4f18\u4e8e io.Copy \u7684\u4e3b\u8981\u597d\u5904\u662f\u5b83\u53ef\u4ee5\u6b63\u786e\u5904\u7406 Range \u8bf7\u6c42\uff0c\u8bbe\u7f6e MIME \u7c7b\u578b\u5e76\u5904\u7406 If-Match \uff0c If-Unmodified-Since \uff0c If-None-Match \uff0c If-Modified-Since \u548c If-Range \u8bf7\u6c42\u3002 \u5982\u679c\u672a\u8bbe\u7f6e\u54cd\u5e94\u7684 Content-Type \u6807\u5934\uff0c\u5219 ServeContent \u9996\u5148\u5c1d\u8bd5\u4ece\u540d\u79f0\u7684\u6587\u4ef6\u6269\u5c55\u540d\u4e2d\u63a8\u65ad\u51fa\u7c7b\u578b\uff0c\u5982\u679c\u5931\u8d25\uff0c\u5219\u9000\u56de\u5230\u8bfb\u53d6\u5185\u5bb9\u7684\u7b2c\u4e00\u5757\u5e76\u5c06\u5176\u4f20\u9012\u7ed9 DetectContentType \u3002\u5426\u5219\u8be5\u540d\u79f0\u672a\u4f7f\u7528\u3002\u7279\u522b\u662f\u5b83\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5e76\u4e14\u6c38\u8fdc\u4e0d\u4f1a\u5728\u54cd\u5e94\u4e2d\u53d1\u9001\u3002 \u5982\u679c modtime \u4e0d\u662f\u96f6\u65f6\u95f4\u6216Unix\u65f6\u671f\uff0c\u5219 ServeContent \u4f1a\u5c06\u5176\u5305\u542b\u5728\u54cd\u5e94\u7684 Last-Modified \u5934\u4e2d\u3002\u5982\u679c\u8bf7\u6c42\u4e2d\u5305\u542b If-Modified-Since \u6807\u5934\uff0c\u5219 ServeContent \u4f7f\u7528 modtime \u6765\u51b3\u5b9a\u662f\u5426\u9700\u8981\u53d1\u9001\u5185\u5bb9\u3002 \u5185\u5bb9\u7684Seek\u65b9\u6cd5\u5fc5\u987b\u8d77\u4f5c\u7528\uff1aServeContent\u4f7f\u7528\u5bf9\u5185\u5bb9\u7ed3\u5c3e\u7684\u67e5\u627e\u6765\u786e\u5b9a\u5176\u5927\u5c0f\u3002 \u5982\u679c\u8c03\u7528\u65b9\u8bbe\u7f6e\u4e86\u6309\u7167 RFC 7232\u7b2c2.3\u8282 \u683c\u5f0f\u5316\u7684w\u7684ETag\u6807\u5934\uff0c\u5219ServeContent\u4f7f\u7528\u5b83\u6765\u5904\u7406\u4f7f\u7528If-Match\uff0cIf-None-Match\u6216If-Range\u7684\u8bf7\u6c42\u3002 \u8bf7\u6ce8\u610f\uff0c* os.File\u5b9e\u73b0\u4e86io.ReadSeeker\u63a5\u53e3\u3002","title":"package http"},{"location":"Language/Library/net/http/#package-http","text":"import net/http http\u5305\u63d0\u4f9bHTTP\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u5b9e\u73b0\u3002 Get\u3001Head\u3001Post\u548cPostForm\u53d1\u8d77HTTP\uff08\u6216HTTPS\uff09\u8bf7\u6c42\uff1a resp , err := http.Get( http://example.com/ ) ... resp, err := http.Post( http://example.com/upload , image/jpeg , buf) ... resp, err := http.PostForm( http://example.com/form ,url.Values{ Key :{ Value }, id :{ 123 }}) \u7ed3\u675f\u540e\uff0c\u5ba2\u6237\u7aef\u5fc5\u987b\u5173\u95ed\u54cd\u5e94\u4f53\uff1a resp, err := http.Get( http://example.com ) if err != nil { // handle error } defer resp.Body.Close() body, err := ioutil.ReadAll(resp.Body) \u60f3\u8981\u63a7\u5236HTTP\u5ba2\u6237\u7aef\u7684\u5934\u3001\u91cd\u5b9a\u5411\u7b56\u7565\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a Client \uff1a client := http.Client{ CheckRedirect: redirectPolicyFunc, } resp, err := client.Get( http://example.com ) // ... req, err := http,NewRequest( GET , http://example.com ,nil) // ... req.Header.Add( if-None-Match ,`W/ wyzzy `) resp, err := client.Do(req) // ... \u60f3\u8981\u63a7\u5236\u4ee3\u7406\uff0cTLS\u914d\u7f6e\uff0ckeep-alive\uff0c\u538b\u7f29\u548c\u5176\u4ed6\u8bbe\u7f6e\uff0c\u9700\u8981\u521b\u5efa\u4e00\u4e2a Transport \uff1a tr := http.Transport{ MaxldleConns: 10, ldleConnTimeout: 30 * time.Second, DisableCompression: true, } client := http.Client{Transport: tr} resp, err := client.Get( https://example.com ) Client \u548c Transport \u53ef\u4ee5\u5b89\u5168\u5730\u88ab\u591a\u4e2a goroutine \u5e76\u53d1\u4f7f\u7528\uff0c\u4e3a\u4e86\u9ad8\u6548\u5e94\u8be5\u53ea\u521b\u5efa\u4e00\u6b21\u5e76\u91cd\u590d\u4f7f\u7528\u3002 ListenAndServe \u4f7f\u7528\u7ed9\u5b9a\u5730\u5740\u548c\u5904\u7406\u7a0b\u5e8f\u542f\u52a8\u4e00\u4e2aHTTP\u670d\u52a1\u7aef\u3002\u8fd9\u4e2a\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u662f nil ,\u8fd9\u8868\u793a\u4f7f\u7528 DefaultServeMux \u3002 Handle \u548c HandleFunc \u5c06\u5904\u7406\u7a0b\u5e8f\u6dfb\u52a0\u5230 DefaultServeMux : http.Handle( /foo \uff0cfooHandler) http.HandleFunc( /bar ,func(w http.ResponseWriter, r *http.Request){ fmt.Fprintf(w, Hello,%q ,html.EscapeString(r.URL,Path)) }) log.Fatal(http.ListenAndServe( :8080 ,nil)) \u521b\u5efa\u4e00\u4e2a\u81ea\u5b9a\u4e49\u7684Server\u6765\u66f4\u597d\u7684\u63a7\u5236server\u7684\u884c\u4e3a\uff1a s := http.Server{ Addr : :8080 , Handler: myHandler, ReadTimeout: 10 * time.Second, WriteTimeout: 10 * time.Second, MaxHeaderBytes: 1 20, } log.Fatal(s.ListenAndServe()) \u4eceGo 1.6\u5f00\u59cb\uff0c\u4f7f\u7528HTTPS\u65f6\uff0chttp\u5305\u5bf9HTTP/2\u534f\u8bae\u5177\u6709\u900f\u660e\u652f\u6301\u3002 \u5fc5\u987b\u7981\u7528HTTP/2\u7684\u7a0b\u5e8f\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e Transport.TLSNextProto(\u5ba2\u6237\u7aef\u8bbe\u7f6e) \u6216\u8005 Server.TLSNextProto (\u670d\u52a1\u7aef\u8bbe\u7f6e)\u7684\u503c\u4e3a\u975enil\u7684\u7a7amap\u3002\u6216\u8005\uff0c\u5f53\u524d\u652f\u6301\u5982\u4e0b\u7684 GODEBUG \u73af\u5883\u53d8\u91cf\uff1a GODEBUG=http2client=0 // \u7981\u7528HTTP/2\u5ba2\u6237\u7aef\u652f\u6301 GODEBUG=http2server=0 // \u7981\u7528HTTP/2\u670d\u52a1\u7aef\u652f\u6301 GODEBUG=http2debug=1 // \u542f\u52a8\u8be6\u7ec6\u7684HTTP/2 \u8c03\u8bd5\u65e5\u5fd7 GODEBUG=http2debug=2 // \u66f4\u8be6\u7ec6\u7684\u65e5\u5fd7\uff0c\u5305\u542b frame dumps Go\u7684API\u517c\u5bb9\u6027\u4fdd\u8bc1\u4e0d\u6db5\u76d6GODEBUG\u53d8\u91cf\u3002\u5728\u7981\u7528HTTP / 2\u652f\u6301\u4e4b\u524d\uff0c\u8bf7\u62a5\u544a\u6240\u6709\u95ee\u9898\uff1a https://golang.org/s/http2bug \u4e3a\u4e86\u7b80\u5316\u914d\u7f6e http \u5305\u4e2d\u7684 Transport \u548c Server \u90fd\u81ea\u5b9a\u542f\u52a8HTTP/2\u652f\u6301\u3002\u8981\u4e3a\u66f4\u590d\u6742\u7684\u914d\u7f6e\u542f\u7528HTTP/2\uff0c\u4ee5\u4f7f\u7528\u4f4e\u7ea7\u522bHTTP/2\u529f\u80fd\u6216\u4f7f\u7528Go\u7684http2\u8f6f\u4ef6\u5305\u7684\u65b0\u7248\u672c\uff0c\u8bf7\u76f4\u63a5\u5bfc\u5165 golang.org/x/net/http2 \u5e76\u4f7f\u7528\u5176 ConfigureTransport \u548c / \u6216 ConfigureServer \u529f\u80fd\u3002\u901a\u8fc7 golang.org/x/net/http2 \u5305\u624b\u52a8\u914d\u7f6eHTTP/2\u4f18\u5148\u4e8enet/http\u5305\u7684\u5185\u7f6eHTTP/2\u652f\u6301\u3002","title":"package http"},{"location":"Language/Library/net/http/#constants","text":"const( MethodGet = GET MethodHead = HEAD MethodPost = POST MethodPut = PUT MethodPath = PATCH // RFC 5789 MethodDelete = DELETE MethodConnect = CONNECT MethodOPtions = OPTIONS MethodTrace = TRACE ) \u5e38\u89c1\u7684HTTP\u65b9\u6cd5\u3002 \u9664\u975e\u53e6\u6709\u8bf4\u660e\uff0c\u5426\u5219\u5b83\u4eec\u5728 RFC 7231\u7b2c4.3\u8282 \u4e2d\u5b9a\u4e49\u3002 const ( StatusContinue = 100 // RFC 7231, 6.2.1 StatusSwitchingProtocols = 101 // RFC 7231, 6.2.2 StatusProcessing = 102 // RFC 2518, 10.1 StatusEarlyHints = 103 // RFC 8297 StatusOK = 200 // RFC 7231, 6.3.1 StatusCreated = 201 // RFC 7231, 6.3.2 StatusAccepted = 202 // RFC 7231, 6.3.3 StatusNonAuthoritativeInfo = 203 // RFC 7231, 6.3.4 StatusNoContent = 204 // RFC 7231, 6.3.5 StatusResetContent = 205 // RFC 7231, 6.3.6 StatusPartialContent = 206 // RFC 7233, 4.1 StatusMultiStatus = 207 // RFC 4918, 11.1 StatusAlreadyReported = 208 // RFC 5842, 7.1 StatusIMUsed = 226 // RFC 3229, 10.4.1 StatusMultipleChoices = 300 // RFC 7231, 6.4.1 StatusMovedPermanently = 301 // RFC 7231, 6.4.2 StatusFound = 302 // RFC 7231, 6.4.3 StatusSeeOther = 303 // RFC 7231, 6.4.4 StatusNotModified = 304 // RFC 7232, 4.1 StatusUseProxy = 305 // RFC 7231, 6.4.5 StatusTemporaryRedirect = 307 // RFC 7231, 6.4.7 StatusPermanentRedirect = 308 // RFC 7538, 3 StatusBadRequest = 400 // RFC 7231, 6.5.1 StatusUnauthorized = 401 // RFC 7235, 3.1 StatusPaymentRequired = 402 // RFC 7231, 6.5.2 StatusForbidden = 403 // RFC 7231, 6.5.3 StatusNotFound = 404 // RFC 7231, 6.5.4 StatusMethodNotAllowed = 405 // RFC 7231, 6.5.5 StatusNotAcceptable = 406 // RFC 7231, 6.5.6 StatusProxyAuthRequired = 407 // RFC 7235, 3.2 StatusRequestTimeout = 408 // RFC 7231, 6.5.7 StatusConflict = 409 // RFC 7231, 6.5.8 StatusGone = 410 // RFC 7231, 6.5.9 StatusLengthRequired = 411 // RFC 7231, 6.5.10 StatusPreconditionFailed = 412 // RFC 7232, 4.2 StatusRequestEntityTooLarge = 413 // RFC 7231, 6.5.11 StatusRequestURITooLong = 414 // RFC 7231, 6.5.12 StatusUnsupportedMediaType = 415 // RFC 7231, 6.5.13 StatusRequestedRangeNotSatisfiable = 416 // RFC 7233, 4.4 StatusExpectationFailed = 417 // RFC 7231, 6.5.14 StatusTeapot = 418 // RFC 7168, 2.3.3 StatusMisdirectedRequest = 421 // RFC 7540, 9.1.2 StatusUnprocessableEntity = 422 // RFC 4918, 11.2 StatusLocked = 423 // RFC 4918, 11.3 StatusFailedDependency = 424 // RFC 4918, 11.4 StatusTooEarly = 425 // RFC 8470, 5.2. StatusUpgradeRequired = 426 // RFC 7231, 6.5.15 StatusPreconditionRequired = 428 // RFC 6585, 3 StatusTooManyRequests = 429 // RFC 6585, 4 StatusRequestHeaderFieldsTooLarge = 431 // RFC 6585, 5 StatusUnavailableForLegalReasons = 451 // RFC 7725, 3 StatusInternalServerError = 500 // RFC 7231, 6.6.1 StatusNotImplemented = 501 // RFC 7231, 6.6.2 StatusBadGateway = 502 // RFC 7231, 6.6.3 StatusServiceUnavailable = 503 // RFC 7231, 6.6.4 StatusGatewayTimeout = 504 // RFC 7231, 6.6.5 StatusHTTPVersionNotSupported = 505 // RFC 7231, 6.6.6 StatusVariantAlsoNegotiates = 506 // RFC 2295, 8.1 StatusInsufficientStorage = 507 // RFC 4918, 11.5 StatusLoopDetected = 508 // RFC 5842, 7.2 StatusNotExtended = 510 // RFC 2774, 7 StatusNetworkAuthenticationRequired = 511 // RFC 6585, 6 ) \u6ce8\u518c\u5728IANA\u4e0a\u7684HTTP\u72b6\u6001\u7801\uff0c\u67e5\u770b\uff1a https://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml const DefaultMaxHeaderBytes = 1 20 // 1 MB DefaultMaxHeaderBytes \u662fHTTP\u8bf7\u6c42\u5934\u7684\u6700\u5927\u5141\u8bb8\u5927\u5c0f\u3002\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e Server.MaxHeaderBytes \u6765\u8986\u76d6\u5b83\u3002 const DefaultMaxIdleConnsPerHost = 2 DefaultMaxIdleConnsPerHost \u662f Transport \u7684 MaxIdleConnsPerHost \u7684\u9ed8\u8ba4\u503c\u3002 const TimeFormat = Mon, 02 Jan 2006 15:04:05 GMT TimeFormat \u662f\u5728HTTP\u6807\u5934\u4e2d\u751f\u6210\u65f6\u95f4\u65f6\u8981\u4f7f\u7528\u7684\u65f6\u95f4\u683c\u5f0f\u3002\u5c31\u50cf time.RFC1123 \u4e00\u6837\uff0c\u4f46\u662f\u5c06GMT\u786c\u7f16\u7801\u4e3a\u65f6\u533a\u3002\u683c\u5f0f\u5316\u65f6\u95f4\u5fc5\u987b\u91c7\u7528UTC\u683c\u5f0f\u624d\u80fd\u751f\u6210\u6b63\u786e\u7684\u683c\u5f0f\u3002 \u6709\u5173\u89e3\u6790\u6b64\u65f6\u95f4\u683c\u5f0f\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u89c1 ParseTime \u3002 const TrailerPrefix = Trailer: TrailerPrefix \u662f ResponseWriter.Header \u7684map\u7684\u952e\u7684\u524d\u7f00\uff08\u5982\u679c\u5b58\u5728\u7684\u8bdd\uff09\uff0c\u8868\u793amap\u6761\u76ee\u5b9e\u9645\u4e0a\u662f\u7528\u4e8e\u54cd\u5e94\u5c3e\u90e8\u7684\uff0c\u800c\u4e0d\u662f\u54cd\u5e94\u5934\u7684\u3002 ServeHTTP \u8c03\u7528\u5b8c\u6210\u540e\uff0c\u524d\u7f00\u5c06\u88ab\u5220\u9664\uff0c\u5e76\u4e14\u503c\u5c06\u5728\u5c3e\u90e8\u4e2d\u53d1\u9001\u3002 \u6b64\u673a\u5236\u4ec5\u9002\u7528\u4e8e\u5728\u5199\u5165\u6807\u5934\u4e4b\u524d\u672a\u77e5\u7684\u5c3e\u90e8\u3002\u5982\u679c\u5728\u5199\u6807\u5934\u4e4b\u524d\u56fa\u5b9a\u7684\u6216\u5df2\u77e5\u7684\u5c3e\u90e8\u7ec4\uff0c\u5219\u9996\u9009\u666e\u901a\u7684Go\u5c3e\u90e8\u673a\u5236\uff1a https://golang.org/pkg/net/http/#ResponseWriter https://golang.org/pkg/net/http/#example_ResponseWriter_trailers","title":"Constants"},{"location":"Language/Library/net/http/#variables","text":"var ( // ErrNotSupported \u662f\u7531Pusher\u7684Push\u65b9\u6cd5\u8fd4\u56de\u7684\uff0c\u8868\u793a\u4e0d\u53ef\u83b7\u5f97\u5bf9HTTP/2\u7684\u652f\u6301 ErrNotSupported = ProtocolError{ feature not supported } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrUnexpectedTrailer // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrUnexpectedTrailer = ProtocolError{ trailer header without chunked transfer encoding } // \u5f53\u8bf7\u6c42\u7684 Content-Type \u4e0d\u5305\u542b\u4e00\u4e2a\u201cboundary\u201d\u53c2\u6570\u65f6\uff0cRequest.MultipartReader \u8fd4\u56de ErrMissingBoundary ErrMissingBoundary = ProtocolError{ no multipart boundary param in Content-Type } // \u5f53\u8bf7\u6c42\u7684 Content-Type \u4e0d\u662f multipart/form-data \u65f6\uff0cRequest.MultipartReader \u8fd4\u56de ErrNotMultipart ErrNotMultipart = ProtocolError{ request Content-Type isn't multipart/form-data } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrHeaderTooLong // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrHeaderTooLong = ProtocolError{ header too long } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrShortBody // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrShortBody = ProtocolError{ entity body too short } // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrMissingContentLength // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrMissingContentLength = ProtocolError{ missing ContentLength in HEAD response } ) var ( // HTTP\u65b9\u6cd5\u6216\u54cd\u5e94\u4ee3\u7801\u4e0d\u5141\u8bb8body\u65f6\uff0cResponseWriter.Write\u8c03\u7528\u8fd4\u56deErrBodyNotAllowed ErrBodyNotAllowed = errors.New( http: request method or response status code does not allow body ) // \u5f53\u4f7f\u7528Hijacker\u63a5\u53e3\u65f6\u57fa\u7840\u8fde\u63a5\u88ab\u52ab\u6301\uff0cResponseWriter.Write \u8fd4\u56de ErrHijacked // \u5728\u88ab\u52ab\u6301\u7684\u8fde\u63a5\u4e0a\u8fdb\u884c\u96f6\u5b57\u8282\u5199\u5165\u5c06\u8fd4\u56deErrHijacked\uff0c\u800c\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5176\u4ed6\u526f\u4f5c\u7528 ErrHijacked = errors.New( http: connection has been hijacked ) // \u5f53 Handler \u4e3aContent-Length\u54cd\u5e94\u5934\u8bbe\u7f6e\u4e00\u4e2a\u957f\u5ea6\uff0c\u7136\u540e\u5c1d\u8bd5\u5199\u5165\u6bd4\u58f0\u660e\u66f4\u591a\u7684\u5b57\u8282\u65f6\uff0c // ResponseWriter.Write\u8c03\u7528\u8fd4\u56deErrContentLength ErrContentLength = errors.New( http: wrote more than the declared Content-Length ) // Deprecated // net/http\u5305\u4e2d\u7684\u4efb\u4f55\u65b9\u6cd5\u90fd\u4e0d\u4f1a\u518d\u8fd4\u56de ErrWriteAfterFlush // \u8c03\u7528\u8005\u4e0d\u5e94\u8be5\u5c06\u9519\u8bef\u4e0e\u8fd9\u4e2a\u53d8\u91cf\u8fdb\u884c\u6bd4\u8f83 ErrWriteAfterFlush = errors.New( unused ) ) HTTP\u670d\u52a1\u7aef\u4f7f\u7528\u7684\u9519\u8bef\u3002 var ( // ServerContextKey\u662f context key\u3002\u53ef\u4ee5\u5728\u5e26\u6709 Context.Value \u7684 HTTP handler \u4e2d // \u4f7f\u7528\u5b83\u6765\u8bbf\u95ee\u542f\u52a8 handler \u7684\u670d\u52a1\u5668 // \u5173\u8054\u7684\u503c\u5c06\u662f* Server\u7c7b\u578b ServerContextKey = contextKey{ http-server } // LocalAddrContextKey\u662fcontext key\u3002 \u53ef\u4ee5\u5728\u5e26\u6709Context.Value\u7684HTTP handler\u4e2d\u4f7f\u7528\u5b83\u6765\u8bbf\u95ee\u8fde\u63a5\u7684\u672c\u5730\u5730\u5740 // \u5173\u8054\u7684\u503c\u5c06\u4e3anet.Addr\u7c7b\u578b\u3002 LocalAddrContextKey = contextKey{ local-addr } ) var DefaultClient = Client{} DefaultClient\u662f\u9ed8\u8ba4\u5ba2\u6237\u7aef\uff0c\u7531Get\uff0cHead\u548cPost\u4f7f\u7528\u3002 var DefaultServeMux = defaultServeMux DefaultServeMux\u662fServe\u4f7f\u7528\u7684\u9ed8\u8ba4ServeMux\u3002 var ErrAbortHandler = errors.New( net/http: abort Handler ) ErrAbortHandler \u662f\u4e00\u4e2a\u4e2d\u6b62panic\u503c\uff0c\u7528\u4e8e\u4e2d\u6b62handler\u3002\u6765\u81eaServeHTTP\u7684\u4efb\u4f55panic\u90fd\u4f1a\u4e2d\u6b62\u5bf9\u5ba2\u6237\u7aef\u7684\u54cd\u5e94\uff0c\u4f46\u662f\u4f7f\u7528 ErrAbortHandler \u8fdb\u884cpanic\u4e5f\u4f1a\u6291\u5236\u5c06\u5806\u6808\u8ddf\u8e2a\u8bb0\u5f55\u5230\u670d\u52a1\u5668\u7684\u9519\u8bef\u65e5\u5fd7\u4e2d\u3002 var ErrBodyReadAfterClose = errors.New( http: invalid Read on closed Body ) \u5728\u5173\u95ed\u8bf7\u6c42\u6216\u54cd\u5e94\u4e3b\u4f53\u540e\uff0c\u8bfb\u53d6\u8bf7\u6c42\u6216\u54cd\u5e94\u4e3b\u4f53\u65f6\uff0c\u5c06\u8fd4\u56de ErrBodyReadAfterClose \u3002\u901a\u5e38\u5728HTTP\u5904\u7406\u7a0b\u5e8f\u5728\u5176 ResponseWriter \u4e0a\u8c03\u7528 WriteHeader \u6216 Write \u540e\u8bfb\u53d6\u6b63\u6587\u65f6\uff0c\u4f1a\u53d1\u751f\u8fd9\u79cd\u60c5\u51b5\u3002 var ErrHandlerTimeout = errors.New( http: Handler timeout )s \u5728\u5df2\u8d85\u65f6\u7684\u5904\u7406\u7a0b\u5e8f\u4e0a\u8fdb\u884c ResponseWriter \u7684Write\u8c03\u7528\u4f1a\u8fd4\u56de ErrHandlerTimeout \u3002 var ErrLineTooLong = internal.ErrLineTooLong \u8bfb\u53d6\u5206\u5757\u7f16\u7801\u5f02\u5e38\u7684\u8bf7\u6c42\u6216\u54cd\u5e94\u4f53\u65f6\uff0c\u5c06\u8fd4\u56de ErrLineTooLong \u3002 var ErrMissingFile = errors.New( http: no such file ) \u5f53\u63d0\u4f9b\u7684\u6587\u4ef6\u5b57\u6bb5\u4e0d\u5b58\u5728\u4e8e\u8bf7\u6c42\u4e2d\u6216\u8005\u5b83\u4e0d\u662f\u4e00\u4e2a\u6587\u4ef6\u5b57\u6bb5\u4e2d\u65f6\uff0cFormFile\u8fd4\u56de ErrMissingFile \u3002 var ErrNoCookie = errors.New( http: named cookie not present ) \u672a\u627e\u5230Cookie\u65f6\uff0cRequest\u7684Cookie\u65b9\u6cd5\u5c06\u8fd4\u56de ErrNoCookie \u3002 var ErrNoLocation = errors.New( http: no Location header in response ) \u5982\u679c\u4e0d\u5b58\u5728Location\u6807\u5934\uff0c\u5219\u7531Response\u7684Location\u65b9\u6cd5\u8fd4\u56de ErrNoLocation \u3002 var ErrServerClosed = errors.New( http: Server closed ) \u8c03\u7528Shutdown\u6216Close\u4e4b\u540e\uff0c\u670d\u52a1\u5668\u7684Serve\uff0cServeTLS\uff0cListenAndServe\u548cListenAndServeTLS\u65b9\u6cd5\u8fd4\u56de ErrServerClosed \u3002 var ErrSkipAltProtocol = errors.New( net/http: skip alternate protocol ) ErrSkipAltProtocol \u662f\u7531 Transport.RegisterProtocol \u5b9a\u4e49\u7684\u6807\u8bb0\u9519\u8bef\u503c\u3002 var ErrUseLastResponse = errors.New( net/http: use last response ) Client.CheckRedirect hooks \u53ef\u4ee5\u8fd4\u56de ErrUseLastResponse \uff0c\u4ee5\u63a7\u5236\u5982\u4f55\u5904\u7406\u91cd\u5b9a\u5411\u3002\u5982\u679c\u8fd4\u56de\uff0c\u5219\u4e0d\u53d1\u9001\u4e0b\u4e00\u4e2a\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd4\u56de\u6700\u8fd1\u7684\u54cd\u5e94\uff0c\u4e14\u5176\u4e3b\u4f53\u672a\u5173\u95ed\u3002 var NoBody = noBody{} NoBody \u662f\u4e00\u4e2a\u6ca1\u6709\u5b57\u8282\u7684 io.ReadCloser \u3002\u8bfb\u53d6\u59cb\u7ec8\u8fd4\u56deEOF\uff0c\u800c\u5173\u95ed\u59cb\u7ec8\u8fd4\u56denil\u3002\u53ef\u4ee5\u5728\u4f20\u51fa\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e2d\u4f7f\u7528\u5b83\u6765\u660e\u786e\u8868\u793a\u8bf7\u6c42\u7684\u5b57\u8282\u6570\u4e3a\u96f6\u3002\u4e5f\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u5c06 Request.Body \u8bbe\u7f6e\u4e3anil\u3002","title":"Variables"},{"location":"Language/Library/net/http/#_1","text":"","title":"\u51fd\u6570"},{"location":"Language/Library/net/http/#func-canonicalheaderkey","text":"func CanonicalHeaderKey(s string) string CanonicalHeaderKey \u8fd4\u56deheader key s \u7684\u89c4\u8303\u683c\u5f0f\u3002\u89c4\u8303\u5316\u5c06\u7b2c\u4e00\u4e2a\u5b57\u6bcd\u548c\u8fde\u5b57\u7b26\u540e\u7684\u4efb\u4f55\u5b57\u6bcd\u8f6c\u6362\u4e3a\u5927\u5199\uff1b\u5176\u4f59\u7684\u5c06\u8f6c\u6362\u4e3a\u5c0f\u5199\u3002\u4f8b\u5982\uff0c\"accept-encoding\"\u7684\u89c4\u8303\u683c\u5f0f\u662f\"Accept-Encoding\"\u3002\u5982\u679c`s``\u5305\u542b\u7a7a\u683c\u6216\u65e0\u6548\u7684header field bytes\uff0c\u5219\u8fd4\u56de\u5b83\u800c\u65e0\u9700\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002","title":"func CanonicalHeaderKey"},{"location":"Language/Library/net/http/#func-detectcontenttype","text":"func DetectContentType(data []byte) string DetectContentType \u5b9e\u73b0\u5728 https://mimesniff.spec.whatwg.org/ \u4e0a\u63cf\u8ff0\u7684\u7b97\u6cd5\uff0c\u4ee5\u786e\u5b9a\u7ed9\u5b9a\u6570\u636e\u7684 Content-Type \u3002\u5b83\u6700\u591a\u8003\u8651\u524d512\u4e2a\u5b57\u8282\u7684\u6570\u636e\u3002 DetectContentType \u59cb\u7ec8\u8fd4\u56de\u6709\u6548\u7684 MIME \u7c7b\u578b\uff1a\u5982\u679c\u65e0\u6cd5\u786e\u5b9a\u66f4\u5177\u4f53\u7684\u7c7b\u578b\uff0c\u5219\u8fd4\u56de \"application/octet-stream\" \u3002","title":"func DetectContentType"},{"location":"Language/Library/net/http/#func-error","text":"func Error(w ResponseWriter, error string, code int) Error\u56de\u590d\u5e26\u6709\u7279\u5b9a\u9519\u8bef\u6d88\u606f\u548cHTTP\u4ee3\u7801\u7684\u8bf7\u6c42\u3002\u5426\u5219\uff0c\u5b83\u4e0d\u4f1a\u7ed3\u675f\u8bf7\u6c42\uff1b\u8c03\u7528\u8005\u5e94\u786e\u4fdd\u4e0d\u518d\u5bf9 w \u8fdb\u884c\u5199\u64cd\u4f5c\u3002\u9519\u8bef\u6d88\u606f\u5e94\u4e3a\u7eaf\u6587\u672c\u3002","title":"func Error"},{"location":"Language/Library/net/http/#func-handle","text":"func Handle(pattern string, handler Handler) Handle \u5728 DefaultServeMux \u4e2d\u6ce8\u518c\u7ed9\u5b9a\u6a21\u5f0f\u7684\u5904\u7406\u7a0b\u5e8f\u3002 ServeMux \u7684\u6587\u6863\u8bf4\u660e\u4e86\u5982\u4f55\u5339\u914d\u6a21\u5f0f\u3002","title":"func Handle"},{"location":"Language/Library/net/http/#handler-example","text":"package main import ( fmt log net/http sync ) type countHander struct{ mu sync.Mutex // guards n n int } func (h *countHandler) ServeHTTP(w http.ResponseWriter, r *http.Request){ h.mu.Lock() defer h.mu.Unlock() h.n++ fmt.Fprintf(w, count is %d\\n ,h.n) } func main(){ http.Handle( /count ,new(countHandler)) log.Fatal(http.ListenAndServe( :8080 ,nil)) }","title":"handler-example"},{"location":"Language/Library/net/http/#func-handlefunc","text":"func HandleFunc(pattern string, handler func(ResponseWriter, *Request)) HandleFunc \u5728 DefaultServeMux \u4e2d\u6ce8\u518c\u7ed9\u5b9a\u6a21\u5f0f\u7684\u5904\u7406\u51fd\u6570\u3002 ServeMux \u7684\u6587\u6863\u8bf4\u660e\u4e86\u5982\u4f55\u5339\u914d\u6a21\u5f0f\u3002","title":"func HandleFunc"},{"location":"Language/Library/net/http/#handlerfunc-example","text":"h1 := func(w http.ResponseWriter, _ *http.Request){ io.WriteString(w, Hello from a HandleFunc #1!\\n ) } h2 := func(w http.ResponseWriter, _ *http.Request){ io.WriteString(w, Hello from a HandleFunc #2!\\n ) } http.HandleFunc( / , h1) http.HandleFunc( /endpoint , h2) log.Fatal(http.ListenAndServe( :8080 ,nil))","title":"handlerfunc-example"},{"location":"Language/Library/net/http/#func-listenandserve","text":"func ListenAndServe(addr string, handler Handler) error ListenAndServe \u4fa6\u542cTCP\u7f51\u7edc\u5730\u5740addr\uff0c\u7136\u540e\u8c03\u7528\u5e26\u6709\u5904\u7406\u7a0b\u5e8f\u7684Serve\u6765\u5904\u7406\u4f20\u5165\u8fde\u63a5\u4e0a\u7684\u8bf7\u6c42\u3002\u80fd\u591f\u63a5\u53d7\u7684\u8fde\u63a5\u9700\u8981\u914d\u7f6e\u4e3a\u542f\u7528TCP keep-alives\u3002 \u8be5\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u4e3anil\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f7f\u7528 DefaultServeMux \u3002 ListenAndServe \u59cb\u7ec8\u8fd4\u56de\u975enil\u9519\u8bef\u3002","title":"func ListenAndServe"},{"location":"Language/Library/net/http/#listenandserve-example","text":"helloHandler := func(w http.ResponseWriter, req *http.Request){ io.WriteString(w, Hello,world!\\n ) } http.HandlerFunc( /hello ,helloHandler) log.Fatal(http.ListenAndServe( :8080 ,nil))","title":"listenandserve-example"},{"location":"Language/Library/net/http/#func-listenandservetls","text":"func ListenAndServeTLS(addr, certFile, keyFile string, handler Handler) error ListenAndServeTLS \u7684\u884c\u4e3a\u4e0e ListenAndServe \u76f8\u540c\uff0c\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\u5b83\u9700\u8981 HTTPS \u8fde\u63a5\u3002\u6b64\u5916\uff0c\u5fc5\u987b\u63d0\u4f9b\u5305\u542b\u670d\u52a1\u5668\u8bc1\u4e66\u548c\u5339\u914d\u79c1\u94a5\u7684\u6587\u4ef6\u3002\u5982\u679c\u8bc1\u4e66\u662f\u7531\u8bc1\u4e66\u9881\u53d1\u673a\u6784\u7b7e\u540d\u7684\uff0c\u5219 certFile \u5e94\u8be5\u662f\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u4efb\u4f55\u4e2d\u95f4\u4ef6\u548cCA\u8bc1\u4e66\u7684\u4e32\u8054\u3002","title":"func ListenAndServeTLS"},{"location":"Language/Library/net/http/#listenandservetls-example","text":"http.HandlerFunc( / ,func(w http.ResponseWriter, req *http.Request){ io.WriteString(w, Hello,TLS!\\n ) }) // One can use generate_cert.go in crypto/tls to generate cert.pem and key.pem log.Printf( About to listen on 8443. Go to https://127.0,0.1:8443/ ) err := http.ListenAndServeTLS( :8443 , cert.pem , key.pem ,nil) log.Fatal(err)","title":"listenandservetls-example"},{"location":"Language/Library/net/http/#func-maxbytesreader","text":"func MaxBytesReader(w ResponseWriter, r io.ReadCloser, n int64) io.ReadCloser MaxBytesReader \u4e0e io.LimitReader \u76f8\u4f3c\uff0c\u4f46\u65e8\u5728\u9650\u5236\u4f20\u5165\u8bf7\u6c42\u4f53\u7684\u5927\u5c0f\u3002\u4e0e io.LimitReader \u76f8\u6bd4\uff0c MaxBytesReader \u7684\u7ed3\u679c\u4e3a ReadCloser \uff0c\u5bf9\u4e8e\u8d85\u51fa\u9650\u5236\u7684Read\u8fd4\u56de\u975eEOF\u9519\u8bef\uff0c\u5e76\u5728\u8c03\u7528\u5176Close\u65b9\u6cd5\u65f6\u5173\u95ed\u5e95\u5c42reader\u3002 MaxBytesReader \u53ef\u4ee5\u9632\u6b62\u5ba2\u6237\u7aef\u610f\u5916\u6216\u6076\u610f\u53d1\u9001\u5927\u8bf7\u6c42\u5e76\u6d6a\u8d39\u670d\u52a1\u5668\u8d44\u6e90\u3002","title":"func MaxBytesReader"},{"location":"Language/Library/net/http/#func-notfound","text":"func NotFound(w ResponseWriter, r *Request) NotFound \u56de\u590d\u8bf7\u6c42\uff0c\u5e76\u663e\u793aHTTP 404 not found\u9519\u8bef\u3002","title":"func NotFound"},{"location":"Language/Library/net/http/#func-parsehttpversion","text":"func ParseHTTPVersion(vers string) (major, minor int, ok bool) ParseHTTPVersion \u89e3\u6790HTTP\u7248\u672c\u5b57\u7b26\u4e32\u3002 \"HTTP/1.0\" \u8fd4\u56de (1,0,true) \u3002","title":"func ParseHTTPVersion"},{"location":"Language/Library/net/http/#funcparsetime","text":"func ParseTime(text string) (t time.Time, err error) ParseTime \u89e3\u6790\u65f6\u95f4\u6807\u5934\uff08\u4f8b\u5982 Date: header \uff09\uff0c\u5c1d\u8bd5\u4f7f\u7528HTTP/1.1\u5141\u8bb8\u7684\u4e09\u79cd\u683c\u5f0f\uff1a TimeFormat \uff0c time.RFC850 \u548c time.ANSIC \u3002","title":"funcParseTime"},{"location":"Language/Library/net/http/#func-proxyfromenvironment","text":"func ProxyFromEnvironment(req *Request) (*url.URL, error) ProxyFromEnvironment \u8fd4\u56de\u7528\u4e8e\u7ed9\u5b9a\u8bf7\u6c42\u7684\u4ee3\u7406\u7684URL\uff0c\u5982\u73af\u5883\u53d8\u91cf HTTP_PROXY \uff0c HTTPS_PROXY \u548c NO_PROXY \uff08\u6216\u5176\u5c0f\u5199\u7248\u672c\uff09\u6240\u6307\u793a\u3002 \u5bf9\u4e8eHTTPS\u8bf7\u6c42\uff0cHTTPS_PROXY\u4f18\u5148\u4e8eHTTP_PROXY \u3002 \u73af\u5883\u503c\u53ef\u4ee5\u662f\u5b8c\u6574\u7684URL\u6216 \"host [:port]\" \uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5047\u5b9a\u4f7f\u7528\"http\"\u534f\u8bae\u3002\u5982\u679c\u503c\u7684\u683c\u5f0f\u4e0d\u540c\uff0c\u5219\u8fd4\u56de\u9519\u8bef\u3002 \u5982\u679c\u73af\u5883\u4e2d\u672a\u5b9a\u4e49\u4efb\u4f55\u4ee3\u7406\uff0c\u5219\u8fd4\u56denil URL\u548cnil\u9519\u8bef\uff0c\u6216\u8005\u4e0d\u5e94\u5c06\u4ee3\u7406\u7528\u4e8e\u8fd9\u6837\u7684\u8bf7\u6c42\uff08\u5982 NO_PROXY \u6240\u5b9a\u4e49\uff09\u3002 \u5728\u7279\u6b8a\u60c5\u51b5\u4e0b\uff0c\u5982\u679c req.URL.Host \u4e3a \"localhost\" \uff08\u6709\u6216\u6ca1\u6709\u7aef\u53e3\u53f7\uff09\uff0c\u5219\u5c06\u8fd4\u56denil URL\u548cnil\u9519\u8bef\u3002","title":"func ProxyFromEnvironment"},{"location":"Language/Library/net/http/#func-proxyurl","text":"func ProxyURL(fixedURL *url.URL) func(*Request) (*url.URL, error) ProxyURL \u8fd4\u56de\u4e00\u4e2a\u4ee3\u7406\u51fd\u6570\uff08\u5728Transport\u4e2d\u4f7f\u7528\uff09\uff0c\u8be5\u51fd\u6570\u59cb\u7ec8\u8fd4\u56de\u76f8\u540cURL\u3002","title":"func ProxyURL"},{"location":"Language/Library/net/http/#func-redirect","text":"func Redirect(w ResponseWriter, r *Request, url string, code int) Redirect \u901a\u8fc7\u91cd\u5b9a\u5411\u5230URL\u6765\u54cd\u5e94\u8bf7\u6c42\uff0cURL\u53ef\u80fd\u662f\u76f8\u5bf9\u4e8e\u8bf7\u6c42\u8def\u5f84\u7684\u8def\u5f84\u3002 \u8fd4\u56de\u7684\u72b6\u6001\u7801\u5e94\u57283xx\u8303\u56f4\u5185\uff0c\u901a\u5e38\u4e3a StatusMovedPermanently \uff08301\uff09\uff0c StatusFound \uff08302\uff09\u6216 StatusSeeOther (303\uff09\u3002 \u5982\u679c\u5c1a\u672a\u8bbe\u7f6e Content-Type \u6807\u5934\uff0c Redirect \u4f1a\u5c06\u5176\u8bbe\u7f6e\u4e3a \"text / html; charset = utf-8\" \u5e76\u7f16\u5199\u4e00\u4e2a\u5c0f\u7684HTML\u3002\u5c06 Content-Type \u6807\u5934\u8bbe\u7f6e\u4e3a\u4efb\u4f55\u503c\uff08\u5305\u62ecnil\uff09\u5c06\u7981\u7528\u8be5\u884c\u4e3a\u3002","title":"func Redirect"},{"location":"Language/Library/net/http/#func-serve","text":"func Serve(l net.Listener, handler Handler) error Serve \u63a5\u53d7\u4fa6\u542c\u5668 l \u4e0a\u4f20\u5165\u7684HTTP\u8fde\u63a5\uff0c\u4ece\u800c\u4e3a\u6bcf\u4e2a\u4fa6\u542c\u5668\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u670d\u52a1 goroutine \u3002\u670d\u52a1 goroutine \u8bfb\u53d6\u8bf7\u6c42\uff0c\u7136\u540e\u8c03\u7528\u5904\u7406\u7a0b\u5e8f\u4ee5\u56de\u590d\u8bf7\u6c42\u3002\u8be5\u5904\u7406\u7a0b\u5e8f\u901a\u5e38\u4e3anil\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5c06\u4f7f\u7528 DefaultServeMux \u3002 \u4ec5\u5f53\u4fa6\u542c\u5668\u8fd4\u56de * tls.Conn \u8fde\u63a5\u5e76\u4e14\u5728 TLS Config.NextProtos \u4e2d\u5c06\u5b83\u4eec\u914d\u7f6e\u4e3a \"h2\" \u65f6\uff0c\u624d\u542f\u7528HTTP/2\u652f\u6301\u3002 Serve \u59cb\u7ec8\u8fd4\u56de\u975enil\u9519\u8bef\u3002","title":"func Serve"},{"location":"Language/Library/net/http/#func-servecontent","text":"func ServeContent(w ResponseWriter, req *Request, name string, modtime time.Time, content io.ReadSeeker) ServeContent \u4f7f\u7528\u63d0\u4f9b\u7684 ReadSeeker \u4e2d\u7684\u5185\u5bb9\u56de\u590d\u8bf7\u6c42\u3002 ServeContent \u4f18\u4e8e io.Copy \u7684\u4e3b\u8981\u597d\u5904\u662f\u5b83\u53ef\u4ee5\u6b63\u786e\u5904\u7406 Range \u8bf7\u6c42\uff0c\u8bbe\u7f6e MIME \u7c7b\u578b\u5e76\u5904\u7406 If-Match \uff0c If-Unmodified-Since \uff0c If-None-Match \uff0c If-Modified-Since \u548c If-Range \u8bf7\u6c42\u3002 \u5982\u679c\u672a\u8bbe\u7f6e\u54cd\u5e94\u7684 Content-Type \u6807\u5934\uff0c\u5219 ServeContent \u9996\u5148\u5c1d\u8bd5\u4ece\u540d\u79f0\u7684\u6587\u4ef6\u6269\u5c55\u540d\u4e2d\u63a8\u65ad\u51fa\u7c7b\u578b\uff0c\u5982\u679c\u5931\u8d25\uff0c\u5219\u9000\u56de\u5230\u8bfb\u53d6\u5185\u5bb9\u7684\u7b2c\u4e00\u5757\u5e76\u5c06\u5176\u4f20\u9012\u7ed9 DetectContentType \u3002\u5426\u5219\u8be5\u540d\u79f0\u672a\u4f7f\u7528\u3002\u7279\u522b\u662f\u5b83\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5e76\u4e14\u6c38\u8fdc\u4e0d\u4f1a\u5728\u54cd\u5e94\u4e2d\u53d1\u9001\u3002 \u5982\u679c modtime \u4e0d\u662f\u96f6\u65f6\u95f4\u6216Unix\u65f6\u671f\uff0c\u5219 ServeContent \u4f1a\u5c06\u5176\u5305\u542b\u5728\u54cd\u5e94\u7684 Last-Modified \u5934\u4e2d\u3002\u5982\u679c\u8bf7\u6c42\u4e2d\u5305\u542b If-Modified-Since \u6807\u5934\uff0c\u5219 ServeContent \u4f7f\u7528 modtime \u6765\u51b3\u5b9a\u662f\u5426\u9700\u8981\u53d1\u9001\u5185\u5bb9\u3002 \u5185\u5bb9\u7684Seek\u65b9\u6cd5\u5fc5\u987b\u8d77\u4f5c\u7528\uff1aServeContent\u4f7f\u7528\u5bf9\u5185\u5bb9\u7ed3\u5c3e\u7684\u67e5\u627e\u6765\u786e\u5b9a\u5176\u5927\u5c0f\u3002 \u5982\u679c\u8c03\u7528\u65b9\u8bbe\u7f6e\u4e86\u6309\u7167 RFC 7232\u7b2c2.3\u8282 \u683c\u5f0f\u5316\u7684w\u7684ETag\u6807\u5934\uff0c\u5219ServeContent\u4f7f\u7528\u5b83\u6765\u5904\u7406\u4f7f\u7528If-Match\uff0cIf-None-Match\u6216If-Range\u7684\u8bf7\u6c42\u3002 \u8bf7\u6ce8\u610f\uff0c* os.File\u5b9e\u73b0\u4e86io.ReadSeeker\u63a5\u53e3\u3002","title":"func ServeContent"},{"location":"Language/Library/net/rpc/","text":"rpc import net/rpc rpc\u5305\u63d0\u4f9b\u5bf9\u901a\u8fc7\u7f51\u7edc\u6216\u5176\u4ed6I/O\u8fde\u63a5\u7684\u5bf9\u8c61\u5bfc\u51fa\u65b9\u6cd5\u7684\u8bbf\u95ee\u3002\u670d\u52a1\u7aef\u6ce8\u518c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u5b83\u4f5c\u4e3a\u5177\u6709\u5bf9\u8c61\u7c7b\u578b\u540d\u79f0\u7684\u670d\u52a1\u800c\u53ef\u89c1\u3002\u5728\u6ce8\u518c\u4e4b\u540e\uff0c\u5bf9\u8c61\u7684\u5bfc\u51fa\u65b9\u6cd5\u53ef\u4ee5\u88ab\u8fdc\u7a0b\u8bbf\u95ee\u3002\u670d\u52a1\u7aef\u53ef\u4ee5\u6ce8\u518c\u4e0d\u540c\u7c7b\u578b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0c\u4f46\u662f\u5982\u679c\u6ce8\u518c\u540c\u4e00\u7c7b\u578b\u7684\u591a\u4e2a\u5bf9\u8c61\u662f\u9519\u8bef\u7684\u3002 \u53ea\u6709\u6ee1\u8db3\u8fd9\u4e9b\u6807\u51c6\u7684\u65b9\u6cd5\u624d\u53ef\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u5176\u4ed6\u65b9\u6cd5\u5c06\u88ab\u5ffd\u7565\uff1a \u65b9\u6cd5\u7684\u7c7b\u578b\u662f\u5bfc\u51fa\u7684 \u65b9\u6cd5\u662f\u5bfc\u51fa\u7684 \u65b9\u6cd5\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u90fd\u662f\u5bfc\u51fa\u6216\u5185\u7f6e\u7c7b\u578b \u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u6307\u9488 \u65b9\u6cd5\u6709\u8fd4\u56deerror\u7c7b\u578b \u5b9e\u9645\u4e0a\uff0c\u8be5\u65b9\u6cd5\u770b\u8d77\u6765\u5e94\u8be5\u50cf\u8fd9\u6837\uff1a func (t *T) MethodName(argType T1, replyType *T2) error \u5176\u4e2dT1\u548cT2\u53ef\u4ee5\u901a\u8fc7 encoding/gob \u7f16\u7801\u3001\u5373\u4f7f\u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u89e3\u7801\u5668\uff0c\u8fd9\u4e9b\u8981\u6c42\u4e5f\u662f\u9002\u7528\u7684\u3002\uff08\u5728\u5c06\u6765\uff0c\u8fd9\u4e9b\u8981\u6c42\u53ef\u80fd\u4f1a\u5bf9\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668\u5f31\u5316\uff09\u3002 \u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u8868\u793a\u8c03\u7528\u65b9\u63d0\u4f9b\u7684\u53c2\u6570 \u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u8868\u793a\u8981\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u7684\u7ed3\u679c\u53c2\u6570 \u8be5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\uff08\u5982\u679c\u4e0d\u662fnil\uff09\u5c06\u4f5c\u4e3a\u5b57\u7b26\u4e32\u4f20\u9012\u56de\u6765\uff0c\u5ba2\u6237\u7aef\u5c06\u8ba4\u4e3a\u5b83\u662f\u7531 errors.New \u521b\u5efa\u7684\u3002\u5982\u679c\u6709\u9519\u8bef\u88ab\u8fd4\u56de\uff0c\u5219\u4e0d\u4f1a\u6709\u54cd\u5e94\u53c2\u6570\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002 \u670d\u52a1\u7aef\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 ServerConn \u6765\u5904\u7406\u5355\u4e2a\u8fde\u63a5\u4e0a\u7684\u8bf7\u6c42\u3002\u66f4\u5e38\u89c1\u7684\u60c5\u51b5\u662f\uff0c\u670d\u52a1\u7aef\u521b\u5efa\u4e00\u4e2a\u7f51\u7edc\u76d1\u542c\u5668\uff0c\u7136\u540e\u8c03\u7528 Accept \uff0c\u6216\u8005\u521b\u5efa\u4e00\u4e2aHTTP\u76d1\u542c\u5668\uff0c\u7136\u540e\u8c03\u7528 HandleHTTP \u548c http.Serve \u3002 \u60f3\u8981\u4f7f\u7528\u8be5\u670d\u52a1\u7684\u5ba2\u6237\u7aef\u4f1a\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u7136\u540e\u5728\u8fde\u63a5\u4e0a\u8c03\u7528 NewClient \u3002 Dial(DialHTTP) \u51fd\u6570\u4e3a\u539f\u59cb\u7f51\u7edc\u8fde\u63a5\uff08HTTP\u8fde\u63a5\uff09\u6267\u884c\u8fd9\u4e24\u4e2a\u6b65\u9aa4\uff0c\u7136\u540e\u5f97\u5230\u7684\u5ba2\u6237\u7aef\u5bf9\u8c61\u6709\u4e24\u4e2a\u65b9\u6cd5 Call \u548c Go \uff0c\u5b83\u4eec\u6307\u5b9a\u8981\u8c03\u7528\u7684\u670d\u52a1\u548c\u65b9\u6cd5\uff0c\u4e00\u4e2a\u4f20\u9012\u53c2\u6570\u7684\u6307\u9488\u548c\u4e00\u4e2a\u63a5\u6536\u7ed3\u679c\u53c2\u6570\u7684\u6307\u9488\u3002 Call\u65b9\u6cd5\uff1a\u7b49\u5f85\u8fdc\u7a0b\u8c03\u7528\u5b8c\u6210 Go\u65b9\u6cd5\uff1a\u5f02\u6b65\u542f\u52a8\u8c03\u7528\uff0c\u5e76\u4f7f\u7528 Call \u7ed3\u6784\u4f53\u4e2d\u7684 Done \u901a\u9053\u53d1\u51fa\u5b8c\u6210\u4fe1\u53f7 \u9664\u975e\u8bbe\u7f6e\u4e86\u663e\u5f0f\u7f16\u89e3\u7801\u5668\uff0c\u5426\u5219\u5c06\u4f7f\u7528 encoding/gob \u5305\u6765\u4f20\u8f93\u6570\u636e\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u670d\u52a1\u7aef\u5e0c\u671b\u5bfc\u51faArith\u7c7b\u578b\u7684\u5bf9\u8c61\uff1a package server import errors type Args struct { A, B int } type Quotient struct { Quo, Rem int } type Arith int func (t *Arith) Multiply(args *Args, reply *int) error { *reply = args.A * args.B return nil } func (t *Arith) Divide(args *Args, quo *Quotient) error { if args.B == 0 { return errors.New( divide by zero ) } quo.Quo = args.A / args.B quo.Rem = args.A % args.B return nil } \u670d\u52a1\u7aef\u8c03\u7528HTTP\u670d\u52a1\uff1a arith := new(Arith) rpc.Register(arith) rpc.HandleHTTP() l, e := net.Listen( tcp , :1234 ) if e != nil { log.Fatal( listen error: , e) } go http.Serve(l, nil) \u6b64\u65f6\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u670d\u52a1\u201cArith\u201d\u5e26\u6709\u65b9\u6cd5\u201cArith.Multiply\u201d\u548c\u201cArith.Divide\u201d\u3002\u8981\u8c03\u7528\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u5ba2\u6237\u7aef\u9996\u5148\u8981\u8fde\u63a5\u670d\u52a1\u7aef\uff1a client, err := rpc.DialHTTP( tcp , serverAddress + :1234 ) if err != nil { log.Fatal( dialing: , err) } \u7136\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u6267\u884c\u4e00\u6b21\u8fdc\u7a0b\u8c03\u7528\uff1a // Synchronous call args := server.Args{7,8} var reply int err = client.Call( Arith.Multiply , args, reply) if err != nil { log.Fatal( arith error: , err) } fmt.Printf( Arith: %d*%d=%d , args.A, args.B, reply) \u6216\u8005\uff1a // Asynchronous call quotient := new(Quotient) divCall := client.Go( Arith.Divide , args, quotient, nil) replyCall := -divCall.Done // will be equal to divCall // check errors, print, etc. \u670d\u52a1\u7aef\u5b9e\u73b0\u901a\u5e38\u4f1a\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u7b80\u5355\u7684\u7c7b\u578b\u5b89\u5168\u5305\u88c5\u5668\uff0c net/rpc \u5305\u5df2\u7ecf\u6682\u505c\uff0c\u4e0d\u4f1a\u5728\u63a5\u53d7\u65b0\u7279\u6027\u3002 Constants const ( // Defaults used by HandleHTTP DefaultRPCPath = /_goRPC_ DefaultDebugPath = /debug/rpc ) Variables var DefaultServer = NewServer() // DefaultServer\u662f *Server\u7684\u9ed8\u8ba4\u5b9e\u4f8b var ErrShutdown = errors.New( connection is shut down ) func Accpet func Accept(lis net.Listener) Accept\u63a5\u53d7\u76d1\u542c\u5668\u4e0a\u7684\u8fde\u63a5\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u4f20\u5165\u8fde\u63a5\u5411DefaultServer\u63d0\u4f9b\u8bf7\u6c42\u3002Accept\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u901a\u5e38\u8c03\u7528\u5219\u5728go\u8bed\u53e5\u4e2d\u8c03\u7528\u5b83\u3002 func HandleHTTP func HandleHTTP() HandleHTTP\u5728DefaultRPCPath\u4e0a\u4e3aRPC\u6d88\u606f\u6ce8\u518c\u4e00\u4e2aHTTP\u5904\u7406\u5668\u5230DefaultServer\u4e0a\uff0c\u5e76\u5728DefaultDebugPath\u4e0a\u6ce8\u518c\u4e00\u4e2a\u8c03\u8bd5\u5668\u3002\u4ecd\u7136\u9700\u8981\u8c03\u7528 http.Serve() \uff0c\u901a\u5e38\u4e5f\u662f\u5728go\u8bed\u53e5\u4e2d\u3002 func Register func Register(rcvr interface{}) error Register \u5728 DefaultServer \u4e2d\u53d1\u5e03\u63a5\u6536\u65b9\u7684\u65b9\u6cd5\u3002 func RegisterName func RegisterName(name string, rcvr interface{}) error Registername \u7c7b\u4f3c\u4e8e Register\uff0c\u4f46\u4f7f\u7528\u63d0\u4f9b\u7684\u7c7b\u578b\u540d\u79f0\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002 func ServeCodec func ServeCodec(codec ServerCodec) Servecodec \u7c7b\u4f3c\u4e8e ServeConn\uff0c\u4f46\u4f7f\u7528\u6307\u5b9a\u7684\u7f16\u89e3\u7801\u5668\u5bf9\u8bf7\u6c42\u8fdb\u884c\u89e3\u7801\u5e76\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801\u3002 func ServeConn func ServeConn(conn io.ReadWriteCloser) ServeConn\u5728\u5355\u4e2a\u8fde\u63a5\u4e0a\u8fd0\u884cDefaultServer\uff0cServeConn\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u5728\u5ba2\u6237\u7aef\u6302\u8d77\u4e4b\u524d\u4e3a\u8fde\u63a5\u63d0\u4f9b\u670d\u52a1\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528\u8005\u5728go\u8bed\u53e5\u4e2d\u8c03\u7528ServeConn\u3002ServeConn\u5728\u8fde\u63a5\u4e0a\u4f7f\u7528gob\u7f16\u7801\u683c\u5f0f\u3002\u82e5\u8981\u4f7f\u7528\u53e6\u5916\u7684\u7f16\u89e3\u7801\u5668\uff0c\u4f7f\u7528ServeCodec\u3002\u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u67e5\u770bNewClient\u7684\u6ce8\u91ca\u3002 func ServeRequest func ServeRequest(codec ServeCodec) error Serverequest \u7c7b\u4f3c\u4e8e ServeCodec\uff0c\u4f46\u540c\u6b65\u670d\u52a1\u4e8e\u5355\u4e2a\u8bf7\u6c42\u3002 \u5b83\u4e0d\u4f1a\u5728\u5b8c\u6210\u65f6\u5173\u95ed\u7f16\u89e3\u7801\u5668\u3002 type call type Call struct { ServiceMethod string // \u8981\u8c03\u7528\u7684\u670d\u52a1\u548c\u65b9\u6cd5\u7684\u540d\u79f0 Args interface{} // function (*struct)\u7684\u4f20\u5165\u53c2\u6570 Reply interface{} // function (*struct)\u7684\u8fd4\u56de\u7ed3\u679c Error error // \u5b8c\u6210\u540e\u7684\u9519\u8bef\u72b6\u6001 Done chan *Call // \u8c03\u7528\u7ed3\u675f\u540e\u53d1\u51fa\u6d88\u606f } Call \u8868\u793a\u4e00\u4e2a\u6d3b\u8dc3\u7684RPC\u3002 type Client type Client struct { codec ClientCodec reqMutex sync.Mutex // protects following request Request mutex sync.Mutex // protects following seq uint64 pending map[uint64]*Call closing bool // user has called Close shutdown bool // server has told us to stop } Client\u8868\u793a\u4e00\u4e2aRPC\u5ba2\u6237\u7aef\uff0c\u4e00\u4e2aClient\u53ef\u80fd\u6709\u591a\u4e2a\u672a\u5b8c\u6210\u7684\u8c03\u7528\uff0c\u4e00\u4e2aClient\u4e5f\u53ef\u80fd\u540c\u65f6\u88ab\u591a\u4e2agoroutine\u4f7f\u7528\u3002 func Dial func Dial(network, address string) (*Client, error) Dial\u6309\u7167\u5230\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u8fde\u63a5\u5230RPC\u670d\u52a1\u5668\u3002 func DialHTTP func DialHTTP(network, address string) (*Client, error) DialHTTP\u6309\u7167\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u8fde\u63a5\u5230HTTP RPC\u670d\u52a1\u5668\uff0c\u5e76\u76d1\u542c\u9ed8\u8ba4\u7684HTTP RPC \u8def\u5f84\u3002 func DialHTTPPath func DialHTTPPath(network, address, path string) (*Client, error) DialHTTPPath \u6309\u7167\u6307\u5b9a\u7684\u7f51\u7edc\u5730\u5740\u548c\u8def\u5f84\u8fde\u63a5\u5230 HTTP RPC \u670d\u52a1\u5668\u3002 func NewClient func NewClient(conn io.ReadWriteCloser) *Client Newclient \u8fd4\u56de\u4e00\u4e2a\u65b0 Client \u6765\u5904\u7406\u8fde\u63a5\u53e6\u4e00\u7aef\u7684\u670d\u52a1\u96c6\u53d1\u51fa\u7684\u8bf7\u6c42\u3002 \u5b83\u5411\u8fde\u63a5\u7684\u5199\u5165\u7aef\u6dfb\u52a0\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u4ee5\u4fbf\u5c06\u5934\u548c\u6709\u6548\u8d1f\u8f7d\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u53d1\u9001\u3002 \u8fde\u63a5\u7684\u8bfb\u53d6\u548c\u5199\u5165\u90e8\u5206\u662f\u72ec\u7acb\u4e32\u884c\u5316\u7684\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u5185\u8054\u9501\u3002 \u4f46\u662f\uff0c\u6bcf\u4e00\u90e8\u5206\u90fd\u53ef\u4ee5\u88ab\u5e76\u53d1\u7684\u8bbf\u95ee\uff0c\u56e0\u6b64 conn \u7684\u5b9e\u73b0\u5e94\u8be5\u80fd\u591f\u9632\u6b62\u5e76\u53d1\u8bfb\u6216\u5e76\u53d1\u5199\u3002 func NewClientWithCodec func NewClientWithCodec(codec ClientCodec) *Client Newclientwithcodec \u7c7b\u4f3c\u4e8e NewClient\uff0c\u4f46\u662f\u4f7f\u7528\u6307\u5b9a\u7684 codec \u5bf9\u8bf7\u6c42\u8fdb\u884c\u7f16\u7801\u5e76\u89e3\u7801\u54cd\u5e94\u3002 func (*Client) Call func (client *Client) Call(serviceMethod string, args interface{}, reply interface{}) error Call\u8c03\u7528\u6307\u5b9a\u540d\u5b57\u7684\u51fd\u6570\uff0c\u7b49\u5f85\u5b83\u5b8c\u6210\uff0c\u5e76\u8fd4\u56de\u5b83\u7684\u9519\u8bef\u72b6\u6001\u3002 func (*Client) Close func (client *Client) Close() error Close \u8c03\u7528\u5e95\u5c42\u7f16\u89e3\u7801\u5668\u7684 Close \u65b9\u6cd5\u3002 \u5982\u679c\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed\uff0c\u5219\u8fd4\u56de ErrShutdown\u3002 func (*Client) Go func (client *Client) Go(serviceMethod string, args interface{}, reply interface{}, done chan *Call) *Call Go \u4ee5\u5f02\u6b65\u65b9\u5f0f\u8c03\u7528\u51fd\u6570\u3002 \u5b83\u8fd4\u56de\u8868\u793a\u8c03\u7528\u7684 Call \u7ed3\u6784\u4f53\u3002 \u901a\u8fc7\u8fd4\u56de\u76f8\u540c\u7684 Call \u5bf9\u8c61\uff0cdone \u901a\u9053\u5c06\u5728\u8c03\u7528\u5b8c\u6210\u65f6\u53d1\u51fa\u4fe1\u53f7\u3002 \u5982\u679c done \u4e3a nil\uff0c\u5219 Go \u5c06\u5206\u914d\u4e00\u4e2a\u65b0\u7684\u901a\u9053\uff0c\u5982\u679c\u4e0d\u662fnil\uff0cdone\u5fc5\u7136\u5df2\u7ecf\u88ab\u586b\u5145\u5426\u5219Go\u5c06\u4f1a\u5954\u6e83\u3002 type ClientCodec type ClientCodec interface { WriteRequest(*Request, interface{}) error ReadResponseHeader(*Response) error ReadResponseBody(interface{}) error Close() error } Clientcodec \u5b9e\u73b0\u5728\u4e00\u4e2aRPC\u4f1a\u8bdd\u7684\u5ba2\u6237\u7aef\u4fa7\u5199\u5165RPC\u8bf7\u6c42\u548c\u8bfb\u53d6RPC\u54cd\u5e94\u3002\u5ba2\u6237\u7aef\u8c03\u7528 WriteRequest \u5411\u8fde\u63a5\u5199\u5165\u8bf7\u6c42\uff0c\u5e76\u6210\u5bf9\u8c03\u7528 ReadResponseHeader \u548c ReadResponseBody \u6765\u8bfb\u53d6\u54cd\u5e94\u3002 \u5f53\u8fde\u63a5\u7ed3\u675f\u65f6\uff0c\u5ba2\u6237\u7aef\u8c03\u7528 Close\u3002 \u53ef\u4ee5\u4f7f\u7528 nil \u53c2\u6570\u8c03\u7528 ReadResponseBody\uff0c\u4ee5\u5f3a\u5236\u8bfb\u53d6\u54cd\u5e94\u4e3b\u4f53\uff0c\u7136\u540e\u5c06\u5176\u4e22\u5f03\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002 type Request type Request struct { ServiceMethod string // format: Service.Method Seq uint64 // \u5ba2\u6237\u7aef\u9009\u62e9\u7684\u5e8f\u5217\u53f7 next *Request // \u670d\u52a1\u5668\u4e2d\u7684\u7a7a\u95f2\u5217\u8868 } Request \u662f\u5728\u6bcf\u4e2a RPC \u8c03\u7528\u4e4b\u524d\u5199\u5165\u7684\u8bf7\u6c42\u5934\u3002 \u5b83\u5728\u5185\u90e8\u4f7f\u7528\uff0c\u4f46\u5728\u8fd9\u91cc\u4f5c\u4e3a\u8c03\u8bd5\u7684\u5e2e\u52a9\u800c\u8bb0\u5f55\u5728\u6848\uff0c\u4f8b\u5982\u5728\u5206\u6790\u7f51\u7edc\u6d41\u91cf\u65f6\u3002 type Response type Response struct { ServiceMethod string // echoes that of the Request Seq uint64 // echoes that of the request Error string // error, if any. next *Response // for free list in Server } Response \u662f\u5728\u6bcf\u4e2a RPC \u8fd4\u56de\u4e4b\u524d\u5199\u5165\u7684\u54cd\u5e94\u5934\u3002 \u5b83\u5728\u5185\u90e8\u4f7f\u7528\uff0c\u4f46\u5728\u8fd9\u91cc\u4f5c\u4e3a\u8c03\u8bd5\u7684\u5e2e\u52a9\u800c\u8bb0\u5f55\u5728\u6848\uff0c\u4f8b\u5982\u5728\u5206\u6790\u7f51\u7edc\u6d41\u91cf\u65f6\u3002 type Server type Server struct { serviceMap sync.Map // map[string]*service reqLock sync.Mutex // protects freeReq freeReq *Request respLock sync.Mutex // protects freeResp freeResp *Response } Server \u4ee3\u8868RPC\u670d\u52a1\u5668\u3002 func (*Server) Accept func (server *Server) Accept(lis net.Listener) Accept\u63a5\u53d7\u76d1\u542c\u5668\u4e0a\u7684\u8fde\u63a5\uff0c\u5e76\u672a\u6bcf\u4e2a\u4f20\u5165\u7684\u8fde\u63a5\u63d0\u4f9b\u8bf7\u6c42\u3002\u5f53\u76d1\u542c\u5668\u8fd4\u56de\u4e00\u4e2a\u975enil\u9519\u8bef\u65f6\uff0cAccetp\u4f1a\u88ab\u963b\u585e\u3002\u901a\u5e38\u5728Go\u8bed\u53e5\u4e2d\u8c03\u7528Accept\u3002 func (*Server) HandleHTTP func (server *Server) HandleHTTP(rpcPath, debugPath string) Handlehttp \u5728 rpcPath \u4e0a\u4e3a RPC \u6d88\u606f\u6ce8\u518c HTTP \u5904\u7406\u5668\uff0c\u5728 debugPath \u4e0a\u6ce8\u518c\u8c03\u8bd5\u5668\u3002 \u4ecd\u7136\u9700\u8981\u8c03\u7528 http.Serve() \uff0c\u901a\u5e38\u5728 go \u8bed\u53e5\u4e2d\u3002 func (*Server) Register func (server *Server) Register(rcvr interface{}) error Register \u5728\u670d\u52a1\u5668\u4e2d\u53d1\u5e03\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u63a5\u6536\u5668\u503c\u7684\u65b9\u6cd5\u96c6: \u5bfc\u51fa\u7c7b\u578b\u7684\u5bfc\u51fa\u65b9\u6cd5 \u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u5bfc\u51fa\u7c7b\u578b \u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\u6307\u9488\u7c7b\u578b \u4e00\u4e2aerror\u7c7b\u578b\u7684\u8fd4\u56de\u503c \u5982\u679c\u63a5\u6536\u5668\u4e0d\u662f\u5bfc\u51fa\u7c7b\u578b\u6216\u8005\u6ca1\u6709\u5408\u9002\u7684\u65b9\u6cd5\uff0c\u5219\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002 \u5b83\u8fd8\u4f7f\u7528log\u5305\u8bb0\u5f55\u9519\u8bef\u3002 \u5ba2\u6237\u7aef\u4f7f\u7528\u201c Type.Method\u201d\u5f62\u5f0f\u7684\u5b57\u7b26\u4e32\u8bbf\u95ee\u6bcf\u4e2a\u65b9\u6cd5\u3002 \u5176\u4e2d Type \u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002 func (*Server) RegisterName func (server *Server) RegisterName(name string, rcvr interface{}) error Registername \u7c7b\u4f3c\u4e8e Register\uff0c\u4f46\u4f7f\u7528\u7ed9\u5b9a\u7684\u7c7b\u578b\u540d\u79f0\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002 func (*Server) ServeCodec func (server *Server) ServeCodec(codec ServerCodec) Servecodec \u7c7b\u4f3c\u4e8e ServeConn\uff0c\u4f46\u4f7f\u7528\u7ed9\u5b9a\u7684\u7f16\u89e3\u7801\u5668\u5bf9\u8bf7\u6c42\u8fdb\u884c\u89e3\u7801\u5e76\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801\u3002 func (*Server) ServeConn func (server *Server) ServeConn(conn io.ReadWriteCloser) Serveconn \u5728\u5355\u4e2a\u8fde\u63a5\u4e0a\u8fd0\u884c\u670d\u52a1\u5668\u3002 Serveconn \u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u5728\u5ba2\u6237\u7aef\u6302\u65ad\u4e4b\u524d\u4e3a\u8fde\u63a5\u63d0\u4f9b\u670d\u52a1\u3002 \u8c03\u7528\u65b9\u901a\u5e38\u5728 go \u8bed\u53e5\u4e2d\u8c03\u7528 ServeConn\u3002 Serveconn \u5728\u8fde\u63a5\u4e0a\u4f7f\u7528gob\u7f16\u7801\u683c\u5f0f\u3002 \u82e5\u8981\u4f7f\u7528\u53e6\u5916\u7684\u7f16\u89e3\u7801\u5668\uff0c\u8bf7\u4f7f\u7528 ServeCodec\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002 func (*Server) ServeHTTP func (server *Server) ServeHTTP(w http.ResponseWriter, req *http.Request) ServeHTTP\u5b9e\u73b0\u4e86\u4e00\u4e2a http.Handler \u6765\u54cd\u5e94RPC\u8bf7\u6c42\u3002 func (*Server) ServeRequest func (server *Server) ServeRequest(codec ServerCodec) error Serverequest \u7c7b\u4f3c\u4e8e ServeCodec\uff0c\u4f46\u540c\u6b65\u670d\u52a1\u4e8e\u5355\u4e2a\u8bf7\u6c42\u3002 \u5b83\u4e0d\u4f1a\u5728\u5b8c\u6210\u65f6\u5173\u95ed\u7f16\u89e3\u7801\u5668\u3002 type ServerCodec type ServerCodec interface { ReadRequestHeader(*Request) error ReadRequestBody(interface{}) error WriteResponse(*Response, interface{}) error // Close \u53ef\u4ee5\u88ab\u591a\u6b21\u8c03\u7528\uff0c\u5e76\u4e14\u5fc5\u987b\u662f\u5e42\u7b49\u7684 Close() error } Servercodec \u4e3a RPC \u4f1a\u8bdd\u7684\u670d\u52a1\u5668\u7aef\u5b9e\u73b0\u5bf9 RPC \u8bf7\u6c42\u7684\u8bfb\u53d6\u548c RPC \u54cd\u5e94\u7684\u5199\u5165\u3002 \u670d\u52a1\u5668\u6210\u5bf9\u8c03\u7528 readrequesttheader \u548c ReadRequestBody \u6765\u8bfb\u53d6\u6765\u81ea\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u5e76\u8c03\u7528 WriteResponse \u6765\u5199\u56de\u5e94\u3002 \u670d\u52a1\u5668\u5728\u8fde\u63a5\u7ed3\u675f\u65f6\u8c03\u7528 Close\u3002 \u53ef\u4ee5\u4f7f\u7528 nil \u53c2\u6570\u8c03\u7528 ReadRequestBody\uff0c\u4ee5\u5f3a\u5236\u8bfb\u53d6\u548c\u4e22\u5f03\u8bf7\u6c42\u7684\u4e3b\u4f53\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002 type ServerError type ServerError string Servererror \u8868\u793a\u4ece RPC \u8fde\u63a5\u7684\u8fdc\u7a0b\u7aef\u8fd4\u56de\u7684\u9519\u8bef\u3002 func (ServerError) Error func (e ServerError) Error() string","title":"rpc"},{"location":"Language/Library/net/rpc/#rpc","text":"import net/rpc rpc\u5305\u63d0\u4f9b\u5bf9\u901a\u8fc7\u7f51\u7edc\u6216\u5176\u4ed6I/O\u8fde\u63a5\u7684\u5bf9\u8c61\u5bfc\u51fa\u65b9\u6cd5\u7684\u8bbf\u95ee\u3002\u670d\u52a1\u7aef\u6ce8\u518c\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4f7f\u5b83\u4f5c\u4e3a\u5177\u6709\u5bf9\u8c61\u7c7b\u578b\u540d\u79f0\u7684\u670d\u52a1\u800c\u53ef\u89c1\u3002\u5728\u6ce8\u518c\u4e4b\u540e\uff0c\u5bf9\u8c61\u7684\u5bfc\u51fa\u65b9\u6cd5\u53ef\u4ee5\u88ab\u8fdc\u7a0b\u8bbf\u95ee\u3002\u670d\u52a1\u7aef\u53ef\u4ee5\u6ce8\u518c\u4e0d\u540c\u7c7b\u578b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0c\u4f46\u662f\u5982\u679c\u6ce8\u518c\u540c\u4e00\u7c7b\u578b\u7684\u591a\u4e2a\u5bf9\u8c61\u662f\u9519\u8bef\u7684\u3002 \u53ea\u6709\u6ee1\u8db3\u8fd9\u4e9b\u6807\u51c6\u7684\u65b9\u6cd5\u624d\u53ef\u7528\u4e8e\u8fdc\u7a0b\u8bbf\u95ee\uff0c\u5176\u4ed6\u65b9\u6cd5\u5c06\u88ab\u5ffd\u7565\uff1a \u65b9\u6cd5\u7684\u7c7b\u578b\u662f\u5bfc\u51fa\u7684 \u65b9\u6cd5\u662f\u5bfc\u51fa\u7684 \u65b9\u6cd5\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u90fd\u662f\u5bfc\u51fa\u6216\u5185\u7f6e\u7c7b\u578b \u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\u662f\u4e00\u4e2a\u6307\u9488 \u65b9\u6cd5\u6709\u8fd4\u56deerror\u7c7b\u578b \u5b9e\u9645\u4e0a\uff0c\u8be5\u65b9\u6cd5\u770b\u8d77\u6765\u5e94\u8be5\u50cf\u8fd9\u6837\uff1a func (t *T) MethodName(argType T1, replyType *T2) error \u5176\u4e2dT1\u548cT2\u53ef\u4ee5\u901a\u8fc7 encoding/gob \u7f16\u7801\u3001\u5373\u4f7f\u4f7f\u7528\u4e0d\u540c\u7684\u7f16\u89e3\u7801\u5668\uff0c\u8fd9\u4e9b\u8981\u6c42\u4e5f\u662f\u9002\u7528\u7684\u3002\uff08\u5728\u5c06\u6765\uff0c\u8fd9\u4e9b\u8981\u6c42\u53ef\u80fd\u4f1a\u5bf9\u81ea\u5b9a\u4e49\u7f16\u89e3\u7801\u5668\u5f31\u5316\uff09\u3002 \u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff1a\u8868\u793a\u8c03\u7528\u65b9\u63d0\u4f9b\u7684\u53c2\u6570 \u65b9\u6cd5\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff1a\u8868\u793a\u8981\u8fd4\u56de\u7ed9\u8c03\u7528\u65b9\u7684\u7ed3\u679c\u53c2\u6570 \u8be5\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\uff08\u5982\u679c\u4e0d\u662fnil\uff09\u5c06\u4f5c\u4e3a\u5b57\u7b26\u4e32\u4f20\u9012\u56de\u6765\uff0c\u5ba2\u6237\u7aef\u5c06\u8ba4\u4e3a\u5b83\u662f\u7531 errors.New \u521b\u5efa\u7684\u3002\u5982\u679c\u6709\u9519\u8bef\u88ab\u8fd4\u56de\uff0c\u5219\u4e0d\u4f1a\u6709\u54cd\u5e94\u53c2\u6570\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef\u3002 \u670d\u52a1\u7aef\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 ServerConn \u6765\u5904\u7406\u5355\u4e2a\u8fde\u63a5\u4e0a\u7684\u8bf7\u6c42\u3002\u66f4\u5e38\u89c1\u7684\u60c5\u51b5\u662f\uff0c\u670d\u52a1\u7aef\u521b\u5efa\u4e00\u4e2a\u7f51\u7edc\u76d1\u542c\u5668\uff0c\u7136\u540e\u8c03\u7528 Accept \uff0c\u6216\u8005\u521b\u5efa\u4e00\u4e2aHTTP\u76d1\u542c\u5668\uff0c\u7136\u540e\u8c03\u7528 HandleHTTP \u548c http.Serve \u3002 \u60f3\u8981\u4f7f\u7528\u8be5\u670d\u52a1\u7684\u5ba2\u6237\u7aef\u4f1a\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u7136\u540e\u5728\u8fde\u63a5\u4e0a\u8c03\u7528 NewClient \u3002 Dial(DialHTTP) \u51fd\u6570\u4e3a\u539f\u59cb\u7f51\u7edc\u8fde\u63a5\uff08HTTP\u8fde\u63a5\uff09\u6267\u884c\u8fd9\u4e24\u4e2a\u6b65\u9aa4\uff0c\u7136\u540e\u5f97\u5230\u7684\u5ba2\u6237\u7aef\u5bf9\u8c61\u6709\u4e24\u4e2a\u65b9\u6cd5 Call \u548c Go \uff0c\u5b83\u4eec\u6307\u5b9a\u8981\u8c03\u7528\u7684\u670d\u52a1\u548c\u65b9\u6cd5\uff0c\u4e00\u4e2a\u4f20\u9012\u53c2\u6570\u7684\u6307\u9488\u548c\u4e00\u4e2a\u63a5\u6536\u7ed3\u679c\u53c2\u6570\u7684\u6307\u9488\u3002 Call\u65b9\u6cd5\uff1a\u7b49\u5f85\u8fdc\u7a0b\u8c03\u7528\u5b8c\u6210 Go\u65b9\u6cd5\uff1a\u5f02\u6b65\u542f\u52a8\u8c03\u7528\uff0c\u5e76\u4f7f\u7528 Call \u7ed3\u6784\u4f53\u4e2d\u7684 Done \u901a\u9053\u53d1\u51fa\u5b8c\u6210\u4fe1\u53f7 \u9664\u975e\u8bbe\u7f6e\u4e86\u663e\u5f0f\u7f16\u89e3\u7801\u5668\uff0c\u5426\u5219\u5c06\u4f7f\u7528 encoding/gob \u5305\u6765\u4f20\u8f93\u6570\u636e\u3002 \u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\uff0c\u670d\u52a1\u7aef\u5e0c\u671b\u5bfc\u51faArith\u7c7b\u578b\u7684\u5bf9\u8c61\uff1a package server import errors type Args struct { A, B int } type Quotient struct { Quo, Rem int } type Arith int func (t *Arith) Multiply(args *Args, reply *int) error { *reply = args.A * args.B return nil } func (t *Arith) Divide(args *Args, quo *Quotient) error { if args.B == 0 { return errors.New( divide by zero ) } quo.Quo = args.A / args.B quo.Rem = args.A % args.B return nil } \u670d\u52a1\u7aef\u8c03\u7528HTTP\u670d\u52a1\uff1a arith := new(Arith) rpc.Register(arith) rpc.HandleHTTP() l, e := net.Listen( tcp , :1234 ) if e != nil { log.Fatal( listen error: , e) } go http.Serve(l, nil) \u6b64\u65f6\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u670d\u52a1\u201cArith\u201d\u5e26\u6709\u65b9\u6cd5\u201cArith.Multiply\u201d\u548c\u201cArith.Divide\u201d\u3002\u8981\u8c03\u7528\u8fd9\u4e9b\u65b9\u6cd5\uff0c\u5ba2\u6237\u7aef\u9996\u5148\u8981\u8fde\u63a5\u670d\u52a1\u7aef\uff1a client, err := rpc.DialHTTP( tcp , serverAddress + :1234 ) if err != nil { log.Fatal( dialing: , err) } \u7136\u540e\uff0c\u5ba2\u6237\u7aef\u53ef\u4ee5\u6267\u884c\u4e00\u6b21\u8fdc\u7a0b\u8c03\u7528\uff1a // Synchronous call args := server.Args{7,8} var reply int err = client.Call( Arith.Multiply , args, reply) if err != nil { log.Fatal( arith error: , err) } fmt.Printf( Arith: %d*%d=%d , args.A, args.B, reply) \u6216\u8005\uff1a // Asynchronous call quotient := new(Quotient) divCall := client.Go( Arith.Divide , args, quotient, nil) replyCall := -divCall.Done // will be equal to divCall // check errors, print, etc. \u670d\u52a1\u7aef\u5b9e\u73b0\u901a\u5e38\u4f1a\u4e3a\u5ba2\u6237\u7aef\u63d0\u4f9b\u7b80\u5355\u7684\u7c7b\u578b\u5b89\u5168\u5305\u88c5\u5668\uff0c net/rpc \u5305\u5df2\u7ecf\u6682\u505c\uff0c\u4e0d\u4f1a\u5728\u63a5\u53d7\u65b0\u7279\u6027\u3002","title":"rpc"},{"location":"Language/Library/net/rpc/#constants","text":"const ( // Defaults used by HandleHTTP DefaultRPCPath = /_goRPC_ DefaultDebugPath = /debug/rpc )","title":"Constants"},{"location":"Language/Library/net/rpc/#variables","text":"var DefaultServer = NewServer() // DefaultServer\u662f *Server\u7684\u9ed8\u8ba4\u5b9e\u4f8b var ErrShutdown = errors.New( connection is shut down )","title":"Variables"},{"location":"Language/Library/net/rpc/#func-accpet","text":"func Accept(lis net.Listener) Accept\u63a5\u53d7\u76d1\u542c\u5668\u4e0a\u7684\u8fde\u63a5\uff0c\u5e76\u4e3a\u6bcf\u4e2a\u4f20\u5165\u8fde\u63a5\u5411DefaultServer\u63d0\u4f9b\u8bf7\u6c42\u3002Accept\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u901a\u5e38\u8c03\u7528\u5219\u5728go\u8bed\u53e5\u4e2d\u8c03\u7528\u5b83\u3002","title":"func Accpet"},{"location":"Language/Library/net/rpc/#func-handlehttp","text":"func HandleHTTP() HandleHTTP\u5728DefaultRPCPath\u4e0a\u4e3aRPC\u6d88\u606f\u6ce8\u518c\u4e00\u4e2aHTTP\u5904\u7406\u5668\u5230DefaultServer\u4e0a\uff0c\u5e76\u5728DefaultDebugPath\u4e0a\u6ce8\u518c\u4e00\u4e2a\u8c03\u8bd5\u5668\u3002\u4ecd\u7136\u9700\u8981\u8c03\u7528 http.Serve() \uff0c\u901a\u5e38\u4e5f\u662f\u5728go\u8bed\u53e5\u4e2d\u3002","title":"func HandleHTTP"},{"location":"Language/Library/net/rpc/#func-register","text":"func Register(rcvr interface{}) error Register \u5728 DefaultServer \u4e2d\u53d1\u5e03\u63a5\u6536\u65b9\u7684\u65b9\u6cd5\u3002","title":"func Register"},{"location":"Language/Library/net/rpc/#func-registername","text":"func RegisterName(name string, rcvr interface{}) error Registername \u7c7b\u4f3c\u4e8e Register\uff0c\u4f46\u4f7f\u7528\u63d0\u4f9b\u7684\u7c7b\u578b\u540d\u79f0\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002","title":"func RegisterName"},{"location":"Language/Library/net/rpc/#func-servecodec","text":"func ServeCodec(codec ServerCodec) Servecodec \u7c7b\u4f3c\u4e8e ServeConn\uff0c\u4f46\u4f7f\u7528\u6307\u5b9a\u7684\u7f16\u89e3\u7801\u5668\u5bf9\u8bf7\u6c42\u8fdb\u884c\u89e3\u7801\u5e76\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801\u3002","title":"func ServeCodec"},{"location":"Language/Library/net/rpc/#func-serveconn","text":"func ServeConn(conn io.ReadWriteCloser) ServeConn\u5728\u5355\u4e2a\u8fde\u63a5\u4e0a\u8fd0\u884cDefaultServer\uff0cServeConn\u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u5728\u5ba2\u6237\u7aef\u6302\u8d77\u4e4b\u524d\u4e3a\u8fde\u63a5\u63d0\u4f9b\u670d\u52a1\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u8c03\u7528\u8005\u5728go\u8bed\u53e5\u4e2d\u8c03\u7528ServeConn\u3002ServeConn\u5728\u8fde\u63a5\u4e0a\u4f7f\u7528gob\u7f16\u7801\u683c\u5f0f\u3002\u82e5\u8981\u4f7f\u7528\u53e6\u5916\u7684\u7f16\u89e3\u7801\u5668\uff0c\u4f7f\u7528ServeCodec\u3002\u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u67e5\u770bNewClient\u7684\u6ce8\u91ca\u3002","title":"func ServeConn"},{"location":"Language/Library/net/rpc/#func-serverequest","text":"func ServeRequest(codec ServeCodec) error Serverequest \u7c7b\u4f3c\u4e8e ServeCodec\uff0c\u4f46\u540c\u6b65\u670d\u52a1\u4e8e\u5355\u4e2a\u8bf7\u6c42\u3002 \u5b83\u4e0d\u4f1a\u5728\u5b8c\u6210\u65f6\u5173\u95ed\u7f16\u89e3\u7801\u5668\u3002","title":"func ServeRequest"},{"location":"Language/Library/net/rpc/#type-call","text":"type Call struct { ServiceMethod string // \u8981\u8c03\u7528\u7684\u670d\u52a1\u548c\u65b9\u6cd5\u7684\u540d\u79f0 Args interface{} // function (*struct)\u7684\u4f20\u5165\u53c2\u6570 Reply interface{} // function (*struct)\u7684\u8fd4\u56de\u7ed3\u679c Error error // \u5b8c\u6210\u540e\u7684\u9519\u8bef\u72b6\u6001 Done chan *Call // \u8c03\u7528\u7ed3\u675f\u540e\u53d1\u51fa\u6d88\u606f } Call \u8868\u793a\u4e00\u4e2a\u6d3b\u8dc3\u7684RPC\u3002","title":"type call"},{"location":"Language/Library/net/rpc/#type-client","text":"type Client struct { codec ClientCodec reqMutex sync.Mutex // protects following request Request mutex sync.Mutex // protects following seq uint64 pending map[uint64]*Call closing bool // user has called Close shutdown bool // server has told us to stop } Client\u8868\u793a\u4e00\u4e2aRPC\u5ba2\u6237\u7aef\uff0c\u4e00\u4e2aClient\u53ef\u80fd\u6709\u591a\u4e2a\u672a\u5b8c\u6210\u7684\u8c03\u7528\uff0c\u4e00\u4e2aClient\u4e5f\u53ef\u80fd\u540c\u65f6\u88ab\u591a\u4e2agoroutine\u4f7f\u7528\u3002","title":"type Client"},{"location":"Language/Library/net/rpc/#func-dial","text":"func Dial(network, address string) (*Client, error) Dial\u6309\u7167\u5230\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u8fde\u63a5\u5230RPC\u670d\u52a1\u5668\u3002","title":"func Dial"},{"location":"Language/Library/net/rpc/#func-dialhttp","text":"func DialHTTP(network, address string) (*Client, error) DialHTTP\u6309\u7167\u6307\u5b9a\u7f51\u7edc\u5730\u5740\u8fde\u63a5\u5230HTTP RPC\u670d\u52a1\u5668\uff0c\u5e76\u76d1\u542c\u9ed8\u8ba4\u7684HTTP RPC \u8def\u5f84\u3002","title":"func DialHTTP"},{"location":"Language/Library/net/rpc/#func-dialhttppath","text":"func DialHTTPPath(network, address, path string) (*Client, error) DialHTTPPath \u6309\u7167\u6307\u5b9a\u7684\u7f51\u7edc\u5730\u5740\u548c\u8def\u5f84\u8fde\u63a5\u5230 HTTP RPC \u670d\u52a1\u5668\u3002","title":"func DialHTTPPath"},{"location":"Language/Library/net/rpc/#func-newclient","text":"func NewClient(conn io.ReadWriteCloser) *Client Newclient \u8fd4\u56de\u4e00\u4e2a\u65b0 Client \u6765\u5904\u7406\u8fde\u63a5\u53e6\u4e00\u7aef\u7684\u670d\u52a1\u96c6\u53d1\u51fa\u7684\u8bf7\u6c42\u3002 \u5b83\u5411\u8fde\u63a5\u7684\u5199\u5165\u7aef\u6dfb\u52a0\u4e00\u4e2a\u7f13\u51b2\u533a\uff0c\u4ee5\u4fbf\u5c06\u5934\u548c\u6709\u6548\u8d1f\u8f7d\u4f5c\u4e3a\u4e00\u4e2a\u5355\u5143\u53d1\u9001\u3002 \u8fde\u63a5\u7684\u8bfb\u53d6\u548c\u5199\u5165\u90e8\u5206\u662f\u72ec\u7acb\u4e32\u884c\u5316\u7684\uff0c\u56e0\u6b64\u4e0d\u9700\u8981\u5185\u8054\u9501\u3002 \u4f46\u662f\uff0c\u6bcf\u4e00\u90e8\u5206\u90fd\u53ef\u4ee5\u88ab\u5e76\u53d1\u7684\u8bbf\u95ee\uff0c\u56e0\u6b64 conn \u7684\u5b9e\u73b0\u5e94\u8be5\u80fd\u591f\u9632\u6b62\u5e76\u53d1\u8bfb\u6216\u5e76\u53d1\u5199\u3002","title":"func NewClient"},{"location":"Language/Library/net/rpc/#func-newclientwithcodec","text":"func NewClientWithCodec(codec ClientCodec) *Client Newclientwithcodec \u7c7b\u4f3c\u4e8e NewClient\uff0c\u4f46\u662f\u4f7f\u7528\u6307\u5b9a\u7684 codec \u5bf9\u8bf7\u6c42\u8fdb\u884c\u7f16\u7801\u5e76\u89e3\u7801\u54cd\u5e94\u3002","title":"func NewClientWithCodec"},{"location":"Language/Library/net/rpc/#func-client-call","text":"func (client *Client) Call(serviceMethod string, args interface{}, reply interface{}) error Call\u8c03\u7528\u6307\u5b9a\u540d\u5b57\u7684\u51fd\u6570\uff0c\u7b49\u5f85\u5b83\u5b8c\u6210\uff0c\u5e76\u8fd4\u56de\u5b83\u7684\u9519\u8bef\u72b6\u6001\u3002","title":"func (*Client) Call"},{"location":"Language/Library/net/rpc/#func-client-close","text":"func (client *Client) Close() error Close \u8c03\u7528\u5e95\u5c42\u7f16\u89e3\u7801\u5668\u7684 Close \u65b9\u6cd5\u3002 \u5982\u679c\u8fde\u63a5\u5df2\u7ecf\u5173\u95ed\uff0c\u5219\u8fd4\u56de ErrShutdown\u3002","title":"func (*Client) Close"},{"location":"Language/Library/net/rpc/#func-client-go","text":"func (client *Client) Go(serviceMethod string, args interface{}, reply interface{}, done chan *Call) *Call Go \u4ee5\u5f02\u6b65\u65b9\u5f0f\u8c03\u7528\u51fd\u6570\u3002 \u5b83\u8fd4\u56de\u8868\u793a\u8c03\u7528\u7684 Call \u7ed3\u6784\u4f53\u3002 \u901a\u8fc7\u8fd4\u56de\u76f8\u540c\u7684 Call \u5bf9\u8c61\uff0cdone \u901a\u9053\u5c06\u5728\u8c03\u7528\u5b8c\u6210\u65f6\u53d1\u51fa\u4fe1\u53f7\u3002 \u5982\u679c done \u4e3a nil\uff0c\u5219 Go \u5c06\u5206\u914d\u4e00\u4e2a\u65b0\u7684\u901a\u9053\uff0c\u5982\u679c\u4e0d\u662fnil\uff0cdone\u5fc5\u7136\u5df2\u7ecf\u88ab\u586b\u5145\u5426\u5219Go\u5c06\u4f1a\u5954\u6e83\u3002","title":"func (*Client) Go"},{"location":"Language/Library/net/rpc/#type-clientcodec","text":"type ClientCodec interface { WriteRequest(*Request, interface{}) error ReadResponseHeader(*Response) error ReadResponseBody(interface{}) error Close() error } Clientcodec \u5b9e\u73b0\u5728\u4e00\u4e2aRPC\u4f1a\u8bdd\u7684\u5ba2\u6237\u7aef\u4fa7\u5199\u5165RPC\u8bf7\u6c42\u548c\u8bfb\u53d6RPC\u54cd\u5e94\u3002\u5ba2\u6237\u7aef\u8c03\u7528 WriteRequest \u5411\u8fde\u63a5\u5199\u5165\u8bf7\u6c42\uff0c\u5e76\u6210\u5bf9\u8c03\u7528 ReadResponseHeader \u548c ReadResponseBody \u6765\u8bfb\u53d6\u54cd\u5e94\u3002 \u5f53\u8fde\u63a5\u7ed3\u675f\u65f6\uff0c\u5ba2\u6237\u7aef\u8c03\u7528 Close\u3002 \u53ef\u4ee5\u4f7f\u7528 nil \u53c2\u6570\u8c03\u7528 ReadResponseBody\uff0c\u4ee5\u5f3a\u5236\u8bfb\u53d6\u54cd\u5e94\u4e3b\u4f53\uff0c\u7136\u540e\u5c06\u5176\u4e22\u5f03\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002","title":"type ClientCodec"},{"location":"Language/Library/net/rpc/#type-request","text":"type Request struct { ServiceMethod string // format: Service.Method Seq uint64 // \u5ba2\u6237\u7aef\u9009\u62e9\u7684\u5e8f\u5217\u53f7 next *Request // \u670d\u52a1\u5668\u4e2d\u7684\u7a7a\u95f2\u5217\u8868 } Request \u662f\u5728\u6bcf\u4e2a RPC \u8c03\u7528\u4e4b\u524d\u5199\u5165\u7684\u8bf7\u6c42\u5934\u3002 \u5b83\u5728\u5185\u90e8\u4f7f\u7528\uff0c\u4f46\u5728\u8fd9\u91cc\u4f5c\u4e3a\u8c03\u8bd5\u7684\u5e2e\u52a9\u800c\u8bb0\u5f55\u5728\u6848\uff0c\u4f8b\u5982\u5728\u5206\u6790\u7f51\u7edc\u6d41\u91cf\u65f6\u3002","title":"type Request"},{"location":"Language/Library/net/rpc/#type-response","text":"type Response struct { ServiceMethod string // echoes that of the Request Seq uint64 // echoes that of the request Error string // error, if any. next *Response // for free list in Server } Response \u662f\u5728\u6bcf\u4e2a RPC \u8fd4\u56de\u4e4b\u524d\u5199\u5165\u7684\u54cd\u5e94\u5934\u3002 \u5b83\u5728\u5185\u90e8\u4f7f\u7528\uff0c\u4f46\u5728\u8fd9\u91cc\u4f5c\u4e3a\u8c03\u8bd5\u7684\u5e2e\u52a9\u800c\u8bb0\u5f55\u5728\u6848\uff0c\u4f8b\u5982\u5728\u5206\u6790\u7f51\u7edc\u6d41\u91cf\u65f6\u3002","title":"type Response"},{"location":"Language/Library/net/rpc/#type-server","text":"type Server struct { serviceMap sync.Map // map[string]*service reqLock sync.Mutex // protects freeReq freeReq *Request respLock sync.Mutex // protects freeResp freeResp *Response } Server \u4ee3\u8868RPC\u670d\u52a1\u5668\u3002","title":"type Server"},{"location":"Language/Library/net/rpc/#func-server-accept","text":"func (server *Server) Accept(lis net.Listener) Accept\u63a5\u53d7\u76d1\u542c\u5668\u4e0a\u7684\u8fde\u63a5\uff0c\u5e76\u672a\u6bcf\u4e2a\u4f20\u5165\u7684\u8fde\u63a5\u63d0\u4f9b\u8bf7\u6c42\u3002\u5f53\u76d1\u542c\u5668\u8fd4\u56de\u4e00\u4e2a\u975enil\u9519\u8bef\u65f6\uff0cAccetp\u4f1a\u88ab\u963b\u585e\u3002\u901a\u5e38\u5728Go\u8bed\u53e5\u4e2d\u8c03\u7528Accept\u3002","title":"func (*Server) Accept"},{"location":"Language/Library/net/rpc/#func-server-handlehttp","text":"func (server *Server) HandleHTTP(rpcPath, debugPath string) Handlehttp \u5728 rpcPath \u4e0a\u4e3a RPC \u6d88\u606f\u6ce8\u518c HTTP \u5904\u7406\u5668\uff0c\u5728 debugPath \u4e0a\u6ce8\u518c\u8c03\u8bd5\u5668\u3002 \u4ecd\u7136\u9700\u8981\u8c03\u7528 http.Serve() \uff0c\u901a\u5e38\u5728 go \u8bed\u53e5\u4e2d\u3002","title":"func (*Server) HandleHTTP"},{"location":"Language/Library/net/rpc/#func-server-register","text":"func (server *Server) Register(rcvr interface{}) error Register \u5728\u670d\u52a1\u5668\u4e2d\u53d1\u5e03\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u63a5\u6536\u5668\u503c\u7684\u65b9\u6cd5\u96c6: \u5bfc\u51fa\u7c7b\u578b\u7684\u5bfc\u51fa\u65b9\u6cd5 \u4e24\u4e2a\u53c2\u6570\u90fd\u662f\u5bfc\u51fa\u7c7b\u578b \u7b2c\u4e8c\u4e2a\u53c2\u6570\u503c\u6307\u9488\u7c7b\u578b \u4e00\u4e2aerror\u7c7b\u578b\u7684\u8fd4\u56de\u503c \u5982\u679c\u63a5\u6536\u5668\u4e0d\u662f\u5bfc\u51fa\u7c7b\u578b\u6216\u8005\u6ca1\u6709\u5408\u9002\u7684\u65b9\u6cd5\uff0c\u5219\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\u3002 \u5b83\u8fd8\u4f7f\u7528log\u5305\u8bb0\u5f55\u9519\u8bef\u3002 \u5ba2\u6237\u7aef\u4f7f\u7528\u201c Type.Method\u201d\u5f62\u5f0f\u7684\u5b57\u7b26\u4e32\u8bbf\u95ee\u6bcf\u4e2a\u65b9\u6cd5\u3002 \u5176\u4e2d Type \u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002","title":"func (*Server) Register"},{"location":"Language/Library/net/rpc/#func-server-registername","text":"func (server *Server) RegisterName(name string, rcvr interface{}) error Registername \u7c7b\u4f3c\u4e8e Register\uff0c\u4f46\u4f7f\u7528\u7ed9\u5b9a\u7684\u7c7b\u578b\u540d\u79f0\u800c\u4e0d\u662f\u63a5\u6536\u65b9\u7684\u5177\u4f53\u7c7b\u578b\u3002","title":"func (*Server) RegisterName"},{"location":"Language/Library/net/rpc/#func-server-servecodec","text":"func (server *Server) ServeCodec(codec ServerCodec) Servecodec \u7c7b\u4f3c\u4e8e ServeConn\uff0c\u4f46\u4f7f\u7528\u7ed9\u5b9a\u7684\u7f16\u89e3\u7801\u5668\u5bf9\u8bf7\u6c42\u8fdb\u884c\u89e3\u7801\u5e76\u5bf9\u54cd\u5e94\u8fdb\u884c\u7f16\u7801\u3002","title":"func (*Server) ServeCodec"},{"location":"Language/Library/net/rpc/#func-server-serveconn","text":"func (server *Server) ServeConn(conn io.ReadWriteCloser) Serveconn \u5728\u5355\u4e2a\u8fde\u63a5\u4e0a\u8fd0\u884c\u670d\u52a1\u5668\u3002 Serveconn \u53ef\u80fd\u4f1a\u88ab\u963b\u585e\uff0c\u5728\u5ba2\u6237\u7aef\u6302\u65ad\u4e4b\u524d\u4e3a\u8fde\u63a5\u63d0\u4f9b\u670d\u52a1\u3002 \u8c03\u7528\u65b9\u901a\u5e38\u5728 go \u8bed\u53e5\u4e2d\u8c03\u7528 ServeConn\u3002 Serveconn \u5728\u8fde\u63a5\u4e0a\u4f7f\u7528gob\u7f16\u7801\u683c\u5f0f\u3002 \u82e5\u8981\u4f7f\u7528\u53e6\u5916\u7684\u7f16\u89e3\u7801\u5668\uff0c\u8bf7\u4f7f\u7528 ServeCodec\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002","title":"func (*Server) ServeConn"},{"location":"Language/Library/net/rpc/#func-server-servehttp","text":"func (server *Server) ServeHTTP(w http.ResponseWriter, req *http.Request) ServeHTTP\u5b9e\u73b0\u4e86\u4e00\u4e2a http.Handler \u6765\u54cd\u5e94RPC\u8bf7\u6c42\u3002","title":"func (*Server) ServeHTTP"},{"location":"Language/Library/net/rpc/#func-server-serverequest","text":"func (server *Server) ServeRequest(codec ServerCodec) error Serverequest \u7c7b\u4f3c\u4e8e ServeCodec\uff0c\u4f46\u540c\u6b65\u670d\u52a1\u4e8e\u5355\u4e2a\u8bf7\u6c42\u3002 \u5b83\u4e0d\u4f1a\u5728\u5b8c\u6210\u65f6\u5173\u95ed\u7f16\u89e3\u7801\u5668\u3002","title":"func (*Server) ServeRequest"},{"location":"Language/Library/net/rpc/#type-servercodec","text":"type ServerCodec interface { ReadRequestHeader(*Request) error ReadRequestBody(interface{}) error WriteResponse(*Response, interface{}) error // Close \u53ef\u4ee5\u88ab\u591a\u6b21\u8c03\u7528\uff0c\u5e76\u4e14\u5fc5\u987b\u662f\u5e42\u7b49\u7684 Close() error } Servercodec \u4e3a RPC \u4f1a\u8bdd\u7684\u670d\u52a1\u5668\u7aef\u5b9e\u73b0\u5bf9 RPC \u8bf7\u6c42\u7684\u8bfb\u53d6\u548c RPC \u54cd\u5e94\u7684\u5199\u5165\u3002 \u670d\u52a1\u5668\u6210\u5bf9\u8c03\u7528 readrequesttheader \u548c ReadRequestBody \u6765\u8bfb\u53d6\u6765\u81ea\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u5e76\u8c03\u7528 WriteResponse \u6765\u5199\u56de\u5e94\u3002 \u670d\u52a1\u5668\u5728\u8fde\u63a5\u7ed3\u675f\u65f6\u8c03\u7528 Close\u3002 \u53ef\u4ee5\u4f7f\u7528 nil \u53c2\u6570\u8c03\u7528 ReadRequestBody\uff0c\u4ee5\u5f3a\u5236\u8bfb\u53d6\u548c\u4e22\u5f03\u8bf7\u6c42\u7684\u4e3b\u4f53\u3002 \u6709\u5173\u5e76\u53d1\u8bbf\u95ee\u7684\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 NewClient \u7684\u6ce8\u91ca\u3002","title":"type ServerCodec"},{"location":"Language/Library/net/rpc/#type-servererror","text":"type ServerError string Servererror \u8868\u793a\u4ece RPC \u8fde\u63a5\u7684\u8fdc\u7a0b\u7aef\u8fd4\u56de\u7684\u9519\u8bef\u3002","title":"type ServerError"},{"location":"Language/Library/net/rpc/#func-servererror-error","text":"func (e ServerError) Error() string","title":"func (ServerError) Error"},{"location":"Language/Library/os/exec/","text":"package exec import os/exec exec \u5305\u7528\u4e8e\u8fd0\u884c\u5916\u90e8\u547d\u4ee4,\u5b83\u5305\u88c5\u4e86 os.StartProcess \uff0c\u4f7f\u5b83\u66f4\u5bb9\u6613\u91cd\u6620\u5c04\u5230 stdin \u548c stdout \uff0c\u6216\u8005\u4f7f\u7528\u7ba1\u9053\u8fde\u63a5I/O\u5e76\u8fdb\u884c\u5176\u4ed6\u8c03\u6574\u3002 \u4e0eC\u8bed\u8a00\u6216\u8005\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u7684\u201c\u7cfb\u7edf\u201d\u5e93\u8c03\u7528\u4e0d\u540c\uff0c os/exec \u5305\u6709\u610f\u4e0d\u8c03\u7528\u7cfb\u7edf shell \uff0c\u4e5f\u4e0d\u6269\u5c55\u4efb\u4f55 glob patterns \u6216\u5904\u7406\u4e00\u822c\u60c5\u51b5\u4e0b\u7531 shell \u5b8c\u6210\u7684\u5176\u4ed6\u6269\u5c55\uff0c\u7ba1\u9053\u6216\u91cd\u5b9a\u5411\u3002 glob patterns \u662f\u4e00\u79cd\u5339\u914d\u6a21\u5f0f\uff0c\u8fd0\u7528\u901a\u914d\u7b26\u6765\u5339\u914d\u4e00\u4e2a\u6587\u4ef6\u5217\u8868\u3002 exec \u5305\u7684\u884c\u4e3a\u66f4\u50cf\u662fC\u7684\u201cexec\u201d\u7cfb\u5217\u51fd\u6570\u7684\u529f\u80fd\u3002 \u8981\u6269\u5c55 glob patterns \u6216\u8005\u76f4\u63a5\u8c03\u7528 shell \u65f6\uff1a \u8981\u6ce8\u610f\u8f6c\u4e49\u4efb\u4f55\u5371\u9669\u7684\u8f93\u5165 \u4e5f\u53ef\u4ee5\u4f7f\u7528 path/filepath \u5305\u7684 Glob \u51fd\u6570 \u8981\u6269\u5c55\u73af\u5883\u53d8\u91cf\uff0c\u8bf7\u4f7f\u7528 os \u5305\u7684 ExpandEnv \u3002 \u8bf7\u6ce8\u610f\uff0c\u6b64\u5305\u4e2d\u7684\u793a\u4f8b\u662f\u5728Unix\u7cfb\u7edf\u4e2d\u4e91\u7684\uff0c\u53ef\u80fd\u65e0\u6cd5\u5728Windows\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u4f7f\u7528 golang.org \u548c godoc.org \u7684Go Playground\u4e2d\u8fd0\u884c\u3002 \u53d8\u91cf var ErrNotFound = errors.New( executable file not found in $PATH ) ErrNotFound \u662f\u8def\u5f84\u641c\u7d22\u672a\u80fd\u627e\u5230\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u5bfc\u81f4\u7684\u9519\u8bef\u3002 \u51fd\u6570LookPath func LookPath(file string) (string, error) LookPath \u5728 PATH \u73af\u5883\u53d8\u91cf\u547d\u540d\u7684\u76ee\u5f55\u4e2d\u641c\u7d22\u53ef\u6267\u884c\u6587\u4ef6 file \u3002\u5982\u679c file \u5305\u542b\u659c\u6760\uff0c\u5219\u76f4\u63a5\u5c1d\u8bd5\u641c\u7d22\u4e14\u4e0d\u67e5\u8be2 PATH \u3002\u8fd4\u56de\u7ed3\u679c\u662f \u7edd\u5bf9\u8def\u5f84 \u6216 \u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84 \u3002 \u793a\u4f8b path, err := exec.LookPath( fortune ) if err != nil { log.Fatal( installing fortune in your future ) } fmt.Printf( fortune is available at %s\\n , path) \u7c7b\u578bCmd type Cmd struct { // Path\u662f\u6240\u8981\u8fd0\u884c\u547d\u4ee4\u7684\u8def\u5f84\uff0c\u8fd9\u662f\u552f\u4e00\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u975e\u96f6\u503c\u7684\u5b57\u6bb5\u3002 // \u5982\u679c\u662fPath\u662f\u76f8\u5bf9\u7684\uff0c\u5219\u76f8\u5bf9\u4e8e{Dir}\u8fdb\u884c\u8bc4\u4f30\u3002 Path string // Args\u4fdd\u5b58\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5305\u62ec\u547d\u4ee4\u4e3aArgs[0]\u3002 // \u5982\u679cArgs\u5b57\u6bb5\u4e3a\u7a7a\u6216\u4e3anil\uff0c\u5219\u76f4\u63a5\u8fd0\u884c\u4e0a\u8ff0{Path}\u5b57\u6bb5\u3002 // \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPath\u548cArgs\u90fd\u662f\u901a\u8fc7\u8c03\u7528Command\u6765\u8bbe\u7f6e\u7684\u3002 Args []string // Env\u6307\u5b9a\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u6bcf\u4e2a\u6761\u76ee\u90fd\u662f\u201ckey=value\u201d\u7684\u683c\u5f0f\u3002 // \u5982\u679cEnv\u4e3anil\uff0c\u90a3\u4e48\u65b0\u521b\u5efa\u7684\u8fdb\u7a0b\u4f7f\u7528\u5f53\u524d\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 // \u5728\u6b64Env\u5207\u7247\u4e2d\uff0c\u5982\u679c\u5305\u542b\u7684\u73af\u5883\u53d8\u91cf\u4e2d\u6709\u91cd\u590d\u7684\u952e\u503c\uff0c // \u90a3\u4e48\u6bcf\u4e2a\u91cd\u590d\u7684\u952e\u503c\u4e2d\u53ea\u6709\u6700\u65b0\u7684\u503c\u4f1a\u88ab\u4f7f\u7528\u3002 Env []string // Dir\u6307\u5b9a\u547d\u4ee4\u7684\u5de5\u4f5c\u76ee\u5f55\u3002 // \u5982\u679cDir\u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48{Run}\u4f1a\u5728\u53d1\u8d77\u8c03\u7528\u7684\u8fdb\u7a0b\u7684\u5f53\u524d\u76ee\u5f55\u4e2d\u8fd0\u884c\u8be5\u547d\u4ee4\u3002 Dir string // Stdin\u6307\u5b9a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165\u3002 // \u5982\u679cStdin\u4e3anil\uff0c\u5219\u8fdb\u7a0b\u4ecenull\u8bbe\u5907\uff08os.DevNull\uff09\u8bfb\u53d6\u3002 // \u5982\u679cStdin\u662f*os.File\uff0c\u5219\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165\u76f4\u63a5\u8fde\u63a5\u5230\u8be5\u6587\u4ef6\u3002 // \u5426\u5219\uff0c\u5728\u6267\u884c\u547d\u4ee4\u671f\u95f4\uff0c\u5355\u72ec\u7684goroutine\u4eceStdin\u8bfb\u53d6\u5e76\u901a\u8fc7\u7ba1\u9053\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u8be5\u547d\u4ee4\u3002 // \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c{Wait}\u5c06\u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230goroutine\u505c\u6b62\u62f7\u8d1d\u6570\u636e\uff0c // \u5373\uff0c\u5df2\u7ecf\u8bfb\u53d6\u5230Stdin\u7684\u672b\u5c3e\uff08EOF\u6216\u8bfb\u53d6\u9519\u8bef\uff09\uff0c\u6216\u6570\u636e\u5199\u5165\u7ba1\u9053\u65f6\u51fa\u9519\u3002 Stdin io.Reader // Stdout\u548cStderr\u6307\u5b9a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 // \u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u4e3anil\uff0c\u5219{Run}\u5c06\u76f8\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u8fde\u63a5\u5230\u7a7a\u8bbe\u5907\uff08os.DevNull\uff09\u3002 // \u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u662f*os.File\uff0c\u5219\u8fdb\u7a0b\u76f8\u5e94\u7684\u8f93\u51fa\u5c06\u76f4\u63a5\u8fde\u63a5\u5230\u8be5\u6587\u4ef6\u3002 // \u5426\u5219\uff0c\u5728\u547d\u4ee4\u6267\u884c\u671f\u95f4\uff0c\u5355\u72ec\u7684goroutine\u901a\u8fc7\u7ba1\u9053\u4ece\u8fdb\u7a0b\u8bfb\u53d6\u5e76\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u5bf9\u5e94\u7684{Writer}\u3002 // \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c{Wait}\u5c06\u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230goroutine\u8bfb\u53d6\u5230EOF\u6216\u9047\u5230\u9519\u8bef\u3002 // \u5982\u679cStdout\u548cStderr\u662f\u540c\u4e00\u4e2awriter\uff0c\u5e76\u4e14\u5177\u6709\u53ef\u4ee5\u5224\u7b49\uff08==\uff09\u7684\u7c7b\u578b\uff0c\u5219\u4e00\u6b21\u6700\u591a\u53ea\u6709\u4e00\u4e2agoroutine\u8c03\u7528\u5199\u5165\u51fd\u6570\u3002 Stdout io.Writer Stderr io.Writer // ExtraFiles\u6307\u5b9a\u65b0\u8fdb\u7a0b\u8981\u7ee7\u627f\u7684\u5176\u4ed6\u5df2\u6253\u5f00\u6587\u4ef6\u3002 // \u5b83\u4e0d\u5305\u62ec\u6807\u51c6\u8f93\u5165\uff0c\u6807\u51c6\u8f93\u51fa\u6216\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 // \u5982\u679c\u975enil\uff0c\u90a3\u4e48\u6761\u76eei\u53d8\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b263+i\u3002 // Windows\u7cfb\u7edf\u4e0d\u652f\u6301ExtraFiles\u3002 ExtraFiles []*os.File // SysProcAttr\u5305\u542b\u53ef\u9009\u7684\u64cd\u4f5c\u7cfb\u7edf\u7279\u5b9a\u5c5e\u6027\u3002 // {Run}\u5c06\u5b83\u4f5c\u4e3aos.ProcAttr\u7684Sys\u5b57\u6bb5\u4f20\u9012\u7ed9os.StartProcess\u3002 SysProcAttr *syscall.SysProcAttr // \u4e00\u65e6\u542f\u52a8\uff0cProcess\u5c31\u662f\u5e95\u5c42\u8fdb\u7a0b\u3002 Process *os.Process // ProcessState\u5305\u542b\u5df2\u9000\u51fa\u8fdb\u7a0b\u7684\u4fe1\u606f\uff0c\u5728\u4e00\u6b21\u8c03\u7528\u540e\u65e0\u8bba\u5904\u4e8e{Wait}\u6216{Run}\u90fd\u53ef\u7528\u3002 ProcessState *os.ProcessState // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } Cmd\u8868\u793a\u6b63\u5728\u51c6\u5907\u6216\u8fd0\u884c\u7684\u5916\u90e8\u547d\u4ee4\uff0c\u5728\u8c03\u7528\u5176 Run \uff0c Output \u6216 CombinedOutput \u65b9\u6cd5\u540e\uff0c\u65e0\u6cd5\u88ab\u91cd\u7528\u3002 \u51fd\u6570Command func Command(name string, arg ...string) *Cmd Command \u8fd4\u56de Cmd \u7ed3\u6784\u4ee5\u4f7f\u7528\u7ed9\u5b9a\u7684\u53c2\u6570\u6267\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\uff0c\u5b83\u4ec5\u5728\u8fd4\u56de\u7684Cmd\u7ed3\u6784\u4e2d\u8bbe\u7f6e Path \u548c Args \u3002 \u5982\u679c name \u4e0d\u5305\u542b\u8def\u5f84\u5206\u9694\u7b26\uff0c\u5219 Command \u4f7f\u7528 LookPath \u5c06 name \u89e3\u6790\u4e3a\u5b8c\u6574\u8def\u5f84\uff08\u5982\u679c\u53ef\u80fd\uff09\u3002\u5426\u5219\uff0c\u5b83\u76f4\u63a5\u4f7f\u7528 name \u4f5c\u4e3a Path \u3002 \u8fd4\u56de\u7684 Cmd\u7ed3\u6784 \u4e2d Args \u5b57\u6bb5\u662f\u4ece\u547d\u4ee4 name \u540e\u7d27\u8ddf\u7684 arg \u5143\u7d20\u6784\u9020\u800c\u6765\uff0c\u56e0\u6b64\u5728 arg \u4e2d\u4e0d\u9700\u8981\u518d\u5305\u542b\u547d\u4ee4 name \u3002\u4f8b\u5982\uff0c Command\uff08\u201cecho\u201d\uff0c\u201chello\u201d\uff09 \u3002 Args[0] \u59cb\u7ec8\u662f name \uff0c\u800c\u4e0d\u53ef\u80fd\u662f\u5df2\u89e3\u6790\u7684\u8def\u5f84\u3002 \u5728 Windows \u4e0a\uff0c\u8fdb\u7a0b\u5c06\u6574\u4e2a\u547d\u4ee4\u884c\u4f5c\u4e3a\u5355\u4e2a\u5b57\u7b26\u4e32\u63a5\u6536\u5e76\u6267\u884c\u81ea\u5df1\u7684\u89e3\u6790\u3002 Command \u4f7f\u7528\u4e0e\u5e94\u7528\u7a0b\u5e8f\u517c\u5bb9\u7684\u7b97\u6cd5 CommandLineToArgvW \uff08\u8fd9\u662f\u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff09\u5c06 Args \u7ec4\u5408\u5e76\u5f15\u7528\u5230\u547d\u4ee4\u884c\u5b57\u7b26\u4e32\u4e2d\u3002\u503c\u5f97\u6ce8\u610f\u7684\u4f8b\u5916\u662f msiexec.exe \u548c cmd.exe \uff08\u5305\u62ec\u6240\u6709\u6279\u5904\u7406\u6587\u4ef6 batch files \uff09\uff0c\u5b83\u4eec\u5177\u6709\u4e0d\u540c\u7684\u53cd\u5f15\u7528\u7b97\u6cd5\u3002\u5728\u8fd9\u4e9b\u6216\u5176\u4ed6\u7c7b\u4f3c\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u81ea\u5df1\u8fdb\u884c\u5f15\u7528\u5e76\u5728 SysProcAttr.CmdLine \u4e2d\u63d0\u4f9b\u5b8c\u6574\u7684\u547d\u4ee4\u884c\uff0c\u8ba9Args\u7a7a\u7740\u3002 cmd := exec.Command( tr , a-z , A-Z ) cmd.Stdin = strings.NewReader( some input ) var out bytes.Buffer cmd.Stdout = out err := cmd.Run() if err != nil { log.Fatal(err) } fmt.Printf( in all caps: %q\\n , out.String()) cmd := exec.Command( prog ) cmd.Env = append(os.Environ(), FOO=duplicate_value , // \u91cd\u590d\u503c\u5c06\u88ab\u5ffd\u7565 FOO=actual_value , // \u6700\u65b0\u503c\u5c06\u88ab\u4f7f\u7528 ) if err := cmd.Run(); err != nil { log.Fatal(err) } \u51fd\u6570CommandContext func CommandContext(ctx context.Context, name string, arg ...string) *Cmd CommandContext \u4e0e Command \u7c7b\u4f3c\uff0c\u4f46\u5305\u542b\u4e0a\u4e0b\u6587\u3002 \u5982\u679c\u5728\u547d\u4ee4\u81ea\u884c\u5b8c\u6210\u4e4b\u524d context \u5df2\u7ecf\u7ed3\u675f\uff0c\u5219\u63d0\u4f9b\u7684 context \u7528\u4e8e\u7ec8\u6b62\u8fdb\u7a0b\uff08\u901a\u8fc7\u8c03\u7528 os.Process.Kill \uff09\u3002 ctx, cancel := context.WithTimeout(context.Background(), 100*time.Millisecond) defer cancel() if err := exec.CommandContext(ctx, sleep , 5 ).Run(); err != nil { // \u8fd9\u5c06\u5728100\u6beb\u79d2\u540e\u5931\u8d25\u3002 // 5\u79d2\u7684sleep\u8fdb\u7a0b\u5c06\u4f1a\u88ab\u4e2d\u65ad\u3002 } \u65b9\u6cd5 (*Cmd)CombinedOutput func (c *Cmd) CombinedOutput() ([]byte, error) CombinedOutput \u8fd0\u884c\u547d\u4ee4\u5e76\u8fd4\u56de\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u9519\u8bef\u8f93\u51fa\u7684\u7ec4\u5408\u3002 cmd := exec.Command( sh , -c , echo stdout; echo 1 2 stderr ) stdoutStderr, err := cmd.CombinedOutput() if err != nil { log.Fatal(err) } fmt.Printf( %s\\n , stdoutStderr) \u65b9\u6cd5 (*Cmd)Output func (c *Cmd) Output() ([]byte, error) Output \u8fd0\u884c\u547d\u4ee4\u5e76\u8fd4\u56de\u5176\u6807\u51c6\u8f93\u51fa\u3002\u4efb\u4f55\u8fd4\u56de\u7684\u9519\u8bef\u901a\u5e38\u90fd\u662f *ExitError \u7c7b\u578b\u3002\u5982\u679c c.Stderr \u4e3a nil \uff0c\u5219 Output \u586b\u5145 ExitError.Stderr \u3002 out, err := exec.Command( date ).Output() if err != nil { log.Fatal(err) } fmt.Printf( The date is %s\\n , out) \u65b9\u6cd5 (*Cmd)Run func (c *Cmd) Run() error Run \u542f\u52a8\u6307\u5b9a\u7684\u547d\u4ee4\u5e76\u7b49\u5f85\u5b83\u5b8c\u6210\u3002 \u5982\u679c\u547d\u4ee4\u8fd0\u884c\uff0c\u5728\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e4b\u95f4\u590d\u5236\u6570\u636e\u6ca1\u6709\u95ee\u9898\u5e76\u4e14\u9000\u51fa\u72b6\u6001\u4e3a\u96f6\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u9519\u8bef\u4e3a nil \u3002 \u5982\u679c\u547d\u4ee4\u542f\u52a8\u4f46\u672a\u6210\u529f\u5b8c\u6210\uff0c\u5219\u8fd4\u56de\u7684\u9519\u8bef\u7c7b\u578b\u4e3a *ExitError \u3002\u5bf9\u4e8e\u5176\u4ed6\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u5176\u4ed6\u9519\u8bef\u7c7b\u578b\u3002 \u5982\u679c\u6b63\u5728\u88ab\u8c03\u7528\u7684goroutine\u5df2\u4f7f\u7528 runtime.LockOSThread \u9501\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u5e76\u4fee\u6539\u4e86\u4efb\u4f55\u53ef\u7ee7\u627f\u7684OS\u7ea7\u522b\u7ebf\u7a0b\u72b6\u6001\uff08\u4f8b\u5982\uff0cLinux\u6216Plan 9\u540d\u79f0\u7a7a\u95f4\uff09\uff0c\u5219\u65b0\u8fdb\u7a0b\u5c06\u7ee7\u627f\u8c03\u7528\u65b9\u7684\u7ebf\u7a0b\u72b6\u6001\u3002 cmd := exec.Command( sleep , 1 ) log.Printf( Running command and waiting for it to finish... ) err := cmd.Run() log.Printf( Command finished with error: %v , err) \u65b9\u6cd5 (*Cmd)Start func (c *Cmd) Start() error Start \u542f\u52a8\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u4f46\u4e0d\u7b49\u5f85\u5b83\u5b8c\u6210\u3002 \u4e00\u65e6\u547d\u4ee4\u9000\u51fa\uff0c Wait \u65b9\u6cd5\u5c06\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u7801\u5e76\u91ca\u653e\u76f8\u5173\u8d44\u6e90\u3002 cmd := exec.Command( sleep , 5 ) err := cmd.Start() if err != nil { log.Fatal(err) } log.Printf( Waiting for command to finish... ) err = cmd.Wait() log.Printf( Command finished with error: %v , err) \u65b9\u6cd5 (*Cmd)StderrPipe func (c *Cmd) StderrPipe() (io.ReadCloser, error) StderrPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 Wait \u5c06\u5728\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5173\u95ed\u7ba1\u9053\uff0c\u56e0\u6b64\u5927\u591a\u6570\u8c03\u7528\u8005\u4e0d\u9700\u8981\u81ea\u5df1\u5173\u95ed\u7ba1\u9053; \u4f46\u662f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728\u7ba1\u9053\u7684\u6240\u6709\u8bfb\u53d6\u5b8c\u6210\u4e4b\u524d\u8c03\u7528 Wait \u662f\u4e0d\u6b63\u786e\u7684\u3002\u540c\u6837\u7684\uff0c\u4f7f\u7528 StderrPipe \u65f6\u4f7f\u7528 Run \u4e5f\u662f\u4e0d\u6b63\u786e\u7684\u3002 \u6709\u5173\u4e60\u60ef\u7528\u6cd5\uff0c\u8bf7\u53c2\u9605StdoutPipe\u793a\u4f8b\u3002 cmd := exec.Command( sh , -c , echo stdout; echo 1 2 stderr ) stderr, err := cmd.StderrPipe() if err != nil { log.Fatal(err) } if err := cmd.Start(); err != nil { log.Fatal(err) } slurp, _ := ioutil.ReadAll(stderr) fmt.Printf( %s\\n , slurp) if err := cmd.Wait(); err != nil { log.Fatal(err) } \u65b9\u6cd5 (*Cmd)StdinPipe func (c *Cmd) StdinPipe() (io.WriteCloser, error) StdinPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u5165\u3002 Wait \u67e5\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5c06\u81ea\u52a8\u5173\u95ed\u7ba1\u9053\u3002\u8c03\u7528\u8005\u53ea\u9700\u8981\u8c03\u7528 Close \u6765\u5f3a\u5236\u7ba1\u9053\u66f4\u5feb\u5173\u95ed\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u547d\u4ee4\u5728\u6807\u51c6\u8f93\u5165\u5173\u95ed\u4e4b\u540e\u4e0d\u4f1a\u9000\u51fa\uff0c\u5219\u8c03\u7528\u8005\u5fc5\u987b\u5173\u95ed\u7ba1\u9053\u3002 cmd := exec.Command( cat ) stdin, err := cmd.StdinPipe() if err != nil { log.Fatal(err) } go func() { defer stdin.Close() io.WriteString(stdin, values written to stdin are passed to cmd's standard input ) }() out, err := cmd.CombinedOutput() if err != nil { log.Fatal(err) } fmt.Printf( %s\\n , out) \u65b9\u6cd5 (*Cmd)StdoutPipe func (c *Cmd) StdoutPipe() (io.ReadCloser, error) StdoutPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u3002 Wait \u5c06\u5728\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5173\u95ed\u7ba1\u9053\uff0c\u56e0\u6b64\u5927\u591a\u6570\u8c03\u7528\u8005\u4e0d\u9700\u8981\u81ea\u5df1\u5173\u95ed\u7ba1\u9053; \u4f46\u662f\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5728\u7ba1\u9053\u7684\u6240\u6709\u8bfb\u53d6\u5b8c\u6210\u4e4b\u524d\u8c03\u7528 Wait \u662f\u4e0d\u6b63\u786e\u7684\u3002\u540c\u6837\u7684\uff0c\u4f7f\u7528 StdoutPipe \u65f6\u8c03\u7528Run\u662f\u4e0d\u6b63\u786e\u7684\u3002\u6709\u5173\u4e60\u60ef\u7528\u6cd5\uff0c\u8bf7\u53c2\u9605\u793a\u4f8b\u3002 cmd := exec.Command( echo , -n , `{ Name : Bob , Age : 32}`) stdout, err := cmd.StdoutPipe() if err != nil { log.Fatal(err) } if err := cmd.Start(); err != nil { log.Fatal(err) } var person struct { Name string Age int } if err := json.NewDecoder(stdout).Decode( person); err != nil { log.Fatal(err) } if err := cmd.Wait(); err != nil { log.Fatal(err) } fmt.Printf( %s is %d years old\\n , person.Name, person.Age) \u65b9\u6cd5 (*Cmd)Wait func (c *Cmd) Wait() error Wait \u7b49\u5f85\u547d\u4ee4\u9000\u51fa\u5e76\u7b49\u5f85\u4efb\u4f55\u590d\u5236\u5230\u6807\u51c6\u8f93\u5165\u6216\u8005\u4ece\u6807\u51c6\u8f93\u51fa\u6216\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u590d\u5236\u5b8c\u6210\u3002 \u8be5\u547d\u4ee4\u5fc5\u987b\u7531 Start \u542f\u52a8\u3002 \u5982\u679c\u547d\u4ee4\u8fd0\u884c\uff0c\u5728\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e4b\u95f4\u590d\u5236\u6570\u636e\u6ca1\u6709\u95ee\u9898\u4e14\u9000\u51fa\u72b6\u6001\u7801\u4e3a\u96f6\uff0c\u90a3\u4e48\uff0c\u8fd4\u56de\u7684\u9519\u8bef\u4e3a nil \u3002 \u5982\u679c\u547d\u4ee4\u65e0\u6cd5\u8fd0\u884c\u6216\u672a\u6210\u529f\u5b8c\u6210\uff0c\u5219\u9519\u8bef\u7c7b\u578b\u4e3a *ExitError \u3002\u5bf9\u4e8eI/O\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u5176\u4ed6\u9519\u8bef\u7c7b\u578b\u3002 \u5982\u679c c.Stdin \uff0c c.Stdout \u6216 c.Stderr \u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u4e0d\u662f *os.File \uff0c\u90a3\u4e48 Wait \u4e5f\u4f1a\u7b49\u5f85\u76f8\u5e94\u7684I/O\u5faa\u73af\u590d\u5236\u5230\u8fdb\u7a0b\u6216\u4ece\u8fdb\u7a0b\u4e2d\u590d\u5236\u5b8c\u6210\u3002 Wait \u91ca\u653e\u4e0e Cmd \u76f8\u5173\u7684\u4efb\u4f55\u8d44\u6e90\u3002 \u7c7b\u578bError type Error struct { // Name\u662f\u53d1\u751f\u9519\u8bef\u7684\u6587\u4ef6\u540d\u3002 Name string // Err\u662f\u6f5c\u5728\u7684\u9519\u8bef\u3002 Err error } Error\u662f LookPath \u65e0\u6cd5\u5c06\u6587\u4ef6\u5f52\u7c7b\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u8fd4\u56de\u7684\u3002 \u65b9\u6cd5 (*Error)Error func (e *Error) Error() string \u7c7b\u578bExitError type ExitError struct { *os.ProcessState // \u5982\u679c\u6ca1\u6709\u6536\u96c6\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff0cStderr\u4f1a\u4fdd\u7559Cmd.Output\u65b9\u6cd5\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u7684\u5b50\u96c6\u3002 // \u5982\u679c\u9519\u8bef\u8f93\u51fa\u5f88\u957f\uff0cStderr\u53ef\u80fd\u53ea\u5305\u542b\u8f93\u51fa\u7684\u524d\u7f00\u548c\u540e\u7f00\uff0c\u4e2d\u95f4\u66ff\u6362\u4e3a\u76f8\u5173\u7701\u7565\u5b57\u8282\u6570\u7684\u6587\u672c\u3002 // \u63d0\u4f9bStderr\u662f\u7528\u4e8e\u4ee3\u7801\u8c03\u8bd5\uff0c\u6765\u5305\u542b\u5728\u9519\u8bef\u6d88\u606f\u4e2d\u3002\u5177\u6709\u5176\u4ed6\u9700\u6c42\u7684\u7528\u6237\u5e94\u6839\u636e\u9700\u8981\u91cd\u5b9a\u5411Cmd.Stderr\u3002 Stderr []byte } ExitError\u62a5\u544a\u547d\u4ee4\u9000\u51fa\u5931\u8d25\u3002 \u65b9\u6cd5 (*ExitError)Error func (e *ExitError) Error() string","title":"package exec"},{"location":"Language/Library/os/exec/#package-exec","text":"import os/exec exec \u5305\u7528\u4e8e\u8fd0\u884c\u5916\u90e8\u547d\u4ee4,\u5b83\u5305\u88c5\u4e86 os.StartProcess \uff0c\u4f7f\u5b83\u66f4\u5bb9\u6613\u91cd\u6620\u5c04\u5230 stdin \u548c stdout \uff0c\u6216\u8005\u4f7f\u7528\u7ba1\u9053\u8fde\u63a5I/O\u5e76\u8fdb\u884c\u5176\u4ed6\u8c03\u6574\u3002 \u4e0eC\u8bed\u8a00\u6216\u8005\u5176\u4ed6\u7f16\u7a0b\u8bed\u8a00\u7684\u201c\u7cfb\u7edf\u201d\u5e93\u8c03\u7528\u4e0d\u540c\uff0c os/exec \u5305\u6709\u610f\u4e0d\u8c03\u7528\u7cfb\u7edf shell \uff0c\u4e5f\u4e0d\u6269\u5c55\u4efb\u4f55 glob patterns \u6216\u5904\u7406\u4e00\u822c\u60c5\u51b5\u4e0b\u7531 shell \u5b8c\u6210\u7684\u5176\u4ed6\u6269\u5c55\uff0c\u7ba1\u9053\u6216\u91cd\u5b9a\u5411\u3002 glob patterns \u662f\u4e00\u79cd\u5339\u914d\u6a21\u5f0f\uff0c\u8fd0\u7528\u901a\u914d\u7b26\u6765\u5339\u914d\u4e00\u4e2a\u6587\u4ef6\u5217\u8868\u3002 exec \u5305\u7684\u884c\u4e3a\u66f4\u50cf\u662fC\u7684\u201cexec\u201d\u7cfb\u5217\u51fd\u6570\u7684\u529f\u80fd\u3002 \u8981\u6269\u5c55 glob patterns \u6216\u8005\u76f4\u63a5\u8c03\u7528 shell \u65f6\uff1a \u8981\u6ce8\u610f\u8f6c\u4e49\u4efb\u4f55\u5371\u9669\u7684\u8f93\u5165 \u4e5f\u53ef\u4ee5\u4f7f\u7528 path/filepath \u5305\u7684 Glob \u51fd\u6570 \u8981\u6269\u5c55\u73af\u5883\u53d8\u91cf\uff0c\u8bf7\u4f7f\u7528 os \u5305\u7684 ExpandEnv \u3002 \u8bf7\u6ce8\u610f\uff0c\u6b64\u5305\u4e2d\u7684\u793a\u4f8b\u662f\u5728Unix\u7cfb\u7edf\u4e2d\u4e91\u7684\uff0c\u53ef\u80fd\u65e0\u6cd5\u5728Windows\u4e0a\u8fd0\u884c\uff0c\u5e76\u4e14\u4e0d\u80fd\u5728\u4f7f\u7528 golang.org \u548c godoc.org \u7684Go Playground\u4e2d\u8fd0\u884c\u3002","title":"package exec"},{"location":"Language/Library/os/exec/#_1","text":"var ErrNotFound = errors.New( executable file not found in $PATH ) ErrNotFound \u662f\u8def\u5f84\u641c\u7d22\u672a\u80fd\u627e\u5230\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u5bfc\u81f4\u7684\u9519\u8bef\u3002","title":"\u53d8\u91cf"},{"location":"Language/Library/os/exec/#lookpath","text":"func LookPath(file string) (string, error) LookPath \u5728 PATH \u73af\u5883\u53d8\u91cf\u547d\u540d\u7684\u76ee\u5f55\u4e2d\u641c\u7d22\u53ef\u6267\u884c\u6587\u4ef6 file \u3002\u5982\u679c file \u5305\u542b\u659c\u6760\uff0c\u5219\u76f4\u63a5\u5c1d\u8bd5\u641c\u7d22\u4e14\u4e0d\u67e5\u8be2 PATH \u3002\u8fd4\u56de\u7ed3\u679c\u662f \u7edd\u5bf9\u8def\u5f84 \u6216 \u76f8\u5bf9\u4e8e\u5f53\u524d\u76ee\u5f55\u7684\u76f8\u5bf9\u8def\u5f84 \u3002","title":"\u51fd\u6570LookPath"},{"location":"Language/Library/os/exec/#_2","text":"path, err := exec.LookPath( fortune ) if err != nil { log.Fatal( installing fortune in your future ) } fmt.Printf( fortune is available at %s\\n , path)","title":"\u793a\u4f8b"},{"location":"Language/Library/os/exec/#cmd","text":"type Cmd struct { // Path\u662f\u6240\u8981\u8fd0\u884c\u547d\u4ee4\u7684\u8def\u5f84\uff0c\u8fd9\u662f\u552f\u4e00\u5fc5\u987b\u8bbe\u7f6e\u4e3a\u975e\u96f6\u503c\u7684\u5b57\u6bb5\u3002 // \u5982\u679c\u662fPath\u662f\u76f8\u5bf9\u7684\uff0c\u5219\u76f8\u5bf9\u4e8e{Dir}\u8fdb\u884c\u8bc4\u4f30\u3002 Path string // Args\u4fdd\u5b58\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u5305\u62ec\u547d\u4ee4\u4e3aArgs[0]\u3002 // \u5982\u679cArgs\u5b57\u6bb5\u4e3a\u7a7a\u6216\u4e3anil\uff0c\u5219\u76f4\u63a5\u8fd0\u884c\u4e0a\u8ff0{Path}\u5b57\u6bb5\u3002 // \u901a\u5e38\u60c5\u51b5\u4e0b\uff0cPath\u548cArgs\u90fd\u662f\u901a\u8fc7\u8c03\u7528Command\u6765\u8bbe\u7f6e\u7684\u3002 Args []string // Env\u6307\u5b9a\u8be5\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002\u6bcf\u4e2a\u6761\u76ee\u90fd\u662f\u201ckey=value\u201d\u7684\u683c\u5f0f\u3002 // \u5982\u679cEnv\u4e3anil\uff0c\u90a3\u4e48\u65b0\u521b\u5efa\u7684\u8fdb\u7a0b\u4f7f\u7528\u5f53\u524d\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u3002 // \u5728\u6b64Env\u5207\u7247\u4e2d\uff0c\u5982\u679c\u5305\u542b\u7684\u73af\u5883\u53d8\u91cf\u4e2d\u6709\u91cd\u590d\u7684\u952e\u503c\uff0c // \u90a3\u4e48\u6bcf\u4e2a\u91cd\u590d\u7684\u952e\u503c\u4e2d\u53ea\u6709\u6700\u65b0\u7684\u503c\u4f1a\u88ab\u4f7f\u7528\u3002 Env []string // Dir\u6307\u5b9a\u547d\u4ee4\u7684\u5de5\u4f5c\u76ee\u5f55\u3002 // \u5982\u679cDir\u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48{Run}\u4f1a\u5728\u53d1\u8d77\u8c03\u7528\u7684\u8fdb\u7a0b\u7684\u5f53\u524d\u76ee\u5f55\u4e2d\u8fd0\u884c\u8be5\u547d\u4ee4\u3002 Dir string // Stdin\u6307\u5b9a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165\u3002 // \u5982\u679cStdin\u4e3anil\uff0c\u5219\u8fdb\u7a0b\u4ecenull\u8bbe\u5907\uff08os.DevNull\uff09\u8bfb\u53d6\u3002 // \u5982\u679cStdin\u662f*os.File\uff0c\u5219\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u5165\u76f4\u63a5\u8fde\u63a5\u5230\u8be5\u6587\u4ef6\u3002 // \u5426\u5219\uff0c\u5728\u6267\u884c\u547d\u4ee4\u671f\u95f4\uff0c\u5355\u72ec\u7684goroutine\u4eceStdin\u8bfb\u53d6\u5e76\u901a\u8fc7\u7ba1\u9053\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u8be5\u547d\u4ee4\u3002 // \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c{Wait}\u5c06\u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230goroutine\u505c\u6b62\u62f7\u8d1d\u6570\u636e\uff0c // \u5373\uff0c\u5df2\u7ecf\u8bfb\u53d6\u5230Stdin\u7684\u672b\u5c3e\uff08EOF\u6216\u8bfb\u53d6\u9519\u8bef\uff09\uff0c\u6216\u6570\u636e\u5199\u5165\u7ba1\u9053\u65f6\u51fa\u9519\u3002 Stdin io.Reader // Stdout\u548cStderr\u6307\u5b9a\u8fdb\u7a0b\u7684\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 // \u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u4e3anil\uff0c\u5219{Run}\u5c06\u76f8\u5e94\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u8fde\u63a5\u5230\u7a7a\u8bbe\u5907\uff08os.DevNull\uff09\u3002 // \u5982\u679c\u5176\u4e2d\u4e00\u4e2a\u662f*os.File\uff0c\u5219\u8fdb\u7a0b\u76f8\u5e94\u7684\u8f93\u51fa\u5c06\u76f4\u63a5\u8fde\u63a5\u5230\u8be5\u6587\u4ef6\u3002 // \u5426\u5219\uff0c\u5728\u547d\u4ee4\u6267\u884c\u671f\u95f4\uff0c\u5355\u72ec\u7684goroutine\u901a\u8fc7\u7ba1\u9053\u4ece\u8fdb\u7a0b\u8bfb\u53d6\u5e76\u5c06\u6570\u636e\u4f20\u9012\u7ed9\u5bf9\u5e94\u7684{Writer}\u3002 // \u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c{Wait}\u5c06\u4f1a\u4e00\u76f4\u7b49\u5f85\u76f4\u5230goroutine\u8bfb\u53d6\u5230EOF\u6216\u9047\u5230\u9519\u8bef\u3002 // \u5982\u679cStdout\u548cStderr\u662f\u540c\u4e00\u4e2awriter\uff0c\u5e76\u4e14\u5177\u6709\u53ef\u4ee5\u5224\u7b49\uff08==\uff09\u7684\u7c7b\u578b\uff0c\u5219\u4e00\u6b21\u6700\u591a\u53ea\u6709\u4e00\u4e2agoroutine\u8c03\u7528\u5199\u5165\u51fd\u6570\u3002 Stdout io.Writer Stderr io.Writer // ExtraFiles\u6307\u5b9a\u65b0\u8fdb\u7a0b\u8981\u7ee7\u627f\u7684\u5176\u4ed6\u5df2\u6253\u5f00\u6587\u4ef6\u3002 // \u5b83\u4e0d\u5305\u62ec\u6807\u51c6\u8f93\u5165\uff0c\u6807\u51c6\u8f93\u51fa\u6216\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 // \u5982\u679c\u975enil\uff0c\u90a3\u4e48\u6761\u76eei\u53d8\u4e3a\u6587\u4ef6\u63cf\u8ff0\u7b263+i\u3002 // Windows\u7cfb\u7edf\u4e0d\u652f\u6301ExtraFiles\u3002 ExtraFiles []*os.File // SysProcAttr\u5305\u542b\u53ef\u9009\u7684\u64cd\u4f5c\u7cfb\u7edf\u7279\u5b9a\u5c5e\u6027\u3002 // {Run}\u5c06\u5b83\u4f5c\u4e3aos.ProcAttr\u7684Sys\u5b57\u6bb5\u4f20\u9012\u7ed9os.StartProcess\u3002 SysProcAttr *syscall.SysProcAttr // \u4e00\u65e6\u542f\u52a8\uff0cProcess\u5c31\u662f\u5e95\u5c42\u8fdb\u7a0b\u3002 Process *os.Process // ProcessState\u5305\u542b\u5df2\u9000\u51fa\u8fdb\u7a0b\u7684\u4fe1\u606f\uff0c\u5728\u4e00\u6b21\u8c03\u7528\u540e\u65e0\u8bba\u5904\u4e8e{Wait}\u6216{Run}\u90fd\u53ef\u7528\u3002 ProcessState *os.ProcessState // \u5305\u542b\u5df2\u8fc7\u6ee4\u6216\u672a\u5bfc\u51fa\u7684\u5b57\u6bb5 } Cmd\u8868\u793a\u6b63\u5728\u51c6\u5907\u6216\u8fd0\u884c\u7684\u5916\u90e8\u547d\u4ee4\uff0c\u5728\u8c03\u7528\u5176 Run \uff0c Output \u6216 CombinedOutput \u65b9\u6cd5\u540e\uff0c\u65e0\u6cd5\u88ab\u91cd\u7528\u3002","title":"\u7c7b\u578bCmd"},{"location":"Language/Library/os/exec/#command","text":"func Command(name string, arg ...string) *Cmd Command \u8fd4\u56de Cmd \u7ed3\u6784\u4ee5\u4f7f\u7528\u7ed9\u5b9a\u7684\u53c2\u6570\u6267\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\uff0c\u5b83\u4ec5\u5728\u8fd4\u56de\u7684Cmd\u7ed3\u6784\u4e2d\u8bbe\u7f6e Path \u548c Args \u3002 \u5982\u679c name \u4e0d\u5305\u542b\u8def\u5f84\u5206\u9694\u7b26\uff0c\u5219 Command \u4f7f\u7528 LookPath \u5c06 name \u89e3\u6790\u4e3a\u5b8c\u6574\u8def\u5f84\uff08\u5982\u679c\u53ef\u80fd\uff09\u3002\u5426\u5219\uff0c\u5b83\u76f4\u63a5\u4f7f\u7528 name \u4f5c\u4e3a Path \u3002 \u8fd4\u56de\u7684 Cmd\u7ed3\u6784 \u4e2d Args \u5b57\u6bb5\u662f\u4ece\u547d\u4ee4 name \u540e\u7d27\u8ddf\u7684 arg \u5143\u7d20\u6784\u9020\u800c\u6765\uff0c\u56e0\u6b64\u5728 arg \u4e2d\u4e0d\u9700\u8981\u518d\u5305\u542b\u547d\u4ee4 name \u3002\u4f8b\u5982\uff0c Command\uff08\u201cecho\u201d\uff0c\u201chello\u201d\uff09 \u3002 Args[0] \u59cb\u7ec8\u662f name \uff0c\u800c\u4e0d\u53ef\u80fd\u662f\u5df2\u89e3\u6790\u7684\u8def\u5f84\u3002 \u5728 Windows \u4e0a\uff0c\u8fdb\u7a0b\u5c06\u6574\u4e2a\u547d\u4ee4\u884c\u4f5c\u4e3a\u5355\u4e2a\u5b57\u7b26\u4e32\u63a5\u6536\u5e76\u6267\u884c\u81ea\u5df1\u7684\u89e3\u6790\u3002 Command \u4f7f\u7528\u4e0e\u5e94\u7528\u7a0b\u5e8f\u517c\u5bb9\u7684\u7b97\u6cd5 CommandLineToArgvW \uff08\u8fd9\u662f\u6700\u5e38\u7528\u7684\u65b9\u5f0f\uff09\u5c06 Args \u7ec4\u5408\u5e76\u5f15\u7528\u5230\u547d\u4ee4\u884c\u5b57\u7b26\u4e32\u4e2d\u3002\u503c\u5f97\u6ce8\u610f\u7684\u4f8b\u5916\u662f msiexec.exe \u548c cmd.exe \uff08\u5305\u62ec\u6240\u6709\u6279\u5904\u7406\u6587\u4ef6 batch files \uff09\uff0c\u5b83\u4eec\u5177\u6709\u4e0d\u540c\u7684\u53cd\u5f15\u7528\u7b97\u6cd5\u3002\u5728\u8fd9\u4e9b\u6216\u5176\u4ed6\u7c7b\u4f3c\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u81ea\u5df1\u8fdb\u884c\u5f15\u7528\u5e76\u5728 SysProcAttr.CmdLine \u4e2d\u63d0\u4f9b\u5b8c\u6574\u7684\u547d\u4ee4\u884c\uff0c\u8ba9Args\u7a7a\u7740\u3002 cmd := exec.Command( tr , a-z , A-Z ) cmd.Stdin = strings.NewReader( some input ) var out bytes.Buffer cmd.Stdout = out err := cmd.Run() if err != nil { log.Fatal(err) } fmt.Printf( in all caps: %q\\n , out.String()) cmd := exec.Command( prog ) cmd.Env = append(os.Environ(), FOO=duplicate_value , // \u91cd\u590d\u503c\u5c06\u88ab\u5ffd\u7565 FOO=actual_value , // \u6700\u65b0\u503c\u5c06\u88ab\u4f7f\u7528 ) if err := cmd.Run(); err != nil { log.Fatal(err) }","title":"\u51fd\u6570Command"},{"location":"Language/Library/os/exec/#commandcontext","text":"func CommandContext(ctx context.Context, name string, arg ...string) *Cmd CommandContext \u4e0e Command \u7c7b\u4f3c\uff0c\u4f46\u5305\u542b\u4e0a\u4e0b\u6587\u3002 \u5982\u679c\u5728\u547d\u4ee4\u81ea\u884c\u5b8c\u6210\u4e4b\u524d context \u5df2\u7ecf\u7ed3\u675f\uff0c\u5219\u63d0\u4f9b\u7684 context \u7528\u4e8e\u7ec8\u6b62\u8fdb\u7a0b\uff08\u901a\u8fc7\u8c03\u7528 os.Process.Kill \uff09\u3002 ctx, cancel := context.WithTimeout(context.Background(), 100*time.Millisecond) defer cancel() if err := exec.CommandContext(ctx, sleep , 5 ).Run(); err != nil { // \u8fd9\u5c06\u5728100\u6beb\u79d2\u540e\u5931\u8d25\u3002 // 5\u79d2\u7684sleep\u8fdb\u7a0b\u5c06\u4f1a\u88ab\u4e2d\u65ad\u3002 }","title":"\u51fd\u6570CommandContext"},{"location":"Language/Library/os/exec/#cmdcombinedoutput","text":"func (c *Cmd) CombinedOutput() ([]byte, error) CombinedOutput \u8fd0\u884c\u547d\u4ee4\u5e76\u8fd4\u56de\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u9519\u8bef\u8f93\u51fa\u7684\u7ec4\u5408\u3002 cmd := exec.Command( sh , -c , echo stdout; echo 1 2 stderr ) stdoutStderr, err := cmd.CombinedOutput() if err != nil { log.Fatal(err) } fmt.Printf( %s\\n , stdoutStderr)","title":"\u65b9\u6cd5 (*Cmd)CombinedOutput"},{"location":"Language/Library/os/exec/#cmdoutput","text":"func (c *Cmd) Output() ([]byte, error) Output \u8fd0\u884c\u547d\u4ee4\u5e76\u8fd4\u56de\u5176\u6807\u51c6\u8f93\u51fa\u3002\u4efb\u4f55\u8fd4\u56de\u7684\u9519\u8bef\u901a\u5e38\u90fd\u662f *ExitError \u7c7b\u578b\u3002\u5982\u679c c.Stderr \u4e3a nil \uff0c\u5219 Output \u586b\u5145 ExitError.Stderr \u3002 out, err := exec.Command( date ).Output() if err != nil { log.Fatal(err) } fmt.Printf( The date is %s\\n , out)","title":"\u65b9\u6cd5 (*Cmd)Output"},{"location":"Language/Library/os/exec/#cmdrun","text":"func (c *Cmd) Run() error Run \u542f\u52a8\u6307\u5b9a\u7684\u547d\u4ee4\u5e76\u7b49\u5f85\u5b83\u5b8c\u6210\u3002 \u5982\u679c\u547d\u4ee4\u8fd0\u884c\uff0c\u5728\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e4b\u95f4\u590d\u5236\u6570\u636e\u6ca1\u6709\u95ee\u9898\u5e76\u4e14\u9000\u51fa\u72b6\u6001\u4e3a\u96f6\uff0c\u90a3\u4e48\u8fd4\u56de\u7684\u9519\u8bef\u4e3a nil \u3002 \u5982\u679c\u547d\u4ee4\u542f\u52a8\u4f46\u672a\u6210\u529f\u5b8c\u6210\uff0c\u5219\u8fd4\u56de\u7684\u9519\u8bef\u7c7b\u578b\u4e3a *ExitError \u3002\u5bf9\u4e8e\u5176\u4ed6\u60c5\u51b5\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u5176\u4ed6\u9519\u8bef\u7c7b\u578b\u3002 \u5982\u679c\u6b63\u5728\u88ab\u8c03\u7528\u7684goroutine\u5df2\u4f7f\u7528 runtime.LockOSThread \u9501\u5b9a\u64cd\u4f5c\u7cfb\u7edf\u7ebf\u7a0b\u5e76\u4fee\u6539\u4e86\u4efb\u4f55\u53ef\u7ee7\u627f\u7684OS\u7ea7\u522b\u7ebf\u7a0b\u72b6\u6001\uff08\u4f8b\u5982\uff0cLinux\u6216Plan 9\u540d\u79f0\u7a7a\u95f4\uff09\uff0c\u5219\u65b0\u8fdb\u7a0b\u5c06\u7ee7\u627f\u8c03\u7528\u65b9\u7684\u7ebf\u7a0b\u72b6\u6001\u3002 cmd := exec.Command( sleep , 1 ) log.Printf( Running command and waiting for it to finish... ) err := cmd.Run() log.Printf( Command finished with error: %v , err)","title":"\u65b9\u6cd5 (*Cmd)Run"},{"location":"Language/Library/os/exec/#cmdstart","text":"func (c *Cmd) Start() error Start \u542f\u52a8\u6307\u5b9a\u7684\u547d\u4ee4\uff0c\u4f46\u4e0d\u7b49\u5f85\u5b83\u5b8c\u6210\u3002 \u4e00\u65e6\u547d\u4ee4\u9000\u51fa\uff0c Wait \u65b9\u6cd5\u5c06\u8fd4\u56de\u9000\u51fa\u72b6\u6001\u7801\u5e76\u91ca\u653e\u76f8\u5173\u8d44\u6e90\u3002 cmd := exec.Command( sleep , 5 ) err := cmd.Start() if err != nil { log.Fatal(err) } log.Printf( Waiting for command to finish... ) err = cmd.Wait() log.Printf( Command finished with error: %v , err)","title":"\u65b9\u6cd5 (*Cmd)Start"},{"location":"Language/Library/os/exec/#cmdstderrpipe","text":"func (c *Cmd) StderrPipe() (io.ReadCloser, error) StderrPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u3002 Wait \u5c06\u5728\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5173\u95ed\u7ba1\u9053\uff0c\u56e0\u6b64\u5927\u591a\u6570\u8c03\u7528\u8005\u4e0d\u9700\u8981\u81ea\u5df1\u5173\u95ed\u7ba1\u9053; \u4f46\u662f\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5728\u7ba1\u9053\u7684\u6240\u6709\u8bfb\u53d6\u5b8c\u6210\u4e4b\u524d\u8c03\u7528 Wait \u662f\u4e0d\u6b63\u786e\u7684\u3002\u540c\u6837\u7684\uff0c\u4f7f\u7528 StderrPipe \u65f6\u4f7f\u7528 Run \u4e5f\u662f\u4e0d\u6b63\u786e\u7684\u3002 \u6709\u5173\u4e60\u60ef\u7528\u6cd5\uff0c\u8bf7\u53c2\u9605StdoutPipe\u793a\u4f8b\u3002 cmd := exec.Command( sh , -c , echo stdout; echo 1 2 stderr ) stderr, err := cmd.StderrPipe() if err != nil { log.Fatal(err) } if err := cmd.Start(); err != nil { log.Fatal(err) } slurp, _ := ioutil.ReadAll(stderr) fmt.Printf( %s\\n , slurp) if err := cmd.Wait(); err != nil { log.Fatal(err) }","title":"\u65b9\u6cd5 (*Cmd)StderrPipe"},{"location":"Language/Library/os/exec/#cmdstdinpipe","text":"func (c *Cmd) StdinPipe() (io.WriteCloser, error) StdinPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u5165\u3002 Wait \u67e5\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5c06\u81ea\u52a8\u5173\u95ed\u7ba1\u9053\u3002\u8c03\u7528\u8005\u53ea\u9700\u8981\u8c03\u7528 Close \u6765\u5f3a\u5236\u7ba1\u9053\u66f4\u5feb\u5173\u95ed\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6b63\u5728\u8fd0\u884c\u7684\u547d\u4ee4\u5728\u6807\u51c6\u8f93\u5165\u5173\u95ed\u4e4b\u540e\u4e0d\u4f1a\u9000\u51fa\uff0c\u5219\u8c03\u7528\u8005\u5fc5\u987b\u5173\u95ed\u7ba1\u9053\u3002 cmd := exec.Command( cat ) stdin, err := cmd.StdinPipe() if err != nil { log.Fatal(err) } go func() { defer stdin.Close() io.WriteString(stdin, values written to stdin are passed to cmd's standard input ) }() out, err := cmd.CombinedOutput() if err != nil { log.Fatal(err) } fmt.Printf( %s\\n , out)","title":"\u65b9\u6cd5 (*Cmd)StdinPipe"},{"location":"Language/Library/os/exec/#cmdstdoutpipe","text":"func (c *Cmd) StdoutPipe() (io.ReadCloser, error) StdoutPipe \u8fd4\u56de\u4e00\u4e2a\u7ba1\u9053\uff0c\u8be5\u7ba1\u9053\u5c06\u5728\u547d\u4ee4\u542f\u52a8\u65f6\u8fde\u63a5\u5230\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u3002 Wait \u5c06\u5728\u770b\u5230\u547d\u4ee4\u9000\u51fa\u540e\u5173\u95ed\u7ba1\u9053\uff0c\u56e0\u6b64\u5927\u591a\u6570\u8c03\u7528\u8005\u4e0d\u9700\u8981\u81ea\u5df1\u5173\u95ed\u7ba1\u9053; \u4f46\u662f\uff0c\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5728\u7ba1\u9053\u7684\u6240\u6709\u8bfb\u53d6\u5b8c\u6210\u4e4b\u524d\u8c03\u7528 Wait \u662f\u4e0d\u6b63\u786e\u7684\u3002\u540c\u6837\u7684\uff0c\u4f7f\u7528 StdoutPipe \u65f6\u8c03\u7528Run\u662f\u4e0d\u6b63\u786e\u7684\u3002\u6709\u5173\u4e60\u60ef\u7528\u6cd5\uff0c\u8bf7\u53c2\u9605\u793a\u4f8b\u3002 cmd := exec.Command( echo , -n , `{ Name : Bob , Age : 32}`) stdout, err := cmd.StdoutPipe() if err != nil { log.Fatal(err) } if err := cmd.Start(); err != nil { log.Fatal(err) } var person struct { Name string Age int } if err := json.NewDecoder(stdout).Decode( person); err != nil { log.Fatal(err) } if err := cmd.Wait(); err != nil { log.Fatal(err) } fmt.Printf( %s is %d years old\\n , person.Name, person.Age)","title":"\u65b9\u6cd5 (*Cmd)StdoutPipe"},{"location":"Language/Library/os/exec/#cmdwait","text":"func (c *Cmd) Wait() error Wait \u7b49\u5f85\u547d\u4ee4\u9000\u51fa\u5e76\u7b49\u5f85\u4efb\u4f55\u590d\u5236\u5230\u6807\u51c6\u8f93\u5165\u6216\u8005\u4ece\u6807\u51c6\u8f93\u51fa\u6216\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u590d\u5236\u5b8c\u6210\u3002 \u8be5\u547d\u4ee4\u5fc5\u987b\u7531 Start \u542f\u52a8\u3002 \u5982\u679c\u547d\u4ee4\u8fd0\u884c\uff0c\u5728\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4e4b\u95f4\u590d\u5236\u6570\u636e\u6ca1\u6709\u95ee\u9898\u4e14\u9000\u51fa\u72b6\u6001\u7801\u4e3a\u96f6\uff0c\u90a3\u4e48\uff0c\u8fd4\u56de\u7684\u9519\u8bef\u4e3a nil \u3002 \u5982\u679c\u547d\u4ee4\u65e0\u6cd5\u8fd0\u884c\u6216\u672a\u6210\u529f\u5b8c\u6210\uff0c\u5219\u9519\u8bef\u7c7b\u578b\u4e3a *ExitError \u3002\u5bf9\u4e8eI/O\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u8fd4\u56de\u5176\u4ed6\u9519\u8bef\u7c7b\u578b\u3002 \u5982\u679c c.Stdin \uff0c c.Stdout \u6216 c.Stderr \u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u4e0d\u662f *os.File \uff0c\u90a3\u4e48 Wait \u4e5f\u4f1a\u7b49\u5f85\u76f8\u5e94\u7684I/O\u5faa\u73af\u590d\u5236\u5230\u8fdb\u7a0b\u6216\u4ece\u8fdb\u7a0b\u4e2d\u590d\u5236\u5b8c\u6210\u3002 Wait \u91ca\u653e\u4e0e Cmd \u76f8\u5173\u7684\u4efb\u4f55\u8d44\u6e90\u3002","title":"\u65b9\u6cd5 (*Cmd)Wait"},{"location":"Language/Library/os/exec/#error","text":"type Error struct { // Name\u662f\u53d1\u751f\u9519\u8bef\u7684\u6587\u4ef6\u540d\u3002 Name string // Err\u662f\u6f5c\u5728\u7684\u9519\u8bef\u3002 Err error } Error\u662f LookPath \u65e0\u6cd5\u5c06\u6587\u4ef6\u5f52\u7c7b\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\u65f6\u8fd4\u56de\u7684\u3002","title":"\u7c7b\u578bError"},{"location":"Language/Library/os/exec/#errorerror","text":"func (e *Error) Error() string","title":"\u65b9\u6cd5 (*Error)Error"},{"location":"Language/Library/os/exec/#exiterror","text":"type ExitError struct { *os.ProcessState // \u5982\u679c\u6ca1\u6709\u6536\u96c6\u6807\u51c6\u9519\u8bef\u8f93\u51fa\uff0cStderr\u4f1a\u4fdd\u7559Cmd.Output\u65b9\u6cd5\u7684\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u7684\u5b50\u96c6\u3002 // \u5982\u679c\u9519\u8bef\u8f93\u51fa\u5f88\u957f\uff0cStderr\u53ef\u80fd\u53ea\u5305\u542b\u8f93\u51fa\u7684\u524d\u7f00\u548c\u540e\u7f00\uff0c\u4e2d\u95f4\u66ff\u6362\u4e3a\u76f8\u5173\u7701\u7565\u5b57\u8282\u6570\u7684\u6587\u672c\u3002 // \u63d0\u4f9bStderr\u662f\u7528\u4e8e\u4ee3\u7801\u8c03\u8bd5\uff0c\u6765\u5305\u542b\u5728\u9519\u8bef\u6d88\u606f\u4e2d\u3002\u5177\u6709\u5176\u4ed6\u9700\u6c42\u7684\u7528\u6237\u5e94\u6839\u636e\u9700\u8981\u91cd\u5b9a\u5411Cmd.Stderr\u3002 Stderr []byte } ExitError\u62a5\u544a\u547d\u4ee4\u9000\u51fa\u5931\u8d25\u3002","title":"\u7c7b\u578bExitError"},{"location":"Language/Library/os/exec/#exiterrorerror","text":"func (e *ExitError) Error() string","title":"\u65b9\u6cd5 (*ExitError)Error"},{"location":"Language/Regexp/\u57fa\u7840/","text":"\u6b63\u5219\u8868\u8fbe\u5f0f \u539f\u6587\u94fe\u63a5\uff1ahttps://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md \u5728\u7ebf\u6b63\u5219\u8868\u8fbe\u5f0f\u7f16\u8f91\uff1ahttps://regex101.com/ \u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u4e00\u7ec4\u7531\u5b57\u6bcd\u548c\u7b26\u53f7\u7ec4\u6210\u7684\u7279\u6b8a\u6587\u672c\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u4ece\u6587\u672c\u4e2d\u627e\u51fa\u6ee1\u8db3\u60f3\u8981\u683c\u5f0f\u7684\u8bed\u53e5\u3002 \u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u201cRegular expression\u201d\uff0c\u7f29\u5199\u4e3a\u201cregex\u201d\u6216\u201cregexp\u201d\uff09\u662f\u4e00\u79cd \u4ece\u5de6\u5230\u53f3\u5339\u914d\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f \uff0c\u53ef\u4ee5\u4ece\u4e00\u4e2a\u57fa\u7840\u5b57\u7b26\u4e32\u4e2d\u6839\u636e\u4e00\u5b9a\u7684\u5339\u914d\u6a21\u5f0f\u66ff\u6362\u6587\u672c\u4e2d\u7684\u5b57\u7b26\u4e32\u3001\u9a8c\u8bc1\u8868\u8fbe\u8868\u5355\u3001\u63d0\u53d6\u5b57\u7b26\u4e32\u7b49\u3002 \u4f8b\u5b50\uff0c\u5047\u8bbe\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u547d\u540d\u7684\u89c4\u5219\uff0c\u8ba9\u7528\u6237\u540d\u5305\u542b\u5b57\u7b26\u3001\u6570\u7ec4\u3001\u4e0b\u5212\u7ebf( _ )\u548c\u8fde\u5b57\u7b26( - )\u5e76\u9650\u5236\u5b57\u7b26\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u9a8c\u8bc1\uff1a \u57fa\u672c\u5339\u914d \u6b63\u5219\u8868\u8fbe\u5f0f\u5176\u5b9e\u5c31\u662f\u5728\u6267\u884c\u641c\u7d22\u65f6\u7684\u683c\u5f0f\uff0c\u5b83\u7531\u4e00\u4e9b\u5b57\u6bcd\u548c\u6570\u7ec4\u7ec4\u5408\u800c\u6210\u3002 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b the \u7531\u5b57\u6bcdt\u5f00\u59cb\uff0c\u63a5\u7740\u662fh\uff0c\u518d\u63a5\u7740\u662fe the = The fat cat sat on the mat. The The = The fat cat sat on the mat. \u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684 \u3002 \u5143\u5b57\u7b26 \u6b63\u5219\u8868\u8fbe\u5f0f\u4e3b\u8981\u4f9d\u8d56\u4e8e\u5143\u5b57\u7b26\u3002 \u5143\u5b57\u7b26\u4e0d\u4ee3\u8868\u5b83\u4eec\u672c\u8eab\u7684\u5b57\u9762\u610f\u601d \uff0c\u5b83\u4eec\u6709\u7279\u6b8a\u7684\u542b\u4e49 \u4e00\u4e9b\u5143\u5b57\u7b26\u5199\u5728 \u65b9\u62ec\u53f7 \u4e2d\u7684\u65f6\u5019\uff0c\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u610f\u601d \u5982 [.] \u8868\u793a\u82f1\u6587\u53e5\u53f7\uff0c\u793a\u4f8b\uff1a ar[.] = A garage is a good place to park a c ar. \u5143\u5b57\u7b26 \u63cf\u8ff0 \u793a\u4f8b . \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff08\u9664\u6362\u884c\u7b26\uff09 .ar = The car parked in the garage. [] \u5339\u914d\u65b9\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 [Tt]he = The car parked in the garage. [^] \u5339\u914d\u65b9\u62ec\u53f7\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 [^c]ar = The car par ked in the gar age. * \u5339\u914d =0\u4e2a * \u4e4b\u524d\u7684\u5b57\u7b26 [a-z]* = T he car parked in the garage #21. + \u5339\u914d =1\u4e2a + \u4e4b\u524d\u7684\u5b57\u7b26 c.+t = The fat cat sat on the mat . ? ? \u4e4b\u524d\u7684\u5b57\u7b26\u4e3a\u53ef\u9009 [T]?he = The car is parked in t he garage. {n,m} \u5339\u914d {} \u524d\u56fa\u5b9a\u6570\u91cf\u4e2a\u5b57\u7b26\uff0c\u6570\u91cf\u5728n\u4e0em\u4e4b\u95f4\uff0cm\u4e0d\u5199\u8868\u793a\u81f3\u5c11n\u4e2a\uff0cm\u548c\uff0c\u90fd\u4e0d\u5199\u8868\u793a\u56fa\u5b9a\u6b21\u6570 [0-9]{2,3} = The number was 9. 999 7 but we rounded it off to 10 .0. () \u5339\u914d\u4e0e () \u5185\u5b8c\u5168\u76f8\u540c\u7684\u5b57\u7b26\u4e32 (c|g|p)ar = The car is par ked in the gar age. | \u5339\u914d | \u5de6\u53f3\u7684\u5b57\u7b26 (T|t)he|car = The car is parked in the garage. \\ \u8f6c\u4e49\u5b57\u7b26\uff0c\u5339\u914d\u4fdd\u7559\u5b57\u7b26 [](){}.*+?^$\\| (f|c|m)at\\.? = The fat cat sat on the mat. ^ \u5339\u914d\u884c\u5f00\u5934 ^(T|t)he = The car is parked in the garage. $ \u5339\u914d\u884c\u7ed3\u5c3e (at\\.)$ = The fat cat. sat. on the mat. \u7b80\u5199\u5b57\u7b26\u96c6 \u7b80\u5199 \u63cf\u8ff0 . \u5339\u914d\u6240\u6709\u5b57\u7b26\uff08\u9664\u6362\u884c\u7b26\uff09 \\w \u5339\u914d\u6240\u6709\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u7b49\u540c [a-zA-Z0-9_] \\W \u5339\u914d\u6240\u6709\u975e\u5b57\u6bcd\u6570\u5b57\uff0c\u7b49\u540c [^\\w] \\d \u5339\u914d\u6570\u5b57\uff0c\u7b49\u540c [0-9] \\D \u5339\u914d\u975e\u6570\u5b57\uff0c\u7b49\u540c [^\\d] \\s \u5339\u914d\u6240\u6709\u7a7a\u683c\u5b57\u7b26\uff0c\u7b49\u540c [\\t\\n\\f\\r\\p{z}] \\S \u5339\u914d\u6240\u6709\u975e\u7a7a\u683c\uff0c\u7b49\u540c [^\\s] \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26 \\n \u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26 \\r \u5339\u914d\u4e00\u4e2a\u56de\u8f66\u7b26 \\t \u5339\u914d\u4e00\u4e2a\u5236\u8868\u7b26 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26 \\p \u5339\u914dCR\\LF\uff0c\u7b49\u540c \\r\\n \uff0c\u5339\u914dDOS\u884c\u7ec8\u6b62\u7b26 \u96f6\u5bbd\u5ea6\u65ad\u8a00 \u5148\u884c\u65ad\u8a00\u548c\u540e\u53d1\u65ad\u8a00\u90fd\u5c5e\u4e8e\u975e\u6355\u83b7\u7c07\uff0c\u4e0d\u6355\u83b7\u6587\u672c\u4e5f\u4e0d\u9488\u5bf9\u7ec4\u5408\u8fdb\u884c\u8ba1\u6570\u3002 \u7b26\u53f7 \u542b\u4e49 \u63cf\u8ff0 \u793a\u4f8b ?= \u6b63\u5148\u884c\u65ad\u8a00---\u5b58\u5728 \u8868\u793a\u7b2c\u4e00\u90e8\u5206\u8868\u8fbe\u5f0f\u540e\u5fc5\u987b\u8ddf\u7740?=...\u5b9a\u4e49\u7684\u8868\u8fbe\u5f0f\uff0c\u7ed3\u679c\u53ea\u5305\u542b\u6ee1\u8db3\u5339\u914d\u6761\u4ef6\u7684\u7b2c\u4e00\u90e8\u5206\u8868\u8fbe\u5f0f\uff0c\u6b63\u5148\u884c\u65ad\u8a00\u7684\u5185\u5bb9\u5199\u5728\u62ec\u53f7\u4e2d\u7684\u7b49\u53f7\u540e (T|t)he(?=\\sfat) = The fat cat sat on the mat. ?! \u8d1f\u5148\u884c\u65ad\u8a00---\u6392\u9664 \u7528\u4e8e\u7b5b\u9009\u6240\u6709\u5339\u914d\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u540e\u4e0d\u8ddf\u968f\u7740\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f (T|t)he(?!\\sfat) = The fat cat sat on the mat. ? = \u6b63\u540e\u53d1\u65ad\u8a00---\u5b58\u5728 \u7b5b\u9009\u6240\u6709\u5339\u914d\u7684\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u524d\u8ddf\u968f\u7740\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f (? =(T|t)he\\s)(fat|mat) = The fat cat sat on the mat . ? ! \u8d1f\u540e\u53d1\u65ad\u8a00---\u6392\u9664 \u7b5b\u9009\u6240\u6709\u5339\u914d\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u524d\u4e0d\u8ddf\u968f\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f \"(? !(T|t)he\\s)(cat) = The cat sat on cat . \u6807\u5fd7 \u6807\u5fd7\u4e5f\u53eb\u6a21\u5f0f\u4fee\u6b63\u7b26\uff0c\u7528\u6765\u4fee\u6539\u8868\u8fbe\u5f0f\u7684\u641c\u7d22\u7ed3\u679c\uff0c\u6807\u5fd7\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4f7f\u7528\uff0c\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e00\u90e8\u5206\u3002 \u6807\u5fd7 \u63cf\u8ff0 \u793a\u4f8b i \u5ffd\u7565\u5927\u5c0f\u5199 /The/gi = The fat cat sat on the mat. g \u5168\u5c40\u641c\u7d22 /.(at)/g = The fat cat sat on the mat . m \u591a\u884c\u4fee\u9970\u7b26\uff0c ^ , $ \u5de5\u4f5c\u8303\u56f4\u5728\u6bcf\u884c\u7684\u8d77\u59cb /.at(.)?$/gm = The fat cat sat on the mat. \u8d2a\u5a6a\u5339\u914d \u60f0\u6027\u5339\u914d \u6b63\u5219\u8868\u8fbe\u5f0f\u9ed8\u8ba4\u91c7\u7528\u8d2a\u5a6a\u5339\u914d\uff1a /(.*at)/ = The fat cat sat on the mat . \u4f7f\u7528 ? \u5c06\u8d2a\u5a6a\u5339\u914d\u8f6c\u6362\u4e3a\u60f0\u6027\u5339\u914d\uff1a /(.*?at)/ = The fat cat sat on the mat.","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Language/Regexp/\u57fa\u7840/#_1","text":"\u539f\u6587\u94fe\u63a5\uff1ahttps://github.com/ziishaned/learn-regex/blob/master/translations/README-cn.md \u5728\u7ebf\u6b63\u5219\u8868\u8fbe\u5f0f\u7f16\u8f91\uff1ahttps://regex101.com/ \u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u4e00\u7ec4\u7531\u5b57\u6bcd\u548c\u7b26\u53f7\u7ec4\u6210\u7684\u7279\u6b8a\u6587\u672c\uff0c\u5b83\u53ef\u4ee5\u7528\u6765\u4ece\u6587\u672c\u4e2d\u627e\u51fa\u6ee1\u8db3\u60f3\u8981\u683c\u5f0f\u7684\u8bed\u53e5\u3002 \u4e00\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u201cRegular expression\u201d\uff0c\u7f29\u5199\u4e3a\u201cregex\u201d\u6216\u201cregexp\u201d\uff09\u662f\u4e00\u79cd \u4ece\u5de6\u5230\u53f3\u5339\u914d\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f \uff0c\u53ef\u4ee5\u4ece\u4e00\u4e2a\u57fa\u7840\u5b57\u7b26\u4e32\u4e2d\u6839\u636e\u4e00\u5b9a\u7684\u5339\u914d\u6a21\u5f0f\u66ff\u6362\u6587\u672c\u4e2d\u7684\u5b57\u7b26\u4e32\u3001\u9a8c\u8bc1\u8868\u8fbe\u8868\u5355\u3001\u63d0\u53d6\u5b57\u7b26\u4e32\u7b49\u3002 \u4f8b\u5b50\uff0c\u5047\u8bbe\u521b\u5efa\u4e00\u4e2a\u7528\u6237\u547d\u540d\u7684\u89c4\u5219\uff0c\u8ba9\u7528\u6237\u540d\u5305\u542b\u5b57\u7b26\u3001\u6570\u7ec4\u3001\u4e0b\u5212\u7ebf( _ )\u548c\u8fde\u5b57\u7b26( - )\u5e76\u9650\u5236\u5b57\u7b26\u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u9a8c\u8bc1\uff1a","title":"\u6b63\u5219\u8868\u8fbe\u5f0f"},{"location":"Language/Regexp/\u57fa\u7840/#_2","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\u5176\u5b9e\u5c31\u662f\u5728\u6267\u884c\u641c\u7d22\u65f6\u7684\u683c\u5f0f\uff0c\u5b83\u7531\u4e00\u4e9b\u5b57\u6bcd\u548c\u6570\u7ec4\u7ec4\u5408\u800c\u6210\u3002 \u6b63\u5219\u8868\u8fbe\u5f0f \u63cf\u8ff0 \u793a\u4f8b the \u7531\u5b57\u6bcdt\u5f00\u59cb\uff0c\u63a5\u7740\u662fh\uff0c\u518d\u63a5\u7740\u662fe the = The fat cat sat on the mat. The The = The fat cat sat on the mat. \u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684 \u3002","title":"\u57fa\u672c\u5339\u914d"},{"location":"Language/Regexp/\u57fa\u7840/#_3","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\u4e3b\u8981\u4f9d\u8d56\u4e8e\u5143\u5b57\u7b26\u3002 \u5143\u5b57\u7b26\u4e0d\u4ee3\u8868\u5b83\u4eec\u672c\u8eab\u7684\u5b57\u9762\u610f\u601d \uff0c\u5b83\u4eec\u6709\u7279\u6b8a\u7684\u542b\u4e49 \u4e00\u4e9b\u5143\u5b57\u7b26\u5199\u5728 \u65b9\u62ec\u53f7 \u4e2d\u7684\u65f6\u5019\uff0c\u6709\u4e00\u4e9b\u7279\u6b8a\u7684\u610f\u601d \u5982 [.] \u8868\u793a\u82f1\u6587\u53e5\u53f7\uff0c\u793a\u4f8b\uff1a ar[.] = A garage is a good place to park a c ar. \u5143\u5b57\u7b26 \u63cf\u8ff0 \u793a\u4f8b . \u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff08\u9664\u6362\u884c\u7b26\uff09 .ar = The car parked in the garage. [] \u5339\u914d\u65b9\u62ec\u53f7\u5185\u7684\u4efb\u610f\u5b57\u7b26 [Tt]he = The car parked in the garage. [^] \u5339\u914d\u65b9\u62ec\u53f7\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26 [^c]ar = The car par ked in the gar age. * \u5339\u914d =0\u4e2a * \u4e4b\u524d\u7684\u5b57\u7b26 [a-z]* = T he car parked in the garage #21. + \u5339\u914d =1\u4e2a + \u4e4b\u524d\u7684\u5b57\u7b26 c.+t = The fat cat sat on the mat . ? ? \u4e4b\u524d\u7684\u5b57\u7b26\u4e3a\u53ef\u9009 [T]?he = The car is parked in t he garage. {n,m} \u5339\u914d {} \u524d\u56fa\u5b9a\u6570\u91cf\u4e2a\u5b57\u7b26\uff0c\u6570\u91cf\u5728n\u4e0em\u4e4b\u95f4\uff0cm\u4e0d\u5199\u8868\u793a\u81f3\u5c11n\u4e2a\uff0cm\u548c\uff0c\u90fd\u4e0d\u5199\u8868\u793a\u56fa\u5b9a\u6b21\u6570 [0-9]{2,3} = The number was 9. 999 7 but we rounded it off to 10 .0. () \u5339\u914d\u4e0e () \u5185\u5b8c\u5168\u76f8\u540c\u7684\u5b57\u7b26\u4e32 (c|g|p)ar = The car is par ked in the gar age. | \u5339\u914d | \u5de6\u53f3\u7684\u5b57\u7b26 (T|t)he|car = The car is parked in the garage. \\ \u8f6c\u4e49\u5b57\u7b26\uff0c\u5339\u914d\u4fdd\u7559\u5b57\u7b26 [](){}.*+?^$\\| (f|c|m)at\\.? = The fat cat sat on the mat. ^ \u5339\u914d\u884c\u5f00\u5934 ^(T|t)he = The car is parked in the garage. $ \u5339\u914d\u884c\u7ed3\u5c3e (at\\.)$ = The fat cat. sat. on the mat.","title":"\u5143\u5b57\u7b26"},{"location":"Language/Regexp/\u57fa\u7840/#_4","text":"\u7b80\u5199 \u63cf\u8ff0 . \u5339\u914d\u6240\u6709\u5b57\u7b26\uff08\u9664\u6362\u884c\u7b26\uff09 \\w \u5339\u914d\u6240\u6709\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u7b49\u540c [a-zA-Z0-9_] \\W \u5339\u914d\u6240\u6709\u975e\u5b57\u6bcd\u6570\u5b57\uff0c\u7b49\u540c [^\\w] \\d \u5339\u914d\u6570\u5b57\uff0c\u7b49\u540c [0-9] \\D \u5339\u914d\u975e\u6570\u5b57\uff0c\u7b49\u540c [^\\d] \\s \u5339\u914d\u6240\u6709\u7a7a\u683c\u5b57\u7b26\uff0c\u7b49\u540c [\\t\\n\\f\\r\\p{z}] \\S \u5339\u914d\u6240\u6709\u975e\u7a7a\u683c\uff0c\u7b49\u540c [^\\s] \\f \u5339\u914d\u4e00\u4e2a\u6362\u9875\u7b26 \\n \u5339\u914d\u4e00\u4e2a\u6362\u884c\u7b26 \\r \u5339\u914d\u4e00\u4e2a\u56de\u8f66\u7b26 \\t \u5339\u914d\u4e00\u4e2a\u5236\u8868\u7b26 \\v \u5339\u914d\u4e00\u4e2a\u5782\u76f4\u5236\u8868\u7b26 \\p \u5339\u914dCR\\LF\uff0c\u7b49\u540c \\r\\n \uff0c\u5339\u914dDOS\u884c\u7ec8\u6b62\u7b26","title":"\u7b80\u5199\u5b57\u7b26\u96c6"},{"location":"Language/Regexp/\u57fa\u7840/#_5","text":"\u5148\u884c\u65ad\u8a00\u548c\u540e\u53d1\u65ad\u8a00\u90fd\u5c5e\u4e8e\u975e\u6355\u83b7\u7c07\uff0c\u4e0d\u6355\u83b7\u6587\u672c\u4e5f\u4e0d\u9488\u5bf9\u7ec4\u5408\u8fdb\u884c\u8ba1\u6570\u3002 \u7b26\u53f7 \u542b\u4e49 \u63cf\u8ff0 \u793a\u4f8b ?= \u6b63\u5148\u884c\u65ad\u8a00---\u5b58\u5728 \u8868\u793a\u7b2c\u4e00\u90e8\u5206\u8868\u8fbe\u5f0f\u540e\u5fc5\u987b\u8ddf\u7740?=...\u5b9a\u4e49\u7684\u8868\u8fbe\u5f0f\uff0c\u7ed3\u679c\u53ea\u5305\u542b\u6ee1\u8db3\u5339\u914d\u6761\u4ef6\u7684\u7b2c\u4e00\u90e8\u5206\u8868\u8fbe\u5f0f\uff0c\u6b63\u5148\u884c\u65ad\u8a00\u7684\u5185\u5bb9\u5199\u5728\u62ec\u53f7\u4e2d\u7684\u7b49\u53f7\u540e (T|t)he(?=\\sfat) = The fat cat sat on the mat. ?! \u8d1f\u5148\u884c\u65ad\u8a00---\u6392\u9664 \u7528\u4e8e\u7b5b\u9009\u6240\u6709\u5339\u914d\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u540e\u4e0d\u8ddf\u968f\u7740\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f (T|t)he(?!\\sfat) = The fat cat sat on the mat. ? = \u6b63\u540e\u53d1\u65ad\u8a00---\u5b58\u5728 \u7b5b\u9009\u6240\u6709\u5339\u914d\u7684\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u524d\u8ddf\u968f\u7740\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f (? =(T|t)he\\s)(fat|mat) = The fat cat sat on the mat . ? ! \u8d1f\u540e\u53d1\u65ad\u8a00---\u6392\u9664 \u7b5b\u9009\u6240\u6709\u5339\u914d\u7ed3\u679c\uff0c\u7b5b\u9009\u6761\u4ef6\u4e3a\u5176\u524d\u4e0d\u8ddf\u968f\u65ad\u8a00\u4e2d\u5b9a\u4e49\u7684\u683c\u5f0f \"(? !(T|t)he\\s)(cat) = The cat sat on cat .","title":"\u96f6\u5bbd\u5ea6\u65ad\u8a00"},{"location":"Language/Regexp/\u57fa\u7840/#_6","text":"\u6807\u5fd7\u4e5f\u53eb\u6a21\u5f0f\u4fee\u6b63\u7b26\uff0c\u7528\u6765\u4fee\u6539\u8868\u8fbe\u5f0f\u7684\u641c\u7d22\u7ed3\u679c\uff0c\u6807\u5fd7\u53ef\u4ee5\u4efb\u610f\u7ec4\u5408\u4f7f\u7528\uff0c\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u4e00\u90e8\u5206\u3002 \u6807\u5fd7 \u63cf\u8ff0 \u793a\u4f8b i \u5ffd\u7565\u5927\u5c0f\u5199 /The/gi = The fat cat sat on the mat. g \u5168\u5c40\u641c\u7d22 /.(at)/g = The fat cat sat on the mat . m \u591a\u884c\u4fee\u9970\u7b26\uff0c ^ , $ \u5de5\u4f5c\u8303\u56f4\u5728\u6bcf\u884c\u7684\u8d77\u59cb /.at(.)?$/gm = The fat cat sat on the mat.","title":"\u6807\u5fd7"},{"location":"Language/Regexp/\u57fa\u7840/#_7","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\u9ed8\u8ba4\u91c7\u7528\u8d2a\u5a6a\u5339\u914d\uff1a /(.*at)/ = The fat cat sat on the mat . \u4f7f\u7528 ? \u5c06\u8d2a\u5a6a\u5339\u914d\u8f6c\u6362\u4e3a\u60f0\u6027\u5339\u914d\uff1a /(.*?at)/ = The fat cat sat on the mat.","title":"\u8d2a\u5a6a\u5339\u914d&amp;\u60f0\u6027\u5339\u914d"},{"location":"Language/Regexp/\u5e38\u7528/","text":"\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u4e00\u4e2a\u5341\u5206\u53e4\u8001\u800c\u53c8\u5f3a\u5927\u7684\u6587\u672c\u5904\u7406\u5de5\u5177\uff0c\u4ec5\u4ec5\u7528\u4e00\u6bb5\u975e\u5e38\u7b80\u77ed\u7684\u8868\u8fbe\u5f0f\u8bed\u53e5\uff0c\u4fbf\u80fd\u591f\u5feb\u901f\u5b9e\u73b0\u4e00\u4e2a\u975e\u5e38\u590d\u6742\u7684\u4e1a\u52a1\u903b\u8f91\u3002\u719f\u7ec3\u5730\u638c\u63e1\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u8bdd\uff0c\u80fd\u591f\u4f7f\u4f60\u7684\u5f00\u53d1\u6548\u7387\u5f97\u5230\u6781\u5927\u7684\u63d0\u5347\u3002 1 . \u6821\u9a8c\u5bc6\u7801\u5f3a\u5ea6 \u5bc6\u7801\u7684\u5f3a\u5ea6\u5fc5\u987b\u662f\u5305\u542b\u5927\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57\u7684\u7ec4\u5408\uff0c\u4e0d\u80fd\u4f7f\u7528\u7279\u6b8a\u5b57\u7b26\uff0c\u957f\u5ea6\u57288-10\u4e4b\u95f4\u3002 ^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$ \u6821\u9a8c\u4e2d\u6587 \u5b57\u7b26\u4e32\u4ec5\u80fd\u662f\u4e2d\u6587\u3002 ^[\\\u4e00-\\\u9fa5]{0,}$ \u7531\u6570\u5b57\u300126\u4e2a\u82f1\u6587\u5b57\u6bcd\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 ^\\w+$ \u6821\u9a8cE-Mail \u5730\u5740 \u540c\u5bc6\u7801\u4e00\u6837\uff0c\u4e0b\u9762\u662fE-mail\u5730\u5740\u5408\u89c4\u6027\u7684\u6b63\u5219\u68c0\u67e5\u8bed\u53e5\u3002 [\\w!#$% '*+/=?^_`{|}~-]+(?:\\.[\\w!#$% '*+/=?^_`{|}~-]+)*@(?:[\\w](?:[\\w-]*[\\w])?\\.)+[\\w](?:[\\w-]*[\\w])? \u6821\u9a8c\u8eab\u4efd\u8bc1\u53f7\u7801 \u4e0b\u9762\u662f\u8eab\u4efd\u8bc1\u53f7\u7801\u7684\u6b63\u5219\u6821\u9a8c\u300215 \u6216 18\u4f4d\u3002 15\u4f4d\uff1a ^[1-9]\\d{7}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}$ 18\u4f4d\uff1a ^[1-9]\\d{5}[1-9]\\d{3}((0\\d)|(1[0-2]))(([0|1|2]\\d)|3[0-1])\\d{3}([0-9]|X)$ \u6821\u9a8c\u65e5\u671f \u201cyyyy-mm-dd\u201c \u683c\u5f0f\u7684\u65e5\u671f\u6821\u9a8c\uff0c\u5df2\u8003\u8651\u5e73\u95f0\u5e74\u3002 ^(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)$ \u6821\u9a8c\u91d1\u989d \u91d1\u989d\u6821\u9a8c\uff0c\u7cbe\u786e\u52302\u4f4d\u5c0f\u6570\u3002 ^[0-9]+(.[0-9]{2})?$ \u6821\u9a8c\u624b\u673a\u53f7 \u4e0b\u9762\u662f\u56fd\u5185 13\u300115\u300118\u5f00\u5934\u7684\u624b\u673a\u53f7\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\uff08\u53ef\u6839\u636e\u76ee\u524d\u56fd\u5185\u6536\u96c6\u53f7\u6269\u5c55\u524d\u4e24\u4f4d\u5f00\u5934\u53f7\u7801\uff09 ^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\\d{8}$ \u5224\u65adIE\u7684\u7248\u672c IE\u76ee\u524d\u8fd8\u6ca1\u88ab\u5b8c\u5168\u53d6\u4ee3\uff0c\u5f88\u591a\u9875\u9762\u8fd8\u662f\u9700\u8981\u505a\u7248\u672c\u517c\u5bb9\uff0c\u4e0b\u9762\u662fIE\u7248\u672c\u68c0\u67e5\u7684\u8868\u8fbe\u5f0f\u3002 ^.*MSIE [5-8](?:\\.[0-9]+)?(?!.*Trident\\/[5-9]\\.0).*$ \u6821\u9a8cIP-v4\u5730\u5740 IP4 \u6b63\u5219\u8bed\u53e5\u3002 \\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\b \u6821\u9a8cIP-v6\u5730\u5740 IP6 \u6b63\u5219\u8bed\u53e5\u3002 (([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])) \u68c0\u67e5URL\u7684\u524d\u7f00 \u5e94\u7528\u5f00\u53d1\u4e2d\u5f88\u591a\u65f6\u5019\u9700\u8981\u533a\u5206\u8bf7\u6c42\u662fHTTPS\u8fd8\u662fHTTP\uff0c\u901a\u8fc7\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u53ef\u4ee5\u53d6\u51fa\u4e00\u4e2aurl\u7684\u524d\u7f00\u7136\u540e\u518d\u903b\u8f91\u5224\u65ad\u3002 if (!s.match(/^[a-zA-Z]+:\\/\\//)){ s = 'http://' + s;} \u63d0\u53d6URL\u94fe\u63a5 \u4e0b\u9762\u7684\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u53ef\u4ee5\u7b5b\u9009\u51fa\u4e00\u6bb5\u6587\u672c\u4e2d\u7684URL\u3002 ^(f|ht){1}(tp|tps):\\/\\/([\\w-]+\\.)+[\\w-]+(\\/[\\w- ./?% =]*)? \u6587\u4ef6\u8def\u5f84\u53ca\u6269\u5c55\u540d\u6821\u9a8c \u9a8c\u8bc1windows\u4e0b\u6587\u4ef6\u8def\u5f84\u548c\u6269\u5c55\u540d\uff08\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\u4e3a.txt\u6587\u4ef6\uff09 ^([a-zA-Z]\\:|\\\\)\\\\([^\\\\]+\\\\)*[^\\/:*? |]+\\.txt(l)?$ \u63d0\u53d6Color Hex Codes \u6709\u65f6\u9700\u8981\u62bd\u53d6\u7f51\u9875\u4e2d\u7684\u989c\u8272\u4ee3\u7801\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u3002 ^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$ \u63d0\u53d6\u7f51\u9875\u56fe\u7247 \u5047\u82e5\u4f60\u60f3\u63d0\u53d6\u7f51\u9875\u4e2d\u6240\u6709\u56fe\u7247\u4fe1\u606f\uff0c\u53ef\u4ee5\u5229\u7528\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u3002 \\ *[img][^\\\\ ]*[src] *= *[\\ \\']{0,1}([^\\ \\'\\ ]*) \u63d0\u53d6\u9875\u9762\u8d85\u94fe\u63a5 \u63d0\u53d6html\u4e2d\u7684\u8d85\u94fe\u63a5\u3002 ( a\\s*(?!.*\\brel=)[^ ]*)(href= https?:\\/\\/)((?!(?:(?:www\\.)?'.implode('|(?:www\\.)?', $follow_list).'))[^ ]+) ((?!.*\\brel=)[^ ]*)(?:[^ ]*) \u67e5\u627eCSS\u5c5e\u6027 \u901a\u8fc7\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\uff0c\u53ef\u4ee5\u641c\u7d22\u5230\u76f8\u5339\u914d\u7684CSS\u5c5e\u6027\u3002 ^\\s*[a-zA-Z\\-]+\\s*[:]{1}\\s[a-zA-Z0-9\\s.#]+[;]{1} \u62bd\u53d6\u6ce8\u91ca \u5982\u679c\u4f60\u9700\u8981\u79fb\u9664HMTL\u4e2d\u7684\u6ce8\u91ca\uff0c\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u7684\u8868\u8fbe\u5f0f\u3002 !--(.*?)-- \u5339\u914dHTML\u6807\u7b7e \u901a\u8fc7\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5339\u914d\u51faHTML\u4e2d\u7684\u6807\u7b7e\u5c5e\u6027\u3002 \\/?\\w+((\\s+\\w+(\\s*=\\s*(?: .*? |'.*?'|[\\^' \\s]+))?)+\\s*|\\s*)\\/?","title":"\u5e38\u7528"}]}